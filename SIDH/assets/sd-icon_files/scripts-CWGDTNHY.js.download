/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */(function(n,c){"use strict";typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?c(n,!0):function(h){if(!h.document)throw new Error("jQuery requires a window with a document");return c(h)}:c(n)})(typeof window<"u"?window:this,function(n,c){"use strict";var h=[],u=Object.getPrototypeOf,d=h.slice,m=h.flat?function(v){return h.flat.call(v)}:function(v){return h.concat.apply([],v)},g=h.push,x=h.indexOf,E={},P=E.toString,L=E.hasOwnProperty,F=L.toString,U=F.call(Object),A={},G=function(v){return typeof v=="function"&&typeof v.nodeType!="number"&&typeof v.item!="function"},B=function(v){return v!=null&&v===v.window},O=n.document,K={type:!0,src:!0,nonce:!0,noModule:!0};function Q(v,S,M){var R,V,q=(M=M||O).createElement("script");if(q.text=v,S)for(R in K)(V=S[R]||S.getAttribute&&S.getAttribute(R))&&q.setAttribute(R,V);M.head.appendChild(q).parentNode.removeChild(q)}function et(v){return v==null?v+"":typeof v=="object"||typeof v=="function"?E[P.call(v)]||"object":typeof v}var lt="3.7.1",pt=/HTML$/i,T=function(v,S){return new T.fn.init(v,S)};function ct(v){var S=!!v&&"length"in v&&v.length,M=et(v);return!G(v)&&!B(v)&&(M==="array"||S===0||typeof S=="number"&&0<S&&S-1 in v)}function ut(v,S){return v.nodeName&&v.nodeName.toLowerCase()===S.toLowerCase()}T.fn=T.prototype={jquery:lt,constructor:T,length:0,toArray:function(){return d.call(this)},get:function(v){return v==null?d.call(this):v<0?this[v+this.length]:this[v]},pushStack:function(v){var S=T.merge(this.constructor(),v);return S.prevObject=this,S},each:function(v){return T.each(this,v)},map:function(v){return this.pushStack(T.map(this,function(S,M){return v.call(S,M,S)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,function(v,S){return(S+1)%2}))},odd:function(){return this.pushStack(T.grep(this,function(v,S){return S%2}))},eq:function(v){var S=this.length,M=+v+(v<0?S:0);return this.pushStack(0<=M&&M<S?[this[M]]:[])},end:function(){return this.prevObject||this.constructor()},push:g,sort:h.sort,splice:h.splice},T.extend=T.fn.extend=function(){var v,S,M,R,V,q,Y=arguments[0]||{},ht=1,st=arguments.length,xt=!1;for(typeof Y=="boolean"&&(xt=Y,Y=arguments[ht]||{},ht++),typeof Y=="object"||G(Y)||(Y={}),ht===st&&(Y=this,ht--);ht<st;ht++)if((v=arguments[ht])!=null)for(S in v)R=v[S],S!=="__proto__"&&Y!==R&&(xt&&R&&(T.isPlainObject(R)||(V=Array.isArray(R)))?(M=Y[S],q=V&&!Array.isArray(M)?[]:V||T.isPlainObject(M)?M:{},V=!1,Y[S]=T.extend(xt,q,R)):R!==void 0&&(Y[S]=R));return Y},T.extend({expando:"jQuery"+(lt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(v){throw new Error(v)},noop:function(){},isPlainObject:function(v){var S,M;return!(!v||P.call(v)!=="[object Object]")&&(!(S=u(v))||typeof(M=L.call(S,"constructor")&&S.constructor)=="function"&&F.call(M)===U)},isEmptyObject:function(v){var S;for(S in v)return!1;return!0},globalEval:function(v,S,M){Q(v,{nonce:S&&S.nonce},M)},each:function(v,S){var M,R=0;if(ct(v))for(M=v.length;R<M&&S.call(v[R],R,v[R])!==!1;R++);else for(R in v)if(S.call(v[R],R,v[R])===!1)break;return v},text:function(v){var S,M="",R=0,V=v.nodeType;if(!V)for(;S=v[R++];)M+=T.text(S);return V===1||V===11?v.textContent:V===9?v.documentElement.textContent:V===3||V===4?v.nodeValue:M},makeArray:function(v,S){var M=S||[];return v!=null&&(ct(Object(v))?T.merge(M,typeof v=="string"?[v]:v):g.call(M,v)),M},inArray:function(v,S,M){return S==null?-1:x.call(S,v,M)},isXMLDoc:function(v){var S=v&&v.namespaceURI,M=v&&(v.ownerDocument||v).documentElement;return!pt.test(S||M&&M.nodeName||"HTML")},merge:function(v,S){for(var M=+S.length,R=0,V=v.length;R<M;R++)v[V++]=S[R];return v.length=V,v},grep:function(v,S,M){for(var R=[],V=0,q=v.length,Y=!M;V<q;V++)!S(v[V],V)!==Y&&R.push(v[V]);return R},map:function(v,S,M){var R,V,q=0,Y=[];if(ct(v))for(R=v.length;q<R;q++)(V=S(v[q],q,M))!=null&&Y.push(V);else for(q in v)(V=S(v[q],q,M))!=null&&Y.push(V);return m(Y)},guid:1,support:A}),typeof Symbol=="function"&&(T.fn[Symbol.iterator]=h[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(v,S){E["[object "+S+"]"]=S.toLowerCase()});var ft=h.pop,$=h.sort,_t=h.splice,W="[\\x20\\t\\r\\n\\f]",rt=new RegExp("^"+W+"+|((?:^|[^\\\\])(?:\\\\.)*)"+W+"+$","g");T.contains=function(v,S){var M=S&&S.parentNode;return v===M||!(!M||M.nodeType!==1||!(v.contains?v.contains(M):v.compareDocumentPosition&&16&v.compareDocumentPosition(M)))};var nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function vt(v,S){return S?v==="\0"?"\uFFFD":v.slice(0,-1)+"\\"+v.charCodeAt(v.length-1).toString(16)+" ":"\\"+v}T.escapeSelector=function(v){return(v+"").replace(nt,vt)};var Mt=O,Bt=g;(function(){var v,S,M,R,V,q,Y,ht,st,xt,Tt=Bt,jt=T.expando,Et=0,qt=0,be=ii(),We=ii(),Ze=ii(),si=ii(),gi=function(tt,mt){return tt===mt&&(V=!0),0},dn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Dn="(?:\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",pr="\\["+W+"*("+Dn+")(?:"+W+"*([*^$|!~]?=)"+W+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Dn+"))|)"+W+"*\\]",Xi=":("+Dn+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+pr+")*)|.*)\\)|)",rr=new RegExp(W+"+","g"),Rr=new RegExp("^"+W+"*,"+W+"*"),Gn=new RegExp("^"+W+"*([>+~]|"+W+")"+W+"*"),ts=new RegExp(W+"|>"),ri=new RegExp(Xi),Fo=new RegExp("^"+Dn+"$"),Zn={ID:new RegExp("^#("+Dn+")"),CLASS:new RegExp("^\\.("+Dn+")"),TAG:new RegExp("^("+Dn+"|[*])"),ATTR:new RegExp("^"+pr),PSEUDO:new RegExp("^"+Xi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+W+"*(even|odd|(([+-]|)(\\d*)n|)"+W+"*(?:([+-]|)"+W+"*(\\d+)|))"+W+"*\\)|)","i"),bool:new RegExp("^(?:"+dn+")$","i"),needsContext:new RegExp("^"+W+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+W+"*((?:-\\d)?\\d*)"+W+"*\\)|)(?=[^-]|$)","i")},ho=/^(?:input|select|textarea|button)$/i,hi=/^h\d$/i,gn=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bi=/[+~]/,Yr=new RegExp("\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\([^\\r\\n\\f])","g"),Bi=function(tt,mt){var Pt="0x"+tt.slice(1)-65536;return mt||(Pt<0?String.fromCharCode(Pt+65536):String.fromCharCode(Pt>>10|55296,1023&Pt|56320))},An=function(){io()},Wi=mn(function(tt){return tt.disabled===!0&&ut(tt,"fieldset")},{dir:"parentNode",next:"legend"});try{Tt.apply(h=d.call(Mt.childNodes),Mt.childNodes),h[Mt.childNodes.length].nodeType}catch{Tt={apply:function(mt,Pt){Bt.apply(mt,d.call(Pt))},call:function(mt){Bt.apply(mt,d.call(arguments,1))}}}function ze(tt,mt,Pt,Nt){var Ht,_e,we,Te,me,_r,Ke,er=mt&&mt.ownerDocument,wr=mt?mt.nodeType:9;if(Pt=Pt||[],typeof tt!="string"||!tt||wr!==1&&wr!==9&&wr!==11)return Pt;if(!Nt&&(io(mt),mt=mt||q,ht)){if(wr!==11&&(me=gn.exec(tt)))if(Ht=me[1]){if(wr===9){if(!(we=mt.getElementById(Ht)))return Pt;if(we.id===Ht)return Tt.call(Pt,we),Pt}else if(er&&(we=er.getElementById(Ht))&&ze.contains(mt,we)&&we.id===Ht)return Tt.call(Pt,we),Pt}else{if(me[2])return Tt.apply(Pt,mt.getElementsByTagName(tt)),Pt;if((Ht=me[3])&&mt.getElementsByClassName)return Tt.apply(Pt,mt.getElementsByClassName(Ht)),Pt}if(!(si[tt+" "]||st&&st.test(tt))){if(Ke=tt,er=mt,wr===1&&(ts.test(tt)||Gn.test(tt))){for((er=bi.test(tt)&&bs(mt.parentNode)||mt)==mt&&A.scope||((Te=mt.getAttribute("id"))?Te=T.escapeSelector(Te):mt.setAttribute("id",Te=jt)),_e=(_r=en(tt)).length;_e--;)_r[_e]=(Te?"#"+Te:":scope")+" "+Zo(_r[_e]);Ke=_r.join(",")}try{return Tt.apply(Pt,er.querySelectorAll(Ke)),Pt}catch{si(tt,!0)}finally{Te===jt&&mt.removeAttribute("id")}}}return ia(tt.replace(rt,"$1"),mt,Pt,Nt)}function ii(){var tt=[];return function mt(Pt,Nt){return tt.push(Pt+" ")>S.cacheLength&&delete mt[tt.shift()],mt[Pt+" "]=Nt}}function zr(tt){return tt[jt]=!0,tt}function qr(tt){var mt=q.createElement("fieldset");try{return!!tt(mt)}catch{return!1}finally{mt.parentNode&&mt.parentNode.removeChild(mt),mt=null}}function vn(tt){return function(mt){return ut(mt,"input")&&mt.type===tt}}function Ie(tt){return function(mt){return(ut(mt,"input")||ut(mt,"button"))&&mt.type===tt}}function lo(tt){return function(mt){return"form"in mt?mt.parentNode&&mt.disabled===!1?"label"in mt?"label"in mt.parentNode?mt.parentNode.disabled===tt:mt.disabled===tt:mt.isDisabled===tt||mt.isDisabled!==!tt&&Wi(mt)===tt:mt.disabled===tt:"label"in mt&&mt.disabled===tt}}function Bn(tt){return zr(function(mt){return mt=+mt,zr(function(Pt,Nt){for(var Ht,_e=tt([],Pt.length,mt),we=_e.length;we--;)Pt[Ht=_e[we]]&&(Pt[Ht]=!(Nt[Ht]=Pt[Ht]))})})}function bs(tt){return tt&&typeof tt.getElementsByTagName<"u"&&tt}function io(tt){var mt,Pt=tt?tt.ownerDocument||tt:Mt;return Pt!=q&&Pt.nodeType===9&&Pt.documentElement&&(Y=(q=Pt).documentElement,ht=!T.isXMLDoc(q),xt=Y.matches||Y.webkitMatchesSelector||Y.msMatchesSelector,Y.msMatchesSelector&&Mt!=q&&(mt=q.defaultView)&&mt.top!==mt&&mt.addEventListener("unload",An),A.getById=qr(function(Nt){return Y.appendChild(Nt).id=T.expando,!q.getElementsByName||!q.getElementsByName(T.expando).length}),A.disconnectedMatch=qr(function(Nt){return xt.call(Nt,"*")}),A.scope=qr(function(){return q.querySelectorAll(":scope")}),A.cssHas=qr(function(){try{return q.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),A.getById?(S.filter.ID=function(Nt){var Ht=Nt.replace(Yr,Bi);return function(_e){return _e.getAttribute("id")===Ht}},S.find.ID=function(Nt,Ht){if(typeof Ht.getElementById<"u"&&ht){var _e=Ht.getElementById(Nt);return _e?[_e]:[]}}):(S.filter.ID=function(Nt){var Ht=Nt.replace(Yr,Bi);return function(_e){var we=typeof _e.getAttributeNode<"u"&&_e.getAttributeNode("id");return we&&we.value===Ht}},S.find.ID=function(Nt,Ht){if(typeof Ht.getElementById<"u"&&ht){var _e,we,Te,me=Ht.getElementById(Nt);if(me){if((_e=me.getAttributeNode("id"))&&_e.value===Nt)return[me];for(Te=Ht.getElementsByName(Nt),we=0;me=Te[we++];)if((_e=me.getAttributeNode("id"))&&_e.value===Nt)return[me]}return[]}}),S.find.TAG=function(Nt,Ht){return typeof Ht.getElementsByTagName<"u"?Ht.getElementsByTagName(Nt):Ht.querySelectorAll(Nt)},S.find.CLASS=function(Nt,Ht){if(typeof Ht.getElementsByClassName<"u"&&ht)return Ht.getElementsByClassName(Nt)},st=[],qr(function(Nt){var Ht;Y.appendChild(Nt).innerHTML="<a id='"+jt+"' href='' disabled='disabled'></a><select id='"+jt+"-\r\\' disabled='disabled'><option selected=''></option></select>",Nt.querySelectorAll("[selected]").length||st.push("\\["+W+"*(?:value|"+dn+")"),Nt.querySelectorAll("[id~="+jt+"-]").length||st.push("~="),Nt.querySelectorAll("a#"+jt+"+*").length||st.push(".#.+[+~]"),Nt.querySelectorAll(":checked").length||st.push(":checked"),(Ht=q.createElement("input")).setAttribute("type","hidden"),Nt.appendChild(Ht).setAttribute("name","D"),Y.appendChild(Nt).disabled=!0,Nt.querySelectorAll(":disabled").length!==2&&st.push(":enabled",":disabled"),(Ht=q.createElement("input")).setAttribute("name",""),Nt.appendChild(Ht),Nt.querySelectorAll("[name='']").length||st.push("\\["+W+"*name"+W+"*="+W+`*(?:''|"")`)}),A.cssHas||st.push(":has"),st=st.length&&new RegExp(st.join("|")),gi=function(Nt,Ht){if(Nt===Ht)return V=!0,0;var _e=!Nt.compareDocumentPosition-!Ht.compareDocumentPosition;return _e||(1&(_e=(Nt.ownerDocument||Nt)==(Ht.ownerDocument||Ht)?Nt.compareDocumentPosition(Ht):1)||!A.sortDetached&&Ht.compareDocumentPosition(Nt)===_e?Nt===q||Nt.ownerDocument==Mt&&ze.contains(Mt,Nt)?-1:Ht===q||Ht.ownerDocument==Mt&&ze.contains(Mt,Ht)?1:R?x.call(R,Nt)-x.call(R,Ht):0:4&_e?-1:1)}),q}for(v in ze.matches=function(tt,mt){return ze(tt,null,null,mt)},ze.matchesSelector=function(tt,mt){if(io(tt),ht&&!si[mt+" "]&&(!st||!st.test(mt)))try{var Pt=xt.call(tt,mt);if(Pt||A.disconnectedMatch||tt.document&&tt.document.nodeType!==11)return Pt}catch{si(mt,!0)}return 0<ze(mt,q,null,[tt]).length},ze.contains=function(tt,mt){return(tt.ownerDocument||tt)!=q&&io(tt),T.contains(tt,mt)},ze.attr=function(tt,mt){(tt.ownerDocument||tt)!=q&&io(tt);var Pt=S.attrHandle[mt.toLowerCase()],Nt=Pt&&L.call(S.attrHandle,mt.toLowerCase())?Pt(tt,mt,!ht):void 0;return Nt!==void 0?Nt:tt.getAttribute(mt)},ze.error=function(tt){throw new Error("Syntax error, unrecognized expression: "+tt)},T.uniqueSort=function(tt){var mt,Pt=[],Nt=0,Ht=0;if(V=!A.sortStable,R=!A.sortStable&&d.call(tt,0),$.call(tt,gi),V){for(;mt=tt[Ht++];)mt===tt[Ht]&&(Nt=Pt.push(Ht));for(;Nt--;)_t.call(tt,Pt[Nt],1)}return R=null,tt},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(d.apply(this)))},(S=T.expr={cacheLength:50,createPseudo:zr,match:Zn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(tt){return tt[1]=tt[1].replace(Yr,Bi),tt[3]=(tt[3]||tt[4]||tt[5]||"").replace(Yr,Bi),tt[2]==="~="&&(tt[3]=" "+tt[3]+" "),tt.slice(0,4)},CHILD:function(tt){return tt[1]=tt[1].toLowerCase(),tt[1].slice(0,3)==="nth"?(tt[3]||ze.error(tt[0]),tt[4]=+(tt[4]?tt[5]+(tt[6]||1):2*(tt[3]==="even"||tt[3]==="odd")),tt[5]=+(tt[7]+tt[8]||tt[3]==="odd")):tt[3]&&ze.error(tt[0]),tt},PSEUDO:function(tt){var mt,Pt=!tt[6]&&tt[2];return Zn.CHILD.test(tt[0])?null:(tt[3]?tt[2]=tt[4]||tt[5]||"":Pt&&ri.test(Pt)&&(mt=en(Pt,!0))&&(mt=Pt.indexOf(")",Pt.length-mt)-Pt.length)&&(tt[0]=tt[0].slice(0,mt),tt[2]=Pt.slice(0,mt)),tt.slice(0,3))}},filter:{TAG:function(tt){var mt=tt.replace(Yr,Bi).toLowerCase();return tt==="*"?function(){return!0}:function(Pt){return ut(Pt,mt)}},CLASS:function(tt){var mt=be[tt+" "];return mt||(mt=new RegExp("(^|"+W+")"+tt+"("+W+"|$)"))&&be(tt,function(Pt){return mt.test(typeof Pt.className=="string"&&Pt.className||typeof Pt.getAttribute<"u"&&Pt.getAttribute("class")||"")})},ATTR:function(tt,mt,Pt){return function(Nt){var Ht=ze.attr(Nt,tt);return Ht==null?mt==="!=":!mt||(Ht+="",mt==="="?Ht===Pt:mt==="!="?Ht!==Pt:mt==="^="?Pt&&Ht.indexOf(Pt)===0:mt==="*="?Pt&&-1<Ht.indexOf(Pt):mt==="$="?Pt&&Ht.slice(-Pt.length)===Pt:mt==="~="?-1<(" "+Ht.replace(rr," ")+" ").indexOf(Pt):mt==="|="&&(Ht===Pt||Ht.slice(0,Pt.length+1)===Pt+"-"))}},CHILD:function(tt,mt,Pt,Nt,Ht){var _e=tt.slice(0,3)!=="nth",we=tt.slice(-4)!=="last",Te=mt==="of-type";return Nt===1&&Ht===0?function(me){return!!me.parentNode}:function(me,_r,Ke){var er,wr,ie,ti,Ti,Si=_e!==we?"nextSibling":"previousSibling",Yi=me.parentNode,sn=Te&&me.nodeName.toLowerCase(),Zi=!Ke&&!Te,jr=!1;if(Yi){if(_e){for(;Si;){for(ie=me;ie=ie[Si];)if(Te?ut(ie,sn):ie.nodeType===1)return!1;Ti=Si=tt==="only"&&!Ti&&"nextSibling"}return!0}if(Ti=[we?Yi.firstChild:Yi.lastChild],we&&Zi){for(jr=(ti=(er=(wr=Yi[jt]||(Yi[jt]={}))[tt]||[])[0]===Et&&er[1])&&er[2],ie=ti&&Yi.childNodes[ti];ie=++ti&&ie&&ie[Si]||(jr=ti=0)||Ti.pop();)if(ie.nodeType===1&&++jr&&ie===me){wr[tt]=[Et,ti,jr];break}}else if(Zi&&(jr=ti=(er=(wr=me[jt]||(me[jt]={}))[tt]||[])[0]===Et&&er[1]),jr===!1)for(;(ie=++ti&&ie&&ie[Si]||(jr=ti=0)||Ti.pop())&&!((Te?ut(ie,sn):ie.nodeType===1)&&++jr&&(Zi&&((wr=ie[jt]||(ie[jt]={}))[tt]=[Et,jr]),ie===me)););return(jr-=Ht)===Nt||jr%Nt==0&&0<=jr/Nt}}},PSEUDO:function(tt,mt){var Pt,Nt=S.pseudos[tt]||S.setFilters[tt.toLowerCase()]||ze.error("unsupported pseudo: "+tt);return Nt[jt]?Nt(mt):1<Nt.length?(Pt=[tt,tt,"",mt],S.setFilters.hasOwnProperty(tt.toLowerCase())?zr(function(Ht,_e){for(var we,Te=Nt(Ht,mt),me=Te.length;me--;)Ht[we=x.call(Ht,Te[me])]=!(_e[we]=Te[me])}):function(Ht){return Nt(Ht,0,Pt)}):Nt}},pseudos:{not:zr(function(tt){var mt=[],Pt=[],Nt=Do(tt.replace(rt,"$1"));return Nt[jt]?zr(function(Ht,_e,we,Te){for(var me,_r=Nt(Ht,null,Te,[]),Ke=Ht.length;Ke--;)(me=_r[Ke])&&(Ht[Ke]=!(_e[Ke]=me))}):function(Ht,_e,we){return mt[0]=Ht,Nt(mt,null,we,Pt),mt[0]=null,!Pt.pop()}}),has:zr(function(tt){return function(mt){return 0<ze(tt,mt).length}}),contains:zr(function(tt){return tt=tt.replace(Yr,Bi),function(mt){return-1<(mt.textContent||T.text(mt)).indexOf(tt)}}),lang:zr(function(tt){return Fo.test(tt||"")||ze.error("unsupported lang: "+tt),tt=tt.replace(Yr,Bi).toLowerCase(),function(mt){var Pt;do if(Pt=ht?mt.lang:mt.getAttribute("xml:lang")||mt.getAttribute("lang"))return(Pt=Pt.toLowerCase())===tt||Pt.indexOf(tt+"-")===0;while((mt=mt.parentNode)&&mt.nodeType===1);return!1}}),target:function(tt){var mt=n.location&&n.location.hash;return mt&&mt.slice(1)===tt.id},root:function(tt){return tt===Y},focus:function(tt){return tt===function(){try{return q.activeElement}catch{}}()&&q.hasFocus()&&!!(tt.type||tt.href||~tt.tabIndex)},enabled:lo(!1),disabled:lo(!0),checked:function(tt){return ut(tt,"input")&&!!tt.checked||ut(tt,"option")&&!!tt.selected},selected:function(tt){return tt.parentNode&&tt.parentNode.selectedIndex,tt.selected===!0},empty:function(tt){for(tt=tt.firstChild;tt;tt=tt.nextSibling)if(tt.nodeType<6)return!1;return!0},parent:function(tt){return!S.pseudos.empty(tt)},header:function(tt){return hi.test(tt.nodeName)},input:function(tt){return ho.test(tt.nodeName)},button:function(tt){return ut(tt,"input")&&tt.type==="button"||ut(tt,"button")},text:function(tt){var mt;return ut(tt,"input")&&tt.type==="text"&&((mt=tt.getAttribute("type"))==null||mt.toLowerCase()==="text")},first:Bn(function(){return[0]}),last:Bn(function(tt,mt){return[mt-1]}),eq:Bn(function(tt,mt,Pt){return[Pt<0?Pt+mt:Pt]}),even:Bn(function(tt,mt){for(var Pt=0;Pt<mt;Pt+=2)tt.push(Pt);return tt}),odd:Bn(function(tt,mt){for(var Pt=1;Pt<mt;Pt+=2)tt.push(Pt);return tt}),lt:Bn(function(tt,mt,Pt){var Nt;for(Nt=Pt<0?Pt+mt:mt<Pt?mt:Pt;0<=--Nt;)tt.push(Nt);return tt}),gt:Bn(function(tt,mt,Pt){for(var Nt=Pt<0?Pt+mt:Pt;++Nt<mt;)tt.push(Nt);return tt})}}).pseudos.nth=S.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[v]=vn(v);for(v in{submit:!0,reset:!0})S.pseudos[v]=Ie(v);function Ss(){}function en(tt,mt){var Pt,Nt,Ht,_e,we,Te,me,_r=We[tt+" "];if(_r)return mt?0:_r.slice(0);for(we=tt,Te=[],me=S.preFilter;we;){for(_e in Pt&&!(Nt=Rr.exec(we))||(Nt&&(we=we.slice(Nt[0].length)||we),Te.push(Ht=[])),Pt=!1,(Nt=Gn.exec(we))&&(Pt=Nt.shift(),Ht.push({value:Pt,type:Nt[0].replace(rt," ")}),we=we.slice(Pt.length)),S.filter)!(Nt=Zn[_e].exec(we))||me[_e]&&!(Nt=me[_e](Nt))||(Pt=Nt.shift(),Ht.push({value:Pt,type:_e,matches:Nt}),we=we.slice(Pt.length));if(!Pt)break}return mt?we.length:we?ze.error(tt):We(tt,Te).slice(0)}function Zo(tt){for(var mt=0,Pt=tt.length,Nt="";mt<Pt;mt++)Nt+=tt[mt].value;return Nt}function mn(tt,mt,Pt){var Nt=mt.dir,Ht=mt.next,_e=Ht||Nt,we=Pt&&_e==="parentNode",Te=qt++;return mt.first?function(me,_r,Ke){for(;me=me[Nt];)if(me.nodeType===1||we)return tt(me,_r,Ke);return!1}:function(me,_r,Ke){var er,wr,ie=[Et,Te];if(Ke){for(;me=me[Nt];)if((me.nodeType===1||we)&&tt(me,_r,Ke))return!0}else for(;me=me[Nt];)if(me.nodeType===1||we)if(wr=me[jt]||(me[jt]={}),Ht&&ut(me,Ht))me=me[Nt]||me;else{if((er=wr[_e])&&er[0]===Et&&er[1]===Te)return ie[2]=er[2];if((wr[_e]=ie)[2]=tt(me,_r,Ke))return!0}return!1}}function es(tt){return 1<tt.length?function(mt,Pt,Nt){for(var Ht=tt.length;Ht--;)if(!tt[Ht](mt,Pt,Nt))return!1;return!0}:tt[0]}function On(tt,mt,Pt,Nt,Ht){for(var _e,we=[],Te=0,me=tt.length,_r=mt!=null;Te<me;Te++)(_e=tt[Te])&&(Pt&&!Pt(_e,Nt,Ht)||(we.push(_e),_r&&mt.push(Te)));return we}function mi(tt,mt,Pt,Nt,Ht,_e){return Nt&&!Nt[jt]&&(Nt=mi(Nt)),Ht&&!Ht[jt]&&(Ht=mi(Ht,_e)),zr(function(we,Te,me,_r){var Ke,er,wr,ie,ti=[],Ti=[],Si=Te.length,Yi=we||function(Zi,jr,an){for(var ji=0,zn=jr.length;ji<zn;ji++)ze(Zi,jr[ji],an);return an}(mt||"*",me.nodeType?[me]:me,[]),sn=!tt||!we&&mt?Yi:On(Yi,ti,tt,me,_r);if(Pt?Pt(sn,ie=Ht||(we?tt:Si||Nt)?[]:Te,me,_r):ie=sn,Nt)for(Ke=On(ie,Ti),Nt(Ke,[],me,_r),er=Ke.length;er--;)(wr=Ke[er])&&(ie[Ti[er]]=!(sn[Ti[er]]=wr));if(we){if(Ht||tt){if(Ht){for(Ke=[],er=ie.length;er--;)(wr=ie[er])&&Ke.push(sn[er]=wr);Ht(null,ie=[],Ke,_r)}for(er=ie.length;er--;)(wr=ie[er])&&-1<(Ke=Ht?x.call(we,wr):ti[er])&&(we[Ke]=!(Te[Ke]=wr))}}else ie=On(ie===Te?ie.splice(Si,ie.length):ie),Ht?Ht(null,Te,ie,_r):Tt.apply(Te,ie)})}function Es(tt){for(var mt,Pt,Nt,Ht=tt.length,_e=S.relative[tt[0].type],we=_e||S.relative[" "],Te=_e?1:0,me=mn(function(er){return er===mt},we,!0),_r=mn(function(er){return-1<x.call(mt,er)},we,!0),Ke=[function(er,wr,ie){var ti=!_e&&(ie||wr!=M)||((mt=wr).nodeType?me(er,wr,ie):_r(er,wr,ie));return mt=null,ti}];Te<Ht;Te++)if(Pt=S.relative[tt[Te].type])Ke=[mn(es(Ke),Pt)];else{if((Pt=S.filter[tt[Te].type].apply(null,tt[Te].matches))[jt]){for(Nt=++Te;Nt<Ht&&!S.relative[tt[Nt].type];Nt++);return mi(1<Te&&es(Ke),1<Te&&Zo(tt.slice(0,Te-1).concat({value:tt[Te-2].type===" "?"*":""})).replace(rt,"$1"),Pt,Te<Nt&&Es(tt.slice(Te,Nt)),Nt<Ht&&Es(tt=tt.slice(Nt)),Nt<Ht&&Zo(tt))}Ke.push(Pt)}return es(Ke)}function Do(tt,mt){var Pt,Nt,Ht,_e,we,Te,me=[],_r=[],Ke=Ze[tt+" "];if(!Ke){for(mt||(mt=en(tt)),Pt=mt.length;Pt--;)(Ke=Es(mt[Pt]))[jt]?me.push(Ke):_r.push(Ke);(Ke=Ze(tt,(Nt=_r,_e=0<(Ht=me).length,we=0<Nt.length,Te=function(er,wr,ie,ti,Ti){var Si,Yi,sn,Zi=0,jr="0",an=er&&[],ji=[],zn=M,xo=er||we&&S.find.TAG("*",Ti),Vi=Et+=zn==null?1:Math.random()||.1,$n=xo.length;for(Ti&&(M=wr==q||wr||Ti);jr!==$n&&(Si=xo[jr])!=null;jr++){if(we&&Si){for(Yi=0,wr||Si.ownerDocument==q||(io(Si),ie=!ht);sn=Nt[Yi++];)if(sn(Si,wr||q,ie)){Tt.call(ti,Si);break}Ti&&(Et=Vi)}_e&&((Si=!sn&&Si)&&Zi--,er&&an.push(Si))}if(Zi+=jr,_e&&jr!==Zi){for(Yi=0;sn=Ht[Yi++];)sn(an,ji,wr,ie);if(er){if(0<Zi)for(;jr--;)an[jr]||ji[jr]||(ji[jr]=ft.call(ti));ji=On(ji)}Tt.apply(ti,ji),Ti&&!er&&0<ji.length&&1<Zi+Ht.length&&T.uniqueSort(ti)}return Ti&&(Et=Vi,M=zn),an},_e?zr(Te):Te))).selector=tt}return Ke}function ia(tt,mt,Pt,Nt){var Ht,_e,we,Te,me,_r=typeof tt=="function"&&tt,Ke=!Nt&&en(tt=_r.selector||tt);if(Pt=Pt||[],Ke.length===1){if(2<(_e=Ke[0]=Ke[0].slice(0)).length&&(we=_e[0]).type==="ID"&&mt.nodeType===9&&ht&&S.relative[_e[1].type]){if(!(mt=(S.find.ID(we.matches[0].replace(Yr,Bi),mt)||[])[0]))return Pt;_r&&(mt=mt.parentNode),tt=tt.slice(_e.shift().value.length)}for(Ht=Zn.needsContext.test(tt)?0:_e.length;Ht--&&(we=_e[Ht],!S.relative[Te=we.type]);)if((me=S.find[Te])&&(Nt=me(we.matches[0].replace(Yr,Bi),bi.test(_e[0].type)&&bs(mt.parentNode)||mt))){if(_e.splice(Ht,1),!(tt=Nt.length&&Zo(_e)))return Tt.apply(Pt,Nt),Pt;break}}return(_r||Do(tt,Ke))(Nt,mt,!ht,Pt,!mt||bi.test(tt)&&bs(mt.parentNode)||mt),Pt}Ss.prototype=S.filters=S.pseudos,S.setFilters=new Ss,A.sortStable=jt.split("").sort(gi).join("")===jt,io(),A.sortDetached=qr(function(tt){return 1&tt.compareDocumentPosition(q.createElement("fieldset"))}),T.find=ze,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,ze.compile=Do,ze.select=ia,ze.setDocument=io,ze.tokenize=en,ze.escape=T.escapeSelector,ze.getText=T.text,ze.isXML=T.isXMLDoc,ze.selectors=T.expr,ze.support=T.support,ze.uniqueSort=T.uniqueSort})();var Vt=function(v,S,M){for(var R=[],V=M!==void 0;(v=v[S])&&v.nodeType!==9;)if(v.nodeType===1){if(V&&T(v).is(M))break;R.push(v)}return R},Lt=function(v,S){for(var M=[];v;v=v.nextSibling)v.nodeType===1&&v!==S&&M.push(v);return M},Ne=T.expr.match.needsContext,ge=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Yt(v,S,M){return G(S)?T.grep(v,function(R,V){return!!S.call(R,V,R)!==M}):S.nodeType?T.grep(v,function(R){return R===S!==M}):typeof S!="string"?T.grep(v,function(R){return-1<x.call(S,R)!==M}):T.filter(S,v,M)}T.filter=function(v,S,M){var R=S[0];return M&&(v=":not("+v+")"),S.length===1&&R.nodeType===1?T.find.matchesSelector(R,v)?[R]:[]:T.find.matches(v,T.grep(S,function(V){return V.nodeType===1}))},T.fn.extend({find:function(v){var S,M,R=this.length,V=this;if(typeof v!="string")return this.pushStack(T(v).filter(function(){for(S=0;S<R;S++)if(T.contains(V[S],this))return!0}));for(M=this.pushStack([]),S=0;S<R;S++)T.find(v,V[S],M);return 1<R?T.uniqueSort(M):M},filter:function(v){return this.pushStack(Yt(this,v||[],!1))},not:function(v){return this.pushStack(Yt(this,v||[],!0))},is:function(v){return!!Yt(this,typeof v=="string"&&Ne.test(v)?T(v):v||[],!1).length}});var ue,ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.init=function(v,S,M){var R,V;if(!v)return this;if(M=M||ue,typeof v=="string"){if(!(R=v[0]==="<"&&v[v.length-1]===">"&&3<=v.length?[null,v,null]:ne.exec(v))||!R[1]&&S)return!S||S.jquery?(S||M).find(v):this.constructor(S).find(v);if(R[1]){if(S=S instanceof T?S[0]:S,T.merge(this,T.parseHTML(R[1],S&&S.nodeType?S.ownerDocument||S:O,!0)),ge.test(R[1])&&T.isPlainObject(S))for(R in S)G(this[R])?this[R](S[R]):this.attr(R,S[R]);return this}return(V=O.getElementById(R[2]))&&(this[0]=V,this.length=1),this}return v.nodeType?(this[0]=v,this.length=1,this):G(v)?M.ready!==void 0?M.ready(v):v(T):T.makeArray(v,this)}).prototype=T.fn,ue=T(O);var dr=/^(?:parents|prev(?:Until|All))/,je={children:!0,contents:!0,next:!0,prev:!0};function Br(v,S){for(;(v=v[S])&&v.nodeType!==1;);return v}T.fn.extend({has:function(v){var S=T(v,this),M=S.length;return this.filter(function(){for(var R=0;R<M;R++)if(T.contains(this,S[R]))return!0})},closest:function(v,S){var M,R=0,V=this.length,q=[],Y=typeof v!="string"&&T(v);if(!Ne.test(v)){for(;R<V;R++)for(M=this[R];M&&M!==S;M=M.parentNode)if(M.nodeType<11&&(Y?-1<Y.index(M):M.nodeType===1&&T.find.matchesSelector(M,v))){q.push(M);break}}return this.pushStack(1<q.length?T.uniqueSort(q):q)},index:function(v){return v?typeof v=="string"?x.call(T(v),this[0]):x.call(this,v.jquery?v[0]:v):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(v,S){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(v,S))))},addBack:function(v){return this.add(v==null?this.prevObject:this.prevObject.filter(v))}}),T.each({parent:function(v){var S=v.parentNode;return S&&S.nodeType!==11?S:null},parents:function(v){return Vt(v,"parentNode")},parentsUntil:function(v,S,M){return Vt(v,"parentNode",M)},next:function(v){return Br(v,"nextSibling")},prev:function(v){return Br(v,"previousSibling")},nextAll:function(v){return Vt(v,"nextSibling")},prevAll:function(v){return Vt(v,"previousSibling")},nextUntil:function(v,S,M){return Vt(v,"nextSibling",M)},prevUntil:function(v,S,M){return Vt(v,"previousSibling",M)},siblings:function(v){return Lt((v.parentNode||{}).firstChild,v)},children:function(v){return Lt(v.firstChild)},contents:function(v){return v.contentDocument!=null&&u(v.contentDocument)?v.contentDocument:(ut(v,"template")&&(v=v.content||v),T.merge([],v.childNodes))}},function(v,S){T.fn[v]=function(M,R){var V=T.map(this,S,M);return v.slice(-5)!=="Until"&&(R=M),R&&typeof R=="string"&&(V=T.filter(R,V)),1<this.length&&(je[v]||T.uniqueSort(V),dr.test(v)&&V.reverse()),this.pushStack(V)}});var Ue=/[^\x20\t\r\n\f]+/g;function Fe(v){return v}function Lr(v){throw v}function De(v,S,M,R){var V;try{v&&G(V=v.promise)?V.call(v).done(S).fail(M):v&&G(V=v.then)?V.call(v,S,M):S.apply(void 0,[v].slice(R))}catch(q){M.apply(void 0,[q])}}T.Callbacks=function(v){var S,M;v=typeof v=="string"?(S=v,M={},T.each(S.match(Ue)||[],function(Et,qt){M[qt]=!0}),M):T.extend({},v);var R,V,q,Y,ht=[],st=[],xt=-1,Tt=function(){for(Y=Y||v.once,q=R=!0;st.length;xt=-1)for(V=st.shift();++xt<ht.length;)ht[xt].apply(V[0],V[1])===!1&&v.stopOnFalse&&(xt=ht.length,V=!1);v.memory||(V=!1),R=!1,Y&&(ht=V?[]:"")},jt={add:function(){return ht&&(V&&!R&&(xt=ht.length-1,st.push(V)),function Et(qt){T.each(qt,function(be,We){G(We)?v.unique&&jt.has(We)||ht.push(We):We&&We.length&&et(We)!=="string"&&Et(We)})}(arguments),V&&!R&&Tt()),this},remove:function(){return T.each(arguments,function(Et,qt){for(var be;-1<(be=T.inArray(qt,ht,be));)ht.splice(be,1),be<=xt&&xt--}),this},has:function(Et){return Et?-1<T.inArray(Et,ht):0<ht.length},empty:function(){return ht&&(ht=[]),this},disable:function(){return Y=st=[],ht=V="",this},disabled:function(){return!ht},lock:function(){return Y=st=[],V||R||(ht=V=""),this},locked:function(){return!!Y},fireWith:function(Et,qt){return Y||(qt=[Et,(qt=qt||[]).slice?qt.slice():qt],st.push(qt),R||Tt()),this},fire:function(){return jt.fireWith(this,arguments),this},fired:function(){return!!q}};return jt},T.extend({Deferred:function(v){var S=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],M="pending",R={state:function(){return M},always:function(){return V.done(arguments).fail(arguments),this},catch:function(q){return R.then(null,q)},pipe:function(){var q=arguments;return T.Deferred(function(Y){T.each(S,function(ht,st){var xt=G(q[st[4]])&&q[st[4]];V[st[1]](function(){var Tt=xt&&xt.apply(this,arguments);Tt&&G(Tt.promise)?Tt.promise().progress(Y.notify).done(Y.resolve).fail(Y.reject):Y[st[0]+"With"](this,xt?[Tt]:arguments)})}),q=null}).promise()},then:function(q,Y,ht){var st=0;function xt(Tt,jt,Et,qt){return function(){var be=this,We=arguments,Ze=function(){var gi,dn;if(!(Tt<st)){if((gi=Et.apply(be,We))===jt.promise())throw new TypeError("Thenable self-resolution");dn=gi&&(typeof gi=="object"||typeof gi=="function")&&gi.then,G(dn)?qt?dn.call(gi,xt(st,jt,Fe,qt),xt(st,jt,Lr,qt)):(st++,dn.call(gi,xt(st,jt,Fe,qt),xt(st,jt,Lr,qt),xt(st,jt,Fe,jt.notifyWith))):(Et!==Fe&&(be=void 0,We=[gi]),(qt||jt.resolveWith)(be,We))}},si=qt?Ze:function(){try{Ze()}catch(gi){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(gi,si.error),st<=Tt+1&&(Et!==Lr&&(be=void 0,We=[gi]),jt.rejectWith(be,We))}};Tt?si():(T.Deferred.getErrorHook?si.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(si.error=T.Deferred.getStackHook()),n.setTimeout(si))}}return T.Deferred(function(Tt){S[0][3].add(xt(0,Tt,G(ht)?ht:Fe,Tt.notifyWith)),S[1][3].add(xt(0,Tt,G(q)?q:Fe)),S[2][3].add(xt(0,Tt,G(Y)?Y:Lr))}).promise()},promise:function(q){return q!=null?T.extend(q,R):R}},V={};return T.each(S,function(q,Y){var ht=Y[2],st=Y[5];R[Y[1]]=ht.add,st&&ht.add(function(){M=st},S[3-q][2].disable,S[3-q][3].disable,S[0][2].lock,S[0][3].lock),ht.add(Y[3].fire),V[Y[0]]=function(){return V[Y[0]+"With"](this===V?void 0:this,arguments),this},V[Y[0]+"With"]=ht.fireWith}),R.promise(V),v&&v.call(V,V),V},when:function(v){var S=arguments.length,M=S,R=Array(M),V=d.call(arguments),q=T.Deferred(),Y=function(ht){return function(st){R[ht]=this,V[ht]=1<arguments.length?d.call(arguments):st,--S||q.resolveWith(R,V)}};if(S<=1&&(De(v,q.done(Y(M)).resolve,q.reject,!S),q.state()==="pending"||G(V[M]&&V[M].then)))return q.then();for(;M--;)De(V[M],Y(M),q.reject);return q.promise()}});var se=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(v,S){n.console&&n.console.warn&&v&&se.test(v.name)&&n.console.warn("jQuery.Deferred exception: "+v.message,v.stack,S)},T.readyException=function(v){n.setTimeout(function(){throw v})};var oe=T.Deferred();function Ar(){O.removeEventListener("DOMContentLoaded",Ar),n.removeEventListener("load",Ar),T.ready()}T.fn.ready=function(v){return oe.then(v).catch(function(S){T.readyException(S)}),this},T.extend({isReady:!1,readyWait:1,ready:function(v){(v===!0?--T.readyWait:T.isReady)||(T.isReady=!0)!==v&&0<--T.readyWait||oe.resolveWith(O,[T])}}),T.ready.then=oe.then,O.readyState==="complete"||O.readyState!=="loading"&&!O.documentElement.doScroll?n.setTimeout(T.ready):(O.addEventListener("DOMContentLoaded",Ar),n.addEventListener("load",Ar));var vr=function(v,S,M,R,V,q,Y){var ht=0,st=v.length,xt=M==null;if(et(M)==="object")for(ht in V=!0,M)vr(v,S,ht,M[ht],!0,q,Y);else if(R!==void 0&&(V=!0,G(R)||(Y=!0),xt&&(Y?(S.call(v,R),S=null):(xt=S,S=function(Tt,jt,Et){return xt.call(T(Tt),Et)})),S))for(;ht<st;ht++)S(v[ht],M,Y?R:R.call(v[ht],ht,S(v[ht],M)));return V?v:xt?S.call(v):st?S(v[0],M):q},Kr=/^-ms-/,wi=/-([a-z])/g;function Ee(v,S){return S.toUpperCase()}function Sr(v){return v.replace(Kr,"ms-").replace(wi,Ee)}var Or=function(v){return v.nodeType===1||v.nodeType===9||!+v.nodeType};function xn(){this.expando=T.expando+xn.uid++}xn.uid=1,xn.prototype={cache:function(v){var S=v[this.expando];return S||(S={},Or(v)&&(v.nodeType?v[this.expando]=S:Object.defineProperty(v,this.expando,{value:S,configurable:!0}))),S},set:function(v,S,M){var R,V=this.cache(v);if(typeof S=="string")V[Sr(S)]=M;else for(R in S)V[Sr(R)]=S[R];return V},get:function(v,S){return S===void 0?this.cache(v):v[this.expando]&&v[this.expando][Sr(S)]},access:function(v,S,M){return S===void 0||S&&typeof S=="string"&&M===void 0?this.get(v,S):(this.set(v,S,M),M!==void 0?M:S)},remove:function(v,S){var M,R=v[this.expando];if(R!==void 0){if(S!==void 0)for(M=(S=Array.isArray(S)?S.map(Sr):(S=Sr(S))in R?[S]:S.match(Ue)||[]).length;M--;)delete R[S[M]];(S===void 0||T.isEmptyObject(R))&&(v.nodeType?v[this.expando]=void 0:delete v[this.expando])}},hasData:function(v){var S=v[this.expando];return S!==void 0&&!T.isEmptyObject(S)}};var ye=new xn,oi=new xn,eo=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Xo=/[A-Z]/g;function Xn(v,S,M){var R,V;if(M===void 0&&v.nodeType===1)if(R="data-"+S.replace(Xo,"-$&").toLowerCase(),typeof(M=v.getAttribute(R))=="string"){try{M=(V=M)==="true"||V!=="false"&&(V==="null"?null:V===+V+""?+V:eo.test(V)?JSON.parse(V):V)}catch{}oi.set(v,S,M)}else M=void 0;return M}T.extend({hasData:function(v){return oi.hasData(v)||ye.hasData(v)},data:function(v,S,M){return oi.access(v,S,M)},removeData:function(v,S){oi.remove(v,S)},_data:function(v,S,M){return ye.access(v,S,M)},_removeData:function(v,S){ye.remove(v,S)}}),T.fn.extend({data:function(v,S){var M,R,V,q=this[0],Y=q&&q.attributes;if(v===void 0){if(this.length&&(V=oi.get(q),q.nodeType===1&&!ye.get(q,"hasDataAttrs"))){for(M=Y.length;M--;)Y[M]&&(R=Y[M].name).indexOf("data-")===0&&(R=Sr(R.slice(5)),Xn(q,R,V[R]));ye.set(q,"hasDataAttrs",!0)}return V}return typeof v=="object"?this.each(function(){oi.set(this,v)}):vr(this,function(ht){var st;if(q&&ht===void 0)return(st=oi.get(q,v))!==void 0||(st=Xn(q,v))!==void 0?st:void 0;this.each(function(){oi.set(this,v,ht)})},null,S,1<arguments.length,null,!0)},removeData:function(v){return this.each(function(){oi.remove(this,v)})}}),T.extend({queue:function(v,S,M){var R;if(v)return S=(S||"fx")+"queue",R=ye.get(v,S),M&&(!R||Array.isArray(M)?R=ye.access(v,S,T.makeArray(M)):R.push(M)),R||[]},dequeue:function(v,S){S=S||"fx";var M=T.queue(v,S),R=M.length,V=M.shift(),q=T._queueHooks(v,S);V==="inprogress"&&(V=M.shift(),R--),V&&(S==="fx"&&M.unshift("inprogress"),delete q.stop,V.call(v,function(){T.dequeue(v,S)},q)),!R&&q&&q.empty.fire()},_queueHooks:function(v,S){var M=S+"queueHooks";return ye.get(v,M)||ye.access(v,M,{empty:T.Callbacks("once memory").add(function(){ye.remove(v,[S+"queue",M])})})}}),T.fn.extend({queue:function(v,S){var M=2;return typeof v!="string"&&(S=v,v="fx",M--),arguments.length<M?T.queue(this[0],v):S===void 0?this:this.each(function(){var R=T.queue(this,v,S);T._queueHooks(this,v),v==="fx"&&R[0]!=="inprogress"&&T.dequeue(this,v)})},dequeue:function(v){return this.each(function(){T.dequeue(this,v)})},clearQueue:function(v){return this.queue(v||"fx",[])},promise:function(v,S){var M,R=1,V=T.Deferred(),q=this,Y=this.length,ht=function(){--R||V.resolveWith(q,[q])};for(typeof v!="string"&&(S=v,v=void 0),v=v||"fx";Y--;)(M=ye.get(q[Y],v+"queueHooks"))&&M.empty&&(R++,M.empty.add(ht));return ht(),V.promise(S)}});var cn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ft=new RegExp("^(?:([+-])=|)("+cn+")([a-z%]*)$","i"),Ot=["Top","Right","Bottom","Left"],Kt=O.documentElement,ae=function(v){return T.contains(v.ownerDocument,v)},Ve={composed:!0};Kt.getRootNode&&(ae=function(v){return T.contains(v.ownerDocument,v)||v.getRootNode(Ve)===v.ownerDocument});var Be=function(v,S){return(v=S||v).style.display==="none"||v.style.display===""&&ae(v)&&T.css(v,"display")==="none"};function Er(v,S,M,R){var V,q,Y=20,ht=R?function(){return R.cur()}:function(){return T.css(v,S,"")},st=ht(),xt=M&&M[3]||(T.cssNumber[S]?"":"px"),Tt=v.nodeType&&(T.cssNumber[S]||xt!=="px"&&+st)&&Ft.exec(T.css(v,S));if(Tt&&Tt[3]!==xt){for(st/=2,xt=xt||Tt[3],Tt=+st||1;Y--;)T.style(v,S,Tt+xt),(1-q)*(1-(q=ht()/st||.5))<=0&&(Y=0),Tt/=q;Tt*=2,T.style(v,S,Tt+xt),M=M||[]}return M&&(Tt=+Tt||+st||0,V=M[1]?Tt+(M[1]+1)*M[2]:+M[2],R&&(R.unit=xt,R.start=Tt,R.end=V)),V}var br={};function Oe(v,S){for(var M,R,V,q,Y,ht,st,xt=[],Tt=0,jt=v.length;Tt<jt;Tt++)(R=v[Tt]).style&&(M=R.style.display,S?(M==="none"&&(xt[Tt]=ye.get(R,"display")||null,xt[Tt]||(R.style.display="")),R.style.display===""&&Be(R)&&(xt[Tt]=(st=Y=q=void 0,Y=(V=R).ownerDocument,ht=V.nodeName,(st=br[ht])||(q=Y.body.appendChild(Y.createElement(ht)),st=T.css(q,"display"),q.parentNode.removeChild(q),st==="none"&&(st="block"),br[ht]=st)))):M!=="none"&&(xt[Tt]="none",ye.set(R,"display",M)));for(Tt=0;Tt<jt;Tt++)xt[Tt]!=null&&(v[Tt].style.display=xt[Tt]);return v}T.fn.extend({show:function(){return Oe(this,!0)},hide:function(){return Oe(this)},toggle:function(v){return typeof v=="boolean"?v?this.show():this.hide():this.each(function(){Be(this)?T(this).show():T(this).hide()})}});var ur,ar,ot=/^(?:checkbox|radio)$/i,zt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Wt=/^$|^module$|\/(?:java|ecma)script/i;ur=O.createDocumentFragment().appendChild(O.createElement("div")),(ar=O.createElement("input")).setAttribute("type","radio"),ar.setAttribute("checked","checked"),ar.setAttribute("name","t"),ur.appendChild(ar),A.checkClone=ur.cloneNode(!0).cloneNode(!0).lastChild.checked,ur.innerHTML="<textarea>x</textarea>",A.noCloneChecked=!!ur.cloneNode(!0).lastChild.defaultValue,ur.innerHTML="<option></option>",A.option=!!ur.lastChild;var Ut={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(v,S){var M;return M=typeof v.getElementsByTagName<"u"?v.getElementsByTagName(S||"*"):typeof v.querySelectorAll<"u"?v.querySelectorAll(S||"*"):[],S===void 0||S&&ut(v,S)?T.merge([v],M):M}function Se(v,S){for(var M=0,R=v.length;M<R;M++)ye.set(v[M],"globalEval",!S||ye.get(S[M],"globalEval"))}Ut.tbody=Ut.tfoot=Ut.colgroup=Ut.caption=Ut.thead,Ut.th=Ut.td,A.option||(Ut.optgroup=Ut.option=[1,"<select multiple='multiple'>","</select>"]);var nr=/<|&#?\w+;/;function xr(v,S,M,R,V){for(var q,Y,ht,st,xt,Tt,jt=S.createDocumentFragment(),Et=[],qt=0,be=v.length;qt<be;qt++)if((q=v[qt])||q===0)if(et(q)==="object")T.merge(Et,q.nodeType?[q]:q);else if(nr.test(q)){for(Y=Y||jt.appendChild(S.createElement("div")),ht=(zt.exec(q)||["",""])[1].toLowerCase(),st=Ut[ht]||Ut._default,Y.innerHTML=st[1]+T.htmlPrefilter(q)+st[2],Tt=st[0];Tt--;)Y=Y.lastChild;T.merge(Et,Y.childNodes),(Y=jt.firstChild).textContent=""}else Et.push(S.createTextNode(q));for(jt.textContent="",qt=0;q=Et[qt++];)if(R&&-1<T.inArray(q,R))V&&V.push(q);else if(xt=ae(q),Y=ve(jt.appendChild(q),"script"),xt&&Se(Y),M)for(Tt=0;q=Y[Tt++];)Wt.test(q.type||"")&&M.push(q);return jt}var Me=/^([^.]*)(?:\.(.+)|)/;function ei(){return!0}function fr(){return!1}function Mr(v,S,M,R,V,q){var Y,ht;if(typeof S=="object"){for(ht in typeof M!="string"&&(R=R||M,M=void 0),S)Mr(v,ht,M,R,S[ht],q);return v}if(R==null&&V==null?(V=M,R=M=void 0):V==null&&(typeof M=="string"?(V=R,R=void 0):(V=R,R=M,M=void 0)),V===!1)V=fr;else if(!V)return v;return q===1&&(Y=V,(V=function(st){return T().off(st),Y.apply(this,arguments)}).guid=Y.guid||(Y.guid=T.guid++)),v.each(function(){T.event.add(this,S,V,R,M)})}function hr(v,S,M){M?(ye.set(v,S,!1),T.event.add(v,S,{namespace:!1,handler:function(R){var V,q=ye.get(this,S);if(1&R.isTrigger&&this[S]){if(q)(T.event.special[S]||{}).delegateType&&R.stopPropagation();else if(q=d.call(arguments),ye.set(this,S,q),this[S](),V=ye.get(this,S),ye.set(this,S,!1),q!==V)return R.stopImmediatePropagation(),R.preventDefault(),V}else q&&(ye.set(this,S,T.event.trigger(q[0],q.slice(1),this)),R.stopPropagation(),R.isImmediatePropagationStopped=ei)}})):ye.get(v,S)===void 0&&T.event.add(v,S,ei)}T.event={global:{},add:function(v,S,M,R,V){var q,Y,ht,st,xt,Tt,jt,Et,qt,be,We,Ze=ye.get(v);if(Or(v))for(M.handler&&(M=(q=M).handler,V=q.selector),V&&T.find.matchesSelector(Kt,V),M.guid||(M.guid=T.guid++),(st=Ze.events)||(st=Ze.events=Object.create(null)),(Y=Ze.handle)||(Y=Ze.handle=function(si){return typeof T<"u"&&T.event.triggered!==si.type?T.event.dispatch.apply(v,arguments):void 0}),xt=(S=(S||"").match(Ue)||[""]).length;xt--;)qt=We=(ht=Me.exec(S[xt])||[])[1],be=(ht[2]||"").split(".").sort(),qt&&(jt=T.event.special[qt]||{},qt=(V?jt.delegateType:jt.bindType)||qt,jt=T.event.special[qt]||{},Tt=T.extend({type:qt,origType:We,data:R,handler:M,guid:M.guid,selector:V,needsContext:V&&T.expr.match.needsContext.test(V),namespace:be.join(".")},q),(Et=st[qt])||((Et=st[qt]=[]).delegateCount=0,jt.setup&&jt.setup.call(v,R,be,Y)!==!1||v.addEventListener&&v.addEventListener(qt,Y)),jt.add&&(jt.add.call(v,Tt),Tt.handler.guid||(Tt.handler.guid=M.guid)),V?Et.splice(Et.delegateCount++,0,Tt):Et.push(Tt),T.event.global[qt]=!0)},remove:function(v,S,M,R,V){var q,Y,ht,st,xt,Tt,jt,Et,qt,be,We,Ze=ye.hasData(v)&&ye.get(v);if(Ze&&(st=Ze.events)){for(xt=(S=(S||"").match(Ue)||[""]).length;xt--;)if(qt=We=(ht=Me.exec(S[xt])||[])[1],be=(ht[2]||"").split(".").sort(),qt){for(jt=T.event.special[qt]||{},Et=st[qt=(R?jt.delegateType:jt.bindType)||qt]||[],ht=ht[2]&&new RegExp("(^|\\.)"+be.join("\\.(?:.*\\.|)")+"(\\.|$)"),Y=q=Et.length;q--;)Tt=Et[q],!V&&We!==Tt.origType||M&&M.guid!==Tt.guid||ht&&!ht.test(Tt.namespace)||R&&R!==Tt.selector&&(R!=="**"||!Tt.selector)||(Et.splice(q,1),Tt.selector&&Et.delegateCount--,jt.remove&&jt.remove.call(v,Tt));Y&&!Et.length&&(jt.teardown&&jt.teardown.call(v,be,Ze.handle)!==!1||T.removeEvent(v,qt,Ze.handle),delete st[qt])}else for(qt in st)T.event.remove(v,qt+S[xt],M,R,!0);T.isEmptyObject(st)&&ye.remove(v,"handle events")}},dispatch:function(v){var S,M,R,V,q,Y,ht=new Array(arguments.length),st=T.event.fix(v),xt=(ye.get(this,"events")||Object.create(null))[st.type]||[],Tt=T.event.special[st.type]||{};for(ht[0]=st,S=1;S<arguments.length;S++)ht[S]=arguments[S];if(st.delegateTarget=this,!Tt.preDispatch||Tt.preDispatch.call(this,st)!==!1){for(Y=T.event.handlers.call(this,st,xt),S=0;(V=Y[S++])&&!st.isPropagationStopped();)for(st.currentTarget=V.elem,M=0;(q=V.handlers[M++])&&!st.isImmediatePropagationStopped();)st.rnamespace&&q.namespace!==!1&&!st.rnamespace.test(q.namespace)||(st.handleObj=q,st.data=q.data,(R=((T.event.special[q.origType]||{}).handle||q.handler).apply(V.elem,ht))!==void 0&&(st.result=R)===!1&&(st.preventDefault(),st.stopPropagation()));return Tt.postDispatch&&Tt.postDispatch.call(this,st),st.result}},handlers:function(v,S){var M,R,V,q,Y,ht=[],st=S.delegateCount,xt=v.target;if(st&&xt.nodeType&&!(v.type==="click"&&1<=v.button)){for(;xt!==this;xt=xt.parentNode||this)if(xt.nodeType===1&&(v.type!=="click"||xt.disabled!==!0)){for(q=[],Y={},M=0;M<st;M++)Y[V=(R=S[M]).selector+" "]===void 0&&(Y[V]=R.needsContext?-1<T(V,this).index(xt):T.find(V,this,null,[xt]).length),Y[V]&&q.push(R);q.length&&ht.push({elem:xt,handlers:q})}}return xt=this,st<S.length&&ht.push({elem:xt,handlers:S.slice(st)}),ht},addProp:function(v,S){Object.defineProperty(T.Event.prototype,v,{enumerable:!0,configurable:!0,get:G(S)?function(){if(this.originalEvent)return S(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[v]},set:function(M){Object.defineProperty(this,v,{enumerable:!0,configurable:!0,writable:!0,value:M})}})},fix:function(v){return v[T.expando]?v:new T.Event(v)},special:{load:{noBubble:!0},click:{setup:function(v){var S=this||v;return ot.test(S.type)&&S.click&&ut(S,"input")&&hr(S,"click",!0),!1},trigger:function(v){var S=this||v;return ot.test(S.type)&&S.click&&ut(S,"input")&&hr(S,"click"),!0},_default:function(v){var S=v.target;return ot.test(S.type)&&S.click&&ut(S,"input")&&ye.get(S,"click")||ut(S,"a")}},beforeunload:{postDispatch:function(v){v.result!==void 0&&v.originalEvent&&(v.originalEvent.returnValue=v.result)}}}},T.removeEvent=function(v,S,M){v.removeEventListener&&v.removeEventListener(S,M)},T.Event=function(v,S){if(!(this instanceof T.Event))return new T.Event(v,S);v&&v.type?(this.originalEvent=v,this.type=v.type,this.isDefaultPrevented=v.defaultPrevented||v.defaultPrevented===void 0&&v.returnValue===!1?ei:fr,this.target=v.target&&v.target.nodeType===3?v.target.parentNode:v.target,this.currentTarget=v.currentTarget,this.relatedTarget=v.relatedTarget):this.type=v,S&&T.extend(this,S),this.timeStamp=v&&v.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:fr,isPropagationStopped:fr,isImmediatePropagationStopped:fr,isSimulated:!1,preventDefault:function(){var v=this.originalEvent;this.isDefaultPrevented=ei,v&&!this.isSimulated&&v.preventDefault()},stopPropagation:function(){var v=this.originalEvent;this.isPropagationStopped=ei,v&&!this.isSimulated&&v.stopPropagation()},stopImmediatePropagation:function(){var v=this.originalEvent;this.isImmediatePropagationStopped=ei,v&&!this.isSimulated&&v.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},function(v,S){function M(R){if(O.documentMode){var V=ye.get(this,"handle"),q=T.event.fix(R);q.type=R.type==="focusin"?"focus":"blur",q.isSimulated=!0,V(R),q.target===q.currentTarget&&V(q)}else T.event.simulate(S,R.target,T.event.fix(R))}T.event.special[v]={setup:function(){var R;if(hr(this,v,!0),!O.documentMode)return!1;(R=ye.get(this,S))||this.addEventListener(S,M),ye.set(this,S,(R||0)+1)},trigger:function(){return hr(this,v),!0},teardown:function(){var R;if(!O.documentMode)return!1;(R=ye.get(this,S)-1)?ye.set(this,S,R):(this.removeEventListener(S,M),ye.remove(this,S))},_default:function(R){return ye.get(R.target,v)},delegateType:S},T.event.special[S]={setup:function(){var R=this.ownerDocument||this.document||this,V=O.documentMode?this:R,q=ye.get(V,S);q||(O.documentMode?this.addEventListener(S,M):R.addEventListener(v,M,!0)),ye.set(V,S,(q||0)+1)},teardown:function(){var R=this.ownerDocument||this.document||this,V=O.documentMode?this:R,q=ye.get(V,S)-1;q?ye.set(V,S,q):(O.documentMode?this.removeEventListener(S,M):R.removeEventListener(v,M,!0),ye.remove(V,S))}}}),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(v,S){T.event.special[v]={delegateType:S,bindType:S,handle:function(M){var R,V=M.relatedTarget,q=M.handleObj;return V&&(V===this||T.contains(this,V))||(M.type=q.origType,R=q.handler.apply(this,arguments),M.type=S),R}}}),T.fn.extend({on:function(v,S,M,R){return Mr(this,v,S,M,R)},one:function(v,S,M,R){return Mr(this,v,S,M,R,1)},off:function(v,S,M){var R,V;if(v&&v.preventDefault&&v.handleObj)return R=v.handleObj,T(v.delegateTarget).off(R.namespace?R.origType+"."+R.namespace:R.origType,R.selector,R.handler),this;if(typeof v=="object"){for(V in v)this.off(V,S,v[V]);return this}return S!==!1&&typeof S!="function"||(M=S,S=void 0),M===!1&&(M=fr),this.each(function(){T.event.remove(this,v,M,S)})}});var Vr=/<script|<style|<link/i,yi=/checked\s*(?:[^=]|=\s*.checked.)/i,Qr=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Fi(v,S){return ut(v,"table")&&ut(S.nodeType!==11?S:S.firstChild,"tr")&&T(v).children("tbody")[0]||v}function ro(v){return v.type=(v.getAttribute("type")!==null)+"/"+v.type,v}function Ln(v){return(v.type||"").slice(0,5)==="true/"?v.type=v.type.slice(5):v.removeAttribute("type"),v}function Di(v,S){var M,R,V,q,Y,ht;if(S.nodeType===1){if(ye.hasData(v)&&(ht=ye.get(v).events))for(V in ye.remove(S,"handle events"),ht)for(M=0,R=ht[V].length;M<R;M++)T.event.add(S,V,ht[V][M]);oi.hasData(v)&&(q=oi.access(v),Y=T.extend({},q),oi.set(S,Y))}}function un(v,S,M,R){S=m(S);var V,q,Y,ht,st,xt,Tt=0,jt=v.length,Et=jt-1,qt=S[0],be=G(qt);if(be||1<jt&&typeof qt=="string"&&!A.checkClone&&yi.test(qt))return v.each(function(We){var Ze=v.eq(We);be&&(S[0]=qt.call(this,We,Ze.html())),un(Ze,S,M,R)});if(jt&&(q=(V=xr(S,v[0].ownerDocument,!1,v,R)).firstChild,V.childNodes.length===1&&(V=q),q||R)){for(ht=(Y=T.map(ve(V,"script"),ro)).length;Tt<jt;Tt++)st=V,Tt!==Et&&(st=T.clone(st,!0,!0),ht&&T.merge(Y,ve(st,"script"))),M.call(v[Tt],st,Tt);if(ht)for(xt=Y[Y.length-1].ownerDocument,T.map(Y,Ln),Tt=0;Tt<ht;Tt++)st=Y[Tt],Wt.test(st.type||"")&&!ye.access(st,"globalEval")&&T.contains(xt,st)&&(st.src&&(st.type||"").toLowerCase()!=="module"?T._evalUrl&&!st.noModule&&T._evalUrl(st.src,{nonce:st.nonce||st.getAttribute("nonce")},xt):Q(st.textContent.replace(Qr,""),st,xt))}return v}function Mi(v,S,M){for(var R,V=S?T.filter(S,v):v,q=0;(R=V[q])!=null;q++)M||R.nodeType!==1||T.cleanData(ve(R)),R.parentNode&&(M&&ae(R)&&Se(ve(R,"script")),R.parentNode.removeChild(R));return v}T.extend({htmlPrefilter:function(v){return v},clone:function(v,S,M){var R,V,q,Y,ht,st,xt,Tt=v.cloneNode(!0),jt=ae(v);if(!(A.noCloneChecked||v.nodeType!==1&&v.nodeType!==11||T.isXMLDoc(v)))for(Y=ve(Tt),R=0,V=(q=ve(v)).length;R<V;R++)ht=q[R],st=Y[R],(xt=st.nodeName.toLowerCase())==="input"&&ot.test(ht.type)?st.checked=ht.checked:xt!=="input"&&xt!=="textarea"||(st.defaultValue=ht.defaultValue);if(S)if(M)for(q=q||ve(v),Y=Y||ve(Tt),R=0,V=q.length;R<V;R++)Di(q[R],Y[R]);else Di(v,Tt);return 0<(Y=ve(Tt,"script")).length&&Se(Y,!jt&&ve(v,"script")),Tt},cleanData:function(v){for(var S,M,R,V=T.event.special,q=0;(M=v[q])!==void 0;q++)if(Or(M)){if(S=M[ye.expando]){if(S.events)for(R in S.events)V[R]?T.event.remove(M,R):T.removeEvent(M,R,S.handle);M[ye.expando]=void 0}M[oi.expando]&&(M[oi.expando]=void 0)}}}),T.fn.extend({detach:function(v){return Mi(this,v,!0)},remove:function(v){return Mi(this,v)},text:function(v){return vr(this,function(S){return S===void 0?T.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=S)})},null,v,arguments.length)},append:function(){return un(this,arguments,function(v){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||Fi(this,v).appendChild(v)})},prepend:function(){return un(this,arguments,function(v){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var S=Fi(this,v);S.insertBefore(v,S.firstChild)}})},before:function(){return un(this,arguments,function(v){this.parentNode&&this.parentNode.insertBefore(v,this)})},after:function(){return un(this,arguments,function(v){this.parentNode&&this.parentNode.insertBefore(v,this.nextSibling)})},empty:function(){for(var v,S=0;(v=this[S])!=null;S++)v.nodeType===1&&(T.cleanData(ve(v,!1)),v.textContent="");return this},clone:function(v,S){return v=v!=null&&v,S=S??v,this.map(function(){return T.clone(this,v,S)})},html:function(v){return vr(this,function(S){var M=this[0]||{},R=0,V=this.length;if(S===void 0&&M.nodeType===1)return M.innerHTML;if(typeof S=="string"&&!Vr.test(S)&&!Ut[(zt.exec(S)||["",""])[1].toLowerCase()]){S=T.htmlPrefilter(S);try{for(;R<V;R++)(M=this[R]||{}).nodeType===1&&(T.cleanData(ve(M,!1)),M.innerHTML=S);M=0}catch{}}M&&this.empty().append(S)},null,v,arguments.length)},replaceWith:function(){var v=[];return un(this,arguments,function(S){var M=this.parentNode;T.inArray(this,v)<0&&(T.cleanData(ve(this)),M&&M.replaceChild(S,this))},v)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(v,S){T.fn[v]=function(M){for(var R,V=[],q=T(M),Y=q.length-1,ht=0;ht<=Y;ht++)R=ht===Y?this:this.clone(!0),T(q[ht])[S](R),g.apply(V,R.get());return this.pushStack(V)}});var Qi=new RegExp("^("+cn+")(?!px)[a-z%]+$","i"),Qo=/^--/,ci=function(v){var S=v.ownerDocument.defaultView;return S&&S.opener||(S=n),S.getComputedStyle(v)},wn=function(v,S,M){var R,V,q={};for(V in S)q[V]=v.style[V],v.style[V]=S[V];for(V in R=M.call(v),S)v.style[V]=q[V];return R},vi=new RegExp(Ot.join("|"),"i");function Jr(v,S,M){var R,V,q,Y,ht=Qo.test(S),st=v.style;return(M=M||ci(v))&&(Y=M.getPropertyValue(S)||M[S],ht&&Y&&(Y=Y.replace(rt,"$1")||void 0),Y!==""||ae(v)||(Y=T.style(v,S)),!A.pixelBoxStyles()&&Qi.test(Y)&&vi.test(S)&&(R=st.width,V=st.minWidth,q=st.maxWidth,st.minWidth=st.maxWidth=st.width=Y,Y=M.width,st.width=R,st.minWidth=V,st.maxWidth=q)),Y!==void 0?Y+"":Y}function tn(v,S){return{get:function(){if(!v())return(this.get=S).apply(this,arguments);delete this.get}}}(function(){function v(){if(xt){st.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",xt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Kt.appendChild(st).appendChild(xt);var Tt=n.getComputedStyle(xt);M=Tt.top!=="1%",ht=S(Tt.marginLeft)===12,xt.style.right="60%",q=S(Tt.right)===36,R=S(Tt.width)===36,xt.style.position="absolute",V=S(xt.offsetWidth/3)===12,Kt.removeChild(st),xt=null}}function S(Tt){return Math.round(parseFloat(Tt))}var M,R,V,q,Y,ht,st=O.createElement("div"),xt=O.createElement("div");xt.style&&(xt.style.backgroundClip="content-box",xt.cloneNode(!0).style.backgroundClip="",A.clearCloneStyle=xt.style.backgroundClip==="content-box",T.extend(A,{boxSizingReliable:function(){return v(),R},pixelBoxStyles:function(){return v(),q},pixelPosition:function(){return v(),M},reliableMarginLeft:function(){return v(),ht},scrollboxSize:function(){return v(),V},reliableTrDimensions:function(){var Tt,jt,Et,qt;return Y==null&&(Tt=O.createElement("table"),jt=O.createElement("tr"),Et=O.createElement("div"),Tt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",jt.style.cssText="box-sizing:content-box;border:1px solid",jt.style.height="1px",Et.style.height="9px",Et.style.display="block",Kt.appendChild(Tt).appendChild(jt).appendChild(Et),qt=n.getComputedStyle(jt),Y=parseInt(qt.height,10)+parseInt(qt.borderTopWidth,10)+parseInt(qt.borderBottomWidth,10)===jt.offsetHeight,Kt.removeChild(Tt)),Y}}))})();var gr=["Webkit","Moz","ms"],St=O.createElement("div").style,_i={};function Wr(v){var S=T.cssProps[v]||_i[v];return S||(v in St?v:_i[v]=function(M){for(var R=M[0].toUpperCase()+M.slice(1),V=gr.length;V--;)if((M=gr[V]+R)in St)return M}(v)||v)}var Vs=/^(none|table(?!-c[ea]).+)/,In={position:"absolute",visibility:"hidden",display:"block"},qi={letterSpacing:"0",fontWeight:"400"};function vo(v,S,M){var R=Ft.exec(S);return R?Math.max(0,R[2]-(M||0))+(R[3]||"px"):S}function xi(v,S,M,R,V,q){var Y=S==="width"?1:0,ht=0,st=0,xt=0;if(M===(R?"border":"content"))return 0;for(;Y<4;Y+=2)M==="margin"&&(xt+=T.css(v,M+Ot[Y],!0,V)),R?(M==="content"&&(st-=T.css(v,"padding"+Ot[Y],!0,V)),M!=="margin"&&(st-=T.css(v,"border"+Ot[Y]+"Width",!0,V))):(st+=T.css(v,"padding"+Ot[Y],!0,V),M!=="padding"?st+=T.css(v,"border"+Ot[Y]+"Width",!0,V):ht+=T.css(v,"border"+Ot[Y]+"Width",!0,V));return!R&&0<=q&&(st+=Math.max(0,Math.ceil(v["offset"+S[0].toUpperCase()+S.slice(1)]-q-st-ht-.5))||0),st+xt}function Ei(v,S,M){var R=ci(v),V=(!A.boxSizingReliable()||M)&&T.css(v,"boxSizing",!1,R)==="border-box",q=V,Y=Jr(v,S,R),ht="offset"+S[0].toUpperCase()+S.slice(1);if(Qi.test(Y)){if(!M)return Y;Y="auto"}return(!A.boxSizingReliable()&&V||!A.reliableTrDimensions()&&ut(v,"tr")||Y==="auto"||!parseFloat(Y)&&T.css(v,"display",!1,R)==="inline")&&v.getClientRects().length&&(V=T.css(v,"boxSizing",!1,R)==="border-box",(q=ht in v)&&(Y=v[ht])),(Y=parseFloat(Y)||0)+xi(v,S,M||(V?"border":"content"),q,R,Y)+"px"}function hn(v,S,M,R,V){return new hn.prototype.init(v,S,M,R,V)}T.extend({cssHooks:{opacity:{get:function(v,S){if(S){var M=Jr(v,"opacity");return M===""?"1":M}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(v,S,M,R){if(v&&v.nodeType!==3&&v.nodeType!==8&&v.style){var V,q,Y,ht=Sr(S),st=Qo.test(S),xt=v.style;if(st||(S=Wr(ht)),Y=T.cssHooks[S]||T.cssHooks[ht],M===void 0)return Y&&"get"in Y&&(V=Y.get(v,!1,R))!==void 0?V:xt[S];(q=typeof M)=="string"&&(V=Ft.exec(M))&&V[1]&&(M=Er(v,S,V),q="number"),M!=null&&M==M&&(q!=="number"||st||(M+=V&&V[3]||(T.cssNumber[ht]?"":"px")),A.clearCloneStyle||M!==""||S.indexOf("background")!==0||(xt[S]="inherit"),Y&&"set"in Y&&(M=Y.set(v,M,R))===void 0||(st?xt.setProperty(S,M):xt[S]=M))}},css:function(v,S,M,R){var V,q,Y,ht=Sr(S);return Qo.test(S)||(S=Wr(ht)),(Y=T.cssHooks[S]||T.cssHooks[ht])&&"get"in Y&&(V=Y.get(v,!0,M)),V===void 0&&(V=Jr(v,S,R)),V==="normal"&&S in qi&&(V=qi[S]),M===""||M?(q=parseFloat(V),M===!0||isFinite(q)?q||0:V):V}}),T.each(["height","width"],function(v,S){T.cssHooks[S]={get:function(M,R,V){if(R)return!Vs.test(T.css(M,"display"))||M.getClientRects().length&&M.getBoundingClientRect().width?Ei(M,S,V):wn(M,In,function(){return Ei(M,S,V)})},set:function(M,R,V){var q,Y=ci(M),ht=!A.scrollboxSize()&&Y.position==="absolute",st=(ht||V)&&T.css(M,"boxSizing",!1,Y)==="border-box",xt=V?xi(M,S,V,st,Y):0;return st&&ht&&(xt-=Math.ceil(M["offset"+S[0].toUpperCase()+S.slice(1)]-parseFloat(Y[S])-xi(M,S,"border",!1,Y)-.5)),xt&&(q=Ft.exec(R))&&(q[3]||"px")!=="px"&&(M.style[S]=R,R=T.css(M,S)),vo(0,R,xt)}}}),T.cssHooks.marginLeft=tn(A.reliableMarginLeft,function(v,S){if(S)return(parseFloat(Jr(v,"marginLeft"))||v.getBoundingClientRect().left-wn(v,{marginLeft:0},function(){return v.getBoundingClientRect().left}))+"px"}),T.each({margin:"",padding:"",border:"Width"},function(v,S){T.cssHooks[v+S]={expand:function(M){for(var R=0,V={},q=typeof M=="string"?M.split(" "):[M];R<4;R++)V[v+Ot[R]+S]=q[R]||q[R-2]||q[0];return V}},v!=="margin"&&(T.cssHooks[v+S].set=vo)}),T.fn.extend({css:function(v,S){return vr(this,function(M,R,V){var q,Y,ht={},st=0;if(Array.isArray(R)){for(q=ci(M),Y=R.length;st<Y;st++)ht[R[st]]=T.css(M,R[st],!1,q);return ht}return V!==void 0?T.style(M,R,V):T.css(M,R)},v,S,1<arguments.length)}}),((T.Tween=hn).prototype={constructor:hn,init:function(v,S,M,R,V,q){this.elem=v,this.prop=M,this.easing=V||T.easing._default,this.options=S,this.start=this.now=this.cur(),this.end=R,this.unit=q||(T.cssNumber[M]?"":"px")},cur:function(){var v=hn.propHooks[this.prop];return v&&v.get?v.get(this):hn.propHooks._default.get(this)},run:function(v){var S,M=hn.propHooks[this.prop];return this.options.duration?this.pos=S=T.easing[this.easing](v,this.options.duration*v,0,1,this.options.duration):this.pos=S=v,this.now=(this.end-this.start)*S+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),M&&M.set?M.set(this):hn.propHooks._default.set(this),this}}).init.prototype=hn.prototype,(hn.propHooks={_default:{get:function(v){var S;return v.elem.nodeType!==1||v.elem[v.prop]!=null&&v.elem.style[v.prop]==null?v.elem[v.prop]:(S=T.css(v.elem,v.prop,""))&&S!=="auto"?S:0},set:function(v){T.fx.step[v.prop]?T.fx.step[v.prop](v):v.elem.nodeType!==1||!T.cssHooks[v.prop]&&v.elem.style[Wr(v.prop)]==null?v.elem[v.prop]=v.now:T.style(v.elem,v.prop,v.now+v.unit)}}}).scrollTop=hn.propHooks.scrollLeft={set:function(v){v.elem.nodeType&&v.elem.parentNode&&(v.elem[v.prop]=v.now)}},T.easing={linear:function(v){return v},swing:function(v){return .5-Math.cos(v*Math.PI)/2},_default:"swing"},T.fx=hn.prototype.init,T.fx.step={};var Mn,bt,Gt,At,Qt=/^(?:toggle|show|hide)$/,le=/queueHooks$/;function re(){bt&&(O.hidden===!1&&n.requestAnimationFrame?n.requestAnimationFrame(re):n.setTimeout(re,T.fx.interval),T.fx.tick())}function Pe(){return n.setTimeout(function(){Mn=void 0}),Mn=Date.now()}function Ce(v,S){var M,R=0,V={height:v};for(S=S?1:0;R<4;R+=2-S)V["margin"+(M=Ot[R])]=V["padding"+M]=v;return S&&(V.opacity=V.width=v),V}function Xe(v,S,M){for(var R,V=(Ae.tweeners[S]||[]).concat(Ae.tweeners["*"]),q=0,Y=V.length;q<Y;q++)if(R=V[q].call(M,S,v))return R}function Ae(v,S,M){var R,V,q=0,Y=Ae.prefilters.length,ht=T.Deferred().always(function(){delete st.elem}),st=function(){if(V)return!1;for(var jt=Mn||Pe(),Et=Math.max(0,xt.startTime+xt.duration-jt),qt=1-(Et/xt.duration||0),be=0,We=xt.tweens.length;be<We;be++)xt.tweens[be].run(qt);return ht.notifyWith(v,[xt,qt,Et]),qt<1&&We?Et:(We||ht.notifyWith(v,[xt,1,0]),ht.resolveWith(v,[xt]),!1)},xt=ht.promise({elem:v,props:T.extend({},S),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},M),originalProperties:S,originalOptions:M,startTime:Mn||Pe(),duration:M.duration,tweens:[],createTween:function(jt,Et){var qt=T.Tween(v,xt.opts,jt,Et,xt.opts.specialEasing[jt]||xt.opts.easing);return xt.tweens.push(qt),qt},stop:function(jt){var Et=0,qt=jt?xt.tweens.length:0;if(V)return this;for(V=!0;Et<qt;Et++)xt.tweens[Et].run(1);return jt?(ht.notifyWith(v,[xt,1,0]),ht.resolveWith(v,[xt,jt])):ht.rejectWith(v,[xt,jt]),this}}),Tt=xt.props;for(!function(jt,Et){var qt,be,We,Ze,si;for(qt in jt)if(We=Et[be=Sr(qt)],Ze=jt[qt],Array.isArray(Ze)&&(We=Ze[1],Ze=jt[qt]=Ze[0]),qt!==be&&(jt[be]=Ze,delete jt[qt]),(si=T.cssHooks[be])&&"expand"in si)for(qt in Ze=si.expand(Ze),delete jt[be],Ze)qt in jt||(jt[qt]=Ze[qt],Et[qt]=We);else Et[be]=We}(Tt,xt.opts.specialEasing);q<Y;q++)if(R=Ae.prefilters[q].call(xt,v,Tt,xt.opts))return G(R.stop)&&(T._queueHooks(xt.elem,xt.opts.queue).stop=R.stop.bind(R)),R;return T.map(Tt,Xe,xt),G(xt.opts.start)&&xt.opts.start.call(v,xt),xt.progress(xt.opts.progress).done(xt.opts.done,xt.opts.complete).fail(xt.opts.fail).always(xt.opts.always),T.fx.timer(T.extend(st,{elem:v,anim:xt,queue:xt.opts.queue})),xt}T.Animation=T.extend(Ae,{tweeners:{"*":[function(v,S){var M=this.createTween(v,S);return Er(M.elem,v,Ft.exec(S),M),M}]},tweener:function(v,S){G(v)?(S=v,v=["*"]):v=v.match(Ue);for(var M,R=0,V=v.length;R<V;R++)M=v[R],Ae.tweeners[M]=Ae.tweeners[M]||[],Ae.tweeners[M].unshift(S)},prefilters:[function(v,S,M){var R,V,q,Y,ht,st,xt,Tt,jt="width"in S||"height"in S,Et=this,qt={},be=v.style,We=v.nodeType&&Be(v),Ze=ye.get(v,"fxshow");for(R in M.queue||((Y=T._queueHooks(v,"fx")).unqueued==null&&(Y.unqueued=0,ht=Y.empty.fire,Y.empty.fire=function(){Y.unqueued||ht()}),Y.unqueued++,Et.always(function(){Et.always(function(){Y.unqueued--,T.queue(v,"fx").length||Y.empty.fire()})})),S)if(V=S[R],Qt.test(V)){if(delete S[R],q=q||V==="toggle",V===(We?"hide":"show")){if(V!=="show"||!Ze||Ze[R]===void 0)continue;We=!0}qt[R]=Ze&&Ze[R]||T.style(v,R)}if((st=!T.isEmptyObject(S))||!T.isEmptyObject(qt))for(R in jt&&v.nodeType===1&&(M.overflow=[be.overflow,be.overflowX,be.overflowY],(xt=Ze&&Ze.display)==null&&(xt=ye.get(v,"display")),(Tt=T.css(v,"display"))==="none"&&(xt?Tt=xt:(Oe([v],!0),xt=v.style.display||xt,Tt=T.css(v,"display"),Oe([v]))),(Tt==="inline"||Tt==="inline-block"&&xt!=null)&&T.css(v,"float")==="none"&&(st||(Et.done(function(){be.display=xt}),xt==null&&(Tt=be.display,xt=Tt==="none"?"":Tt)),be.display="inline-block")),M.overflow&&(be.overflow="hidden",Et.always(function(){be.overflow=M.overflow[0],be.overflowX=M.overflow[1],be.overflowY=M.overflow[2]})),st=!1,qt)st||(Ze?"hidden"in Ze&&(We=Ze.hidden):Ze=ye.access(v,"fxshow",{display:xt}),q&&(Ze.hidden=!We),We&&Oe([v],!0),Et.done(function(){for(R in We||Oe([v]),ye.remove(v,"fxshow"),qt)T.style(v,R,qt[R])})),st=Xe(We?Ze[R]:0,R,Et),R in Ze||(Ze[R]=st.start,We&&(st.end=st.start,st.start=0))}],prefilter:function(v,S){S?Ae.prefilters.unshift(v):Ae.prefilters.push(v)}}),T.speed=function(v,S,M){var R=v&&typeof v=="object"?T.extend({},v):{complete:M||!M&&S||G(v)&&v,duration:v,easing:M&&S||S&&!G(S)&&S};return T.fx.off?R.duration=0:typeof R.duration!="number"&&(R.duration in T.fx.speeds?R.duration=T.fx.speeds[R.duration]:R.duration=T.fx.speeds._default),R.queue!=null&&R.queue!==!0||(R.queue="fx"),R.old=R.complete,R.complete=function(){G(R.old)&&R.old.call(this),R.queue&&T.dequeue(this,R.queue)},R},T.fn.extend({fadeTo:function(v,S,M,R){return this.filter(Be).css("opacity",0).show().end().animate({opacity:S},v,M,R)},animate:function(v,S,M,R){var V=T.isEmptyObject(v),q=T.speed(S,M,R),Y=function(){var ht=Ae(this,T.extend({},v),q);(V||ye.get(this,"finish"))&&ht.stop(!0)};return Y.finish=Y,V||q.queue===!1?this.each(Y):this.queue(q.queue,Y)},stop:function(v,S,M){var R=function(V){var q=V.stop;delete V.stop,q(M)};return typeof v!="string"&&(M=S,S=v,v=void 0),S&&this.queue(v||"fx",[]),this.each(function(){var V=!0,q=v!=null&&v+"queueHooks",Y=T.timers,ht=ye.get(this);if(q)ht[q]&&ht[q].stop&&R(ht[q]);else for(q in ht)ht[q]&&ht[q].stop&&le.test(q)&&R(ht[q]);for(q=Y.length;q--;)Y[q].elem!==this||v!=null&&Y[q].queue!==v||(Y[q].anim.stop(M),V=!1,Y.splice(q,1));!V&&M||T.dequeue(this,v)})},finish:function(v){return v!==!1&&(v=v||"fx"),this.each(function(){var S,M=ye.get(this),R=M[v+"queue"],V=M[v+"queueHooks"],q=T.timers,Y=R?R.length:0;for(M.finish=!0,T.queue(this,v,[]),V&&V.stop&&V.stop.call(this,!0),S=q.length;S--;)q[S].elem===this&&q[S].queue===v&&(q[S].anim.stop(!0),q.splice(S,1));for(S=0;S<Y;S++)R[S]&&R[S].finish&&R[S].finish.call(this);delete M.finish})}}),T.each(["toggle","show","hide"],function(v,S){var M=T.fn[S];T.fn[S]=function(R,V,q){return R==null||typeof R=="boolean"?M.apply(this,arguments):this.animate(Ce(S,!0),R,V,q)}}),T.each({slideDown:Ce("show"),slideUp:Ce("hide"),slideToggle:Ce("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(v,S){T.fn[v]=function(M,R,V){return this.animate(S,M,R,V)}}),T.timers=[],T.fx.tick=function(){var v,S=0,M=T.timers;for(Mn=Date.now();S<M.length;S++)(v=M[S])()||M[S]!==v||M.splice(S--,1);M.length||T.fx.stop(),Mn=void 0},T.fx.timer=function(v){T.timers.push(v),T.fx.start()},T.fx.interval=13,T.fx.start=function(){bt||(bt=!0,re())},T.fx.stop=function(){bt=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(v,S){return v=T.fx&&T.fx.speeds[v]||v,S=S||"fx",this.queue(S,function(M,R){var V=n.setTimeout(M,v);R.stop=function(){n.clearTimeout(V)}})},Gt=O.createElement("input"),At=O.createElement("select").appendChild(O.createElement("option")),Gt.type="checkbox",A.checkOn=Gt.value!=="",A.optSelected=At.selected,(Gt=O.createElement("input")).value="t",Gt.type="radio",A.radioValue=Gt.value==="t";var ke,lr=T.expr.attrHandle;T.fn.extend({attr:function(v,S){return vr(this,T.attr,v,S,1<arguments.length)},removeAttr:function(v){return this.each(function(){T.removeAttr(this,v)})}}),T.extend({attr:function(v,S,M){var R,V,q=v.nodeType;if(q!==3&&q!==8&&q!==2)return typeof v.getAttribute>"u"?T.prop(v,S,M):(q===1&&T.isXMLDoc(v)||(V=T.attrHooks[S.toLowerCase()]||(T.expr.match.bool.test(S)?ke:void 0)),M!==void 0?M===null?void T.removeAttr(v,S):V&&"set"in V&&(R=V.set(v,M,S))!==void 0?R:(v.setAttribute(S,M+""),M):V&&"get"in V&&(R=V.get(v,S))!==null?R:(R=T.find.attr(v,S))==null?void 0:R)},attrHooks:{type:{set:function(v,S){if(!A.radioValue&&S==="radio"&&ut(v,"input")){var M=v.value;return v.setAttribute("type",S),M&&(v.value=M),S}}}},removeAttr:function(v,S){var M,R=0,V=S&&S.match(Ue);if(V&&v.nodeType===1)for(;M=V[R++];)v.removeAttribute(M)}}),ke={set:function(v,S,M){return S===!1?T.removeAttr(v,M):v.setAttribute(M,M),M}},T.each(T.expr.match.bool.source.match(/\w+/g),function(v,S){var M=lr[S]||T.find.attr;lr[S]=function(R,V,q){var Y,ht,st=V.toLowerCase();return q||(ht=lr[st],lr[st]=Y,Y=M(R,V,q)!=null?st:null,lr[st]=ht),Y}});var mr=/^(?:input|select|textarea|button)$/i,Fr=/^(?:a|area)$/i;function Ur(v){return(v.match(Ue)||[]).join(" ")}function ui(v){return v.getAttribute&&v.getAttribute("class")||""}function nn(v){return Array.isArray(v)?v:typeof v=="string"&&v.match(Ue)||[]}T.fn.extend({prop:function(v,S){return vr(this,T.prop,v,S,1<arguments.length)},removeProp:function(v){return this.each(function(){delete this[T.propFix[v]||v]})}}),T.extend({prop:function(v,S,M){var R,V,q=v.nodeType;if(q!==3&&q!==8&&q!==2)return q===1&&T.isXMLDoc(v)||(S=T.propFix[S]||S,V=T.propHooks[S]),M!==void 0?V&&"set"in V&&(R=V.set(v,M,S))!==void 0?R:v[S]=M:V&&"get"in V&&(R=V.get(v,S))!==null?R:v[S]},propHooks:{tabIndex:{get:function(v){var S=T.find.attr(v,"tabindex");return S?parseInt(S,10):mr.test(v.nodeName)||Fr.test(v.nodeName)&&v.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),A.optSelected||(T.propHooks.selected={get:function(v){var S=v.parentNode;return S&&S.parentNode&&S.parentNode.selectedIndex,null},set:function(v){var S=v.parentNode;S&&(S.selectedIndex,S.parentNode&&S.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){T.propFix[this.toLowerCase()]=this}),T.fn.extend({addClass:function(v){var S,M,R,V,q,Y;return G(v)?this.each(function(ht){T(this).addClass(v.call(this,ht,ui(this)))}):(S=nn(v)).length?this.each(function(){if(R=ui(this),M=this.nodeType===1&&" "+Ur(R)+" "){for(q=0;q<S.length;q++)V=S[q],M.indexOf(" "+V+" ")<0&&(M+=V+" ");Y=Ur(M),R!==Y&&this.setAttribute("class",Y)}}):this},removeClass:function(v){var S,M,R,V,q,Y;return G(v)?this.each(function(ht){T(this).removeClass(v.call(this,ht,ui(this)))}):arguments.length?(S=nn(v)).length?this.each(function(){if(R=ui(this),M=this.nodeType===1&&" "+Ur(R)+" "){for(q=0;q<S.length;q++)for(V=S[q];-1<M.indexOf(" "+V+" ");)M=M.replace(" "+V+" "," ");Y=Ur(M),R!==Y&&this.setAttribute("class",Y)}}):this:this.attr("class","")},toggleClass:function(v,S){var M,R,V,q,Y=typeof v,ht=Y==="string"||Array.isArray(v);return G(v)?this.each(function(st){T(this).toggleClass(v.call(this,st,ui(this),S),S)}):typeof S=="boolean"&&ht?S?this.addClass(v):this.removeClass(v):(M=nn(v),this.each(function(){if(ht)for(q=T(this),V=0;V<M.length;V++)R=M[V],q.hasClass(R)?q.removeClass(R):q.addClass(R);else v!==void 0&&Y!=="boolean"||((R=ui(this))&&ye.set(this,"__className__",R),this.setAttribute&&this.setAttribute("class",R||v===!1?"":ye.get(this,"__className__")||""))}))},hasClass:function(v){var S,M,R=0;for(S=" "+v+" ";M=this[R++];)if(M.nodeType===1&&-1<(" "+Ur(ui(M))+" ").indexOf(S))return!0;return!1}});var pn=/\r/g;T.fn.extend({val:function(v){var S,M,R,V=this[0];return arguments.length?(R=G(v),this.each(function(q){var Y;this.nodeType===1&&((Y=R?v.call(this,q,T(this).val()):v)==null?Y="":typeof Y=="number"?Y+="":Array.isArray(Y)&&(Y=T.map(Y,function(ht){return ht==null?"":ht+""})),(S=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in S&&S.set(this,Y,"value")!==void 0||(this.value=Y))})):V?(S=T.valHooks[V.type]||T.valHooks[V.nodeName.toLowerCase()])&&"get"in S&&(M=S.get(V,"value"))!==void 0?M:typeof(M=V.value)=="string"?M.replace(pn,""):M??"":void 0}}),T.extend({valHooks:{option:{get:function(v){var S=T.find.attr(v,"value");return S??Ur(T.text(v))}},select:{get:function(v){var S,M,R,V=v.options,q=v.selectedIndex,Y=v.type==="select-one",ht=Y?null:[],st=Y?q+1:V.length;for(R=q<0?st:Y?q:0;R<st;R++)if(((M=V[R]).selected||R===q)&&!M.disabled&&(!M.parentNode.disabled||!ut(M.parentNode,"optgroup"))){if(S=T(M).val(),Y)return S;ht.push(S)}return ht},set:function(v,S){for(var M,R,V=v.options,q=T.makeArray(S),Y=V.length;Y--;)((R=V[Y]).selected=-1<T.inArray(T.valHooks.option.get(R),q))&&(M=!0);return M||(v.selectedIndex=-1),q}}}}),T.each(["radio","checkbox"],function(){T.valHooks[this]={set:function(v,S){if(Array.isArray(S))return v.checked=-1<T.inArray(T(v).val(),S)}},A.checkOn||(T.valHooks[this].get=function(v){return v.getAttribute("value")===null?"on":v.value})});var Co=n.location,Us={guid:Date.now()},Wn=/\?/;T.parseXML=function(v){var S,M;if(!v||typeof v!="string")return null;try{S=new n.DOMParser().parseFromString(v,"text/xml")}catch{}return M=S&&S.getElementsByTagName("parsererror")[0],S&&!M||T.error("Invalid XML: "+(M?T.map(M.childNodes,function(R){return R.textContent}).join(`
`):v)),S};var En=/^(?:focusinfocus|focusoutblur)$/,ao=function(v){v.stopPropagation()};T.extend(T.event,{trigger:function(v,S,M,R){var V,q,Y,ht,st,xt,Tt,jt,Et=[M||O],qt=L.call(v,"type")?v.type:v,be=L.call(v,"namespace")?v.namespace.split("."):[];if(q=jt=Y=M=M||O,M.nodeType!==3&&M.nodeType!==8&&!En.test(qt+T.event.triggered)&&(-1<qt.indexOf(".")&&(qt=(be=qt.split(".")).shift(),be.sort()),st=qt.indexOf(":")<0&&"on"+qt,(v=v[T.expando]?v:new T.Event(qt,typeof v=="object"&&v)).isTrigger=R?2:3,v.namespace=be.join("."),v.rnamespace=v.namespace?new RegExp("(^|\\.)"+be.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,v.result=void 0,v.target||(v.target=M),S=S==null?[v]:T.makeArray(S,[v]),Tt=T.event.special[qt]||{},R||!Tt.trigger||Tt.trigger.apply(M,S)!==!1)){if(!R&&!Tt.noBubble&&!B(M)){for(ht=Tt.delegateType||qt,En.test(ht+qt)||(q=q.parentNode);q;q=q.parentNode)Et.push(q),Y=q;Y===(M.ownerDocument||O)&&Et.push(Y.defaultView||Y.parentWindow||n)}for(V=0;(q=Et[V++])&&!v.isPropagationStopped();)jt=q,v.type=1<V?ht:Tt.bindType||qt,(xt=(ye.get(q,"events")||Object.create(null))[v.type]&&ye.get(q,"handle"))&&xt.apply(q,S),(xt=st&&q[st])&&xt.apply&&Or(q)&&(v.result=xt.apply(q,S),v.result===!1&&v.preventDefault());return v.type=qt,R||v.isDefaultPrevented()||Tt._default&&Tt._default.apply(Et.pop(),S)!==!1||!Or(M)||st&&G(M[qt])&&!B(M)&&((Y=M[st])&&(M[st]=null),T.event.triggered=qt,v.isPropagationStopped()&&jt.addEventListener(qt,ao),M[qt](),v.isPropagationStopped()&&jt.removeEventListener(qt,ao),T.event.triggered=void 0,Y&&(M[st]=Y)),v.result}},simulate:function(v,S,M){var R=T.extend(new T.Event,M,{type:v,isSimulated:!0});T.event.trigger(R,null,S)}}),T.fn.extend({trigger:function(v,S){return this.each(function(){T.event.trigger(v,S,this)})},triggerHandler:function(v,S){var M=this[0];if(M)return T.event.trigger(v,S,M,!0)}});var as=/\[\]$/,vs=/\r?\n/g,ko=/^(?:submit|button|image|reset|file)$/i,ba=/^(?:input|select|textarea|keygen)/i;function _s(v,S,M,R){var V;if(Array.isArray(S))T.each(S,function(q,Y){M||as.test(v)?R(v,Y):_s(v+"["+(typeof Y=="object"&&Y!=null?q:"")+"]",Y,M,R)});else if(M||et(S)!=="object")R(v,S);else for(V in S)_s(v+"["+V+"]",S[V],M,R)}T.param=function(v,S){var M,R=[],V=function(q,Y){var ht=G(Y)?Y():Y;R[R.length]=encodeURIComponent(q)+"="+encodeURIComponent(ht??"")};if(v==null)return"";if(Array.isArray(v)||v.jquery&&!T.isPlainObject(v))T.each(v,function(){V(this.name,this.value)});else for(M in v)_s(M,v[M],S,V);return R.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var v=T.prop(this,"elements");return v?T.makeArray(v):this}).filter(function(){var v=this.type;return this.name&&!T(this).is(":disabled")&&ba.test(this.nodeName)&&!ko.test(v)&&(this.checked||!ot.test(v))}).map(function(v,S){var M=T(this).val();return M==null?null:Array.isArray(M)?T.map(M,function(R){return{name:S.name,value:R.replace(vs,`\r
`)}}):{name:S.name,value:M.replace(vs,`\r
`)}}).get()}});var Wo=/%20/g,Qa=/#.*$/,tl=/([?&])_=[^&]*/,bl=/^(.*?):[ \t]*([^\r\n]*)$/gm,el=/^(?:GET|HEAD)$/,xs=/^\/\//,_o={},To={},Yo="*/".concat("*"),Gi=O.createElement("a");function Sl(v){return function(S,M){typeof S!="string"&&(M=S,S="*");var R,V=0,q=S.toLowerCase().match(Ue)||[];if(G(M))for(;R=q[V++];)R[0]==="+"?(R=R.slice(1)||"*",(v[R]=v[R]||[]).unshift(M)):(v[R]=v[R]||[]).push(M)}}function Po(v,S,M,R){var V={},q=v===To;function Y(ht){var st;return V[ht]=!0,T.each(v[ht]||[],function(xt,Tt){var jt=Tt(S,M,R);return typeof jt!="string"||q||V[jt]?q?!(st=jt):void 0:(S.dataTypes.unshift(jt),Y(jt),!1)}),st}return Y(S.dataTypes[0])||!V["*"]&&Y("*")}function Yn(v,S){var M,R,V=T.ajaxSettings.flatOptions||{};for(M in S)S[M]!==void 0&&((V[M]?v:R||(R={}))[M]=S[M]);return R&&T.extend(!0,v,R),v}Gi.href=Co.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Co.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Co.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Yo,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(v,S){return S?Yn(Yn(v,T.ajaxSettings),S):Yn(T.ajaxSettings,v)},ajaxPrefilter:Sl(_o),ajaxTransport:Sl(To),ajax:function(v,S){typeof v=="object"&&(S=v,v=void 0),S=S||{};var M,R,V,q,Y,ht,st,xt,Tt,jt,Et=T.ajaxSetup({},S),qt=Et.context||Et,be=Et.context&&(qt.nodeType||qt.jquery)?T(qt):T.event,We=T.Deferred(),Ze=T.Callbacks("once memory"),si=Et.statusCode||{},gi={},dn={},Dn="canceled",pr={readyState:0,getResponseHeader:function(rr){var Rr;if(st){if(!q)for(q={};Rr=bl.exec(V);)q[Rr[1].toLowerCase()+" "]=(q[Rr[1].toLowerCase()+" "]||[]).concat(Rr[2]);Rr=q[rr.toLowerCase()+" "]}return Rr==null?null:Rr.join(", ")},getAllResponseHeaders:function(){return st?V:null},setRequestHeader:function(rr,Rr){return st==null&&(rr=dn[rr.toLowerCase()]=dn[rr.toLowerCase()]||rr,gi[rr]=Rr),this},overrideMimeType:function(rr){return st==null&&(Et.mimeType=rr),this},statusCode:function(rr){var Rr;if(rr)if(st)pr.always(rr[pr.status]);else for(Rr in rr)si[Rr]=[si[Rr],rr[Rr]];return this},abort:function(rr){var Rr=rr||Dn;return M&&M.abort(Rr),Xi(0,Rr),this}};if(We.promise(pr),Et.url=((v||Et.url||Co.href)+"").replace(xs,Co.protocol+"//"),Et.type=S.method||S.type||Et.method||Et.type,Et.dataTypes=(Et.dataType||"*").toLowerCase().match(Ue)||[""],Et.crossDomain==null){ht=O.createElement("a");try{ht.href=Et.url,ht.href=ht.href,Et.crossDomain=Gi.protocol+"//"+Gi.host!=ht.protocol+"//"+ht.host}catch{Et.crossDomain=!0}}if(Et.data&&Et.processData&&typeof Et.data!="string"&&(Et.data=T.param(Et.data,Et.traditional)),Po(_o,Et,S,pr),st)return pr;for(Tt in(xt=T.event&&Et.global)&&T.active++==0&&T.event.trigger("ajaxStart"),Et.type=Et.type.toUpperCase(),Et.hasContent=!el.test(Et.type),R=Et.url.replace(Qa,""),Et.hasContent?Et.data&&Et.processData&&(Et.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Et.data=Et.data.replace(Wo,"+")):(jt=Et.url.slice(R.length),Et.data&&(Et.processData||typeof Et.data=="string")&&(R+=(Wn.test(R)?"&":"?")+Et.data,delete Et.data),Et.cache===!1&&(R=R.replace(tl,"$1"),jt=(Wn.test(R)?"&":"?")+"_="+Us.guid+++jt),Et.url=R+jt),Et.ifModified&&(T.lastModified[R]&&pr.setRequestHeader("If-Modified-Since",T.lastModified[R]),T.etag[R]&&pr.setRequestHeader("If-None-Match",T.etag[R])),(Et.data&&Et.hasContent&&Et.contentType!==!1||S.contentType)&&pr.setRequestHeader("Content-Type",Et.contentType),pr.setRequestHeader("Accept",Et.dataTypes[0]&&Et.accepts[Et.dataTypes[0]]?Et.accepts[Et.dataTypes[0]]+(Et.dataTypes[0]!=="*"?", "+Yo+"; q=0.01":""):Et.accepts["*"]),Et.headers)pr.setRequestHeader(Tt,Et.headers[Tt]);if(Et.beforeSend&&(Et.beforeSend.call(qt,pr,Et)===!1||st))return pr.abort();if(Dn="abort",Ze.add(Et.complete),pr.done(Et.success),pr.fail(Et.error),M=Po(To,Et,S,pr)){if(pr.readyState=1,xt&&be.trigger("ajaxSend",[pr,Et]),st)return pr;Et.async&&0<Et.timeout&&(Y=n.setTimeout(function(){pr.abort("timeout")},Et.timeout));try{st=!1,M.send(gi,Xi)}catch(rr){if(st)throw rr;Xi(-1,rr)}}else Xi(-1,"No Transport");function Xi(rr,Rr,Gn,ts){var ri,Fo,Zn,ho,hi,gn=Rr;st||(st=!0,Y&&n.clearTimeout(Y),M=void 0,V=ts||"",pr.readyState=0<rr?4:0,ri=200<=rr&&rr<300||rr===304,Gn&&(ho=function(bi,Yr,Bi){for(var An,Wi,ze,ii,zr=bi.contents,qr=bi.dataTypes;qr[0]==="*";)qr.shift(),An===void 0&&(An=bi.mimeType||Yr.getResponseHeader("Content-Type"));if(An){for(Wi in zr)if(zr[Wi]&&zr[Wi].test(An)){qr.unshift(Wi);break}}if(qr[0]in Bi)ze=qr[0];else{for(Wi in Bi){if(!qr[0]||bi.converters[Wi+" "+qr[0]]){ze=Wi;break}ii||(ii=Wi)}ze=ze||ii}if(ze)return ze!==qr[0]&&qr.unshift(ze),Bi[ze]}(Et,pr,Gn)),!ri&&-1<T.inArray("script",Et.dataTypes)&&T.inArray("json",Et.dataTypes)<0&&(Et.converters["text script"]=function(){}),ho=function(bi,Yr,Bi,An){var Wi,ze,ii,zr,qr,vn={},Ie=bi.dataTypes.slice();if(Ie[1])for(ii in bi.converters)vn[ii.toLowerCase()]=bi.converters[ii];for(ze=Ie.shift();ze;)if(bi.responseFields[ze]&&(Bi[bi.responseFields[ze]]=Yr),!qr&&An&&bi.dataFilter&&(Yr=bi.dataFilter(Yr,bi.dataType)),qr=ze,ze=Ie.shift()){if(ze==="*")ze=qr;else if(qr!=="*"&&qr!==ze){if(!(ii=vn[qr+" "+ze]||vn["* "+ze])){for(Wi in vn)if((zr=Wi.split(" "))[1]===ze&&(ii=vn[qr+" "+zr[0]]||vn["* "+zr[0]])){ii===!0?ii=vn[Wi]:vn[Wi]!==!0&&(ze=zr[0],Ie.unshift(zr[1]));break}}if(ii!==!0)if(ii&&bi.throws)Yr=ii(Yr);else try{Yr=ii(Yr)}catch(lo){return{state:"parsererror",error:ii?lo:"No conversion from "+qr+" to "+ze}}}}return{state:"success",data:Yr}}(Et,ho,pr,ri),ri?(Et.ifModified&&((hi=pr.getResponseHeader("Last-Modified"))&&(T.lastModified[R]=hi),(hi=pr.getResponseHeader("etag"))&&(T.etag[R]=hi)),rr===204||Et.type==="HEAD"?gn="nocontent":rr===304?gn="notmodified":(gn=ho.state,Fo=ho.data,ri=!(Zn=ho.error))):(Zn=gn,!rr&&gn||(gn="error",rr<0&&(rr=0))),pr.status=rr,pr.statusText=(Rr||gn)+"",ri?We.resolveWith(qt,[Fo,gn,pr]):We.rejectWith(qt,[pr,gn,Zn]),pr.statusCode(si),si=void 0,xt&&be.trigger(ri?"ajaxSuccess":"ajaxError",[pr,Et,ri?Fo:Zn]),Ze.fireWith(qt,[pr,gn]),xt&&(be.trigger("ajaxComplete",[pr,Et]),--T.active||T.event.trigger("ajaxStop")))}return pr},getJSON:function(v,S,M){return T.get(v,S,M,"json")},getScript:function(v,S){return T.get(v,void 0,S,"script")}}),T.each(["get","post"],function(v,S){T[S]=function(M,R,V,q){return G(R)&&(q=q||V,V=R,R=void 0),T.ajax(T.extend({url:M,type:S,dataType:q,data:R,success:V},T.isPlainObject(M)&&M))}}),T.ajaxPrefilter(function(v){var S;for(S in v.headers)S.toLowerCase()==="content-type"&&(v.contentType=v.headers[S]||"")}),T._evalUrl=function(v,S,M){return T.ajax({url:v,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(R){T.globalEval(R,S,M)}})},T.fn.extend({wrapAll:function(v){var S;return this[0]&&(G(v)&&(v=v.call(this[0])),S=T(v,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&S.insertBefore(this[0]),S.map(function(){for(var M=this;M.firstElementChild;)M=M.firstElementChild;return M}).append(this)),this},wrapInner:function(v){return G(v)?this.each(function(S){T(this).wrapInner(v.call(this,S))}):this.each(function(){var S=T(this),M=S.contents();M.length?M.wrapAll(v):S.append(v)})},wrap:function(v){var S=G(v);return this.each(function(M){T(this).wrapAll(S?v.call(this,M):v)})},unwrap:function(v){return this.parent(v).not("body").each(function(){T(this).replaceWith(this.childNodes)}),this}}),T.expr.pseudos.hidden=function(v){return!T.expr.pseudos.visible(v)},T.expr.pseudos.visible=function(v){return!!(v.offsetWidth||v.offsetHeight||v.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var Ki={0:200,1223:204},fn=T.ajaxSettings.xhr();A.cors=!!fn&&"withCredentials"in fn,A.ajax=fn=!!fn,T.ajaxTransport(function(v){var S,M;if(A.cors||fn&&!v.crossDomain)return{send:function(R,V){var q,Y=v.xhr();if(Y.open(v.type,v.url,v.async,v.username,v.password),v.xhrFields)for(q in v.xhrFields)Y[q]=v.xhrFields[q];for(q in v.mimeType&&Y.overrideMimeType&&Y.overrideMimeType(v.mimeType),v.crossDomain||R["X-Requested-With"]||(R["X-Requested-With"]="XMLHttpRequest"),R)Y.setRequestHeader(q,R[q]);S=function(ht){return function(){S&&(S=M=Y.onload=Y.onerror=Y.onabort=Y.ontimeout=Y.onreadystatechange=null,ht==="abort"?Y.abort():ht==="error"?typeof Y.status!="number"?V(0,"error"):V(Y.status,Y.statusText):V(Ki[Y.status]||Y.status,Y.statusText,(Y.responseType||"text")!=="text"||typeof Y.responseText!="string"?{binary:Y.response}:{text:Y.responseText},Y.getAllResponseHeaders()))}},Y.onload=S(),M=Y.onerror=Y.ontimeout=S("error"),Y.onabort!==void 0?Y.onabort=M:Y.onreadystatechange=function(){Y.readyState===4&&n.setTimeout(function(){S&&M()})},S=S("abort");try{Y.send(v.hasContent&&v.data||null)}catch(ht){if(S)throw ht}},abort:function(){S&&S()}}}),T.ajaxPrefilter(function(v){v.crossDomain&&(v.contents.script=!1)}),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(v){return T.globalEval(v),v}}}),T.ajaxPrefilter("script",function(v){v.cache===void 0&&(v.cache=!1),v.crossDomain&&(v.type="GET")}),T.ajaxTransport("script",function(v){var S,M;if(v.crossDomain||v.scriptAttrs)return{send:function(R,V){S=T("<script>").attr(v.scriptAttrs||{}).prop({charset:v.scriptCharset,src:v.url}).on("load error",M=function(q){S.remove(),M=null,q&&V(q.type==="error"?404:200,q.type)}),O.head.appendChild(S[0])},abort:function(){M&&M()}}});var Zr,Qn=[],Gr=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var v=Qn.pop()||T.expando+"_"+Us.guid++;return this[v]=!0,v}}),T.ajaxPrefilter("json jsonp",function(v,S,M){var R,V,q,Y=v.jsonp!==!1&&(Gr.test(v.url)?"url":typeof v.data=="string"&&(v.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Gr.test(v.data)&&"data");if(Y||v.dataTypes[0]==="jsonp")return R=v.jsonpCallback=G(v.jsonpCallback)?v.jsonpCallback():v.jsonpCallback,Y?v[Y]=v[Y].replace(Gr,"$1"+R):v.jsonp!==!1&&(v.url+=(Wn.test(v.url)?"&":"?")+v.jsonp+"="+R),v.converters["script json"]=function(){return q||T.error(R+" was not called"),q[0]},v.dataTypes[0]="json",V=n[R],n[R]=function(){q=arguments},M.always(function(){V===void 0?T(n).removeProp(R):n[R]=V,v[R]&&(v.jsonpCallback=S.jsonpCallback,Qn.push(R)),q&&G(V)&&V(q[0]),q=V=void 0}),"script"}),A.createHTMLDocument=((Zr=O.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",Zr.childNodes.length===2),T.parseHTML=function(v,S,M){return typeof v!="string"?[]:(typeof S=="boolean"&&(M=S,S=!1),S||(A.createHTMLDocument?((R=(S=O.implementation.createHTMLDocument("")).createElement("base")).href=O.location.href,S.head.appendChild(R)):S=O),q=!M&&[],(V=ge.exec(v))?[S.createElement(V[1])]:(V=xr([v],S,q),q&&q.length&&T(q).remove(),T.merge([],V.childNodes)));var R,V,q},T.fn.load=function(v,S,M){var R,V,q,Y=this,ht=v.indexOf(" ");return-1<ht&&(R=Ur(v.slice(ht)),v=v.slice(0,ht)),G(S)?(M=S,S=void 0):S&&typeof S=="object"&&(V="POST"),0<Y.length&&T.ajax({url:v,type:V||"GET",dataType:"html",data:S}).done(function(st){q=arguments,Y.html(R?T("<div>").append(T.parseHTML(st)).find(R):st)}).always(M&&function(st,xt){Y.each(function(){M.apply(this,q||[st.responseText,xt,st])})}),this},T.expr.pseudos.animated=function(v){return T.grep(T.timers,function(S){return v===S.elem}).length},T.offset={setOffset:function(v,S,M){var R,V,q,Y,ht,st,xt=T.css(v,"position"),Tt=T(v),jt={};xt==="static"&&(v.style.position="relative"),ht=Tt.offset(),q=T.css(v,"top"),st=T.css(v,"left"),(xt==="absolute"||xt==="fixed")&&-1<(q+st).indexOf("auto")?(Y=(R=Tt.position()).top,V=R.left):(Y=parseFloat(q)||0,V=parseFloat(st)||0),G(S)&&(S=S.call(v,M,T.extend({},ht))),S.top!=null&&(jt.top=S.top-ht.top+Y),S.left!=null&&(jt.left=S.left-ht.left+V),"using"in S?S.using.call(v,jt):Tt.css(jt)}},T.fn.extend({offset:function(v){if(arguments.length)return v===void 0?this:this.each(function(V){T.offset.setOffset(this,v,V)});var S,M,R=this[0];return R?R.getClientRects().length?(S=R.getBoundingClientRect(),M=R.ownerDocument.defaultView,{top:S.top+M.pageYOffset,left:S.left+M.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var v,S,M,R=this[0],V={top:0,left:0};if(T.css(R,"position")==="fixed")S=R.getBoundingClientRect();else{for(S=this.offset(),M=R.ownerDocument,v=R.offsetParent||M.documentElement;v&&(v===M.body||v===M.documentElement)&&T.css(v,"position")==="static";)v=v.parentNode;v&&v!==R&&v.nodeType===1&&((V=T(v).offset()).top+=T.css(v,"borderTopWidth",!0),V.left+=T.css(v,"borderLeftWidth",!0))}return{top:S.top-V.top-T.css(R,"marginTop",!0),left:S.left-V.left-T.css(R,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var v=this.offsetParent;v&&T.css(v,"position")==="static";)v=v.offsetParent;return v||Kt})}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(v,S){var M=S==="pageYOffset";T.fn[v]=function(R){return vr(this,function(V,q,Y){var ht;if(B(V)?ht=V:V.nodeType===9&&(ht=V.defaultView),Y===void 0)return ht?ht[S]:V[q];ht?ht.scrollTo(M?ht.pageXOffset:Y,M?Y:ht.pageYOffset):V[q]=Y},v,R,arguments.length)}}),T.each(["top","left"],function(v,S){T.cssHooks[S]=tn(A.pixelPosition,function(M,R){if(R)return R=Jr(M,S),Qi.test(R)?T(M).position()[S]+"px":R})}),T.each({Height:"height",Width:"width"},function(v,S){T.each({padding:"inner"+v,content:S,"":"outer"+v},function(M,R){T.fn[R]=function(V,q){var Y=arguments.length&&(M||typeof V!="boolean"),ht=M||(V===!0||q===!0?"margin":"border");return vr(this,function(st,xt,Tt){var jt;return B(st)?R.indexOf("outer")===0?st["inner"+v]:st.document.documentElement["client"+v]:st.nodeType===9?(jt=st.documentElement,Math.max(st.body["scroll"+v],jt["scroll"+v],st.body["offset"+v],jt["offset"+v],jt["client"+v])):Tt===void 0?T.css(st,xt,ht):T.style(st,xt,Tt,ht)},S,Y?V:void 0,Y)}})}),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(v,S){T.fn[S]=function(M){return this.on(S,M)}}),T.fn.extend({bind:function(v,S,M){return this.on(v,null,S,M)},unbind:function(v,S){return this.off(v,null,S)},delegate:function(v,S,M,R){return this.on(S,v,M,R)},undelegate:function(v,S,M){return arguments.length===1?this.off(v,"**"):this.off(S,v||"**",M)},hover:function(v,S){return this.on("mouseenter",v).on("mouseleave",S||v)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(v,S){T.fn[S]=function(M,R){return 0<arguments.length?this.on(S,null,M,R):this.trigger(S)}});var on=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;T.proxy=function(v,S){var M,R,V;if(typeof S=="string"&&(M=v[S],S=v,v=M),G(v))return R=d.call(arguments,2),(V=function(){return v.apply(S||this,R.concat(d.call(arguments)))}).guid=v.guid=v.guid||T.guid++,V},T.holdReady=function(v){v?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=ut,T.isFunction=G,T.isWindow=B,T.camelCase=Sr,T.type=et,T.now=Date.now,T.isNumeric=function(v){var S=T.type(v);return(S==="number"||S==="string")&&!isNaN(v-parseFloat(v))},T.trim=function(v){return v==null?"":(v+"").replace(on,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return T});var ws=n.jQuery,Hi=n.$;return T.noConflict=function(v){return n.$===T&&(n.$=Hi),v&&n.jQuery===T&&(n.jQuery=ws),T},typeof c>"u"&&(n.jQuery=n.$=T),T}),function(n){typeof exports=="object"&&typeof module<"u"?module.exports=n():typeof define=="function"&&define.amd?define([],n):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).Ajv=n()}(function(){return function n(c,h,u){function d(x,E){if(!h[x]){if(!c[x]){var P=typeof require=="function"&&require;if(!E&&P)return P(x,!0);if(m)return m(x,!0);var L=new Error("Cannot find module '"+x+"'");throw L.code="MODULE_NOT_FOUND",L}var F=h[x]={exports:{}};c[x][0].call(F.exports,function(U){return d(c[x][1][U]||U)},F,F.exports,n,c,h,u)}return h[x].exports}for(var m=typeof require=="function"&&require,g=0;g<u.length;g++)d(u[g]);return d}({1:[function(n,c,h){"use strict";var u=c.exports=function(){this._cache={}};u.prototype.put=function(d,m){this._cache[d]=m},u.prototype.get=function(d){return this._cache[d]},u.prototype.del=function(d){delete this._cache[d]},u.prototype.clear=function(){this._cache={}}},{}],2:[function(n,c,h){"use strict";var u=n("./error_classes").MissingRef;c.exports=function d(m,g,x){var E=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof g=="function"&&(x=g,g=void 0);var P=L(m).then(function(){var U=E._addSchema(m,void 0,g);return U.validate||function(A){try{return E._compile(A)}catch(G){if(G instanceof u)return function(B){var O=B.missingSchema;if(et(O))throw new Error("Schema "+O+" is loaded but "+B.missingRef+" cannot be resolved");var K=E._loadingSchemas[O];return K||(K=E._loadingSchemas[O]=E._opts.loadSchema(O)).then(Q,Q),K.then(function(lt){if(!et(O))return L(lt).then(function(){et(O)||E.addSchema(lt,O,void 0,g)})}).then(function(){return F(A)});function Q(){delete E._loadingSchemas[O]}function et(lt){return E._refs[lt]||E._schemas[lt]}}(G);throw G}}(U)});return x&&P.then(function(U){x(null,U)},x),P;function L(U){var A=U.$schema;return A&&!E.getSchema(A)?d.call(E,{$ref:A},!0):Promise.resolve()}function F(U){try{return E._compile(U)}catch(A){if(A instanceof u)return function(G){var B=G.missingSchema;if(Q(B))throw new Error("Schema "+B+" is loaded but "+G.missingRef+" cannot be resolved");var O=E._loadingSchemas[B];return O||(O=E._loadingSchemas[B]=E._opts.loadSchema(B)).then(K,K),O.then(function(et){if(!Q(B))return L(et).then(function(){Q(B)||E.addSchema(et,B,void 0,g)})}).then(function(){return F(U)});function K(){delete E._loadingSchemas[B]}function Q(et){return E._refs[et]||E._schemas[et]}}(A);throw A}}}},{"./error_classes":3}],3:[function(n,c,h){"use strict";var u=n("./resolve");function d(g,x,E){this.message=E||d.message(g,x),this.missingRef=u.url(g,x),this.missingSchema=u.normalizeId(u.fullPath(this.missingRef))}function m(g){return g.prototype=Object.create(Error.prototype),g.prototype.constructor=g}c.exports={Validation:m(function(g){this.message="validation failed",this.errors=g,this.ajv=this.validation=!0}),MissingRef:m(d)},d.message=function(g,x){return"can't resolve reference "+x+" from id "+g}},{"./resolve":6}],4:[function(n,c,h){"use strict";var u=n("./util"),d=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,m=[0,31,28,31,30,31,30,31,31,30,31,30,31],g=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,x=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,E=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,P=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,L=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,F=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,U=/^(?:\/(?:[^~/]|~0|~1)*)*$/,A=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,G=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function B(T){return u.copy(B[T=T=="full"?"full":"fast"])}function O(T){var ct=T.match(d);if(!ct)return!1;var ut,ft=+ct[2],$=+ct[3];return 1<=ft&&ft<=12&&1<=$&&$<=(ft!=2||(ut=+ct[1])%4!=0||ut%100==0&&ut%400!=0?m[ft]:29)}function K(T,ct){var ut=T.match(g);if(!ut)return!1;var ft=ut[1],$=ut[2],_t=ut[3];return(ft<=23&&$<=59&&_t<=59||ft==23&&$==59&&_t==60)&&(!ct||ut[5])}(c.exports=B).fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":P,url:L,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:x,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:pt,uuid:F,"json-pointer":U,"json-pointer-uri-fragment":A,"relative-json-pointer":G},B.full={date:O,time:K,"date-time":function(T){var ct=T.split(Q);return ct.length==2&&O(ct[0])&&K(ct[1],!0)},uri:function(T){return et.test(T)&&E.test(T)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":P,url:L,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:function(T){return T.length<=255&&x.test(T)},ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:pt,uuid:F,"json-pointer":U,"json-pointer-uri-fragment":A,"relative-json-pointer":G};var Q=/t|\s/i,et=/\/|:/,lt=/[^\\]\\Z/;function pt(T){if(lt.test(T))return!1;try{return new RegExp(T),!0}catch{return!1}}},{"./util":10}],5:[function(n,c,h){"use strict";var u=n("./resolve"),d=n("./util"),m=n("./error_classes"),g=n("fast-json-stable-stringify"),x=n("../dotjs/validate"),E=d.ucs2length,P=n("fast-deep-equal"),L=m.Validation;function F(K,Q,et){for(var lt=0;lt<this._compilations.length;lt++){var pt=this._compilations[lt];if(pt.schema==K&&pt.root==Q&&pt.baseId==et)return lt}return-1}function U(K,Q){return"var pattern"+K+" = new RegExp("+d.toQuotedString(Q[K])+");"}function A(K){return"var default"+K+" = defaults["+K+"];"}function G(K,Q){return Q[K]===void 0?"":"var refVal"+K+" = refVal["+K+"];"}function B(K){return"var customRule"+K+" = customRules["+K+"];"}function O(K,Q){if(!K.length)return"";for(var et="",lt=0;lt<K.length;lt++)et+=Q(lt,K);return et}c.exports=function K(Q,et,lt,pt){var T=this,ct=this._opts,ut=[void 0],ft={},$=[],_t={},W=[],rt={},nt=[];et=et||{schema:Q,refVal:ut,refs:ft};var vt=function(Ue,Fe,Lr){var De=F.call(this,Ue,Fe,Lr);return 0<=De?{index:De,compiling:!0}:{index:De=this._compilations.length,compiling:(this._compilations[De]={schema:Ue,root:Fe,baseId:Lr},!1)}}.call(this,Q,et,pt),Mt=this._compilations[vt.index];if(vt.compiling)return Mt.callValidate=function Ue(){var Fe=Mt.validate,Lr=Fe.apply(this,arguments);return Ue.errors=Fe.errors,Lr};var Bt=this._formats,Vt=this.RULES;try{var Lt=ge(Q,et,lt,pt);Mt.validate=Lt;var Ne=Mt.callValidate;return Ne&&(Ne.schema=Lt.schema,Ne.errors=null,Ne.refs=Lt.refs,Ne.refVal=Lt.refVal,Ne.root=Lt.root,Ne.$async=Lt.$async,ct.sourceCode&&(Ne.source=Lt.source)),Lt}finally{(function(Ue,Fe,Lr){var De=F.call(this,Ue,Fe,Lr);0<=De&&this._compilations.splice(De,1)}).call(this,Q,et,pt)}function ge(Ue,Fe,Lr,De){var se=!Fe||Fe&&Fe.schema==Ue;if(Fe.schema!=et.schema)return K.call(T,Ue,Fe,Lr,De);var oe,Ar=Ue.$async===!0,vr=x({isTop:!0,schema:Ue,isRoot:se,baseId:De,root:Fe,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:m.MissingRef,RULES:Vt,validate:x,util:d,resolve:u,resolveRef:Yt,usePattern:dr,useDefault:je,useCustomRule:Br,opts:ct,formats:Bt,logger:T.logger,self:T});vr=O(ut,G)+O($,U)+O(W,A)+O(nt,B)+vr,ct.processCode&&(vr=ct.processCode(vr));try{var Kr=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",vr);oe=Kr(T,Vt,Bt,et,ut,W,nt,P,E,L),ut[0]=oe}catch(wi){throw T.logger.error("Error compiling schema, function code:",vr),wi}return oe.schema=Ue,oe.errors=null,oe.refs=ft,oe.refVal=ut,oe.root=se?oe:Fe,Ar&&(oe.$async=!0),ct.sourceCode===!0&&(oe.source={code:vr,patterns:$,defaults:W}),oe}function Yt(Ue,Fe,Lr){Fe=u.url(Ue,Fe);var De,se,oe=ft[Fe];if(oe!==void 0)return ne(De=ut[oe],se="refVal["+oe+"]");if(!Lr&&et.refs){var Ar=et.refs[Fe];if(Ar!==void 0)return se=ue(Fe,De=et.refVal[Ar]),ne(De,se)}se=ue(Fe);var vr=u.call(T,ge,et,Fe);if(vr===void 0){var Kr=lt&&lt[Fe];Kr&&(vr=u.inlineRef(Kr,ct.inlineRefs)?Kr:K.call(T,Kr,et,lt,Ue))}if(vr!==void 0)return ut[ft[Fe]]=vr,ne(vr,se);delete ft[Fe]}function ue(Ue,Fe){var Lr=ut.length;return ut[Lr]=Fe,"refVal"+(ft[Ue]=Lr)}function ne(Ue,Fe){return typeof Ue=="object"||typeof Ue=="boolean"?{code:Fe,schema:Ue,inline:!0}:{code:Fe,$async:Ue&&!!Ue.$async}}function dr(Ue){var Fe=_t[Ue];return Fe===void 0&&(Fe=_t[Ue]=$.length,$[Fe]=Ue),"pattern"+Fe}function je(Ue){switch(typeof Ue){case"boolean":case"number":return""+Ue;case"string":return d.toQuotedString(Ue);case"object":if(Ue===null)return"null";var Fe=g(Ue),Lr=rt[Fe];return Lr===void 0&&(Lr=rt[Fe]=W.length,W[Lr]=Ue),"default"+Lr}}function Br(Ue,Fe,Lr,De){var se=Ue.definition.validateSchema;if(se&&T._opts.validateSchema!==!1){var oe=se(Fe);if(!oe){var Ar="keyword schema is invalid: "+T.errorsText(se.errors);if(T._opts.validateSchema!="log")throw new Error(Ar);T.logger.error(Ar)}}var vr,Kr=Ue.definition.compile,wi=Ue.definition.inline,Ee=Ue.definition.macro;if(Kr)vr=Kr.call(T,Fe,Lr,De);else if(Ee)vr=Ee.call(T,Fe,Lr,De),ct.validateSchema!==!1&&T.validateSchema(vr,!0);else if(wi)vr=wi.call(T,De,Ue.keyword,Fe,Lr);else if(!(vr=Ue.definition.validate))return;if(vr===void 0)throw new Error('custom keyword "'+Ue.keyword+'"failed to compile');var Sr=nt.length;return{code:"customRule"+Sr,validate:nt[Sr]=vr}}}},{"../dotjs/validate":37,"./error_classes":3,"./resolve":6,"./util":10,"fast-deep-equal":41,"fast-json-stable-stringify":42}],6:[function(n,c,h){"use strict";var u=n("uri-js"),d=n("fast-deep-equal"),m=n("./util"),g=n("./schema_obj"),x=n("json-schema-traverse");function E(et,lt,pt){var T=this._refs[pt];if(typeof T=="string"){if(!this._refs[T])return E.call(this,et,lt,T);T=this._refs[T]}if((T=T||this._schemas[pt])instanceof g)return A(T.schema,this._opts.inlineRefs)?T.schema:T.validate||this._compile(T);var ct,ut,ft,$=P.call(this,lt,pt);return $&&(ct=$.schema,lt=$.root,ft=$.baseId),ct instanceof g?ut=ct.validate||et.call(this,ct.schema,lt,void 0,ft):ct!==void 0&&(ut=A(ct,this._opts.inlineRefs)?ct:et.call(this,ct,lt,void 0,ft)),ut}function P(et,lt){var pt=u.parse(lt),T=B(pt),ct=G(this._getId(et.schema));if(T!==ct){var ut=K(T),ft=this._refs[ut];if(typeof ft=="string")return function($,_t,W){var rt=P.call(this,$,_t);if(rt){var nt=rt.schema,vt=rt.baseId;$=rt.root;var Mt=this._getId(nt);return Mt&&(vt=Q(vt,Mt)),F.call(this,W,vt,nt,$)}}.call(this,et,ft,pt);if(ft instanceof g)ft.validate||this._compile(ft),et=ft;else{if(!((ft=this._schemas[ut])instanceof g))return;if(ft.validate||this._compile(ft),ut==K(lt))return{schema:ft,root:et,baseId:ct};et=ft}if(!et.schema)return;ct=G(this._getId(et.schema))}return F.call(this,pt,ct,et.schema,et)}(c.exports=E).normalizeId=K,E.fullPath=G,E.url=Q,E.ids=function(et){var lt=K(this._getId(et)),pt={"":lt},T={"":G(lt,!1)},ct={},ut=this;return x(et,{allKeys:!0},function(ft,$,_t,W,rt,nt,vt){if($!==""){var Mt=ut._getId(ft),Bt=pt[W],Vt=T[W]+"/"+rt;if(vt!==void 0&&(Vt+="/"+(typeof vt=="number"?vt:m.escapeFragment(vt))),typeof Mt=="string"){Mt=Bt=K(Bt?u.resolve(Bt,Mt):Mt);var Lt=ut._refs[Mt];if(typeof Lt=="string"&&(Lt=ut._refs[Lt]),Lt&&Lt.schema){if(!d(ft,Lt.schema))throw new Error('id "'+Mt+'" resolves to more than one schema')}else if(Mt!=K(Vt))if(Mt[0]=="#"){if(ct[Mt]&&!d(ft,ct[Mt]))throw new Error('id "'+Mt+'" resolves to more than one schema');ct[Mt]=ft}else ut._refs[Mt]=Vt}pt[$]=Bt,T[$]=Vt}}),ct},E.inlineRef=A,E.schema=P;var L=m.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function F(et,lt,pt,T){if(et.fragment=et.fragment||"",et.fragment.slice(0,1)=="/"){for(var ct=et.fragment.split("/"),ut=1;ut<ct.length;ut++){var ft=ct[ut];if(ft){if((pt=pt[ft=m.unescapeFragment(ft)])===void 0)break;var $;if(!L[ft]&&(($=this._getId(pt))&&(lt=Q(lt,$)),pt.$ref)){var _t=Q(lt,pt.$ref),W=P.call(this,T,_t);W&&(pt=W.schema,T=W.root,lt=W.baseId)}}}return pt!==void 0&&pt!==T.schema?{schema:pt,root:T,baseId:lt}:void 0}}var U=m.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function A(et,lt){return lt!==!1&&(lt===void 0||lt===!0?function pt(T){var ct;if(Array.isArray(T)){for(var ut=0;ut<T.length;ut++)if(typeof(ct=T[ut])=="object"&&!pt(ct))return!1}else for(var ft in T)if(ft=="$ref"||typeof(ct=T[ft])=="object"&&!pt(ct))return!1;return!0}(et):lt?function pt(T){var ct,ut=0;if(Array.isArray(T)){for(var ft=0;ft<T.length;ft++)if(typeof(ct=T[ft])=="object"&&(ut+=pt(ct)),ut==1/0)return 1/0}else for(var $ in T){if($=="$ref")return 1/0;if(U[$])ut++;else if(typeof(ct=T[$])=="object"&&(ut+=pt(ct)+1),ut==1/0)return 1/0}return ut}(et)<=lt:void 0)}function G(et,lt){return lt!==!1&&(et=K(et)),B(u.parse(et))}function B(et){return u.serialize(et).split("#")[0]+"#"}var O=/#\/?$/;function K(et){return et?et.replace(O,""):""}function Q(et,lt){return lt=K(lt),u.resolve(et,lt)}},{"./schema_obj":8,"./util":10,"fast-deep-equal":41,"json-schema-traverse":43,"uri-js":44}],7:[function(n,c,h){"use strict";var u=n("../dotjs"),d=n("./util").toHash;c.exports=function(){var m=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],g=["type","$comment"];return m.all=d(g),m.types=d(["number","integer","string","array","object","boolean","null"]),m.forEach(function(x){x.rules=x.rules.map(function(E){var P;if(typeof E=="object"){var L=Object.keys(E)[0];P=E[L],E=L,P.forEach(function(F){g.push(F),m.all[F]=!0})}return g.push(E),m.all[E]={keyword:E,code:u[E],implements:P}}),m.all.$comment={keyword:"$comment",code:u.$comment},x.type&&(m.types[x.type]=x)}),m.keywords=d(g.concat(["$schema","$id","id","$data","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),m.custom={},m}},{"../dotjs":26,"./util":10}],8:[function(n,c,h){"use strict";var u=n("./util");c.exports=function(d){u.copy(d,this)}},{"./util":10}],9:[function(n,c,h){"use strict";c.exports=function(u){for(var d,m=0,g=u.length,x=0;x<g;)m++,55296<=(d=u.charCodeAt(x++))&&d<=56319&&x<g&&(64512&(d=u.charCodeAt(x)))==56320&&x++;return m}},{}],10:[function(n,c,h){"use strict";function u(W,rt,nt){var vt=nt?" !== ":" === ",Mt=nt?" || ":" && ",Bt=nt?"!":"",Vt=nt?"":"!";switch(W){case"null":return rt+vt+"null";case"array":return Bt+"Array.isArray("+rt+")";case"object":return"("+Bt+rt+Mt+"typeof "+rt+vt+'"object"'+Mt+Vt+"Array.isArray("+rt+"))";case"integer":return"(typeof "+rt+vt+'"number"'+Mt+Vt+"("+rt+" % 1)"+Mt+rt+vt+rt+")";default:return"typeof "+rt+vt+'"'+W+'"'}}c.exports={copy:function(W,rt){for(var nt in rt=rt||{},W)rt[nt]=W[nt];return rt},checkDataType:u,checkDataTypes:function(W,rt){switch(W.length){case 1:return u(W[0],rt,!0);default:var nt="",vt=m(W);for(var Mt in vt.array&&vt.object&&(nt=vt.null?"(":"(!"+rt+" || ",nt+="typeof "+rt+' !== "object")',delete vt.null,delete vt.array,delete vt.object),vt.number&&delete vt.integer,vt)nt+=(nt?" && ":"")+u(Mt,rt,!0);return nt}},coerceToTypes:function(W,rt){if(Array.isArray(rt)){for(var nt=[],vt=0;vt<rt.length;vt++){var Mt=rt[vt];(d[Mt]||W==="array"&&Mt==="array")&&(nt[nt.length]=Mt)}if(nt.length)return nt}else{if(d[rt])return[rt];if(W==="array"&&rt==="array")return["array"]}},toHash:m,getProperty:E,escapeQuotes:P,equal:n("fast-deep-equal"),ucs2length:n("./ucs2length"),varOccurences:function(W,rt){var nt=W.match(new RegExp(rt+="[^0-9]","g"));return nt?nt.length:0},varReplace:function(W,rt,nt){return rt+="([^0-9])",nt=nt.replace(/\$/g,"$$$$"),W.replace(new RegExp(rt,"g"),nt+"$1")},cleanUpCode:function(W){return W.replace(L,"").replace(F,"").replace(U,"if (!($1))")},finalCleanUpCode:function(W,rt){var nt=W.match(A);return nt&&nt.length==2&&(W=rt?W.replace(B,"").replace(Q,et):W.replace(G,"").replace(O,K)),(nt=W.match(lt))&&nt.length===3?W.replace(pt,""):W},schemaHasRules:function(W,rt){if(typeof W=="boolean")return!W;for(var nt in W)if(rt[nt])return!0},schemaHasRulesExcept:function(W,rt,nt){if(typeof W=="boolean")return!W&&nt!="not";for(var vt in W)if(vt!=nt&&rt[vt])return!0},toQuotedString:T,getPathExpr:function(W,rt,nt,vt){return ft(W,nt?"'/' + "+rt+(vt?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):vt?"'[' + "+rt+" + ']'":"'[\\'' + "+rt+" + '\\']'")},getPath:function(W,rt,nt){var vt=T(nt?"/"+$(rt):E(rt));return ft(W,vt)},getData:function(W,rt,nt){var vt,Mt,Bt,Vt;if(W==="")return"rootData";if(W[0]=="/"){if(!ct.test(W))throw new Error("Invalid JSON-pointer: "+W);Mt=W,Bt="rootData"}else{if(!(Vt=W.match(ut)))throw new Error("Invalid JSON-pointer: "+W);if(vt=+Vt[1],(Mt=Vt[2])=="#"){if(rt<=vt)throw new Error("Cannot access property/index "+vt+" levels up, current level is "+rt);return nt[rt-vt]}if(rt<vt)throw new Error("Cannot access data "+vt+" levels up, current level is "+rt);if(Bt="data"+(rt-vt||""),!Mt)return Bt}for(var Lt=Bt,Ne=Mt.split("/"),ge=0;ge<Ne.length;ge++){var Yt=Ne[ge];Yt&&(Bt+=E(_t(Yt)),Lt+=" && "+Bt)}return Lt},unescapeFragment:function(W){return _t(decodeURIComponent(W))},unescapeJsonPointer:_t,escapeFragment:function(W){return encodeURIComponent($(W))},escapeJsonPointer:$};var d=m(["string","number","integer","boolean","null"]);function m(W){for(var rt={},nt=0;nt<W.length;nt++)rt[W[nt]]=!0;return rt}var g=/^[a-z$_][a-z$_0-9]*$/i,x=/'|\\/g;function E(W){return typeof W=="number"?"["+W+"]":g.test(W)?"."+W:"['"+P(W)+"']"}function P(W){return W.replace(x,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var L=/else\s*{\s*}/g,F=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,U=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,A=/[^v.]errors/g,G=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,B=/var errors = 0;|var vErrors = null;/g,O="return errors === 0;",K="validate.errors = null; return true;",Q=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,et="return data;",lt=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,pt=/if \(rootData === undefined\) rootData = data;/;function T(W){return"'"+P(W)+"'"}var ct=/^\/(?:[^~]|~0|~1)*$/,ut=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ft(W,rt){return W=='""'?rt:(W+" + "+rt).replace(/' \+ '/g,"")}function $(W){return W.replace(/~/g,"~0").replace(/\//g,"~1")}function _t(W){return W.replace(/~1/g,"/").replace(/~0/g,"~")}},{"./ucs2length":9,"fast-deep-equal":41}],11:[function(n,c,h){"use strict";var u=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];c.exports=function(d,m){for(var g=0;g<m.length;g++){d=JSON.parse(JSON.stringify(d));var x,E=m[g].split("/"),P=d;for(x=1;x<E.length;x++)P=P[E[x]];for(x=0;x<u.length;x++){var L=u[x],F=P[L];F&&(P[L]={anyOf:[F,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return d}},{}],12:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L;var O=d=="maximum",K=O?"exclusiveMaximum":"exclusiveMinimum",Q=u.schema[K],et=u.opts.$data&&Q&&Q.$data,lt=O?"<":">",pt=O?">":"<",T=void 0;if(et){var ct=u.util.getData(Q.$data,P,u.dataPathArr),ut="exclusive"+E,ft="exclType"+E,$="exclIsNumber"+E,_t="' + "+(nt="op"+E)+" + '";x+=" var schemaExcl"+E+" = "+ct+"; ";var W;T=K,(W=W||[]).push(x+=" var "+ut+"; var "+ft+" = typeof "+(ct="schemaExcl"+E)+"; if ("+ft+" != 'boolean' && "+ft+" != 'undefined' && "+ft+" != 'number') { "),x="",u.createErrors!==!1?(x+=" { keyword: '"+(T||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: {} ",u.opts.messages!==!1&&(x+=" , message: '"+K+" should be boolean' "),u.opts.verbose&&(x+=" , schema: validate.schema"+F+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var rt=x;x=W.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+rt+"]); ":" validate.errors = ["+rt+"]; return false; ":" var err = "+rt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+=" } else if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || "),x+=" "+ft+" == 'number' ? ( ("+ut+" = "+g+" === undefined || "+ct+" "+lt+"= "+g+") ? "+G+" "+pt+"= "+ct+" : "+G+" "+pt+" "+g+" ) : ( ("+ut+" = "+ct+" === true) ? "+G+" "+pt+"= "+g+" : "+G+" "+pt+" "+g+" ) || "+G+" !== "+G+") { var op"+E+" = "+ut+" ? '"+lt+"' : '"+lt+"='; ",L===void 0&&(U=u.errSchemaPath+"/"+(T=K),g=ct,B=et)}else if(_t=lt,($=typeof Q=="number")&&B){var nt="'"+_t+"'";x+=" if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || "),x+=" ( "+g+" === undefined || "+Q+" "+lt+"= "+g+" ? "+G+" "+pt+"= "+Q+" : "+G+" "+pt+" "+g+" ) || "+G+" !== "+G+") { "}else $&&L===void 0?(ut=!0,U=u.errSchemaPath+"/"+(T=K),g=Q,pt+="="):($&&(g=Math[O?"min":"max"](Q,L)),Q===(!$||g)?(ut=!0,U=u.errSchemaPath+"/"+(T=K),pt+="="):(ut=!1,_t+="=")),nt="'"+_t+"'",x+=" if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || "),x+=" "+G+" "+pt+" "+g+" || "+G+" !== "+G+") { ";return T=T||d,(W=W||[]).push(x),x="",u.createErrors!==!1?(x+=" { keyword: '"+(T||"_limit")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { comparison: "+nt+", limit: "+g+", exclusive: "+ut+" } ",u.opts.messages!==!1&&(x+=" , message: 'should be "+_t+" ",x+=B?"' + "+g:g+"'"),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ",rt=x,x=W.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+rt+"]); ":" validate.errors = ["+rt+"]; return false; ":" var err = "+rt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+=" } ",A&&(x+=" else { "),x}},{}],13:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L,x+="if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || ");var O=d,K=K||[];K.push(x+=" "+G+".length "+(d=="maxItems"?">":"<")+" "+g+") { "),x="",u.createErrors!==!1?(x+=" { keyword: '"+(O||"_limitItems")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { limit: "+g+" } ",u.opts.messages!==!1&&(x+=" , message: 'should NOT have ",x+=d=="maxItems"?"more":"less",x+=" than ",x+=B?"' + "+g+" + '":""+L,x+=" items' "),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var Q=x;return x=K.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+="} ",A&&(x+=" else { "),x}},{}],14:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L,x+="if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || "),x+=u.opts.unicode===!1?" "+G+".length ":" ucs2length("+G+") ";var O=d,K=K||[];K.push(x+=" "+(d=="maxLength"?">":"<")+" "+g+") { "),x="",u.createErrors!==!1?(x+=" { keyword: '"+(O||"_limitLength")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { limit: "+g+" } ",u.opts.messages!==!1&&(x+=" , message: 'should NOT be ",x+=d=="maxLength"?"longer":"shorter",x+=" than ",x+=B?"' + "+g+" + '":""+L,x+=" characters' "),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var Q=x;return x=K.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+="} ",A&&(x+=" else { "),x}},{}],15:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L,x+="if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'number') || ");var O=d,K=K||[];K.push(x+=" Object.keys("+G+").length "+(d=="maxProperties"?">":"<")+" "+g+") { "),x="",u.createErrors!==!1?(x+=" { keyword: '"+(O||"_limitProperties")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { limit: "+g+" } ",u.opts.messages!==!1&&(x+=" , message: 'should NOT have ",x+=d=="maxProperties"?"more":"less",x+=" than ",x+=B?"' + "+g+" + '":""+L,x+=" properties' "),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var Q=x;return x=K.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+="} ",A&&(x+=" else { "),x}},{}],16:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.schema[d],E=u.schemaPath+u.util.getProperty(d),P=u.errSchemaPath+"/"+d,L=!u.opts.allErrors,F=u.util.copy(u),U="";F.level++;var A="valid"+F.level,G=F.baseId,B=!0,O=x;if(O)for(var K,Q=-1,et=O.length-1;Q<et;)K=O[Q+=1],u.util.schemaHasRules(K,u.RULES.all)&&(B=!1,F.schema=K,F.schemaPath=E+"["+Q+"]",F.errSchemaPath=P+"/"+Q,g+="  "+u.validate(F)+" ",F.baseId=G,L&&(g+=" if ("+A+") { ",U+="}"));return L&&(g+=B?" if (true) { ":" "+U.slice(0,-1)+" "),g=u.util.cleanUpCode(g)}},{}],17:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B="errs__"+x,O=u.util.copy(u),K="";O.level++;var Q="valid"+O.level;if(P.every(function(ft){return u.util.schemaHasRules(ft,u.RULES.all)})){var et=O.baseId;g+=" var "+B+" = errors; var "+G+" = false;  ";var lt=u.compositeRule;u.compositeRule=O.compositeRule=!0;var pt=P;if(pt)for(var T,ct=-1,ut=pt.length-1;ct<ut;)T=pt[ct+=1],O.schema=T,O.schemaPath=L+"["+ct+"]",O.errSchemaPath=F+"/"+ct,g+="  "+u.validate(O)+" ",O.baseId=et,g+=" "+G+" = "+G+" || "+Q+"; if (!"+G+") { ",K+="}";u.compositeRule=O.compositeRule=lt,g+=" "+K+" if (!"+G+") {   var err =   ",u.createErrors!==!1?(g+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: {} ",u.opts.messages!==!1&&(g+=" , message: 'should match some schema in anyOf' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!u.compositeRule&&U&&(g+=u.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),g+=" } else {  errors = "+B+"; if (vErrors !== null) { if ("+B+") vErrors.length = "+B+"; else vErrors = null; } ",u.opts.allErrors&&(g+=" } "),g=u.util.cleanUpCode(g)}else U&&(g+=" if (true) { ");return g}},{}],18:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.errSchemaPath+"/"+d,E=u.util.toQuotedString(u.schema[d]);return u.opts.$comment===!0?g+=" console.log("+E+");":typeof u.opts.$comment=="function"&&(g+=" self._opts.$comment("+E+", "+u.util.toQuotedString(x)+", validate.root.schema);"),g}},{}],19:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B=u.opts.$data&&P&&P.$data;B&&(g+=" var schema"+x+" = "+u.util.getData(P.$data,E,u.dataPathArr)+"; "),B||(g+=" var schema"+x+" = validate.schema"+L+";");var O=O||[];O.push(g+="var "+G+" = equal("+A+", schema"+x+"); if (!"+G+") {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'const' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { allowedValue: schema"+x+" } ",u.opts.messages!==!1&&(g+=" , message: 'should be equal to constant' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var K=g;return g=O.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" }",U&&(g+=" else { "),g}},{}],20:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B="errs__"+x,O=u.util.copy(u);O.level++;var K="valid"+O.level,Q="i"+x,et=O.dataLevel=u.dataLevel+1,lt="data"+et,pt=u.baseId,T=u.util.schemaHasRules(P,u.RULES.all);if(g+="var "+B+" = errors;var "+G+";",T){var ct=u.compositeRule;u.compositeRule=O.compositeRule=!0,O.schema=P,O.schemaPath=L,O.errSchemaPath=F,g+=" var "+K+" = false; for (var "+Q+" = 0; "+Q+" < "+A+".length; "+Q+"++) { ",O.errorPath=u.util.getPathExpr(u.errorPath,Q,u.opts.jsonPointers,!0);var ut=A+"["+Q+"]";O.dataPathArr[et]=Q;var ft=u.validate(O);O.baseId=pt,u.util.varOccurences(ft,lt)<2?g+=" "+u.util.varReplace(ft,lt,ut)+" ":g+=" var "+lt+" = "+ut+"; "+ft+" ",g+=" if ("+K+") break; }  ",u.compositeRule=O.compositeRule=ct,g+="  if (!"+K+") {"}else g+=" if ("+A+".length == 0) {";var $=$||[];$.push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: {} ",u.opts.messages!==!1&&(g+=" , message: 'should contain a valid item' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var _t=g;return g=$.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+_t+"]); ":" validate.errors = ["+_t+"]; return false; ":" var err = "+_t+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } else { ",T&&(g+="  errors = "+B+"; if (vErrors !== null) { if ("+B+") vErrors.length = "+B+"; else vErrors = null; } "),u.opts.allErrors&&(g+=" } "),g=u.util.cleanUpCode(g)}},{}],21:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x,E=" ",P=u.level,L=u.dataLevel,F=u.schema[d],U=u.schemaPath+u.util.getProperty(d),A=u.errSchemaPath+"/"+d,G=!u.opts.allErrors,B="data"+(L||""),O="valid"+P,K="errs__"+P,Q=u.opts.$data&&F&&F.$data;Q?(E+=" var schema"+P+" = "+u.util.getData(F.$data,L,u.dataPathArr)+"; ",x="schema"+P):x=F;var et,lt,pt,T,ct,ut=this,ft="definition"+P,$=ut.definition,_t="";if(Q&&$.$data){var W=$.validateSchema;E+=" var "+ft+" = RULES.custom['"+d+"'].definition; var "+(ct="keywordValidate"+P)+" = "+ft+".validate;"}else{if(!(T=u.useCustomRule(ut,F,u.schema,u)))return;x="validate.schema"+U,ct=T.code,et=$.compile,lt=$.inline,pt=$.macro}var rt=ct+".errors",nt="i"+P,vt="ruleErr"+P,Mt=$.async;if(Mt&&!u.async)throw new Error("async keyword in sync schema");if(lt||pt||(E+=rt+" = null;"),E+="var "+K+" = errors;var "+O+";",Q&&$.$data&&(_t+="}",E+=" if ("+x+" === undefined) { "+O+" = true; } else { ",W&&(_t+="}",E+=" "+O+" = "+ft+".validateSchema("+x+"); if ("+O+") { ")),lt)E+=$.statements?" "+T.validate+" ":" "+O+" = "+T.validate+"; ";else if(pt){var Bt=u.util.copy(u);_t="",Bt.level++;var Vt="valid"+Bt.level;Bt.schema=T.validate,Bt.schemaPath="";var Lt=u.compositeRule;u.compositeRule=Bt.compositeRule=!0;var Ne=u.validate(Bt).replace(/validate\.schema/g,ct);u.compositeRule=Bt.compositeRule=Lt,E+=" "+Ne}else{(ne=ne||[]).push(E),E="",E+="  "+ct+".call( ",E+=u.opts.passContext?"this":"self",E+=et||$.schema===!1?" , "+B+" ":" , "+x+" , "+B+" , validate.schema"+u.schemaPath+" ",E+=" , (dataPath || '')",u.errorPath!='""'&&(E+=" + "+u.errorPath);var ge=L?"data"+(L-1||""):"parentData",Yt=L?u.dataPathArr[L]:"parentDataProperty",ue=E+=" , "+ge+" , "+Yt+" , rootData )  ";E=ne.pop(),$.errors===!1?(E+=" "+O+" = ",Mt&&(E+="await "),E+=ue+"; "):E+=Mt?" var "+(rt="customErrors"+P)+" = null; try { "+O+" = await "+ue+"; } catch (e) { "+O+" = false; if (e instanceof ValidationError) "+rt+" = e.errors; else throw e; } ":" "+rt+" = null; "+O+" = "+ue+"; "}if($.modifying&&(E+=" if ("+ge+") "+B+" = "+ge+"["+Yt+"];"),E+=""+_t,$.valid)G&&(E+=" if (true) { ");else{var ne;E+=" if ( ",$.valid===void 0?(E+=" !",E+=pt?""+Vt:""+O):E+=" "+!$.valid+" ",g=ut.keyword,(ne=ne||[]).push(E+=") { "),(ne=ne||[]).push(E=""),E="",u.createErrors!==!1?(E+=" { keyword: '"+(g||"custom")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(A)+" , params: { keyword: '"+ut.keyword+"' } ",u.opts.messages!==!1&&(E+=` , message: 'should pass "`+ut.keyword+`" keyword validation' `),u.opts.verbose&&(E+=" , schema: validate.schema"+U+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+B+" "),E+=" } "):E+=" {} ";var dr=E;E=ne.pop();var je=E+=!u.compositeRule&&G?u.async?" throw new ValidationError(["+dr+"]); ":" validate.errors = ["+dr+"]; return false; ":" var err = "+dr+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";E=ne.pop(),lt?$.errors?$.errors!="full"&&(E+="  for (var "+nt+"="+K+"; "+nt+"<errors; "+nt+"++) { var "+vt+" = vErrors["+nt+"]; if ("+vt+".dataPath === undefined) "+vt+".dataPath = (dataPath || '') + "+u.errorPath+"; if ("+vt+".schemaPath === undefined) { "+vt+'.schemaPath = "'+A+'"; } ',u.opts.verbose&&(E+=" "+vt+".schema = "+x+"; "+vt+".data = "+B+"; "),E+=" } "):$.errors===!1?E+=" "+je+" ":(E+=" if ("+K+" == errors) { "+je+" } else {  for (var "+nt+"="+K+"; "+nt+"<errors; "+nt+"++) { var "+vt+" = vErrors["+nt+"]; if ("+vt+".dataPath === undefined) "+vt+".dataPath = (dataPath || '') + "+u.errorPath+"; if ("+vt+".schemaPath === undefined) { "+vt+'.schemaPath = "'+A+'"; } ',u.opts.verbose&&(E+=" "+vt+".schema = "+x+"; "+vt+".data = "+B+"; "),E+=" } } "):pt?(E+="   var err =   ",u.createErrors!==!1?(E+=" { keyword: '"+(g||"custom")+"' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(A)+" , params: { keyword: '"+ut.keyword+"' } ",u.opts.messages!==!1&&(E+=` , message: 'should pass "`+ut.keyword+`" keyword validation' `),u.opts.verbose&&(E+=" , schema: validate.schema"+U+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+B+" "),E+=" } "):E+=" {} ",E+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!u.compositeRule&&G&&(E+=u.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; ")):$.errors===!1?E+=" "+je+" ":(E+=" if (Array.isArray("+rt+")) { if (vErrors === null) vErrors = "+rt+"; else vErrors = vErrors.concat("+rt+"); errors = vErrors.length;  for (var "+nt+"="+K+"; "+nt+"<errors; "+nt+"++) { var "+vt+" = vErrors["+nt+"]; if ("+vt+".dataPath === undefined) "+vt+".dataPath = (dataPath || '') + "+u.errorPath+";  "+vt+'.schemaPath = "'+A+'";  ',u.opts.verbose&&(E+=" "+vt+".schema = "+x+"; "+vt+".data = "+B+"; "),E+=" } } else { "+je+" } "),E+=" } ",G&&(E+=" else { ")}return E}},{}],22:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="errs__"+x,B=u.util.copy(u),O="";B.level++;var K="valid"+B.level,Q={},et={},lt=u.opts.ownProperties;for(ut in P){var pt=P[ut],T=Array.isArray(pt)?et:Q;T[ut]=pt}g+="var "+G+" = errors;";var ct=u.errorPath;for(var ut in g+="var missing"+x+";",et)if((T=et[ut]).length){if(g+=" if ( "+A+u.util.getProperty(ut)+" !== undefined ",lt&&(g+=" && Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(ut)+"') "),U){g+=" && ( ";var ft=T;if(ft)for(var $=-1,_t=ft.length-1;$<_t;)Bt=ft[$+=1],$&&(g+=" || "),g+=" ( ( "+(ge=A+(Ne=u.util.getProperty(Bt)))+" === undefined ",lt&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(Bt)+"') "),g+=") && (missing"+x+" = "+u.util.toQuotedString(u.opts.jsonPointers?Bt:Ne)+") ) ";g+=")) {  ";var W="missing"+x,rt="' + "+W+" + '";u.opts._errorDataPathProperty&&(u.errorPath=u.opts.jsonPointers?u.util.getPathExpr(ct,W,!0):ct+" + "+W);var nt=nt||[];nt.push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { property: '"+u.util.escapeQuotes(ut)+"', missingProperty: '"+rt+"', depsCount: "+T.length+", deps: '"+u.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",u.opts.messages!==!1&&(g+=" , message: 'should have ",g+=T.length==1?"property "+u.util.escapeQuotes(T[0]):"properties "+u.util.escapeQuotes(T.join(", ")),g+=" when property "+u.util.escapeQuotes(ut)+" is present' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var vt=g;g=nt.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+vt+"]); ":" validate.errors = ["+vt+"]; return false; ":" var err = "+vt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{g+=" ) { ";var Mt=T;if(Mt)for(var Bt,Vt=-1,Lt=Mt.length-1;Vt<Lt;){Bt=Mt[Vt+=1];var Ne=u.util.getProperty(Bt),ge=(rt=u.util.escapeQuotes(Bt),A+Ne);u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPath(ct,Bt,u.opts.jsonPointers)),g+=" if ( "+ge+" === undefined ",lt&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(Bt)+"') "),g+=") {  var err =   ",u.createErrors!==!1?(g+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { property: '"+u.util.escapeQuotes(ut)+"', missingProperty: '"+rt+"', depsCount: "+T.length+", deps: '"+u.util.escapeQuotes(T.length==1?T[0]:T.join(", "))+"' } ",u.opts.messages!==!1&&(g+=" , message: 'should have ",g+=T.length==1?"property "+u.util.escapeQuotes(T[0]):"properties "+u.util.escapeQuotes(T.join(", ")),g+=" when property "+u.util.escapeQuotes(ut)+" is present' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}g+=" }   ",U&&(O+="}",g+=" else { ")}u.errorPath=ct;var Yt=B.baseId;for(var ut in Q)u.util.schemaHasRules(pt=Q[ut],u.RULES.all)&&(g+=" "+K+" = true; if ( "+A+u.util.getProperty(ut)+" !== undefined ",lt&&(g+=" && Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(ut)+"') "),g+=") { ",B.schema=pt,B.schemaPath=L+u.util.getProperty(ut),B.errSchemaPath=F+"/"+u.util.escapeFragment(ut),g+="  "+u.validate(B)+" ",B.baseId=Yt,g+=" }  ",U&&(g+=" if ("+K+") { ",O+="}"));return U&&(g+="   "+O+" if ("+G+" == errors) {"),g=u.util.cleanUpCode(g)}},{}],23:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B=u.opts.$data&&P&&P.$data;B&&(g+=" var schema"+x+" = "+u.util.getData(P.$data,E,u.dataPathArr)+"; ");var O="i"+x,K="schema"+x;B||(g+=" var "+K+" = validate.schema"+L+";"),g+="var "+G+";",B&&(g+=" if (schema"+x+" === undefined) "+G+" = true; else if (!Array.isArray(schema"+x+")) "+G+" = false; else {"),g+=G+" = false;for (var "+O+"=0; "+O+"<"+K+".length; "+O+"++) if (equal("+A+", "+K+"["+O+"])) { "+G+" = true; break; }",B&&(g+="  }  ");var Q=Q||[];Q.push(g+=" if (!"+G+") {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { allowedValues: schema"+x+" } ",u.opts.messages!==!1&&(g+=" , message: 'should be equal to one of the allowed values' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var et=g;return g=Q.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+et+"]); ":" validate.errors = ["+et+"]; return false; ":" var err = "+et+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" }",U&&(g+=" else { "),g}},{}],24:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||"");if(u.opts.format===!1)return U&&(g+=" if (true) { "),g;var G,B=u.opts.$data&&P&&P.$data;B?(g+=" var schema"+x+" = "+u.util.getData(P.$data,E,u.dataPathArr)+"; ",G="schema"+x):G=P;var O=u.opts.unknownFormats,K=Array.isArray(O);if(B)g+=" var "+(Q="format"+x)+" = formats["+G+"]; var "+(et="isObject"+x)+" = typeof "+Q+" == 'object' && !("+Q+" instanceof RegExp) && "+Q+".validate; var "+(lt="formatType"+x)+" = "+et+" && "+Q+".type || 'string'; if ("+et+") { ",u.async&&(g+=" var async"+x+" = "+Q+".async; "),g+=" "+Q+" = "+Q+".validate; } if (  ",B&&(g+=" ("+G+" !== undefined && typeof "+G+" != 'string') || "),g+=" (",O!="ignore"&&(g+=" ("+G+" && !"+Q+" ",K&&(g+=" && self._opts.unknownFormats.indexOf("+G+") == -1 "),g+=") || "),g+=" ("+Q+" && "+lt+" == '"+m+"' && !(typeof "+Q+" == 'function' ? ",g+=u.async?" (async"+x+" ? await "+Q+"("+A+") : "+Q+"("+A+")) ":" "+Q+"("+A+") ",g+=" : "+Q+".test("+A+"))))) {";else{var Q;if(!(Q=u.formats[P])){if(O=="ignore")return u.logger.warn('unknown format "'+P+'" ignored in schema at path "'+u.errSchemaPath+'"'),U&&(g+=" if (true) { "),g;if(K&&0<=O.indexOf(P))return U&&(g+=" if (true) { "),g;throw new Error('unknown format "'+P+'" is used in schema at path "'+u.errSchemaPath+'"')}var et,lt=(et=typeof Q=="object"&&!(Q instanceof RegExp)&&Q.validate)&&Q.type||"string";if(et){var pt=Q.async===!0;Q=Q.validate}if(lt!=m)return U&&(g+=" if (true) { "),g;if(pt){if(!u.async)throw new Error("async format in sync schema");g+=" if (!(await "+(T="formats"+u.util.getProperty(P)+".validate")+"("+A+"))) { "}else{g+=" if (! ";var T="formats"+u.util.getProperty(P);et&&(T+=".validate"),g+=typeof Q=="function"?" "+T+"("+A+") ":" "+T+".test("+A+") ",g+=") { "}}var ct=ct||[];ct.push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'format' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { format:  ",g+=B?""+G:""+u.util.toQuotedString(P),g+="  } ",u.opts.messages!==!1&&(g+=` , message: 'should match format "`,g+=B?"' + "+G+" + '":""+u.util.escapeQuotes(P),g+=`"' `),u.opts.verbose&&(g+=" , schema:  ",g+=B?"validate.schema"+L:""+u.util.toQuotedString(P),g+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var ut=g;return g=ct.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+ut+"]); ":" validate.errors = ["+ut+"]; return false; ":" var err = "+ut+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } ",U&&(g+=" else { "),g}},{}],25:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B="errs__"+x,O=u.util.copy(u);O.level++;var K="valid"+O.level,Q=u.schema.then,et=u.schema.else,lt=Q!==void 0&&u.util.schemaHasRules(Q,u.RULES.all),pt=et!==void 0&&u.util.schemaHasRules(et,u.RULES.all),T=O.baseId;if(lt||pt){var ct;O.createErrors=!1,O.schema=P,O.schemaPath=L,O.errSchemaPath=F,g+=" var "+B+" = errors; var "+G+" = true;  ";var ut=u.compositeRule;u.compositeRule=O.compositeRule=!0,g+="  "+u.validate(O)+" ",O.baseId=T,O.createErrors=!0,g+="  errors = "+B+"; if (vErrors !== null) { if ("+B+") vErrors.length = "+B+"; else vErrors = null; }  ",u.compositeRule=O.compositeRule=ut,lt?(g+=" if ("+K+") {  ",O.schema=u.schema.then,O.schemaPath=u.schemaPath+".then",O.errSchemaPath=u.errSchemaPath+"/then",g+="  "+u.validate(O)+" ",O.baseId=T,g+=" "+G+" = "+K+"; ",lt&&pt?g+=" var "+(ct="ifClause"+x)+" = 'then'; ":ct="'then'",g+=" } ",pt&&(g+=" else { ")):g+=" if (!"+K+") { ",pt&&(O.schema=u.schema.else,O.schemaPath=u.schemaPath+".else",O.errSchemaPath=u.errSchemaPath+"/else",g+="  "+u.validate(O)+" ",O.baseId=T,g+=" "+G+" = "+K+"; ",lt&&pt?g+=" var "+(ct="ifClause"+x)+" = 'else'; ":ct="'else'",g+=" } "),g+=" if (!"+G+") {   var err =   ",u.createErrors!==!1?(g+=" { keyword: 'if' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { failingKeyword: "+ct+" } ",u.opts.messages!==!1&&(g+=` , message: 'should match "' + `+ct+` + '" schema' `),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!u.compositeRule&&U&&(g+=u.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),g+=" }   ",U&&(g+=" else { "),g=u.util.cleanUpCode(g)}else U&&(g+=" if (true) { ");return g}},{}],26:[function(n,c,h){"use strict";c.exports={$ref:n("./ref"),allOf:n("./allOf"),anyOf:n("./anyOf"),$comment:n("./comment"),const:n("./const"),contains:n("./contains"),dependencies:n("./dependencies"),enum:n("./enum"),format:n("./format"),if:n("./if"),items:n("./items"),maximum:n("./_limit"),minimum:n("./_limit"),maxItems:n("./_limitItems"),minItems:n("./_limitItems"),maxLength:n("./_limitLength"),minLength:n("./_limitLength"),maxProperties:n("./_limitProperties"),minProperties:n("./_limitProperties"),multipleOf:n("./multipleOf"),not:n("./not"),oneOf:n("./oneOf"),pattern:n("./pattern"),properties:n("./properties"),propertyNames:n("./propertyNames"),required:n("./required"),uniqueItems:n("./uniqueItems"),validate:n("./validate")}},{"./_limit":12,"./_limitItems":13,"./_limitLength":14,"./_limitProperties":15,"./allOf":16,"./anyOf":17,"./comment":18,"./const":19,"./contains":20,"./dependencies":22,"./enum":23,"./format":24,"./if":25,"./items":27,"./multipleOf":28,"./not":29,"./oneOf":30,"./pattern":31,"./properties":32,"./propertyNames":33,"./ref":34,"./required":35,"./uniqueItems":36,"./validate":37}],27:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B="errs__"+x,O=u.util.copy(u),K="";O.level++;var Q="valid"+O.level,et="i"+x,lt=O.dataLevel=u.dataLevel+1,pt="data"+lt,T=u.baseId;if(g+="var "+B+" = errors;var "+G+";",Array.isArray(P)){var ct=u.schema.additionalItems;if(ct===!1){g+=" "+G+" = "+A+".length <= "+P.length+"; ";var ut=F;F=u.errSchemaPath+"/additionalItems";var ft=ft||[];ft.push(g+="  if (!"+G+") {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { limit: "+P.length+" } ",u.opts.messages!==!1&&(g+=" , message: 'should NOT have more than "+P.length+" items' "),u.opts.verbose&&(g+=" , schema: false , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var $=g;g=ft.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+$+"]); ":" validate.errors = ["+$+"]; return false; ":" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } ",F=ut,U&&(K+="}",g+=" else { ")}var _t=P;if(_t){for(var W,rt=-1,nt=_t.length-1;rt<nt;)if(W=_t[rt+=1],u.util.schemaHasRules(W,u.RULES.all)){g+=" "+Q+" = true; if ("+A+".length > "+rt+") { ";var vt=A+"["+rt+"]";O.schema=W,O.schemaPath=L+"["+rt+"]",O.errSchemaPath=F+"/"+rt,O.errorPath=u.util.getPathExpr(u.errorPath,rt,u.opts.jsonPointers,!0),O.dataPathArr[lt]=rt;var Mt=u.validate(O);O.baseId=T,u.util.varOccurences(Mt,pt)<2?g+=" "+u.util.varReplace(Mt,pt,vt)+" ":g+=" var "+pt+" = "+vt+"; "+Mt+" ",g+=" }  ",U&&(g+=" if ("+Q+") { ",K+="}")}}typeof ct=="object"&&u.util.schemaHasRules(ct,u.RULES.all)&&(O.schema=ct,O.schemaPath=u.schemaPath+".additionalItems",O.errSchemaPath=u.errSchemaPath+"/additionalItems",g+=" "+Q+" = true; if ("+A+".length > "+P.length+") {  for (var "+et+" = "+P.length+"; "+et+" < "+A+".length; "+et+"++) { ",O.errorPath=u.util.getPathExpr(u.errorPath,et,u.opts.jsonPointers,!0),vt=A+"["+et+"]",O.dataPathArr[lt]=et,Mt=u.validate(O),O.baseId=T,u.util.varOccurences(Mt,pt)<2?g+=" "+u.util.varReplace(Mt,pt,vt)+" ":g+=" var "+pt+" = "+vt+"; "+Mt+" ",U&&(g+=" if (!"+Q+") break; "),g+=" } }  ",U&&(g+=" if ("+Q+") { ",K+="}"))}else u.util.schemaHasRules(P,u.RULES.all)&&(O.schema=P,O.schemaPath=L,O.errSchemaPath=F,g+="  for (var "+et+" = 0; "+et+" < "+A+".length; "+et+"++) { ",O.errorPath=u.util.getPathExpr(u.errorPath,et,u.opts.jsonPointers,!0),vt=A+"["+et+"]",O.dataPathArr[lt]=et,Mt=u.validate(O),O.baseId=T,u.util.varOccurences(Mt,pt)<2?g+=" "+u.util.varReplace(Mt,pt,vt)+" ":g+=" var "+pt+" = "+vt+"; "+Mt+" ",U&&(g+=" if (!"+Q+") break; "),g+=" }");return U&&(g+=" "+K+" if ("+B+" == errors) {"),g=u.util.cleanUpCode(g)}},{}],28:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L,x+="var division"+E+";if (",B&&(x+=" "+g+" !== undefined && ( typeof "+g+" != 'number' || "),x+=" (division"+E+" = "+G+" / "+g+", ",x+=u.opts.multipleOfPrecision?" Math.abs(Math.round(division"+E+") - division"+E+") > 1e-"+u.opts.multipleOfPrecision+" ":" division"+E+" !== parseInt(division"+E+") ",x+=" ) ",B&&(x+="  )  ");var O=O||[];O.push(x+=" ) {   "),x="",u.createErrors!==!1?(x+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { multipleOf: "+g+" } ",u.opts.messages!==!1&&(x+=" , message: 'should be multiple of ",x+=B?"' + "+g:g+"'"),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var K=x;return x=O.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+="} ",A&&(x+=" else { "),x}},{}],29:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="errs__"+x,B=u.util.copy(u);B.level++;var O="valid"+B.level;if(u.util.schemaHasRules(P,u.RULES.all)){B.schema=P,B.schemaPath=L,B.errSchemaPath=F,g+=" var "+G+" = errors;  ";var K,Q=u.compositeRule;u.compositeRule=B.compositeRule=!0,B.createErrors=!1,B.opts.allErrors&&(K=B.opts.allErrors,B.opts.allErrors=!1),g+=" "+u.validate(B)+" ",B.createErrors=!0,K&&(B.opts.allErrors=K),u.compositeRule=B.compositeRule=Q;var et=et||[];et.push(g+=" if ("+O+") {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'not' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: {} ",u.opts.messages!==!1&&(g+=" , message: 'should NOT be valid' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var lt=g;g=et.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+lt+"]); ":" validate.errors = ["+lt+"]; return false; ":" var err = "+lt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } else {  errors = "+G+"; if (vErrors !== null) { if ("+G+") vErrors.length = "+G+"; else vErrors = null; } ",u.opts.allErrors&&(g+=" } ")}else g+="  var err =   ",u.createErrors!==!1?(g+=" { keyword: 'not' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: {} ",u.opts.messages!==!1&&(g+=" , message: 'should NOT be valid' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",U&&(g+=" if (false) { ");return g}},{}],30:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B="errs__"+x,O=u.util.copy(u),K="";O.level++;var Q="valid"+O.level,et=O.baseId,lt="prevValid"+x,pt="passingSchemas"+x;g+="var "+B+" = errors , "+lt+" = false , "+G+" = false , "+pt+" = null; ";var T=u.compositeRule;u.compositeRule=O.compositeRule=!0;var ct=P;if(ct)for(var ut,ft=-1,$=ct.length-1;ft<$;)ut=ct[ft+=1],u.util.schemaHasRules(ut,u.RULES.all)?(O.schema=ut,O.schemaPath=L+"["+ft+"]",O.errSchemaPath=F+"/"+ft,g+="  "+u.validate(O)+" ",O.baseId=et):g+=" var "+Q+" = true; ",ft&&(g+=" if ("+Q+" && "+lt+") { "+G+" = false; "+pt+" = ["+pt+", "+ft+"]; } else { ",K+="}"),g+=" if ("+Q+") { "+G+" = "+lt+" = true; "+pt+" = "+ft+"; }";return u.compositeRule=O.compositeRule=T,g+=K+"if (!"+G+") {   var err =   ",u.createErrors!==!1?(g+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { passingSchemas: "+pt+" } ",u.opts.messages!==!1&&(g+=" , message: 'should match exactly one schema in oneOf' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!u.compositeRule&&U&&(g+=u.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),g+="} else {  errors = "+B+"; if (vErrors !== null) { if ("+B+") vErrors.length = "+B+"; else vErrors = null; }",u.opts.allErrors&&(g+=" } "),g}},{}],31:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B=u.opts.$data&&L&&L.$data;B?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L;var O=B?"(new RegExp("+g+"))":u.usePattern(L);x+="if ( ",B&&(x+=" ("+g+" !== undefined && typeof "+g+" != 'string') || ");var K=K||[];K.push(x+=" !"+O+".test("+G+") ) {   "),x="",u.createErrors!==!1?(x+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { pattern:  ",x+=B?""+g:""+u.util.toQuotedString(L),x+="  } ",u.opts.messages!==!1&&(x+=` , message: 'should match pattern "`,x+=B?"' + "+g+" + '":""+u.util.escapeQuotes(L),x+=`"' `),u.opts.verbose&&(x+=" , schema:  ",x+=B?"validate.schema"+F:""+u.util.toQuotedString(L),x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var Q=x;return x=K.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+="} ",A&&(x+=" else { "),x}},{}],32:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="errs__"+x,B=u.util.copy(u),O="";B.level++;var K="valid"+B.level,Q="key"+x,et="idx"+x,lt=B.dataLevel=u.dataLevel+1,pt="data"+lt,T="dataProperties"+x,ct=Object.keys(P||{}),ut=u.schema.patternProperties||{},ft=Object.keys(ut),$=u.schema.additionalProperties,_t=ct.length||ft.length,W=$===!1,rt=typeof $=="object"&&Object.keys($).length,nt=u.opts.removeAdditional,vt=W||rt||nt,Mt=u.opts.ownProperties,Bt=u.baseId,Vt=u.schema.required;if(Vt&&(!u.opts.$data||!Vt.$data)&&Vt.length<u.opts.loopRequired)var Lt=u.util.toHash(Vt);if(g+="var "+G+" = errors;var "+K+" = true;",Mt&&(g+=" var "+T+" = undefined;"),vt){if(g+=Mt?" "+T+" = "+T+" || Object.keys("+A+"); for (var "+et+"=0; "+et+"<"+T+".length; "+et+"++) { var "+Q+" = "+T+"["+et+"]; ":" for (var "+Q+" in "+A+") { ",_t){if(g+=" var isAdditional"+x+" = !(false ",ct.length)if(8<ct.length)g+=" || validate.schema"+L+".hasOwnProperty("+Q+") ";else{var Ne=ct;if(Ne)for(var ge=-1,Yt=Ne.length-1;ge<Yt;)vr=Ne[ge+=1],g+=" || "+Q+" == "+u.util.toQuotedString(vr)+" "}if(ft.length){var ue=ft;if(ue)for(var ne=-1,dr=ue.length-1;ne<dr;)eo=ue[ne+=1],g+=" || "+u.usePattern(eo)+".test("+Q+") "}g+=" ); if (isAdditional"+x+") { "}if(nt=="all")g+=" delete "+A+"["+Q+"]; ";else{var je=u.errorPath,Br="' + "+Q+" + '";if(u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPathExpr(u.errorPath,Q,u.opts.jsonPointers)),W)if(nt)g+=" delete "+A+"["+Q+"]; ";else{var Ue=F;F=u.errSchemaPath+"/additionalProperties",(xn=xn||[]).push(g+=" "+K+" = false; "),g="",u.createErrors!==!1?(g+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { additionalProperty: '"+Br+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is an invalid additional property":"should NOT have additional properties",g+="' "),u.opts.verbose&&(g+=" , schema: false , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var Fe=g;g=xn.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+Fe+"]); ":" validate.errors = ["+Fe+"]; return false; ":" var err = "+Fe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",F=Ue,U&&(g+=" break; ")}else if(rt)if(nt=="failing"){g+=" var "+G+" = errors;  ";var Lr=u.compositeRule;u.compositeRule=B.compositeRule=!0,B.schema=$,B.schemaPath=u.schemaPath+".additionalProperties",B.errSchemaPath=u.errSchemaPath+"/additionalProperties",B.errorPath=u.opts._errorDataPathProperty?u.errorPath:u.util.getPathExpr(u.errorPath,Q,u.opts.jsonPointers);var De=A+"["+Q+"]";B.dataPathArr[lt]=Q;var se=u.validate(B);B.baseId=Bt,u.util.varOccurences(se,pt)<2?g+=" "+u.util.varReplace(se,pt,De)+" ":g+=" var "+pt+" = "+De+"; "+se+" ",g+=" if (!"+K+") { errors = "+G+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+A+"["+Q+"]; }  ",u.compositeRule=B.compositeRule=Lr}else B.schema=$,B.schemaPath=u.schemaPath+".additionalProperties",B.errSchemaPath=u.errSchemaPath+"/additionalProperties",B.errorPath=u.opts._errorDataPathProperty?u.errorPath:u.util.getPathExpr(u.errorPath,Q,u.opts.jsonPointers),De=A+"["+Q+"]",B.dataPathArr[lt]=Q,se=u.validate(B),B.baseId=Bt,u.util.varOccurences(se,pt)<2?g+=" "+u.util.varReplace(se,pt,De)+" ":g+=" var "+pt+" = "+De+"; "+se+" ",U&&(g+=" if (!"+K+") break; ");u.errorPath=je}_t&&(g+=" } "),g+=" }  ",U&&(g+=" if ("+K+") { ",O+="}")}var oe=u.opts.useDefaults&&!u.compositeRule;if(ct.length){var Ar=ct;if(Ar)for(var vr,Kr=-1,wi=Ar.length-1;Kr<wi;){if(vr=Ar[Kr+=1],u.util.schemaHasRules(cn=P[vr],u.RULES.all)){var Ee=u.util.getProperty(vr),Sr=(De=A+Ee,oe&&cn.default!==void 0);if(B.schema=cn,B.schemaPath=L+Ee,B.errSchemaPath=F+"/"+u.util.escapeFragment(vr),B.errorPath=u.util.getPath(u.errorPath,vr,u.opts.jsonPointers),B.dataPathArr[lt]=u.util.toQuotedString(vr),se=u.validate(B),B.baseId=Bt,u.util.varOccurences(se,pt)<2){se=u.util.varReplace(se,pt,De);var Or=De}else Or=pt,g+=" var "+pt+" = "+De+"; ";if(Sr)g+=" "+se+" ";else{if(Lt&&Lt[vr]){g+=" if ( "+Or+" === undefined ",Mt&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(vr)+"') "),g+=") { "+K+" = false; ",je=u.errorPath,Ue=F;var xn,ye=u.util.escapeQuotes(vr);u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPath(je,vr,u.opts.jsonPointers)),F=u.errSchemaPath+"/required",(xn=xn||[]).push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+ye+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+ye+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",Fe=g,g=xn.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+Fe+"]); ":" validate.errors = ["+Fe+"]; return false; ":" var err = "+Fe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",F=Ue,u.errorPath=je,g+=" } else { "}else U?(g+=" if ( "+Or+" === undefined ",Mt&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(vr)+"') "),g+=") { "+K+" = true; } else { "):(g+=" if ("+Or+" !== undefined ",Mt&&(g+=" &&   Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(vr)+"') "),g+=" ) { ");g+=" "+se+" } "}}U&&(g+=" if ("+K+") { ",O+="}")}}if(ft.length){var oi=ft;if(oi)for(var eo,Xo=-1,Xn=oi.length-1;Xo<Xn;){var cn;eo=oi[Xo+=1],u.util.schemaHasRules(cn=ut[eo],u.RULES.all)&&(B.schema=cn,B.schemaPath=u.schemaPath+".patternProperties"+u.util.getProperty(eo),B.errSchemaPath=u.errSchemaPath+"/patternProperties/"+u.util.escapeFragment(eo),g+=Mt?" "+T+" = "+T+" || Object.keys("+A+"); for (var "+et+"=0; "+et+"<"+T+".length; "+et+"++) { var "+Q+" = "+T+"["+et+"]; ":" for (var "+Q+" in "+A+") { ",g+=" if ("+u.usePattern(eo)+".test("+Q+")) { ",B.errorPath=u.util.getPathExpr(u.errorPath,Q,u.opts.jsonPointers),De=A+"["+Q+"]",B.dataPathArr[lt]=Q,se=u.validate(B),B.baseId=Bt,u.util.varOccurences(se,pt)<2?g+=" "+u.util.varReplace(se,pt,De)+" ":g+=" var "+pt+" = "+De+"; "+se+" ",U&&(g+=" if (!"+K+") break; "),g+=" } ",U&&(g+=" else "+K+" = true; "),g+=" }  ",U&&(g+=" if ("+K+") { ",O+="}"))}}return U&&(g+=" "+O+" if ("+G+" == errors) {"),g=u.util.cleanUpCode(g)}},{}],33:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="errs__"+x,B=u.util.copy(u);B.level++;var O="valid"+B.level;if(u.util.schemaHasRules(P,u.RULES.all)){B.schema=P,B.schemaPath=L,B.errSchemaPath=F;var K="key"+x,Q="idx"+x,et="i"+x,lt="' + "+K+" + '",pt="data"+(B.dataLevel=u.dataLevel+1),T="dataProperties"+x,ct=u.opts.ownProperties,ut=u.baseId;g+=" var "+G+" = errors; ",ct&&(g+=" var "+T+" = undefined; "),g+=ct?" "+T+" = "+T+" || Object.keys("+A+"); for (var "+Q+"=0; "+Q+"<"+T+".length; "+Q+"++) { var "+K+" = "+T+"["+Q+"]; ":" for (var "+K+" in "+A+") { ",g+=" var startErrs"+x+" = errors; ";var ft=K,$=u.compositeRule;u.compositeRule=B.compositeRule=!0;var _t=u.validate(B);B.baseId=ut,u.util.varOccurences(_t,pt)<2?g+=" "+u.util.varReplace(_t,pt,ft)+" ":g+=" var "+pt+" = "+ft+"; "+_t+" ",u.compositeRule=B.compositeRule=$,g+=" if (!"+O+") { for (var "+et+"=startErrs"+x+"; "+et+"<errors; "+et+"++) { vErrors["+et+"].propertyName = "+K+"; }   var err =   ",u.createErrors!==!1?(g+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { propertyName: '"+lt+"' } ",u.opts.messages!==!1&&(g+=" , message: 'property name \\'"+lt+"\\' is invalid' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!u.compositeRule&&U&&(g+=u.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),U&&(g+=" break; "),g+=" } }"}return U&&(g+="  if ("+G+" == errors) {"),g=u.util.cleanUpCode(g)}},{}],34:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x,E=" ",P=u.dataLevel,L=u.schema[d],F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(P||""),G="valid"+u.level;if(L=="#"||L=="#/")u.isRoot?(g=u.async,x="validate"):(g=u.root.schema.$async===!0,x="root.refVal[0]");else{var B=u.resolveRef(u.baseId,L,u.isRoot);if(B===void 0){var O=u.MissingRefError.message(u.baseId,L);if(u.opts.missingRefs=="fail"){u.logger.error(O),(lt=lt||[]).push(E),E="",u.createErrors!==!1?(E+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { ref: '"+u.util.escapeQuotes(L)+"' } ",u.opts.messages!==!1&&(E+=" , message: 'can\\'t resolve reference "+u.util.escapeQuotes(L)+"' "),u.opts.verbose&&(E+=" , schema: "+u.util.toQuotedString(L)+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),E+=" } "):E+=" {} ";var K=E;E=lt.pop(),E+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+K+"]); ":" validate.errors = ["+K+"]; return false; ":" var err = "+K+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",U&&(E+=" if (false) { ")}else{if(u.opts.missingRefs!="ignore")throw new u.MissingRefError(u.baseId,L,O);u.logger.warn(O),U&&(E+=" if (true) { ")}}else if(B.inline){var Q=u.util.copy(u);Q.level++;var et="valid"+Q.level;Q.schema=B.schema,Q.schemaPath="",Q.errSchemaPath=L,E+=" "+u.validate(Q).replace(/validate\.schema/g,B.code)+" ",U&&(E+=" if ("+et+") { ")}else g=B.$async===!0||u.async&&B.$async!==!1,x=B.code}if(x){var lt;(lt=lt||[]).push(E),E="",E+=u.opts.passContext?" "+x+".call(this, ":" "+x+"( ",E+=" "+A+", (dataPath || '')",u.errorPath!='""'&&(E+=" + "+u.errorPath);var pt=E+=" , "+(P?"data"+(P-1||""):"parentData")+" , "+(P?u.dataPathArr[P]:"parentDataProperty")+", rootData)  ";if(E=lt.pop(),g){if(!u.async)throw new Error("async schema referenced by sync schema");U&&(E+=" var "+G+"; "),E+=" try { await "+pt+"; ",U&&(E+=" "+G+" = true; "),E+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",U&&(E+=" "+G+" = false; "),E+=" } ",U&&(E+=" if ("+G+") { ")}else E+=" if (!"+pt+") { if (vErrors === null) vErrors = "+x+".errors; else vErrors = vErrors.concat("+x+".errors); errors = vErrors.length; } ",U&&(E+=" else { ")}return E}},{}],35:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g=" ",x=u.level,E=u.dataLevel,P=u.schema[d],L=u.schemaPath+u.util.getProperty(d),F=u.errSchemaPath+"/"+d,U=!u.opts.allErrors,A="data"+(E||""),G="valid"+x,B=u.opts.$data&&P&&P.$data;B&&(g+=" var schema"+x+" = "+u.util.getData(P.$data,E,u.dataPathArr)+"; ");var O="schema"+x;if(!B)if(P.length<u.opts.loopRequired&&u.schema.properties&&Object.keys(u.schema.properties).length){var K=[],Q=P;if(Q)for(var et,lt=-1,pt=Q.length-1;lt<pt;){et=Q[lt+=1];var T=u.schema.properties[et];T&&u.util.schemaHasRules(T,u.RULES.all)||(K[K.length]=et)}}else K=P;if(B||K.length){var ct=u.errorPath,ut=B||u.opts.loopRequired<=K.length,ft=u.opts.ownProperties;if(U)if(g+=" var missing"+x+"; ",ut){B||(g+=" var "+O+" = validate.schema"+L+"; ");var $="' + "+(Mt="schema"+x+"["+(rt="i"+x)+"]")+" + '";u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPathExpr(ct,Mt,u.opts.jsonPointers)),g+=" var "+G+" = true; ",B&&(g+=" if (schema"+x+" === undefined) "+G+" = true; else if (!Array.isArray(schema"+x+")) "+G+" = false; else {"),g+=" for (var "+rt+" = 0; "+rt+" < "+O+".length; "+rt+"++) { "+G+" = "+A+"["+O+"["+rt+"]] !== undefined ",ft&&(g+=" &&   Object.prototype.hasOwnProperty.call("+A+", "+O+"["+rt+"]) "),g+="; if (!"+G+") break; } ",B&&(g+="  }  "),(vt=vt||[]).push(g+="  if (!"+G+") {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+$+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+$+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ";var _t=g;g=vt.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+_t+"]); ":" validate.errors = ["+_t+"]; return false; ":" var err = "+_t+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } else { "}else{g+=" if ( ";var W=K;if(W)for(var rt=-1,nt=W.length-1;rt<nt;)Vt=W[rt+=1],rt&&(g+=" || "),g+=" ( ( "+(Yt=A+(ge=u.util.getProperty(Vt)))+" === undefined ",ft&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(Vt)+"') "),g+=") && (missing"+x+" = "+u.util.toQuotedString(u.opts.jsonPointers?Vt:ge)+") ) ";g+=") {  ";var vt;$="' + "+(Mt="missing"+x)+" + '",u.opts._errorDataPathProperty&&(u.errorPath=u.opts.jsonPointers?u.util.getPathExpr(ct,Mt,!0):ct+" + "+Mt),(vt=vt||[]).push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+$+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+$+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",_t=g,g=vt.pop(),g+=!u.compositeRule&&U?u.async?" throw new ValidationError(["+_t+"]); ":" validate.errors = ["+_t+"]; return false; ":" var err = "+_t+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } else { "}else if(ut){B||(g+=" var "+O+" = validate.schema"+L+"; ");var Mt;$="' + "+(Mt="schema"+x+"["+(rt="i"+x)+"]")+" + '",u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPathExpr(ct,Mt,u.opts.jsonPointers)),B&&(g+=" if ("+O+" && !Array.isArray("+O+")) {  var err =   ",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+$+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+$+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+O+" !== undefined) { "),g+=" for (var "+rt+" = 0; "+rt+" < "+O+".length; "+rt+"++) { if ("+A+"["+O+"["+rt+"]] === undefined ",ft&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", "+O+"["+rt+"]) "),g+=") {  var err =   ",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+$+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+$+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",B&&(g+="  }  ")}else{var Bt=K;if(Bt)for(var Vt,Lt=-1,Ne=Bt.length-1;Lt<Ne;){Vt=Bt[Lt+=1];var ge=u.util.getProperty(Vt),Yt=($=u.util.escapeQuotes(Vt),A+ge);u.opts._errorDataPathProperty&&(u.errorPath=u.util.getPath(ct,Vt,u.opts.jsonPointers)),g+=" if ( "+Yt+" === undefined ",ft&&(g+=" || ! Object.prototype.hasOwnProperty.call("+A+", '"+u.util.escapeQuotes(Vt)+"') "),g+=") {  var err =   ",u.createErrors!==!1?(g+=" { keyword: 'required' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(F)+" , params: { missingProperty: '"+$+"' } ",u.opts.messages!==!1&&(g+=" , message: '",g+=u.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+$+"\\'",g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+L+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+A+" "),g+=" } "):g+=" {} ",g+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}u.errorPath=ct}else U&&(g+=" if (true) {");return g}},{}],36:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g,x=" ",E=u.level,P=u.dataLevel,L=u.schema[d],F=u.schemaPath+u.util.getProperty(d),U=u.errSchemaPath+"/"+d,A=!u.opts.allErrors,G="data"+(P||""),B="valid"+E,O=u.opts.$data&&L&&L.$data;if(O?(x+=" var schema"+E+" = "+u.util.getData(L.$data,P,u.dataPathArr)+"; ",g="schema"+E):g=L,(L||O)&&u.opts.uniqueItems!==!1){O&&(x+=" var "+B+"; if ("+g+" === false || "+g+" === undefined) "+B+" = true; else if (typeof "+g+" != 'boolean') "+B+" = false; else { "),x+=" var i = "+G+".length , "+B+" = true , j; if (i > 1) { ";var K=u.schema.items&&u.schema.items.type,Q=Array.isArray(K);!K||K=="object"||K=="array"||Q&&(0<=K.indexOf("object")||0<=K.indexOf("array"))?x+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+G+"[i], "+G+"[j])) { "+B+" = false; break outer; } } } ":(x+=" var itemIndices = {}, item; for (;i--;) { var item = "+G+"[i]; ",x+=" if ("+u.util["checkDataType"+(Q?"s":"")](K,"item",!0)+") continue; ",Q&&(x+=` if (typeof item == 'string') item = '"' + item; `),x+=" if (typeof itemIndices[item] == 'number') { "+B+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "),x+=" } ",O&&(x+="  }  ");var et=et||[];et.push(x+=" if (!"+B+") {   "),x="",u.createErrors!==!1?(x+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(U)+" , params: { i: i, j: j } ",u.opts.messages!==!1&&(x+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),u.opts.verbose&&(x+=" , schema:  ",x+=O?"validate.schema"+F:""+L,x+="         , parentSchema: validate.schema"+u.schemaPath+" , data: "+G+" "),x+=" } "):x+=" {} ";var lt=x;x=et.pop(),x+=!u.compositeRule&&A?u.async?" throw new ValidationError(["+lt+"]); ":" validate.errors = ["+lt+"]; return false; ":" var err = "+lt+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",x+=" } ",A&&(x+=" else { ")}else A&&(x+=" if (true) { ");return x}},{}],37:[function(n,c,h){"use strict";c.exports=function(u,d,m){var g="",x=u.schema.$async===!0,E=u.util.schemaHasRulesExcept(u.schema,u.RULES.all,"$ref"),P=u.self._getId(u.schema);if(u.isTop&&(g+=" var validate = ",x&&(u.async=!0,g+="async "),g+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",P&&(u.opts.sourceCode||u.opts.processCode)&&(g+=" /*# sourceURL="+P+" */ ")),typeof u.schema=="boolean"||!E&&!u.schema.$ref){var L=u.level,F=u.dataLevel,U=u.schema[d="false schema"],A=u.schemaPath+u.util.getProperty(d),G=u.errSchemaPath+"/"+d,B=!u.opts.allErrors,O="data"+(F||""),K="valid"+L;if(u.schema===!1){u.isTop?B=!0:g+=" var "+K+" = false; ",(Ar=Ar||[]).push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(G)+" , params: {} ",u.opts.messages!==!1&&(g+=" , message: 'boolean schema is false' "),u.opts.verbose&&(g+=" , schema: false , parentSchema: validate.schema"+u.schemaPath+" , data: "+O+" "),g+=" } "):g+=" {} ";var Q=g;g=Ar.pop(),g+=!u.compositeRule&&B?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else g+=u.isTop?x?" return data; ":" validate.errors = null; return true; ":" var "+K+" = true; ";return u.isTop&&(g+=" }; return validate; "),g}if(u.isTop){var et=u.isTop;L=u.level=0,F=u.dataLevel=0,O="data",u.rootId=u.resolve.fullPath(u.self._getId(u.root.schema)),u.baseId=u.baseId||u.rootId,delete u.isTop,u.dataPathArr=[void 0],g+=" var vErrors = null; ",g+=" var errors = 0;     ",g+=" if (rootData === undefined) rootData = data; "}else{if(L=u.level,O="data"+((F=u.dataLevel)||""),P&&(u.baseId=u.resolve.url(u.baseId,P)),x&&!u.async)throw new Error("async schema in sync schema");g+=" var errs_"+L+" = errors;"}K="valid"+L,B=!u.opts.allErrors;var lt="",pt="",T=u.schema.type,ct=Array.isArray(T);if(ct&&T.length==1&&(T=T[0],ct=!1),u.schema.$ref&&E){if(u.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+u.errSchemaPath+'" (see option extendRefs)');u.opts.extendRefs!==!0&&(E=!1,u.logger.warn('$ref: keywords ignored in schema at path "'+u.errSchemaPath+'"'))}if(u.schema.$comment&&u.opts.$comment&&(g+=" "+u.RULES.all.$comment.code(u,"$comment")),T){if(u.opts.coerceTypes)var ut=u.util.coerceToTypes(u.opts.coerceTypes,T);var ft=u.RULES.types[T];if(ut||ct||ft===!0||ft&&!vr(ft)){if(A=u.schemaPath+".type",G=u.errSchemaPath+"/type",A=u.schemaPath+".type",G=u.errSchemaPath+"/type",g+=" if ("+u.util[ct?"checkDataTypes":"checkDataType"](T,O,!0)+") { ",ut){var $="dataType"+L,_t="coerced"+L;g+=" var "+$+" = typeof "+O+"; ",u.opts.coerceTypes=="array"&&(g+=" if ("+$+" == 'object' && Array.isArray("+O+")) "+$+" = 'array'; "),g+=" var "+_t+" = undefined; ";var W="",rt=ut;if(rt)for(var nt,vt=-1,Mt=rt.length-1;vt<Mt;)nt=rt[vt+=1],vt&&(g+=" if ("+_t+" === undefined) { ",W+="}"),u.opts.coerceTypes=="array"&&nt!="array"&&(g+=" if ("+$+" == 'array' && "+O+".length == 1) { "+_t+" = "+O+" = "+O+"[0]; "+$+" = typeof "+O+";  } "),nt=="string"?g+=" if ("+$+" == 'number' || "+$+" == 'boolean') "+_t+" = '' + "+O+"; else if ("+O+" === null) "+_t+" = ''; ":nt=="number"||nt=="integer"?(g+=" if ("+$+" == 'boolean' || "+O+" === null || ("+$+" == 'string' && "+O+" && "+O+" == +"+O+" ",nt=="integer"&&(g+=" && !("+O+" % 1)"),g+=")) "+_t+" = +"+O+"; "):nt=="boolean"?g+=" if ("+O+" === 'false' || "+O+" === 0 || "+O+" === null) "+_t+" = false; else if ("+O+" === 'true' || "+O+" === 1) "+_t+" = true; ":nt=="null"?g+=" if ("+O+" === '' || "+O+" === 0 || "+O+" === false) "+_t+" = null; ":u.opts.coerceTypes=="array"&&nt=="array"&&(g+=" if ("+$+" == 'string' || "+$+" == 'number' || "+$+" == 'boolean' || "+O+" == null) "+_t+" = ["+O+"]; ");(Ar=Ar||[]).push(g+=" "+W+" if ("+_t+" === undefined) {   "),g="",u.createErrors!==!1?(g+=" { keyword: 'type' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(G)+" , params: { type: '",g+=ct?""+T.join(","):""+T,g+="' } ",u.opts.messages!==!1&&(g+=" , message: 'should be ",g+=ct?""+T.join(","):""+T,g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+A+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+O+" "),g+=" } "):g+=" {} ",Q=g,g=Ar.pop(),g+=!u.compositeRule&&B?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } else {  ";var Bt=F?"data"+(F-1||""):"parentData";g+=" "+O+" = "+_t+"; ",F||(g+="if ("+Bt+" !== undefined)"),g+=" "+Bt+"["+(F?u.dataPathArr[F]:"parentDataProperty")+"] = "+_t+"; } "}else(Ar=Ar||[]).push(g),g="",u.createErrors!==!1?(g+=" { keyword: 'type' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(G)+" , params: { type: '",g+=ct?""+T.join(","):""+T,g+="' } ",u.opts.messages!==!1&&(g+=" , message: 'should be ",g+=ct?""+T.join(","):""+T,g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+A+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+O+" "),g+=" } "):g+=" {} ",Q=g,g=Ar.pop(),g+=!u.compositeRule&&B?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";g+=" } "}}if(u.schema.$ref&&!E)g+=" "+u.RULES.all.$ref.code(u,"$ref")+" ",B&&(g+=" } if (errors === ",g+=et?"0":"errs_"+L,g+=") { ",pt+="}");else{var Vt=u.RULES;if(Vt){for(var Lt=-1,Ne=Vt.length-1;Lt<Ne;)if(vr(ft=Vt[Lt+=1])){if(ft.type&&(g+=" if ("+u.util.checkDataType(ft.type,O)+") { "),u.opts.useDefaults&&!u.compositeRule){if(ft.type=="object"&&u.schema.properties){U=u.schema.properties;var ge=Object.keys(U);if(ge)for(var Yt,ue=-1,ne=ge.length-1;ue<ne;)(je=U[Yt=ge[ue+=1]]).default!==void 0&&(g+="  if ("+(Ue=O+u.util.getProperty(Yt))+" === undefined) "+Ue+" = ",g+=u.opts.useDefaults=="shared"?" "+u.useDefault(je.default)+" ":" "+JSON.stringify(je.default)+" ",g+="; ")}else if(ft.type=="array"&&Array.isArray(u.schema.items)){var dr=u.schema.items;if(dr){vt=-1;for(var je,Br=dr.length-1;vt<Br;){var Ue;(je=dr[vt+=1]).default!==void 0&&(g+="  if ("+(Ue=O+"["+vt+"]")+" === undefined) "+Ue+" = ",g+=u.opts.useDefaults=="shared"?" "+u.useDefault(je.default)+" ":" "+JSON.stringify(je.default)+" ",g+="; ")}}}}var Fe=ft.rules;if(Fe){for(var Lr,De=-1,se=Fe.length-1;De<se;)if(Kr(Lr=Fe[De+=1])){var oe=Lr.code(u,Lr.keyword,ft.type);oe&&(g+=" "+oe+" ",B&&(lt+="}"))}}if(B&&(g+=" "+lt+" ",lt=""),ft.type&&(g+=" } ",T&&T===ft.type&&!ut)){var Ar;A=u.schemaPath+".type",G=u.errSchemaPath+"/type",(Ar=Ar||[]).push(g+=" else { "),g="",u.createErrors!==!1?(g+=" { keyword: 'type' , dataPath: (dataPath || '') + "+u.errorPath+" , schemaPath: "+u.util.toQuotedString(G)+" , params: { type: '",g+=ct?""+T.join(","):""+T,g+="' } ",u.opts.messages!==!1&&(g+=" , message: 'should be ",g+=ct?""+T.join(","):""+T,g+="' "),u.opts.verbose&&(g+=" , schema: validate.schema"+A+" , parentSchema: validate.schema"+u.schemaPath+" , data: "+O+" "),g+=" } "):g+=" {} ",Q=g,g=Ar.pop(),g+=!u.compositeRule&&B?u.async?" throw new ValidationError(["+Q+"]); ":" validate.errors = ["+Q+"]; return false; ":" var err = "+Q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",g+=" } "}B&&(g+=" if (errors === ",g+=et?"0":"errs_"+L,g+=") { ",pt+="}")}}}function vr(wi){for(var Ee=wi.rules,Sr=0;Sr<Ee.length;Sr++)if(Kr(Ee[Sr]))return!0}function Kr(wi){return u.schema[wi.keyword]!==void 0||wi.implements&&function(Ee){for(var Sr=Ee.implements,Or=0;Or<Sr.length;Or++)if(u.schema[Sr[Or]]!==void 0)return!0}(wi)}return B&&(g+=" "+pt+" "),et?(x?(g+=" if (errors === 0) return data;           ",g+=" else throw new ValidationError(vErrors); "):(g+=" validate.errors = vErrors; ",g+=" return errors === 0;       "),g+=" }; return validate;"):g+=" var "+K+" = errors === errs_"+L+";",g=u.util.cleanUpCode(g),et&&(g=u.util.finalCleanUpCode(g,x)),g}},{}],38:[function(n,c,h){"use strict";var u=/^[a-z_$][a-z0-9_$-]*$/i,d=n("./dotjs/custom");c.exports={add:function(m,g){var x=this.RULES;if(x.keywords[m])throw new Error("Keyword "+m+" is already defined");if(!u.test(m))throw new Error("Keyword "+m+" is not a valid identifier");if(g){if(g.macro&&g.valid!==void 0)throw new Error('"valid" option cannot be used with macro keywords');var E=g.type;if(Array.isArray(E)){var P,L=E.length;for(P=0;P<L;P++)G(E[P]);for(P=0;P<L;P++)A(m,E[P],g)}else E&&G(E),A(m,E,g);var F=g.$data===!0&&this._opts.$data;if(F&&!g.validate)throw new Error('$data support: "validate" function is not defined');var U=g.metaSchema;U&&(F&&(U={anyOf:[U,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),g.validateSchema=this.compile(U,!0))}function A(B,O,K){for(var Q,et=0;et<x.length;et++){var lt=x[et];if(lt.type==O){Q=lt;break}}Q||x.push(Q={type:O,rules:[]});var pt={keyword:B,definition:K,custom:!0,code:d,implements:K.implements};Q.rules.push(pt),x.custom[B]=pt}function G(B){if(!x.types[B])throw new Error("Unknown type "+B)}return x.keywords[m]=x.all[m]=!0,this},get:function(m){var g=this.RULES.custom[m];return g?g.definition:this.RULES.keywords[m]||!1},remove:function(m){var g=this.RULES;delete g.keywords[m],delete g.all[m],delete g.custom[m];for(var x=0;x<g.length;x++)for(var E=g[x].rules,P=0;P<E.length;P++)if(E[P].keyword==m){E.splice(P,1);break}return this}}},{"./dotjs/custom":21}],39:[function(n,c,h){c.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},{}],40:[function(n,c,h){c.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}},{}],41:[function(n,c,h){"use strict";var u=Array.isArray,d=Object.keys,m=Object.prototype.hasOwnProperty;c.exports=function g(x,E){if(x===E)return!0;if(x&&E&&typeof x=="object"&&typeof E=="object"){var P,L,F,U=u(x),A=u(E);if(U&&A){if((L=x.length)!=E.length)return!1;for(P=L;P--!=0;)if(!g(x[P],E[P]))return!1;return!0}if(U!=A)return!1;var G=x instanceof Date,B=E instanceof Date;if(G!=B)return!1;if(G&&B)return x.getTime()==E.getTime();var O=x instanceof RegExp,K=E instanceof RegExp;if(O!=K)return!1;if(O&&K)return x.toString()==E.toString();var Q=d(x);if((L=Q.length)!==d(E).length)return!1;for(P=L;P--!=0;)if(!m.call(E,Q[P]))return!1;for(P=L;P--!=0;)if(!g(x[F=Q[P]],E[F]))return!1;return!0}return x!=x&&E!=E}},{}],42:[function(n,c,h){"use strict";c.exports=function(u,d){d||(d={}),typeof d=="function"&&(d={cmp:d});var m,g=typeof d.cycles=="boolean"&&d.cycles,x=d.cmp&&(m=d.cmp,function(P){return function(L,F){return m({key:L,value:P[L]},{key:F,value:P[F]})}}),E=[];return function P(L){if(L&&L.toJSON&&typeof L.toJSON=="function"&&(L=L.toJSON()),L!==void 0){if(typeof L=="number")return isFinite(L)?""+L:"null";if(typeof L!="object")return JSON.stringify(L);var F,U;if(Array.isArray(L)){for(U="[",F=0;F<L.length;F++)F&&(U+=","),U+=P(L[F])||"null";return U+"]"}if(L===null)return"null";if(E.indexOf(L)!==-1){if(g)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var A=E.push(L)-1,G=Object.keys(L).sort(x&&x(L));for(U="",F=0;F<G.length;F++){var B=G[F],O=P(L[B]);O&&(U&&(U+=","),U+=JSON.stringify(B)+":"+O)}return E.splice(A,1),"{"+U+"}"}}(u)}},{}],43:[function(n,c,h){"use strict";var u=c.exports=function(d,m,g){typeof m=="function"&&(g=m,m={}),function x(E,P,L,F,U,A,G,B,O){if(L&&typeof L=="object"&&!Array.isArray(L))for(var K in P(L,F,U,A,G,B,O),L){var Q=L[K];if(Array.isArray(Q)){if(K in u.arrayKeywords)for(var et=0;et<Q.length;et++)x(E,P,Q[et],F+"/"+K+"/"+et,U,F,K,L,et)}else if(K in u.propsKeywords){if(Q&&typeof Q=="object")for(var lt in Q)x(E,P,Q[lt],F+"/"+K+"/"+lt.replace(/~/g,"~0").replace(/\//g,"~1"),U,F,K,L,lt)}else(K in u.keywords||E.allKeys&&!(K in u.skipKeywords))&&x(E,P,Q,F+"/"+K,U,F,K,L)}}(m,g,d,"",d)};u.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},u.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},u.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},u.skipKeywords={enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},{}],44:[function(n,c,h){var u;u=this,function(d){"use strict";function m(){for(var Ft=arguments.length,Ot=Array(Ft),Kt=0;Kt<Ft;Kt++)Ot[Kt]=arguments[Kt];if(1<Ot.length){Ot[0]=Ot[0].slice(0,-1);for(var ae=Ot.length-1,Ve=1;Ve<ae;++Ve)Ot[Ve]=Ot[Ve].slice(1,-1);return Ot[ae]=Ot[ae].slice(1),Ot.join("")}return Ot[0]}function g(Ft){return"(?:"+Ft+")"}function x(Ft){return Ft===void 0?"undefined":Ft===null?"null":Object.prototype.toString.call(Ft).split(" ").pop().split("]").shift().toLowerCase()}function E(Ft){return Ft.toUpperCase()}function P(Ft){var Ot="[A-Za-z]",Kt="[0-9]",ae=m(Kt,"[A-Fa-f]"),Ve=g(g("%[EFef]"+ae+"%"+ae+ae+"%"+ae+ae)+"|"+g("%[89A-Fa-f]"+ae+"%"+ae+ae)+"|"+g("%"+ae+ae)),Be="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Er=m("[\\:\\/\\?\\#\\[\\]\\@]",Be),br=Ft?"[\\uE000-\\uF8FF]":"[]",Oe=m(Ot,Kt,"[\\-\\.\\_\\~]",Ft?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),ur=g(Ot+m(Ot,Kt,"[\\+\\-\\.]")+"*"),ar=g(g(Ve+"|"+m(Oe,Be,"[\\:]"))+"*"),ot=(g(g("25[0-5]")+"|"+g("2[0-4]"+Kt)+"|"+g("1"+Kt+Kt)+"|"+g("[1-9]"+Kt)+"|"+Kt),g(g("25[0-5]")+"|"+g("2[0-4]"+Kt)+"|"+g("1"+Kt+Kt)+"|"+g("0?[1-9]"+Kt)+"|0?0?"+Kt)),zt=g(ot+"\\."+ot+"\\."+ot+"\\."+ot),Wt=g(ae+"{1,4}"),Ut=g(g(Wt+"\\:"+Wt)+"|"+zt),ve=g([g(g(Wt+"\\:")+"{6}"+Ut),g("\\:\\:"+g(Wt+"\\:")+"{5}"+Ut),g(g(Wt)+"?\\:\\:"+g(Wt+"\\:")+"{4}"+Ut),g(g(g(Wt+"\\:")+"{0,1}"+Wt)+"?\\:\\:"+g(Wt+"\\:")+"{3}"+Ut),g(g(g(Wt+"\\:")+"{0,2}"+Wt)+"?\\:\\:"+g(Wt+"\\:")+"{2}"+Ut),g(g(g(Wt+"\\:")+"{0,3}"+Wt)+"?\\:\\:"+Wt+"\\:"+Ut),g(g(g(Wt+"\\:")+"{0,4}"+Wt)+"?\\:\\:"+Ut),g(g(g(Wt+"\\:")+"{0,5}"+Wt)+"?\\:\\:"+Wt),g(g(g(Wt+"\\:")+"{0,6}"+Wt)+"?\\:\\:")].join("|")),Se=g(g(Oe+"|"+Ve)+"+"),nr=(g(ve+"\\%25"+Se),g("\\["+g(g(ve+g("\\%25|\\%(?!"+ae+"{2})")+Se)+"|"+ve+"|"+g("[vV]"+ae+"+\\."+m(Oe,Be,"[\\:]")+"+"))+"\\]")),xr=g(g(Ve+"|"+m(Oe,Be))+"*"),Me=g(nr+"|"+zt+"(?!"+xr+")|"+xr),ei=g(Kt+"*"),fr=g(g(ar+"@")+"?"+Me+g("\\:"+ei)+"?"),Mr=g(Ve+"|"+m(Oe,Be,"[\\:\\@]")),hr=g(Mr+"*"),Vr=g(Mr+"+"),yi=g(g(Ve+"|"+m(Oe,Be,"[\\@]"))+"+"),Qr=g(g("\\/"+hr)+"*"),Fi=g("\\/"+g(Vr+Qr)+"?"),ro=g(yi+Qr),Ln=g(Vr+Qr),Di="(?!"+Mr+")",un=(g(Qr+"|"+Fi+"|"+ro+"|"+Ln+"|"+Di),g(g(Mr+"|"+m("[\\/\\?]",br))+"*")),Mi=g(g(Mr+"|[\\/\\?]")+"*"),Qi=g(g("\\/\\/"+fr+Qr)+"|"+Fi+"|"+Ln+"|"+Di);return g(g(ur+"\\:"+Qi+g("\\?"+un)+"?"+g("\\#"+Mi)+"?")+"|"+g(g(g("\\/\\/"+fr+Qr)+"|"+Fi+"|"+ro+"|"+Di)+g("\\?"+un)+"?"+g("\\#"+Mi)+"?")),g(ur+"\\:"+Qi+g("\\?"+un)+"?"),g(g("\\/\\/("+g("("+ar+")@")+"?("+Me+")"+g("\\:("+ei+")")+"?)")+"?("+Qr+"|"+Fi+"|"+Ln+"|"+Di+")"),g("\\?("+un+")"),g("\\#("+Mi+")"),g(g("\\/\\/("+g("("+ar+")@")+"?("+Me+")"+g("\\:("+ei+")")+"?)")+"?("+Qr+"|"+Fi+"|"+ro+"|"+Di+")"),g("\\?("+un+")"),g("\\#("+Mi+")"),g(g("\\/\\/("+g("("+ar+")@")+"?("+Me+")"+g("\\:("+ei+")")+"?)")+"?("+Qr+"|"+Fi+"|"+Ln+"|"+Di+")"),g("\\?("+un+")"),g("\\#("+Mi+")"),g("("+ar+")@"),g("\\:("+ei+")"),{NOT_SCHEME:new RegExp(m("[^]",Ot,Kt,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(m("[^\\%\\:]",Oe,Be),"g"),NOT_HOST:new RegExp(m("[^\\%\\[\\]\\:]",Oe,Be),"g"),NOT_PATH:new RegExp(m("[^\\%\\/\\:\\@]",Oe,Be),"g"),NOT_PATH_NOSCHEME:new RegExp(m("[^\\%\\/\\@]",Oe,Be),"g"),NOT_QUERY:new RegExp(m("[^\\%]",Oe,Be,"[\\:\\@\\/\\?]",br),"g"),NOT_FRAGMENT:new RegExp(m("[^\\%]",Oe,Be,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(m("[^]",Oe,Be),"g"),UNRESERVED:new RegExp(Oe,"g"),OTHER_CHARS:new RegExp(m("[^\\%]",Oe,Er),"g"),PCT_ENCODED:new RegExp(Ve,"g"),IPV4ADDRESS:new RegExp("^("+zt+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ve+")"+g(g("\\%25|\\%(?!"+ae+"{2})")+"("+Se+")")+"?\\]?$")}}var L=P(!1),F=P(!0),U=function(Ft,Ot){if(Array.isArray(Ft))return Ft;if(Symbol.iterator in Object(Ft))return function(Kt,ae){var Ve=[],Be=!0,Er=!1,br=void 0;try{for(var Oe,ur=Kt[Symbol.iterator]();!(Be=(Oe=ur.next()).done)&&(Ve.push(Oe.value),!ae||Ve.length!==ae);Be=!0);}catch(ar){Er=!0,br=ar}finally{try{!Be&&ur.return&&ur.return()}finally{if(Er)throw br}}return Ve}(Ft,Ot);throw new TypeError("Invalid attempt to destructure non-iterable instance")},A=2147483647,G=/^xn--/,B=/[^\0-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,K={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Q=Math.floor,et=String.fromCharCode;function lt(Ft){throw new RangeError(K[Ft])}function pt(Ft,Ot){var Kt=Ft.split("@"),ae="";return 1<Kt.length&&(ae=Kt[0]+"@",Ft=Kt[1]),ae+function(Ve,Be){for(var Er=[],br=Ve.length;br--;)Er[br]=Be(Ve[br]);return Er}((Ft=Ft.replace(O,".")).split("."),Ot).join(".")}function T(Ft){for(var Ot=[],Kt=0,ae=Ft.length;Kt<ae;){var Ve=Ft.charCodeAt(Kt++);if(55296<=Ve&&Ve<=56319&&Kt<ae){var Be=Ft.charCodeAt(Kt++);(64512&Be)==56320?Ot.push(((1023&Ve)<<10)+(1023&Be)+65536):(Ot.push(Ve),Kt--)}else Ot.push(Ve)}return Ot}var ct=function(Ft,Ot){return Ft+22+75*(Ft<26)-((Ot!=0)<<5)},ut=function(Ft,Ot,Kt){var ae=0;for(Ft=Kt?Q(Ft/700):Ft>>1,Ft+=Q(Ft/Ot);455<Ft;ae+=36)Ft=Q(Ft/35);return Q(ae+36*Ft/(Ft+38))},ft=function(Ft){var Ot,Kt=[],ae=Ft.length,Ve=0,Be=128,Er=72,br=Ft.lastIndexOf("-");br<0&&(br=0);for(var Oe=0;Oe<br;++Oe)128<=Ft.charCodeAt(Oe)&&lt("not-basic"),Kt.push(Ft.charCodeAt(Oe));for(var ur=0<br?br+1:0;ur<ae;){for(var ar=Ve,ot=1,zt=36;;zt+=36){ae<=ur&&lt("invalid-input");var Wt=(Ot=Ft.charCodeAt(ur++))-48<10?Ot-22:Ot-65<26?Ot-65:Ot-97<26?Ot-97:36;(36<=Wt||Wt>Q((A-Ve)/ot))&&lt("overflow"),Ve+=Wt*ot;var Ut=zt<=Er?1:Er+26<=zt?26:zt-Er;if(Wt<Ut)break;var ve=36-Ut;ot>Q(A/ve)&&lt("overflow"),ot*=ve}var Se=Kt.length+1;Er=ut(Ve-ar,Se,ar==0),Q(Ve/Se)>A-Be&&lt("overflow"),Be+=Q(Ve/Se),Ve%=Se,Kt.splice(Ve++,0,Be)}return String.fromCodePoint.apply(String,Kt)},$=function(Ft){var Ot=[],Kt=(Ft=T(Ft)).length,ae=128,Ve=0,Be=72,Er=!0,br=!1,Oe=void 0;try{for(var ur,ar=Ft[Symbol.iterator]();!(Er=(ur=ar.next()).done);Er=!0){var ot=ur.value;ot<128&&Ot.push(et(ot))}}catch(Qi){br=!0,Oe=Qi}finally{try{!Er&&ar.return&&ar.return()}finally{if(br)throw Oe}}var zt=Ot.length,Wt=zt;for(zt&&Ot.push("-");Wt<Kt;){var Ut=A,ve=!0,Se=!1,nr=void 0;try{for(var xr,Me=Ft[Symbol.iterator]();!(ve=(xr=Me.next()).done);ve=!0){var ei=xr.value;ae<=ei&&ei<Ut&&(Ut=ei)}}catch(Qi){Se=!0,nr=Qi}finally{try{!ve&&Me.return&&Me.return()}finally{if(Se)throw nr}}var fr=Wt+1;Ut-ae>Q((A-Ve)/fr)&&lt("overflow"),Ve+=(Ut-ae)*fr,ae=Ut;var Mr=!0,hr=!1,Vr=void 0;try{for(var yi,Qr=Ft[Symbol.iterator]();!(Mr=(yi=Qr.next()).done);Mr=!0){var Fi=yi.value;if(Fi<ae&&++Ve>A&&lt("overflow"),Fi==ae){for(var ro=Ve,Ln=36;;Ln+=36){var Di=Ln<=Be?1:Be+26<=Ln?26:Ln-Be;if(ro<Di)break;var un=ro-Di,Mi=36-Di;Ot.push(et(ct(Di+un%Mi,0))),ro=Q(un/Mi)}Ot.push(et(ct(ro,0))),Be=ut(Ve,fr,Wt==zt),Ve=0,++Wt}}}catch(Qi){hr=!0,Vr=Qi}finally{try{!Mr&&Qr.return&&Qr.return()}finally{if(hr)throw Vr}}++Ve,++ae}return Ot.join("")},_t={version:"2.1.0",ucs2:{decode:T,encode:function(Ft){return String.fromCodePoint.apply(String,function(Ot){if(Array.isArray(Ot)){for(var Kt=0,ae=Array(Ot.length);Kt<Ot.length;Kt++)ae[Kt]=Ot[Kt];return ae}return Array.from(Ot)}(Ft))}},decode:ft,encode:$,toASCII:function(Ft){return pt(Ft,function(Ot){return B.test(Ot)?"xn--"+$(Ot):Ot})},toUnicode:function(Ft){return pt(Ft,function(Ot){return G.test(Ot)?ft(Ot.slice(4).toLowerCase()):Ot})}},W={};function rt(Ft){var Ot=Ft.charCodeAt(0);return Ot<16?"%0"+Ot.toString(16).toUpperCase():Ot<128?"%"+Ot.toString(16).toUpperCase():Ot<2048?"%"+(Ot>>6|192).toString(16).toUpperCase()+"%"+(63&Ot|128).toString(16).toUpperCase():"%"+(Ot>>12|224).toString(16).toUpperCase()+"%"+(Ot>>6&63|128).toString(16).toUpperCase()+"%"+(63&Ot|128).toString(16).toUpperCase()}function nt(Ft){for(var Ot="",Kt=0,ae=Ft.length;Kt<ae;){var Ve=parseInt(Ft.substr(Kt+1,2),16);if(Ve<128)Ot+=String.fromCharCode(Ve),Kt+=3;else if(194<=Ve&&Ve<224){if(6<=ae-Kt){var Be=parseInt(Ft.substr(Kt+4,2),16);Ot+=String.fromCharCode((31&Ve)<<6|63&Be)}else Ot+=Ft.substr(Kt,6);Kt+=6}else if(224<=Ve){if(9<=ae-Kt){var Er=parseInt(Ft.substr(Kt+4,2),16),br=parseInt(Ft.substr(Kt+7,2),16);Ot+=String.fromCharCode((15&Ve)<<12|(63&Er)<<6|63&br)}else Ot+=Ft.substr(Kt,9);Kt+=9}else Ot+=Ft.substr(Kt,3),Kt+=3}return Ot}function vt(Ft,Ot){function Kt(ae){var Ve=nt(ae);return Ve.match(Ot.UNRESERVED)?Ve:ae}return Ft.scheme&&(Ft.scheme=String(Ft.scheme).replace(Ot.PCT_ENCODED,Kt).toLowerCase().replace(Ot.NOT_SCHEME,"")),Ft.userinfo!==void 0&&(Ft.userinfo=String(Ft.userinfo).replace(Ot.PCT_ENCODED,Kt).replace(Ot.NOT_USERINFO,rt).replace(Ot.PCT_ENCODED,E)),Ft.host!==void 0&&(Ft.host=String(Ft.host).replace(Ot.PCT_ENCODED,Kt).toLowerCase().replace(Ot.NOT_HOST,rt).replace(Ot.PCT_ENCODED,E)),Ft.path!==void 0&&(Ft.path=String(Ft.path).replace(Ot.PCT_ENCODED,Kt).replace(Ft.scheme?Ot.NOT_PATH:Ot.NOT_PATH_NOSCHEME,rt).replace(Ot.PCT_ENCODED,E)),Ft.query!==void 0&&(Ft.query=String(Ft.query).replace(Ot.PCT_ENCODED,Kt).replace(Ot.NOT_QUERY,rt).replace(Ot.PCT_ENCODED,E)),Ft.fragment!==void 0&&(Ft.fragment=String(Ft.fragment).replace(Ot.PCT_ENCODED,Kt).replace(Ot.NOT_FRAGMENT,rt).replace(Ot.PCT_ENCODED,E)),Ft}function Mt(Ft){return Ft.replace(/^0*(.*)/,"$1")||"0"}function Bt(Ft,Ot){var Kt=Ft.match(Ot.IPV4ADDRESS)||[],ae=U(Kt,2)[1];return ae?ae.split(".").map(Mt).join("."):Ft}function Vt(Ft,Ot){var Kt=Ft.match(Ot.IPV6ADDRESS)||[],ae=U(Kt,3),Ve=ae[1],Be=ae[2];if(Ve){for(var Er=Ve.toLowerCase().split("::").reverse(),br=U(Er,2),Oe=br[0],ur=br[1],ar=ur?ur.split(":").map(Mt):[],ot=Oe.split(":").map(Mt),zt=Ot.IPV4ADDRESS.test(ot[ot.length-1]),Wt=zt?7:8,Ut=ot.length-Wt,ve=Array(Wt),Se=0;Se<Wt;++Se)ve[Se]=ar[Se]||ot[Ut+Se]||"";zt&&(ve[Wt-1]=Bt(ve[Wt-1],Ot));var nr=ve.reduce(function(fr,Mr,hr){if(!Mr||Mr==="0"){var Vr=fr[fr.length-1];Vr&&Vr.index+Vr.length===hr?Vr.length++:fr.push({index:hr,length:1})}return fr},[]).sort(function(fr,Mr){return Mr.length-fr.length})[0],xr=void 0;if(nr&&1<nr.length){var Me=ve.slice(0,nr.index),ei=ve.slice(nr.index+nr.length);xr=Me.join(":")+"::"+ei.join(":")}else xr=ve.join(":");return Be&&(xr+="%"+Be),xr}return Ft}var Lt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Ne="".match(/(){0}/)[1]===void 0;function ge(Ft){var Ot=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Kt={},ae=Ot.iri!==!1?F:L;Ot.reference==="suffix"&&(Ft=(Ot.scheme?Ot.scheme+":":"")+"//"+Ft);var Ve=Ft.match(Lt);if(Ve){Ne?(Kt.scheme=Ve[1],Kt.userinfo=Ve[3],Kt.host=Ve[4],Kt.port=parseInt(Ve[5],10),Kt.path=Ve[6]||"",Kt.query=Ve[7],Kt.fragment=Ve[8],isNaN(Kt.port)&&(Kt.port=Ve[5])):(Kt.scheme=Ve[1]||void 0,Kt.userinfo=Ft.indexOf("@")!==-1?Ve[3]:void 0,Kt.host=Ft.indexOf("//")!==-1?Ve[4]:void 0,Kt.port=parseInt(Ve[5],10),Kt.path=Ve[6]||"",Kt.query=Ft.indexOf("?")!==-1?Ve[7]:void 0,Kt.fragment=Ft.indexOf("#")!==-1?Ve[8]:void 0,isNaN(Kt.port)&&(Kt.port=Ft.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?Ve[4]:void 0)),Kt.host&&(Kt.host=Vt(Bt(Kt.host,ae),ae)),Kt.reference=Kt.scheme!==void 0||Kt.userinfo!==void 0||Kt.host!==void 0||Kt.port!==void 0||Kt.path||Kt.query!==void 0?Kt.scheme===void 0?"relative":Kt.fragment===void 0?"absolute":"uri":"same-document",Ot.reference&&Ot.reference!=="suffix"&&Ot.reference!==Kt.reference&&(Kt.error=Kt.error||"URI is not a "+Ot.reference+" reference.");var Be=W[(Ot.scheme||Kt.scheme||"").toLowerCase()];if(Ot.unicodeSupport||Be&&Be.unicodeSupport)vt(Kt,ae);else{if(Kt.host&&(Ot.domainHost||Be&&Be.domainHost))try{Kt.host=_t.toASCII(Kt.host.replace(ae.PCT_ENCODED,nt).toLowerCase())}catch(Er){Kt.error=Kt.error||"Host's domain name can not be converted to ASCII via punycode: "+Er}vt(Kt,L)}Be&&Be.parse&&Be.parse(Kt,Ot)}else Kt.error=Kt.error||"URI can not be parsed.";return Kt}var Yt=/^\.\.?\//,ue=/^\/\.(\/|$)/,ne=/^\/\.\.(\/|$)/,dr=/^\/?(?:.|\n)*?(?=\/|$)/;function je(Ft){for(var Ot=[];Ft.length;)if(Ft.match(Yt))Ft=Ft.replace(Yt,"");else if(Ft.match(ue))Ft=Ft.replace(ue,"/");else if(Ft.match(ne))Ft=Ft.replace(ne,"/"),Ot.pop();else if(Ft==="."||Ft==="..")Ft="";else{var Kt=Ft.match(dr);if(!Kt)throw new Error("Unexpected dot segment condition");var ae=Kt[0];Ft=Ft.slice(ae.length),Ot.push(ae)}return Ot.join("")}function Br(Ft){var Ot=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Kt=Ot.iri?F:L,ae=[],Ve=W[(Ot.scheme||Ft.scheme||"").toLowerCase()];if(Ve&&Ve.serialize&&Ve.serialize(Ft,Ot),Ft.host&&!Kt.IPV6ADDRESS.test(Ft.host)){if(Ot.domainHost||Ve&&Ve.domainHost)try{Ft.host=Ot.iri?_t.toUnicode(Ft.host):_t.toASCII(Ft.host.replace(Kt.PCT_ENCODED,nt).toLowerCase())}catch(ar){Ft.error=Ft.error||"Host's domain name can not be converted to "+(Ot.iri?"Unicode":"ASCII")+" via punycode: "+ar}}vt(Ft,Kt),Ot.reference!=="suffix"&&Ft.scheme&&(ae.push(Ft.scheme),ae.push(":"));var Be,Er,br,Oe=(Er=Ot.iri!==!1?F:L,br=[],(Be=Ft).userinfo!==void 0&&(br.push(Be.userinfo),br.push("@")),Be.host!==void 0&&br.push(Vt(Bt(String(Be.host),Er),Er).replace(Er.IPV6ADDRESS,function(ar,ot,zt){return"["+ot+(zt?"%25"+zt:"")+"]"})),typeof Be.port=="number"&&(br.push(":"),br.push(Be.port.toString(10))),br.length?br.join(""):void 0);if(Oe!==void 0&&(Ot.reference!=="suffix"&&ae.push("//"),ae.push(Oe),Ft.path&&Ft.path.charAt(0)!=="/"&&ae.push("/")),Ft.path!==void 0){var ur=Ft.path;Ot.absolutePath||Ve&&Ve.absolutePath||(ur=je(ur)),Oe===void 0&&(ur=ur.replace(/^\/\//,"/%2F")),ae.push(ur)}return Ft.query!==void 0&&(ae.push("?"),ae.push(Ft.query)),Ft.fragment!==void 0&&(ae.push("#"),ae.push(Ft.fragment)),ae.join("")}function Ue(Ft,Ot){var Kt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},ae={};return arguments[3]||(Ft=ge(Br(Ft,Kt),Kt),Ot=ge(Br(Ot,Kt),Kt)),!(Kt=Kt||{}).tolerant&&Ot.scheme?(ae.scheme=Ot.scheme,ae.userinfo=Ot.userinfo,ae.host=Ot.host,ae.port=Ot.port,ae.path=je(Ot.path||""),ae.query=Ot.query):(Ot.userinfo!==void 0||Ot.host!==void 0||Ot.port!==void 0?(ae.userinfo=Ot.userinfo,ae.host=Ot.host,ae.port=Ot.port,ae.path=je(Ot.path||""),ae.query=Ot.query):(Ot.path?(Ot.path.charAt(0)==="/"?ae.path=je(Ot.path):(ae.path=Ft.userinfo===void 0&&Ft.host===void 0&&Ft.port===void 0||Ft.path?Ft.path?Ft.path.slice(0,Ft.path.lastIndexOf("/")+1)+Ot.path:Ot.path:"/"+Ot.path,ae.path=je(ae.path)),ae.query=Ot.query):(ae.path=Ft.path,ae.query=Ot.query!==void 0?Ot.query:Ft.query),ae.userinfo=Ft.userinfo,ae.host=Ft.host,ae.port=Ft.port),ae.scheme=Ft.scheme),ae.fragment=Ot.fragment,ae}function Fe(Ft,Ot){return Ft&&Ft.toString().replace(Ot&&Ot.iri?F.PCT_ENCODED:L.PCT_ENCODED,nt)}var Lr={scheme:"http",domainHost:!0,parse:function(Ft,Ot){return Ft.host||(Ft.error=Ft.error||"HTTP URIs must have a host."),Ft},serialize:function(Ft,Ot){return Ft.port!==(String(Ft.scheme).toLowerCase()!=="https"?80:443)&&Ft.port!==""||(Ft.port=void 0),Ft.path||(Ft.path="/"),Ft}},De={scheme:"https",domainHost:Lr.domainHost,parse:Lr.parse,serialize:Lr.serialize},se={},oe="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Ar="[0-9A-Fa-f]",vr=g(g("%[EFef]"+Ar+"%"+Ar+Ar+"%"+Ar+Ar)+"|"+g("%[89A-Fa-f]"+Ar+"%"+Ar+Ar)+"|"+g("%"+Ar+Ar)),Kr=m("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),wi=new RegExp(oe,"g"),Ee=new RegExp(vr,"g"),Sr=new RegExp(m("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Kr),"g"),Or=new RegExp(m("[^]",oe,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),xn=Or;function ye(Ft){var Ot=nt(Ft);return Ot.match(wi)?Ot:Ft}var oi={scheme:"mailto",parse:function(Ft,Ot){var Kt=Ft,ae=Kt.to=Kt.path?Kt.path.split(","):[];if(Kt.path=void 0,Kt.query){for(var Ve=!1,Be={},Er=Kt.query.split("&"),br=0,Oe=Er.length;br<Oe;++br){var ur=Er[br].split("=");switch(ur[0]){case"to":for(var ar=ur[1].split(","),ot=0,zt=ar.length;ot<zt;++ot)ae.push(ar[ot]);break;case"subject":Kt.subject=Fe(ur[1],Ot);break;case"body":Kt.body=Fe(ur[1],Ot);break;default:Ve=!0,Be[Fe(ur[0],Ot)]=Fe(ur[1],Ot)}}Ve&&(Kt.headers=Be)}Kt.query=void 0;for(var Wt=0,Ut=ae.length;Wt<Ut;++Wt){var ve=ae[Wt].split("@");if(ve[0]=Fe(ve[0]),Ot.unicodeSupport)ve[1]=Fe(ve[1],Ot).toLowerCase();else try{ve[1]=_t.toASCII(Fe(ve[1],Ot).toLowerCase())}catch(Se){Kt.error=Kt.error||"Email address's domain name can not be converted to ASCII via punycode: "+Se}ae[Wt]=ve.join("@")}return Kt},serialize:function(Ft,Ot){var Kt,ae=Ft,Ve=(Kt=Ft.to)!=null?Kt instanceof Array?Kt:typeof Kt.length!="number"||Kt.split||Kt.setInterval||Kt.call?[Kt]:Array.prototype.slice.call(Kt):[];if(Ve){for(var Be=0,Er=Ve.length;Be<Er;++Be){var br=String(Ve[Be]),Oe=br.lastIndexOf("@"),ur=br.slice(0,Oe).replace(Ee,ye).replace(Ee,E).replace(Sr,rt),ar=br.slice(Oe+1);try{ar=Ot.iri?_t.toUnicode(ar):_t.toASCII(Fe(ar,Ot).toLowerCase())}catch(Ut){ae.error=ae.error||"Email address's domain name can not be converted to "+(Ot.iri?"Unicode":"ASCII")+" via punycode: "+Ut}Ve[Be]=ur+"@"+ar}ae.path=Ve.join(",")}var ot=Ft.headers=Ft.headers||{};Ft.subject&&(ot.subject=Ft.subject),Ft.body&&(ot.body=Ft.body);var zt=[];for(var Wt in ot)ot[Wt]!==se[Wt]&&zt.push(Wt.replace(Ee,ye).replace(Ee,E).replace(Or,rt)+"="+ot[Wt].replace(Ee,ye).replace(Ee,E).replace(xn,rt));return zt.length&&(ae.query=zt.join("&")),ae}},eo=/^([^\:]+)\:(.*)/,Xo={scheme:"urn",parse:function(Ft,Ot){var Kt=Ft.path&&Ft.path.match(eo),ae=Ft;if(Kt){var Ve=Ot.scheme||ae.scheme||"urn",Be=Kt[1].toLowerCase(),Er=Kt[2],br=W[Ve+":"+(Ot.nid||Be)];ae.nid=Be,ae.nss=Er,ae.path=void 0,br&&(ae=br.parse(ae,Ot))}else ae.error=ae.error||"URN can not be parsed.";return ae},serialize:function(Ft,Ot){var Kt=Ft.nid,ae=W[(Ot.scheme||Ft.scheme||"urn")+":"+(Ot.nid||Kt)];ae&&(Ft=ae.serialize(Ft,Ot));var Ve=Ft;return Ve.path=(Kt||Ot.nid)+":"+Ft.nss,Ve}},Xn=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,cn={scheme:"urn:uuid",parse:function(Ft,Ot){var Kt=Ft;return Kt.uuid=Kt.nss,Kt.nss=void 0,Ot.tolerant||Kt.uuid&&Kt.uuid.match(Xn)||(Kt.error=Kt.error||"UUID is not valid."),Kt},serialize:function(Ft,Ot){var Kt=Ft;return Kt.nss=(Ft.uuid||"").toLowerCase(),Kt}};W[Lr.scheme]=Lr,W[De.scheme]=De,W[oi.scheme]=oi,W[Xo.scheme]=Xo,W[cn.scheme]=cn,d.SCHEMES=W,d.pctEncChar=rt,d.pctDecChars=nt,d.parse=ge,d.removeDotSegments=je,d.serialize=Br,d.resolveComponents=Ue,d.resolve=function(Ft,Ot,Kt){var ae=function(Ve,Be){var Er=Ve;if(Be)for(var br in Be)Er[br]=Be[br];return Er}({scheme:"null"},Kt);return Br(Ue(ge(Ft,ae),ge(Ot,ae),ae,!0),ae)},d.normalize=function(Ft,Ot){return typeof Ft=="string"?Ft=Br(ge(Ft,Ot),Ot):x(Ft)==="object"&&(Ft=ge(Br(Ft,Ot),Ot)),Ft},d.equal=function(Ft,Ot,Kt){return typeof Ft=="string"?Ft=Br(ge(Ft,Kt),Kt):x(Ft)==="object"&&(Ft=Br(Ft,Kt)),typeof Ot=="string"?Ot=Br(ge(Ot,Kt),Kt):x(Ot)==="object"&&(Ot=Br(Ot,Kt)),Ft===Ot},d.escapeComponent=function(Ft,Ot){return Ft&&Ft.toString().replace(Ot&&Ot.iri?F.ESCAPE:L.ESCAPE,rt)},d.unescapeComponent=Fe,Object.defineProperty(d,"__esModule",{value:!0})}(typeof h=="object"&&c!==void 0?h:u.URI=u.URI||{})},{}],ajv:[function(n,c,h){"use strict";var u=n("./compile"),d=n("./compile/resolve"),m=n("./cache"),g=n("./compile/schema_obj"),x=n("fast-json-stable-stringify"),E=n("./compile/formats"),P=n("./compile/rules"),L=n("./data"),F=n("./compile/util");(c.exports=K).prototype.validate=function(ft,$){var _t;if(typeof ft=="string"){if(!(_t=this.getSchema(ft)))throw new Error('no schema with key or ref "'+ft+'"')}else{var W=this._addSchema(ft);_t=W.validate||this._compile(W)}var rt=_t($);return _t.$async!==!0&&(this.errors=_t.errors),rt},K.prototype.compile=function(ft,$){var _t=this._addSchema(ft,void 0,$);return _t.validate||this._compile(_t)},K.prototype.addSchema=function(ft,$,_t,W){if(Array.isArray(ft)){for(var rt=0;rt<ft.length;rt++)this.addSchema(ft[rt],void 0,_t,W);return this}var nt=this._getId(ft);if(nt!==void 0&&typeof nt!="string")throw new Error("schema id must be string");return ct(this,$=d.normalizeId($||nt)),this._schemas[$]=this._addSchema(ft,_t,W,!0),this},K.prototype.addMetaSchema=function(ft,$,_t){return this.addSchema(ft,$,_t,!0),this},K.prototype.validateSchema=function(ft,$){var _t=ft.$schema;if(_t!==void 0&&typeof _t!="string")throw new Error("$schema must be a string");if(!(_t=_t||this._opts.defaultMeta||(W=this,rt=W._opts.meta,W._opts.defaultMeta=typeof rt=="object"?W._getId(rt)||rt:W.getSchema(G)?G:void 0,W._opts.defaultMeta)))return this.logger.warn("meta-schema not available"),!(this.errors=null);var W,rt,nt,vt=this._formats.uri;this._formats.uri=typeof vt=="function"?this._schemaUriFormatFunc:this._schemaUriFormat;try{nt=this.validate(_t,ft)}finally{this._formats.uri=vt}if(!nt&&$){var Mt="schema is invalid: "+this.errorsText();if(this._opts.validateSchema!="log")throw new Error(Mt);this.logger.error(Mt)}return nt},K.prototype.getSchema=function(ft){var $=Q(this,ft);switch(typeof $){case"object":return $.validate||this._compile($);case"string":return this.getSchema($);case"undefined":return function(_t,W){var rt=d.schema.call(_t,{schema:{}},W);if(rt){var nt=rt.schema,vt=rt.root,Mt=rt.baseId,Bt=u.call(_t,nt,vt,void 0,Mt);return _t._fragments[W]=new g({ref:W,fragment:!0,schema:nt,root:vt,baseId:Mt,validate:Bt}),Bt}}(this,ft)}},K.prototype.removeSchema=function(ft){if(ft instanceof RegExp)return et(this,this._schemas,ft),et(this,this._refs,ft),this;switch(typeof ft){case"undefined":return et(this,this._schemas),et(this,this._refs),this._cache.clear(),this;case"string":var $=Q(this,ft);return $&&this._cache.del($.cacheKey),delete this._schemas[ft],delete this._refs[ft],this;case"object":var _t=this._opts.serialize,W=_t?_t(ft):ft;this._cache.del(W);var rt=this._getId(ft);rt&&(rt=d.normalizeId(rt),delete this._schemas[rt],delete this._refs[rt])}return this},K.prototype.addFormat=function(ft,$){return typeof $=="string"&&($=new RegExp($)),this._formats[ft]=$,this},K.prototype.errorsText=function(ft,$){if(!(ft=ft||this.errors))return"No errors";for(var _t=($=$||{}).separator===void 0?", ":$.separator,W=$.dataVar===void 0?"data":$.dataVar,rt="",nt=0;nt<ft.length;nt++){var vt=ft[nt];vt&&(rt+=W+vt.dataPath+" "+vt.message+_t)}return rt.slice(0,-_t.length)},K.prototype._addSchema=function(ft,$,_t,W){if(typeof ft!="object"&&typeof ft!="boolean")throw new Error("schema should be object or boolean");var rt=this._opts.serialize,nt=rt?rt(ft):ft,vt=this._cache.get(nt);if(vt)return vt;W=W||this._opts.addUsedSchema!==!1;var Mt=d.normalizeId(this._getId(ft));Mt&&W&&ct(this,Mt);var Bt,Vt=this._opts.validateSchema!==!1&&!$;Vt&&!(Bt=Mt&&Mt==d.normalizeId(ft.$schema))&&this.validateSchema(ft,!0);var Lt=d.ids.call(this,ft),Ne=new g({id:Mt,schema:ft,localRefs:Lt,cacheKey:nt,meta:_t});return Mt[0]!="#"&&W&&(this._refs[Mt]=Ne),this._cache.put(nt,Ne),Vt&&Bt&&this.validateSchema(ft,!0),Ne},K.prototype._compile=function(ft,$){if(ft.compiling)return(ft.validate=rt).schema=ft.schema,rt.errors=null,rt.root=$||rt,ft.schema.$async===!0&&(rt.$async=!0),rt;var _t,W;ft.compiling=!0,ft.meta&&(_t=this._opts,this._opts=this._metaOpts);try{W=u.call(this,ft.schema,$,ft.localRefs)}finally{ft.compiling=!1,ft.meta&&(this._opts=_t)}return ft.validate=W,ft.refs=W.refs,ft.refVal=W.refVal,ft.root=W.root,W;function rt(){var nt=ft.validate,vt=nt.apply(this,arguments);return rt.errors=nt.errors,vt}},K.prototype.compileAsync=n("./compile/async");var U=n("./keyword");K.prototype.addKeyword=U.add,K.prototype.getKeyword=U.get,K.prototype.removeKeyword=U.remove;var A=n("./compile/error_classes");K.ValidationError=A.Validation,K.MissingRefError=A.MissingRef,K.$dataMetaSchema=L;var G="http://json-schema.org/draft-07/schema",B=["removeAdditional","useDefaults","coerceTypes"],O=["/properties"];function K(ft){if(!(this instanceof K))return new K(ft);ft=this._opts=F.copy(ft)||{},function(_t){var W=_t._opts.logger;if(W===!1)_t.logger={log:ut,warn:ut,error:ut};else{if(W===void 0&&(W=console),!(typeof W=="object"&&W.log&&W.warn&&W.error))throw new Error("logger must implement log, warn and error methods");_t.logger=W}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=E(ft.format);var $=this._schemaUriFormat=this._formats["uri-reference"];this._schemaUriFormatFunc=function(_t){return $.test(_t)},this._cache=ft.cache||new m,this._loadingSchemas={},this._compilations=[],this.RULES=P(),this._getId=function(_t){switch(_t.schemaId){case"auto":return T;case"id":return lt;default:return pt}}(ft),ft.loopRequired=ft.loopRequired||1/0,ft.errorDataPath=="property"&&(ft._errorDataPathProperty=!0),ft.serialize===void 0&&(ft.serialize=x),this._metaOpts=function(_t){for(var W=F.copy(_t._opts),rt=0;rt<B.length;rt++)delete W[B[rt]];return W}(this),ft.formats&&function(_t){for(var W in _t._opts.formats){var rt=_t._opts.formats[W];_t.addFormat(W,rt)}}(this),function(_t){var W;if(_t._opts.$data&&(W=n("./refs/data.json"),_t.addMetaSchema(W,W.$id,!0)),_t._opts.meta!==!1){var rt=n("./refs/json-schema-draft-07.json");_t._opts.$data&&(rt=L(rt,O)),_t.addMetaSchema(rt,G,!0),_t._refs["http://json-schema.org/schema"]=G}}(this),typeof ft.meta=="object"&&this.addMetaSchema(ft.meta),function(_t){var W=_t._opts.schemas;if(W)if(Array.isArray(W))_t.addSchema(W);else for(var rt in W)_t.addSchema(W[rt],rt)}(this)}function Q(ft,$){return $=d.normalizeId($),ft._schemas[$]||ft._refs[$]||ft._fragments[$]}function et(ft,$,_t){for(var W in $){var rt=$[W];rt.meta||_t&&!_t.test(W)||(ft._cache.del(rt.cacheKey),delete $[W])}}function lt(ft){return ft.$id&&this.logger.warn("schema $id ignored",ft.$id),ft.id}function pt(ft){return ft.id&&this.logger.warn("schema id ignored",ft.id),ft.$id}function T(ft){if(ft.$id&&ft.id&&ft.$id!=ft.id)throw new Error("schema $id is different from id");return ft.$id||ft.id}function ct(ft,$){if(ft._schemas[$]||ft._refs[$])throw new Error('schema with key or id "'+$+'" already exists')}function ut(){}},{"./cache":1,"./compile":5,"./compile/async":2,"./compile/error_classes":3,"./compile/formats":4,"./compile/resolve":6,"./compile/rules":7,"./compile/schema_obj":8,"./compile/util":10,"./data":11,"./keyword":38,"./refs/data.json":39,"./refs/json-schema-draft-07.json":40,"fast-json-stable-stringify":42}]},{},[])("ajv")});var telemetrySchema=[{$id:"http://api.ekstep.org/telemetry/actor",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/actor/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/actor/type",type:"string"}},required:["type","id"]},{$id:"http://api.ekstep.org/telemetry/assess",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["ASSESS"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["item","pass","score","resvalues","duration"],properties:{item:{$ref:"http://api.ekstep.org/telemetry/question"},index:{$id:"http://api.ekstep.org/telemetry/edata/index",type:"number"},pass:{$id:"http://api.ekstep.org/telemetry/edata/pass",type:"string"},score:{$id:"http://api.ekstep.org/telemetry/edata/score",type:"number"},resvalues:{$id:"http://api.ekstep.org/telemetry/edata/resvalues",type:"array",items:{type:"object"}},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"}}}}}]},{$id:"http://api.ekstep.org/telemetry/audit",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["AUDIT"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,properties:{props:{$id:"http://api.ekstep.org/telemetry/edata/props",type:"array",items:{type:"string"}},state:{$id:"http://api.ekstep.org/telemetry/edata/state",type:"string"},prevstate:{$id:"http://api.ekstep.org/telemetry/edata/prevstate",type:"string"},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"},type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"}}}}}]},{$id:"http://api.ekstep.org/telemetry/cdata",type:"array",items:{type:"object",properties:{type:{$id:"http://api.ekstep.org/telemetry/cdata/type",type:"string"},id:{$id:"http://api.ekstep.org/telemetry/cdata/id",type:"string"}},additionalProperties:!1,required:["type","id"]}},{$id:"http://api.ekstep.org/telemetry/common",type:"object",properties:{ets:{$id:"http://api.ekstep.org/telemetry/ets",type:"number",format:"date-time"},ver:{$id:"http://api.ekstep.org/telemetry/ver",type:"string",enum:["3.0"]},mid:{$id:"http://api.ekstep.org/telemetry/mid",type:"string",minLength:1},actor:{$ref:"http://api.ekstep.org/telemetry/actor"},context:{$ref:"http://api.ekstep.org/telemetry/context"},object:{$ref:"http://api.ekstep.org/telemetry/object"},tags:{type:"array",items:{type:"string"}}}},{$id:"http://api.ekstep.org/telemetry/context",type:"object",properties:{channel:{$id:"http://api.ekstep.org/telemetry/context/channel",type:"string",minLength:1},pdata:{$ref:"http://api.ekstep.org/telemetry/pdata"},env:{$id:"http://api.ekstep.org/telemetry/context/env",type:"string"},sid:{$id:"http://api.ekstep.org/telemetry/context/sid",type:"string"},did:{$id:"http://api.ekstep.org/telemetry/context/did",type:"string"},cdata:{$ref:"http://api.ekstep.org/telemetry/cdata"}},required:["channel","env","pdata"]},{$id:"http://api.ekstep.org/telemetry/dspec",type:"object",properties:{os:{$id:"http://api.ekstep.org/telemetry/dspec/os",type:"string"},make:{$id:"http://api.ekstep.org/telemetry/dspec/make",type:"string"},id:{$id:"http://api.ekstep.org/telemetry/dspec/id",type:"string"},mem:{$id:"http://api.ekstep.org/telemetry/dspec/mem",type:"number",minimum:-1},idisk:{$id:"http://api.ekstep.org/telemetry/dspec/idisk",type:"number",minimum:-1},edisk:{$id:"http://api.ekstep.org/telemetry/dspec/edisk",type:"number",minimum:-1},scrn:{$id:"http://api.ekstep.org/telemetry/dspec/scrn",type:"number",minimum:-1},camera:{$id:"http://api.ekstep.org/telemetry/dspec/camera",type:"string"},cpu:{$id:"http://api.ekstep.org/telemetry/dspec/cpu",type:"string"},sims:{$id:"http://api.ekstep.org/telemetry/dspec/sims",type:"number",minimum:-1},cap:{$id:"http://api.ekstep.org/telemetry/dspec/cap",type:"array",items:{type:"string"}}}},{$id:"http://api.ekstep.org/telemetry/end",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["END"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},mode:{$id:"http://api.ekstep.org/telemetry/edata/mode",type:"string"},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"},summary:{$id:"http://api.ekstep.org/telemetry/edata/summary",type:"array",items:{type:"object"}}}}}}]},{$id:"http://api.ekstep.org/telemetry/error",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["ERROR"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["err","errtype","stacktrace"],properties:{err:{$id:"http://api.ekstep.org/telemetry/edata/err",type:"string"},errtype:{$id:"http://api.ekstep.org/telemetry/edata/errtype",type:"string"},stacktrace:{$id:"http://api.ekstep.org/telemetry/edata/stacktrace",type:"string"},traceid:{$id:"http://api.ekstep.org/telemetry/edata/traceid",type:"string"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"},object:{$ref:"http://api.ekstep.org/telemetry/inlineobject"},plugin:{$ref:"http://api.ekstep.org/telemetry/plugin"}}}}}]},{$id:"http://api.ekstep.org/telemetry/exdata",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["EXDATA"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},data:{$id:"http://api.ekstep.org/telemetry/edata/data",type:"string"}}}}}]},{$id:"http://api.ekstep.org/telemetry/feedback",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["FEEDBACK"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,properties:{rating:{$id:"http://api.ekstep.org/telemetry/edata/rating",type:"number"},commentid:{$id:"http://api.ekstep.org/telemetry/edata/commentid",type:"string"},commenttxt:{$id:"http://api.ekstep.org/telemetry/edata/commenttxt",type:"string"}}}}}]},{$id:"http://api.ekstep.org/telemetry/heartbeat",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["HEARTBEAT"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object"}}}]},{$id:"http://api.ekstep.org/telemetry/impression",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["IMPRESSION"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type","pageid","uri"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},subtype:{$id:"http://api.ekstep.org/telemetry/edata/subtype",type:"string"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"},uri:{$id:"http://api.ekstep.org/telemetry/edata/uri",type:"string"},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"},visits:{$id:"http://api.ekstep.org/telemetry/edata/visits",type:"array",items:{type:"object",properties:{objid:{$id:"http://api.ekstep.org/telemetry/edata/visits/objid",type:"string"},objtype:{$id:"http://api.ekstep.org/telemetry/edata/visits/objtype",type:"string"},objver:{$id:"http://api.ekstep.org/telemetry/edata/visits/objver",type:"string"},section:{$id:"http://api.ekstep.org/telemetry/edata/visits/section",type:"string"},index:{$id:"http://api.ekstep.org/telemetry/edata/visits/index",type:"number"}},additionalProperties:!1,required:["objid","objtype"]}}}}}}]},{$id:"http://api.ekstep.org/telemetry/inlineobject",type:"object",additionalProperties:!1,required:["id","type","ver"],properties:{id:{$id:"http://api.ekstep.org/telemetry/inlineobject/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/inlineobject/type",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/inlineobject/ver",type:"string"},subtype:{$id:"http://api.ekstep.org/telemetry/inlineobject/subtype",type:"string"},name:{$id:"http://api.ekstep.org/telemetry/inlineobject/name",type:"string"},code:{$id:"http://api.ekstep.org/telemetry/inlineobject/code",type:"string"},parent:{$ref:"http://api.ekstep.org/telemetry/parent"}}},{$id:"http://api.ekstep.org/telemetry/interact",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["INTERACT"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type","id"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},subtype:{$id:"http://api.ekstep.org/telemetry/edata/subtype",type:"string"},id:{$id:"http://api.ekstep.org/telemetry/edata/id",type:"string"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"},target:{$ref:"http://api.ekstep.org/telemetry/target"},plugin:{$ref:"http://api.ekstep.org/telemetry/plugin"},extra:{$id:"http://api.ekstep.org/telemetry/edata/extra",type:"object"}}}}}]},{$id:"http://api.ekstep.org/telemetry/interrupt",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["INTERRUPT"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"}}}}}]},{$id:"http://api.ekstep.org/telemetry/items",type:"array",items:{type:"object",additionalProperties:!1,properties:{id:{$id:"http://api.ekstep.org/telemetry/items/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/items/type",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/items/ver",type:"string"},params:{$id:"http://api.ekstep.org/telemetry/items/params",type:"array",items:{type:"object"}},origin:{$id:"http://api.ekstep.org/telemetry/items/origin",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/items/origin/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/items/origin/type",type:"string"}}},to:{$id:"http://api.ekstep.org/telemetry/items/to",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/items/to/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/items/to/type",type:"string"}}}}}},{$id:"http://api.ekstep.org/telemetry/log",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["LOG"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type","level","message"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},level:{$id:"http://api.ekstep.org/telemetry/edata/level",type:"string"},message:{$id:"http://api.ekstep.org/telemetry/edata/message",type:"string"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"},params:{$id:"http://api.ekstep.org/telemetry/edata/params",type:"array",items:{type:"object"}}}}}}]},{$id:"http://api.ekstep.org/telemetry/object",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/object/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/object/type",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/object/ver",type:"string"},rollup:{$ref:"http://api.ekstep.org/telemetry/rollup"}}},{$id:"http://api.ekstep.org/telemetry/parent",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/parent/id",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/parent/type",type:"string"}}},{$id:"http://api.ekstep.org/telemetry/pdata",type:"object",properties:{id:{$id:"http://api.ekstep.org/telemetry/pdata/id",type:"string"},pid:{$id:"http://api.ekstep.org/telemetry/pdata/pid",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/pdata/ver",type:"string"}},required:["id"]},{$id:"http://api.ekstep.org/telemetry/plugin",type:"object",additionalProperties:!1,required:["id","ver"],properties:{id:{$id:"http://api.ekstep.org/telemetry/plugin/id",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/plugin/ver",type:"string"},category:{$id:"http://api.ekstep.org/telemetry/plugin/category",type:"string"}}},{$id:"http://api.ekstep.org/telemetry/question",type:"object",additionalProperties:!1,required:["id"],properties:{id:{$id:"http://api.ekstep.org/telemetry/question/id",type:"string"},maxscore:{$id:"http://api.ekstep.org/telemetry/question/maxscore",type:"number"},exlength:{$id:"http://api.ekstep.org/telemetry/question/exlength",type:"number"},params:{$id:"http://api.ekstep.org/telemetry/question/params",type:"array",items:{type:"object"}},uri:{$id:"http://api.ekstep.org/telemetry/question/uri",type:"string"},desc:{$id:"http://api.ekstep.org/telemetry/question/desc",type:"string"},title:{$id:"http://api.ekstep.org/telemetry/question/title",type:"string"},mmc:{$id:"http://api.ekstep.org/telemetry/question/mmc",type:"array",items:{type:"string"}},mc:{$id:"http://api.ekstep.org/telemetry/question/mc",type:"array",items:{type:"string"}}}},{$id:"http://api.ekstep.org/telemetry/response",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["RESPONSE"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["target","type","values"],properties:{type:{$id:"http://api.ekstep.org/telemetry/type",type:"string"},target:{$ref:"http://api.ekstep.org/telemetry/target"},values:{type:"array",items:{type:"object"}}}}}}]},{$id:"http://api.ekstep.org/telemetry/rollup",type:"object",properties:{l1:{$id:"http://api.ekstep.org/telemetry/context/rollup/l1",type:"string"},l2:{$id:"http://api.ekstep.org/telemetry/context/rollup/l2",type:"string"},l3:{$id:"http://api.ekstep.org/telemetry/context/rollup/l3",type:"string"},l4:{$id:"http://api.ekstep.org/telemetry/context/rollup/l4",type:"string"}}},{$id:"http://api.ekstep.org/telemetry/search",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["SEARCH"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["query","size","topn"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},query:{$id:"http://api.ekstep.org/telemetry/edata/query",type:"string"},filters:{$id:"http://api.ekstep.org/telemetry/edata/filters",type:"object"},sort:{$id:"http://api.ekstep.org/telemetry/edata/sort",type:"object"},correlationid:{$id:"http://api.ekstep.org/telemetry/edata/correlationid",type:"string"},size:{$id:"http://api.ekstep.org/telemetry/edata/size",type:"number"},topn:{$id:"http://api.ekstep.org/telemetry/edata/topn",type:"array",items:{type:"object"}}}}}}]},{$id:"http://api.ekstep.org/telemetry/share",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["SHARE"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["items"],properties:{dir:{$id:"http://api.ekstep.org/telemetry/edata/dir",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},items:{$ref:"http://api.ekstep.org/telemetry/items"}}}}}]},{$id:"http://api.ekstep.org/telemetry/start",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["START"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},dspec:{$ref:"http://api.ekstep.org/telemetry/dspec"},uaspec:{$ref:"http://api.ekstep.org/telemetry/uaspec"},loc:{$id:"http://api.ekstep.org/telemetry/edata/loc",type:"string"},mode:{$id:"http://api.ekstep.org/telemetry/edata/mode",type:"string"},duration:{$id:"http://api.ekstep.org/telemetry/edata/duration",type:"number"},pageid:{$id:"http://api.ekstep.org/telemetry/edata/pageid",type:"string"}}}}}]},{$id:"http://api.ekstep.org/telemetry/summary",type:"object",required:["eid","ets","ver","mid","actor","context","edata"],allOf:[{$ref:"http://api.ekstep.org/telemetry/common"},{properties:{eid:{$id:"http://api.ekstep.org/telemetry/eid",enum:["SUMMARY"]},edata:{$id:"http://api.ekstep.org/telemetry/edata",type:"object",additionalProperties:!1,required:["type","starttime","endtime","timespent","pageviews","interactions"],properties:{type:{$id:"http://api.ekstep.org/telemetry/edata/type",type:"string"},mode:{$id:"http://api.ekstep.org/telemetry/edata/mode",type:"string"},starttime:{$id:"http://api.ekstep.org/telemetry/edata/starttime",type:"number"},endtime:{$id:"http://api.ekstep.org/telemetry/edata/endtime",type:"number"},timespent:{$id:"http://api.ekstep.org/telemetry/edata/timespent",type:"string"},pageviews:{$id:"http://api.ekstep.org/telemetry/edata/pageviews",type:"number"},interactions:{$id:"http://api.ekstep.org/telemetry/edata/interactions",type:"number"},extra:{$id:"http://api.ekstep.org/telemetry/edata/extra",type:"array"}}}}}]},{$id:"http://api.ekstep.org/telemetry/target",type:"object",additionalProperties:!1,required:["id","ver","type"],properties:{id:{$id:"http://api.ekstep.org/telemetry/target/id",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/target/ver",type:"string"},type:{$id:"http://api.ekstep.org/telemetry/target/type",type:"string"},parent:{$ref:"http://api.ekstep.org/telemetry/parent"}}},{$id:"http://api.ekstep.org/telemetry/uaspec",type:"object",properties:{agent:{$id:"http://api.ekstep.org/telemetry/uaspec/agent",type:"string"},ver:{$id:"http://api.ekstep.org/telemetry/uaspec/ver",type:"string"},system:{$id:"http://api.ekstep.org/telemetry/uaspec/system",type:"string"},platform:{$id:"http://api.ekstep.org/telemetry/uaspec/platform",type:"string"},raw:{$id:"http://api.ekstep.org/telemetry/uaspec/raw",type:"string"}}}],detectClient=function(){var n=navigator.userAgent,c=navigator.appName,h=""+parseFloat(navigator.appVersion),u,d,m;return(d=n.indexOf("Opera"))!=-1?(c="opera",h=n.substring(d+6),(d=n.indexOf("Version"))!=-1&&(h=n.substring(d+8))):(d=n.indexOf("MSIE"))!=-1?(c="IE",h=n.substring(d+5)):(d=n.indexOf("Chrome"))!=-1?(c="chrome",h=n.substring(d+7)):(d=n.indexOf("Safari"))!=-1?(c="safari",h=n.substring(d+7),(d=n.indexOf("Version"))!=-1&&(h=n.substring(d+8))):(d=n.indexOf("Firefox"))!=-1&&(c="firefox",h=n.substring(d+8)),(m=h.indexOf(";"))!=-1&&(h=h.substring(0,m)),(m=h.indexOf(" "))!=-1&&(h=h.substring(0,m)),{browser:c,browserver:h,os:navigator.platform}},CryptoJS=CryptoJS||function(n,c){var h={},u=h.lib={},d=function(){},m=u.Base={extend:function(A){d.prototype=this;var G=new d;return A&&G.mixIn(A),G.hasOwnProperty("init")||(G.init=function(){G.$super.init.apply(this,arguments)}),G.init.prototype=G,G.$super=this,G},create:function(){var A=this.extend();return A.init.apply(A,arguments),A},init:function(){},mixIn:function(A){for(var G in A)A.hasOwnProperty(G)&&(this[G]=A[G]);A.hasOwnProperty("toString")&&(this.toString=A.toString)},clone:function(){return this.init.prototype.extend(this)}},g=u.WordArray=m.extend({init:function(A,G){A=this.words=A||[],this.sigBytes=G!=c?G:4*A.length},toString:function(A){return(A||E).stringify(this)},concat:function(A){var G=this.words,B=A.words,O=this.sigBytes;if(A=A.sigBytes,this.clamp(),O%4)for(var K=0;K<A;K++)G[O+K>>>2]|=(B[K>>>2]>>>24-8*(K%4)&255)<<24-8*((O+K)%4);else if(65535<B.length)for(K=0;K<A;K+=4)G[O+K>>>2]=B[K>>>2];else G.push.apply(G,B);return this.sigBytes+=A,this},clamp:function(){var A=this.words,G=this.sigBytes;A[G>>>2]&=4294967295<<32-8*(G%4),A.length=n.ceil(G/4)},clone:function(){var A=m.clone.call(this);return A.words=this.words.slice(0),A},random:function(A){for(var G=[],B=0;B<A;B+=4)G.push(4294967296*n.random()|0);return new g.init(G,A)}}),x=h.enc={},E=x.Hex={stringify:function(A){var G=A.words;A=A.sigBytes;for(var B=[],O=0;O<A;O++){var K=G[O>>>2]>>>24-8*(O%4)&255;B.push((K>>>4).toString(16)),B.push((K&15).toString(16))}return B.join("")},parse:function(A){for(var G=A.length,B=[],O=0;O<G;O+=2)B[O>>>3]|=parseInt(A.substr(O,2),16)<<24-4*(O%8);return new g.init(B,G/2)}},P=x.Latin1={stringify:function(A){var G=A.words;A=A.sigBytes;for(var B=[],O=0;O<A;O++)B.push(String.fromCharCode(G[O>>>2]>>>24-8*(O%4)&255));return B.join("")},parse:function(A){for(var G=A.length,B=[],O=0;O<G;O++)B[O>>>2]|=(A.charCodeAt(O)&255)<<24-8*(O%4);return new g.init(B,G)}},L=x.Utf8={stringify:function(A){try{return decodeURIComponent(escape(P.stringify(A)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(A){return P.parse(unescape(encodeURIComponent(A)))}},F=u.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(A){typeof A=="string"&&(A=L.parse(A)),this._data.concat(A),this._nDataBytes+=A.sigBytes},_process:function(A){var G=this._data,B=G.words,O=G.sigBytes,K=this.blockSize,Q=O/(4*K),Q=A?n.ceil(Q):n.max((Q|0)-this._minBufferSize,0);if(A=Q*K,O=n.min(4*A,O),A){for(var et=0;et<A;et+=K)this._doProcessBlock(B,et);et=B.splice(0,A),G.sigBytes-=O}return new g.init(et,O)},clone:function(){var A=m.clone.call(this);return A._data=this._data.clone(),A},_minBufferSize:0});u.Hasher=F.extend({cfg:m.extend(),init:function(A){this.cfg=this.cfg.extend(A),this.reset()},reset:function(){F.reset.call(this),this._doReset()},update:function(A){return this._append(A),this._process(),this},finalize:function(A){return A&&this._append(A),this._doFinalize()},blockSize:16,_createHelper:function(A){return function(G,B){return new A.init(B).finalize(G)}},_createHmacHelper:function(A){return function(G,B){return new U.HMAC.init(A,B).finalize(G)}}});var U=h.algo={};return h}(Math);if(function(n){function c(F,U,A,G,B,O,K){return F=F+(U&A|~U&G)+B+K,(F<<O|F>>>32-O)+U}function h(F,U,A,G,B,O,K){return F=F+(U&G|A&~G)+B+K,(F<<O|F>>>32-O)+U}function u(F,U,A,G,B,O,K){return F=F+(U^A^G)+B+K,(F<<O|F>>>32-O)+U}function d(F,U,A,G,B,O,K){return F=F+(A^(U|~G))+B+K,(F<<O|F>>>32-O)+U}for(var m=CryptoJS,E=m.lib,g=E.WordArray,x=E.Hasher,E=m.algo,P=[],L=0;64>L;L++)P[L]=4294967296*n.abs(n.sin(L+1))|0;E=E.MD5=x.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(F,U){for(var A=0;16>A;A++){var G=U+A,B=F[G];F[G]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}var A=this._hash.words,G=F[U+0],B=F[U+1],O=F[U+2],K=F[U+3],Q=F[U+4],et=F[U+5],lt=F[U+6],pt=F[U+7],T=F[U+8],ct=F[U+9],ut=F[U+10],ft=F[U+11],$=F[U+12],_t=F[U+13],W=F[U+14],rt=F[U+15],nt=A[0],Bt=A[1],Mt=A[2],vt=A[3],nt=c(nt,Bt,Mt,vt,G,7,P[0]),vt=c(vt,nt,Bt,Mt,B,12,P[1]),Mt=c(Mt,vt,nt,Bt,O,17,P[2]),Bt=c(Bt,Mt,vt,nt,K,22,P[3]),nt=c(nt,Bt,Mt,vt,Q,7,P[4]),vt=c(vt,nt,Bt,Mt,et,12,P[5]),Mt=c(Mt,vt,nt,Bt,lt,17,P[6]),Bt=c(Bt,Mt,vt,nt,pt,22,P[7]),nt=c(nt,Bt,Mt,vt,T,7,P[8]),vt=c(vt,nt,Bt,Mt,ct,12,P[9]),Mt=c(Mt,vt,nt,Bt,ut,17,P[10]),Bt=c(Bt,Mt,vt,nt,ft,22,P[11]),nt=c(nt,Bt,Mt,vt,$,7,P[12]),vt=c(vt,nt,Bt,Mt,_t,12,P[13]),Mt=c(Mt,vt,nt,Bt,W,17,P[14]),Bt=c(Bt,Mt,vt,nt,rt,22,P[15]),nt=h(nt,Bt,Mt,vt,B,5,P[16]),vt=h(vt,nt,Bt,Mt,lt,9,P[17]),Mt=h(Mt,vt,nt,Bt,ft,14,P[18]),Bt=h(Bt,Mt,vt,nt,G,20,P[19]),nt=h(nt,Bt,Mt,vt,et,5,P[20]),vt=h(vt,nt,Bt,Mt,ut,9,P[21]),Mt=h(Mt,vt,nt,Bt,rt,14,P[22]),Bt=h(Bt,Mt,vt,nt,Q,20,P[23]),nt=h(nt,Bt,Mt,vt,ct,5,P[24]),vt=h(vt,nt,Bt,Mt,W,9,P[25]),Mt=h(Mt,vt,nt,Bt,K,14,P[26]),Bt=h(Bt,Mt,vt,nt,T,20,P[27]),nt=h(nt,Bt,Mt,vt,_t,5,P[28]),vt=h(vt,nt,Bt,Mt,O,9,P[29]),Mt=h(Mt,vt,nt,Bt,pt,14,P[30]),Bt=h(Bt,Mt,vt,nt,$,20,P[31]),nt=u(nt,Bt,Mt,vt,et,4,P[32]),vt=u(vt,nt,Bt,Mt,T,11,P[33]),Mt=u(Mt,vt,nt,Bt,ft,16,P[34]),Bt=u(Bt,Mt,vt,nt,W,23,P[35]),nt=u(nt,Bt,Mt,vt,B,4,P[36]),vt=u(vt,nt,Bt,Mt,Q,11,P[37]),Mt=u(Mt,vt,nt,Bt,pt,16,P[38]),Bt=u(Bt,Mt,vt,nt,ut,23,P[39]),nt=u(nt,Bt,Mt,vt,_t,4,P[40]),vt=u(vt,nt,Bt,Mt,G,11,P[41]),Mt=u(Mt,vt,nt,Bt,K,16,P[42]),Bt=u(Bt,Mt,vt,nt,lt,23,P[43]),nt=u(nt,Bt,Mt,vt,ct,4,P[44]),vt=u(vt,nt,Bt,Mt,$,11,P[45]),Mt=u(Mt,vt,nt,Bt,rt,16,P[46]),Bt=u(Bt,Mt,vt,nt,O,23,P[47]),nt=d(nt,Bt,Mt,vt,G,6,P[48]),vt=d(vt,nt,Bt,Mt,pt,10,P[49]),Mt=d(Mt,vt,nt,Bt,W,15,P[50]),Bt=d(Bt,Mt,vt,nt,et,21,P[51]),nt=d(nt,Bt,Mt,vt,$,6,P[52]),vt=d(vt,nt,Bt,Mt,K,10,P[53]),Mt=d(Mt,vt,nt,Bt,ut,15,P[54]),Bt=d(Bt,Mt,vt,nt,B,21,P[55]),nt=d(nt,Bt,Mt,vt,T,6,P[56]),vt=d(vt,nt,Bt,Mt,rt,10,P[57]),Mt=d(Mt,vt,nt,Bt,lt,15,P[58]),Bt=d(Bt,Mt,vt,nt,_t,21,P[59]),nt=d(nt,Bt,Mt,vt,Q,6,P[60]),vt=d(vt,nt,Bt,Mt,ft,10,P[61]),Mt=d(Mt,vt,nt,Bt,O,15,P[62]),Bt=d(Bt,Mt,vt,nt,ct,21,P[63]);A[0]=A[0]+nt|0,A[1]=A[1]+Bt|0,A[2]=A[2]+Mt|0,A[3]=A[3]+vt|0},_doFinalize:function(){var F=this._data,U=F.words,A=8*this._nDataBytes,G=8*F.sigBytes;U[G>>>5]|=128<<24-G%32;var B=n.floor(A/4294967296);for(U[(G+64>>>9<<4)+15]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,U[(G+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,F.sigBytes=4*(U.length+1),this._process(),F=this._hash,U=F.words,A=0;4>A;A++)G=U[A],U[A]=(G<<8|G>>>24)&16711935|(G<<24|G>>>8)&4278255360;return F},clone:function(){var F=x.clone.call(this);return F._hash=this._hash.clone(),F}}),m.MD5=x._createHelper(E),m.HmacMD5=x._createHmacHelper(E)}(Math),function(n,c){"use strict";var h="function",u="undefined",d="object",m="model",g="name",x="type",E="vendor",P="version",L="architecture",F="console",U="mobile",A="tablet",G="smarttv",B="wearable",O={extend:function(ct,ut){var ft={};for(var $ in ct)ut[$]&&ut[$].length%2==0?ft[$]=ut[$].concat(ct[$]):ft[$]=ct[$];return ft},has:function(ct,ut){return typeof ct=="string"&&ut.toLowerCase().indexOf(ct.toLowerCase())!==-1},lowerize:function(ct){return ct.toLowerCase()},major:function(ct){return typeof ct=="string"?ct.replace(/[^\d\.]/g,"").split(".")[0]:c},trim:function(ct){return ct.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},K={rgx:function(ct,ut){for(var ft,$,_t,W,rt,nt,vt=0;vt<ut.length&&!rt;){var Mt=ut[vt],Bt=ut[vt+1];for(ft=$=0;ft<Mt.length&&!rt;)if(rt=Mt[ft++].exec(ct))for(_t=0;_t<Bt.length;_t++)nt=rt[++$],typeof(W=Bt[_t])===d&&0<W.length?W.length==2?typeof W[1]==h?this[W[0]]=W[1].call(this,nt):this[W[0]]=W[1]:W.length==3?typeof W[1]!==h||W[1].exec&&W[1].test?this[W[0]]=nt?nt.replace(W[1],W[2]):c:this[W[0]]=nt?W[1].call(this,nt,W[2]):c:W.length==4&&(this[W[0]]=nt?W[3].call(this,nt.replace(W[1],W[2])):c):this[W]=nt||c;vt+=2}},str:function(ct,ut){for(var ft in ut)if(typeof ut[ft]===d&&0<ut[ft].length){for(var $=0;$<ut[ft].length;$++)if(O.has(ut[ft][$],ct))return ft==="?"?c:ft}else if(O.has(ut[ft],ct))return ft==="?"?c:ft;return ct}},Q={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},et={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[g,P],[/(opios)[\/\s]+([\w\.]+)/i],[[g,"Opera Mini"],P],[/\s(opr)\/([\w\.]+)/i],[[g,"Opera"],P],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[g,P],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[g,"IE"],P],[/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i],[[g,"Edge"],P],[/(yabrowser)\/([\w\.]+)/i],[[g,"Yandex"],P],[/(puffin)\/([\w\.]+)/i],[[g,"Puffin"],P],[/(focus)\/([\w\.]+)/i],[[g,"Firefox Focus"],P],[/(opt)\/([\w\.]+)/i],[[g,"Opera Touch"],P],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[g,"UCBrowser"],P],[/(comodo_dragon)\/([\w\.]+)/i],[[g,/_/g," "],P],[/(micromessenger)\/([\w\.]+)/i],[[g,"WeChat"],P],[/(brave)\/([\w\.]+)/i],[[g,"Brave"],P],[/(qqbrowserlite)\/([\w\.]+)/i],[g,P],[/(QQ)\/([\d\.]+)/i],[g,P],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[g,P],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[g,P],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[g,P],[/(MetaSr)[\/\s]?([\w\.]+)/i],[g],[/(LBBROWSER)/i],[g],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[P,[g,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[P,[g,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[g,P],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[P,[g,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[g,/(.+)/,"$1 WebView"],P],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[g,/(.+(?:g|us))(.+)/,"$1 $2"],P],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[P,[g,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[g,P],[/(dolfin)\/([\w\.]+)/i],[[g,"Dolphin"],P],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[g,"Chrome"],P],[/(coast)\/([\w\.]+)/i],[[g,"Opera Coast"],P],[/fxios\/([\w\.-]+)/i],[P,[g,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[P,[g,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[P,g],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[g,"GSA"],P],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[g,[P,K.str,Q.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[g,P],[/(navigator|netscape)\/([\w\.-]+)/i],[[g,"Netscape"],P],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[g,P]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[L,"amd64"]],[/(ia32(?=;))/i],[[L,O.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[L,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[L,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[L,/ower/,"",O.lowerize]],[/(sun4\w)[;\)]/i],[[L,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[L,O.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[m,E,[x,A]],[/applecoremedia\/[\w\.]+ \((ipad)/],[m,[E,"Apple"],[x,A]],[/(apple\s{0,1}tv)/i],[[m,"Apple TV"],[E,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[E,m,[x,A]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[m,[E,"Amazon"],[x,A]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[m,K.str,Q.device.amazon.model],[E,"Amazon"],[x,U]],[/android.+aft([bms])\sbuild/i],[m,[E,"Amazon"],[x,G]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[m,E,[x,U]],[/\((ip[honed|\s\w*]+);/i],[m,[E,"Apple"],[x,U]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[E,m,[x,U]],[/\(bb10;\s(\w+)/i],[m,[E,"BlackBerry"],[x,U]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[m,[E,"Asus"],[x,A]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[E,"Sony"],[m,"Xperia Tablet"],[x,A]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[m,[E,"Sony"],[x,U]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[E,m,[x,F]],[/android.+;\s(shield)\sbuild/i],[m,[E,"Nvidia"],[x,F]],[/(playstation\s[34portablevi]+)/i],[m,[E,"Sony"],[x,F]],[/(sprint\s(\w+))/i],[[E,K.str,Q.device.sprint.vendor],[m,K.str,Q.device.sprint.model],[x,U]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[E,m,[x,A]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[E,[m,/_/g," "],[x,U]],[/(nexus\s9)/i],[m,[E,"HTC"],[x,A]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[m,[E,"Huawei"],[x,U]],[/(microsoft);\s(lumia[\s\w]+)/i],[E,m,[x,U]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[m,[E,"Microsoft"],[x,F]],[/(kin\.[onetw]{3})/i],[[m,/\./g," "],[E,"Microsoft"],[x,U]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[m,[E,"Motorola"],[x,U]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[m,[E,"Motorola"],[x,A]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[E,O.trim],[m,O.trim],[x,G]],[/hbbtv.+maple;(\d+)/i],[[m,/^/,"SmartTV"],[E,"Samsung"],[x,G]],[/\(dtv[\);].+(aquos)/i],[m,[E,"Sharp"],[x,G]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[E,"Samsung"],m,[x,A]],[/smart-tv.+(samsung)/i],[E,[x,G],m],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[E,"Samsung"],m,[x,U]],[/sie-(\w*)/i],[m,[E,"Siemens"],[x,U]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[E,"Nokia"],m,[x,U]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[m,[E,"Acer"],[x,A]],[/android.+([vl]k\-?\d{3})\s+build/i],[m,[E,"LG"],[x,A]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[E,"LG"],m,[x,A]],[/(lg) netcast\.tv/i],[E,m,[x,G]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[m,[E,"LG"],[x,U]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[m,[E,"Lenovo"],[x,A]],[/linux;.+((jolla));/i],[E,m,[x,U]],[/((pebble))app\/[\d\.]+\s/i],[E,m,[x,B]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[E,m,[x,U]],[/crkey/i],[[m,"Chromecast"],[E,"Google"]],[/android.+;\s(glass)\s\d/i],[m,[E,"Google"],[x,B]],[/android.+;\s(pixel c)[\s)]/i],[m,[E,"Google"],[x,A]],[/android.+;\s(pixel( [23])?( xl)?)\s/i],[m,[E,"Google"],[x,U]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[m,/_/g," "],[E,"Xiaomi"],[x,U]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[m,/_/g," "],[E,"Xiaomi"],[x,A]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[m,[E,"Meizu"],[x,A]],[/(mz)-([\w-]{2,})/i],[[E,"Meizu"],m,[x,U]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[m,[E,"OnePlus"],[x,U]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[m,[E,"RCA"],[x,A]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[m,[E,"Dell"],[x,A]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[m,[E,"Verizon"],[x,A]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[E,"Barnes & Noble"],m,[x,A]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[m,[E,"NuVision"],[x,A]],[/android.+;\s(k88)\sbuild/i],[m,[E,"ZTE"],[x,A]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[m,[E,"Swiss"],[x,U]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[m,[E,"Swiss"],[x,A]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[m,[E,"Zeki"],[x,A]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[E,"Dragon Touch"],m,[x,A]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[m,[E,"Insignia"],[x,A]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[m,[E,"NextBook"],[x,A]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[E,"Voice"],m,[x,U]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[E,"LvTel"],m,[x,U]],[/android.+;\s(PH-1)\s/i],[m,[E,"Essential"],[x,U]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[m,[E,"Envizen"],[x,A]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[E,m,[x,A]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[m,[E,"MachSpeed"],[x,A]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[E,m,[x,A]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[m,[E,"Rotor"],[x,A]],[/android.+(KS(.+))\s+build/i],[m,[E,"Amazon"],[x,A]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[E,m,[x,A]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[x,O.lowerize],E,m],[/(android[\w\.\s\-]{0,9});.+build/i],[m,[E,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[P,[g,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[g,P],[/rv\:([\w\.]{1,9}).+(gecko)/i],[P,g]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[g,P],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[g,[P,K.str,Q.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[g,"Windows"],[P,K.str,Q.os.windows.version]],[/\((bb)(10);/i],[[g,"BlackBerry"],P],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[g,P],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[g,"Symbian"],P],[/\((series40);/i],[g],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[g,"Firefox OS"],P],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[g,P],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[g,"Chromium OS"],P],[/(sunos)\s?([\w\.\d]*)/i],[[g,"Solaris"],P],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[g,P],[/(haiku)\s(\w+)/i],[g,P],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[P,/_/g,"."],[g,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[g,"Mac OS"],[P,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[g,P]]},lt=function(ct,ut){if(typeof ct=="object"&&(ut=ct,ct=c),!(this instanceof lt))return new lt(ct,ut).getResult();var ft=ct||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),$=ut?O.extend(et,ut):et;return this.getBrowser=function(){var _t={name:c,version:c};return K.rgx.call(_t,ft,$.browser),_t.major=O.major(_t.version),_t},this.getCPU=function(){var _t={architecture:c};return K.rgx.call(_t,ft,$.cpu),_t},this.getDevice=function(){var _t={vendor:c,model:c,type:c};return K.rgx.call(_t,ft,$.device),_t},this.getEngine=function(){var _t={name:c,version:c};return K.rgx.call(_t,ft,$.engine),_t},this.getOS=function(){var _t={name:c,version:c};return K.rgx.call(_t,ft,$.os),_t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ft},this.setUA=function(_t){return ft=_t,this},this};lt.VERSION="0.7.19",lt.BROWSER={NAME:g,MAJOR:"major",VERSION:P},lt.CPU={ARCHITECTURE:L},lt.DEVICE={MODEL:m,VENDOR:E,TYPE:x,CONSOLE:F,MOBILE:U,SMARTTV:G,TABLET:A,WEARABLE:B,EMBEDDED:"embedded"},lt.ENGINE={NAME:g,VERSION:P},lt.OS={NAME:g,VERSION:P},typeof exports!==u?(typeof module!==u&&module.exports&&(exports=module.exports=lt),exports.UAParser=lt):typeof define===h&&define.amd?define(function(){return lt}):n&&(n.UAParser=lt);var pt=n&&(n.jQuery||n.Zepto);if(typeof pt!==u&&!pt.ua){var T=new lt;pt.ua=T.getResult(),pt.ua.get=function(){return T.getUA()},pt.ua.set=function(ct){T.setUA(ct);var ut=T.getResult();for(var ft in ut)pt.ua[ft]=ut[ft]}}}(typeof window=="object"?window:this),function(n,c,h){"use strict";typeof window<"u"&&typeof define=="function"&&define.amd?define(h):typeof module<"u"&&module.exports?module.exports=h():c.exports?c.exports=h():c[n]=h()}("Fingerprint2",this,function(){"use strict";var n=function(ot,zt){ot=[ot[0]>>>16,ot[0]&65535,ot[1]>>>16,ot[1]&65535],zt=[zt[0]>>>16,zt[0]&65535,zt[1]>>>16,zt[1]&65535];var Wt=[0,0,0,0];return Wt[3]+=ot[3]+zt[3],Wt[2]+=Wt[3]>>>16,Wt[3]&=65535,Wt[2]+=ot[2]+zt[2],Wt[1]+=Wt[2]>>>16,Wt[2]&=65535,Wt[1]+=ot[1]+zt[1],Wt[0]+=Wt[1]>>>16,Wt[1]&=65535,Wt[0]+=ot[0]+zt[0],Wt[0]&=65535,[Wt[0]<<16|Wt[1],Wt[2]<<16|Wt[3]]},c=function(ot,zt){ot=[ot[0]>>>16,ot[0]&65535,ot[1]>>>16,ot[1]&65535],zt=[zt[0]>>>16,zt[0]&65535,zt[1]>>>16,zt[1]&65535];var Wt=[0,0,0,0];return Wt[3]+=ot[3]*zt[3],Wt[2]+=Wt[3]>>>16,Wt[3]&=65535,Wt[2]+=ot[2]*zt[3],Wt[1]+=Wt[2]>>>16,Wt[2]&=65535,Wt[2]+=ot[3]*zt[2],Wt[1]+=Wt[2]>>>16,Wt[2]&=65535,Wt[1]+=ot[1]*zt[3],Wt[0]+=Wt[1]>>>16,Wt[1]&=65535,Wt[1]+=ot[2]*zt[2],Wt[0]+=Wt[1]>>>16,Wt[1]&=65535,Wt[1]+=ot[3]*zt[1],Wt[0]+=Wt[1]>>>16,Wt[1]&=65535,Wt[0]+=ot[0]*zt[3]+ot[1]*zt[2]+ot[2]*zt[1]+ot[3]*zt[0],Wt[0]&=65535,[Wt[0]<<16|Wt[1],Wt[2]<<16|Wt[3]]},h=function(ot,zt){return zt%=64,zt===32?[ot[1],ot[0]]:zt<32?[ot[0]<<zt|ot[1]>>>32-zt,ot[1]<<zt|ot[0]>>>32-zt]:(zt-=32,[ot[1]<<zt|ot[0]>>>32-zt,ot[0]<<zt|ot[1]>>>32-zt])},u=function(ot,zt){return zt%=64,zt===0?ot:zt<32?[ot[0]<<zt|ot[1]>>>32-zt,ot[1]<<zt]:[ot[1]<<zt-32,0]},d=function(ot,zt){return[ot[0]^zt[0],ot[1]^zt[1]]},m=function(ot){return ot=d(ot,[0,ot[0]>>>1]),ot=c(ot,[4283543511,3981806797]),ot=d(ot,[0,ot[0]>>>1]),ot=c(ot,[3301882366,444984403]),ot=d(ot,[0,ot[0]>>>1]),ot},g=function(ot,zt){ot=ot||"",zt=zt||0;for(var Wt=ot.length%16,Ut=ot.length-Wt,ve=[0,zt],Se=[0,zt],nr=[0,0],xr=[0,0],Me=[2277735313,289559509],ei=[1291169091,658871167],fr=0;fr<Ut;fr=fr+16)nr=[ot.charCodeAt(fr+4)&255|(ot.charCodeAt(fr+5)&255)<<8|(ot.charCodeAt(fr+6)&255)<<16|(ot.charCodeAt(fr+7)&255)<<24,ot.charCodeAt(fr)&255|(ot.charCodeAt(fr+1)&255)<<8|(ot.charCodeAt(fr+2)&255)<<16|(ot.charCodeAt(fr+3)&255)<<24],xr=[ot.charCodeAt(fr+12)&255|(ot.charCodeAt(fr+13)&255)<<8|(ot.charCodeAt(fr+14)&255)<<16|(ot.charCodeAt(fr+15)&255)<<24,ot.charCodeAt(fr+8)&255|(ot.charCodeAt(fr+9)&255)<<8|(ot.charCodeAt(fr+10)&255)<<16|(ot.charCodeAt(fr+11)&255)<<24],nr=c(nr,Me),nr=h(nr,31),nr=c(nr,ei),ve=d(ve,nr),ve=h(ve,27),ve=n(ve,Se),ve=n(c(ve,[0,5]),[0,1390208809]),xr=c(xr,ei),xr=h(xr,33),xr=c(xr,Me),Se=d(Se,xr),Se=h(Se,31),Se=n(Se,ve),Se=n(c(Se,[0,5]),[0,944331445]);switch(nr=[0,0],xr=[0,0],Wt){case 15:xr=d(xr,u([0,ot.charCodeAt(fr+14)],48));case 14:xr=d(xr,u([0,ot.charCodeAt(fr+13)],40));case 13:xr=d(xr,u([0,ot.charCodeAt(fr+12)],32));case 12:xr=d(xr,u([0,ot.charCodeAt(fr+11)],24));case 11:xr=d(xr,u([0,ot.charCodeAt(fr+10)],16));case 10:xr=d(xr,u([0,ot.charCodeAt(fr+9)],8));case 9:xr=d(xr,[0,ot.charCodeAt(fr+8)]),xr=c(xr,ei),xr=h(xr,33),xr=c(xr,Me),Se=d(Se,xr);case 8:nr=d(nr,u([0,ot.charCodeAt(fr+7)],56));case 7:nr=d(nr,u([0,ot.charCodeAt(fr+6)],48));case 6:nr=d(nr,u([0,ot.charCodeAt(fr+5)],40));case 5:nr=d(nr,u([0,ot.charCodeAt(fr+4)],32));case 4:nr=d(nr,u([0,ot.charCodeAt(fr+3)],24));case 3:nr=d(nr,u([0,ot.charCodeAt(fr+2)],16));case 2:nr=d(nr,u([0,ot.charCodeAt(fr+1)],8));case 1:nr=d(nr,[0,ot.charCodeAt(fr)]),nr=c(nr,Me),nr=h(nr,31),nr=c(nr,ei),ve=d(ve,nr)}return ve=d(ve,[0,ot.length]),Se=d(Se,[0,ot.length]),ve=n(ve,Se),Se=n(Se,ve),ve=m(ve),Se=m(Se),ve=n(ve,Se),Se=n(Se,ve),("00000000"+(ve[0]>>>0).toString(16)).slice(-8)+("00000000"+(ve[1]>>>0).toString(16)).slice(-8)+("00000000"+(Se[0]>>>0).toString(16)).slice(-8)+("00000000"+(Se[1]>>>0).toString(16)).slice(-8)},x={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},E=function(ot,zt){if(Array.prototype.forEach&&ot.forEach===Array.prototype.forEach)ot.forEach(zt);else if(ot.length===+ot.length)for(var Wt=0,Ut=ot.length;Wt<Ut;Wt++)zt(ot[Wt],Wt,ot);else for(var ve in ot)ot.hasOwnProperty(ve)&&zt(ot[ve],ve,ot)},P=function(ot,zt){var Wt=[];return ot==null?Wt:Array.prototype.map&&ot.map===Array.prototype.map?ot.map(zt):(E(ot,function(Ut,ve,Se){Wt.push(zt(Ut,ve,Se))}),Wt)},L=function(ot,zt){if(zt==null)return ot;var Wt,Ut;for(Ut in zt)Wt=zt[Ut],Wt!=null&&!Object.prototype.hasOwnProperty.call(ot,Ut)&&(ot[Ut]=Wt);return ot},F=function(ot,zt){if(!U())return ot(zt.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then(function(Wt){ot(Wt.map(function(Ut){return"id="+Ut.deviceId+";gid="+Ut.groupId+";"+Ut.kind+";"+Ut.label}))}).catch(function(Wt){ot(Wt)})},U=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices},A=function(ot,zt){var Wt=zt.audio;if(Wt.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return ot(zt.EXCLUDED);var Ut=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(Ut==null)return ot(zt.NOT_AVAILABLE);var ve=new Ut(1,44100,44100),Se=ve.createOscillator();Se.type="triangle",Se.frequency.setValueAtTime(1e4,ve.currentTime);var nr=ve.createDynamicsCompressor();E([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],function(Me){nr[Me[0]]!==void 0&&typeof nr[Me[0]].setValueAtTime=="function"&&nr[Me[0]].setValueAtTime(Me[1],ve.currentTime)}),Se.connect(nr),nr.connect(ve.destination),Se.start(0),ve.startRendering();var xr=setTimeout(function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/Valve/fingerprintjs2 with your user agent: "'+navigator.userAgent+'".'),ve.oncomplete=function(){},ve=null,ot("audioTimeout")},Wt.timeout);ve.oncomplete=function(Me){var ei;try{clearTimeout(xr),ei=Me.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce(function(fr,Mr){return fr+Math.abs(Mr)},0).toString(),Se.disconnect(),nr.disconnect()}catch(fr){ot(fr);return}ot(ei)}},G=function(ot){ot(navigator.userAgent)},B=function(ot,zt){ot(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||zt.NOT_AVAILABLE)},O=function(ot,zt){ot(window.screen.colorDepth||zt.NOT_AVAILABLE)},K=function(ot,zt){ot(navigator.deviceMemory||zt.NOT_AVAILABLE)},Q=function(ot,zt){ot(window.devicePixelRatio||zt.NOT_AVAILABLE)},et=function(ot,zt){ot(lt(zt))},lt=function(ot){var zt=[window.screen.width,window.screen.height];return ot.screen.detectScreenOrientation&&zt.sort().reverse(),zt},pt=function(ot,zt){ot(T(zt))},T=function(ot){if(window.screen.availWidth&&window.screen.availHeight){var zt=[window.screen.availHeight,window.screen.availWidth];return ot.screen.detectScreenOrientation&&zt.sort().reverse(),zt}return ot.NOT_AVAILABLE},ct=function(ot){ot(new Date().getTimezoneOffset())},ut=function(ot,zt){if(window.Intl&&window.Intl.DateTimeFormat){ot(new window.Intl.DateTimeFormat().resolvedOptions().timeZone);return}ot(zt.NOT_AVAILABLE)},ft=function(ot,zt){ot(oe(zt))},$=function(ot,zt){ot(Ar(zt))},_t=function(ot,zt){ot(vr(zt))},W=function(ot){ot(!!(document.body&&document.body.addBehavior))},rt=function(ot){ot(!!window.openDatabase)},nt=function(ot,zt){ot(wi(zt))},vt=function(ot,zt){ot(Ee(zt))},Mt=function(ot,zt){ot(Sr(zt))},Bt=function(ot,zt){if(Ot()){ot(xn(zt));return}ot(zt.NOT_AVAILABLE)},Vt=function(ot,zt){if(Kt()){ot(ye());return}ot(zt.NOT_AVAILABLE)},Lt=function(ot){if(Kt()){ot(oi());return}ot()},Ne=function(ot){ot(eo())},ge=function(ot){ot(Xo())},Yt=function(ot){ot(Xn())},ue=function(ot){ot(cn())},ne=function(ot){ot(Ft())},dr=function(ot,zt){if(!Ve())return ot("swf object not loaded");if(!Be())return ot("flash not installed");if(!zt.fonts.swfPath)return ot("missing options.fonts.swfPath");br(function(Wt){ot(Wt)},zt)},je=function(ot,zt){var Wt=["monospace","sans-serif","serif"],Ut=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"];if(zt.fonts.extendedJsFonts){var ve=["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"];Ut=Ut.concat(ve)}Ut=Ut.concat(zt.fonts.userDefinedFonts),Ut=Ut.filter(function(ci,wn){return Ut.indexOf(ci)===wn});var Se="mmmmmmmmmmlli",nr="72px",xr=document.getElementsByTagName("body")[0],Me=document.createElement("div"),ei=document.createElement("div"),fr={},Mr={},hr=function(){var ci=document.createElement("span");return ci.style.position="absolute",ci.style.left="-9999px",ci.style.fontSize=nr,ci.style.fontStyle="normal",ci.style.fontWeight="normal",ci.style.letterSpacing="normal",ci.style.lineBreak="auto",ci.style.lineHeight="normal",ci.style.textTransform="none",ci.style.textAlign="left",ci.style.textDecoration="none",ci.style.textShadow="none",ci.style.whiteSpace="normal",ci.style.wordBreak="normal",ci.style.wordSpacing="normal",ci.innerHTML=Se,ci},Vr=function(ci,wn){var vi=hr();return vi.style.fontFamily="'"+ci+"',"+wn,vi},yi=function(){for(var ci=[],wn=0,vi=Wt.length;wn<vi;wn++){var Jr=hr();Jr.style.fontFamily=Wt[wn],Me.appendChild(Jr),ci.push(Jr)}return ci},Qr=function(){for(var ci={},wn=0,vi=Ut.length;wn<vi;wn++){for(var Jr=[],tn=0,gr=Wt.length;tn<gr;tn++){var St=Vr(Ut[wn],Wt[tn]);ei.appendChild(St),Jr.push(St)}ci[Ut[wn]]=Jr}return ci},Fi=function(ci){for(var wn=!1,vi=0;vi<Wt.length;vi++)if(wn=ci[vi].offsetWidth!==fr[Wt[vi]]||ci[vi].offsetHeight!==Mr[Wt[vi]],wn)return wn;return wn},ro=yi();xr.appendChild(Me);for(var Ln=0,Di=Wt.length;Ln<Di;Ln++)fr[Wt[Ln]]=ro[Ln].offsetWidth,Mr[Wt[Ln]]=ro[Ln].offsetHeight;var un=Qr();xr.appendChild(ei);for(var Mi=[],Qi=0,Qo=Ut.length;Qi<Qo;Qi++)Fi(un[Ut[Qi]])&&Mi.push(Ut[Qi]);xr.removeChild(ei),xr.removeChild(Me),ot(Mi)},Br=function(ot,zt){ae()?zt.plugins.excludeIE?ot(zt.EXCLUDED):ot(Fe(zt)):ot(Ue(zt))},Ue=function(ot){if(navigator.plugins==null)return ot.NOT_AVAILABLE;for(var zt=[],Wt=0,Ut=navigator.plugins.length;Wt<Ut;Wt++)navigator.plugins[Wt]&&zt.push(navigator.plugins[Wt]);return Lr(ot)&&(zt=zt.sort(function(ve,Se){return ve.name>Se.name?1:ve.name<Se.name?-1:0})),P(zt,function(ve){var Se=P(ve,function(nr){return[nr.type,nr.suffixes]});return[ve.name,ve.description,Se]})},Fe=function(ot){var zt=[];if(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window){var Wt=["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"];zt=P(Wt,function(Ut){try{return new window.ActiveXObject(Ut),Ut}catch{return ot.ERROR}})}else zt.push(ot.NOT_AVAILABLE);return navigator.plugins&&(zt=zt.concat(Ue(ot))),zt},Lr=function(ot){for(var zt=!1,Wt=0,Ut=ot.plugins.sortPluginsFor.length;Wt<Ut;Wt++){var ve=ot.plugins.sortPluginsFor[Wt];if(navigator.userAgent.match(ve)){zt=!0;break}}return zt},De=function(ot){ot(Or())},se=function(ot,zt){ot(Kr(zt))},oe=function(ot){try{return!!window.sessionStorage}catch{return ot.ERROR}},Ar=function(ot){try{return!!window.localStorage}catch{return ot.ERROR}},vr=function(ot){try{return!!window.indexedDB}catch{return ot.ERROR}},Kr=function(ot){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:ot.NOT_AVAILABLE},wi=function(ot){return navigator.cpuClass||ot.NOT_AVAILABLE},Ee=function(ot){return navigator.platform?navigator.platform:ot.NOT_AVAILABLE},Sr=function(ot){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:ot.NOT_AVAILABLE},Or=function(){var ot=0,zt;typeof navigator.maxTouchPoints<"u"?ot=navigator.maxTouchPoints:typeof navigator.msMaxTouchPoints<"u"&&(ot=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent"),zt=!0}catch{zt=!1}var Wt="ontouchstart"in window;return[ot,zt,Wt]},xn=function(ot){var zt=[],Wt=document.createElement("canvas");Wt.width=2e3,Wt.height=200,Wt.style.display="inline";var Ut=Wt.getContext("2d");return Ut.rect(0,0,10,10),Ut.rect(2,2,6,6),zt.push("canvas winding:"+(Ut.isPointInPath(5,5,"evenodd")===!1?"yes":"no")),Ut.textBaseline="alphabetic",Ut.fillStyle="#f60",Ut.fillRect(125,1,62,20),Ut.fillStyle="#069",ot.dontUseFakeFontInCanvas?Ut.font="11pt Arial":Ut.font="11pt no-real-font-123",Ut.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}",2,15),Ut.fillStyle="rgba(102, 204, 0, 0.2)",Ut.font="18pt Arial",Ut.fillText("Cwm fjordbank glyphs vext quiz, \u{1F603}",4,45),Ut.globalCompositeOperation="multiply",Ut.fillStyle="rgb(255,0,255)",Ut.beginPath(),Ut.arc(50,50,50,0,Math.PI*2,!0),Ut.closePath(),Ut.fill(),Ut.fillStyle="rgb(0,255,255)",Ut.beginPath(),Ut.arc(100,50,50,0,Math.PI*2,!0),Ut.closePath(),Ut.fill(),Ut.fillStyle="rgb(255,255,0)",Ut.beginPath(),Ut.arc(75,100,50,0,Math.PI*2,!0),Ut.closePath(),Ut.fill(),Ut.fillStyle="rgb(255,0,255)",Ut.arc(75,75,75,0,Math.PI*2,!0),Ut.arc(75,75,25,0,Math.PI*2,!0),Ut.fill("evenodd"),Wt.toDataURL&&zt.push("canvas fp:"+Wt.toDataURL()),zt},ye=function(){var ot,zt=function(hr){return ot.clearColor(0,0,0,1),ot.enable(ot.DEPTH_TEST),ot.depthFunc(ot.LEQUAL),ot.clear(ot.COLOR_BUFFER_BIT|ot.DEPTH_BUFFER_BIT),"["+hr[0]+", "+hr[1]+"]"},Wt=function(hr){var Vr=hr.getExtension("EXT_texture_filter_anisotropic")||hr.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||hr.getExtension("MOZ_EXT_texture_filter_anisotropic");if(Vr){var yi=hr.getParameter(Vr.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return yi===0&&(yi=2),yi}else return null};if(ot=Oe(),!ot)return null;var Ut=[],ve="attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}",Se="precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}",nr=ot.createBuffer();ot.bindBuffer(ot.ARRAY_BUFFER,nr);var xr=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);ot.bufferData(ot.ARRAY_BUFFER,xr,ot.STATIC_DRAW),nr.itemSize=3,nr.numItems=3;var Me=ot.createProgram(),ei=ot.createShader(ot.VERTEX_SHADER);ot.shaderSource(ei,ve),ot.compileShader(ei);var fr=ot.createShader(ot.FRAGMENT_SHADER);ot.shaderSource(fr,Se),ot.compileShader(fr),ot.attachShader(Me,ei),ot.attachShader(Me,fr),ot.linkProgram(Me),ot.useProgram(Me),Me.vertexPosAttrib=ot.getAttribLocation(Me,"attrVertex"),Me.offsetUniform=ot.getUniformLocation(Me,"uniformOffset"),ot.enableVertexAttribArray(Me.vertexPosArray),ot.vertexAttribPointer(Me.vertexPosAttrib,nr.itemSize,ot.FLOAT,!1,0,0),ot.uniform2f(Me.offsetUniform,1,1),ot.drawArrays(ot.TRIANGLE_STRIP,0,nr.numItems);try{Ut.push(ot.canvas.toDataURL())}catch{}Ut.push("extensions:"+(ot.getSupportedExtensions()||[]).join(";")),Ut.push("webgl aliased line width range:"+zt(ot.getParameter(ot.ALIASED_LINE_WIDTH_RANGE))),Ut.push("webgl aliased point size range:"+zt(ot.getParameter(ot.ALIASED_POINT_SIZE_RANGE))),Ut.push("webgl alpha bits:"+ot.getParameter(ot.ALPHA_BITS)),Ut.push("webgl antialiasing:"+(ot.getContextAttributes().antialias?"yes":"no")),Ut.push("webgl blue bits:"+ot.getParameter(ot.BLUE_BITS)),Ut.push("webgl depth bits:"+ot.getParameter(ot.DEPTH_BITS)),Ut.push("webgl green bits:"+ot.getParameter(ot.GREEN_BITS)),Ut.push("webgl max anisotropy:"+Wt(ot)),Ut.push("webgl max combined texture image units:"+ot.getParameter(ot.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),Ut.push("webgl max cube map texture size:"+ot.getParameter(ot.MAX_CUBE_MAP_TEXTURE_SIZE)),Ut.push("webgl max fragment uniform vectors:"+ot.getParameter(ot.MAX_FRAGMENT_UNIFORM_VECTORS)),Ut.push("webgl max render buffer size:"+ot.getParameter(ot.MAX_RENDERBUFFER_SIZE)),Ut.push("webgl max texture image units:"+ot.getParameter(ot.MAX_TEXTURE_IMAGE_UNITS)),Ut.push("webgl max texture size:"+ot.getParameter(ot.MAX_TEXTURE_SIZE)),Ut.push("webgl max varying vectors:"+ot.getParameter(ot.MAX_VARYING_VECTORS)),Ut.push("webgl max vertex attribs:"+ot.getParameter(ot.MAX_VERTEX_ATTRIBS)),Ut.push("webgl max vertex texture image units:"+ot.getParameter(ot.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),Ut.push("webgl max vertex uniform vectors:"+ot.getParameter(ot.MAX_VERTEX_UNIFORM_VECTORS)),Ut.push("webgl max viewport dims:"+zt(ot.getParameter(ot.MAX_VIEWPORT_DIMS))),Ut.push("webgl red bits:"+ot.getParameter(ot.RED_BITS)),Ut.push("webgl renderer:"+ot.getParameter(ot.RENDERER)),Ut.push("webgl shading language version:"+ot.getParameter(ot.SHADING_LANGUAGE_VERSION)),Ut.push("webgl stencil bits:"+ot.getParameter(ot.STENCIL_BITS)),Ut.push("webgl vendor:"+ot.getParameter(ot.VENDOR)),Ut.push("webgl version:"+ot.getParameter(ot.VERSION));try{var Mr=ot.getExtension("WEBGL_debug_renderer_info");Mr&&(Ut.push("webgl unmasked vendor:"+ot.getParameter(Mr.UNMASKED_VENDOR_WEBGL)),Ut.push("webgl unmasked renderer:"+ot.getParameter(Mr.UNMASKED_RENDERER_WEBGL)))}catch{}return ot.getShaderPrecisionFormat&&E(["FLOAT","INT"],function(hr){E(["VERTEX","FRAGMENT"],function(Vr){E(["HIGH","MEDIUM","LOW"],function(yi){E(["precision","rangeMin","rangeMax"],function(Qr){var Fi=ot.getShaderPrecisionFormat(ot[Vr+"_SHADER"],ot[yi+"_"+hr])[Qr];Qr!=="precision"&&(Qr="precision "+Qr);var ro=["webgl ",Vr.toLowerCase()," shader ",yi.toLowerCase()," ",hr.toLowerCase()," ",Qr,":",Fi].join("");Ut.push(ro)})})})}),Ut},oi=function(){try{var ot=Oe(),zt=ot.getExtension("WEBGL_debug_renderer_info");return ot.getParameter(zt.UNMASKED_VENDOR_WEBGL)+"~"+ot.getParameter(zt.UNMASKED_RENDERER_WEBGL)}catch{return null}},eo=function(){var ot=document.createElement("div");ot.innerHTML="&nbsp;",ot.className="adsbox";var zt=!1;try{document.body.appendChild(ot),zt=document.getElementsByClassName("adsbox")[0].offsetHeight===0,document.body.removeChild(ot)}catch{zt=!1}return zt},Xo=function(){if(typeof navigator.languages<"u")try{var ot=navigator.languages[0].substr(0,2);if(ot!==navigator.language.substr(0,2))return!0}catch{return!0}return!1},Xn=function(){return window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight},cn=function(){var ot=navigator.userAgent.toLowerCase(),zt=navigator.oscpu,Wt=navigator.platform.toLowerCase(),Ut;ot.indexOf("windows phone")>=0?Ut="Windows Phone":ot.indexOf("win")>=0?Ut="Windows":ot.indexOf("android")>=0?Ut="Android":ot.indexOf("linux")>=0?Ut="Linux":ot.indexOf("iphone")>=0||ot.indexOf("ipad")>=0?Ut="iOS":ot.indexOf("mac")>=0?Ut="Mac":Ut="Other";var ve="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;if(ve&&Ut!=="Windows Phone"&&Ut!=="Android"&&Ut!=="iOS"&&Ut!=="Other")return!0;if(typeof zt<"u"){if(zt=zt.toLowerCase(),zt.indexOf("win")>=0&&Ut!=="Windows"&&Ut!=="Windows Phone")return!0;if(zt.indexOf("linux")>=0&&Ut!=="Linux"&&Ut!=="Android")return!0;if(zt.indexOf("mac")>=0&&Ut!=="Mac"&&Ut!=="iOS")return!0;if((zt.indexOf("win")===-1&&zt.indexOf("linux")===-1&&zt.indexOf("mac")===-1)!=(Ut==="Other"))return!0}return Wt.indexOf("win")>=0&&Ut!=="Windows"&&Ut!=="Windows Phone"||(Wt.indexOf("linux")>=0||Wt.indexOf("android")>=0||Wt.indexOf("pike")>=0)&&Ut!=="Linux"&&Ut!=="Android"||(Wt.indexOf("mac")>=0||Wt.indexOf("ipad")>=0||Wt.indexOf("ipod")>=0||Wt.indexOf("iphone")>=0)&&Ut!=="Mac"&&Ut!=="iOS"||(Wt.indexOf("win")===-1&&Wt.indexOf("linux")===-1&&Wt.indexOf("mac")===-1)!=(Ut==="Other")?!0:typeof navigator.plugins>"u"&&Ut!=="Windows"&&Ut!=="Windows Phone"},Ft=function(){var ot=navigator.userAgent.toLowerCase(),zt=navigator.productSub,Wt;if(ot.indexOf("firefox")>=0?Wt="Firefox":ot.indexOf("opera")>=0||ot.indexOf("opr")>=0?Wt="Opera":ot.indexOf("chrome")>=0?Wt="Chrome":ot.indexOf("safari")>=0?Wt="Safari":ot.indexOf("trident")>=0?Wt="Internet Explorer":Wt="Other",(Wt==="Chrome"||Wt==="Safari"||Wt==="Opera")&&zt!=="20030107")return!0;var Ut=eval.toString().length;if(Ut===37&&Wt!=="Safari"&&Wt!=="Firefox"&&Wt!=="Other")return!0;if(Ut===39&&Wt!=="Internet Explorer"&&Wt!=="Other")return!0;if(Ut===33&&Wt!=="Chrome"&&Wt!=="Opera"&&Wt!=="Other")return!0;var ve;try{throw"a"}catch(Se){try{Se.toSource(),ve=!0}catch{ve=!1}}return ve&&Wt!=="Firefox"&&Wt!=="Other"},Ot=function(){var ot=document.createElement("canvas");return!!(ot.getContext&&ot.getContext("2d"))},Kt=function(){if(!Ot())return!1;var ot=Oe();return!!window.WebGLRenderingContext&&!!ot},ae=function(){return navigator.appName==="Microsoft Internet Explorer"?!0:!!(navigator.appName==="Netscape"&&/Trident/.test(navigator.userAgent))},Ve=function(){return typeof window.swfobject<"u"},Be=function(){return window.swfobject.hasFlashPlayerVersion("9.0.0")},Er=function(ot){var zt=document.createElement("div");zt.setAttribute("id",ot.fonts.swfContainerId),document.body.appendChild(zt)},br=function(ot,zt){var Wt="___fp_swf_loaded";window[Wt]=function(nr){ot(nr)};var Ut=zt.fonts.swfContainerId;Er();var ve={onReady:Wt},Se={allowScriptAccess:"always",menu:"false"};window.swfobject.embedSWF(zt.fonts.swfPath,Ut,"1","1","9.0.0",!1,ve,Se,{})},Oe=function(){var ot=document.createElement("canvas"),zt=null;try{zt=ot.getContext("webgl")||ot.getContext("experimental-webgl")}catch{}return zt||(zt=null),zt},ur=[{key:"userAgent",getData:G},{key:"language",getData:B},{key:"colorDepth",getData:O},{key:"deviceMemory",getData:K},{key:"pixelRatio",getData:Q},{key:"hardwareConcurrency",getData:se},{key:"screenResolution",getData:et},{key:"availableScreenResolution",getData:pt},{key:"timezoneOffset",getData:ct},{key:"timezone",getData:ut},{key:"sessionStorage",getData:ft},{key:"localStorage",getData:$},{key:"indexedDb",getData:_t},{key:"addBehavior",getData:W},{key:"openDatabase",getData:rt},{key:"cpuClass",getData:nt},{key:"platform",getData:vt},{key:"doNotTrack",getData:Mt},{key:"plugins",getData:Br},{key:"canvas",getData:Bt},{key:"webgl",getData:Vt},{key:"webglVendorAndRenderer",getData:Lt},{key:"adBlock",getData:Ne},{key:"hasLiedLanguages",getData:ge},{key:"hasLiedResolution",getData:Yt},{key:"hasLiedOs",getData:ue},{key:"hasLiedBrowser",getData:ne},{key:"touchSupport",getData:De},{key:"fonts",getData:je,pauseBefore:!0},{key:"fontsFlash",getData:dr,pauseBefore:!0},{key:"audio",getData:A},{key:"enumerateDevices",getData:F}],ar=function(ot){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/Valve/fingerprintjs2#upgrade-guide-from-182-to-200")};return ar.get=function(ot,zt){zt?ot||(ot={}):(zt=ot,ot={}),L(ot,x),ot.components=ot.extraComponents.concat(ur);var Wt={data:[],addPreprocessedComponent:function(Se,nr){typeof ot.preprocessor=="function"&&(nr=ot.preprocessor(Se,nr)),Wt.data.push({key:Se,value:nr})}},Ut=-1,ve=function(Se){if(Ut+=1,Ut>=ot.components.length){zt(Wt.data);return}var nr=ot.components[Ut];if(ot.excludes[nr.key]){ve(!1);return}if(!Se&&nr.pauseBefore){Ut-=1,setTimeout(function(){ve(!0)},1);return}try{nr.getData(function(xr){Wt.addPreprocessedComponent(nr.key,xr),ve(!1)},ot)}catch(xr){Wt.addPreprocessedComponent(nr.key,String(xr)),ve(!1)}};ve(!1)},ar.getPromise=function(ot){return new Promise(function(zt,Wt){ar.get(ot,zt)})},ar.getV18=function(ot,zt){return zt==null&&(zt=ot,ot={}),ar.get(ot,function(Wt){for(var Ut=[],ve=0;ve<Wt.length;ve++){var Se=Wt[ve];if(Se.value===(ot.NOT_AVAILABLE||"not available"))Ut.push({key:Se.key,value:"unknown"});else if(Se.key==="plugins")Ut.push({key:"plugins",value:P(Se.value,function(xr){var Me=P(xr[2],function(ei){return ei.join?ei.join("~"):ei}).join(",");return[xr[0],xr[1],Me].join("::")})});else if(["canvas","webgl"].indexOf(Se.key)!==-1)Ut.push({key:Se.key,value:Se.value.join("~")});else if(["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(Se.key)!==-1)if(Se.value)Ut.push({key:Se.key,value:1});else continue;else Se.value?Ut.push(Se.value.join?{key:Se.key,value:Se.value.join(";")}:Se):Ut.push({key:Se.key,value:Se.value})}var nr=g(P(Ut,function(xr){return xr.value}).join("~~~"),31);zt(nr,Ut)})},ar.x64hash128=g,ar.VERSION="2.0.6",ar}),typeof require=="function")var Ajv=require("ajv");var libraryDispatcher={dispatch:function(n){typeof document<"u"?document.dispatchEvent(new CustomEvent("TelemetryEvent",{detail:n})):console.info("Library dispatcher supports only for client side.")}},Telemetry=function(){this.telemetry=function(){};var n=function(){},c=this;this.telemetry.initialized=!1,this.telemetry.config={},this.telemetry._version="3.0",this.telemetry.fingerPrintId=void 0,this.dispatcher=libraryDispatcher,this._defaultValue={uid:"anonymous",authtoken:"",batchsize:20,host:"https://api.ekstep.in",endpoint:"/data/v3/telemetry",apislug:"/action"},this.telemetryEnvelop={eid:"",ets:"",ver:"",mid:"",actor:{},context:{},object:{},tags:[],edata:""},this._globalContext={channel:"in.ekstep",pdata:{id:"in.ekstep",ver:"1.0",pid:""},env:"contentplayer",sid:"",did:"",cdata:[],rollup:{}},this.runningEnv="client",this.enableValidation=!1,this._globalObject={},this.startData=[],this.ajv=new Ajv({schemas:telemetrySchema}),this.telemetry.initialize=function(u){n.init(u)},this.telemetry.start=function(u,d,m,g,x){g.duration=g.duration||new Date().getTime()*.001,d&&m&&(c._globalObject.id=d,c._globalObject.ver=m),!Telemetry.initialized&&u&&n.init(u,d,m),n.updateValues(x);var E=n.getEvent("START",g);n._dispatch(E),c.startData.push(JSON.parse(JSON.stringify(E)))},this.telemetry.impression=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("IMPRESSION",u))},this.telemetry.interact=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("INTERACT",u))},this.telemetry.assess=function(u,d){n.updateValues(d),assessEvent=n.getEvent("ASSESS",u),d&&d.eventVer&&(assessEvent.ver=d.eventVer),n._dispatch(assessEvent)},this.telemetry.response=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("RESPONSE",u))},this.telemetry.interrupt=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("INTERRUPT",u))},this.telemetry.feedback=function(u,d){var m={rating:u.rating,commentid:u.commentid||"",commenttxt:u.commenttxt||""};n.updateValues(d),n._dispatch(n.getEvent("FEEDBACK",m))},this.telemetry.share=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("SHARE",u))},this.telemetry.audit=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("AUDIT",u))},this.telemetry.error=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("ERROR",u))},this.telemetry.heartbeat=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("HEARTBEAT",u))},this.telemetry.log=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("LOG",u))},this.telemetry.search=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("SEARCH",u))},this.telemetry.metrics=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("METRICS",u))},this.telemetry.exdata=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("EXDATA",u))},this.telemetry.summary=function(u,d){n.updateValues(d),n._dispatch(n.getEvent("SUMMARY",u))},this.telemetry.end=function(u,d){if(c.startData.length){var m=c.startData.pop();u.duration=parseFloat(((new Date().getTime()-m.ets)*.001).toFixed(2)),n.updateValues(d),n._dispatch(n.getEvent("END",u))}else console.info("Please invoke start before invoking end event.")},this.telemetry.isInitialized=function(){return Telemetry.initialized},this.telemetry.resetContext=function(u){c._currentContext=u||{}},this.telemetry.resetObject=function(u){c._currentObject=u||{}},this.telemetry.resetActor=function(u){c._currentActor=u||{}},this.telemetry.resetTags=function(u){c._currentTags=u||[]},this.telemetry.syncEvents=function(u=!0){typeof TelemetrySyncManager<"u"&&TelemetrySyncManager.syncEvents(u)},n.init=function(u,d,m){if(Telemetry.initialized){console.log("Telemetry is already initialized..");return}!u&&(u={}),d&&(c._globalObject.id=d),m&&(c._globalObject.ver=m),u.runningEnv&&(c.runningEnv=u.runningEnv),typeof u.enableValidation<"u"&&(c.enableValidation=u.enableValidation),u.batchsize=u.batchsize?u.batchsize>1e3?1e3:u.batchsize:_defaultValue.batchsize,Telemetry.config=Object.assign(_defaultValue,u),Telemetry.initialized=!0,c.dispatcher=Telemetry.config.dispatcher?Telemetry.config.dispatcher:libraryDispatcher,n.updateConfigurations(u),console.info("Telemetry is initialized.")},n._dispatch=function(u){if(u.mid=u.eid+":"+CryptoJS.MD5(JSON.stringify(u)).toString(),c.enableValidation){var d=ajv.getSchema("http://api.ekstep.org/telemetry/"+u.eid.toLowerCase()),m=d(u);if(!m){console.error("Invalid "+u.eid+" Event: "+ajv.errorsText(d.errors));return}}c.runningEnv==="client"?u.context.did?(u.actor.id=n.getActorId(u.actor.id,u.context.did),dispatcher.dispatch(u)):Telemetry.fingerPrintId?(u.context.did=Telemetry.fingerPrintId,u.actor.id=n.getActorId(u.actor.id,Telemetry.fingerPrintId),dispatcher.dispatch(u)):Telemetry.getFingerPrint(function(g,x){u.context.did=g,u.actor.id=n.getActorId(u.actor.id,g),Telemetry.fingerPrintId=g,dispatcher.dispatch(u)}):dispatcher.dispatch(u)},n.getActorId=function(u,d){return!u||u==="anonymous"?d:u},n.getEvent=function(u,d){return c.telemetryEnvelop.eid=u,c.telemetryEnvelop.ets=new Date().getTime()+(Telemetry.config.timeDiff*1e3||0),c.telemetryEnvelop.ver=Telemetry._version,c.telemetryEnvelop.mid="",c.telemetryEnvelop.actor=Object.assign({},{id:Telemetry.config.uid||"anonymous",type:"User"},n.getUpdatedValue("actor")),c.telemetryEnvelop.context=Object.assign({},n.getGlobalContext(),n.getUpdatedValue("context")),c.telemetryEnvelop.object=Object.assign({},n.getGlobalObject(),n.getUpdatedValue("object")),c.telemetryEnvelop.tags=Object.assign([],Telemetry.config.tags,n.getUpdatedValue("tags")),c.telemetryEnvelop.edata=d,c.telemetryEnvelop},n.updateConfigurations=function(u){u.object&&(c._globalObject=u.object),u.channel&&(c._globalContext.channel=u.channel),u.env&&(c._globalContext.env=u.env),u.rollup&&(c._globalContext.rollup=u.rollup),u.sid&&(c._globalContext.sid=u.sid),u.did&&(c._globalContext.did=u.did),u.cdata&&(c._globalContext.cdata=u.cdata),u.pdata&&(c._globalContext.pdata=u.pdata)},n.getGlobalContext=function(){return c._globalContext},n.getGlobalObject=function(){return c._globalObject},n.updateValues=function(u){u&&(u.context&&(c._currentContext=u.context),u.object&&(c._currentObject=u.object),u.actor&&(c._currentActor=u.actor),u.tags&&(c._currentTags=u.tags),u.runningEnv&&(c.runningEnv=u.runningEnv))},n.getUpdatedValue=function(u){switch(u.toLowerCase()){case"context":return c._currentContext||{};case"object":return c._currentObject||{};case"actor":return c._currentActor||{};case"tags":return c._currentTags||[]}},n.objectAssign=function(){Object.assign=function(u){"use strict";if(u==null)throw new TypeError("Cannot convert undefined or null to object");u=Object(u);for(var d=1;d<arguments.length;d++){var m=arguments[d];if(m!=null)for(var g in m)Object.prototype.hasOwnProperty.call(m,g)&&(u[g]=m[g])}return u}};var h={audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[{key:"customKey",getData:function(u,d){var m=new Date().getTime();const g="didGenerateTime";window.localStorage&&window.localStorage.getItem(g)?m=window.localStorage.getItem(g):window.localStorage.setItem(g,m),u(m)}}],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0,screenResolution:!0,availableScreenResolution:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"};return this.telemetry.getFingerPrint=function(u){const d="v2";if(localStorage&&localStorage.getItem(`fpDetails_${d}`)){var m=JSON.parse(localStorage.getItem(`fpDetails_${d}`));u&&u(m.result,m.components,d)}else Fingerprint2.getV18(h,function(g,x){localStorage&&localStorage.setItem(`fpDetails_${d}`,JSON.stringify({result:g,components:x})),u&&u(g,x,d)})},typeof Object.assign!="function"&&n.objectAssign(),this.telemetry}();EkTelemetry=$t=Telemetry,typeof module<"u"&&(module.exports=Telemetry);var TelemetrySyncManager={_teleData:[],_failedBatch:[],_failedBatchSize:20,_syncRetryInterval:2e3,init:function(){var n=this,c=EkTelemetry||c;c.config.syncRetryInterval&&(n._syncRetryInterval=c.config.syncRetryInterval),c.config.failedBatchSize&&(n._failedBatchSize=c.config.failedBatchSize),document.addEventListener("TelemetryEvent",this.sendTelemetry)},sendTelemetry:function(n){var c=n.detail;Telemetry.config.telemetryDebugEnabled&&console.log("Telemetry Events ",JSON.stringify(c));var h=TelemetrySyncManager;h._teleData.push(Object.assign({},c)),(c.eid.toUpperCase()==="END"||h._teleData.length>=Telemetry.config.batchsize)&&TelemetrySyncManager.syncEvents()},syncEvents:function(n=!0,c){var h=EkTelemetry||h,u=TelemetrySyncManager;if(!c){var d=u._teleData.splice(0,h.config.batchsize);if(!d.length)return;c={id:"api.sunbird.telemetry",ver:h._version,params:{msgid:CryptoJS.MD5(JSON.stringify(d)).toString()},ets:new Date().getTime()+(h.config.timeDiff*1e3||0),events:d}}var m={};typeof h.config.authtoken<"u"&&(m.Authorization="Bearer "+h.config.authtoken);var g=h.config.host+h.config.apislug+h.config.endpoint;m.dataType="json",m["Content-Type"]="application/json",m["x-app-id"]=h.config.pdata.id,m["x-device-id"]=h.fingerPrintId,m["x-channel-id"]=h.config.channel,jQuery.ajax({url:g,type:"POST",headers:m,data:JSON.stringify(c),async:n}).done(function(x){h.config.telemetryDebugEnabled&&console.log("Telemetry API success",x)}).fail(function(x,E,P){u._failedBatchSize>u._failedBatch.length&&u._failedBatch.push(c),x.status==403?console.error("Authentication error: ",x):console.log("Error while Telemetry sync to server: ",x)})},syncFailedBatch:function(){var n=TelemetrySyncManager;if(n._failedBatch.length){Telemetry.config.telemetryDebugEnabled&&console.log("syncing failed telemetry batch");var c=n._failedBatch.shift();n.syncEvents(!0,c)}}};typeof document<"u"&&(TelemetrySyncManager.init(),setInterval(function(){TelemetrySyncManager.syncFailedBatch()},TelemetrySyncManager._syncRetryInterval));/*! jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */(function(n,c){"use strict";typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?c(n,!0):function(h){if(!h.document)throw new Error("jQuery requires a window with a document");return c(h)}:c(n)})(typeof window<"u"?window:this,function(n,c){"use strict";var h=[],u=Object.getPrototypeOf,d=h.slice,m=h.flat?function(v){return h.flat.call(v)}:function(v){return h.concat.apply([],v)},g=h.push,x=h.indexOf,E={},P=E.toString,L=E.hasOwnProperty,F=L.toString,U=F.call(Object),A={},G=function(v){return typeof v=="function"&&typeof v.nodeType!="number"&&typeof v.item!="function"},B=function(v){return v!=null&&v===v.window},O=n.document,K={type:!0,src:!0,nonce:!0,noModule:!0};function Q(v,S,M){var R,V,q=(M=M||O).createElement("script");if(q.text=v,S)for(R in K)(V=S[R]||S.getAttribute&&S.getAttribute(R))&&q.setAttribute(R,V);M.head.appendChild(q).parentNode.removeChild(q)}function et(v){return v==null?v+"":typeof v=="object"||typeof v=="function"?E[P.call(v)]||"object":typeof v}var lt="3.7.1",pt=/HTML$/i,T=function(v,S){return new T.fn.init(v,S)};function ct(v){var S=!!v&&"length"in v&&v.length,M=et(v);return!G(v)&&!B(v)&&(M==="array"||S===0||typeof S=="number"&&0<S&&S-1 in v)}function ut(v,S){return v.nodeName&&v.nodeName.toLowerCase()===S.toLowerCase()}T.fn=T.prototype={jquery:lt,constructor:T,length:0,toArray:function(){return d.call(this)},get:function(v){return v==null?d.call(this):v<0?this[v+this.length]:this[v]},pushStack:function(v){var S=T.merge(this.constructor(),v);return S.prevObject=this,S},each:function(v){return T.each(this,v)},map:function(v){return this.pushStack(T.map(this,function(S,M){return v.call(S,M,S)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(T.grep(this,function(v,S){return(S+1)%2}))},odd:function(){return this.pushStack(T.grep(this,function(v,S){return S%2}))},eq:function(v){var S=this.length,M=+v+(v<0?S:0);return this.pushStack(0<=M&&M<S?[this[M]]:[])},end:function(){return this.prevObject||this.constructor()},push:g,sort:h.sort,splice:h.splice},T.extend=T.fn.extend=function(){var v,S,M,R,V,q,Y=arguments[0]||{},ht=1,st=arguments.length,xt=!1;for(typeof Y=="boolean"&&(xt=Y,Y=arguments[ht]||{},ht++),typeof Y=="object"||G(Y)||(Y={}),ht===st&&(Y=this,ht--);ht<st;ht++)if((v=arguments[ht])!=null)for(S in v)R=v[S],S!=="__proto__"&&Y!==R&&(xt&&R&&(T.isPlainObject(R)||(V=Array.isArray(R)))?(M=Y[S],q=V&&!Array.isArray(M)?[]:V||T.isPlainObject(M)?M:{},V=!1,Y[S]=T.extend(xt,q,R)):R!==void 0&&(Y[S]=R));return Y},T.extend({expando:"jQuery"+(lt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(v){throw new Error(v)},noop:function(){},isPlainObject:function(v){var S,M;return!(!v||P.call(v)!=="[object Object]")&&(!(S=u(v))||typeof(M=L.call(S,"constructor")&&S.constructor)=="function"&&F.call(M)===U)},isEmptyObject:function(v){var S;for(S in v)return!1;return!0},globalEval:function(v,S,M){Q(v,{nonce:S&&S.nonce},M)},each:function(v,S){var M,R=0;if(ct(v))for(M=v.length;R<M&&S.call(v[R],R,v[R])!==!1;R++);else for(R in v)if(S.call(v[R],R,v[R])===!1)break;return v},text:function(v){var S,M="",R=0,V=v.nodeType;if(!V)for(;S=v[R++];)M+=T.text(S);return V===1||V===11?v.textContent:V===9?v.documentElement.textContent:V===3||V===4?v.nodeValue:M},makeArray:function(v,S){var M=S||[];return v!=null&&(ct(Object(v))?T.merge(M,typeof v=="string"?[v]:v):g.call(M,v)),M},inArray:function(v,S,M){return S==null?-1:x.call(S,v,M)},isXMLDoc:function(v){var S=v&&v.namespaceURI,M=v&&(v.ownerDocument||v).documentElement;return!pt.test(S||M&&M.nodeName||"HTML")},merge:function(v,S){for(var M=+S.length,R=0,V=v.length;R<M;R++)v[V++]=S[R];return v.length=V,v},grep:function(v,S,M){for(var R=[],V=0,q=v.length,Y=!M;V<q;V++)!S(v[V],V)!==Y&&R.push(v[V]);return R},map:function(v,S,M){var R,V,q=0,Y=[];if(ct(v))for(R=v.length;q<R;q++)(V=S(v[q],q,M))!=null&&Y.push(V);else for(q in v)(V=S(v[q],q,M))!=null&&Y.push(V);return m(Y)},guid:1,support:A}),typeof Symbol=="function"&&(T.fn[Symbol.iterator]=h[Symbol.iterator]),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(v,S){E["[object "+S+"]"]=S.toLowerCase()});var ft=h.pop,$=h.sort,_t=h.splice,W="[\\x20\\t\\r\\n\\f]",rt=new RegExp("^"+W+"+|((?:^|[^\\\\])(?:\\\\.)*)"+W+"+$","g");T.contains=function(v,S){var M=S&&S.parentNode;return v===M||!(!M||M.nodeType!==1||!(v.contains?v.contains(M):v.compareDocumentPosition&&16&v.compareDocumentPosition(M)))};var nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function vt(v,S){return S?v==="\0"?"\uFFFD":v.slice(0,-1)+"\\"+v.charCodeAt(v.length-1).toString(16)+" ":"\\"+v}T.escapeSelector=function(v){return(v+"").replace(nt,vt)};var Mt=O,Bt=g;(function(){var v,S,M,R,V,q,Y,ht,st,xt,Tt=Bt,jt=T.expando,Et=0,qt=0,be=ii(),We=ii(),Ze=ii(),si=ii(),gi=function(tt,mt){return tt===mt&&(V=!0),0},dn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Dn="(?:\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",pr="\\["+W+"*("+Dn+")(?:"+W+"*([*^$|!~]?=)"+W+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Dn+"))|)"+W+"*\\]",Xi=":("+Dn+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+pr+")*)|.*)\\)|)",rr=new RegExp(W+"+","g"),Rr=new RegExp("^"+W+"*,"+W+"*"),Gn=new RegExp("^"+W+"*([>+~]|"+W+")"+W+"*"),ts=new RegExp(W+"|>"),ri=new RegExp(Xi),Fo=new RegExp("^"+Dn+"$"),Zn={ID:new RegExp("^#("+Dn+")"),CLASS:new RegExp("^\\.("+Dn+")"),TAG:new RegExp("^("+Dn+"|[*])"),ATTR:new RegExp("^"+pr),PSEUDO:new RegExp("^"+Xi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+W+"*(even|odd|(([+-]|)(\\d*)n|)"+W+"*(?:([+-]|)"+W+"*(\\d+)|))"+W+"*\\)|)","i"),bool:new RegExp("^(?:"+dn+")$","i"),needsContext:new RegExp("^"+W+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+W+"*((?:-\\d)?\\d*)"+W+"*\\)|)(?=[^-]|$)","i")},ho=/^(?:input|select|textarea|button)$/i,hi=/^h\d$/i,gn=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bi=/[+~]/,Yr=new RegExp("\\\\[\\da-fA-F]{1,6}"+W+"?|\\\\([^\\r\\n\\f])","g"),Bi=function(tt,mt){var Pt="0x"+tt.slice(1)-65536;return mt||(Pt<0?String.fromCharCode(Pt+65536):String.fromCharCode(Pt>>10|55296,1023&Pt|56320))},An=function(){io()},Wi=mn(function(tt){return tt.disabled===!0&&ut(tt,"fieldset")},{dir:"parentNode",next:"legend"});try{Tt.apply(h=d.call(Mt.childNodes),Mt.childNodes),h[Mt.childNodes.length].nodeType}catch{Tt={apply:function(mt,Pt){Bt.apply(mt,d.call(Pt))},call:function(mt){Bt.apply(mt,d.call(arguments,1))}}}function ze(tt,mt,Pt,Nt){var Ht,_e,we,Te,me,_r,Ke,er=mt&&mt.ownerDocument,wr=mt?mt.nodeType:9;if(Pt=Pt||[],typeof tt!="string"||!tt||wr!==1&&wr!==9&&wr!==11)return Pt;if(!Nt&&(io(mt),mt=mt||q,ht)){if(wr!==11&&(me=gn.exec(tt)))if(Ht=me[1]){if(wr===9){if(!(we=mt.getElementById(Ht)))return Pt;if(we.id===Ht)return Tt.call(Pt,we),Pt}else if(er&&(we=er.getElementById(Ht))&&ze.contains(mt,we)&&we.id===Ht)return Tt.call(Pt,we),Pt}else{if(me[2])return Tt.apply(Pt,mt.getElementsByTagName(tt)),Pt;if((Ht=me[3])&&mt.getElementsByClassName)return Tt.apply(Pt,mt.getElementsByClassName(Ht)),Pt}if(!(si[tt+" "]||st&&st.test(tt))){if(Ke=tt,er=mt,wr===1&&(ts.test(tt)||Gn.test(tt))){for((er=bi.test(tt)&&bs(mt.parentNode)||mt)==mt&&A.scope||((Te=mt.getAttribute("id"))?Te=T.escapeSelector(Te):mt.setAttribute("id",Te=jt)),_e=(_r=en(tt)).length;_e--;)_r[_e]=(Te?"#"+Te:":scope")+" "+Zo(_r[_e]);Ke=_r.join(",")}try{return Tt.apply(Pt,er.querySelectorAll(Ke)),Pt}catch{si(tt,!0)}finally{Te===jt&&mt.removeAttribute("id")}}}return ia(tt.replace(rt,"$1"),mt,Pt,Nt)}function ii(){var tt=[];return function mt(Pt,Nt){return tt.push(Pt+" ")>S.cacheLength&&delete mt[tt.shift()],mt[Pt+" "]=Nt}}function zr(tt){return tt[jt]=!0,tt}function qr(tt){var mt=q.createElement("fieldset");try{return!!tt(mt)}catch{return!1}finally{mt.parentNode&&mt.parentNode.removeChild(mt),mt=null}}function vn(tt){return function(mt){return ut(mt,"input")&&mt.type===tt}}function Ie(tt){return function(mt){return(ut(mt,"input")||ut(mt,"button"))&&mt.type===tt}}function lo(tt){return function(mt){return"form"in mt?mt.parentNode&&mt.disabled===!1?"label"in mt?"label"in mt.parentNode?mt.parentNode.disabled===tt:mt.disabled===tt:mt.isDisabled===tt||mt.isDisabled!==!tt&&Wi(mt)===tt:mt.disabled===tt:"label"in mt&&mt.disabled===tt}}function Bn(tt){return zr(function(mt){return mt=+mt,zr(function(Pt,Nt){for(var Ht,_e=tt([],Pt.length,mt),we=_e.length;we--;)Pt[Ht=_e[we]]&&(Pt[Ht]=!(Nt[Ht]=Pt[Ht]))})})}function bs(tt){return tt&&typeof tt.getElementsByTagName<"u"&&tt}function io(tt){var mt,Pt=tt?tt.ownerDocument||tt:Mt;return Pt!=q&&Pt.nodeType===9&&Pt.documentElement&&(Y=(q=Pt).documentElement,ht=!T.isXMLDoc(q),xt=Y.matches||Y.webkitMatchesSelector||Y.msMatchesSelector,Y.msMatchesSelector&&Mt!=q&&(mt=q.defaultView)&&mt.top!==mt&&mt.addEventListener("unload",An),A.getById=qr(function(Nt){return Y.appendChild(Nt).id=T.expando,!q.getElementsByName||!q.getElementsByName(T.expando).length}),A.disconnectedMatch=qr(function(Nt){return xt.call(Nt,"*")}),A.scope=qr(function(){return q.querySelectorAll(":scope")}),A.cssHas=qr(function(){try{return q.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),A.getById?(S.filter.ID=function(Nt){var Ht=Nt.replace(Yr,Bi);return function(_e){return _e.getAttribute("id")===Ht}},S.find.ID=function(Nt,Ht){if(typeof Ht.getElementById<"u"&&ht){var _e=Ht.getElementById(Nt);return _e?[_e]:[]}}):(S.filter.ID=function(Nt){var Ht=Nt.replace(Yr,Bi);return function(_e){var we=typeof _e.getAttributeNode<"u"&&_e.getAttributeNode("id");return we&&we.value===Ht}},S.find.ID=function(Nt,Ht){if(typeof Ht.getElementById<"u"&&ht){var _e,we,Te,me=Ht.getElementById(Nt);if(me){if((_e=me.getAttributeNode("id"))&&_e.value===Nt)return[me];for(Te=Ht.getElementsByName(Nt),we=0;me=Te[we++];)if((_e=me.getAttributeNode("id"))&&_e.value===Nt)return[me]}return[]}}),S.find.TAG=function(Nt,Ht){return typeof Ht.getElementsByTagName<"u"?Ht.getElementsByTagName(Nt):Ht.querySelectorAll(Nt)},S.find.CLASS=function(Nt,Ht){if(typeof Ht.getElementsByClassName<"u"&&ht)return Ht.getElementsByClassName(Nt)},st=[],qr(function(Nt){var Ht;Y.appendChild(Nt).innerHTML="<a id='"+jt+"' href='' disabled='disabled'></a><select id='"+jt+"-\r\\' disabled='disabled'><option selected=''></option></select>",Nt.querySelectorAll("[selected]").length||st.push("\\["+W+"*(?:value|"+dn+")"),Nt.querySelectorAll("[id~="+jt+"-]").length||st.push("~="),Nt.querySelectorAll("a#"+jt+"+*").length||st.push(".#.+[+~]"),Nt.querySelectorAll(":checked").length||st.push(":checked"),(Ht=q.createElement("input")).setAttribute("type","hidden"),Nt.appendChild(Ht).setAttribute("name","D"),Y.appendChild(Nt).disabled=!0,Nt.querySelectorAll(":disabled").length!==2&&st.push(":enabled",":disabled"),(Ht=q.createElement("input")).setAttribute("name",""),Nt.appendChild(Ht),Nt.querySelectorAll("[name='']").length||st.push("\\["+W+"*name"+W+"*="+W+`*(?:''|"")`)}),A.cssHas||st.push(":has"),st=st.length&&new RegExp(st.join("|")),gi=function(Nt,Ht){if(Nt===Ht)return V=!0,0;var _e=!Nt.compareDocumentPosition-!Ht.compareDocumentPosition;return _e||(1&(_e=(Nt.ownerDocument||Nt)==(Ht.ownerDocument||Ht)?Nt.compareDocumentPosition(Ht):1)||!A.sortDetached&&Ht.compareDocumentPosition(Nt)===_e?Nt===q||Nt.ownerDocument==Mt&&ze.contains(Mt,Nt)?-1:Ht===q||Ht.ownerDocument==Mt&&ze.contains(Mt,Ht)?1:R?x.call(R,Nt)-x.call(R,Ht):0:4&_e?-1:1)}),q}for(v in ze.matches=function(tt,mt){return ze(tt,null,null,mt)},ze.matchesSelector=function(tt,mt){if(io(tt),ht&&!si[mt+" "]&&(!st||!st.test(mt)))try{var Pt=xt.call(tt,mt);if(Pt||A.disconnectedMatch||tt.document&&tt.document.nodeType!==11)return Pt}catch{si(mt,!0)}return 0<ze(mt,q,null,[tt]).length},ze.contains=function(tt,mt){return(tt.ownerDocument||tt)!=q&&io(tt),T.contains(tt,mt)},ze.attr=function(tt,mt){(tt.ownerDocument||tt)!=q&&io(tt);var Pt=S.attrHandle[mt.toLowerCase()],Nt=Pt&&L.call(S.attrHandle,mt.toLowerCase())?Pt(tt,mt,!ht):void 0;return Nt!==void 0?Nt:tt.getAttribute(mt)},ze.error=function(tt){throw new Error("Syntax error, unrecognized expression: "+tt)},T.uniqueSort=function(tt){var mt,Pt=[],Nt=0,Ht=0;if(V=!A.sortStable,R=!A.sortStable&&d.call(tt,0),$.call(tt,gi),V){for(;mt=tt[Ht++];)mt===tt[Ht]&&(Nt=Pt.push(Ht));for(;Nt--;)_t.call(tt,Pt[Nt],1)}return R=null,tt},T.fn.uniqueSort=function(){return this.pushStack(T.uniqueSort(d.apply(this)))},(S=T.expr={cacheLength:50,createPseudo:zr,match:Zn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(tt){return tt[1]=tt[1].replace(Yr,Bi),tt[3]=(tt[3]||tt[4]||tt[5]||"").replace(Yr,Bi),tt[2]==="~="&&(tt[3]=" "+tt[3]+" "),tt.slice(0,4)},CHILD:function(tt){return tt[1]=tt[1].toLowerCase(),tt[1].slice(0,3)==="nth"?(tt[3]||ze.error(tt[0]),tt[4]=+(tt[4]?tt[5]+(tt[6]||1):2*(tt[3]==="even"||tt[3]==="odd")),tt[5]=+(tt[7]+tt[8]||tt[3]==="odd")):tt[3]&&ze.error(tt[0]),tt},PSEUDO:function(tt){var mt,Pt=!tt[6]&&tt[2];return Zn.CHILD.test(tt[0])?null:(tt[3]?tt[2]=tt[4]||tt[5]||"":Pt&&ri.test(Pt)&&(mt=en(Pt,!0))&&(mt=Pt.indexOf(")",Pt.length-mt)-Pt.length)&&(tt[0]=tt[0].slice(0,mt),tt[2]=Pt.slice(0,mt)),tt.slice(0,3))}},filter:{TAG:function(tt){var mt=tt.replace(Yr,Bi).toLowerCase();return tt==="*"?function(){return!0}:function(Pt){return ut(Pt,mt)}},CLASS:function(tt){var mt=be[tt+" "];return mt||(mt=new RegExp("(^|"+W+")"+tt+"("+W+"|$)"))&&be(tt,function(Pt){return mt.test(typeof Pt.className=="string"&&Pt.className||typeof Pt.getAttribute<"u"&&Pt.getAttribute("class")||"")})},ATTR:function(tt,mt,Pt){return function(Nt){var Ht=ze.attr(Nt,tt);return Ht==null?mt==="!=":!mt||(Ht+="",mt==="="?Ht===Pt:mt==="!="?Ht!==Pt:mt==="^="?Pt&&Ht.indexOf(Pt)===0:mt==="*="?Pt&&-1<Ht.indexOf(Pt):mt==="$="?Pt&&Ht.slice(-Pt.length)===Pt:mt==="~="?-1<(" "+Ht.replace(rr," ")+" ").indexOf(Pt):mt==="|="&&(Ht===Pt||Ht.slice(0,Pt.length+1)===Pt+"-"))}},CHILD:function(tt,mt,Pt,Nt,Ht){var _e=tt.slice(0,3)!=="nth",we=tt.slice(-4)!=="last",Te=mt==="of-type";return Nt===1&&Ht===0?function(me){return!!me.parentNode}:function(me,_r,Ke){var er,wr,ie,ti,Ti,Si=_e!==we?"nextSibling":"previousSibling",Yi=me.parentNode,sn=Te&&me.nodeName.toLowerCase(),Zi=!Ke&&!Te,jr=!1;if(Yi){if(_e){for(;Si;){for(ie=me;ie=ie[Si];)if(Te?ut(ie,sn):ie.nodeType===1)return!1;Ti=Si=tt==="only"&&!Ti&&"nextSibling"}return!0}if(Ti=[we?Yi.firstChild:Yi.lastChild],we&&Zi){for(jr=(ti=(er=(wr=Yi[jt]||(Yi[jt]={}))[tt]||[])[0]===Et&&er[1])&&er[2],ie=ti&&Yi.childNodes[ti];ie=++ti&&ie&&ie[Si]||(jr=ti=0)||Ti.pop();)if(ie.nodeType===1&&++jr&&ie===me){wr[tt]=[Et,ti,jr];break}}else if(Zi&&(jr=ti=(er=(wr=me[jt]||(me[jt]={}))[tt]||[])[0]===Et&&er[1]),jr===!1)for(;(ie=++ti&&ie&&ie[Si]||(jr=ti=0)||Ti.pop())&&!((Te?ut(ie,sn):ie.nodeType===1)&&++jr&&(Zi&&((wr=ie[jt]||(ie[jt]={}))[tt]=[Et,jr]),ie===me)););return(jr-=Ht)===Nt||jr%Nt==0&&0<=jr/Nt}}},PSEUDO:function(tt,mt){var Pt,Nt=S.pseudos[tt]||S.setFilters[tt.toLowerCase()]||ze.error("unsupported pseudo: "+tt);return Nt[jt]?Nt(mt):1<Nt.length?(Pt=[tt,tt,"",mt],S.setFilters.hasOwnProperty(tt.toLowerCase())?zr(function(Ht,_e){for(var we,Te=Nt(Ht,mt),me=Te.length;me--;)Ht[we=x.call(Ht,Te[me])]=!(_e[we]=Te[me])}):function(Ht){return Nt(Ht,0,Pt)}):Nt}},pseudos:{not:zr(function(tt){var mt=[],Pt=[],Nt=Do(tt.replace(rt,"$1"));return Nt[jt]?zr(function(Ht,_e,we,Te){for(var me,_r=Nt(Ht,null,Te,[]),Ke=Ht.length;Ke--;)(me=_r[Ke])&&(Ht[Ke]=!(_e[Ke]=me))}):function(Ht,_e,we){return mt[0]=Ht,Nt(mt,null,we,Pt),mt[0]=null,!Pt.pop()}}),has:zr(function(tt){return function(mt){return 0<ze(tt,mt).length}}),contains:zr(function(tt){return tt=tt.replace(Yr,Bi),function(mt){return-1<(mt.textContent||T.text(mt)).indexOf(tt)}}),lang:zr(function(tt){return Fo.test(tt||"")||ze.error("unsupported lang: "+tt),tt=tt.replace(Yr,Bi).toLowerCase(),function(mt){var Pt;do if(Pt=ht?mt.lang:mt.getAttribute("xml:lang")||mt.getAttribute("lang"))return(Pt=Pt.toLowerCase())===tt||Pt.indexOf(tt+"-")===0;while((mt=mt.parentNode)&&mt.nodeType===1);return!1}}),target:function(tt){var mt=n.location&&n.location.hash;return mt&&mt.slice(1)===tt.id},root:function(tt){return tt===Y},focus:function(tt){return tt===function(){try{return q.activeElement}catch{}}()&&q.hasFocus()&&!!(tt.type||tt.href||~tt.tabIndex)},enabled:lo(!1),disabled:lo(!0),checked:function(tt){return ut(tt,"input")&&!!tt.checked||ut(tt,"option")&&!!tt.selected},selected:function(tt){return tt.parentNode&&tt.parentNode.selectedIndex,tt.selected===!0},empty:function(tt){for(tt=tt.firstChild;tt;tt=tt.nextSibling)if(tt.nodeType<6)return!1;return!0},parent:function(tt){return!S.pseudos.empty(tt)},header:function(tt){return hi.test(tt.nodeName)},input:function(tt){return ho.test(tt.nodeName)},button:function(tt){return ut(tt,"input")&&tt.type==="button"||ut(tt,"button")},text:function(tt){var mt;return ut(tt,"input")&&tt.type==="text"&&((mt=tt.getAttribute("type"))==null||mt.toLowerCase()==="text")},first:Bn(function(){return[0]}),last:Bn(function(tt,mt){return[mt-1]}),eq:Bn(function(tt,mt,Pt){return[Pt<0?Pt+mt:Pt]}),even:Bn(function(tt,mt){for(var Pt=0;Pt<mt;Pt+=2)tt.push(Pt);return tt}),odd:Bn(function(tt,mt){for(var Pt=1;Pt<mt;Pt+=2)tt.push(Pt);return tt}),lt:Bn(function(tt,mt,Pt){var Nt;for(Nt=Pt<0?Pt+mt:mt<Pt?mt:Pt;0<=--Nt;)tt.push(Nt);return tt}),gt:Bn(function(tt,mt,Pt){for(var Nt=Pt<0?Pt+mt:Pt;++Nt<mt;)tt.push(Nt);return tt})}}).pseudos.nth=S.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[v]=vn(v);for(v in{submit:!0,reset:!0})S.pseudos[v]=Ie(v);function Ss(){}function en(tt,mt){var Pt,Nt,Ht,_e,we,Te,me,_r=We[tt+" "];if(_r)return mt?0:_r.slice(0);for(we=tt,Te=[],me=S.preFilter;we;){for(_e in Pt&&!(Nt=Rr.exec(we))||(Nt&&(we=we.slice(Nt[0].length)||we),Te.push(Ht=[])),Pt=!1,(Nt=Gn.exec(we))&&(Pt=Nt.shift(),Ht.push({value:Pt,type:Nt[0].replace(rt," ")}),we=we.slice(Pt.length)),S.filter)!(Nt=Zn[_e].exec(we))||me[_e]&&!(Nt=me[_e](Nt))||(Pt=Nt.shift(),Ht.push({value:Pt,type:_e,matches:Nt}),we=we.slice(Pt.length));if(!Pt)break}return mt?we.length:we?ze.error(tt):We(tt,Te).slice(0)}function Zo(tt){for(var mt=0,Pt=tt.length,Nt="";mt<Pt;mt++)Nt+=tt[mt].value;return Nt}function mn(tt,mt,Pt){var Nt=mt.dir,Ht=mt.next,_e=Ht||Nt,we=Pt&&_e==="parentNode",Te=qt++;return mt.first?function(me,_r,Ke){for(;me=me[Nt];)if(me.nodeType===1||we)return tt(me,_r,Ke);return!1}:function(me,_r,Ke){var er,wr,ie=[Et,Te];if(Ke){for(;me=me[Nt];)if((me.nodeType===1||we)&&tt(me,_r,Ke))return!0}else for(;me=me[Nt];)if(me.nodeType===1||we)if(wr=me[jt]||(me[jt]={}),Ht&&ut(me,Ht))me=me[Nt]||me;else{if((er=wr[_e])&&er[0]===Et&&er[1]===Te)return ie[2]=er[2];if((wr[_e]=ie)[2]=tt(me,_r,Ke))return!0}return!1}}function es(tt){return 1<tt.length?function(mt,Pt,Nt){for(var Ht=tt.length;Ht--;)if(!tt[Ht](mt,Pt,Nt))return!1;return!0}:tt[0]}function On(tt,mt,Pt,Nt,Ht){for(var _e,we=[],Te=0,me=tt.length,_r=mt!=null;Te<me;Te++)(_e=tt[Te])&&(Pt&&!Pt(_e,Nt,Ht)||(we.push(_e),_r&&mt.push(Te)));return we}function mi(tt,mt,Pt,Nt,Ht,_e){return Nt&&!Nt[jt]&&(Nt=mi(Nt)),Ht&&!Ht[jt]&&(Ht=mi(Ht,_e)),zr(function(we,Te,me,_r){var Ke,er,wr,ie,ti=[],Ti=[],Si=Te.length,Yi=we||function(Zi,jr,an){for(var ji=0,zn=jr.length;ji<zn;ji++)ze(Zi,jr[ji],an);return an}(mt||"*",me.nodeType?[me]:me,[]),sn=!tt||!we&&mt?Yi:On(Yi,ti,tt,me,_r);if(Pt?Pt(sn,ie=Ht||(we?tt:Si||Nt)?[]:Te,me,_r):ie=sn,Nt)for(Ke=On(ie,Ti),Nt(Ke,[],me,_r),er=Ke.length;er--;)(wr=Ke[er])&&(ie[Ti[er]]=!(sn[Ti[er]]=wr));if(we){if(Ht||tt){if(Ht){for(Ke=[],er=ie.length;er--;)(wr=ie[er])&&Ke.push(sn[er]=wr);Ht(null,ie=[],Ke,_r)}for(er=ie.length;er--;)(wr=ie[er])&&-1<(Ke=Ht?x.call(we,wr):ti[er])&&(we[Ke]=!(Te[Ke]=wr))}}else ie=On(ie===Te?ie.splice(Si,ie.length):ie),Ht?Ht(null,Te,ie,_r):Tt.apply(Te,ie)})}function Es(tt){for(var mt,Pt,Nt,Ht=tt.length,_e=S.relative[tt[0].type],we=_e||S.relative[" "],Te=_e?1:0,me=mn(function(er){return er===mt},we,!0),_r=mn(function(er){return-1<x.call(mt,er)},we,!0),Ke=[function(er,wr,ie){var ti=!_e&&(ie||wr!=M)||((mt=wr).nodeType?me(er,wr,ie):_r(er,wr,ie));return mt=null,ti}];Te<Ht;Te++)if(Pt=S.relative[tt[Te].type])Ke=[mn(es(Ke),Pt)];else{if((Pt=S.filter[tt[Te].type].apply(null,tt[Te].matches))[jt]){for(Nt=++Te;Nt<Ht&&!S.relative[tt[Nt].type];Nt++);return mi(1<Te&&es(Ke),1<Te&&Zo(tt.slice(0,Te-1).concat({value:tt[Te-2].type===" "?"*":""})).replace(rt,"$1"),Pt,Te<Nt&&Es(tt.slice(Te,Nt)),Nt<Ht&&Es(tt=tt.slice(Nt)),Nt<Ht&&Zo(tt))}Ke.push(Pt)}return es(Ke)}function Do(tt,mt){var Pt,Nt,Ht,_e,we,Te,me=[],_r=[],Ke=Ze[tt+" "];if(!Ke){for(mt||(mt=en(tt)),Pt=mt.length;Pt--;)(Ke=Es(mt[Pt]))[jt]?me.push(Ke):_r.push(Ke);(Ke=Ze(tt,(Nt=_r,_e=0<(Ht=me).length,we=0<Nt.length,Te=function(er,wr,ie,ti,Ti){var Si,Yi,sn,Zi=0,jr="0",an=er&&[],ji=[],zn=M,xo=er||we&&S.find.TAG("*",Ti),Vi=Et+=zn==null?1:Math.random()||.1,$n=xo.length;for(Ti&&(M=wr==q||wr||Ti);jr!==$n&&(Si=xo[jr])!=null;jr++){if(we&&Si){for(Yi=0,wr||Si.ownerDocument==q||(io(Si),ie=!ht);sn=Nt[Yi++];)if(sn(Si,wr||q,ie)){Tt.call(ti,Si);break}Ti&&(Et=Vi)}_e&&((Si=!sn&&Si)&&Zi--,er&&an.push(Si))}if(Zi+=jr,_e&&jr!==Zi){for(Yi=0;sn=Ht[Yi++];)sn(an,ji,wr,ie);if(er){if(0<Zi)for(;jr--;)an[jr]||ji[jr]||(ji[jr]=ft.call(ti));ji=On(ji)}Tt.apply(ti,ji),Ti&&!er&&0<ji.length&&1<Zi+Ht.length&&T.uniqueSort(ti)}return Ti&&(Et=Vi,M=zn),an},_e?zr(Te):Te))).selector=tt}return Ke}function ia(tt,mt,Pt,Nt){var Ht,_e,we,Te,me,_r=typeof tt=="function"&&tt,Ke=!Nt&&en(tt=_r.selector||tt);if(Pt=Pt||[],Ke.length===1){if(2<(_e=Ke[0]=Ke[0].slice(0)).length&&(we=_e[0]).type==="ID"&&mt.nodeType===9&&ht&&S.relative[_e[1].type]){if(!(mt=(S.find.ID(we.matches[0].replace(Yr,Bi),mt)||[])[0]))return Pt;_r&&(mt=mt.parentNode),tt=tt.slice(_e.shift().value.length)}for(Ht=Zn.needsContext.test(tt)?0:_e.length;Ht--&&(we=_e[Ht],!S.relative[Te=we.type]);)if((me=S.find[Te])&&(Nt=me(we.matches[0].replace(Yr,Bi),bi.test(_e[0].type)&&bs(mt.parentNode)||mt))){if(_e.splice(Ht,1),!(tt=Nt.length&&Zo(_e)))return Tt.apply(Pt,Nt),Pt;break}}return(_r||Do(tt,Ke))(Nt,mt,!ht,Pt,!mt||bi.test(tt)&&bs(mt.parentNode)||mt),Pt}Ss.prototype=S.filters=S.pseudos,S.setFilters=new Ss,A.sortStable=jt.split("").sort(gi).join("")===jt,io(),A.sortDetached=qr(function(tt){return 1&tt.compareDocumentPosition(q.createElement("fieldset"))}),T.find=ze,T.expr[":"]=T.expr.pseudos,T.unique=T.uniqueSort,ze.compile=Do,ze.select=ia,ze.setDocument=io,ze.tokenize=en,ze.escape=T.escapeSelector,ze.getText=T.text,ze.isXML=T.isXMLDoc,ze.selectors=T.expr,ze.support=T.support,ze.uniqueSort=T.uniqueSort})();var Vt=function(v,S,M){for(var R=[],V=M!==void 0;(v=v[S])&&v.nodeType!==9;)if(v.nodeType===1){if(V&&T(v).is(M))break;R.push(v)}return R},Lt=function(v,S){for(var M=[];v;v=v.nextSibling)v.nodeType===1&&v!==S&&M.push(v);return M},Ne=T.expr.match.needsContext,ge=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Yt(v,S,M){return G(S)?T.grep(v,function(R,V){return!!S.call(R,V,R)!==M}):S.nodeType?T.grep(v,function(R){return R===S!==M}):typeof S!="string"?T.grep(v,function(R){return-1<x.call(S,R)!==M}):T.filter(S,v,M)}T.filter=function(v,S,M){var R=S[0];return M&&(v=":not("+v+")"),S.length===1&&R.nodeType===1?T.find.matchesSelector(R,v)?[R]:[]:T.find.matches(v,T.grep(S,function(V){return V.nodeType===1}))},T.fn.extend({find:function(v){var S,M,R=this.length,V=this;if(typeof v!="string")return this.pushStack(T(v).filter(function(){for(S=0;S<R;S++)if(T.contains(V[S],this))return!0}));for(M=this.pushStack([]),S=0;S<R;S++)T.find(v,V[S],M);return 1<R?T.uniqueSort(M):M},filter:function(v){return this.pushStack(Yt(this,v||[],!1))},not:function(v){return this.pushStack(Yt(this,v||[],!0))},is:function(v){return!!Yt(this,typeof v=="string"&&Ne.test(v)?T(v):v||[],!1).length}});var ue,ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(T.fn.init=function(v,S,M){var R,V;if(!v)return this;if(M=M||ue,typeof v=="string"){if(!(R=v[0]==="<"&&v[v.length-1]===">"&&3<=v.length?[null,v,null]:ne.exec(v))||!R[1]&&S)return!S||S.jquery?(S||M).find(v):this.constructor(S).find(v);if(R[1]){if(S=S instanceof T?S[0]:S,T.merge(this,T.parseHTML(R[1],S&&S.nodeType?S.ownerDocument||S:O,!0)),ge.test(R[1])&&T.isPlainObject(S))for(R in S)G(this[R])?this[R](S[R]):this.attr(R,S[R]);return this}return(V=O.getElementById(R[2]))&&(this[0]=V,this.length=1),this}return v.nodeType?(this[0]=v,this.length=1,this):G(v)?M.ready!==void 0?M.ready(v):v(T):T.makeArray(v,this)}).prototype=T.fn,ue=T(O);var dr=/^(?:parents|prev(?:Until|All))/,je={children:!0,contents:!0,next:!0,prev:!0};function Br(v,S){for(;(v=v[S])&&v.nodeType!==1;);return v}T.fn.extend({has:function(v){var S=T(v,this),M=S.length;return this.filter(function(){for(var R=0;R<M;R++)if(T.contains(this,S[R]))return!0})},closest:function(v,S){var M,R=0,V=this.length,q=[],Y=typeof v!="string"&&T(v);if(!Ne.test(v)){for(;R<V;R++)for(M=this[R];M&&M!==S;M=M.parentNode)if(M.nodeType<11&&(Y?-1<Y.index(M):M.nodeType===1&&T.find.matchesSelector(M,v))){q.push(M);break}}return this.pushStack(1<q.length?T.uniqueSort(q):q)},index:function(v){return v?typeof v=="string"?x.call(T(v),this[0]):x.call(this,v.jquery?v[0]:v):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(v,S){return this.pushStack(T.uniqueSort(T.merge(this.get(),T(v,S))))},addBack:function(v){return this.add(v==null?this.prevObject:this.prevObject.filter(v))}}),T.each({parent:function(v){var S=v.parentNode;return S&&S.nodeType!==11?S:null},parents:function(v){return Vt(v,"parentNode")},parentsUntil:function(v,S,M){return Vt(v,"parentNode",M)},next:function(v){return Br(v,"nextSibling")},prev:function(v){return Br(v,"previousSibling")},nextAll:function(v){return Vt(v,"nextSibling")},prevAll:function(v){return Vt(v,"previousSibling")},nextUntil:function(v,S,M){return Vt(v,"nextSibling",M)},prevUntil:function(v,S,M){return Vt(v,"previousSibling",M)},siblings:function(v){return Lt((v.parentNode||{}).firstChild,v)},children:function(v){return Lt(v.firstChild)},contents:function(v){return v.contentDocument!=null&&u(v.contentDocument)?v.contentDocument:(ut(v,"template")&&(v=v.content||v),T.merge([],v.childNodes))}},function(v,S){T.fn[v]=function(M,R){var V=T.map(this,S,M);return v.slice(-5)!=="Until"&&(R=M),R&&typeof R=="string"&&(V=T.filter(R,V)),1<this.length&&(je[v]||T.uniqueSort(V),dr.test(v)&&V.reverse()),this.pushStack(V)}});var Ue=/[^\x20\t\r\n\f]+/g;function Fe(v){return v}function Lr(v){throw v}function De(v,S,M,R){var V;try{v&&G(V=v.promise)?V.call(v).done(S).fail(M):v&&G(V=v.then)?V.call(v,S,M):S.apply(void 0,[v].slice(R))}catch(q){M.apply(void 0,[q])}}T.Callbacks=function(v){var S,M;v=typeof v=="string"?(S=v,M={},T.each(S.match(Ue)||[],function(Et,qt){M[qt]=!0}),M):T.extend({},v);var R,V,q,Y,ht=[],st=[],xt=-1,Tt=function(){for(Y=Y||v.once,q=R=!0;st.length;xt=-1)for(V=st.shift();++xt<ht.length;)ht[xt].apply(V[0],V[1])===!1&&v.stopOnFalse&&(xt=ht.length,V=!1);v.memory||(V=!1),R=!1,Y&&(ht=V?[]:"")},jt={add:function(){return ht&&(V&&!R&&(xt=ht.length-1,st.push(V)),function Et(qt){T.each(qt,function(be,We){G(We)?v.unique&&jt.has(We)||ht.push(We):We&&We.length&&et(We)!=="string"&&Et(We)})}(arguments),V&&!R&&Tt()),this},remove:function(){return T.each(arguments,function(Et,qt){for(var be;-1<(be=T.inArray(qt,ht,be));)ht.splice(be,1),be<=xt&&xt--}),this},has:function(Et){return Et?-1<T.inArray(Et,ht):0<ht.length},empty:function(){return ht&&(ht=[]),this},disable:function(){return Y=st=[],ht=V="",this},disabled:function(){return!ht},lock:function(){return Y=st=[],V||R||(ht=V=""),this},locked:function(){return!!Y},fireWith:function(Et,qt){return Y||(qt=[Et,(qt=qt||[]).slice?qt.slice():qt],st.push(qt),R||Tt()),this},fire:function(){return jt.fireWith(this,arguments),this},fired:function(){return!!q}};return jt},T.extend({Deferred:function(v){var S=[["notify","progress",T.Callbacks("memory"),T.Callbacks("memory"),2],["resolve","done",T.Callbacks("once memory"),T.Callbacks("once memory"),0,"resolved"],["reject","fail",T.Callbacks("once memory"),T.Callbacks("once memory"),1,"rejected"]],M="pending",R={state:function(){return M},always:function(){return V.done(arguments).fail(arguments),this},catch:function(q){return R.then(null,q)},pipe:function(){var q=arguments;return T.Deferred(function(Y){T.each(S,function(ht,st){var xt=G(q[st[4]])&&q[st[4]];V[st[1]](function(){var Tt=xt&&xt.apply(this,arguments);Tt&&G(Tt.promise)?Tt.promise().progress(Y.notify).done(Y.resolve).fail(Y.reject):Y[st[0]+"With"](this,xt?[Tt]:arguments)})}),q=null}).promise()},then:function(q,Y,ht){var st=0;function xt(Tt,jt,Et,qt){return function(){var be=this,We=arguments,Ze=function(){var gi,dn;if(!(Tt<st)){if((gi=Et.apply(be,We))===jt.promise())throw new TypeError("Thenable self-resolution");dn=gi&&(typeof gi=="object"||typeof gi=="function")&&gi.then,G(dn)?qt?dn.call(gi,xt(st,jt,Fe,qt),xt(st,jt,Lr,qt)):(st++,dn.call(gi,xt(st,jt,Fe,qt),xt(st,jt,Lr,qt),xt(st,jt,Fe,jt.notifyWith))):(Et!==Fe&&(be=void 0,We=[gi]),(qt||jt.resolveWith)(be,We))}},si=qt?Ze:function(){try{Ze()}catch(gi){T.Deferred.exceptionHook&&T.Deferred.exceptionHook(gi,si.error),st<=Tt+1&&(Et!==Lr&&(be=void 0,We=[gi]),jt.rejectWith(be,We))}};Tt?si():(T.Deferred.getErrorHook?si.error=T.Deferred.getErrorHook():T.Deferred.getStackHook&&(si.error=T.Deferred.getStackHook()),n.setTimeout(si))}}return T.Deferred(function(Tt){S[0][3].add(xt(0,Tt,G(ht)?ht:Fe,Tt.notifyWith)),S[1][3].add(xt(0,Tt,G(q)?q:Fe)),S[2][3].add(xt(0,Tt,G(Y)?Y:Lr))}).promise()},promise:function(q){return q!=null?T.extend(q,R):R}},V={};return T.each(S,function(q,Y){var ht=Y[2],st=Y[5];R[Y[1]]=ht.add,st&&ht.add(function(){M=st},S[3-q][2].disable,S[3-q][3].disable,S[0][2].lock,S[0][3].lock),ht.add(Y[3].fire),V[Y[0]]=function(){return V[Y[0]+"With"](this===V?void 0:this,arguments),this},V[Y[0]+"With"]=ht.fireWith}),R.promise(V),v&&v.call(V,V),V},when:function(v){var S=arguments.length,M=S,R=Array(M),V=d.call(arguments),q=T.Deferred(),Y=function(ht){return function(st){R[ht]=this,V[ht]=1<arguments.length?d.call(arguments):st,--S||q.resolveWith(R,V)}};if(S<=1&&(De(v,q.done(Y(M)).resolve,q.reject,!S),q.state()==="pending"||G(V[M]&&V[M].then)))return q.then();for(;M--;)De(V[M],Y(M),q.reject);return q.promise()}});var se=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;T.Deferred.exceptionHook=function(v,S){n.console&&n.console.warn&&v&&se.test(v.name)&&n.console.warn("jQuery.Deferred exception: "+v.message,v.stack,S)},T.readyException=function(v){n.setTimeout(function(){throw v})};var oe=T.Deferred();function Ar(){O.removeEventListener("DOMContentLoaded",Ar),n.removeEventListener("load",Ar),T.ready()}T.fn.ready=function(v){return oe.then(v).catch(function(S){T.readyException(S)}),this},T.extend({isReady:!1,readyWait:1,ready:function(v){(v===!0?--T.readyWait:T.isReady)||(T.isReady=!0)!==v&&0<--T.readyWait||oe.resolveWith(O,[T])}}),T.ready.then=oe.then,O.readyState==="complete"||O.readyState!=="loading"&&!O.documentElement.doScroll?n.setTimeout(T.ready):(O.addEventListener("DOMContentLoaded",Ar),n.addEventListener("load",Ar));var vr=function(v,S,M,R,V,q,Y){var ht=0,st=v.length,xt=M==null;if(et(M)==="object")for(ht in V=!0,M)vr(v,S,ht,M[ht],!0,q,Y);else if(R!==void 0&&(V=!0,G(R)||(Y=!0),xt&&(Y?(S.call(v,R),S=null):(xt=S,S=function(Tt,jt,Et){return xt.call(T(Tt),Et)})),S))for(;ht<st;ht++)S(v[ht],M,Y?R:R.call(v[ht],ht,S(v[ht],M)));return V?v:xt?S.call(v):st?S(v[0],M):q},Kr=/^-ms-/,wi=/-([a-z])/g;function Ee(v,S){return S.toUpperCase()}function Sr(v){return v.replace(Kr,"ms-").replace(wi,Ee)}var Or=function(v){return v.nodeType===1||v.nodeType===9||!+v.nodeType};function xn(){this.expando=T.expando+xn.uid++}xn.uid=1,xn.prototype={cache:function(v){var S=v[this.expando];return S||(S={},Or(v)&&(v.nodeType?v[this.expando]=S:Object.defineProperty(v,this.expando,{value:S,configurable:!0}))),S},set:function(v,S,M){var R,V=this.cache(v);if(typeof S=="string")V[Sr(S)]=M;else for(R in S)V[Sr(R)]=S[R];return V},get:function(v,S){return S===void 0?this.cache(v):v[this.expando]&&v[this.expando][Sr(S)]},access:function(v,S,M){return S===void 0||S&&typeof S=="string"&&M===void 0?this.get(v,S):(this.set(v,S,M),M!==void 0?M:S)},remove:function(v,S){var M,R=v[this.expando];if(R!==void 0){if(S!==void 0)for(M=(S=Array.isArray(S)?S.map(Sr):(S=Sr(S))in R?[S]:S.match(Ue)||[]).length;M--;)delete R[S[M]];(S===void 0||T.isEmptyObject(R))&&(v.nodeType?v[this.expando]=void 0:delete v[this.expando])}},hasData:function(v){var S=v[this.expando];return S!==void 0&&!T.isEmptyObject(S)}};var ye=new xn,oi=new xn,eo=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Xo=/[A-Z]/g;function Xn(v,S,M){var R,V;if(M===void 0&&v.nodeType===1)if(R="data-"+S.replace(Xo,"-$&").toLowerCase(),typeof(M=v.getAttribute(R))=="string"){try{M=(V=M)==="true"||V!=="false"&&(V==="null"?null:V===+V+""?+V:eo.test(V)?JSON.parse(V):V)}catch{}oi.set(v,S,M)}else M=void 0;return M}T.extend({hasData:function(v){return oi.hasData(v)||ye.hasData(v)},data:function(v,S,M){return oi.access(v,S,M)},removeData:function(v,S){oi.remove(v,S)},_data:function(v,S,M){return ye.access(v,S,M)},_removeData:function(v,S){ye.remove(v,S)}}),T.fn.extend({data:function(v,S){var M,R,V,q=this[0],Y=q&&q.attributes;if(v===void 0){if(this.length&&(V=oi.get(q),q.nodeType===1&&!ye.get(q,"hasDataAttrs"))){for(M=Y.length;M--;)Y[M]&&(R=Y[M].name).indexOf("data-")===0&&(R=Sr(R.slice(5)),Xn(q,R,V[R]));ye.set(q,"hasDataAttrs",!0)}return V}return typeof v=="object"?this.each(function(){oi.set(this,v)}):vr(this,function(ht){var st;if(q&&ht===void 0)return(st=oi.get(q,v))!==void 0||(st=Xn(q,v))!==void 0?st:void 0;this.each(function(){oi.set(this,v,ht)})},null,S,1<arguments.length,null,!0)},removeData:function(v){return this.each(function(){oi.remove(this,v)})}}),T.extend({queue:function(v,S,M){var R;if(v)return S=(S||"fx")+"queue",R=ye.get(v,S),M&&(!R||Array.isArray(M)?R=ye.access(v,S,T.makeArray(M)):R.push(M)),R||[]},dequeue:function(v,S){S=S||"fx";var M=T.queue(v,S),R=M.length,V=M.shift(),q=T._queueHooks(v,S);V==="inprogress"&&(V=M.shift(),R--),V&&(S==="fx"&&M.unshift("inprogress"),delete q.stop,V.call(v,function(){T.dequeue(v,S)},q)),!R&&q&&q.empty.fire()},_queueHooks:function(v,S){var M=S+"queueHooks";return ye.get(v,M)||ye.access(v,M,{empty:T.Callbacks("once memory").add(function(){ye.remove(v,[S+"queue",M])})})}}),T.fn.extend({queue:function(v,S){var M=2;return typeof v!="string"&&(S=v,v="fx",M--),arguments.length<M?T.queue(this[0],v):S===void 0?this:this.each(function(){var R=T.queue(this,v,S);T._queueHooks(this,v),v==="fx"&&R[0]!=="inprogress"&&T.dequeue(this,v)})},dequeue:function(v){return this.each(function(){T.dequeue(this,v)})},clearQueue:function(v){return this.queue(v||"fx",[])},promise:function(v,S){var M,R=1,V=T.Deferred(),q=this,Y=this.length,ht=function(){--R||V.resolveWith(q,[q])};for(typeof v!="string"&&(S=v,v=void 0),v=v||"fx";Y--;)(M=ye.get(q[Y],v+"queueHooks"))&&M.empty&&(R++,M.empty.add(ht));return ht(),V.promise(S)}});var cn=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ft=new RegExp("^(?:([+-])=|)("+cn+")([a-z%]*)$","i"),Ot=["Top","Right","Bottom","Left"],Kt=O.documentElement,ae=function(v){return T.contains(v.ownerDocument,v)},Ve={composed:!0};Kt.getRootNode&&(ae=function(v){return T.contains(v.ownerDocument,v)||v.getRootNode(Ve)===v.ownerDocument});var Be=function(v,S){return(v=S||v).style.display==="none"||v.style.display===""&&ae(v)&&T.css(v,"display")==="none"};function Er(v,S,M,R){var V,q,Y=20,ht=R?function(){return R.cur()}:function(){return T.css(v,S,"")},st=ht(),xt=M&&M[3]||(T.cssNumber[S]?"":"px"),Tt=v.nodeType&&(T.cssNumber[S]||xt!=="px"&&+st)&&Ft.exec(T.css(v,S));if(Tt&&Tt[3]!==xt){for(st/=2,xt=xt||Tt[3],Tt=+st||1;Y--;)T.style(v,S,Tt+xt),(1-q)*(1-(q=ht()/st||.5))<=0&&(Y=0),Tt/=q;Tt*=2,T.style(v,S,Tt+xt),M=M||[]}return M&&(Tt=+Tt||+st||0,V=M[1]?Tt+(M[1]+1)*M[2]:+M[2],R&&(R.unit=xt,R.start=Tt,R.end=V)),V}var br={};function Oe(v,S){for(var M,R,V,q,Y,ht,st,xt=[],Tt=0,jt=v.length;Tt<jt;Tt++)(R=v[Tt]).style&&(M=R.style.display,S?(M==="none"&&(xt[Tt]=ye.get(R,"display")||null,xt[Tt]||(R.style.display="")),R.style.display===""&&Be(R)&&(xt[Tt]=(st=Y=q=void 0,Y=(V=R).ownerDocument,ht=V.nodeName,(st=br[ht])||(q=Y.body.appendChild(Y.createElement(ht)),st=T.css(q,"display"),q.parentNode.removeChild(q),st==="none"&&(st="block"),br[ht]=st)))):M!=="none"&&(xt[Tt]="none",ye.set(R,"display",M)));for(Tt=0;Tt<jt;Tt++)xt[Tt]!=null&&(v[Tt].style.display=xt[Tt]);return v}T.fn.extend({show:function(){return Oe(this,!0)},hide:function(){return Oe(this)},toggle:function(v){return typeof v=="boolean"?v?this.show():this.hide():this.each(function(){Be(this)?T(this).show():T(this).hide()})}});var ur,ar,ot=/^(?:checkbox|radio)$/i,zt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Wt=/^$|^module$|\/(?:java|ecma)script/i;ur=O.createDocumentFragment().appendChild(O.createElement("div")),(ar=O.createElement("input")).setAttribute("type","radio"),ar.setAttribute("checked","checked"),ar.setAttribute("name","t"),ur.appendChild(ar),A.checkClone=ur.cloneNode(!0).cloneNode(!0).lastChild.checked,ur.innerHTML="<textarea>x</textarea>",A.noCloneChecked=!!ur.cloneNode(!0).lastChild.defaultValue,ur.innerHTML="<option></option>",A.option=!!ur.lastChild;var Ut={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(v,S){var M;return M=typeof v.getElementsByTagName<"u"?v.getElementsByTagName(S||"*"):typeof v.querySelectorAll<"u"?v.querySelectorAll(S||"*"):[],S===void 0||S&&ut(v,S)?T.merge([v],M):M}function Se(v,S){for(var M=0,R=v.length;M<R;M++)ye.set(v[M],"globalEval",!S||ye.get(S[M],"globalEval"))}Ut.tbody=Ut.tfoot=Ut.colgroup=Ut.caption=Ut.thead,Ut.th=Ut.td,A.option||(Ut.optgroup=Ut.option=[1,"<select multiple='multiple'>","</select>"]);var nr=/<|&#?\w+;/;function xr(v,S,M,R,V){for(var q,Y,ht,st,xt,Tt,jt=S.createDocumentFragment(),Et=[],qt=0,be=v.length;qt<be;qt++)if((q=v[qt])||q===0)if(et(q)==="object")T.merge(Et,q.nodeType?[q]:q);else if(nr.test(q)){for(Y=Y||jt.appendChild(S.createElement("div")),ht=(zt.exec(q)||["",""])[1].toLowerCase(),st=Ut[ht]||Ut._default,Y.innerHTML=st[1]+T.htmlPrefilter(q)+st[2],Tt=st[0];Tt--;)Y=Y.lastChild;T.merge(Et,Y.childNodes),(Y=jt.firstChild).textContent=""}else Et.push(S.createTextNode(q));for(jt.textContent="",qt=0;q=Et[qt++];)if(R&&-1<T.inArray(q,R))V&&V.push(q);else if(xt=ae(q),Y=ve(jt.appendChild(q),"script"),xt&&Se(Y),M)for(Tt=0;q=Y[Tt++];)Wt.test(q.type||"")&&M.push(q);return jt}var Me=/^([^.]*)(?:\.(.+)|)/;function ei(){return!0}function fr(){return!1}function Mr(v,S,M,R,V,q){var Y,ht;if(typeof S=="object"){for(ht in typeof M!="string"&&(R=R||M,M=void 0),S)Mr(v,ht,M,R,S[ht],q);return v}if(R==null&&V==null?(V=M,R=M=void 0):V==null&&(typeof M=="string"?(V=R,R=void 0):(V=R,R=M,M=void 0)),V===!1)V=fr;else if(!V)return v;return q===1&&(Y=V,(V=function(st){return T().off(st),Y.apply(this,arguments)}).guid=Y.guid||(Y.guid=T.guid++)),v.each(function(){T.event.add(this,S,V,R,M)})}function hr(v,S,M){M?(ye.set(v,S,!1),T.event.add(v,S,{namespace:!1,handler:function(R){var V,q=ye.get(this,S);if(1&R.isTrigger&&this[S]){if(q)(T.event.special[S]||{}).delegateType&&R.stopPropagation();else if(q=d.call(arguments),ye.set(this,S,q),this[S](),V=ye.get(this,S),ye.set(this,S,!1),q!==V)return R.stopImmediatePropagation(),R.preventDefault(),V}else q&&(ye.set(this,S,T.event.trigger(q[0],q.slice(1),this)),R.stopPropagation(),R.isImmediatePropagationStopped=ei)}})):ye.get(v,S)===void 0&&T.event.add(v,S,ei)}T.event={global:{},add:function(v,S,M,R,V){var q,Y,ht,st,xt,Tt,jt,Et,qt,be,We,Ze=ye.get(v);if(Or(v))for(M.handler&&(M=(q=M).handler,V=q.selector),V&&T.find.matchesSelector(Kt,V),M.guid||(M.guid=T.guid++),(st=Ze.events)||(st=Ze.events=Object.create(null)),(Y=Ze.handle)||(Y=Ze.handle=function(si){return typeof T<"u"&&T.event.triggered!==si.type?T.event.dispatch.apply(v,arguments):void 0}),xt=(S=(S||"").match(Ue)||[""]).length;xt--;)qt=We=(ht=Me.exec(S[xt])||[])[1],be=(ht[2]||"").split(".").sort(),qt&&(jt=T.event.special[qt]||{},qt=(V?jt.delegateType:jt.bindType)||qt,jt=T.event.special[qt]||{},Tt=T.extend({type:qt,origType:We,data:R,handler:M,guid:M.guid,selector:V,needsContext:V&&T.expr.match.needsContext.test(V),namespace:be.join(".")},q),(Et=st[qt])||((Et=st[qt]=[]).delegateCount=0,jt.setup&&jt.setup.call(v,R,be,Y)!==!1||v.addEventListener&&v.addEventListener(qt,Y)),jt.add&&(jt.add.call(v,Tt),Tt.handler.guid||(Tt.handler.guid=M.guid)),V?Et.splice(Et.delegateCount++,0,Tt):Et.push(Tt),T.event.global[qt]=!0)},remove:function(v,S,M,R,V){var q,Y,ht,st,xt,Tt,jt,Et,qt,be,We,Ze=ye.hasData(v)&&ye.get(v);if(Ze&&(st=Ze.events)){for(xt=(S=(S||"").match(Ue)||[""]).length;xt--;)if(qt=We=(ht=Me.exec(S[xt])||[])[1],be=(ht[2]||"").split(".").sort(),qt){for(jt=T.event.special[qt]||{},Et=st[qt=(R?jt.delegateType:jt.bindType)||qt]||[],ht=ht[2]&&new RegExp("(^|\\.)"+be.join("\\.(?:.*\\.|)")+"(\\.|$)"),Y=q=Et.length;q--;)Tt=Et[q],!V&&We!==Tt.origType||M&&M.guid!==Tt.guid||ht&&!ht.test(Tt.namespace)||R&&R!==Tt.selector&&(R!=="**"||!Tt.selector)||(Et.splice(q,1),Tt.selector&&Et.delegateCount--,jt.remove&&jt.remove.call(v,Tt));Y&&!Et.length&&(jt.teardown&&jt.teardown.call(v,be,Ze.handle)!==!1||T.removeEvent(v,qt,Ze.handle),delete st[qt])}else for(qt in st)T.event.remove(v,qt+S[xt],M,R,!0);T.isEmptyObject(st)&&ye.remove(v,"handle events")}},dispatch:function(v){var S,M,R,V,q,Y,ht=new Array(arguments.length),st=T.event.fix(v),xt=(ye.get(this,"events")||Object.create(null))[st.type]||[],Tt=T.event.special[st.type]||{};for(ht[0]=st,S=1;S<arguments.length;S++)ht[S]=arguments[S];if(st.delegateTarget=this,!Tt.preDispatch||Tt.preDispatch.call(this,st)!==!1){for(Y=T.event.handlers.call(this,st,xt),S=0;(V=Y[S++])&&!st.isPropagationStopped();)for(st.currentTarget=V.elem,M=0;(q=V.handlers[M++])&&!st.isImmediatePropagationStopped();)st.rnamespace&&q.namespace!==!1&&!st.rnamespace.test(q.namespace)||(st.handleObj=q,st.data=q.data,(R=((T.event.special[q.origType]||{}).handle||q.handler).apply(V.elem,ht))!==void 0&&(st.result=R)===!1&&(st.preventDefault(),st.stopPropagation()));return Tt.postDispatch&&Tt.postDispatch.call(this,st),st.result}},handlers:function(v,S){var M,R,V,q,Y,ht=[],st=S.delegateCount,xt=v.target;if(st&&xt.nodeType&&!(v.type==="click"&&1<=v.button)){for(;xt!==this;xt=xt.parentNode||this)if(xt.nodeType===1&&(v.type!=="click"||xt.disabled!==!0)){for(q=[],Y={},M=0;M<st;M++)Y[V=(R=S[M]).selector+" "]===void 0&&(Y[V]=R.needsContext?-1<T(V,this).index(xt):T.find(V,this,null,[xt]).length),Y[V]&&q.push(R);q.length&&ht.push({elem:xt,handlers:q})}}return xt=this,st<S.length&&ht.push({elem:xt,handlers:S.slice(st)}),ht},addProp:function(v,S){Object.defineProperty(T.Event.prototype,v,{enumerable:!0,configurable:!0,get:G(S)?function(){if(this.originalEvent)return S(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[v]},set:function(M){Object.defineProperty(this,v,{enumerable:!0,configurable:!0,writable:!0,value:M})}})},fix:function(v){return v[T.expando]?v:new T.Event(v)},special:{load:{noBubble:!0},click:{setup:function(v){var S=this||v;return ot.test(S.type)&&S.click&&ut(S,"input")&&hr(S,"click",!0),!1},trigger:function(v){var S=this||v;return ot.test(S.type)&&S.click&&ut(S,"input")&&hr(S,"click"),!0},_default:function(v){var S=v.target;return ot.test(S.type)&&S.click&&ut(S,"input")&&ye.get(S,"click")||ut(S,"a")}},beforeunload:{postDispatch:function(v){v.result!==void 0&&v.originalEvent&&(v.originalEvent.returnValue=v.result)}}}},T.removeEvent=function(v,S,M){v.removeEventListener&&v.removeEventListener(S,M)},T.Event=function(v,S){if(!(this instanceof T.Event))return new T.Event(v,S);v&&v.type?(this.originalEvent=v,this.type=v.type,this.isDefaultPrevented=v.defaultPrevented||v.defaultPrevented===void 0&&v.returnValue===!1?ei:fr,this.target=v.target&&v.target.nodeType===3?v.target.parentNode:v.target,this.currentTarget=v.currentTarget,this.relatedTarget=v.relatedTarget):this.type=v,S&&T.extend(this,S),this.timeStamp=v&&v.timeStamp||Date.now(),this[T.expando]=!0},T.Event.prototype={constructor:T.Event,isDefaultPrevented:fr,isPropagationStopped:fr,isImmediatePropagationStopped:fr,isSimulated:!1,preventDefault:function(){var v=this.originalEvent;this.isDefaultPrevented=ei,v&&!this.isSimulated&&v.preventDefault()},stopPropagation:function(){var v=this.originalEvent;this.isPropagationStopped=ei,v&&!this.isSimulated&&v.stopPropagation()},stopImmediatePropagation:function(){var v=this.originalEvent;this.isImmediatePropagationStopped=ei,v&&!this.isSimulated&&v.stopImmediatePropagation(),this.stopPropagation()}},T.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},T.event.addProp),T.each({focus:"focusin",blur:"focusout"},function(v,S){function M(R){if(O.documentMode){var V=ye.get(this,"handle"),q=T.event.fix(R);q.type=R.type==="focusin"?"focus":"blur",q.isSimulated=!0,V(R),q.target===q.currentTarget&&V(q)}else T.event.simulate(S,R.target,T.event.fix(R))}T.event.special[v]={setup:function(){var R;if(hr(this,v,!0),!O.documentMode)return!1;(R=ye.get(this,S))||this.addEventListener(S,M),ye.set(this,S,(R||0)+1)},trigger:function(){return hr(this,v),!0},teardown:function(){var R;if(!O.documentMode)return!1;(R=ye.get(this,S)-1)?ye.set(this,S,R):(this.removeEventListener(S,M),ye.remove(this,S))},_default:function(R){return ye.get(R.target,v)},delegateType:S},T.event.special[S]={setup:function(){var R=this.ownerDocument||this.document||this,V=O.documentMode?this:R,q=ye.get(V,S);q||(O.documentMode?this.addEventListener(S,M):R.addEventListener(v,M,!0)),ye.set(V,S,(q||0)+1)},teardown:function(){var R=this.ownerDocument||this.document||this,V=O.documentMode?this:R,q=ye.get(V,S)-1;q?ye.set(V,S,q):(O.documentMode?this.removeEventListener(S,M):R.removeEventListener(v,M,!0),ye.remove(V,S))}}}),T.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(v,S){T.event.special[v]={delegateType:S,bindType:S,handle:function(M){var R,V=M.relatedTarget,q=M.handleObj;return V&&(V===this||T.contains(this,V))||(M.type=q.origType,R=q.handler.apply(this,arguments),M.type=S),R}}}),T.fn.extend({on:function(v,S,M,R){return Mr(this,v,S,M,R)},one:function(v,S,M,R){return Mr(this,v,S,M,R,1)},off:function(v,S,M){var R,V;if(v&&v.preventDefault&&v.handleObj)return R=v.handleObj,T(v.delegateTarget).off(R.namespace?R.origType+"."+R.namespace:R.origType,R.selector,R.handler),this;if(typeof v=="object"){for(V in v)this.off(V,S,v[V]);return this}return S!==!1&&typeof S!="function"||(M=S,S=void 0),M===!1&&(M=fr),this.each(function(){T.event.remove(this,v,M,S)})}});var Vr=/<script|<style|<link/i,yi=/checked\s*(?:[^=]|=\s*.checked.)/i,Qr=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Fi(v,S){return ut(v,"table")&&ut(S.nodeType!==11?S:S.firstChild,"tr")&&T(v).children("tbody")[0]||v}function ro(v){return v.type=(v.getAttribute("type")!==null)+"/"+v.type,v}function Ln(v){return(v.type||"").slice(0,5)==="true/"?v.type=v.type.slice(5):v.removeAttribute("type"),v}function Di(v,S){var M,R,V,q,Y,ht;if(S.nodeType===1){if(ye.hasData(v)&&(ht=ye.get(v).events))for(V in ye.remove(S,"handle events"),ht)for(M=0,R=ht[V].length;M<R;M++)T.event.add(S,V,ht[V][M]);oi.hasData(v)&&(q=oi.access(v),Y=T.extend({},q),oi.set(S,Y))}}function un(v,S,M,R){S=m(S);var V,q,Y,ht,st,xt,Tt=0,jt=v.length,Et=jt-1,qt=S[0],be=G(qt);if(be||1<jt&&typeof qt=="string"&&!A.checkClone&&yi.test(qt))return v.each(function(We){var Ze=v.eq(We);be&&(S[0]=qt.call(this,We,Ze.html())),un(Ze,S,M,R)});if(jt&&(q=(V=xr(S,v[0].ownerDocument,!1,v,R)).firstChild,V.childNodes.length===1&&(V=q),q||R)){for(ht=(Y=T.map(ve(V,"script"),ro)).length;Tt<jt;Tt++)st=V,Tt!==Et&&(st=T.clone(st,!0,!0),ht&&T.merge(Y,ve(st,"script"))),M.call(v[Tt],st,Tt);if(ht)for(xt=Y[Y.length-1].ownerDocument,T.map(Y,Ln),Tt=0;Tt<ht;Tt++)st=Y[Tt],Wt.test(st.type||"")&&!ye.access(st,"globalEval")&&T.contains(xt,st)&&(st.src&&(st.type||"").toLowerCase()!=="module"?T._evalUrl&&!st.noModule&&T._evalUrl(st.src,{nonce:st.nonce||st.getAttribute("nonce")},xt):Q(st.textContent.replace(Qr,""),st,xt))}return v}function Mi(v,S,M){for(var R,V=S?T.filter(S,v):v,q=0;(R=V[q])!=null;q++)M||R.nodeType!==1||T.cleanData(ve(R)),R.parentNode&&(M&&ae(R)&&Se(ve(R,"script")),R.parentNode.removeChild(R));return v}T.extend({htmlPrefilter:function(v){return v},clone:function(v,S,M){var R,V,q,Y,ht,st,xt,Tt=v.cloneNode(!0),jt=ae(v);if(!(A.noCloneChecked||v.nodeType!==1&&v.nodeType!==11||T.isXMLDoc(v)))for(Y=ve(Tt),R=0,V=(q=ve(v)).length;R<V;R++)ht=q[R],st=Y[R],(xt=st.nodeName.toLowerCase())==="input"&&ot.test(ht.type)?st.checked=ht.checked:xt!=="input"&&xt!=="textarea"||(st.defaultValue=ht.defaultValue);if(S)if(M)for(q=q||ve(v),Y=Y||ve(Tt),R=0,V=q.length;R<V;R++)Di(q[R],Y[R]);else Di(v,Tt);return 0<(Y=ve(Tt,"script")).length&&Se(Y,!jt&&ve(v,"script")),Tt},cleanData:function(v){for(var S,M,R,V=T.event.special,q=0;(M=v[q])!==void 0;q++)if(Or(M)){if(S=M[ye.expando]){if(S.events)for(R in S.events)V[R]?T.event.remove(M,R):T.removeEvent(M,R,S.handle);M[ye.expando]=void 0}M[oi.expando]&&(M[oi.expando]=void 0)}}}),T.fn.extend({detach:function(v){return Mi(this,v,!0)},remove:function(v){return Mi(this,v)},text:function(v){return vr(this,function(S){return S===void 0?T.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=S)})},null,v,arguments.length)},append:function(){return un(this,arguments,function(v){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||Fi(this,v).appendChild(v)})},prepend:function(){return un(this,arguments,function(v){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var S=Fi(this,v);S.insertBefore(v,S.firstChild)}})},before:function(){return un(this,arguments,function(v){this.parentNode&&this.parentNode.insertBefore(v,this)})},after:function(){return un(this,arguments,function(v){this.parentNode&&this.parentNode.insertBefore(v,this.nextSibling)})},empty:function(){for(var v,S=0;(v=this[S])!=null;S++)v.nodeType===1&&(T.cleanData(ve(v,!1)),v.textContent="");return this},clone:function(v,S){return v=v!=null&&v,S=S??v,this.map(function(){return T.clone(this,v,S)})},html:function(v){return vr(this,function(S){var M=this[0]||{},R=0,V=this.length;if(S===void 0&&M.nodeType===1)return M.innerHTML;if(typeof S=="string"&&!Vr.test(S)&&!Ut[(zt.exec(S)||["",""])[1].toLowerCase()]){S=T.htmlPrefilter(S);try{for(;R<V;R++)(M=this[R]||{}).nodeType===1&&(T.cleanData(ve(M,!1)),M.innerHTML=S);M=0}catch{}}M&&this.empty().append(S)},null,v,arguments.length)},replaceWith:function(){var v=[];return un(this,arguments,function(S){var M=this.parentNode;T.inArray(this,v)<0&&(T.cleanData(ve(this)),M&&M.replaceChild(S,this))},v)}}),T.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(v,S){T.fn[v]=function(M){for(var R,V=[],q=T(M),Y=q.length-1,ht=0;ht<=Y;ht++)R=ht===Y?this:this.clone(!0),T(q[ht])[S](R),g.apply(V,R.get());return this.pushStack(V)}});var Qi=new RegExp("^("+cn+")(?!px)[a-z%]+$","i"),Qo=/^--/,ci=function(v){var S=v.ownerDocument.defaultView;return S&&S.opener||(S=n),S.getComputedStyle(v)},wn=function(v,S,M){var R,V,q={};for(V in S)q[V]=v.style[V],v.style[V]=S[V];for(V in R=M.call(v),S)v.style[V]=q[V];return R},vi=new RegExp(Ot.join("|"),"i");function Jr(v,S,M){var R,V,q,Y,ht=Qo.test(S),st=v.style;return(M=M||ci(v))&&(Y=M.getPropertyValue(S)||M[S],ht&&Y&&(Y=Y.replace(rt,"$1")||void 0),Y!==""||ae(v)||(Y=T.style(v,S)),!A.pixelBoxStyles()&&Qi.test(Y)&&vi.test(S)&&(R=st.width,V=st.minWidth,q=st.maxWidth,st.minWidth=st.maxWidth=st.width=Y,Y=M.width,st.width=R,st.minWidth=V,st.maxWidth=q)),Y!==void 0?Y+"":Y}function tn(v,S){return{get:function(){if(!v())return(this.get=S).apply(this,arguments);delete this.get}}}(function(){function v(){if(xt){st.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",xt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Kt.appendChild(st).appendChild(xt);var Tt=n.getComputedStyle(xt);M=Tt.top!=="1%",ht=S(Tt.marginLeft)===12,xt.style.right="60%",q=S(Tt.right)===36,R=S(Tt.width)===36,xt.style.position="absolute",V=S(xt.offsetWidth/3)===12,Kt.removeChild(st),xt=null}}function S(Tt){return Math.round(parseFloat(Tt))}var M,R,V,q,Y,ht,st=O.createElement("div"),xt=O.createElement("div");xt.style&&(xt.style.backgroundClip="content-box",xt.cloneNode(!0).style.backgroundClip="",A.clearCloneStyle=xt.style.backgroundClip==="content-box",T.extend(A,{boxSizingReliable:function(){return v(),R},pixelBoxStyles:function(){return v(),q},pixelPosition:function(){return v(),M},reliableMarginLeft:function(){return v(),ht},scrollboxSize:function(){return v(),V},reliableTrDimensions:function(){var Tt,jt,Et,qt;return Y==null&&(Tt=O.createElement("table"),jt=O.createElement("tr"),Et=O.createElement("div"),Tt.style.cssText="position:absolute;left:-11111px;border-collapse:separate",jt.style.cssText="box-sizing:content-box;border:1px solid",jt.style.height="1px",Et.style.height="9px",Et.style.display="block",Kt.appendChild(Tt).appendChild(jt).appendChild(Et),qt=n.getComputedStyle(jt),Y=parseInt(qt.height,10)+parseInt(qt.borderTopWidth,10)+parseInt(qt.borderBottomWidth,10)===jt.offsetHeight,Kt.removeChild(Tt)),Y}}))})();var gr=["Webkit","Moz","ms"],St=O.createElement("div").style,_i={};function Wr(v){var S=T.cssProps[v]||_i[v];return S||(v in St?v:_i[v]=function(M){for(var R=M[0].toUpperCase()+M.slice(1),V=gr.length;V--;)if((M=gr[V]+R)in St)return M}(v)||v)}var Vs=/^(none|table(?!-c[ea]).+)/,In={position:"absolute",visibility:"hidden",display:"block"},qi={letterSpacing:"0",fontWeight:"400"};function vo(v,S,M){var R=Ft.exec(S);return R?Math.max(0,R[2]-(M||0))+(R[3]||"px"):S}function xi(v,S,M,R,V,q){var Y=S==="width"?1:0,ht=0,st=0,xt=0;if(M===(R?"border":"content"))return 0;for(;Y<4;Y+=2)M==="margin"&&(xt+=T.css(v,M+Ot[Y],!0,V)),R?(M==="content"&&(st-=T.css(v,"padding"+Ot[Y],!0,V)),M!=="margin"&&(st-=T.css(v,"border"+Ot[Y]+"Width",!0,V))):(st+=T.css(v,"padding"+Ot[Y],!0,V),M!=="padding"?st+=T.css(v,"border"+Ot[Y]+"Width",!0,V):ht+=T.css(v,"border"+Ot[Y]+"Width",!0,V));return!R&&0<=q&&(st+=Math.max(0,Math.ceil(v["offset"+S[0].toUpperCase()+S.slice(1)]-q-st-ht-.5))||0),st+xt}function Ei(v,S,M){var R=ci(v),V=(!A.boxSizingReliable()||M)&&T.css(v,"boxSizing",!1,R)==="border-box",q=V,Y=Jr(v,S,R),ht="offset"+S[0].toUpperCase()+S.slice(1);if(Qi.test(Y)){if(!M)return Y;Y="auto"}return(!A.boxSizingReliable()&&V||!A.reliableTrDimensions()&&ut(v,"tr")||Y==="auto"||!parseFloat(Y)&&T.css(v,"display",!1,R)==="inline")&&v.getClientRects().length&&(V=T.css(v,"boxSizing",!1,R)==="border-box",(q=ht in v)&&(Y=v[ht])),(Y=parseFloat(Y)||0)+xi(v,S,M||(V?"border":"content"),q,R,Y)+"px"}function hn(v,S,M,R,V){return new hn.prototype.init(v,S,M,R,V)}T.extend({cssHooks:{opacity:{get:function(v,S){if(S){var M=Jr(v,"opacity");return M===""?"1":M}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(v,S,M,R){if(v&&v.nodeType!==3&&v.nodeType!==8&&v.style){var V,q,Y,ht=Sr(S),st=Qo.test(S),xt=v.style;if(st||(S=Wr(ht)),Y=T.cssHooks[S]||T.cssHooks[ht],M===void 0)return Y&&"get"in Y&&(V=Y.get(v,!1,R))!==void 0?V:xt[S];(q=typeof M)=="string"&&(V=Ft.exec(M))&&V[1]&&(M=Er(v,S,V),q="number"),M!=null&&M==M&&(q!=="number"||st||(M+=V&&V[3]||(T.cssNumber[ht]?"":"px")),A.clearCloneStyle||M!==""||S.indexOf("background")!==0||(xt[S]="inherit"),Y&&"set"in Y&&(M=Y.set(v,M,R))===void 0||(st?xt.setProperty(S,M):xt[S]=M))}},css:function(v,S,M,R){var V,q,Y,ht=Sr(S);return Qo.test(S)||(S=Wr(ht)),(Y=T.cssHooks[S]||T.cssHooks[ht])&&"get"in Y&&(V=Y.get(v,!0,M)),V===void 0&&(V=Jr(v,S,R)),V==="normal"&&S in qi&&(V=qi[S]),M===""||M?(q=parseFloat(V),M===!0||isFinite(q)?q||0:V):V}}),T.each(["height","width"],function(v,S){T.cssHooks[S]={get:function(M,R,V){if(R)return!Vs.test(T.css(M,"display"))||M.getClientRects().length&&M.getBoundingClientRect().width?Ei(M,S,V):wn(M,In,function(){return Ei(M,S,V)})},set:function(M,R,V){var q,Y=ci(M),ht=!A.scrollboxSize()&&Y.position==="absolute",st=(ht||V)&&T.css(M,"boxSizing",!1,Y)==="border-box",xt=V?xi(M,S,V,st,Y):0;return st&&ht&&(xt-=Math.ceil(M["offset"+S[0].toUpperCase()+S.slice(1)]-parseFloat(Y[S])-xi(M,S,"border",!1,Y)-.5)),xt&&(q=Ft.exec(R))&&(q[3]||"px")!=="px"&&(M.style[S]=R,R=T.css(M,S)),vo(0,R,xt)}}}),T.cssHooks.marginLeft=tn(A.reliableMarginLeft,function(v,S){if(S)return(parseFloat(Jr(v,"marginLeft"))||v.getBoundingClientRect().left-wn(v,{marginLeft:0},function(){return v.getBoundingClientRect().left}))+"px"}),T.each({margin:"",padding:"",border:"Width"},function(v,S){T.cssHooks[v+S]={expand:function(M){for(var R=0,V={},q=typeof M=="string"?M.split(" "):[M];R<4;R++)V[v+Ot[R]+S]=q[R]||q[R-2]||q[0];return V}},v!=="margin"&&(T.cssHooks[v+S].set=vo)}),T.fn.extend({css:function(v,S){return vr(this,function(M,R,V){var q,Y,ht={},st=0;if(Array.isArray(R)){for(q=ci(M),Y=R.length;st<Y;st++)ht[R[st]]=T.css(M,R[st],!1,q);return ht}return V!==void 0?T.style(M,R,V):T.css(M,R)},v,S,1<arguments.length)}}),((T.Tween=hn).prototype={constructor:hn,init:function(v,S,M,R,V,q){this.elem=v,this.prop=M,this.easing=V||T.easing._default,this.options=S,this.start=this.now=this.cur(),this.end=R,this.unit=q||(T.cssNumber[M]?"":"px")},cur:function(){var v=hn.propHooks[this.prop];return v&&v.get?v.get(this):hn.propHooks._default.get(this)},run:function(v){var S,M=hn.propHooks[this.prop];return this.options.duration?this.pos=S=T.easing[this.easing](v,this.options.duration*v,0,1,this.options.duration):this.pos=S=v,this.now=(this.end-this.start)*S+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),M&&M.set?M.set(this):hn.propHooks._default.set(this),this}}).init.prototype=hn.prototype,(hn.propHooks={_default:{get:function(v){var S;return v.elem.nodeType!==1||v.elem[v.prop]!=null&&v.elem.style[v.prop]==null?v.elem[v.prop]:(S=T.css(v.elem,v.prop,""))&&S!=="auto"?S:0},set:function(v){T.fx.step[v.prop]?T.fx.step[v.prop](v):v.elem.nodeType!==1||!T.cssHooks[v.prop]&&v.elem.style[Wr(v.prop)]==null?v.elem[v.prop]=v.now:T.style(v.elem,v.prop,v.now+v.unit)}}}).scrollTop=hn.propHooks.scrollLeft={set:function(v){v.elem.nodeType&&v.elem.parentNode&&(v.elem[v.prop]=v.now)}},T.easing={linear:function(v){return v},swing:function(v){return .5-Math.cos(v*Math.PI)/2},_default:"swing"},T.fx=hn.prototype.init,T.fx.step={};var Mn,bt,Gt,At,Qt=/^(?:toggle|show|hide)$/,le=/queueHooks$/;function re(){bt&&(O.hidden===!1&&n.requestAnimationFrame?n.requestAnimationFrame(re):n.setTimeout(re,T.fx.interval),T.fx.tick())}function Pe(){return n.setTimeout(function(){Mn=void 0}),Mn=Date.now()}function Ce(v,S){var M,R=0,V={height:v};for(S=S?1:0;R<4;R+=2-S)V["margin"+(M=Ot[R])]=V["padding"+M]=v;return S&&(V.opacity=V.width=v),V}function Xe(v,S,M){for(var R,V=(Ae.tweeners[S]||[]).concat(Ae.tweeners["*"]),q=0,Y=V.length;q<Y;q++)if(R=V[q].call(M,S,v))return R}function Ae(v,S,M){var R,V,q=0,Y=Ae.prefilters.length,ht=T.Deferred().always(function(){delete st.elem}),st=function(){if(V)return!1;for(var jt=Mn||Pe(),Et=Math.max(0,xt.startTime+xt.duration-jt),qt=1-(Et/xt.duration||0),be=0,We=xt.tweens.length;be<We;be++)xt.tweens[be].run(qt);return ht.notifyWith(v,[xt,qt,Et]),qt<1&&We?Et:(We||ht.notifyWith(v,[xt,1,0]),ht.resolveWith(v,[xt]),!1)},xt=ht.promise({elem:v,props:T.extend({},S),opts:T.extend(!0,{specialEasing:{},easing:T.easing._default},M),originalProperties:S,originalOptions:M,startTime:Mn||Pe(),duration:M.duration,tweens:[],createTween:function(jt,Et){var qt=T.Tween(v,xt.opts,jt,Et,xt.opts.specialEasing[jt]||xt.opts.easing);return xt.tweens.push(qt),qt},stop:function(jt){var Et=0,qt=jt?xt.tweens.length:0;if(V)return this;for(V=!0;Et<qt;Et++)xt.tweens[Et].run(1);return jt?(ht.notifyWith(v,[xt,1,0]),ht.resolveWith(v,[xt,jt])):ht.rejectWith(v,[xt,jt]),this}}),Tt=xt.props;for(!function(jt,Et){var qt,be,We,Ze,si;for(qt in jt)if(We=Et[be=Sr(qt)],Ze=jt[qt],Array.isArray(Ze)&&(We=Ze[1],Ze=jt[qt]=Ze[0]),qt!==be&&(jt[be]=Ze,delete jt[qt]),(si=T.cssHooks[be])&&"expand"in si)for(qt in Ze=si.expand(Ze),delete jt[be],Ze)qt in jt||(jt[qt]=Ze[qt],Et[qt]=We);else Et[be]=We}(Tt,xt.opts.specialEasing);q<Y;q++)if(R=Ae.prefilters[q].call(xt,v,Tt,xt.opts))return G(R.stop)&&(T._queueHooks(xt.elem,xt.opts.queue).stop=R.stop.bind(R)),R;return T.map(Tt,Xe,xt),G(xt.opts.start)&&xt.opts.start.call(v,xt),xt.progress(xt.opts.progress).done(xt.opts.done,xt.opts.complete).fail(xt.opts.fail).always(xt.opts.always),T.fx.timer(T.extend(st,{elem:v,anim:xt,queue:xt.opts.queue})),xt}T.Animation=T.extend(Ae,{tweeners:{"*":[function(v,S){var M=this.createTween(v,S);return Er(M.elem,v,Ft.exec(S),M),M}]},tweener:function(v,S){G(v)?(S=v,v=["*"]):v=v.match(Ue);for(var M,R=0,V=v.length;R<V;R++)M=v[R],Ae.tweeners[M]=Ae.tweeners[M]||[],Ae.tweeners[M].unshift(S)},prefilters:[function(v,S,M){var R,V,q,Y,ht,st,xt,Tt,jt="width"in S||"height"in S,Et=this,qt={},be=v.style,We=v.nodeType&&Be(v),Ze=ye.get(v,"fxshow");for(R in M.queue||((Y=T._queueHooks(v,"fx")).unqueued==null&&(Y.unqueued=0,ht=Y.empty.fire,Y.empty.fire=function(){Y.unqueued||ht()}),Y.unqueued++,Et.always(function(){Et.always(function(){Y.unqueued--,T.queue(v,"fx").length||Y.empty.fire()})})),S)if(V=S[R],Qt.test(V)){if(delete S[R],q=q||V==="toggle",V===(We?"hide":"show")){if(V!=="show"||!Ze||Ze[R]===void 0)continue;We=!0}qt[R]=Ze&&Ze[R]||T.style(v,R)}if((st=!T.isEmptyObject(S))||!T.isEmptyObject(qt))for(R in jt&&v.nodeType===1&&(M.overflow=[be.overflow,be.overflowX,be.overflowY],(xt=Ze&&Ze.display)==null&&(xt=ye.get(v,"display")),(Tt=T.css(v,"display"))==="none"&&(xt?Tt=xt:(Oe([v],!0),xt=v.style.display||xt,Tt=T.css(v,"display"),Oe([v]))),(Tt==="inline"||Tt==="inline-block"&&xt!=null)&&T.css(v,"float")==="none"&&(st||(Et.done(function(){be.display=xt}),xt==null&&(Tt=be.display,xt=Tt==="none"?"":Tt)),be.display="inline-block")),M.overflow&&(be.overflow="hidden",Et.always(function(){be.overflow=M.overflow[0],be.overflowX=M.overflow[1],be.overflowY=M.overflow[2]})),st=!1,qt)st||(Ze?"hidden"in Ze&&(We=Ze.hidden):Ze=ye.access(v,"fxshow",{display:xt}),q&&(Ze.hidden=!We),We&&Oe([v],!0),Et.done(function(){for(R in We||Oe([v]),ye.remove(v,"fxshow"),qt)T.style(v,R,qt[R])})),st=Xe(We?Ze[R]:0,R,Et),R in Ze||(Ze[R]=st.start,We&&(st.end=st.start,st.start=0))}],prefilter:function(v,S){S?Ae.prefilters.unshift(v):Ae.prefilters.push(v)}}),T.speed=function(v,S,M){var R=v&&typeof v=="object"?T.extend({},v):{complete:M||!M&&S||G(v)&&v,duration:v,easing:M&&S||S&&!G(S)&&S};return T.fx.off?R.duration=0:typeof R.duration!="number"&&(R.duration in T.fx.speeds?R.duration=T.fx.speeds[R.duration]:R.duration=T.fx.speeds._default),R.queue!=null&&R.queue!==!0||(R.queue="fx"),R.old=R.complete,R.complete=function(){G(R.old)&&R.old.call(this),R.queue&&T.dequeue(this,R.queue)},R},T.fn.extend({fadeTo:function(v,S,M,R){return this.filter(Be).css("opacity",0).show().end().animate({opacity:S},v,M,R)},animate:function(v,S,M,R){var V=T.isEmptyObject(v),q=T.speed(S,M,R),Y=function(){var ht=Ae(this,T.extend({},v),q);(V||ye.get(this,"finish"))&&ht.stop(!0)};return Y.finish=Y,V||q.queue===!1?this.each(Y):this.queue(q.queue,Y)},stop:function(v,S,M){var R=function(V){var q=V.stop;delete V.stop,q(M)};return typeof v!="string"&&(M=S,S=v,v=void 0),S&&this.queue(v||"fx",[]),this.each(function(){var V=!0,q=v!=null&&v+"queueHooks",Y=T.timers,ht=ye.get(this);if(q)ht[q]&&ht[q].stop&&R(ht[q]);else for(q in ht)ht[q]&&ht[q].stop&&le.test(q)&&R(ht[q]);for(q=Y.length;q--;)Y[q].elem!==this||v!=null&&Y[q].queue!==v||(Y[q].anim.stop(M),V=!1,Y.splice(q,1));!V&&M||T.dequeue(this,v)})},finish:function(v){return v!==!1&&(v=v||"fx"),this.each(function(){var S,M=ye.get(this),R=M[v+"queue"],V=M[v+"queueHooks"],q=T.timers,Y=R?R.length:0;for(M.finish=!0,T.queue(this,v,[]),V&&V.stop&&V.stop.call(this,!0),S=q.length;S--;)q[S].elem===this&&q[S].queue===v&&(q[S].anim.stop(!0),q.splice(S,1));for(S=0;S<Y;S++)R[S]&&R[S].finish&&R[S].finish.call(this);delete M.finish})}}),T.each(["toggle","show","hide"],function(v,S){var M=T.fn[S];T.fn[S]=function(R,V,q){return R==null||typeof R=="boolean"?M.apply(this,arguments):this.animate(Ce(S,!0),R,V,q)}}),T.each({slideDown:Ce("show"),slideUp:Ce("hide"),slideToggle:Ce("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(v,S){T.fn[v]=function(M,R,V){return this.animate(S,M,R,V)}}),T.timers=[],T.fx.tick=function(){var v,S=0,M=T.timers;for(Mn=Date.now();S<M.length;S++)(v=M[S])()||M[S]!==v||M.splice(S--,1);M.length||T.fx.stop(),Mn=void 0},T.fx.timer=function(v){T.timers.push(v),T.fx.start()},T.fx.interval=13,T.fx.start=function(){bt||(bt=!0,re())},T.fx.stop=function(){bt=null},T.fx.speeds={slow:600,fast:200,_default:400},T.fn.delay=function(v,S){return v=T.fx&&T.fx.speeds[v]||v,S=S||"fx",this.queue(S,function(M,R){var V=n.setTimeout(M,v);R.stop=function(){n.clearTimeout(V)}})},Gt=O.createElement("input"),At=O.createElement("select").appendChild(O.createElement("option")),Gt.type="checkbox",A.checkOn=Gt.value!=="",A.optSelected=At.selected,(Gt=O.createElement("input")).value="t",Gt.type="radio",A.radioValue=Gt.value==="t";var ke,lr=T.expr.attrHandle;T.fn.extend({attr:function(v,S){return vr(this,T.attr,v,S,1<arguments.length)},removeAttr:function(v){return this.each(function(){T.removeAttr(this,v)})}}),T.extend({attr:function(v,S,M){var R,V,q=v.nodeType;if(q!==3&&q!==8&&q!==2)return typeof v.getAttribute>"u"?T.prop(v,S,M):(q===1&&T.isXMLDoc(v)||(V=T.attrHooks[S.toLowerCase()]||(T.expr.match.bool.test(S)?ke:void 0)),M!==void 0?M===null?void T.removeAttr(v,S):V&&"set"in V&&(R=V.set(v,M,S))!==void 0?R:(v.setAttribute(S,M+""),M):V&&"get"in V&&(R=V.get(v,S))!==null?R:(R=T.find.attr(v,S))==null?void 0:R)},attrHooks:{type:{set:function(v,S){if(!A.radioValue&&S==="radio"&&ut(v,"input")){var M=v.value;return v.setAttribute("type",S),M&&(v.value=M),S}}}},removeAttr:function(v,S){var M,R=0,V=S&&S.match(Ue);if(V&&v.nodeType===1)for(;M=V[R++];)v.removeAttribute(M)}}),ke={set:function(v,S,M){return S===!1?T.removeAttr(v,M):v.setAttribute(M,M),M}},T.each(T.expr.match.bool.source.match(/\w+/g),function(v,S){var M=lr[S]||T.find.attr;lr[S]=function(R,V,q){var Y,ht,st=V.toLowerCase();return q||(ht=lr[st],lr[st]=Y,Y=M(R,V,q)!=null?st:null,lr[st]=ht),Y}});var mr=/^(?:input|select|textarea|button)$/i,Fr=/^(?:a|area)$/i;function Ur(v){return(v.match(Ue)||[]).join(" ")}function ui(v){return v.getAttribute&&v.getAttribute("class")||""}function nn(v){return Array.isArray(v)?v:typeof v=="string"&&v.match(Ue)||[]}T.fn.extend({prop:function(v,S){return vr(this,T.prop,v,S,1<arguments.length)},removeProp:function(v){return this.each(function(){delete this[T.propFix[v]||v]})}}),T.extend({prop:function(v,S,M){var R,V,q=v.nodeType;if(q!==3&&q!==8&&q!==2)return q===1&&T.isXMLDoc(v)||(S=T.propFix[S]||S,V=T.propHooks[S]),M!==void 0?V&&"set"in V&&(R=V.set(v,M,S))!==void 0?R:v[S]=M:V&&"get"in V&&(R=V.get(v,S))!==null?R:v[S]},propHooks:{tabIndex:{get:function(v){var S=T.find.attr(v,"tabindex");return S?parseInt(S,10):mr.test(v.nodeName)||Fr.test(v.nodeName)&&v.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),A.optSelected||(T.propHooks.selected={get:function(v){var S=v.parentNode;return S&&S.parentNode&&S.parentNode.selectedIndex,null},set:function(v){var S=v.parentNode;S&&(S.selectedIndex,S.parentNode&&S.parentNode.selectedIndex)}}),T.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){T.propFix[this.toLowerCase()]=this}),T.fn.extend({addClass:function(v){var S,M,R,V,q,Y;return G(v)?this.each(function(ht){T(this).addClass(v.call(this,ht,ui(this)))}):(S=nn(v)).length?this.each(function(){if(R=ui(this),M=this.nodeType===1&&" "+Ur(R)+" "){for(q=0;q<S.length;q++)V=S[q],M.indexOf(" "+V+" ")<0&&(M+=V+" ");Y=Ur(M),R!==Y&&this.setAttribute("class",Y)}}):this},removeClass:function(v){var S,M,R,V,q,Y;return G(v)?this.each(function(ht){T(this).removeClass(v.call(this,ht,ui(this)))}):arguments.length?(S=nn(v)).length?this.each(function(){if(R=ui(this),M=this.nodeType===1&&" "+Ur(R)+" "){for(q=0;q<S.length;q++)for(V=S[q];-1<M.indexOf(" "+V+" ");)M=M.replace(" "+V+" "," ");Y=Ur(M),R!==Y&&this.setAttribute("class",Y)}}):this:this.attr("class","")},toggleClass:function(v,S){var M,R,V,q,Y=typeof v,ht=Y==="string"||Array.isArray(v);return G(v)?this.each(function(st){T(this).toggleClass(v.call(this,st,ui(this),S),S)}):typeof S=="boolean"&&ht?S?this.addClass(v):this.removeClass(v):(M=nn(v),this.each(function(){if(ht)for(q=T(this),V=0;V<M.length;V++)R=M[V],q.hasClass(R)?q.removeClass(R):q.addClass(R);else v!==void 0&&Y!=="boolean"||((R=ui(this))&&ye.set(this,"__className__",R),this.setAttribute&&this.setAttribute("class",R||v===!1?"":ye.get(this,"__className__")||""))}))},hasClass:function(v){var S,M,R=0;for(S=" "+v+" ";M=this[R++];)if(M.nodeType===1&&-1<(" "+Ur(ui(M))+" ").indexOf(S))return!0;return!1}});var pn=/\r/g;T.fn.extend({val:function(v){var S,M,R,V=this[0];return arguments.length?(R=G(v),this.each(function(q){var Y;this.nodeType===1&&((Y=R?v.call(this,q,T(this).val()):v)==null?Y="":typeof Y=="number"?Y+="":Array.isArray(Y)&&(Y=T.map(Y,function(ht){return ht==null?"":ht+""})),(S=T.valHooks[this.type]||T.valHooks[this.nodeName.toLowerCase()])&&"set"in S&&S.set(this,Y,"value")!==void 0||(this.value=Y))})):V?(S=T.valHooks[V.type]||T.valHooks[V.nodeName.toLowerCase()])&&"get"in S&&(M=S.get(V,"value"))!==void 0?M:typeof(M=V.value)=="string"?M.replace(pn,""):M??"":void 0}}),T.extend({valHooks:{option:{get:function(v){var S=T.find.attr(v,"value");return S??Ur(T.text(v))}},select:{get:function(v){var S,M,R,V=v.options,q=v.selectedIndex,Y=v.type==="select-one",ht=Y?null:[],st=Y?q+1:V.length;for(R=q<0?st:Y?q:0;R<st;R++)if(((M=V[R]).selected||R===q)&&!M.disabled&&(!M.parentNode.disabled||!ut(M.parentNode,"optgroup"))){if(S=T(M).val(),Y)return S;ht.push(S)}return ht},set:function(v,S){for(var M,R,V=v.options,q=T.makeArray(S),Y=V.length;Y--;)((R=V[Y]).selected=-1<T.inArray(T.valHooks.option.get(R),q))&&(M=!0);return M||(v.selectedIndex=-1),q}}}}),T.each(["radio","checkbox"],function(){T.valHooks[this]={set:function(v,S){if(Array.isArray(S))return v.checked=-1<T.inArray(T(v).val(),S)}},A.checkOn||(T.valHooks[this].get=function(v){return v.getAttribute("value")===null?"on":v.value})});var Co=n.location,Us={guid:Date.now()},Wn=/\?/;T.parseXML=function(v){var S,M;if(!v||typeof v!="string")return null;try{S=new n.DOMParser().parseFromString(v,"text/xml")}catch{}return M=S&&S.getElementsByTagName("parsererror")[0],S&&!M||T.error("Invalid XML: "+(M?T.map(M.childNodes,function(R){return R.textContent}).join(`
`):v)),S};var En=/^(?:focusinfocus|focusoutblur)$/,ao=function(v){v.stopPropagation()};T.extend(T.event,{trigger:function(v,S,M,R){var V,q,Y,ht,st,xt,Tt,jt,Et=[M||O],qt=L.call(v,"type")?v.type:v,be=L.call(v,"namespace")?v.namespace.split("."):[];if(q=jt=Y=M=M||O,M.nodeType!==3&&M.nodeType!==8&&!En.test(qt+T.event.triggered)&&(-1<qt.indexOf(".")&&(qt=(be=qt.split(".")).shift(),be.sort()),st=qt.indexOf(":")<0&&"on"+qt,(v=v[T.expando]?v:new T.Event(qt,typeof v=="object"&&v)).isTrigger=R?2:3,v.namespace=be.join("."),v.rnamespace=v.namespace?new RegExp("(^|\\.)"+be.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,v.result=void 0,v.target||(v.target=M),S=S==null?[v]:T.makeArray(S,[v]),Tt=T.event.special[qt]||{},R||!Tt.trigger||Tt.trigger.apply(M,S)!==!1)){if(!R&&!Tt.noBubble&&!B(M)){for(ht=Tt.delegateType||qt,En.test(ht+qt)||(q=q.parentNode);q;q=q.parentNode)Et.push(q),Y=q;Y===(M.ownerDocument||O)&&Et.push(Y.defaultView||Y.parentWindow||n)}for(V=0;(q=Et[V++])&&!v.isPropagationStopped();)jt=q,v.type=1<V?ht:Tt.bindType||qt,(xt=(ye.get(q,"events")||Object.create(null))[v.type]&&ye.get(q,"handle"))&&xt.apply(q,S),(xt=st&&q[st])&&xt.apply&&Or(q)&&(v.result=xt.apply(q,S),v.result===!1&&v.preventDefault());return v.type=qt,R||v.isDefaultPrevented()||Tt._default&&Tt._default.apply(Et.pop(),S)!==!1||!Or(M)||st&&G(M[qt])&&!B(M)&&((Y=M[st])&&(M[st]=null),T.event.triggered=qt,v.isPropagationStopped()&&jt.addEventListener(qt,ao),M[qt](),v.isPropagationStopped()&&jt.removeEventListener(qt,ao),T.event.triggered=void 0,Y&&(M[st]=Y)),v.result}},simulate:function(v,S,M){var R=T.extend(new T.Event,M,{type:v,isSimulated:!0});T.event.trigger(R,null,S)}}),T.fn.extend({trigger:function(v,S){return this.each(function(){T.event.trigger(v,S,this)})},triggerHandler:function(v,S){var M=this[0];if(M)return T.event.trigger(v,S,M,!0)}});var as=/\[\]$/,vs=/\r?\n/g,ko=/^(?:submit|button|image|reset|file)$/i,ba=/^(?:input|select|textarea|keygen)/i;function _s(v,S,M,R){var V;if(Array.isArray(S))T.each(S,function(q,Y){M||as.test(v)?R(v,Y):_s(v+"["+(typeof Y=="object"&&Y!=null?q:"")+"]",Y,M,R)});else if(M||et(S)!=="object")R(v,S);else for(V in S)_s(v+"["+V+"]",S[V],M,R)}T.param=function(v,S){var M,R=[],V=function(q,Y){var ht=G(Y)?Y():Y;R[R.length]=encodeURIComponent(q)+"="+encodeURIComponent(ht??"")};if(v==null)return"";if(Array.isArray(v)||v.jquery&&!T.isPlainObject(v))T.each(v,function(){V(this.name,this.value)});else for(M in v)_s(M,v[M],S,V);return R.join("&")},T.fn.extend({serialize:function(){return T.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var v=T.prop(this,"elements");return v?T.makeArray(v):this}).filter(function(){var v=this.type;return this.name&&!T(this).is(":disabled")&&ba.test(this.nodeName)&&!ko.test(v)&&(this.checked||!ot.test(v))}).map(function(v,S){var M=T(this).val();return M==null?null:Array.isArray(M)?T.map(M,function(R){return{name:S.name,value:R.replace(vs,`\r
`)}}):{name:S.name,value:M.replace(vs,`\r
`)}}).get()}});var Wo=/%20/g,Qa=/#.*$/,tl=/([?&])_=[^&]*/,bl=/^(.*?):[ \t]*([^\r\n]*)$/gm,el=/^(?:GET|HEAD)$/,xs=/^\/\//,_o={},To={},Yo="*/".concat("*"),Gi=O.createElement("a");function Sl(v){return function(S,M){typeof S!="string"&&(M=S,S="*");var R,V=0,q=S.toLowerCase().match(Ue)||[];if(G(M))for(;R=q[V++];)R[0]==="+"?(R=R.slice(1)||"*",(v[R]=v[R]||[]).unshift(M)):(v[R]=v[R]||[]).push(M)}}function Po(v,S,M,R){var V={},q=v===To;function Y(ht){var st;return V[ht]=!0,T.each(v[ht]||[],function(xt,Tt){var jt=Tt(S,M,R);return typeof jt!="string"||q||V[jt]?q?!(st=jt):void 0:(S.dataTypes.unshift(jt),Y(jt),!1)}),st}return Y(S.dataTypes[0])||!V["*"]&&Y("*")}function Yn(v,S){var M,R,V=T.ajaxSettings.flatOptions||{};for(M in S)S[M]!==void 0&&((V[M]?v:R||(R={}))[M]=S[M]);return R&&T.extend(!0,v,R),v}Gi.href=Co.href,T.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Co.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Co.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Yo,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":T.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(v,S){return S?Yn(Yn(v,T.ajaxSettings),S):Yn(T.ajaxSettings,v)},ajaxPrefilter:Sl(_o),ajaxTransport:Sl(To),ajax:function(v,S){typeof v=="object"&&(S=v,v=void 0),S=S||{};var M,R,V,q,Y,ht,st,xt,Tt,jt,Et=T.ajaxSetup({},S),qt=Et.context||Et,be=Et.context&&(qt.nodeType||qt.jquery)?T(qt):T.event,We=T.Deferred(),Ze=T.Callbacks("once memory"),si=Et.statusCode||{},gi={},dn={},Dn="canceled",pr={readyState:0,getResponseHeader:function(rr){var Rr;if(st){if(!q)for(q={};Rr=bl.exec(V);)q[Rr[1].toLowerCase()+" "]=(q[Rr[1].toLowerCase()+" "]||[]).concat(Rr[2]);Rr=q[rr.toLowerCase()+" "]}return Rr==null?null:Rr.join(", ")},getAllResponseHeaders:function(){return st?V:null},setRequestHeader:function(rr,Rr){return st==null&&(rr=dn[rr.toLowerCase()]=dn[rr.toLowerCase()]||rr,gi[rr]=Rr),this},overrideMimeType:function(rr){return st==null&&(Et.mimeType=rr),this},statusCode:function(rr){var Rr;if(rr)if(st)pr.always(rr[pr.status]);else for(Rr in rr)si[Rr]=[si[Rr],rr[Rr]];return this},abort:function(rr){var Rr=rr||Dn;return M&&M.abort(Rr),Xi(0,Rr),this}};if(We.promise(pr),Et.url=((v||Et.url||Co.href)+"").replace(xs,Co.protocol+"//"),Et.type=S.method||S.type||Et.method||Et.type,Et.dataTypes=(Et.dataType||"*").toLowerCase().match(Ue)||[""],Et.crossDomain==null){ht=O.createElement("a");try{ht.href=Et.url,ht.href=ht.href,Et.crossDomain=Gi.protocol+"//"+Gi.host!=ht.protocol+"//"+ht.host}catch{Et.crossDomain=!0}}if(Et.data&&Et.processData&&typeof Et.data!="string"&&(Et.data=T.param(Et.data,Et.traditional)),Po(_o,Et,S,pr),st)return pr;for(Tt in(xt=T.event&&Et.global)&&T.active++==0&&T.event.trigger("ajaxStart"),Et.type=Et.type.toUpperCase(),Et.hasContent=!el.test(Et.type),R=Et.url.replace(Qa,""),Et.hasContent?Et.data&&Et.processData&&(Et.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(Et.data=Et.data.replace(Wo,"+")):(jt=Et.url.slice(R.length),Et.data&&(Et.processData||typeof Et.data=="string")&&(R+=(Wn.test(R)?"&":"?")+Et.data,delete Et.data),Et.cache===!1&&(R=R.replace(tl,"$1"),jt=(Wn.test(R)?"&":"?")+"_="+Us.guid+++jt),Et.url=R+jt),Et.ifModified&&(T.lastModified[R]&&pr.setRequestHeader("If-Modified-Since",T.lastModified[R]),T.etag[R]&&pr.setRequestHeader("If-None-Match",T.etag[R])),(Et.data&&Et.hasContent&&Et.contentType!==!1||S.contentType)&&pr.setRequestHeader("Content-Type",Et.contentType),pr.setRequestHeader("Accept",Et.dataTypes[0]&&Et.accepts[Et.dataTypes[0]]?Et.accepts[Et.dataTypes[0]]+(Et.dataTypes[0]!=="*"?", "+Yo+"; q=0.01":""):Et.accepts["*"]),Et.headers)pr.setRequestHeader(Tt,Et.headers[Tt]);if(Et.beforeSend&&(Et.beforeSend.call(qt,pr,Et)===!1||st))return pr.abort();if(Dn="abort",Ze.add(Et.complete),pr.done(Et.success),pr.fail(Et.error),M=Po(To,Et,S,pr)){if(pr.readyState=1,xt&&be.trigger("ajaxSend",[pr,Et]),st)return pr;Et.async&&0<Et.timeout&&(Y=n.setTimeout(function(){pr.abort("timeout")},Et.timeout));try{st=!1,M.send(gi,Xi)}catch(rr){if(st)throw rr;Xi(-1,rr)}}else Xi(-1,"No Transport");function Xi(rr,Rr,Gn,ts){var ri,Fo,Zn,ho,hi,gn=Rr;st||(st=!0,Y&&n.clearTimeout(Y),M=void 0,V=ts||"",pr.readyState=0<rr?4:0,ri=200<=rr&&rr<300||rr===304,Gn&&(ho=function(bi,Yr,Bi){for(var An,Wi,ze,ii,zr=bi.contents,qr=bi.dataTypes;qr[0]==="*";)qr.shift(),An===void 0&&(An=bi.mimeType||Yr.getResponseHeader("Content-Type"));if(An){for(Wi in zr)if(zr[Wi]&&zr[Wi].test(An)){qr.unshift(Wi);break}}if(qr[0]in Bi)ze=qr[0];else{for(Wi in Bi){if(!qr[0]||bi.converters[Wi+" "+qr[0]]){ze=Wi;break}ii||(ii=Wi)}ze=ze||ii}if(ze)return ze!==qr[0]&&qr.unshift(ze),Bi[ze]}(Et,pr,Gn)),!ri&&-1<T.inArray("script",Et.dataTypes)&&T.inArray("json",Et.dataTypes)<0&&(Et.converters["text script"]=function(){}),ho=function(bi,Yr,Bi,An){var Wi,ze,ii,zr,qr,vn={},Ie=bi.dataTypes.slice();if(Ie[1])for(ii in bi.converters)vn[ii.toLowerCase()]=bi.converters[ii];for(ze=Ie.shift();ze;)if(bi.responseFields[ze]&&(Bi[bi.responseFields[ze]]=Yr),!qr&&An&&bi.dataFilter&&(Yr=bi.dataFilter(Yr,bi.dataType)),qr=ze,ze=Ie.shift()){if(ze==="*")ze=qr;else if(qr!=="*"&&qr!==ze){if(!(ii=vn[qr+" "+ze]||vn["* "+ze])){for(Wi in vn)if((zr=Wi.split(" "))[1]===ze&&(ii=vn[qr+" "+zr[0]]||vn["* "+zr[0]])){ii===!0?ii=vn[Wi]:vn[Wi]!==!0&&(ze=zr[0],Ie.unshift(zr[1]));break}}if(ii!==!0)if(ii&&bi.throws)Yr=ii(Yr);else try{Yr=ii(Yr)}catch(lo){return{state:"parsererror",error:ii?lo:"No conversion from "+qr+" to "+ze}}}}return{state:"success",data:Yr}}(Et,ho,pr,ri),ri?(Et.ifModified&&((hi=pr.getResponseHeader("Last-Modified"))&&(T.lastModified[R]=hi),(hi=pr.getResponseHeader("etag"))&&(T.etag[R]=hi)),rr===204||Et.type==="HEAD"?gn="nocontent":rr===304?gn="notmodified":(gn=ho.state,Fo=ho.data,ri=!(Zn=ho.error))):(Zn=gn,!rr&&gn||(gn="error",rr<0&&(rr=0))),pr.status=rr,pr.statusText=(Rr||gn)+"",ri?We.resolveWith(qt,[Fo,gn,pr]):We.rejectWith(qt,[pr,gn,Zn]),pr.statusCode(si),si=void 0,xt&&be.trigger(ri?"ajaxSuccess":"ajaxError",[pr,Et,ri?Fo:Zn]),Ze.fireWith(qt,[pr,gn]),xt&&(be.trigger("ajaxComplete",[pr,Et]),--T.active||T.event.trigger("ajaxStop")))}return pr},getJSON:function(v,S,M){return T.get(v,S,M,"json")},getScript:function(v,S){return T.get(v,void 0,S,"script")}}),T.each(["get","post"],function(v,S){T[S]=function(M,R,V,q){return G(R)&&(q=q||V,V=R,R=void 0),T.ajax(T.extend({url:M,type:S,dataType:q,data:R,success:V},T.isPlainObject(M)&&M))}}),T.ajaxPrefilter(function(v){var S;for(S in v.headers)S.toLowerCase()==="content-type"&&(v.contentType=v.headers[S]||"")}),T._evalUrl=function(v,S,M){return T.ajax({url:v,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(R){T.globalEval(R,S,M)}})},T.fn.extend({wrapAll:function(v){var S;return this[0]&&(G(v)&&(v=v.call(this[0])),S=T(v,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&S.insertBefore(this[0]),S.map(function(){for(var M=this;M.firstElementChild;)M=M.firstElementChild;return M}).append(this)),this},wrapInner:function(v){return G(v)?this.each(function(S){T(this).wrapInner(v.call(this,S))}):this.each(function(){var S=T(this),M=S.contents();M.length?M.wrapAll(v):S.append(v)})},wrap:function(v){var S=G(v);return this.each(function(M){T(this).wrapAll(S?v.call(this,M):v)})},unwrap:function(v){return this.parent(v).not("body").each(function(){T(this).replaceWith(this.childNodes)}),this}}),T.expr.pseudos.hidden=function(v){return!T.expr.pseudos.visible(v)},T.expr.pseudos.visible=function(v){return!!(v.offsetWidth||v.offsetHeight||v.getClientRects().length)},T.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var Ki={0:200,1223:204},fn=T.ajaxSettings.xhr();A.cors=!!fn&&"withCredentials"in fn,A.ajax=fn=!!fn,T.ajaxTransport(function(v){var S,M;if(A.cors||fn&&!v.crossDomain)return{send:function(R,V){var q,Y=v.xhr();if(Y.open(v.type,v.url,v.async,v.username,v.password),v.xhrFields)for(q in v.xhrFields)Y[q]=v.xhrFields[q];for(q in v.mimeType&&Y.overrideMimeType&&Y.overrideMimeType(v.mimeType),v.crossDomain||R["X-Requested-With"]||(R["X-Requested-With"]="XMLHttpRequest"),R)Y.setRequestHeader(q,R[q]);S=function(ht){return function(){S&&(S=M=Y.onload=Y.onerror=Y.onabort=Y.ontimeout=Y.onreadystatechange=null,ht==="abort"?Y.abort():ht==="error"?typeof Y.status!="number"?V(0,"error"):V(Y.status,Y.statusText):V(Ki[Y.status]||Y.status,Y.statusText,(Y.responseType||"text")!=="text"||typeof Y.responseText!="string"?{binary:Y.response}:{text:Y.responseText},Y.getAllResponseHeaders()))}},Y.onload=S(),M=Y.onerror=Y.ontimeout=S("error"),Y.onabort!==void 0?Y.onabort=M:Y.onreadystatechange=function(){Y.readyState===4&&n.setTimeout(function(){S&&M()})},S=S("abort");try{Y.send(v.hasContent&&v.data||null)}catch(ht){if(S)throw ht}},abort:function(){S&&S()}}}),T.ajaxPrefilter(function(v){v.crossDomain&&(v.contents.script=!1)}),T.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(v){return T.globalEval(v),v}}}),T.ajaxPrefilter("script",function(v){v.cache===void 0&&(v.cache=!1),v.crossDomain&&(v.type="GET")}),T.ajaxTransport("script",function(v){var S,M;if(v.crossDomain||v.scriptAttrs)return{send:function(R,V){S=T("<script>").attr(v.scriptAttrs||{}).prop({charset:v.scriptCharset,src:v.url}).on("load error",M=function(q){S.remove(),M=null,q&&V(q.type==="error"?404:200,q.type)}),O.head.appendChild(S[0])},abort:function(){M&&M()}}});var Zr,Qn=[],Gr=/(=)\?(?=&|$)|\?\?/;T.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var v=Qn.pop()||T.expando+"_"+Us.guid++;return this[v]=!0,v}}),T.ajaxPrefilter("json jsonp",function(v,S,M){var R,V,q,Y=v.jsonp!==!1&&(Gr.test(v.url)?"url":typeof v.data=="string"&&(v.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Gr.test(v.data)&&"data");if(Y||v.dataTypes[0]==="jsonp")return R=v.jsonpCallback=G(v.jsonpCallback)?v.jsonpCallback():v.jsonpCallback,Y?v[Y]=v[Y].replace(Gr,"$1"+R):v.jsonp!==!1&&(v.url+=(Wn.test(v.url)?"&":"?")+v.jsonp+"="+R),v.converters["script json"]=function(){return q||T.error(R+" was not called"),q[0]},v.dataTypes[0]="json",V=n[R],n[R]=function(){q=arguments},M.always(function(){V===void 0?T(n).removeProp(R):n[R]=V,v[R]&&(v.jsonpCallback=S.jsonpCallback,Qn.push(R)),q&&G(V)&&V(q[0]),q=V=void 0}),"script"}),A.createHTMLDocument=((Zr=O.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",Zr.childNodes.length===2),T.parseHTML=function(v,S,M){return typeof v!="string"?[]:(typeof S=="boolean"&&(M=S,S=!1),S||(A.createHTMLDocument?((R=(S=O.implementation.createHTMLDocument("")).createElement("base")).href=O.location.href,S.head.appendChild(R)):S=O),q=!M&&[],(V=ge.exec(v))?[S.createElement(V[1])]:(V=xr([v],S,q),q&&q.length&&T(q).remove(),T.merge([],V.childNodes)));var R,V,q},T.fn.load=function(v,S,M){var R,V,q,Y=this,ht=v.indexOf(" ");return-1<ht&&(R=Ur(v.slice(ht)),v=v.slice(0,ht)),G(S)?(M=S,S=void 0):S&&typeof S=="object"&&(V="POST"),0<Y.length&&T.ajax({url:v,type:V||"GET",dataType:"html",data:S}).done(function(st){q=arguments,Y.html(R?T("<div>").append(T.parseHTML(st)).find(R):st)}).always(M&&function(st,xt){Y.each(function(){M.apply(this,q||[st.responseText,xt,st])})}),this},T.expr.pseudos.animated=function(v){return T.grep(T.timers,function(S){return v===S.elem}).length},T.offset={setOffset:function(v,S,M){var R,V,q,Y,ht,st,xt=T.css(v,"position"),Tt=T(v),jt={};xt==="static"&&(v.style.position="relative"),ht=Tt.offset(),q=T.css(v,"top"),st=T.css(v,"left"),(xt==="absolute"||xt==="fixed")&&-1<(q+st).indexOf("auto")?(Y=(R=Tt.position()).top,V=R.left):(Y=parseFloat(q)||0,V=parseFloat(st)||0),G(S)&&(S=S.call(v,M,T.extend({},ht))),S.top!=null&&(jt.top=S.top-ht.top+Y),S.left!=null&&(jt.left=S.left-ht.left+V),"using"in S?S.using.call(v,jt):Tt.css(jt)}},T.fn.extend({offset:function(v){if(arguments.length)return v===void 0?this:this.each(function(V){T.offset.setOffset(this,v,V)});var S,M,R=this[0];return R?R.getClientRects().length?(S=R.getBoundingClientRect(),M=R.ownerDocument.defaultView,{top:S.top+M.pageYOffset,left:S.left+M.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var v,S,M,R=this[0],V={top:0,left:0};if(T.css(R,"position")==="fixed")S=R.getBoundingClientRect();else{for(S=this.offset(),M=R.ownerDocument,v=R.offsetParent||M.documentElement;v&&(v===M.body||v===M.documentElement)&&T.css(v,"position")==="static";)v=v.parentNode;v&&v!==R&&v.nodeType===1&&((V=T(v).offset()).top+=T.css(v,"borderTopWidth",!0),V.left+=T.css(v,"borderLeftWidth",!0))}return{top:S.top-V.top-T.css(R,"marginTop",!0),left:S.left-V.left-T.css(R,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var v=this.offsetParent;v&&T.css(v,"position")==="static";)v=v.offsetParent;return v||Kt})}}),T.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(v,S){var M=S==="pageYOffset";T.fn[v]=function(R){return vr(this,function(V,q,Y){var ht;if(B(V)?ht=V:V.nodeType===9&&(ht=V.defaultView),Y===void 0)return ht?ht[S]:V[q];ht?ht.scrollTo(M?ht.pageXOffset:Y,M?Y:ht.pageYOffset):V[q]=Y},v,R,arguments.length)}}),T.each(["top","left"],function(v,S){T.cssHooks[S]=tn(A.pixelPosition,function(M,R){if(R)return R=Jr(M,S),Qi.test(R)?T(M).position()[S]+"px":R})}),T.each({Height:"height",Width:"width"},function(v,S){T.each({padding:"inner"+v,content:S,"":"outer"+v},function(M,R){T.fn[R]=function(V,q){var Y=arguments.length&&(M||typeof V!="boolean"),ht=M||(V===!0||q===!0?"margin":"border");return vr(this,function(st,xt,Tt){var jt;return B(st)?R.indexOf("outer")===0?st["inner"+v]:st.document.documentElement["client"+v]:st.nodeType===9?(jt=st.documentElement,Math.max(st.body["scroll"+v],jt["scroll"+v],st.body["offset"+v],jt["offset"+v],jt["client"+v])):Tt===void 0?T.css(st,xt,ht):T.style(st,xt,Tt,ht)},S,Y?V:void 0,Y)}})}),T.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(v,S){T.fn[S]=function(M){return this.on(S,M)}}),T.fn.extend({bind:function(v,S,M){return this.on(v,null,S,M)},unbind:function(v,S){return this.off(v,null,S)},delegate:function(v,S,M,R){return this.on(S,v,M,R)},undelegate:function(v,S,M){return arguments.length===1?this.off(v,"**"):this.off(S,v||"**",M)},hover:function(v,S){return this.on("mouseenter",v).on("mouseleave",S||v)}}),T.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(v,S){T.fn[S]=function(M,R){return 0<arguments.length?this.on(S,null,M,R):this.trigger(S)}});var on=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;T.proxy=function(v,S){var M,R,V;if(typeof S=="string"&&(M=v[S],S=v,v=M),G(v))return R=d.call(arguments,2),(V=function(){return v.apply(S||this,R.concat(d.call(arguments)))}).guid=v.guid=v.guid||T.guid++,V},T.holdReady=function(v){v?T.readyWait++:T.ready(!0)},T.isArray=Array.isArray,T.parseJSON=JSON.parse,T.nodeName=ut,T.isFunction=G,T.isWindow=B,T.camelCase=Sr,T.type=et,T.now=Date.now,T.isNumeric=function(v){var S=T.type(v);return(S==="number"||S==="string")&&!isNaN(v-parseFloat(v))},T.trim=function(v){return v==null?"":(v+"").replace(on,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return T});var ws=n.jQuery,Hi=n.$;return T.noConflict=function(v){return n.$===T&&(n.$=Hi),v&&n.jQuery===T&&(n.jQuery=ws),T},typeof c>"u"&&(n.jQuery=n.$=T),T}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports<"u"?module.exports=n(require("jquery")):n(jQuery)}(function(n){"use strict";var c=window.Slick||{};(c=function(){var h=0;return function(u,d){var m,g=this;g.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:n(u),appendDots:n(u),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(x,E){return n('<button type="button" />').text(E+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},g.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},n.extend(g,g.initials),g.activeBreakpoint=null,g.animType=null,g.animProp=null,g.breakpoints=[],g.breakpointSettings=[],g.cssTransitions=!1,g.focussed=!1,g.interrupted=!1,g.hidden="hidden",g.paused=!0,g.positionProp=null,g.respondTo=null,g.rowCount=1,g.shouldClick=!0,g.$slider=n(u),g.$slidesCache=null,g.transformType=null,g.transitionType=null,g.visibilityChange="visibilitychange",g.windowWidth=0,g.windowTimer=null,m=n(u).data("slick")||{},g.options=n.extend({},g.defaults,d,m),g.currentSlide=g.options.initialSlide,g.originalSettings=g.options,document.mozHidden!==void 0?(g.hidden="mozHidden",g.visibilityChange="mozvisibilitychange"):document.webkitHidden!==void 0&&(g.hidden="webkitHidden",g.visibilityChange="webkitvisibilitychange"),g.autoPlay=n.proxy(g.autoPlay,g),g.autoPlayClear=n.proxy(g.autoPlayClear,g),g.autoPlayIterator=n.proxy(g.autoPlayIterator,g),g.changeSlide=n.proxy(g.changeSlide,g),g.clickHandler=n.proxy(g.clickHandler,g),g.selectHandler=n.proxy(g.selectHandler,g),g.setPosition=n.proxy(g.setPosition,g),g.swipeHandler=n.proxy(g.swipeHandler,g),g.dragHandler=n.proxy(g.dragHandler,g),g.keyHandler=n.proxy(g.keyHandler,g),g.instanceUid=h++,g.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,g.registerBreakpoints(),g.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},c.prototype.addSlide=c.prototype.slickAdd=function(h,u,d){var m=this;if(typeof u=="boolean")d=u,u=null;else if(u<0||u>=m.slideCount)return!1;m.unload(),typeof u=="number"?u===0&&m.$slides.length===0?n(h).appendTo(m.$slideTrack):d?n(h).insertBefore(m.$slides.eq(u)):n(h).insertAfter(m.$slides.eq(u)):d===!0?n(h).prependTo(m.$slideTrack):n(h).appendTo(m.$slideTrack),m.$slides=m.$slideTrack.children(this.options.slide),m.$slideTrack.children(this.options.slide).detach(),m.$slideTrack.append(m.$slides),m.$slides.each(function(g,x){n(x).attr("data-slick-index",g)}),m.$slidesCache=m.$slides,m.reinit()},c.prototype.animateHeight=function(){var h=this;if(h.options.slidesToShow===1&&h.options.adaptiveHeight===!0&&h.options.vertical===!1){var u=h.$slides.eq(h.currentSlide).outerHeight(!0);h.$list.animate({height:u},h.options.speed)}},c.prototype.animateSlide=function(h,u){var d={},m=this;m.animateHeight(),m.options.rtl===!0&&m.options.vertical===!1&&(h=-h),m.transformsEnabled===!1?m.options.vertical===!1?m.$slideTrack.animate({left:h},m.options.speed,m.options.easing,u):m.$slideTrack.animate({top:h},m.options.speed,m.options.easing,u):m.cssTransitions===!1?(m.options.rtl===!0&&(m.currentLeft=-m.currentLeft),n({animStart:m.currentLeft}).animate({animStart:h},{duration:m.options.speed,easing:m.options.easing,step:function(g){g=Math.ceil(g),m.options.vertical===!1?(d[m.animType]="translate("+g+"px, 0px)",m.$slideTrack.css(d)):(d[m.animType]="translate(0px,"+g+"px)",m.$slideTrack.css(d))},complete:function(){u&&u.call()}})):(m.applyTransition(),h=Math.ceil(h),m.options.vertical===!1?d[m.animType]="translate3d("+h+"px, 0px, 0px)":d[m.animType]="translate3d(0px,"+h+"px, 0px)",m.$slideTrack.css(d),u&&setTimeout(function(){m.disableTransition(),u.call()},m.options.speed))},c.prototype.getNavTarget=function(){var h=this,u=h.options.asNavFor;return u&&u!==null&&(u=n(u).not(h.$slider)),u},c.prototype.asNavFor=function(h){var u=this.getNavTarget();u!==null&&typeof u=="object"&&u.each(function(){var d=n(this).slick("getSlick");d.unslicked||d.slideHandler(h,!0)})},c.prototype.applyTransition=function(h){var u=this,d={};u.options.fade===!1?d[u.transitionType]=u.transformType+" "+u.options.speed+"ms "+u.options.cssEase:d[u.transitionType]="opacity "+u.options.speed+"ms "+u.options.cssEase,u.options.fade===!1?u.$slideTrack.css(d):u.$slides.eq(h).css(d)},c.prototype.autoPlay=function(){var h=this;h.autoPlayClear(),h.slideCount>h.options.slidesToShow&&(h.autoPlayTimer=setInterval(h.autoPlayIterator,h.options.autoplaySpeed))},c.prototype.autoPlayClear=function(){var h=this;h.autoPlayTimer&&clearInterval(h.autoPlayTimer)},c.prototype.autoPlayIterator=function(){var h=this,u=h.currentSlide+h.options.slidesToScroll;h.paused||h.interrupted||h.focussed||(h.options.infinite===!1&&(h.direction===1&&h.currentSlide+1===h.slideCount-1?h.direction=0:h.direction===0&&(u=h.currentSlide-h.options.slidesToScroll,h.currentSlide-1==0&&(h.direction=1))),h.slideHandler(u))},c.prototype.buildArrows=function(){var h=this;h.options.arrows===!0&&(h.$prevArrow=n(h.options.prevArrow).addClass("slick-arrow"),h.$nextArrow=n(h.options.nextArrow).addClass("slick-arrow"),h.slideCount>h.options.slidesToShow?(h.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),h.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),h.htmlExpr.test(h.options.prevArrow)&&h.$prevArrow.prependTo(h.options.appendArrows),h.htmlExpr.test(h.options.nextArrow)&&h.$nextArrow.appendTo(h.options.appendArrows),h.options.infinite!==!0&&h.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):h.$prevArrow.add(h.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},c.prototype.buildDots=function(){var h,u,d=this;if(d.options.dots===!0){for(d.$slider.addClass("slick-dotted"),u=n("<ul />").addClass(d.options.dotsClass),h=0;h<=d.getDotCount();h+=1)u.append(n("<li />").append(d.options.customPaging.call(this,d,h)));d.$dots=u.appendTo(d.options.appendDots),d.$dots.find("li").first().addClass("slick-active")}},c.prototype.buildOut=function(){var h=this;h.$slides=h.$slider.children(h.options.slide+":not(.slick-cloned)").addClass("slick-slide"),h.slideCount=h.$slides.length,h.$slides.each(function(u,d){n(d).attr("data-slick-index",u).data("originalStyling",n(d).attr("style")||"")}),h.$slider.addClass("slick-slider"),h.$slideTrack=h.slideCount===0?n('<div class="slick-track"/>').appendTo(h.$slider):h.$slides.wrapAll('<div class="slick-track"/>').parent(),h.$list=h.$slideTrack.wrap('<div class="slick-list"/>').parent(),h.$slideTrack.css("opacity",0),h.options.centerMode!==!0&&h.options.swipeToSlide!==!0||(h.options.slidesToScroll=1),n("img[data-lazy]",h.$slider).not("[src]").addClass("slick-loading"),h.setupInfinite(),h.buildArrows(),h.buildDots(),h.updateDots(),h.setSlideClasses(typeof h.currentSlide=="number"?h.currentSlide:0),h.options.draggable===!0&&h.$list.addClass("draggable")},c.prototype.buildRows=function(){var h,u,d,m,g,x,E,P=this;if(m=document.createDocumentFragment(),x=P.$slider.children(),P.options.rows>1){for(E=P.options.slidesPerRow*P.options.rows,g=Math.ceil(x.length/E),h=0;h<g;h++){var L=document.createElement("div");for(u=0;u<P.options.rows;u++){var F=document.createElement("div");for(d=0;d<P.options.slidesPerRow;d++){var U=h*E+(u*P.options.slidesPerRow+d);x.get(U)&&F.appendChild(x.get(U))}L.appendChild(F)}m.appendChild(L)}P.$slider.empty().append(m),P.$slider.children().children().children().css({width:100/P.options.slidesPerRow+"%",display:"inline-block"})}},c.prototype.checkResponsive=function(h,u){var d,m,g,x=this,E=!1,P=x.$slider.width(),L=window.innerWidth||n(window).width();if(x.respondTo==="window"?g=L:x.respondTo==="slider"?g=P:x.respondTo==="min"&&(g=Math.min(L,P)),x.options.responsive&&x.options.responsive.length&&x.options.responsive!==null){m=null;for(d in x.breakpoints)x.breakpoints.hasOwnProperty(d)&&(x.originalSettings.mobileFirst===!1?g<x.breakpoints[d]&&(m=x.breakpoints[d]):g>x.breakpoints[d]&&(m=x.breakpoints[d]));m!==null?x.activeBreakpoint!==null?(m!==x.activeBreakpoint||u)&&(x.activeBreakpoint=m,x.breakpointSettings[m]==="unslick"?x.unslick(m):(x.options=n.extend({},x.originalSettings,x.breakpointSettings[m]),h===!0&&(x.currentSlide=x.options.initialSlide),x.refresh(h)),E=m):(x.activeBreakpoint=m,x.breakpointSettings[m]==="unslick"?x.unslick(m):(x.options=n.extend({},x.originalSettings,x.breakpointSettings[m]),h===!0&&(x.currentSlide=x.options.initialSlide),x.refresh(h)),E=m):x.activeBreakpoint!==null&&(x.activeBreakpoint=null,x.options=x.originalSettings,h===!0&&(x.currentSlide=x.options.initialSlide),x.refresh(h),E=m),h||E===!1||x.$slider.trigger("breakpoint",[x,E])}},c.prototype.changeSlide=function(h,u){var d,m,g,x=this,E=n(h.currentTarget);switch(E.is("a")&&h.preventDefault(),E.is("li")||(E=E.closest("li")),g=x.slideCount%x.options.slidesToScroll!=0,d=g?0:(x.slideCount-x.currentSlide)%x.options.slidesToScroll,h.data.message){case"previous":m=d===0?x.options.slidesToScroll:x.options.slidesToShow-d,x.slideCount>x.options.slidesToShow&&x.slideHandler(x.currentSlide-m,!1,u);break;case"next":m=d===0?x.options.slidesToScroll:d,x.slideCount>x.options.slidesToShow&&x.slideHandler(x.currentSlide+m,!1,u);break;case"index":var P=h.data.index===0?0:h.data.index||E.index()*x.options.slidesToScroll;x.slideHandler(x.checkNavigable(P),!1,u),E.children().trigger("focus");break;default:return}},c.prototype.checkNavigable=function(h){var u,d;if(u=this.getNavigableIndexes(),d=0,h>u[u.length-1])h=u[u.length-1];else for(var m in u){if(h<u[m]){h=d;break}d=u[m]}return h},c.prototype.cleanUpEvents=function(){var h=this;h.options.dots&&h.$dots!==null&&(n("li",h.$dots).off("click.slick",h.changeSlide).off("mouseenter.slick",n.proxy(h.interrupt,h,!0)).off("mouseleave.slick",n.proxy(h.interrupt,h,!1)),h.options.accessibility===!0&&h.$dots.off("keydown.slick",h.keyHandler)),h.$slider.off("focus.slick blur.slick"),h.options.arrows===!0&&h.slideCount>h.options.slidesToShow&&(h.$prevArrow&&h.$prevArrow.off("click.slick",h.changeSlide),h.$nextArrow&&h.$nextArrow.off("click.slick",h.changeSlide),h.options.accessibility===!0&&(h.$prevArrow&&h.$prevArrow.off("keydown.slick",h.keyHandler),h.$nextArrow&&h.$nextArrow.off("keydown.slick",h.keyHandler))),h.$list.off("touchstart.slick mousedown.slick",h.swipeHandler),h.$list.off("touchmove.slick mousemove.slick",h.swipeHandler),h.$list.off("touchend.slick mouseup.slick",h.swipeHandler),h.$list.off("touchcancel.slick mouseleave.slick",h.swipeHandler),h.$list.off("click.slick",h.clickHandler),n(document).off(h.visibilityChange,h.visibility),h.cleanUpSlideEvents(),h.options.accessibility===!0&&h.$list.off("keydown.slick",h.keyHandler),h.options.focusOnSelect===!0&&n(h.$slideTrack).children().off("click.slick",h.selectHandler),n(window).off("orientationchange.slick.slick-"+h.instanceUid,h.orientationChange),n(window).off("resize.slick.slick-"+h.instanceUid,h.resize),n("[draggable!=true]",h.$slideTrack).off("dragstart",h.preventDefault),n(window).off("load.slick.slick-"+h.instanceUid,h.setPosition)},c.prototype.cleanUpSlideEvents=function(){var h=this;h.$list.off("mouseenter.slick",n.proxy(h.interrupt,h,!0)),h.$list.off("mouseleave.slick",n.proxy(h.interrupt,h,!1))},c.prototype.cleanUpRows=function(){var h,u=this;u.options.rows>1&&((h=u.$slides.children().children()).removeAttr("style"),u.$slider.empty().append(h))},c.prototype.clickHandler=function(h){this.shouldClick===!1&&(h.stopImmediatePropagation(),h.stopPropagation(),h.preventDefault())},c.prototype.destroy=function(h){var u=this;u.autoPlayClear(),u.touchObject={},u.cleanUpEvents(),n(".slick-cloned",u.$slider).detach(),u.$dots&&u.$dots.remove(),u.$prevArrow&&u.$prevArrow.length&&(u.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),u.htmlExpr.test(u.options.prevArrow)&&u.$prevArrow.remove()),u.$nextArrow&&u.$nextArrow.length&&(u.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),u.htmlExpr.test(u.options.nextArrow)&&u.$nextArrow.remove()),u.$slides&&(u.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){n(this).attr("style",n(this).data("originalStyling"))}),u.$slideTrack.children(this.options.slide).detach(),u.$slideTrack.detach(),u.$list.detach(),u.$slider.append(u.$slides)),u.cleanUpRows(),u.$slider.removeClass("slick-slider"),u.$slider.removeClass("slick-initialized"),u.$slider.removeClass("slick-dotted"),u.unslicked=!0,h||u.$slider.trigger("destroy",[u])},c.prototype.disableTransition=function(h){var u=this,d={};d[u.transitionType]="",u.options.fade===!1?u.$slideTrack.css(d):u.$slides.eq(h).css(d)},c.prototype.fadeSlide=function(h,u){var d=this;d.cssTransitions===!1?(d.$slides.eq(h).css({zIndex:d.options.zIndex}),d.$slides.eq(h).animate({opacity:1},d.options.speed,d.options.easing,u)):(d.applyTransition(h),d.$slides.eq(h).css({opacity:1,zIndex:d.options.zIndex}),u&&setTimeout(function(){d.disableTransition(h),u.call()},d.options.speed))},c.prototype.fadeSlideOut=function(h){var u=this;u.cssTransitions===!1?u.$slides.eq(h).animate({opacity:0,zIndex:u.options.zIndex-2},u.options.speed,u.options.easing):(u.applyTransition(h),u.$slides.eq(h).css({opacity:0,zIndex:u.options.zIndex-2}))},c.prototype.filterSlides=c.prototype.slickFilter=function(h){var u=this;h!==null&&(u.$slidesCache=u.$slides,u.unload(),u.$slideTrack.children(this.options.slide).detach(),u.$slidesCache.filter(h).appendTo(u.$slideTrack),u.reinit())},c.prototype.focusHandler=function(){var h=this;h.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(u){u.stopImmediatePropagation();var d=n(this);setTimeout(function(){h.options.pauseOnFocus&&(h.focussed=d.is(":focus"),h.autoPlay())},0)})},c.prototype.getCurrent=c.prototype.slickCurrentSlide=function(){return this.currentSlide},c.prototype.getDotCount=function(){var h=this,u=0,d=0,m=0;if(h.options.infinite===!0)if(h.slideCount<=h.options.slidesToShow)++m;else for(;u<h.slideCount;)++m,u=d+h.options.slidesToScroll,d+=h.options.slidesToScroll<=h.options.slidesToShow?h.options.slidesToScroll:h.options.slidesToShow;else if(h.options.centerMode===!0)m=h.slideCount;else if(h.options.asNavFor)for(;u<h.slideCount;)++m,u=d+h.options.slidesToScroll,d+=h.options.slidesToScroll<=h.options.slidesToShow?h.options.slidesToScroll:h.options.slidesToShow;else m=1+Math.ceil((h.slideCount-h.options.slidesToShow)/h.options.slidesToScroll);return m-1},c.prototype.getLeft=function(h){var u,d,m,g,x=this,E=0;return x.slideOffset=0,d=x.$slides.first().outerHeight(!0),x.options.infinite===!0?(x.slideCount>x.options.slidesToShow&&(x.slideOffset=x.slideWidth*x.options.slidesToShow*-1,g=-1,x.options.vertical===!0&&x.options.centerMode===!0&&(x.options.slidesToShow===2?g=-1.5:x.options.slidesToShow===1&&(g=-2)),E=d*x.options.slidesToShow*g),x.slideCount%x.options.slidesToScroll!=0&&h+x.options.slidesToScroll>x.slideCount&&x.slideCount>x.options.slidesToShow&&(h>x.slideCount?(x.slideOffset=(x.options.slidesToShow-(h-x.slideCount))*x.slideWidth*-1,E=(x.options.slidesToShow-(h-x.slideCount))*d*-1):(x.slideOffset=x.slideCount%x.options.slidesToScroll*x.slideWidth*-1,E=x.slideCount%x.options.slidesToScroll*d*-1))):h+x.options.slidesToShow>x.slideCount&&(x.slideOffset=(h+x.options.slidesToShow-x.slideCount)*x.slideWidth,E=(h+x.options.slidesToShow-x.slideCount)*d),x.slideCount<=x.options.slidesToShow&&(x.slideOffset=0,E=0),x.options.centerMode===!0&&x.slideCount<=x.options.slidesToShow?x.slideOffset=x.slideWidth*Math.floor(x.options.slidesToShow)/2-x.slideWidth*x.slideCount/2:x.options.centerMode===!0&&x.options.infinite===!0?x.slideOffset+=x.slideWidth*Math.floor(x.options.slidesToShow/2)-x.slideWidth:x.options.centerMode===!0&&(x.slideOffset=0,x.slideOffset+=x.slideWidth*Math.floor(x.options.slidesToShow/2)),u=x.options.vertical===!1?h*x.slideWidth*-1+x.slideOffset:h*d*-1+E,x.options.variableWidth===!0&&(m=x.slideCount<=x.options.slidesToShow||x.options.infinite===!1?x.$slideTrack.children(".slick-slide").eq(h):x.$slideTrack.children(".slick-slide").eq(h+x.options.slidesToShow),u=x.options.rtl===!0?m[0]?-1*(x.$slideTrack.width()-m[0].offsetLeft-m.width()):0:m[0]?-1*m[0].offsetLeft:0,x.options.centerMode===!0&&(m=x.slideCount<=x.options.slidesToShow||x.options.infinite===!1?x.$slideTrack.children(".slick-slide").eq(h):x.$slideTrack.children(".slick-slide").eq(h+x.options.slidesToShow+1),u=x.options.rtl===!0?m[0]?-1*(x.$slideTrack.width()-m[0].offsetLeft-m.width()):0:m[0]?-1*m[0].offsetLeft:0,u+=(x.$list.width()-m.outerWidth())/2)),u},c.prototype.getOption=c.prototype.slickGetOption=function(h){return this.options[h]},c.prototype.getNavigableIndexes=function(){var h,u=this,d=0,m=0,g=[];for(u.options.infinite===!1?h=u.slideCount:(d=-1*u.options.slidesToScroll,m=-1*u.options.slidesToScroll,h=2*u.slideCount);d<h;)g.push(d),d=m+u.options.slidesToScroll,m+=u.options.slidesToScroll<=u.options.slidesToShow?u.options.slidesToScroll:u.options.slidesToShow;return g},c.prototype.getSlick=function(){return this},c.prototype.getSlideCount=function(){var h,u,d=this;return u=d.options.centerMode===!0?d.slideWidth*Math.floor(d.options.slidesToShow/2):0,d.options.swipeToSlide===!0?(d.$slideTrack.find(".slick-slide").each(function(m,g){if(g.offsetLeft-u+n(g).outerWidth()/2>-1*d.swipeLeft)return h=g,!1}),Math.abs(n(h).attr("data-slick-index")-d.currentSlide)||1):d.options.slidesToScroll},c.prototype.goTo=c.prototype.slickGoTo=function(h,u){this.changeSlide({data:{message:"index",index:parseInt(h)}},u)},c.prototype.init=function(h){var u=this;n(u.$slider).hasClass("slick-initialized")||(n(u.$slider).addClass("slick-initialized"),u.buildRows(),u.buildOut(),u.setProps(),u.startLoad(),u.loadSlider(),u.initializeEvents(),u.updateArrows(),u.updateDots(),u.checkResponsive(!0),u.focusHandler()),h&&u.$slider.trigger("init",[u]),u.options.accessibility===!0&&u.initADA(),u.options.autoplay&&(u.paused=!1,u.autoPlay())},c.prototype.initADA=function(){var h=this,u=Math.ceil(h.slideCount/h.options.slidesToShow),d=h.getNavigableIndexes().filter(function(x){return x>=0&&x<h.slideCount});h.$slides.add(h.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),h.$dots!==null&&(h.$slides.not(h.$slideTrack.find(".slick-cloned")).each(function(x){var E=d.indexOf(x);n(this).attr({role:"tabpanel",id:"slick-slide"+h.instanceUid+x,tabindex:-1}),E!==-1&&n(this).attr({"aria-describedby":"slick-slide-control"+h.instanceUid+E})}),h.$dots.attr("role","tablist").find("li").each(function(x){var E=d[x];n(this).attr({role:"presentation"}),n(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+h.instanceUid+x,"aria-controls":"slick-slide"+h.instanceUid+E,"aria-label":x+1+" of "+u,"aria-selected":null,tabindex:"-1"})}).eq(h.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var m=h.currentSlide,g=m+h.options.slidesToShow;m<g;m++)h.$slides.eq(m).attr("tabindex",0);h.activateADA()},c.prototype.initArrowEvents=function(){var h=this;h.options.arrows===!0&&h.slideCount>h.options.slidesToShow&&(h.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},h.changeSlide),h.$nextArrow.off("click.slick").on("click.slick",{message:"next"},h.changeSlide),h.options.accessibility===!0&&(h.$prevArrow.on("keydown.slick",h.keyHandler),h.$nextArrow.on("keydown.slick",h.keyHandler)))},c.prototype.initDotEvents=function(){var h=this;h.options.dots===!0&&(n("li",h.$dots).on("click.slick",{message:"index"},h.changeSlide),h.options.accessibility===!0&&h.$dots.on("keydown.slick",h.keyHandler)),h.options.dots===!0&&h.options.pauseOnDotsHover===!0&&n("li",h.$dots).on("mouseenter.slick",n.proxy(h.interrupt,h,!0)).on("mouseleave.slick",n.proxy(h.interrupt,h,!1))},c.prototype.initSlideEvents=function(){var h=this;h.options.pauseOnHover&&(h.$list.on("mouseenter.slick",n.proxy(h.interrupt,h,!0)),h.$list.on("mouseleave.slick",n.proxy(h.interrupt,h,!1)))},c.prototype.initializeEvents=function(){var h=this;h.initArrowEvents(),h.initDotEvents(),h.initSlideEvents(),h.$list.on("touchstart.slick mousedown.slick",{action:"start"},h.swipeHandler),h.$list.on("touchmove.slick mousemove.slick",{action:"move"},h.swipeHandler),h.$list.on("touchend.slick mouseup.slick",{action:"end"},h.swipeHandler),h.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},h.swipeHandler),h.$list.on("click.slick",h.clickHandler),n(document).on(h.visibilityChange,n.proxy(h.visibility,h)),h.options.accessibility===!0&&h.$list.on("keydown.slick",h.keyHandler),h.options.focusOnSelect===!0&&n(h.$slideTrack).children().on("click.slick",h.selectHandler),n(window).on("orientationchange.slick.slick-"+h.instanceUid,n.proxy(h.orientationChange,h)),n(window).on("resize.slick.slick-"+h.instanceUid,n.proxy(h.resize,h)),n("[draggable!=true]",h.$slideTrack).on("dragstart",h.preventDefault),n(window).on("load.slick.slick-"+h.instanceUid,h.setPosition),n(h.setPosition)},c.prototype.initUI=function(){var h=this;h.options.arrows===!0&&h.slideCount>h.options.slidesToShow&&(h.$prevArrow.show(),h.$nextArrow.show()),h.options.dots===!0&&h.slideCount>h.options.slidesToShow&&h.$dots.show()},c.prototype.keyHandler=function(h){var u=this;h.target.tagName.match("TEXTAREA|INPUT|SELECT")||(h.keyCode===37&&u.options.accessibility===!0?u.changeSlide({data:{message:u.options.rtl===!0?"next":"previous"}}):h.keyCode===39&&u.options.accessibility===!0&&u.changeSlide({data:{message:u.options.rtl===!0?"previous":"next"}}))},c.prototype.lazyLoad=function(){function h(F){n("img[data-lazy]",F).each(function(){var U=n(this),A=n(this).attr("data-lazy"),G=n(this).attr("data-srcset"),B=n(this).attr("data-sizes")||g.$slider.attr("data-sizes"),O=document.createElement("img");O.onload=function(){U.animate({opacity:0},100,function(){G&&(U.attr("srcset",G),B&&U.attr("sizes",B)),U.attr("src",A).animate({opacity:1},200,function(){U.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),g.$slider.trigger("lazyLoaded",[g,U,A])})},O.onerror=function(){U.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),g.$slider.trigger("lazyLoadError",[g,U,A])},O.src=A})}var u,d,m,g=this;if(g.options.centerMode===!0?g.options.infinite===!0?m=(d=g.currentSlide+(g.options.slidesToShow/2+1))+g.options.slidesToShow+2:(d=Math.max(0,g.currentSlide-(g.options.slidesToShow/2+1)),m=g.options.slidesToShow/2+1+2+g.currentSlide):(d=g.options.infinite?g.options.slidesToShow+g.currentSlide:g.currentSlide,m=Math.ceil(d+g.options.slidesToShow),g.options.fade===!0&&(d>0&&d--,m<=g.slideCount&&m++)),u=g.$slider.find(".slick-slide").slice(d,m),g.options.lazyLoad==="anticipated")for(var x=d-1,E=m,P=g.$slider.find(".slick-slide"),L=0;L<g.options.slidesToScroll;L++)x<0&&(x=g.slideCount-1),u=(u=u.add(P.eq(x))).add(P.eq(E)),x--,E++;h(u),g.slideCount<=g.options.slidesToShow?h(g.$slider.find(".slick-slide")):g.currentSlide>=g.slideCount-g.options.slidesToShow?h(g.$slider.find(".slick-cloned").slice(0,g.options.slidesToShow)):g.currentSlide===0&&h(g.$slider.find(".slick-cloned").slice(-1*g.options.slidesToShow))},c.prototype.loadSlider=function(){var h=this;h.setPosition(),h.$slideTrack.css({opacity:1}),h.$slider.removeClass("slick-loading"),h.initUI(),h.options.lazyLoad==="progressive"&&h.progressiveLazyLoad()},c.prototype.next=c.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},c.prototype.orientationChange=function(){var h=this;h.checkResponsive(),h.setPosition()},c.prototype.pause=c.prototype.slickPause=function(){var h=this;h.autoPlayClear(),h.paused=!0},c.prototype.play=c.prototype.slickPlay=function(){var h=this;h.autoPlay(),h.options.autoplay=!0,h.paused=!1,h.focussed=!1,h.interrupted=!1},c.prototype.postSlide=function(h){var u=this;u.unslicked||(u.$slider.trigger("afterChange",[u,h]),u.animating=!1,u.slideCount>u.options.slidesToShow&&u.setPosition(),u.swipeLeft=null,u.options.autoplay&&u.autoPlay(),u.options.accessibility===!0&&(u.initADA(),u.options.focusOnChange&&n(u.$slides.get(u.currentSlide)).attr("tabindex",0).focus()))},c.prototype.prev=c.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},c.prototype.preventDefault=function(h){h.preventDefault()},c.prototype.progressiveLazyLoad=function(h){h=h||1;var u,d,m,g,x,E=this,P=n("img[data-lazy]",E.$slider);P.length?(u=P.first(),d=u.attr("data-lazy"),m=u.attr("data-srcset"),g=u.attr("data-sizes")||E.$slider.attr("data-sizes"),(x=document.createElement("img")).onload=function(){m&&(u.attr("srcset",m),g&&u.attr("sizes",g)),u.attr("src",d).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),E.options.adaptiveHeight===!0&&E.setPosition(),E.$slider.trigger("lazyLoaded",[E,u,d]),E.progressiveLazyLoad()},x.onerror=function(){h<3?setTimeout(function(){E.progressiveLazyLoad(h+1)},500):(u.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),E.$slider.trigger("lazyLoadError",[E,u,d]),E.progressiveLazyLoad())},x.src=d):E.$slider.trigger("allImagesLoaded",[E])},c.prototype.refresh=function(h){var u,d,m=this;d=m.slideCount-m.options.slidesToShow,!m.options.infinite&&m.currentSlide>d&&(m.currentSlide=d),m.slideCount<=m.options.slidesToShow&&(m.currentSlide=0),u=m.currentSlide,m.destroy(!0),n.extend(m,m.initials,{currentSlide:u}),m.init(),h||m.changeSlide({data:{message:"index",index:u}},!1)},c.prototype.registerBreakpoints=function(){var h,u,d,m=this,g=m.options.responsive||null;if(n.type(g)==="array"&&g.length){m.respondTo=m.options.respondTo||"window";for(h in g)if(d=m.breakpoints.length-1,g.hasOwnProperty(h)){for(u=g[h].breakpoint;d>=0;)m.breakpoints[d]&&m.breakpoints[d]===u&&m.breakpoints.splice(d,1),d--;m.breakpoints.push(u),m.breakpointSettings[u]=g[h].settings}m.breakpoints.sort(function(x,E){return m.options.mobileFirst?x-E:E-x})}},c.prototype.reinit=function(){var h=this;h.$slides=h.$slideTrack.children(h.options.slide).addClass("slick-slide"),h.slideCount=h.$slides.length,h.currentSlide>=h.slideCount&&h.currentSlide!==0&&(h.currentSlide=h.currentSlide-h.options.slidesToScroll),h.slideCount<=h.options.slidesToShow&&(h.currentSlide=0),h.registerBreakpoints(),h.setProps(),h.setupInfinite(),h.buildArrows(),h.updateArrows(),h.initArrowEvents(),h.buildDots(),h.updateDots(),h.initDotEvents(),h.cleanUpSlideEvents(),h.initSlideEvents(),h.checkResponsive(!1,!0),h.options.focusOnSelect===!0&&n(h.$slideTrack).children().on("click.slick",h.selectHandler),h.setSlideClasses(typeof h.currentSlide=="number"?h.currentSlide:0),h.setPosition(),h.focusHandler(),h.paused=!h.options.autoplay,h.autoPlay(),h.$slider.trigger("reInit",[h])},c.prototype.resize=function(){var h=this;n(window).width()!==h.windowWidth&&(clearTimeout(h.windowDelay),h.windowDelay=window.setTimeout(function(){h.windowWidth=n(window).width(),h.checkResponsive(),h.unslicked||h.setPosition()},50))},c.prototype.removeSlide=c.prototype.slickRemove=function(h,u,d){var m=this;if(h=typeof h=="boolean"?(u=h)===!0?0:m.slideCount-1:u===!0?--h:h,m.slideCount<1||h<0||h>m.slideCount-1)return!1;m.unload(),d===!0?m.$slideTrack.children().remove():m.$slideTrack.children(this.options.slide).eq(h).remove(),m.$slides=m.$slideTrack.children(this.options.slide),m.$slideTrack.children(this.options.slide).detach(),m.$slideTrack.append(m.$slides),m.$slidesCache=m.$slides,m.reinit()},c.prototype.setCSS=function(h){var u,d,m=this,g={};m.options.rtl===!0&&(h=-h),u=m.positionProp=="left"?Math.ceil(h)+"px":"0px",d=m.positionProp=="top"?Math.ceil(h)+"px":"0px",g[m.positionProp]=h,m.transformsEnabled===!1?m.$slideTrack.css(g):(g={},m.cssTransitions===!1?(g[m.animType]="translate("+u+", "+d+")",m.$slideTrack.css(g)):(g[m.animType]="translate3d("+u+", "+d+", 0px)",m.$slideTrack.css(g)))},c.prototype.setDimensions=function(){var h=this;h.options.vertical===!1?h.options.centerMode===!0&&h.$list.css({padding:"0px "+h.options.centerPadding}):(h.$list.height(h.$slides.first().outerHeight(!0)*h.options.slidesToShow),h.options.centerMode===!0&&h.$list.css({padding:h.options.centerPadding+" 0px"})),h.listWidth=h.$list.width(),h.listHeight=h.$list.height(),h.options.vertical===!1&&h.options.variableWidth===!1?(h.slideWidth=Math.ceil(h.listWidth/h.options.slidesToShow),h.$slideTrack.width(Math.ceil(h.slideWidth*h.$slideTrack.children(".slick-slide").length))):h.options.variableWidth===!0?h.$slideTrack.width(5e3*h.slideCount):(h.slideWidth=Math.ceil(h.listWidth),h.$slideTrack.height(Math.ceil(h.$slides.first().outerHeight(!0)*h.$slideTrack.children(".slick-slide").length)));var u=h.$slides.first().outerWidth(!0)-h.$slides.first().width();h.options.variableWidth===!1&&h.$slideTrack.children(".slick-slide").width(h.slideWidth-u)},c.prototype.setFade=function(){var h,u=this;u.$slides.each(function(d,m){h=u.slideWidth*d*-1,u.options.rtl===!0?n(m).css({position:"relative",right:h,top:0,zIndex:u.options.zIndex-2,opacity:0}):n(m).css({position:"relative",left:h,top:0,zIndex:u.options.zIndex-2,opacity:0})}),u.$slides.eq(u.currentSlide).css({zIndex:u.options.zIndex-1,opacity:1})},c.prototype.setHeight=function(){var h=this;if(h.options.slidesToShow===1&&h.options.adaptiveHeight===!0&&h.options.vertical===!1){var u=h.$slides.eq(h.currentSlide).outerHeight(!0);h.$list.css("height",u)}},c.prototype.setOption=c.prototype.slickSetOption=function(){var h,u,d,m,g,x=this,E=!1;if(n.type(arguments[0])==="object"?(d=arguments[0],E=arguments[1],g="multiple"):n.type(arguments[0])==="string"&&(d=arguments[0],m=arguments[1],E=arguments[2],arguments[0]==="responsive"&&n.type(arguments[1])==="array"?g="responsive":arguments[1]!==void 0&&(g="single")),g==="single")x.options[d]=m;else if(g==="multiple")n.each(d,function(P,L){x.options[P]=L});else if(g==="responsive")for(u in m)if(n.type(x.options.responsive)!=="array")x.options.responsive=[m[u]];else{for(h=x.options.responsive.length-1;h>=0;)x.options.responsive[h].breakpoint===m[u].breakpoint&&x.options.responsive.splice(h,1),h--;x.options.responsive.push(m[u])}E&&(x.unload(),x.reinit())},c.prototype.setPosition=function(){var h=this;h.setDimensions(),h.setHeight(),h.options.fade===!1?h.setCSS(h.getLeft(h.currentSlide)):h.setFade(),h.$slider.trigger("setPosition",[h])},c.prototype.setProps=function(){var h=this,u=document.body.style;h.positionProp=h.options.vertical===!0?"top":"left",h.positionProp==="top"?h.$slider.addClass("slick-vertical"):h.$slider.removeClass("slick-vertical"),u.WebkitTransition===void 0&&u.MozTransition===void 0&&u.msTransition===void 0||h.options.useCSS===!0&&(h.cssTransitions=!0),h.options.fade&&(typeof h.options.zIndex=="number"?h.options.zIndex<3&&(h.options.zIndex=3):h.options.zIndex=h.defaults.zIndex),u.OTransform!==void 0&&(h.animType="OTransform",h.transformType="-o-transform",h.transitionType="OTransition",u.perspectiveProperty===void 0&&u.webkitPerspective===void 0&&(h.animType=!1)),u.MozTransform!==void 0&&(h.animType="MozTransform",h.transformType="-moz-transform",h.transitionType="MozTransition",u.perspectiveProperty===void 0&&u.MozPerspective===void 0&&(h.animType=!1)),u.webkitTransform!==void 0&&(h.animType="webkitTransform",h.transformType="-webkit-transform",h.transitionType="webkitTransition",u.perspectiveProperty===void 0&&u.webkitPerspective===void 0&&(h.animType=!1)),u.msTransform!==void 0&&(h.animType="msTransform",h.transformType="-ms-transform",h.transitionType="msTransition",u.msTransform===void 0&&(h.animType=!1)),u.transform!==void 0&&h.animType!==!1&&(h.animType="transform",h.transformType="transform",h.transitionType="transition"),h.transformsEnabled=h.options.useTransform&&h.animType!==null&&h.animType!==!1},c.prototype.setSlideClasses=function(h){var u,d,m,g,x=this;if(d=x.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),x.$slides.eq(h).addClass("slick-current"),x.options.centerMode===!0){var E=x.options.slidesToShow%2==0?1:0;u=Math.floor(x.options.slidesToShow/2),x.options.infinite===!0&&(h>=u&&h<=x.slideCount-1-u?x.$slides.slice(h-u+E,h+u+1).addClass("slick-active").attr("aria-hidden","false"):(m=x.options.slidesToShow+h,d.slice(m-u+1+E,m+u+2).addClass("slick-active").attr("aria-hidden","false")),h===0?d.eq(d.length-1-x.options.slidesToShow).addClass("slick-center"):h===x.slideCount-1&&d.eq(x.options.slidesToShow).addClass("slick-center")),x.$slides.eq(h).addClass("slick-center")}else h>=0&&h<=x.slideCount-x.options.slidesToShow?x.$slides.slice(h,h+x.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):d.length<=x.options.slidesToShow?d.addClass("slick-active").attr("aria-hidden","false"):(g=x.slideCount%x.options.slidesToShow,m=x.options.infinite===!0?x.options.slidesToShow+h:h,x.options.slidesToShow==x.options.slidesToScroll&&x.slideCount-h<x.options.slidesToShow?d.slice(m-(x.options.slidesToShow-g),m+g).addClass("slick-active").attr("aria-hidden","false"):d.slice(m,m+x.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));x.options.lazyLoad!=="ondemand"&&x.options.lazyLoad!=="anticipated"||x.lazyLoad()},c.prototype.setupInfinite=function(){var h,u,d,m=this;if(m.options.fade===!0&&(m.options.centerMode=!1),m.options.infinite===!0&&m.options.fade===!1&&(u=null,m.slideCount>m.options.slidesToShow)){for(d=m.options.centerMode===!0?m.options.slidesToShow+1:m.options.slidesToShow,h=m.slideCount;h>m.slideCount-d;h-=1)u=h-1,n(m.$slides[u]).clone(!0).attr("id","").attr("data-slick-index",u-m.slideCount).prependTo(m.$slideTrack).addClass("slick-cloned");for(h=0;h<d+m.slideCount;h+=1)u=h,n(m.$slides[u]).clone(!0).attr("id","").attr("data-slick-index",u+m.slideCount).appendTo(m.$slideTrack).addClass("slick-cloned");m.$slideTrack.find(".slick-cloned").find("[id]").each(function(){n(this).attr("id","")})}},c.prototype.interrupt=function(h){var u=this;h||u.autoPlay(),u.interrupted=h},c.prototype.selectHandler=function(h){var u=this,d=n(h.target).is(".slick-slide")?n(h.target):n(h.target).parents(".slick-slide"),m=parseInt(d.attr("data-slick-index"));m||(m=0),u.slideCount<=u.options.slidesToShow?u.slideHandler(m,!1,!0):u.slideHandler(m)},c.prototype.slideHandler=function(h,u,d){var m,g,x,E,P,L=null,F=this;if(u=u||!1,!(F.animating===!0&&F.options.waitForAnimate===!0||F.options.fade===!0&&F.currentSlide===h))if(u===!1&&F.asNavFor(h),m=h,L=F.getLeft(m),E=F.getLeft(F.currentSlide),F.currentLeft=F.swipeLeft===null?E:F.swipeLeft,F.options.infinite===!1&&F.options.centerMode===!1&&(h<0||h>F.getDotCount()*F.options.slidesToScroll))F.options.fade===!1&&(m=F.currentSlide,d!==!0?F.animateSlide(E,function(){F.postSlide(m)}):F.postSlide(m));else if(F.options.infinite===!1&&F.options.centerMode===!0&&(h<0||h>F.slideCount-F.options.slidesToScroll))F.options.fade===!1&&(m=F.currentSlide,d!==!0?F.animateSlide(E,function(){F.postSlide(m)}):F.postSlide(m));else{if(F.options.autoplay&&clearInterval(F.autoPlayTimer),g=m<0?F.slideCount%F.options.slidesToScroll!=0?F.slideCount-F.slideCount%F.options.slidesToScroll:F.slideCount+m:m>=F.slideCount?F.slideCount%F.options.slidesToScroll!=0?0:m-F.slideCount:m,F.animating=!0,F.$slider.trigger("beforeChange",[F,F.currentSlide,g]),x=F.currentSlide,F.currentSlide=g,F.setSlideClasses(F.currentSlide),F.options.asNavFor&&(P=(P=F.getNavTarget()).slick("getSlick")).slideCount<=P.options.slidesToShow&&P.setSlideClasses(F.currentSlide),F.updateDots(),F.updateArrows(),F.options.fade===!0)return d!==!0?(F.fadeSlideOut(x),F.fadeSlide(g,function(){F.postSlide(g)})):F.postSlide(g),void F.animateHeight();d!==!0?F.animateSlide(L,function(){F.postSlide(g)}):F.postSlide(g)}},c.prototype.startLoad=function(){var h=this;h.options.arrows===!0&&h.slideCount>h.options.slidesToShow&&(h.$prevArrow.hide(),h.$nextArrow.hide()),h.options.dots===!0&&h.slideCount>h.options.slidesToShow&&h.$dots.hide(),h.$slider.addClass("slick-loading")},c.prototype.swipeDirection=function(){var h,u,d,m,g=this;return h=g.touchObject.startX-g.touchObject.curX,u=g.touchObject.startY-g.touchObject.curY,d=Math.atan2(u,h),(m=Math.round(180*d/Math.PI))<0&&(m=360-Math.abs(m)),m<=45&&m>=0||m<=360&&m>=315?g.options.rtl===!1?"left":"right":m>=135&&m<=225?g.options.rtl===!1?"right":"left":g.options.verticalSwiping===!0?m>=35&&m<=135?"down":"up":"vertical"},c.prototype.swipeEnd=function(h){var u,d,m=this;if(m.dragging=!1,m.swiping=!1,m.scrolling)return m.scrolling=!1,!1;if(m.interrupted=!1,m.shouldClick=!(m.touchObject.swipeLength>10),m.touchObject.curX===void 0)return!1;if(m.touchObject.edgeHit===!0&&m.$slider.trigger("edge",[m,m.swipeDirection()]),m.touchObject.swipeLength>=m.touchObject.minSwipe){switch(d=m.swipeDirection()){case"left":case"down":u=m.options.swipeToSlide?m.checkNavigable(m.currentSlide+m.getSlideCount()):m.currentSlide+m.getSlideCount(),m.currentDirection=0;break;case"right":case"up":u=m.options.swipeToSlide?m.checkNavigable(m.currentSlide-m.getSlideCount()):m.currentSlide-m.getSlideCount(),m.currentDirection=1}d!="vertical"&&(m.slideHandler(u),m.touchObject={},m.$slider.trigger("swipe",[m,d]))}else m.touchObject.startX!==m.touchObject.curX&&(m.slideHandler(m.currentSlide),m.touchObject={})},c.prototype.swipeHandler=function(h){var u=this;if(!(u.options.swipe===!1||"ontouchend"in document&&u.options.swipe===!1||u.options.draggable===!1&&h.type.indexOf("mouse")!==-1))switch(u.touchObject.fingerCount=h.originalEvent&&h.originalEvent.touches!==void 0?h.originalEvent.touches.length:1,u.touchObject.minSwipe=u.listWidth/u.options.touchThreshold,u.options.verticalSwiping===!0&&(u.touchObject.minSwipe=u.listHeight/u.options.touchThreshold),h.data.action){case"start":u.swipeStart(h);break;case"move":u.swipeMove(h);break;case"end":u.swipeEnd(h)}},c.prototype.swipeMove=function(h){var u,d,m,g,x,E,P=this;return x=h.originalEvent!==void 0?h.originalEvent.touches:null,!(!P.dragging||P.scrolling||x&&x.length!==1)&&(u=P.getLeft(P.currentSlide),P.touchObject.curX=x!==void 0?x[0].pageX:h.clientX,P.touchObject.curY=x!==void 0?x[0].pageY:h.clientY,P.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(P.touchObject.curX-P.touchObject.startX,2))),E=Math.round(Math.sqrt(Math.pow(P.touchObject.curY-P.touchObject.startY,2))),!P.options.verticalSwiping&&!P.swiping&&E>4?(P.scrolling=!0,!1):(P.options.verticalSwiping===!0&&(P.touchObject.swipeLength=E),d=P.swipeDirection(),h.originalEvent!==void 0&&P.touchObject.swipeLength>4&&(P.swiping=!0,h.preventDefault()),g=(P.options.rtl===!1?1:-1)*(P.touchObject.curX>P.touchObject.startX?1:-1),P.options.verticalSwiping===!0&&(g=P.touchObject.curY>P.touchObject.startY?1:-1),m=P.touchObject.swipeLength,P.touchObject.edgeHit=!1,P.options.infinite===!1&&(P.currentSlide===0&&d==="right"||P.currentSlide>=P.getDotCount()&&d==="left")&&(m=P.touchObject.swipeLength*P.options.edgeFriction,P.touchObject.edgeHit=!0),P.options.vertical===!1?P.swipeLeft=u+m*g:P.swipeLeft=u+m*(P.$list.height()/P.listWidth)*g,P.options.verticalSwiping===!0&&(P.swipeLeft=u+m*g),P.options.fade!==!0&&P.options.touchMove!==!1&&(P.animating===!0?(P.swipeLeft=null,!1):void P.setCSS(P.swipeLeft))))},c.prototype.swipeStart=function(h){var u,d=this;if(d.interrupted=!0,d.touchObject.fingerCount!==1||d.slideCount<=d.options.slidesToShow)return d.touchObject={},!1;h.originalEvent!==void 0&&h.originalEvent.touches!==void 0&&(u=h.originalEvent.touches[0]),d.touchObject.startX=d.touchObject.curX=u!==void 0?u.pageX:h.clientX,d.touchObject.startY=d.touchObject.curY=u!==void 0?u.pageY:h.clientY,d.dragging=!0},c.prototype.unfilterSlides=c.prototype.slickUnfilter=function(){var h=this;h.$slidesCache!==null&&(h.unload(),h.$slideTrack.children(this.options.slide).detach(),h.$slidesCache.appendTo(h.$slideTrack),h.reinit())},c.prototype.unload=function(){var h=this;n(".slick-cloned",h.$slider).remove(),h.$dots&&h.$dots.remove(),h.$prevArrow&&h.htmlExpr.test(h.options.prevArrow)&&h.$prevArrow.remove(),h.$nextArrow&&h.htmlExpr.test(h.options.nextArrow)&&h.$nextArrow.remove(),h.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},c.prototype.unslick=function(h){var u=this;u.$slider.trigger("unslick",[u,h]),u.destroy()},c.prototype.updateArrows=function(){var h=this;Math.floor(h.options.slidesToShow/2),h.options.arrows===!0&&h.slideCount>h.options.slidesToShow&&!h.options.infinite&&(h.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),h.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),h.currentSlide===0?(h.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),h.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):(h.currentSlide>=h.slideCount-h.options.slidesToShow&&h.options.centerMode===!1||h.currentSlide>=h.slideCount-1&&h.options.centerMode===!0)&&(h.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),h.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},c.prototype.updateDots=function(){var h=this;h.$dots!==null&&(h.$dots.find("li").removeClass("slick-active").end(),h.$dots.find("li").eq(Math.floor(h.currentSlide/h.options.slidesToScroll)).addClass("slick-active"))},c.prototype.visibility=function(){var h=this;h.options.autoplay&&(document[h.hidden]?h.interrupted=!0:h.interrupted=!1)},n.fn.slick=function(){var h,u,d=this,m=arguments[0],g=Array.prototype.slice.call(arguments,1),x=d.length;for(h=0;h<x;h++)if(typeof m=="object"||m===void 0?d[h].slick=new c(d[h],m):u=d[h].slick[m].apply(d[h].slick,g),u!==void 0)return u;return d}});/*! For license information please see ol.js.LICENSE.txt */(function(n,c){typeof exports=="object"&&typeof module=="object"?module.exports=c():typeof define=="function"&&define.amd?define([],c):typeof exports=="object"?exports.ol=c():n.ol=c()})(self,function(){return function(){var n,c={226:function(m,g){g.read=function(x,E,P,L,F){var U,A,G=8*F-L-1,B=(1<<G)-1,O=B>>1,K=-7,Q=P?F-1:0,et=P?-1:1,lt=x[E+Q];for(Q+=et,U=lt&(1<<-K)-1,lt>>=-K,K+=G;K>0;U=256*U+x[E+Q],Q+=et,K-=8);for(A=U&(1<<-K)-1,U>>=-K,K+=L;K>0;A=256*A+x[E+Q],Q+=et,K-=8);if(U===0)U=1-O;else{if(U===B)return A?NaN:1/0*(lt?-1:1);A+=Math.pow(2,L),U-=O}return(lt?-1:1)*A*Math.pow(2,U-L)},g.write=function(x,E,P,L,F,U){var A,G,B,O=8*U-F-1,K=(1<<O)-1,Q=K>>1,et=F===23?Math.pow(2,-24)-Math.pow(2,-77):0,lt=L?0:U-1,pt=L?1:-1,T=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(G=isNaN(E)?1:0,A=K):(A=Math.floor(Math.log(E)/Math.LN2),E*(B=Math.pow(2,-A))<1&&(A--,B*=2),(E+=A+Q>=1?et/B:et*Math.pow(2,1-Q))*B>=2&&(A++,B/=2),A+Q>=K?(G=0,A=K):A+Q>=1?(G=(E*B-1)*Math.pow(2,F),A+=Q):(G=E*Math.pow(2,Q-1)*Math.pow(2,F),A=0));F>=8;x[P+lt]=255&G,lt+=pt,G/=256,F-=8);for(A=A<<F|G,O+=F;O>0;x[P+lt]=255&A,lt+=pt,A/=256,O-=8);x[P+lt-pt]|=128*T}},875:function(m,g,x){"use strict";const E=x(692),P=Symbol("max"),L=Symbol("length"),F=Symbol("lengthCalculator"),U=Symbol("allowStale"),A=Symbol("maxAge"),G=Symbol("dispose"),B=Symbol("noDisposeOnSet"),O=Symbol("lruList"),K=Symbol("cache"),Q=Symbol("updateAgeOnGet"),et=()=>1,lt=($,_t,W)=>{const rt=$[K].get(_t);if(rt){const nt=rt.value;if(pt($,nt)){if(ct($,rt),!$[U])return}else W&&($[Q]&&(rt.value.now=Date.now()),$[O].unshiftNode(rt));return nt.value}},pt=($,_t)=>{if(!_t||!_t.maxAge&&!$[A])return!1;const W=Date.now()-_t.now;return _t.maxAge?W>_t.maxAge:$[A]&&W>$[A]},T=$=>{if($[L]>$[P])for(let _t=$[O].tail;$[L]>$[P]&&_t!==null;){const W=_t.prev;ct($,_t),_t=W}},ct=($,_t)=>{if(_t){const W=_t.value;$[G]&&$[G](W.key,W.value),$[L]-=W.length,$[K].delete(W.key),$[O].removeNode(_t)}};class ut{constructor(_t,W,rt,nt,vt){this.key=_t,this.value=W,this.length=rt,this.now=nt,this.maxAge=vt||0}}const ft=($,_t,W,rt)=>{let nt=W.value;pt($,nt)&&(ct($,W),$[U]||(nt=void 0)),nt&&_t.call(rt,nt.value,nt.key,$)};m.exports=class{constructor($){if(typeof $=="number"&&($={max:$}),$||($={}),$.max&&(typeof $.max!="number"||$.max<0))throw new TypeError("max must be a non-negative number");this[P]=$.max||1/0;const _t=$.length||et;if(this[F]=typeof _t!="function"?et:_t,this[U]=$.stale||!1,$.maxAge&&typeof $.maxAge!="number")throw new TypeError("maxAge must be a number");this[A]=$.maxAge||0,this[G]=$.dispose,this[B]=$.noDisposeOnSet||!1,this[Q]=$.updateAgeOnGet||!1,this.reset()}set max($){if(typeof $!="number"||$<0)throw new TypeError("max must be a non-negative number");this[P]=$||1/0,T(this)}get max(){return this[P]}set allowStale($){this[U]=!!$}get allowStale(){return this[U]}set maxAge($){if(typeof $!="number")throw new TypeError("maxAge must be a non-negative number");this[A]=$,T(this)}get maxAge(){return this[A]}set lengthCalculator($){typeof $!="function"&&($=et),$!==this[F]&&(this[F]=$,this[L]=0,this[O].forEach(_t=>{_t.length=this[F](_t.value,_t.key),this[L]+=_t.length})),T(this)}get lengthCalculator(){return this[F]}get length(){return this[L]}get itemCount(){return this[O].length}rforEach($,_t){_t=_t||this;for(let W=this[O].tail;W!==null;){const rt=W.prev;ft(this,$,W,_t),W=rt}}forEach($,_t){_t=_t||this;for(let W=this[O].head;W!==null;){const rt=W.next;ft(this,$,W,_t),W=rt}}keys(){return this[O].toArray().map($=>$.key)}values(){return this[O].toArray().map($=>$.value)}reset(){this[G]&&this[O]&&this[O].length&&this[O].forEach($=>this[G]($.key,$.value)),this[K]=new Map,this[O]=new E,this[L]=0}dump(){return this[O].map($=>!pt(this,$)&&{k:$.key,v:$.value,e:$.now+($.maxAge||0)}).toArray().filter($=>$)}dumpLru(){return this[O]}set($,_t,W){if((W=W||this[A])&&typeof W!="number")throw new TypeError("maxAge must be a number");const rt=W?Date.now():0,nt=this[F](_t,$);if(this[K].has($)){if(nt>this[P])return ct(this,this[K].get($)),!1;const Mt=this[K].get($).value;return this[G]&&(this[B]||this[G]($,Mt.value)),Mt.now=rt,Mt.maxAge=W,Mt.value=_t,this[L]+=nt-Mt.length,Mt.length=nt,this.get($),T(this),!0}const vt=new ut($,_t,nt,rt,W);return vt.length>this[P]?(this[G]&&this[G]($,_t),!1):(this[L]+=vt.length,this[O].unshift(vt),this[K].set($,this[O].head),T(this),!0)}has($){if(!this[K].has($))return!1;const _t=this[K].get($).value;return!pt(this,_t)}get($){return lt(this,$,!0)}peek($){return lt(this,$,!1)}pop(){const $=this[O].tail;return $?(ct(this,$),$.value):null}del($){ct(this,this[K].get($))}load($){this.reset();const _t=Date.now();for(let W=$.length-1;W>=0;W--){const rt=$[W],nt=rt.e||0;if(nt===0)this.set(rt.k,rt.v);else{const vt=nt-_t;vt>0&&this.set(rt.k,rt.v,vt)}}}prune(){this[K].forEach(($,_t)=>lt(this,_t,!1))}}},98:function(m,g,x){"use strict";m.exports=P;var E=x(226);function P(W){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(W)?W:new Uint8Array(W||0),this.pos=0,this.type=0,this.length=this.buf.length}P.Varint=0,P.Fixed64=1,P.Bytes=2,P.Fixed32=5;var L=4294967296,F=1/L,U=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function A(W){return W.type===P.Bytes?W.readVarint()+W.pos:W.pos+1}function G(W,rt,nt){return nt?4294967296*rt+(W>>>0):4294967296*(rt>>>0)+(W>>>0)}function B(W,rt,nt){var vt=rt<=16383?1:rt<=2097151?2:rt<=268435455?3:Math.floor(Math.log(rt)/(7*Math.LN2));nt.realloc(vt);for(var Mt=nt.pos-1;Mt>=W;Mt--)nt.buf[Mt+vt]=nt.buf[Mt]}function O(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeVarint(W[nt])}function K(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeSVarint(W[nt])}function Q(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeFloat(W[nt])}function et(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeDouble(W[nt])}function lt(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeBoolean(W[nt])}function pt(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeFixed32(W[nt])}function T(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeSFixed32(W[nt])}function ct(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeFixed64(W[nt])}function ut(W,rt){for(var nt=0;nt<W.length;nt++)rt.writeSFixed64(W[nt])}function ft(W,rt){return(W[rt]|W[rt+1]<<8|W[rt+2]<<16)+16777216*W[rt+3]}function $(W,rt,nt){W[nt]=rt,W[nt+1]=rt>>>8,W[nt+2]=rt>>>16,W[nt+3]=rt>>>24}function _t(W,rt){return(W[rt]|W[rt+1]<<8|W[rt+2]<<16)+(W[rt+3]<<24)}P.prototype={destroy:function(){this.buf=null},readFields:function(W,rt,nt){for(nt=nt||this.length;this.pos<nt;){var vt=this.readVarint(),Mt=vt>>3,Bt=this.pos;this.type=7&vt,W(Mt,rt,this),this.pos===Bt&&this.skip(vt)}return rt},readMessage:function(W,rt){return this.readFields(W,rt,this.readVarint()+this.pos)},readFixed32:function(){var W=ft(this.buf,this.pos);return this.pos+=4,W},readSFixed32:function(){var W=_t(this.buf,this.pos);return this.pos+=4,W},readFixed64:function(){var W=ft(this.buf,this.pos)+ft(this.buf,this.pos+4)*L;return this.pos+=8,W},readSFixed64:function(){var W=ft(this.buf,this.pos)+_t(this.buf,this.pos+4)*L;return this.pos+=8,W},readFloat:function(){var W=E.read(this.buf,this.pos,!0,23,4);return this.pos+=4,W},readDouble:function(){var W=E.read(this.buf,this.pos,!0,52,8);return this.pos+=8,W},readVarint:function(W){var rt,nt,vt=this.buf;return rt=127&(nt=vt[this.pos++]),nt<128?rt:(rt|=(127&(nt=vt[this.pos++]))<<7,nt<128?rt:(rt|=(127&(nt=vt[this.pos++]))<<14,nt<128?rt:(rt|=(127&(nt=vt[this.pos++]))<<21,nt<128?rt:function(Mt,Bt,Vt){var Lt,Ne,ge=Vt.buf;if(Ne=ge[Vt.pos++],Lt=(112&Ne)>>4,Ne<128||(Ne=ge[Vt.pos++],Lt|=(127&Ne)<<3,Ne<128)||(Ne=ge[Vt.pos++],Lt|=(127&Ne)<<10,Ne<128)||(Ne=ge[Vt.pos++],Lt|=(127&Ne)<<17,Ne<128)||(Ne=ge[Vt.pos++],Lt|=(127&Ne)<<24,Ne<128)||(Ne=ge[Vt.pos++],Lt|=(1&Ne)<<31,Ne<128))return G(Mt,Lt,Bt);throw new Error("Expected varint not more than 10 bytes")}(rt|=(15&(nt=vt[this.pos]))<<28,W,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var W=this.readVarint();return W%2==1?(W+1)/-2:W/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var W=this.readVarint()+this.pos,rt=this.pos;return this.pos=W,W-rt>=12&&U?function(nt,vt,Mt){return U.decode(nt.subarray(vt,Mt))}(this.buf,rt,W):function(nt,vt,Mt){for(var Bt="",Vt=vt;Vt<Mt;){var Lt,Ne,ge,Yt=nt[Vt],ue=null,ne=Yt>239?4:Yt>223?3:Yt>191?2:1;if(Vt+ne>Mt)break;ne===1?Yt<128&&(ue=Yt):ne===2?(192&(Lt=nt[Vt+1]))==128&&(ue=(31&Yt)<<6|63&Lt)<=127&&(ue=null):ne===3?(Lt=nt[Vt+1],Ne=nt[Vt+2],(192&Lt)==128&&(192&Ne)==128&&((ue=(15&Yt)<<12|(63&Lt)<<6|63&Ne)<=2047||ue>=55296&&ue<=57343)&&(ue=null)):ne===4&&(Lt=nt[Vt+1],Ne=nt[Vt+2],ge=nt[Vt+3],(192&Lt)==128&&(192&Ne)==128&&(192&ge)==128&&((ue=(15&Yt)<<18|(63&Lt)<<12|(63&Ne)<<6|63&ge)<=65535||ue>=1114112)&&(ue=null)),ue===null?(ue=65533,ne=1):ue>65535&&(ue-=65536,Bt+=String.fromCharCode(ue>>>10&1023|55296),ue=56320|1023&ue),Bt+=String.fromCharCode(ue),Vt+=ne}return Bt}(this.buf,rt,W)},readBytes:function(){var W=this.readVarint()+this.pos,rt=this.buf.subarray(this.pos,W);return this.pos=W,rt},readPackedVarint:function(W,rt){if(this.type!==P.Bytes)return W.push(this.readVarint(rt));var nt=A(this);for(W=W||[];this.pos<nt;)W.push(this.readVarint(rt));return W},readPackedSVarint:function(W){if(this.type!==P.Bytes)return W.push(this.readSVarint());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readSVarint());return W},readPackedBoolean:function(W){if(this.type!==P.Bytes)return W.push(this.readBoolean());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readBoolean());return W},readPackedFloat:function(W){if(this.type!==P.Bytes)return W.push(this.readFloat());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readFloat());return W},readPackedDouble:function(W){if(this.type!==P.Bytes)return W.push(this.readDouble());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readDouble());return W},readPackedFixed32:function(W){if(this.type!==P.Bytes)return W.push(this.readFixed32());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readFixed32());return W},readPackedSFixed32:function(W){if(this.type!==P.Bytes)return W.push(this.readSFixed32());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readSFixed32());return W},readPackedFixed64:function(W){if(this.type!==P.Bytes)return W.push(this.readFixed64());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readFixed64());return W},readPackedSFixed64:function(W){if(this.type!==P.Bytes)return W.push(this.readSFixed64());var rt=A(this);for(W=W||[];this.pos<rt;)W.push(this.readSFixed64());return W},skip:function(W){var rt=7&W;if(rt===P.Varint)for(;this.buf[this.pos++]>127;);else if(rt===P.Bytes)this.pos=this.readVarint()+this.pos;else if(rt===P.Fixed32)this.pos+=4;else{if(rt!==P.Fixed64)throw new Error("Unimplemented type: "+rt);this.pos+=8}},writeTag:function(W,rt){this.writeVarint(W<<3|rt)},realloc:function(W){for(var rt=this.length||16;rt<this.pos+W;)rt*=2;if(rt!==this.length){var nt=new Uint8Array(rt);nt.set(this.buf),this.buf=nt,this.length=rt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(W){this.realloc(4),$(this.buf,W,this.pos),this.pos+=4},writeSFixed32:function(W){this.realloc(4),$(this.buf,W,this.pos),this.pos+=4},writeFixed64:function(W){this.realloc(8),$(this.buf,-1&W,this.pos),$(this.buf,Math.floor(W*F),this.pos+4),this.pos+=8},writeSFixed64:function(W){this.realloc(8),$(this.buf,-1&W,this.pos),$(this.buf,Math.floor(W*F),this.pos+4),this.pos+=8},writeVarint:function(W){(W=+W||0)>268435455||W<0?function(rt,nt){var vt,Mt;if(rt>=0?(vt=rt%4294967296|0,Mt=rt/4294967296|0):(Mt=~(-rt/4294967296),4294967295^(vt=~(-rt%4294967296))?vt=vt+1|0:(vt=0,Mt=Mt+1|0)),rt>=18446744073709552e3||rt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");nt.realloc(10),function(Bt,Vt,Lt){Lt.buf[Lt.pos++]=127&Bt|128,Bt>>>=7,Lt.buf[Lt.pos++]=127&Bt|128,Bt>>>=7,Lt.buf[Lt.pos++]=127&Bt|128,Bt>>>=7,Lt.buf[Lt.pos++]=127&Bt|128,Bt>>>=7,Lt.buf[Lt.pos]=127&Bt}(vt,0,nt),function(Bt,Vt){var Lt=(7&Bt)<<4;Vt.buf[Vt.pos++]|=Lt|((Bt>>>=3)?128:0),Bt&&(Vt.buf[Vt.pos++]=127&Bt|((Bt>>>=7)?128:0),Bt&&(Vt.buf[Vt.pos++]=127&Bt|((Bt>>>=7)?128:0),Bt&&(Vt.buf[Vt.pos++]=127&Bt|((Bt>>>=7)?128:0),Bt&&(Vt.buf[Vt.pos++]=127&Bt|((Bt>>>=7)?128:0),Bt&&(Vt.buf[Vt.pos++]=127&Bt)))))}(Mt,nt)}(W,this):(this.realloc(4),this.buf[this.pos++]=127&W|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=W>>>7&127))))},writeSVarint:function(W){this.writeVarint(W<0?2*-W-1:2*W)},writeBoolean:function(W){this.writeVarint(!!W)},writeString:function(W){W=String(W),this.realloc(4*W.length),this.pos++;var rt=this.pos;this.pos=function(vt,Mt,Bt){for(var Vt,Lt,Ne=0;Ne<Mt.length;Ne++){if((Vt=Mt.charCodeAt(Ne))>55295&&Vt<57344){if(!Lt){Vt>56319||Ne+1===Mt.length?(vt[Bt++]=239,vt[Bt++]=191,vt[Bt++]=189):Lt=Vt;continue}if(Vt<56320){vt[Bt++]=239,vt[Bt++]=191,vt[Bt++]=189,Lt=Vt;continue}Vt=Lt-55296<<10|Vt-56320|65536,Lt=null}else Lt&&(vt[Bt++]=239,vt[Bt++]=191,vt[Bt++]=189,Lt=null);Vt<128?vt[Bt++]=Vt:(Vt<2048?vt[Bt++]=Vt>>6|192:(Vt<65536?vt[Bt++]=Vt>>12|224:(vt[Bt++]=Vt>>18|240,vt[Bt++]=Vt>>12&63|128),vt[Bt++]=Vt>>6&63|128),vt[Bt++]=63&Vt|128)}return Bt}(this.buf,W,this.pos);var nt=this.pos-rt;nt>=128&&B(rt,nt,this),this.pos=rt-1,this.writeVarint(nt),this.pos+=nt},writeFloat:function(W){this.realloc(4),E.write(this.buf,W,this.pos,!0,23,4),this.pos+=4},writeDouble:function(W){this.realloc(8),E.write(this.buf,W,this.pos,!0,52,8),this.pos+=8},writeBytes:function(W){var rt=W.length;this.writeVarint(rt),this.realloc(rt);for(var nt=0;nt<rt;nt++)this.buf[this.pos++]=W[nt]},writeRawMessage:function(W,rt){this.pos++;var nt=this.pos;W(rt,this);var vt=this.pos-nt;vt>=128&&B(nt,vt,this),this.pos=nt-1,this.writeVarint(vt),this.pos+=vt},writeMessage:function(W,rt,nt){this.writeTag(W,P.Bytes),this.writeRawMessage(rt,nt)},writePackedVarint:function(W,rt){rt.length&&this.writeMessage(W,O,rt)},writePackedSVarint:function(W,rt){rt.length&&this.writeMessage(W,K,rt)},writePackedBoolean:function(W,rt){rt.length&&this.writeMessage(W,lt,rt)},writePackedFloat:function(W,rt){rt.length&&this.writeMessage(W,Q,rt)},writePackedDouble:function(W,rt){rt.length&&this.writeMessage(W,et,rt)},writePackedFixed32:function(W,rt){rt.length&&this.writeMessage(W,pt,rt)},writePackedSFixed32:function(W,rt){rt.length&&this.writeMessage(W,T,rt)},writePackedFixed64:function(W,rt){rt.length&&this.writeMessage(W,ct,rt)},writePackedSFixed64:function(W,rt){rt.length&&this.writeMessage(W,ut,rt)},writeBytesField:function(W,rt){this.writeTag(W,P.Bytes),this.writeBytes(rt)},writeFixed32Field:function(W,rt){this.writeTag(W,P.Fixed32),this.writeFixed32(rt)},writeSFixed32Field:function(W,rt){this.writeTag(W,P.Fixed32),this.writeSFixed32(rt)},writeFixed64Field:function(W,rt){this.writeTag(W,P.Fixed64),this.writeFixed64(rt)},writeSFixed64Field:function(W,rt){this.writeTag(W,P.Fixed64),this.writeSFixed64(rt)},writeVarintField:function(W,rt){this.writeTag(W,P.Varint),this.writeVarint(rt)},writeSVarintField:function(W,rt){this.writeTag(W,P.Varint),this.writeSVarint(rt)},writeStringField:function(W,rt){this.writeTag(W,P.Bytes),this.writeString(rt)},writeFloatField:function(W,rt){this.writeTag(W,P.Fixed32),this.writeFloat(rt)},writeDoubleField:function(W,rt){this.writeTag(W,P.Fixed64),this.writeDouble(rt)},writeBooleanField:function(W,rt){this.writeVarintField(W,!!rt)}}},72:function(m){m.exports=function(){"use strict";function g(T,ct,ut,ft,$){(function _t(W,rt,nt,vt,Mt){for(;vt>nt;){if(vt-nt>600){var Bt=vt-nt+1,Vt=rt-nt+1,Lt=Math.log(Bt),Ne=.5*Math.exp(2*Lt/3),ge=.5*Math.sqrt(Lt*Ne*(Bt-Ne)/Bt)*(Vt-Bt/2<0?-1:1);_t(W,rt,Math.max(nt,Math.floor(rt-Vt*Ne/Bt+ge)),Math.min(vt,Math.floor(rt+(Bt-Vt)*Ne/Bt+ge)),Mt)}var Yt=W[rt],ue=nt,ne=vt;for(x(W,nt,rt),Mt(W[vt],Yt)>0&&x(W,nt,vt);ue<ne;){for(x(W,ue,ne),ue++,ne--;Mt(W[ue],Yt)<0;)ue++;for(;Mt(W[ne],Yt)>0;)ne--}Mt(W[nt],Yt)===0?x(W,nt,ne):x(W,++ne,vt),ne<=rt&&(nt=ne+1),rt<=ne&&(vt=ne-1)}})(T,ct,ut||0,ft||T.length-1,$||E)}function x(T,ct,ut){var ft=T[ct];T[ct]=T[ut],T[ut]=ft}function E(T,ct){return T<ct?-1:T>ct?1:0}var P=function(T){T===void 0&&(T=9),this._maxEntries=Math.max(4,T),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function L(T,ct,ut){if(!ut)return ct.indexOf(T);for(var ft=0;ft<ct.length;ft++)if(ut(T,ct[ft]))return ft;return-1}function F(T,ct){U(T,0,T.children.length,ct,T)}function U(T,ct,ut,ft,$){$||($=lt(null)),$.minX=1/0,$.minY=1/0,$.maxX=-1/0,$.maxY=-1/0;for(var _t=ct;_t<ut;_t++){var W=T.children[_t];A($,T.leaf?ft(W):W)}return $}function A(T,ct){return T.minX=Math.min(T.minX,ct.minX),T.minY=Math.min(T.minY,ct.minY),T.maxX=Math.max(T.maxX,ct.maxX),T.maxY=Math.max(T.maxY,ct.maxY),T}function G(T,ct){return T.minX-ct.minX}function B(T,ct){return T.minY-ct.minY}function O(T){return(T.maxX-T.minX)*(T.maxY-T.minY)}function K(T){return T.maxX-T.minX+(T.maxY-T.minY)}function Q(T,ct){return T.minX<=ct.minX&&T.minY<=ct.minY&&ct.maxX<=T.maxX&&ct.maxY<=T.maxY}function et(T,ct){return ct.minX<=T.maxX&&ct.minY<=T.maxY&&ct.maxX>=T.minX&&ct.maxY>=T.minY}function lt(T){return{children:T,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function pt(T,ct,ut,ft,$){for(var _t=[ct,ut];_t.length;)if(!((ut=_t.pop())-(ct=_t.pop())<=ft)){var W=ct+Math.ceil((ut-ct)/ft/2)*ft;g(T,W,ct,ut,$),_t.push(ct,W,W,ut)}}return P.prototype.all=function(){return this._all(this.data,[])},P.prototype.search=function(T){var ct=this.data,ut=[];if(!et(T,ct))return ut;for(var ft=this.toBBox,$=[];ct;){for(var _t=0;_t<ct.children.length;_t++){var W=ct.children[_t],rt=ct.leaf?ft(W):W;et(T,rt)&&(ct.leaf?ut.push(W):Q(T,rt)?this._all(W,ut):$.push(W))}ct=$.pop()}return ut},P.prototype.collides=function(T){var ct=this.data;if(!et(T,ct))return!1;for(var ut=[];ct;){for(var ft=0;ft<ct.children.length;ft++){var $=ct.children[ft],_t=ct.leaf?this.toBBox($):$;if(et(T,_t)){if(ct.leaf||Q(T,_t))return!0;ut.push($)}}ct=ut.pop()}return!1},P.prototype.load=function(T){if(!T||!T.length)return this;if(T.length<this._minEntries){for(var ct=0;ct<T.length;ct++)this.insert(T[ct]);return this}var ut=this._build(T.slice(),0,T.length-1,0);if(this.data.children.length)if(this.data.height===ut.height)this._splitRoot(this.data,ut);else{if(this.data.height<ut.height){var ft=this.data;this.data=ut,ut=ft}this._insert(ut,this.data.height-ut.height-1,!0)}else this.data=ut;return this},P.prototype.insert=function(T){return T&&this._insert(T,this.data.height-1),this},P.prototype.clear=function(){return this.data=lt([]),this},P.prototype.remove=function(T,ct){if(!T)return this;for(var ut,ft,$,_t=this.data,W=this.toBBox(T),rt=[],nt=[];_t||rt.length;){if(_t||(_t=rt.pop(),ft=rt[rt.length-1],ut=nt.pop(),$=!0),_t.leaf){var vt=L(T,_t.children,ct);if(vt!==-1)return _t.children.splice(vt,1),rt.push(_t),this._condense(rt),this}$||_t.leaf||!Q(_t,W)?ft?(ut++,_t=ft.children[ut],$=!1):_t=null:(rt.push(_t),nt.push(ut),ut=0,ft=_t,_t=_t.children[0])}return this},P.prototype.toBBox=function(T){return T},P.prototype.compareMinX=function(T,ct){return T.minX-ct.minX},P.prototype.compareMinY=function(T,ct){return T.minY-ct.minY},P.prototype.toJSON=function(){return this.data},P.prototype.fromJSON=function(T){return this.data=T,this},P.prototype._all=function(T,ct){for(var ut=[];T;)T.leaf?ct.push.apply(ct,T.children):ut.push.apply(ut,T.children),T=ut.pop();return ct},P.prototype._build=function(T,ct,ut,ft){var $,_t=ut-ct+1,W=this._maxEntries;if(_t<=W)return F($=lt(T.slice(ct,ut+1)),this.toBBox),$;ft||(ft=Math.ceil(Math.log(_t)/Math.log(W)),W=Math.ceil(_t/Math.pow(W,ft-1))),($=lt([])).leaf=!1,$.height=ft;var rt=Math.ceil(_t/W),nt=rt*Math.ceil(Math.sqrt(W));pt(T,ct,ut,nt,this.compareMinX);for(var vt=ct;vt<=ut;vt+=nt){var Mt=Math.min(vt+nt-1,ut);pt(T,vt,Mt,rt,this.compareMinY);for(var Bt=vt;Bt<=Mt;Bt+=rt){var Vt=Math.min(Bt+rt-1,Mt);$.children.push(this._build(T,Bt,Vt,ft-1))}}return F($,this.toBBox),$},P.prototype._chooseSubtree=function(T,ct,ut,ft){for(;ft.push(ct),!ct.leaf&&ft.length-1!==ut;){for(var $=1/0,_t=1/0,W=void 0,rt=0;rt<ct.children.length;rt++){var nt=ct.children[rt],vt=O(nt),Mt=(Bt=T,Vt=nt,(Math.max(Vt.maxX,Bt.maxX)-Math.min(Vt.minX,Bt.minX))*(Math.max(Vt.maxY,Bt.maxY)-Math.min(Vt.minY,Bt.minY))-vt);Mt<_t?(_t=Mt,$=vt<$?vt:$,W=nt):Mt===_t&&vt<$&&($=vt,W=nt)}ct=W||ct.children[0]}var Bt,Vt;return ct},P.prototype._insert=function(T,ct,ut){var ft=ut?T:this.toBBox(T),$=[],_t=this._chooseSubtree(ft,this.data,ct,$);for(_t.children.push(T),A(_t,ft);ct>=0&&$[ct].children.length>this._maxEntries;)this._split($,ct),ct--;this._adjustParentBBoxes(ft,$,ct)},P.prototype._split=function(T,ct){var ut=T[ct],ft=ut.children.length,$=this._minEntries;this._chooseSplitAxis(ut,$,ft);var _t=this._chooseSplitIndex(ut,$,ft),W=lt(ut.children.splice(_t,ut.children.length-_t));W.height=ut.height,W.leaf=ut.leaf,F(ut,this.toBBox),F(W,this.toBBox),ct?T[ct-1].children.push(W):this._splitRoot(ut,W)},P.prototype._splitRoot=function(T,ct){this.data=lt([T,ct]),this.data.height=T.height+1,this.data.leaf=!1,F(this.data,this.toBBox)},P.prototype._chooseSplitIndex=function(T,ct,ut){for(var ft,$,_t,W,rt,nt,vt,Mt=1/0,Bt=1/0,Vt=ct;Vt<=ut-ct;Vt++){var Lt=U(T,0,Vt,this.toBBox),Ne=U(T,Vt,ut,this.toBBox),ge=($=Lt,_t=Ne,W=void 0,rt=void 0,nt=void 0,vt=void 0,W=Math.max($.minX,_t.minX),rt=Math.max($.minY,_t.minY),nt=Math.min($.maxX,_t.maxX),vt=Math.min($.maxY,_t.maxY),Math.max(0,nt-W)*Math.max(0,vt-rt)),Yt=O(Lt)+O(Ne);ge<Mt?(Mt=ge,ft=Vt,Bt=Yt<Bt?Yt:Bt):ge===Mt&&Yt<Bt&&(Bt=Yt,ft=Vt)}return ft||ut-ct},P.prototype._chooseSplitAxis=function(T,ct,ut){var ft=T.leaf?this.compareMinX:G,$=T.leaf?this.compareMinY:B;this._allDistMargin(T,ct,ut,ft)<this._allDistMargin(T,ct,ut,$)&&T.children.sort(ft)},P.prototype._allDistMargin=function(T,ct,ut,ft){T.children.sort(ft);for(var $=this.toBBox,_t=U(T,0,ct,$),W=U(T,ut-ct,ut,$),rt=K(_t)+K(W),nt=ct;nt<ut-ct;nt++){var vt=T.children[nt];A(_t,T.leaf?$(vt):vt),rt+=K(_t)}for(var Mt=ut-ct-1;Mt>=ct;Mt--){var Bt=T.children[Mt];A(W,T.leaf?$(Bt):Bt),rt+=K(W)}return rt},P.prototype._adjustParentBBoxes=function(T,ct,ut){for(var ft=ut;ft>=0;ft--)A(ct[ft],T)},P.prototype._condense=function(T){for(var ct=T.length-1,ut=void 0;ct>=0;ct--)T[ct].children.length===0?ct>0?(ut=T[ct-1].children).splice(ut.indexOf(T[ct]),1):this.clear():F(T[ct],this.toBBox)},P}()},760:function(m){var g=function(x){"use strict";var E,P=Object.prototype,L=P.hasOwnProperty,F=typeof Symbol=="function"?Symbol:{},U=F.iterator||"@@iterator",A=F.asyncIterator||"@@asyncIterator",G=F.toStringTag||"@@toStringTag";function B(Yt,ue,ne){return Object.defineProperty(Yt,ue,{value:ne,enumerable:!0,configurable:!0,writable:!0}),Yt[ue]}try{B({},"")}catch{B=function(ue,ne,dr){return ue[ne]=dr}}function O(Yt,ue,ne,dr){var je=ue&&ue.prototype instanceof ct?ue:ct,Br=Object.create(je.prototype),Ue=new Lt(dr||[]);return Br._invoke=function(Fe,Lr,De){var se=Q;return function(oe,Ar){if(se===lt)throw new Error("Generator is already running");if(se===pt){if(oe==="throw")throw Ar;return ge()}for(De.method=oe,De.arg=Ar;;){var vr=De.delegate;if(vr){var Kr=Mt(vr,De);if(Kr){if(Kr===T)continue;return Kr}}if(De.method==="next")De.sent=De._sent=De.arg;else if(De.method==="throw"){if(se===Q)throw se=pt,De.arg;De.dispatchException(De.arg)}else De.method==="return"&&De.abrupt("return",De.arg);se=lt;var wi=K(Fe,Lr,De);if(wi.type==="normal"){if(se=De.done?pt:et,wi.arg===T)continue;return{value:wi.arg,done:De.done}}wi.type==="throw"&&(se=pt,De.method="throw",De.arg=wi.arg)}}}(Yt,ne,Ue),Br}function K(Yt,ue,ne){try{return{type:"normal",arg:Yt.call(ue,ne)}}catch(dr){return{type:"throw",arg:dr}}}x.wrap=O;var Q="suspendedStart",et="suspendedYield",lt="executing",pt="completed",T={};function ct(){}function ut(){}function ft(){}var $={};B($,U,function(){return this});var _t=Object.getPrototypeOf,W=_t&&_t(_t(Ne([])));W&&W!==P&&L.call(W,U)&&($=W);var rt=ft.prototype=ct.prototype=Object.create($);function nt(Yt){["next","throw","return"].forEach(function(ue){B(Yt,ue,function(ne){return this._invoke(ue,ne)})})}function vt(Yt,ue){function ne(je,Br,Ue,Fe){var Lr=K(Yt[je],Yt,Br);if(Lr.type!=="throw"){var De=Lr.arg,se=De.value;return se&&typeof se=="object"&&L.call(se,"__await")?ue.resolve(se.__await).then(function(oe){ne("next",oe,Ue,Fe)},function(oe){ne("throw",oe,Ue,Fe)}):ue.resolve(se).then(function(oe){De.value=oe,Ue(De)},function(oe){return ne("throw",oe,Ue,Fe)})}Fe(Lr.arg)}var dr;this._invoke=function(je,Br){function Ue(){return new ue(function(Fe,Lr){ne(je,Br,Fe,Lr)})}return dr=dr?dr.then(Ue,Ue):Ue()}}function Mt(Yt,ue){var ne=Yt.iterator[ue.method];if(ne===E){if(ue.delegate=null,ue.method==="throw"){if(Yt.iterator.return&&(ue.method="return",ue.arg=E,Mt(Yt,ue),ue.method==="throw"))return T;ue.method="throw",ue.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var dr=K(ne,Yt.iterator,ue.arg);if(dr.type==="throw")return ue.method="throw",ue.arg=dr.arg,ue.delegate=null,T;var je=dr.arg;return je?je.done?(ue[Yt.resultName]=je.value,ue.next=Yt.nextLoc,ue.method!=="return"&&(ue.method="next",ue.arg=E),ue.delegate=null,T):je:(ue.method="throw",ue.arg=new TypeError("iterator result is not an object"),ue.delegate=null,T)}function Bt(Yt){var ue={tryLoc:Yt[0]};1 in Yt&&(ue.catchLoc=Yt[1]),2 in Yt&&(ue.finallyLoc=Yt[2],ue.afterLoc=Yt[3]),this.tryEntries.push(ue)}function Vt(Yt){var ue=Yt.completion||{};ue.type="normal",delete ue.arg,Yt.completion=ue}function Lt(Yt){this.tryEntries=[{tryLoc:"root"}],Yt.forEach(Bt,this),this.reset(!0)}function Ne(Yt){if(Yt){var ue=Yt[U];if(ue)return ue.call(Yt);if(typeof Yt.next=="function")return Yt;if(!isNaN(Yt.length)){var ne=-1,dr=function je(){for(;++ne<Yt.length;)if(L.call(Yt,ne))return je.value=Yt[ne],je.done=!1,je;return je.value=E,je.done=!0,je};return dr.next=dr}}return{next:ge}}function ge(){return{value:E,done:!0}}return ut.prototype=ft,B(rt,"constructor",ft),B(ft,"constructor",ut),ut.displayName=B(ft,G,"GeneratorFunction"),x.isGeneratorFunction=function(Yt){var ue=typeof Yt=="function"&&Yt.constructor;return!!ue&&(ue===ut||(ue.displayName||ue.name)==="GeneratorFunction")},x.mark=function(Yt){return Object.setPrototypeOf?Object.setPrototypeOf(Yt,ft):(Yt.__proto__=ft,B(Yt,G,"GeneratorFunction")),Yt.prototype=Object.create(rt),Yt},x.awrap=function(Yt){return{__await:Yt}},nt(vt.prototype),B(vt.prototype,A,function(){return this}),x.AsyncIterator=vt,x.async=function(Yt,ue,ne,dr,je){je===void 0&&(je=Promise);var Br=new vt(O(Yt,ue,ne,dr),je);return x.isGeneratorFunction(ue)?Br:Br.next().then(function(Ue){return Ue.done?Ue.value:Br.next()})},nt(rt),B(rt,G,"Generator"),B(rt,U,function(){return this}),B(rt,"toString",function(){return"[object Generator]"}),x.keys=function(Yt){var ue=[];for(var ne in Yt)ue.push(ne);return ue.reverse(),function dr(){for(;ue.length;){var je=ue.pop();if(je in Yt)return dr.value=je,dr.done=!1,dr}return dr.done=!0,dr}},x.values=Ne,Lt.prototype={constructor:Lt,reset:function(Yt){if(this.prev=0,this.next=0,this.sent=this._sent=E,this.done=!1,this.delegate=null,this.method="next",this.arg=E,this.tryEntries.forEach(Vt),!Yt)for(var ue in this)ue.charAt(0)==="t"&&L.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=E)},stop:function(){this.done=!0;var Yt=this.tryEntries[0].completion;if(Yt.type==="throw")throw Yt.arg;return this.rval},dispatchException:function(Yt){if(this.done)throw Yt;var ue=this;function ne(Lr,De){return Br.type="throw",Br.arg=Yt,ue.next=Lr,De&&(ue.method="next",ue.arg=E),!!De}for(var dr=this.tryEntries.length-1;dr>=0;--dr){var je=this.tryEntries[dr],Br=je.completion;if(je.tryLoc==="root")return ne("end");if(je.tryLoc<=this.prev){var Ue=L.call(je,"catchLoc"),Fe=L.call(je,"finallyLoc");if(Ue&&Fe){if(this.prev<je.catchLoc)return ne(je.catchLoc,!0);if(this.prev<je.finallyLoc)return ne(je.finallyLoc)}else if(Ue){if(this.prev<je.catchLoc)return ne(je.catchLoc,!0)}else{if(!Fe)throw new Error("try statement without catch or finally");if(this.prev<je.finallyLoc)return ne(je.finallyLoc)}}}},abrupt:function(Yt,ue){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var dr=this.tryEntries[ne];if(dr.tryLoc<=this.prev&&L.call(dr,"finallyLoc")&&this.prev<dr.finallyLoc){var je=dr;break}}je&&(Yt==="break"||Yt==="continue")&&je.tryLoc<=ue&&ue<=je.finallyLoc&&(je=null);var Br=je?je.completion:{};return Br.type=Yt,Br.arg=ue,je?(this.method="next",this.next=je.finallyLoc,T):this.complete(Br)},complete:function(Yt,ue){if(Yt.type==="throw")throw Yt.arg;return Yt.type==="break"||Yt.type==="continue"?this.next=Yt.arg:Yt.type==="return"?(this.rval=this.arg=Yt.arg,this.method="return",this.next="end"):Yt.type==="normal"&&ue&&(this.next=ue),T},finish:function(Yt){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var ne=this.tryEntries[ue];if(ne.finallyLoc===Yt)return this.complete(ne.completion,ne.afterLoc),Vt(ne),T}},catch:function(Yt){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var ne=this.tryEntries[ue];if(ne.tryLoc===Yt){var dr=ne.completion;if(dr.type==="throw"){var je=dr.arg;Vt(ne)}return je}}throw new Error("illegal catch attempt")},delegateYield:function(Yt,ue,ne){return this.delegate={iterator:Ne(Yt),resultName:ue,nextLoc:ne},this.method==="next"&&(this.arg=E),T}},x}(m.exports);try{regeneratorRuntime=g}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=g:Function("r","regeneratorRuntime = r")(g)}},617:function(m,g,x){const E=x(279);m.exports=function(P,L,F){const U=F&&F.debug||!1,A=F&&F.startIndex||0;U&&console.log("starting findTagByName with",L," and ",F);const G=E(P,`<${L}[ >]`,A);if(U&&console.log("start:",G),G===-1)return;const B=P.slice(G+L.length);let O=E(B,"[ /]"+L+">",0);const K=O===-1;K&&(O=E(B,"[ /]>",0));const Q=G+L.length+O+1+(K?0:L.length)+1;if(U&&console.log("end:",Q),Q===-1)return;const et=P.slice(G,Q);let lt;return lt=K?null:et.slice(et.indexOf(">")+1,et.lastIndexOf("<")),{inner:lt,outer:et,start:G,end:Q}}},51:function(m,g,x){const E=x(617);m.exports=function(P,L,F){const U=[],A=F&&F.debug||!1;let G,B=F&&F.startIndex||0;for(;G=E(P,L,{debug:A,startIndex:B});)B=G.end,U.push(G);return A&&console.log("findTagsByName found",U.length,"tags"),U}},802:function(m){m.exports=function(g,x,E){const P=E&&E.debug||!1;P&&console.log("getting "+x+" in "+g);const L=typeof g=="object"?g.outer:g,F=`${x}\\="([^"]*)"`;P&&console.log("pattern:",F);const U=new RegExp(F).exec(L);if(P&&console.log("match:",U),U)return U[1]}},279:function(m){m.exports=function(g,x,E){const P=new RegExp(x).exec(g.slice(E));return P?E+P.index:-1}},518:function(m){"use strict";m.exports=function(g){g.prototype[Symbol.iterator]=function*(){for(let x=this.head;x;x=x.next)yield x.value}}},692:function(m,g,x){"use strict";function E(A){var G=this;if(G instanceof E||(G=new E),G.tail=null,G.head=null,G.length=0,A&&typeof A.forEach=="function")A.forEach(function(K){G.push(K)});else if(arguments.length>0)for(var B=0,O=arguments.length;B<O;B++)G.push(arguments[B]);return G}function P(A,G,B){var O=G===A.head?new U(B,null,G,A):new U(B,G,G.next,A);return O.next===null&&(A.tail=O),O.prev===null&&(A.head=O),A.length++,O}function L(A,G){A.tail=new U(G,A.tail,null,A),A.head||(A.head=A.tail),A.length++}function F(A,G){A.head=new U(G,null,A.head,A),A.tail||(A.tail=A.head),A.length++}function U(A,G,B,O){if(!(this instanceof U))return new U(A,G,B,O);this.list=O,this.value=A,G?(G.next=this,this.prev=G):this.prev=null,B?(B.prev=this,this.next=B):this.next=null}m.exports=E,E.Node=U,E.create=E,E.prototype.removeNode=function(A){if(A.list!==this)throw new Error("removing node which does not belong to this list");var G=A.next,B=A.prev;return G&&(G.prev=B),B&&(B.next=G),A===this.head&&(this.head=G),A===this.tail&&(this.tail=B),A.list.length--,A.next=null,A.prev=null,A.list=null,G},E.prototype.unshiftNode=function(A){if(A!==this.head){A.list&&A.list.removeNode(A);var G=this.head;A.list=this,A.next=G,G&&(G.prev=A),this.head=A,this.tail||(this.tail=A),this.length++}},E.prototype.pushNode=function(A){if(A!==this.tail){A.list&&A.list.removeNode(A);var G=this.tail;A.list=this,A.prev=G,G&&(G.next=A),this.tail=A,this.head||(this.head=A),this.length++}},E.prototype.push=function(){for(var A=0,G=arguments.length;A<G;A++)L(this,arguments[A]);return this.length},E.prototype.unshift=function(){for(var A=0,G=arguments.length;A<G;A++)F(this,arguments[A]);return this.length},E.prototype.pop=function(){if(this.tail){var A=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,A}},E.prototype.shift=function(){if(this.head){var A=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,A}},E.prototype.forEach=function(A,G){G=G||this;for(var B=this.head,O=0;B!==null;O++)A.call(G,B.value,O,this),B=B.next},E.prototype.forEachReverse=function(A,G){G=G||this;for(var B=this.tail,O=this.length-1;B!==null;O--)A.call(G,B.value,O,this),B=B.prev},E.prototype.get=function(A){for(var G=0,B=this.head;B!==null&&G<A;G++)B=B.next;if(G===A&&B!==null)return B.value},E.prototype.getReverse=function(A){for(var G=0,B=this.tail;B!==null&&G<A;G++)B=B.prev;if(G===A&&B!==null)return B.value},E.prototype.map=function(A,G){G=G||this;for(var B=new E,O=this.head;O!==null;)B.push(A.call(G,O.value,this)),O=O.next;return B},E.prototype.mapReverse=function(A,G){G=G||this;for(var B=new E,O=this.tail;O!==null;)B.push(A.call(G,O.value,this)),O=O.prev;return B},E.prototype.reduce=function(A,G){var B,O=this.head;if(arguments.length>1)B=G;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");O=this.head.next,B=this.head.value}for(var K=0;O!==null;K++)B=A(B,O.value,K),O=O.next;return B},E.prototype.reduceReverse=function(A,G){var B,O=this.tail;if(arguments.length>1)B=G;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");O=this.tail.prev,B=this.tail.value}for(var K=this.length-1;O!==null;K--)B=A(B,O.value,K),O=O.prev;return B},E.prototype.toArray=function(){for(var A=new Array(this.length),G=0,B=this.head;B!==null;G++)A[G]=B.value,B=B.next;return A},E.prototype.toArrayReverse=function(){for(var A=new Array(this.length),G=0,B=this.tail;B!==null;G++)A[G]=B.value,B=B.prev;return A},E.prototype.slice=function(A,G){(G=G||this.length)<0&&(G+=this.length),(A=A||0)<0&&(A+=this.length);var B=new E;if(G<A||G<0)return B;A<0&&(A=0),G>this.length&&(G=this.length);for(var O=0,K=this.head;K!==null&&O<A;O++)K=K.next;for(;K!==null&&O<G;O++,K=K.next)B.push(K.value);return B},E.prototype.sliceReverse=function(A,G){(G=G||this.length)<0&&(G+=this.length),(A=A||0)<0&&(A+=this.length);var B=new E;if(G<A||G<0)return B;A<0&&(A=0),G>this.length&&(G=this.length);for(var O=this.length,K=this.tail;K!==null&&O>G;O--)K=K.prev;for(;K!==null&&O>A;O--,K=K.prev)B.push(K.value);return B},E.prototype.splice=function(A,G){A>this.length&&(A=this.length-1),A<0&&(A=this.length+A);for(var B=0,O=this.head;O!==null&&B<A;B++)O=O.next;var K=[];for(B=0;O&&B<G;B++)K.push(O.value),O=this.removeNode(O);for(O===null&&(O=this.tail),O!==this.head&&O!==this.tail&&(O=O.prev),B=0;B<(arguments.length<=2?0:arguments.length-2);B++)O=P(this,O,B+2<2||arguments.length<=B+2?void 0:arguments[B+2]);return K},E.prototype.reverse=function(){for(var A=this.head,G=this.tail,B=A;B!==null;B=B.prev){var O=B.prev;B.prev=B.next,B.next=O}return this.head=G,this.tail=A,this};try{x(518)(E)}catch{}},752:function(){},640:function(){},630:function(){},429:function(m,g,x){"use strict";function E(){return function(){throw new Error("Unimplemented abstract method.")}()}x.d(g,{default:function(){return pN}});var P=0;function L(s){return s.ol_uid||(s.ol_uid=String(++P))}var F,U="6.15.1",A=(F=function(s,i){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(s,i)},function(s,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=s}F(s,i),s.prototype=i===null?Object.create(i):(t.prototype=i.prototype,new t)}),G=function(s){function i(t){var e=this,o="Assertion failed. See https://openlayers.org/en/"+("v"+U.split("-")[0])+"/doc/errors/#"+t+" for details.";return(e=s.call(this,o)||this).code=t,e.name="AssertionError",e.message=o,e}return A(i,s),i}(Error);function B(s){s.stopPropagation()}var O=function(){function s(i){this.propagationStopped,this.defaultPrevented,this.type=i,this.target=null}return s.prototype.preventDefault=function(){this.defaultPrevented=!0},s.prototype.stopPropagation=function(){this.propagationStopped=!0},s}(),K="propertychange",Q=function(){function s(){this.disposed=!1}return s.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},s.prototype.disposeInternal=function(){},s}();function et(s,i,t){for(var e,o,l=t||lt,f=0,y=s.length,w=!1;f<y;)(o=+l(s[e=f+(y-f>>1)],i))<0?f=e+1:(y=e,w=!o);return w?f:~f}function lt(s,i){return s>i?1:s<i?-1:0}function pt(s,i){return s.indexOf(i)>=0}function T(s,i,t){var e=s.length;if(s[0]<=i)return 0;if(i<=s[e-1])return e-1;var o=void 0;if(t>0){for(o=1;o<e;++o)if(s[o]<i)return o-1}else if(t<0){for(o=1;o<e;++o)if(s[o]<=i)return o}else for(o=1;o<e;++o){if(s[o]==i)return o;if(s[o]<i)return typeof t=="function"?t(i,s[o-1],s[o])>0?o-1:o:s[o-1]-i<i-s[o]?o-1:o}return e-1}function ct(s,i,t){for(;i<t;){var e=s[i];s[i]=s[t],s[t]=e,++i,--t}}function ut(s,i){for(var t=Array.isArray(i)?i:[i],e=t.length,o=0;o<e;o++)s[s.length]=t[o]}function ft(s,i){for(var t,e=s.length>>>0,o=0;o<e;o++)if(i(t=s[o],o,s))return t;return null}function $(s,i){var t=s.length;if(t!==i.length)return!1;for(var e=0;e<t;e++)if(s[e]!==i[e])return!1;return!0}function _t(s,i){var t;return s.every(function(e,o){return t=o,!i(e,o,s)})?-1:t}function W(s,i,t){var e=i||lt;return s.every(function(o,l){if(l===0)return!0;var f=e(s[l-1],o);return!(f>0||t&&f===0)})}function rt(){return!0}function nt(){return!1}function vt(){}function Mt(s){var i,t,e,o=!1;return function(){var l=Array.prototype.slice.call(arguments);return o&&this===e&&$(l,t)||(o=!0,e=this,t=l,i=s.apply(this,arguments)),i}}function Bt(s){return function(){var i;try{i=s()}catch(t){return Promise.reject(t)}return i instanceof Promise?i:Promise.resolve(i)}()}var Vt=typeof Object.assign=="function"?Object.assign:function(s,i){if(s==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(s),e=1,o=arguments.length;e<o;++e){var l=arguments[e];if(l!=null)for(var f in l)l.hasOwnProperty(f)&&(t[f]=l[f])}return t};function Lt(s){for(var i in s)delete s[i]}var Ne=typeof Object.values=="function"?Object.values:function(s){var i=[];for(var t in s)i.push(s[t]);return i};function ge(s){var i;for(i in s)return!1;return!i}var Yt=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ue=function(s){function i(t){var e=s.call(this)||this;return e.t=t,e._=null,e.S=null,e.O=null,e}return Yt(i,s),i.prototype.addEventListener=function(t,e){if(t&&e){var o=this.O||(this.O={}),l=o[t]||(o[t]=[]);l.indexOf(e)===-1&&l.push(e)}},i.prototype.dispatchEvent=function(t){var e=typeof t=="string",o=e?t:t.type,l=this.O&&this.O[o];if(l){var f=e?new O(t):t;f.target||(f.target=this.t||this);var y,w=this.S||(this.S={}),b=this._||(this._={});o in w||(w[o]=0,b[o]=0),++w[o];for(var I=0,N=l.length;I<N;++I)if((y="handleEvent"in l[I]?l[I].handleEvent(f):l[I].call(this,f))===!1||f.propagationStopped){y=!1;break}if(--w[o]==0){var D=b[o];for(delete b[o];D--;)this.removeEventListener(o,vt);delete w[o]}return y}},i.prototype.disposeInternal=function(){this.O&&Lt(this.O)},i.prototype.getListeners=function(t){return this.O&&this.O[t]||void 0},i.prototype.hasListener=function(t){return!!this.O&&(t?t in this.O:Object.keys(this.O).length>0)},i.prototype.removeEventListener=function(t,e){var o=this.O&&this.O[t];if(o){var l=o.indexOf(e);l!==-1&&(this._&&t in this._?(o[l]=vt,++this._[t]):(o.splice(l,1),o.length===0&&delete this.O[t]))}},i}(Q),ne="change",dr="error",je="contextmenu",Br="click",Ue="dblclick",Fe="dragenter",Lr="dragover",De="drop",se="keydown",oe="keypress",Ar="load",vr="resize",Kr="touchmove",wi="wheel";function Ee(s,i,t,e,o){if(e&&e!==s&&(t=t.bind(e)),o){var l=t;t=function(){s.removeEventListener(i,t),l.apply(this,arguments)}}var f={target:s,type:i,listener:t};return s.addEventListener(i,t),f}function Sr(s,i,t,e){return Ee(s,i,t,e,!0)}function Or(s){s&&s.target&&(s.target.removeEventListener(s.type,s.listener),Lt(s))}var xn=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ye=function(s){function i(){var t=s.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.T=0,t}return xn(i,s),i.prototype.changed=function(){++this.T,this.dispatchEvent(ne)},i.prototype.getRevision=function(){return this.T},i.prototype.onInternal=function(t,e){if(Array.isArray(t)){for(var o=t.length,l=new Array(o),f=0;f<o;++f)l[f]=Ee(this,t[f],e);return l}return Ee(this,t,e)},i.prototype.onceInternal=function(t,e){var o;if(Array.isArray(t)){var l=t.length;o=new Array(l);for(var f=0;f<l;++f)o[f]=Sr(this,t[f],e)}else o=Sr(this,t,e);return e.ol_key=o,o},i.prototype.unInternal=function(t,e){var o=e.ol_key;if(o)oi(o);else if(Array.isArray(t))for(var l=0,f=t.length;l<f;++l)this.removeEventListener(t[l],e);else this.removeEventListener(t,e)},i}(ue);function oi(s){if(Array.isArray(s))for(var i=0,t=s.length;i<t;++i)Or(s[i]);else Or(s)}ye.prototype.on,ye.prototype.once,ye.prototype.un;var eo=ye,Xo=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Xn=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.key=e,l.oldValue=o,l}return Xo(i,s),i}(O),cn=function(s){function i(t){var e=s.call(this)||this;return e.on,e.once,e.un,L(e),e.A=null,t!==void 0&&e.setProperties(t),e}return Xo(i,s),i.prototype.get=function(t){var e;return this.A&&this.A.hasOwnProperty(t)&&(e=this.A[t]),e},i.prototype.getKeys=function(){return this.A&&Object.keys(this.A)||[]},i.prototype.getProperties=function(){return this.A&&Vt({},this.A)||{}},i.prototype.hasProperties=function(){return!!this.A},i.prototype.notify=function(t,e){var o;o="change:".concat(t),this.hasListener(o)&&this.dispatchEvent(new Xn(o,t,e)),o=K,this.hasListener(o)&&this.dispatchEvent(new Xn(o,t,e))},i.prototype.addChangeListener=function(t,e){this.addEventListener("change:".concat(t),e)},i.prototype.removeChangeListener=function(t,e){this.removeEventListener("change:".concat(t),e)},i.prototype.set=function(t,e,o){var l=this.A||(this.A={});if(o)l[t]=e;else{var f=l[t];l[t]=e,f!==e&&this.notify(t,f)}},i.prototype.setProperties=function(t,e){for(var o in t)this.set(o,t[o],e)},i.prototype.applyProperties=function(t){t.A&&Vt(this.A||(this.A={}),t.A)},i.prototype.unset=function(t,e){if(this.A&&t in this.A){var o=this.A[t];delete this.A[t],ge(this.A)&&(this.A=null),e||this.notify(t,o)}},i}(eo),Ft="add",Ot="remove",Kt=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ae="length",Ve=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.element=e,l.index=o,l}return Kt(i,s),i}(O),Be=function(s){function i(t,e){var o=s.call(this)||this;o.on,o.once,o.un;var l=e||{};if(o.P=!!l.unique,o.C=t||[],o.P)for(var f=0,y=o.C.length;f<y;++f)o.R(o.C[f],f);return o.G(),o}return Kt(i,s),i.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},i.prototype.extend=function(t){for(var e=0,o=t.length;e<o;++e)this.push(t[e]);return this},i.prototype.forEach=function(t){for(var e=this.C,o=0,l=e.length;o<l;++o)t(e[o],o,e)},i.prototype.getArray=function(){return this.C},i.prototype.item=function(t){return this.C[t]},i.prototype.getLength=function(){return this.get(ae)},i.prototype.insertAt=function(t,e){this.P&&this.R(e),this.C.splice(t,0,e),this.G(),this.dispatchEvent(new Ve(Ft,e,t))},i.prototype.pop=function(){return this.removeAt(this.getLength()-1)},i.prototype.push=function(t){this.P&&this.R(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},i.prototype.remove=function(t){for(var e=this.C,o=0,l=e.length;o<l;++o)if(e[o]===t)return this.removeAt(o)},i.prototype.removeAt=function(t){var e=this.C[t];return this.C.splice(t,1),this.G(),this.dispatchEvent(new Ve(Ot,e,t)),e},i.prototype.setAt=function(t,e){var o=this.getLength();if(t<o){this.P&&this.R(e,t);var l=this.C[t];this.C[t]=e,this.dispatchEvent(new Ve(Ot,l,t)),this.dispatchEvent(new Ve(Ft,e,t))}else{for(var f=o;f<t;++f)this.insertAt(f,void 0);this.insertAt(t,e)}},i.prototype.G=function(){this.set(ae,this.C.length)},i.prototype.R=function(t,e){for(var o=0,l=this.C.length;o<l;++o)if(this.C[o]===t&&o!==e)throw new G(58)},i}(cn),Er=0,br=1,Oe=2,ur=3,ar=4;function ot(s){return Math.pow(s,3)}function zt(s){return 1-ot(1-s)}function Wt(s){return 3*s*s-2*s*s*s}function Ut(s){return s}var ve=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Se=function(s){function i(t,e,o){var l=s.call(this)||this,f=o||{};return l.tileCoord=t,l.state=e,l.interimTile=null,l.key="",l.D=f.transition===void 0?250:f.transition,l.q={},l.interpolate=!!f.interpolate,l}return ve(i,s),i.prototype.changed=function(){this.dispatchEvent(ne)},i.prototype.release=function(){},i.prototype.getKey=function(){return this.key+"/"+this.tileCoord},i.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Oe)return this.D=0,t;t=t.interimTile}while(t);return this},i.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Oe){t.interimTile=null;break}t.getState()==br?e=t:t.getState()==Er?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},i.prototype.getTileCoord=function(){return this.tileCoord},i.prototype.getState=function(){return this.state},i.prototype.setState=function(t){if(this.state!==ur&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},i.prototype.load=function(){E()},i.prototype.getAlpha=function(t,e){if(!this.D)return 1;var o=this.q[t];if(o){if(o===-1)return 1}else o=e,this.q[t]=o;var l=e-o+1e3/60;return l>=this.D?1:ot(l/this.D)},i.prototype.inTransition=function(t){return!!this.D&&this.q[t]!==-1},i.prototype.endTransition=function(t){this.D&&(this.q[t]=-1)},i}(ue),nr=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),xr=function(s){function i(t){var e=this,o=Er;return(e=s.call(this,t.tileCoord,o,{transition:t.transition,interpolate:t.interpolate})||this).U=t.loader,e.B=null,e.V=null,e.W=t.size||[256,256],e}return nr(i,s),i.prototype.getSize=function(){return this.W},i.prototype.getData=function(){return this.B},i.prototype.getError=function(){return this.V},i.prototype.load=function(){if(this.state===Er||this.state===ur){this.state=br,this.changed();var t=this;this.U().then(function(e){t.B=e,t.state=Oe,t.changed()}).catch(function(e){t.V=e,t.state=ur,t.changed()})}},i}(Se);function Me(s,i){if(!s)throw new G(i)}var ei=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function fr(s){return typeof s=="function"?s:(Array.isArray(s)?i=s:(Me(typeof s.getZIndex=="function",41),i=[s]),function(){return i});var i}var Mr=function(s){function i(t){var e=s.call(this)||this;if(e.on,e.once,e.un,e.$=void 0,e.K="geometry",e.H=null,e.tt=void 0,e.nt=null,e.addChangeListener(e.K,e.it),t)if(typeof t.getSimplifiedGeometry=="function"){var o=t;e.setGeometry(o)}else{var l=t;e.setProperties(l)}return e}return ei(i,s),i.prototype.clone=function(){var t=new i(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var o=this.getStyle();return o&&t.setStyle(o),t},i.prototype.getGeometry=function(){return this.get(this.K)},i.prototype.getId=function(){return this.$},i.prototype.getGeometryName=function(){return this.K},i.prototype.getStyle=function(){return this.H},i.prototype.getStyleFunction=function(){return this.tt},i.prototype.rt=function(){this.changed()},i.prototype.it=function(){this.nt&&(Or(this.nt),this.nt=null);var t=this.getGeometry();t&&(this.nt=Ee(t,ne,this.rt,this)),this.changed()},i.prototype.setGeometry=function(t){this.set(this.K,t)},i.prototype.setStyle=function(t){this.H=t,this.tt=t?fr(t):void 0,this.changed()},i.prototype.setId=function(t){this.$=t,this.changed()},i.prototype.setGeometryName=function(t){this.removeChangeListener(this.K,this.it),this.K=t,this.addChangeListener(this.K,this.it),this.it()},i}(cn),hr="XY",Vr="XYZ",yi="XYM",Qr="XYZM",Fi={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ro={9001:Fi.METERS,9002:Fi.FEET,9003:Fi.USFEET,9101:Fi.RADIANS,9102:Fi.DEGREES};function Ln(s){return ro[s]}var Di={};Di[Fi.RADIANS]=6370997/(2*Math.PI),Di[Fi.DEGREES]=2*Math.PI*6370997/360,Di[Fi.FEET]=.3048,Di[Fi.METERS]=1,Di[Fi.USFEET]=.3048006096012192;var un,Mi=Fi,Qi=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"",Qo=Qi.indexOf("firefox")!==-1,ci=Qi.indexOf("safari")!==-1&&Qi.indexOf("chrom")==-1,wn=ci&&!!(Qi.indexOf("version/15.4")>=0||Qi.match(/cpu (os|iphone os) 15_4 like mac os x/)),vi=Qi.indexOf("webkit")!==-1&&Qi.indexOf("edge")==-1,Jr=Qi.indexOf("macintosh")!==-1,tn=typeof devicePixelRatio<"u"?devicePixelRatio:1,gr=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,St=typeof Image<"u"&&Image.prototype.decode,_i=function(){var s=!1;try{var i=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("_",null,i),window.removeEventListener("_",null,i)}catch{}return s}(),Wr=new Array(6);function Vs(){return[1,0,0,1,0,0]}function In(s){return vo(s,1,0,0,1,0,0)}function qi(s,i){var t=s[0],e=s[1],o=s[2],l=s[3],f=s[4],y=s[5],w=i[0],b=i[1],I=i[2],N=i[3],D=i[4],j=i[5];return s[0]=t*w+o*b,s[1]=e*w+l*b,s[2]=t*I+o*N,s[3]=e*I+l*N,s[4]=t*D+o*j+f,s[5]=e*D+l*j+y,s}function vo(s,i,t,e,o,l,f){return s[0]=i,s[1]=t,s[2]=e,s[3]=o,s[4]=l,s[5]=f,s}function xi(s,i){return s[0]=i[0],s[1]=i[1],s[2]=i[2],s[3]=i[3],s[4]=i[4],s[5]=i[5],s}function Ei(s,i){var t=i[0],e=i[1];return i[0]=s[0]*t+s[2]*e+s[4],i[1]=s[1]*t+s[3]*e+s[5],i}function hn(s,i){var t=Math.cos(i),e=Math.sin(i);return qi(s,vo(Wr,t,e,-e,t,0,0))}function Mn(s,i,t){return qi(s,vo(Wr,i,0,0,t,0,0))}function bt(s,i,t){return vo(s,i,0,0,t,0,0)}function Gt(s,i,t){return qi(s,vo(Wr,1,0,0,1,i,t))}function At(s,i,t,e,o,l,f,y){var w=Math.sin(l),b=Math.cos(l);return s[0]=e*b,s[1]=o*w,s[2]=-e*w,s[3]=o*b,s[4]=f*e*b-y*e*w+i,s[5]=f*o*w+y*o*b+t,s}function Qt(s,i){var t=le(i);Me(t!==0,32);var e=i[0],o=i[1],l=i[2],f=i[3],y=i[4],w=i[5];return s[0]=f/t,s[1]=-o/t,s[2]=-l/t,s[3]=e/t,s[4]=(l*w-f*y)/t,s[5]=-(e*w-o*y)/t,s}function le(s){return s[0]*s[3]-s[1]*s[2]}function re(s){var i="matrix("+s.join(", ")+")";if(gr)return i;var t=un||(un=document.createElement("div"));return t.style.transform=i,t.style.transform}var Pe=0,Ce=1,Xe=2,Ae=4,ke=8,lr=16;function mr(s){for(var i=Wn(),t=0,e=s.length;t<e;++t)Wo(i,s[t]);return i}function Fr(s,i,t){return t?(t[0]=s[0]-i,t[1]=s[1]-i,t[2]=s[2]+i,t[3]=s[3]+i,t):[s[0]-i,s[1]-i,s[2]+i,s[3]+i]}function Ur(s,i){return i?(i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i):s.slice()}function ui(s,i,t){var e,o;return(e=i<s[0]?s[0]-i:s[2]<i?i-s[2]:0)*e+(o=t<s[1]?s[1]-t:s[3]<t?t-s[3]:0)*o}function nn(s,i){return Co(s,i[0],i[1])}function pn(s,i){return s[0]<=i[0]&&i[2]<=s[2]&&s[1]<=i[1]&&i[3]<=s[3]}function Co(s,i,t){return s[0]<=i&&i<=s[2]&&s[1]<=t&&t<=s[3]}function Us(s,i){var t=s[0],e=s[1],o=s[2],l=s[3],f=i[0],y=i[1],w=Pe;return f<t?w|=lr:f>o&&(w|=Ae),y<e?w|=ke:y>l&&(w|=Xe),w===Pe&&(w=Ce),w}function Wn(){return[1/0,1/0,-1/0,-1/0]}function En(s,i,t,e,o){return o?(o[0]=s,o[1]=i,o[2]=t,o[3]=e,o):[s,i,t,e]}function ao(s){return En(1/0,1/0,-1/0,-1/0,s)}function as(s,i){var t=s[0],e=s[1];return En(t,e,t,e,i)}function vs(s,i,t,e,o){return tl(ao(o),s,i,t,e)}function ko(s,i){return s[0]==i[0]&&s[2]==i[2]&&s[1]==i[1]&&s[3]==i[3]}function ba(s,i,t){return Math.abs(s[0]-i[0])<t&&Math.abs(s[2]-i[2])<t&&Math.abs(s[1]-i[1])<t&&Math.abs(s[3]-i[3])<t}function _s(s,i){return i[0]<s[0]&&(s[0]=i[0]),i[2]>s[2]&&(s[2]=i[2]),i[1]<s[1]&&(s[1]=i[1]),i[3]>s[3]&&(s[3]=i[3]),s}function Wo(s,i){i[0]<s[0]&&(s[0]=i[0]),i[0]>s[2]&&(s[2]=i[0]),i[1]<s[1]&&(s[1]=i[1]),i[1]>s[3]&&(s[3]=i[1])}function Qa(s,i){for(var t=0,e=i.length;t<e;++t)Wo(s,i[t]);return s}function tl(s,i,t,e,o){for(;t<e;t+=o)el(s,i[t],i[t+1]);return s}function bl(s,i){for(var t=0,e=i.length;t<e;++t)Qa(s,i[t]);return s}function el(s,i,t){s[0]=Math.min(s[0],i),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],i),s[3]=Math.max(s[3],t)}function xs(s,i){var t;return(t=i(To(s)))||(t=i(Yo(s)))||(t=i(Qn(s)))?t:(t=i(Zr(s)))||!1}function _o(s){var i=0;return ws(s)||(i=Gr(s)*Ki(s)),i}function To(s){return[s[0],s[1]]}function Yo(s){return[s[2],s[1]]}function Gi(s){return[(s[0]+s[2])/2,(s[1]+s[3])/2]}function Sl(s,i){var t;return i==="bottom-left"?t=To(s):i==="bottom-right"?t=Yo(s):i==="top-left"?t=Zr(s):i==="top-right"?t=Qn(s):Me(!1,13),t}function Po(s,i,t,e,o){var l=Yn(s,i,t,e),f=l[0],y=l[1],w=l[2],b=l[3],I=l[4],N=l[5],D=l[6],j=l[7];return En(Math.min(f,w,I,D),Math.min(y,b,N,j),Math.max(f,w,I,D),Math.max(y,b,N,j),o)}function Yn(s,i,t,e){var o=i*e[0]/2,l=i*e[1]/2,f=Math.cos(t),y=Math.sin(t),w=o*f,b=o*y,I=l*f,N=l*y,D=s[0],j=s[1];return[D-w+N,j-b-I,D-w-N,j-b+I,D+w-N,j+b+I,D+w+N,j+b-I,D-w+N,j-b-I]}function Ki(s){return s[3]-s[1]}function fn(s,i,t){var e=t||[1/0,1/0,-1/0,-1/0];return on(s,i)?(s[0]>i[0]?e[0]=s[0]:e[0]=i[0],s[1]>i[1]?e[1]=s[1]:e[1]=i[1],s[2]<i[2]?e[2]=s[2]:e[2]=i[2],s[3]<i[3]?e[3]=s[3]:e[3]=i[3]):ao(e),e}function Zr(s){return[s[0],s[3]]}function Qn(s){return[s[2],s[3]]}function Gr(s){return s[2]-s[0]}function on(s,i){return s[0]<=i[2]&&s[2]>=i[0]&&s[1]<=i[3]&&s[3]>=i[1]}function ws(s){return s[2]<s[0]||s[3]<s[1]}function Hi(s,i){return i?(i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i):s}function v(s,i){var t=(s[2]-s[0])/2*(i-1),e=(s[3]-s[1])/2*(i-1);s[0]-=t,s[2]+=t,s[1]-=e,s[3]+=e}function S(s,i,t){var e=!1,o=Us(s,i),l=Us(s,t);if(o===Ce||l===Ce)e=!0;else{var f=s[0],y=s[1],w=s[2],b=s[3],I=i[0],N=i[1],D=t[0],j=t[1],H=(j-N)/(D-I),Z=void 0,it=void 0;l&Xe&&!(o&Xe)&&(e=(Z=D-(j-b)/H)>=f&&Z<=w),e||!(l&Ae)||o&Ae||(e=(it=j-(D-w)*H)>=y&&it<=b),e||!(l&ke)||o&ke||(e=(Z=D-(j-y)/H)>=f&&Z<=w),e||!(l&lr)||o&lr||(e=(it=j-(D-f)*H)>=y&&it<=b)}return e}function M(s,i,t,e){var o=[];if(e>1)for(var l=s[2]-s[0],f=s[3]-s[1],y=0;y<e;++y)o.push(s[0]+l*y/e,s[1],s[2],s[1]+f*y/e,s[2]-l*y/e,s[3],s[0],s[3]-f*y/e);else o=[s[0],s[1],s[2],s[1],s[2],s[3],s[0],s[3]];i(o,o,2);for(var w=[],b=[],I=(y=0,o.length);y<I;y+=2)w.push(o[y]),b.push(o[y+1]);return function(N,D,j){return En(Math.min.apply(null,N),Math.min.apply(null,D),Math.max.apply(null,N),Math.max.apply(null,D),j)}(w,b,t)}function R(s,i){var t=i.getExtent(),e=Gi(s);if(i.canWrapX()&&(e[0]<t[0]||e[0]>=t[2])){var o=Gr(t),l=Math.floor((e[0]-t[0])/o)*o;s[0]-=l,s[2]-=l}return s}function V(s,i){if(i.canWrapX()){var t=i.getExtent();if(!isFinite(s[0])||!isFinite(s[2]))return[[t[0],s[1],t[2],s[3]]];R(s,i);var e=Gr(t);if(Gr(s)>e)return[[t[0],s[1],t[2],s[3]]];if(s[0]<t[0])return[[s[0]+e,s[1],t[2],s[3]],[t[0],s[1],s[2],s[3]]];if(s[2]>t[2])return[[s[0],s[1],t[2],s[3]],[t[0],s[1],s[2]-e,s[3]]]}return[s]}var q=function(){function s(i){this.et=i.code,this.ot=i.units,this.st=i.extent!==void 0?i.extent:null,this.ut=i.worldExtent!==void 0?i.worldExtent:null,this.ht=i.axisOrientation!==void 0?i.axisOrientation:"enu",this.ft=i.global!==void 0&&i.global,this.ct=!(!this.ft||!this.st),this.lt=i.getPointResolution,this.vt=null,this.dt=i.metersPerUnit}return s.prototype.canWrapX=function(){return this.ct},s.prototype.getCode=function(){return this.et},s.prototype.getExtent=function(){return this.st},s.prototype.getUnits=function(){return this.ot},s.prototype.getMetersPerUnit=function(){return this.dt||Di[this.ot]},s.prototype.getWorldExtent=function(){return this.ut},s.prototype.getAxisOrientation=function(){return this.ht},s.prototype.isGlobal=function(){return this.ft},s.prototype.setGlobal=function(i){this.ft=i,this.ct=!(!i||!this.st)},s.prototype.getDefaultTileGrid=function(){return this.vt},s.prototype.setDefaultTileGrid=function(i){this.vt=i},s.prototype.setExtent=function(i){this.st=i,this.ct=!(!this.ft||!i)},s.prototype.setWorldExtent=function(i){this.ut=i},s.prototype.setGetPointResolution=function(i){this.lt=i},s.prototype.getPointResolutionFunc=function(){return this.lt},s}();function Y(s,i,t){return Math.min(Math.max(s,i),t)}var ht="cosh"in Math?Math.cosh:function(s){var i=Math.exp(s);return(i+1/i)/2},st="log2"in Math?Math.log2:function(s){return Math.log(s)*Math.LOG2E};function xt(s,i,t,e,o,l){var f=o-t,y=l-e;if(f!==0||y!==0){var w=((s-t)*f+(i-e)*y)/(f*f+y*y);w>1?(t=o,e=l):w>0&&(t+=f*w,e+=y*w)}return Tt(s,i,t,e)}function Tt(s,i,t,e){var o=t-s,l=e-i;return o*o+l*l}function jt(s){for(var i=s.length,t=0;t<i;t++){for(var e=t,o=Math.abs(s[t][t]),l=t+1;l<i;l++){var f=Math.abs(s[l][t]);f>o&&(o=f,e=l)}if(o===0)return null;var y=s[e];s[e]=s[t],s[t]=y;for(var w=t+1;w<i;w++)for(var b=-s[w][t]/s[t][t],I=t;I<i+1;I++)t==I?s[w][I]=0:s[w][I]+=b*s[t][I]}for(var N=new Array(i),D=i-1;D>=0;D--){N[D]=s[D][i]/s[D][D];for(var j=D-1;j>=0;j--)s[j][i]-=s[j][D]*N[D]}return N}function Et(s){return 180*s/Math.PI}function qt(s){return s*Math.PI/180}function be(s,i){var t=s%i;return t*i<0?t+i:t}function We(s,i,t){return s+t*(i-s)}function Ze(s,i){var t=Math.pow(10,i);return Math.round(s*t)/t}function si(s,i){return Math.round(Ze(s,i))}function gi(s,i){return Math.floor(Ze(s,i))}function dn(s,i){return Math.ceil(Ze(s,i))}var Dn=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),pr=6378137,Xi=Math.PI*pr,rr=[-Xi,-Xi,Xi,Xi],Rr=[-180,-85,180,85],Gn=pr*Math.log(Math.tan(Math.PI/2)),ts=function(s){function i(t){return s.call(this,{code:t,units:Mi.METERS,extent:rr,global:!0,worldExtent:Rr,getPointResolution:function(e,o){return e/ht(o[1]/pr)}})||this}return Dn(i,s),i}(q),ri=[new ts("EPSG:3857"),new ts("EPSG:102100"),new ts("EPSG:102113"),new ts("EPSG:900913"),new ts("http://www.opengis.net/def/crs/EPSG/0/3857"),new ts("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Fo(s,i,t){var e=s.length,o=t>1?t:2,l=i;l===void 0&&(l=o>2?s.slice():new Array(e));for(var f=0;f<e;f+=o){l[f]=Xi*s[f]/180;var y=pr*Math.log(Math.tan(Math.PI*(+s[f+1]+90)/360));y>Gn?y=Gn:y<-Gn&&(y=-Gn),l[f+1]=y}return l}function Zn(s,i,t){var e=s.length,o=t>1?t:2,l=i;l===void 0&&(l=o>2?s.slice():new Array(e));for(var f=0;f<e;f+=o)l[f]=180*s[f]/Xi,l[f+1]=360*Math.atan(Math.exp(s[f+1]/pr))/Math.PI-90;return l}var ho=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),hi=6378137,gn=[-180,-90,180,90],bi=Math.PI*hi/180,Yr=function(s){function i(t,e){return s.call(this,{code:t,units:Mi.DEGREES,extent:gn,axisOrientation:e,global:!0,metersPerUnit:bi,worldExtent:gn})||this}return ho(i,s),i}(q),Bi=[new Yr("CRS:84"),new Yr("EPSG:4326","neu"),new Yr("urn:ogc:def:crs:OGC:1.3:CRS84"),new Yr("urn:ogc:def:crs:OGC:2:84"),new Yr("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Yr("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Yr("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],An={};function Wi(){An={}}function ze(s){return An[s]||An[s.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ii(s,i){An[s]=i}var zr={};function qr(){zr={}}function vn(s,i,t){var e=s.getCode(),o=i.getCode();e in zr||(zr[e]={}),zr[e][o]=t}function Ie(s,i){var t;return s in zr&&i in zr[s]&&(t=zr[s][i]),t}function lo(s,i,t){var e=t!==void 0?s.toFixed(t):""+s,o=e.indexOf(".");return(o=o===-1?e.length:o)>i?e:new Array(1+i-o).join("0")+e}function Bn(s,i){for(var t=(""+s).split("."),e=(""+i).split("."),o=0;o<Math.max(t.length,e.length);o++){var l=parseInt(t[o]||"0",10),f=parseInt(e[o]||"0",10);if(l>f)return 1;if(f>l)return-1}return 0}function bs(s,i){return s[0]+=+i[0],s[1]+=+i[1],s}function io(s,i){var t=i.getRadius(),e=i.getCenter(),o=e[0],l=e[1],f=s[0]-o,y=s[1]-l;f===0&&y===0&&(f=1);var w=Math.sqrt(f*f+y*y);return[o+t*f/w,l+t*y/w]}function Ss(s,i){var t,e,o=s[0],l=s[1],f=i[0],y=i[1],w=f[0],b=f[1],I=y[0],N=y[1],D=I-w,j=N-b,H=D===0&&j===0?0:(D*(o-w)+j*(l-b))/(D*D+j*j||0);return H<=0?(t=w,e=b):H>=1?(t=I,e=N):(t=w+H*D,e=b+H*j),[t,e]}function en(s,i,t){var e=be(i+180,360)-180,o=Math.abs(3600*e),l=t||0,f=Math.pow(10,l),y=Math.floor(o/3600),w=Math.floor((o-3600*y)/60),b=o-3600*y-60*w;return(b=Math.ceil(b*f)/f)>=60&&(b=0,w+=1),w>=60&&(w=0,y+=1),y+"\xB0 "+lo(w,2)+"\u2032 "+lo(b,2,l)+"\u2033"+(e==0?"":" "+s.charAt(e<0?1:0))}function Zo(s,i,t){return s?i.replace("{x}",s[0].toFixed(t)).replace("{y}",s[1].toFixed(t)):""}function mn(s,i){for(var t=!0,e=s.length-1;e>=0;--e)if(s[e]!=i[e]){t=!1;break}return t}function es(s,i){var t=Math.cos(i),e=Math.sin(i),o=s[0]*t-s[1]*e,l=s[1]*t+s[0]*e;return s[0]=o,s[1]=l,s}function On(s,i){return s[0]*=i,s[1]*=i,s}function mi(s,i){var t=s[0]-i[0],e=s[1]-i[1];return t*t+e*e}function Es(s,i){return Math.sqrt(mi(s,i))}function Do(s,i){return mi(s,Ss(s,i))}function ia(s,i){return Zo(s,"{x}, {y}",i)}function tt(s,i){if(i.canWrapX()){var t=Gr(i.getExtent()),e=mt(s,i,t);e&&(s[0]-=e*t)}return s}function mt(s,i,t){var e=i.getExtent(),o=0;if(i.canWrapX()&&(s[0]<e[0]||s[0]>e[2])){var l=t||Gr(e);o=Math.floor((s[0]-e[0])/l)}return o}var Pt=63710088e-1;function Nt(s,i,t){var e=t||Pt,o=qt(s[1]),l=qt(i[1]),f=(l-o)/2,y=qt(i[0]-s[0])/2,w=Math.sin(f)*Math.sin(f)+Math.sin(y)*Math.sin(y)*Math.cos(o)*Math.cos(l);return 2*e*Math.atan2(Math.sqrt(w),Math.sqrt(1-w))}function Ht(s,i){for(var t=0,e=0,o=s.length;e<o-1;++e)t+=Nt(s[e],s[e+1],i);return t}function _e(s,i){for(var t=0,e=s.length,o=s[e-1][0],l=s[e-1][1],f=0;f<e;f++){var y=s[f][0],w=s[f][1];t+=qt(y-o)*(2+Math.sin(qt(l))+Math.sin(qt(w))),o=y,l=w}return t*i*i/2}function we(s,i,t,e){var o=e||Pt,l=qt(s[1]),f=qt(s[0]),y=i/o,w=Math.asin(Math.sin(l)*Math.cos(y)+Math.cos(l)*Math.sin(y)*Math.cos(t));return[Et(f+Math.atan2(Math.sin(t)*Math.sin(y)*Math.cos(l),Math.cos(y)-Math.sin(l)*Math.sin(w))),Et(w)]}var Te=!0;function me(s){Te=!(s===void 0||s)}function _r(s,i,t){var e;if(i!==void 0){for(var o=0,l=s.length;o<l;++o)i[o]=s[o];e=i}else e=s.slice();return e}function Ke(s,i,t){if(i!==void 0&&s!==i){for(var e=0,o=s.length;e<o;++e)i[e]=s[e];s=i}return s}function er(s){ii(s.getCode(),s),vn(s,s,_r)}function wr(s){s.forEach(er)}function ie(s){return typeof s=="string"?ze(s):s||null}function ti(s,i,t,e){var o,l=(s=ie(s)).getPointResolutionFunc();if(l)o=l(i,t),e&&e!==s.getUnits()&&(y=s.getMetersPerUnit())&&(o=o*y/Di[e]);else{var f=s.getUnits();if(f==Mi.DEGREES&&!e||e==Mi.DEGREES)o=i;else{var y,w=ji(s,ie("EPSG:4326"));if(w===Ke&&f!==Mi.DEGREES)o=i*s.getMetersPerUnit();else{var b=[t[0]-i/2,t[1],t[0]+i/2,t[1],t[0],t[1]-i/2,t[0],t[1]+i/2];o=(Nt((b=w(b,b,2)).slice(0,2),b.slice(2,4))+Nt(b.slice(4,6),b.slice(6,8)))/2}(y=e?Di[e]:s.getMetersPerUnit())!==void 0&&(o/=y)}}return o}function Ti(s){wr(s),s.forEach(function(i){s.forEach(function(t){i!==t&&vn(i,t,_r)})})}function Si(s,i,t,e){s.forEach(function(o){i.forEach(function(l){vn(o,l,t),vn(l,o,e)})})}function Yi(s,i){return s?typeof s=="string"?ie(s):s:ie(i)}function sn(s){return function(i,t,e){for(var o=i.length,l=e!==void 0?e:2,f=t!==void 0?t:new Array(o),y=0;y<o;y+=l)for(var w=s(i.slice(y,y+l)),b=w.length,I=0,N=l;I<N;++I)f[y+I]=I>=b?i[y+I]:w[I];return f}}function Zi(s,i,t,e){var o=ie(s),l=ie(i);vn(o,l,sn(t)),vn(l,o,sn(e))}function jr(s,i){return me(),xo(s,"EPSG:4326",i!==void 0?i:"EPSG:3857")}function an(s,i){if(s===i)return!0;var t=s.getUnits()===i.getUnits();return(s.getCode()===i.getCode()||ji(s,i)===_r)&&t}function ji(s,i){var t=Ie(s.getCode(),i.getCode());return t||(t=Ke),t}function zn(s,i){return ji(ie(s),ie(i))}function xo(s,i,t){return zn(i,t)(s,void 0,s.length)}function Vi(s,i,t,e){return M(s,zn(i,t),void 0,e)}var $n=null;function rs(s){$n=ie(s)}function wo(){return $n}function Io(s,i){return $n?xo(s,i,$n):s}function $i(s,i){return $n?xo(s,$n,i):(Te&&!mn(s,[0,0])&&s[0]>=-180&&s[0]<=180&&s[1]>=-90&&s[1]<=90&&(Te=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),s)}function na(s,i){return $n?Vi(s,i,$n):s}function Mo(s,i){return $n?Vi(s,$n,i):s}function Yh(s,i){if(!$n)return s;var t=ie(i).getUnits(),e=$n.getUnits();return t&&e?s*Di[t]/Di[e]:s}function Zh(s,i){if(!$n)return s;var t=ie(i).getUnits(),e=$n.getUnits();return t&&e?s*Di[e]/Di[t]:s}function po(s,i,t){return function(e){var o,l;if(s.canWrapX()){var f=s.getExtent(),y=Gr(f);(l=mt(e=e.slice(0),s,y))&&(e[0]=e[0]-l*y),e[0]=Y(e[0],f[0],f[2]),e[1]=Y(e[1],f[1],f[3]),o=t(e)}else o=t(e);return l&&i.canWrapX()&&(o[0]+=l*Gr(i.getExtent())),o}}function lf(){Ti(ri),Ti(Bi),Si(Bi,ri,Fo,Zn)}function Sa(s,i,t,e,o,l){for(var f=l||[],y=0,w=i;w<t;w+=e){var b=s[w],I=s[w+1];f[y++]=o[0]*b+o[2]*I+o[4],f[y++]=o[1]*b+o[3]*I+o[5]}return l&&f.length!=y&&(f.length=y),f}function Uu(s,i,t,e,o,l,f){for(var y=f||[],w=Math.cos(o),b=Math.sin(o),I=l[0],N=l[1],D=0,j=i;j<t;j+=e){var H=s[j]-I,Z=s[j+1]-N;y[D++]=I+H*w-Z*b,y[D++]=N+H*b+Z*w;for(var it=j+2;it<j+e;++it)y[D++]=s[it]}return f&&y.length!=D&&(y.length=D),y}function cf(s,i,t,e,o,l,f,y){for(var w=y||[],b=f[0],I=f[1],N=0,D=i;D<t;D+=e){var j=s[D]-b,H=s[D+1]-I;w[N++]=b+o*j,w[N++]=I+l*H;for(var Z=D+2;Z<D+e;++Z)w[N++]=s[Z]}return y&&w.length!=N&&(w.length=N),w}function Ea(s,i,t,e,o,l,f){for(var y=f||[],w=0,b=i;b<t;b+=e){y[w++]=s[b]+o,y[w++]=s[b+1]+l;for(var I=b+2;I<b+e;++I)y[w++]=s[I]}return f&&y.length!=w&&(y.length=w),y}lf();var uf=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$o=[1,0,0,1,0,0],zc=function(s){function i(){var t=s.call(this)||this;return t.st=[1/0,1/0,-1/0,-1/0],t.yt=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=Mt(function(e,o,l){if(!l)return this.getSimplifiedGeometry(o);var f=this.clone();return f.applyTransform(l),f.getSimplifiedGeometry(o)}),t}return uf(i,s),i.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},i.prototype.clone=function(){return E()},i.prototype.closestPointXY=function(t,e,o,l){return E()},i.prototype.containsXY=function(t,e){var o=this.getClosestPoint([t,e]);return o[0]===t&&o[1]===e},i.prototype.getClosestPoint=function(t,e){var o=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],o,1/0),o},i.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},i.prototype.computeExtent=function(t){return E()},i.prototype.getExtent=function(t){if(this.yt!=this.getRevision()){var e=this.computeExtent(this.st);(isNaN(e[0])||isNaN(e[1]))&&ao(e),this.yt=this.getRevision()}return Hi(this.st,t)},i.prototype.rotate=function(t,e){E()},i.prototype.scale=function(t,e,o){E()},i.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},i.prototype.getSimplifiedGeometry=function(t){return E()},i.prototype.getType=function(){return E()},i.prototype.applyTransform=function(t){E()},i.prototype.intersectsExtent=function(t){return E()},i.prototype.translate=function(t,e){E()},i.prototype.transform=function(t,e){var o=ie(t),l=o.getUnits()==Mi.TILE_PIXELS?function(f,y,w){var b=o.getExtent(),I=o.getWorldExtent(),N=Ki(I)/Ki(b);return At($o,I[0],I[3],N,-N,0,0,0),Sa(f,0,f.length,w,$o,y),zn(o,e)(f,y,w)}:zn(o,e);return this.applyTransform(l),this},i}(cn),qu=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Vc(s){var i;return s==hr?i=2:s==Vr||s==yi?i=3:s==Qr&&(i=4),i}function El(s,i,t){var e=s.getFlatCoordinates();if(e){var o=s.getStride();return Sa(e,0,e.length,o,i,t)}return null}var Cs=function(s){function i(){var t=s.call(this)||this;return t.layout=hr,t.stride=2,t.flatCoordinates=null,t}return qu(i,s),i.prototype.computeExtent=function(t){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},i.prototype.getCoordinates=function(){return E()},i.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},i.prototype.getFlatCoordinates=function(){return this.flatCoordinates},i.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},i.prototype.getLayout=function(){return this.layout},i.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},i.prototype.getSimplifiedGeometryInternal=function(t){return this},i.prototype.getStride=function(){return this.stride},i.prototype.setFlatCoordinates=function(t,e){this.stride=Vc(t),this.layout=t,this.flatCoordinates=e},i.prototype.setCoordinates=function(t,e){E()},i.prototype.setLayout=function(t,e,o){var l;if(t)l=Vc(t);else{for(var f=0;f<o;++f){if(e.length===0)return this.layout=hr,void(this.stride=2);e=e[0]}t=function(y){var w;return y==2?w=hr:y==3?w=Vr:y==4&&(w=Qr),w}(l=e.length)}this.layout=t,this.stride=l},i.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},i.prototype.rotate=function(t,e){var o=this.getFlatCoordinates();if(o){var l=this.getStride();Uu(o,0,o.length,l,t,e,o),this.changed()}},i.prototype.scale=function(t,e,o){var l=e;l===void 0&&(l=t);var f=o;f||(f=Gi(this.getExtent()));var y=this.getFlatCoordinates();if(y){var w=this.getStride();cf(y,0,y.length,w,t,l,f,y),this.changed()}},i.prototype.translate=function(t,e){var o=this.getFlatCoordinates();if(o){var l=this.getStride();Ea(o,0,o.length,l,t,e,o),this.changed()}},i}(zc);function oa(s,i,t,e,o,l,f){var y,w=s[i],b=s[i+1],I=s[t]-w,N=s[t+1]-b;if(I===0&&N===0)y=i;else{var D=((o-w)*I+(l-b)*N)/(I*I+N*N);if(D>1)y=t;else{if(D>0){for(var j=0;j<e;++j)f[j]=We(s[i+j],s[t+j],D);return void(f.length=e)}y=i}}for(j=0;j<e;++j)f[j]=s[y+j];f.length=e}function Uc(s,i,t,e,o){var l=s[i],f=s[i+1];for(i+=e;i<t;i+=e){var y=s[i],w=s[i+1],b=Tt(l,f,y,w);b>o&&(o=b),l=y,f=w}return o}function Go(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l){var y=t[l];o=Uc(s,i,y,e,o),i=y}return o}function rl(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l){var y=t[l];o=Go(s,i,y,e,o),i=y[y.length-1]}return o}function Ir(s,i,t,e,o,l,f,y,w,b,I){if(i==t)return b;var N,D;if(o===0){if((D=Tt(f,y,s[i],s[i+1]))<b){for(N=0;N<e;++N)w[N]=s[i+N];return w.length=e,D}return b}for(var j=I||[NaN,NaN],H=i+e;H<t;)if(oa(s,H-e,H,e,f,y,j),(D=Tt(f,y,j[0],j[1]))<b){for(b=D,N=0;N<e;++N)w[N]=j[N];w.length=e,H+=e}else H+=e*Math.max((Math.sqrt(D)-Math.sqrt(b))/o|0,1);if(l&&(oa(s,t-e,i,e,f,y,j),(D=Tt(f,y,j[0],j[1]))<b)){for(b=D,N=0;N<e;++N)w[N]=j[N];w.length=e}return b}function sa(s,i,t,e,o,l,f,y,w,b,I){for(var N=I||[NaN,NaN],D=0,j=t.length;D<j;++D){var H=t[D];b=Ir(s,i,H,e,o,l,f,y,w,b,N),i=H}return b}function ls(s,i,t,e,o,l,f,y,w,b,I){for(var N=I||[NaN,NaN],D=0,j=t.length;D<j;++D){var H=t[D];b=sa(s,i,H,e,o,l,f,y,w,b,N),i=H[H.length-1]}return b}function ac(s,i,t,e){for(var o=0,l=t.length;o<l;++o)s[i++]=t[o];return i}function Ca(s,i,t,e){for(var o=0,l=t.length;o<l;++o)for(var f=t[o],y=0;y<e;++y)s[i++]=f[y];return i}function $h(s,i,t,e,o){for(var l=o||[],f=0,y=0,w=t.length;y<w;++y){var b=Ca(s,i,t[y],e);l[f++]=b,i=b}return l.length=f,l}function Ta(s,i,t,e,o){for(var l=o||[],f=0,y=0,w=t.length;y<w;++y){var b=$h(s,i,t[y],e,l[f]);l[f++]=b,i=b[b.length-1]}return l.length=f,l}function Pa(s,i,t,e,o,l,f){var y=(t-i)/e;if(y<3){for(;i<t;i+=e)l[f++]=s[i],l[f++]=s[i+1];return f}var w=new Array(y);w[0]=1,w[y-1]=1;for(var b=[i,t-e],I=0;b.length>0;){for(var N=b.pop(),D=b.pop(),j=0,H=s[D],Z=s[D+1],it=s[N],at=s[N+1],wt=D+e;wt<N;wt+=e){var gt=xt(s[wt],s[wt+1],H,Z,it,at);gt>j&&(I=wt,j=gt)}j>o&&(w[(I-i)/e]=1,D+e<I&&b.push(D,I),I+e<N&&b.push(I,N))}for(wt=0;wt<y;++wt)w[wt]&&(l[f++]=s[i+wt*e],l[f++]=s[i+wt*e+1]);return f}function aa(s,i,t,e,o,l,f,y){for(var w=0,b=t.length;w<b;++w){var I=t[w];f=Pa(s,i,I,e,o,l,f),y.push(f),i=I}return f}function qc(s,i,t,e,o,l,f){if(t<=i+e){for(;i<t;i+=e)l[f++]=s[i],l[f++]=s[i+1];return f}var y=s[i],w=s[i+1];l[f++]=y,l[f++]=w;var b=y,I=w;for(i+=e;i<t;i+=e)Tt(y,w,b=s[i],I=s[i+1])>o&&(l[f++]=b,l[f++]=I,y=b,w=I);return b==y&&I==w||(l[f++]=b,l[f++]=I),f}function jo(s,i){return i*Math.round(s/i)}function Ia(s,i,t,e,o,l,f){if(i==t)return f;var y,w,b=jo(s[i],o),I=jo(s[i+1],o);i+=e,l[f++]=b,l[f++]=I;do if(y=jo(s[i],o),w=jo(s[i+1],o),(i+=e)==t)return l[f++]=y,l[f++]=w,f;while(y==b&&w==I);for(;i<t;){var N=jo(s[i],o),D=jo(s[i+1],o);if(i+=e,N!=y||D!=w){var j=y-b,H=w-I,Z=N-b,it=D-I;j*it==H*Z&&(j<0&&Z<j||j==Z||j>0&&Z>j)&&(H<0&&it<H||H==it||H>0&&it>H)?(y=N,w=D):(l[f++]=y,l[f++]=w,b=y,I=w,y=N,w=D)}}return l[f++]=y,l[f++]=w,f}function Kh(s,i,t,e,o,l,f,y){for(var w=0,b=t.length;w<b;++w){var I=t[w];f=Ia(s,i,I,e,o,l,f),y.push(f),i=I}return f}function Hc(s,i,t,e,o,l,f,y){for(var w=0,b=t.length;w<b;++w){var I=t[w],N=[];f=Kh(s,i,I,e,o,l,f,N),y.push(N),i=I[I.length-1]}return f}function cs(s,i,t,e,o){for(var l=o!==void 0?o:[],f=0,y=i;y<t;y+=e)l[f++]=s.slice(y,y+e);return l.length=f,l}function Ma(s,i,t,e,o){for(var l=o!==void 0?o:[],f=0,y=0,w=t.length;y<w;++y){var b=t[y];l[f++]=cs(s,i,b,e,l[f]),i=b}return l.length=f,l}function La(s,i,t,e,o){for(var l=o!==void 0?o:[],f=0,y=0,w=t.length;y<w;++y){var b=t[y];l[f++]=Ma(s,i,b,e,l[f]),i=b[b.length-1]}return l.length=f,l}function Ko(s,i,t,e){for(var o=0,l=s[t-e],f=s[t-e+1];i<t;i+=e){var y=s[i],w=s[i+1];o+=f*y-l*w,l=y,f=w}return o/2}function hf(s,i,t,e){for(var o=0,l=0,f=t.length;l<f;++l){var y=t[l];o+=Ko(s,i,y,e),i=y}return o}function lc(s,i,t,e){for(var o=0,l=0,f=t.length;l<f;++l){var y=t[l];o+=hf(s,i,y,e),i=y[y.length-1]}return o}var Jh=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Xc=function(s){function i(t,e){var o=s.call(this)||this;return o.wt=-1,o.gt=-1,e===void 0||Array.isArray(t[0])?o.setCoordinates(t,e):o.setFlatCoordinates(e,t),o}return Jh(i,s),i.prototype.clone=function(){return new i(this.flatCoordinates.slice(),this.layout)},i.prototype.closestPointXY=function(t,e,o,l){return l<ui(this.getExtent(),t,e)?l:(this.gt!=this.getRevision()&&(this.wt=Math.sqrt(Uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.gt=this.getRevision()),Ir(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.wt,!0,t,e,o,l))},i.prototype.getArea=function(){return Ko(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getCoordinates=function(){return cs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=Pa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,hr)},i.prototype.getType=function(){return"LinearRing"},i.prototype.intersectsExtent=function(t){return!1},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ca(this.flatCoordinates,0,t,this.stride),this.changed()},i}(Cs),cc=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),rn=function(s){function i(t,e){var o=s.call(this)||this;return o.setCoordinates(t,e),o}return cc(i,s),i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){var f=this.flatCoordinates,y=Tt(t,e,f[0],f[1]);if(y<l){for(var w=this.stride,b=0;b<w;++b)o[b]=f[b];return o.length=w,y}return l},i.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},i.prototype.computeExtent=function(t){return as(this.flatCoordinates,t)},i.prototype.getType=function(){return"Point"},i.prototype.intersectsExtent=function(t){return Co(t,this.flatCoordinates[0],this.flatCoordinates[1])},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ac(this.flatCoordinates,0,t,this.stride),this.changed()},i}(Cs);function Hu(s,i,t,e,o){return!xs(o,function(l){return!Aa(s,i,t,e,l[0],l[1])})}function Aa(s,i,t,e,o,l){for(var f=0,y=s[t-e],w=s[t-e+1];i<t;i+=e){var b=s[i],I=s[i+1];w<=l?I>l&&(b-y)*(l-w)-(o-y)*(I-w)>0&&f++:I<=l&&(b-y)*(l-w)-(o-y)*(I-w)<0&&f--,y=b,w=I}return f!==0}function Qh(s,i,t,e,o,l){if(t.length===0||!Aa(s,i,t[0],e,o,l))return!1;for(var f=1,y=t.length;f<y;++f)if(Aa(s,t[f-1],t[f],e,o,l))return!1;return!0}function Xu(s,i,t,e,o,l){if(t.length===0)return!1;for(var f=0,y=t.length;f<y;++f){var w=t[f];if(Qh(s,i,w,e,o,l))return!0;i=w[w.length-1]}return!1}function tp(s,i,t,e,o,l,f){for(var y,w,b,I,N,D,j,H=o[l+1],Z=[],it=0,at=t.length;it<at;++it){var wt=t[it];for(I=s[wt-e],D=s[wt-e+1],y=i;y<wt;y+=e)N=s[y],j=s[y+1],(H<=D&&j<=H||D<=H&&H<=j)&&(b=(H-D)/(j-D)*(N-I)+I,Z.push(b)),I=N,D=j}var gt=NaN,yt=-1/0;for(Z.sort(lt),I=Z[0],y=1,w=Z.length;y<w;++y){N=Z[y];var It=Math.abs(N-I);It>yt&&Qh(s,i,t,e,b=(I+N)/2,H)&&(gt=b,yt=It),I=N}return isNaN(gt)&&(gt=o[l]),f?(f.push(gt,H,yt),f):[gt,H,yt]}function pf(s,i,t,e,o){for(var l=[],f=0,y=t.length;f<y;++f){var w=t[f];l=tp(s,i,w,e,o,2*f,l),i=w[w.length-1]}return l}function Wu(s,i,t,e,o){var l;for(i+=e;i<t;i+=e)if(l=o(s.slice(i-e,i),s.slice(i,i+e)))return l;return!1}function Cl(s,i,t,e,o){var l=tl([1/0,1/0,-1/0,-1/0],s,i,t,e);return!!on(o,l)&&(!!pn(o,l)||l[0]>=o[0]&&l[2]<=o[2]||l[1]>=o[1]&&l[3]<=o[3]||Wu(s,i,t,e,function(f,y){return S(o,f,y)}))}function Tl(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l){if(Cl(s,i,t[l],e,o))return!0;i=t[l]}return!1}function Wc(s,i,t,e,o){return!!Cl(s,i,t,e,o)||!!Aa(s,i,t,e,o[0],o[1])||!!Aa(s,i,t,e,o[0],o[3])||!!Aa(s,i,t,e,o[2],o[1])||!!Aa(s,i,t,e,o[2],o[3])}function ff(s,i,t,e,o){if(!Wc(s,i,t[0],e,o))return!1;if(t.length===1)return!0;for(var l=1,f=t.length;l<f;++l)if(Hu(s,t[l-1],t[l],e,o)&&!Cl(s,t[l-1],t[l],e,o))return!1;return!0}function il(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l){var y=t[l];if(ff(s,i,y,e,o))return!0;i=y[y.length-1]}return!1}function Yc(s,i,t,e){for(;i<t-e;){for(var o=0;o<e;++o){var l=s[i+o];s[i+o]=s[t-e+o],s[t-e+o]=l}i+=e,t-=e}}function Pl(s,i,t,e){for(var o=0,l=s[t-e],f=s[t-e+1];i<t;i+=e){var y=s[i],w=s[i+1];o+=(y-l)*(w+f),l=y,f=w}return o===0?void 0:o>0}function df(s,i,t,e,o){for(var l=o!==void 0&&o,f=0,y=t.length;f<y;++f){var w=t[f],b=Pl(s,i,w,e);if(f===0){if(l&&b||!l&&!b)return!1}else if(l&&!b||!l&&b)return!1;i=w}return!0}function Zc(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l){var y=t[l];if(!df(s,i,y,e,o))return!1;y.length&&(i=y[y.length-1])}return!0}function Il(s,i,t,e,o){for(var l=o!==void 0&&o,f=0,y=t.length;f<y;++f){var w=t[f],b=Pl(s,i,w,e);(f===0?l&&b||!l&&!b:l&&!b||!l&&b)&&Yc(s,i,w,e),i=w}return i}function Ml(s,i,t,e,o){for(var l=0,f=t.length;l<f;++l)i=Il(s,i,t[l],e,o);return i}function gf(s,i){for(var t=[],e=0,o=0,l=0,f=i.length;l<f;++l){var y=i[l];if(Pl(s,e,y,2)){if(t.length===0)continue;t[t.length-1].push(i[o])}else t.push(i.slice(o,l+1));o=l+1,e=y}return t}var Dm=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ep=function(s){function i(t,e,o){var l=s.call(this)||this;return l.bt=[],l.xt=-1,l.Mt=null,l.wt=-1,l.gt=-1,l._t=-1,l.St=null,e!==void 0&&o?(l.setFlatCoordinates(e,t),l.bt=o):l.setCoordinates(t,e),l}return Dm(i,s),i.prototype.appendLinearRing=function(t){this.flatCoordinates?ut(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.bt.push(this.flatCoordinates.length),this.changed()},i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),this.layout,this.bt.slice());return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){return l<ui(this.getExtent(),t,e)?l:(this.gt!=this.getRevision()&&(this.wt=Math.sqrt(Go(this.flatCoordinates,0,this.bt,this.stride,0)),this.gt=this.getRevision()),sa(this.flatCoordinates,0,this.bt,this.stride,this.wt,!0,t,e,o,l))},i.prototype.containsXY=function(t,e){return Qh(this.getOrientedFlatCoordinates(),0,this.bt,this.stride,t,e)},i.prototype.getArea=function(){return hf(this.getOrientedFlatCoordinates(),0,this.bt,this.stride)},i.prototype.getCoordinates=function(t){var e;return t!==void 0?Il(e=this.getOrientedFlatCoordinates().slice(),0,this.bt,this.stride,t):e=this.flatCoordinates,Ma(e,0,this.bt,this.stride)},i.prototype.getEnds=function(){return this.bt},i.prototype.getFlatInteriorPoint=function(){if(this.xt!=this.getRevision()){var t=Gi(this.getExtent());this.Mt=tp(this.getOrientedFlatCoordinates(),0,this.bt,this.stride,t,0),this.xt=this.getRevision()}return this.Mt},i.prototype.getInteriorPoint=function(){return new rn(this.getFlatInteriorPoint(),yi)},i.prototype.getLinearRingCount=function(){return this.bt.length},i.prototype.getLinearRing=function(t){return t<0||this.bt.length<=t?null:new Xc(this.flatCoordinates.slice(t===0?0:this.bt[t-1],this.bt[t]),this.layout)},i.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,o=this.bt,l=[],f=0,y=0,w=o.length;y<w;++y){var b=o[y],I=new Xc(e.slice(f,b),t);l.push(I),f=b}return l},i.prototype.getOrientedFlatCoordinates=function(){if(this._t!=this.getRevision()){var t=this.flatCoordinates;df(t,0,this.bt,this.stride)?this.St=t:(this.St=t.slice(),this.St.length=Il(this.St,0,this.bt,this.stride)),this._t=this.getRevision()}return this.St},i.prototype.getSimplifiedGeometryInternal=function(t){var e=[],o=[];return e.length=Kh(this.flatCoordinates,0,this.bt,this.stride,Math.sqrt(t),e,0,o),new i(e,hr,o)},i.prototype.getType=function(){return"Polygon"},i.prototype.intersectsExtent=function(t){return ff(this.getOrientedFlatCoordinates(),0,this.bt,this.stride,t)},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var o=$h(this.flatCoordinates,0,t,this.stride,this.bt);this.flatCoordinates.length=o.length===0?0:o[o.length-1],this.changed()},i}(Cs),Lo=ep;function mf(s,i,t,e){for(var o=t||32,l=[],f=0;f<o;++f)ut(l,we(s,i,2*Math.PI*f/o,e));return l.push(l[0],l[1]),new ep(l,hr,[l.length])}function Ao(s){var i=s[0],t=s[1],e=s[2],o=s[3],l=[i,t,i,o,e,o,e,t,i,t];return new ep(l,hr,[l.length])}function us(s,i,t){for(var e=i||32,o=s.getStride(),l=s.getLayout(),f=s.getCenter(),y=o*(e+1),w=new Array(y),b=0;b<y;b+=o){w[b]=0,w[b+1]=0;for(var I=2;I<o;I++)w[b+I]=f[I]}var N=[w.length],D=new ep(w,l,N);return uc(D,f,s.getRadius(),t),D}function uc(s,i,t,e){for(var o=s.getFlatCoordinates(),l=s.getStride(),f=o.length/l-1,y=e||0,w=0;w<=f;++w){var b=w*l,I=y+2*be(w,f)*Math.PI/f;o[b]=i[0]+t*Math.cos(I),o[b+1]=i[1]+t*Math.sin(I)}s.changed()}var Dd=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Gd="accuracy",nl="accuracyGeometry",jd="altitude",Ll="altitudeAccuracy",Yu="heading",yf="position",to="projection",Zu="speed",la="tracking",Bd="trackingOptions",vf=function(s){function i(t){var e=s.call(this,dr)||this;return e.code=t.code,e.message=t.message,e}return Dd(i,s),i}(O),sl=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un;var o=t||{};return e.Ot=null,e.jt=Ke,e.Et=void 0,e.addChangeListener(to,e.Tt),e.addChangeListener(la,e.At),o.projection!==void 0&&e.setProjection(o.projection),o.trackingOptions!==void 0&&e.setTrackingOptions(o.trackingOptions),e.setTracking(o.tracking!==void 0&&o.tracking),e}return Dd(i,s),i.prototype.disposeInternal=function(){this.setTracking(!1),s.prototype.disposeInternal.call(this)},i.prototype.Tt=function(){var t=this.getProjection();t&&(this.jt=ji(ie("EPSG:4326"),t),this.Ot&&this.set(yf,this.jt(this.Ot)))},i.prototype.At=function(){if("geolocation"in navigator){var t=this.getTracking();t&&this.Et===void 0?this.Et=navigator.geolocation.watchPosition(this.Pt.bind(this),this.Ct.bind(this),this.getTrackingOptions()):t||this.Et===void 0||(navigator.geolocation.clearWatch(this.Et),this.Et=void 0)}},i.prototype.Pt=function(t){var e=t.coords;this.set(Gd,e.accuracy),this.set(jd,e.altitude===null?void 0:e.altitude),this.set(Ll,e.altitudeAccuracy===null?void 0:e.altitudeAccuracy),this.set(Yu,e.heading===null?void 0:qt(e.heading)),this.Ot?(this.Ot[0]=e.longitude,this.Ot[1]=e.latitude):this.Ot=[e.longitude,e.latitude];var o=this.jt(this.Ot);this.set(yf,o),this.set(Zu,e.speed===null?void 0:e.speed);var l=mf(this.Ot,e.accuracy);l.applyTransform(this.jt),this.set(nl,l),this.changed()},i.prototype.Ct=function(t){this.dispatchEvent(new vf(t))},i.prototype.getAccuracy=function(){return this.get(Gd)},i.prototype.getAccuracyGeometry=function(){return this.get(nl)||null},i.prototype.getAltitude=function(){return this.get(jd)},i.prototype.getAltitudeAccuracy=function(){return this.get(Ll)},i.prototype.getHeading=function(){return this.get(Yu)},i.prototype.getPosition=function(){return this.get(yf)},i.prototype.getProjection=function(){return this.get(to)},i.prototype.getSpeed=function(){return this.get(Zu)},i.prototype.getTracking=function(){return this.get(la)},i.prototype.getTrackingOptions=function(){return this.get(Bd)},i.prototype.setProjection=function(t){this.set(to,ie(t))},i.prototype.setTracking=function(t){this.set(la,t)},i.prototype.setTrackingOptions=function(t){this.set(Bd,t)},i}(cn),qs=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),hc=function(s){function i(t,e,o,l){var f=s.call(this)||this;return f.extent=t,f.kt=o,f.resolution=e,f.state=l,f}return qs(i,s),i.prototype.changed=function(){this.dispatchEvent(ne)},i.prototype.getExtent=function(){return this.extent},i.prototype.getImage=function(){return E()},i.prototype.getPixelRatio=function(){return this.kt},i.prototype.getResolution=function(){return this.resolution},i.prototype.getState=function(){return this.state},i.prototype.load=function(){E()},i}(ue),co=0,Oa=1,Nn=2,ca=3,$u=4,rp=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Ku(s,i,t){var e=s,o=!0,l=!1,f=!1,y=[Sr(e,Ar,function(){f=!0,l||i()})];return e.src&&St?(l=!0,e.decode().then(function(){o&&i()}).catch(function(w){o&&(f?i():t())})):y.push(Sr(e,dr,t)),function(){o=!1,y.forEach(Or)}}var pc=function(s){function i(t,e,o,l,f,y){var w=s.call(this,t,e,o,co)||this;return w.Nt=l,w.Lt=new Image,f!==null&&(w.Lt.crossOrigin=f),w.zt=null,w.state=co,w.Rt=y,w}return rp(i,s),i.prototype.getImage=function(){return this.Lt},i.prototype.Ft=function(){this.state=ca,this.Gt(),this.changed()},i.prototype.Dt=function(){this.resolution===void 0&&(this.resolution=Ki(this.extent)/this.Lt.height),this.state=Nn,this.Gt(),this.changed()},i.prototype.load=function(){this.state!=co&&this.state!=ca||(this.state=Oa,this.changed(),this.Rt(this,this.Nt),this.zt=Ku(this.Lt,this.Dt.bind(this),this.Ft.bind(this)))},i.prototype.setImage=function(t){this.Lt=t,this.resolution=Ki(this.extent)/this.Lt.height},i.prototype.Gt=function(){this.zt&&(this.zt(),this.zt=null)},i}(hc),_f=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$c=function(s){function i(t,e,o,l,f){var y=this,w=f!==void 0?co:Nn;return(y=s.call(this,t,e,o,w)||this).U=f!==void 0?f:null,y.qt=l,y.V=null,y}return _f(i,s),i.prototype.getError=function(){return this.V},i.prototype.Ut=function(t){t?(this.V=t,this.state=ca):this.state=Nn,this.changed()},i.prototype.load=function(){this.state==co&&(this.state=Oa,this.changed(),this.U(this.Ut.bind(this)))},i.prototype.getImage=function(){return this.qt},i}(hc);function Cn(s,i,t,e){var o;return o=t&&t.length?t.shift():gr?new OffscreenCanvas(s||300,i||300):document.createElement("canvas"),s&&(o.width=s),i&&(o.height=i),o.getContext("2d",e)}function ip(s){var i=s.canvas;i.width=1,i.height=1,s.clearRect(0,0,1,1)}function zd(s){var i=s.offsetWidth,t=getComputedStyle(s);return i+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10)}function Vd(s){var i=s.offsetHeight,t=getComputedStyle(s);return i+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}function Na(s,i){var t=i.parentNode;t&&t.replaceChild(s,i)}function Kc(s){return s&&s.parentNode?s.parentNode.removeChild(s):null}function Jc(s){for(;s.lastChild;)s.removeChild(s.lastChild)}function Ud(s,i){for(var t=s.childNodes,e=0;;++e){var o=t[e],l=i[e];if(!o&&!l)break;o!==l&&(o?l?s.insertBefore(l,o):(s.removeChild(o),--e):s.appendChild(l))}}var xf=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),fc=function(s){function i(t,e,o,l,f,y){var w=s.call(this,t,e,y)||this;return w.Bt=l,w.Nt=o,w.key=o,w.Lt=new Image,l!==null&&(w.Lt.crossOrigin=l),w.zt=null,w.Xt=f,w}return xf(i,s),i.prototype.getImage=function(){return this.Lt},i.prototype.setImage=function(t){this.Lt=t,this.state=Oe,this.Gt(),this.changed()},i.prototype.Ft=function(){var t;this.state=ur,this.Gt(),this.Lt=((t=Cn(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},i.prototype.Dt=function(){var t=this.Lt;t.naturalWidth&&t.naturalHeight?this.state=Oe:this.state=ar,this.Gt(),this.changed()},i.prototype.load=function(){this.state==ur&&(this.state=Er,this.Lt=new Image,this.Bt!==null&&(this.Lt.crossOrigin=this.Bt)),this.state==Er&&(this.state=br,this.changed(),this.Xt(this,this.Nt),this.zt=Ku(this.Lt,this.Dt.bind(this),this.Ft.bind(this)))},i.prototype.Gt=function(){this.zt&&(this.zt(),this.zt=null)},i}(Se),np=function(){function s(i,t,e){this.Vt=i,this.Wt=t,this.Yt=e,this.Zt=[],this.$t=0,this.Kt=0}return s.prototype.begin=function(){this.Zt.length=0,this.$t=0,this.Kt=0},s.prototype.update=function(i,t){this.Zt.push(i,t,Date.now())},s.prototype.end=function(){if(this.Zt.length<6)return!1;var i=Date.now()-this.Yt,t=this.Zt.length-3;if(this.Zt[t+2]<i)return!1;for(var e=t-3;e>0&&this.Zt[e+2]>i;)e-=3;var o=this.Zt[t+2]-this.Zt[e+2];if(o<1e3/60)return!1;var l=this.Zt[t]-this.Zt[e],f=this.Zt[t+1]-this.Zt[e+1];return this.$t=Math.atan2(f,l),this.Kt=Math.sqrt(l*l+f*f)/o,this.Kt>this.Wt},s.prototype.getDistance=function(){return(this.Wt-this.Kt)/this.Vt},s.prototype.getAngle=function(){return this.$t},s}(),Ju=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,op=/^([a-z]*)$|^hsla?\(.*\)$/i;function Pi(s){return typeof s=="string"?s:Qu(s)}function hs(s){var i=document.createElement("div");if(i.style.color=s,i.style.color!==""){document.body.appendChild(i);var t=getComputedStyle(i).color;return document.body.removeChild(i),t}return""}var ua=function(){var s={},i=0;return function(t){var e;if(s.hasOwnProperty(t))e=s[t];else{if(i>=1024){var o=0;for(var l in s)(3&o++)==0&&(delete s[l],--i)}e=function(f){var y,w,b,I,N;if(op.exec(f)&&(f=hs(f)),Ju.exec(f)){var D=f.length-1,j=void 0;j=D<=4?1:2;var H=D===4||D===8;y=parseInt(f.substr(1+0*j,j),16),w=parseInt(f.substr(1+1*j,j),16),b=parseInt(f.substr(1+2*j,j),16),I=H?parseInt(f.substr(1+3*j,j),16):255,j==1&&(y=(y<<4)+y,w=(w<<4)+w,b=(b<<4)+b,H&&(I=(I<<4)+I)),N=[y,w,b,I/255]}else f.indexOf("rgba(")==0?Qc(N=f.slice(5,-1).split(",").map(Number)):f.indexOf("rgb(")==0?((N=f.slice(4,-1).split(",").map(Number)).push(1),Qc(N)):Me(!1,14);return N}(t),s[t]=e,++i}return e}}();function Ra(s){return Array.isArray(s)?s:ua(s)}function Qc(s){return s[0]=Y(s[0]+.5|0,0,255),s[1]=Y(s[1]+.5|0,0,255),s[2]=Y(s[2]+.5|0,0,255),s[3]=Y(s[3],0,1),s}function Qu(s){var i=s[0];i!=(0|i)&&(i=i+.5|0);var t=s[1];t!=(0|t)&&(t=t+.5|0);var e=s[2];return e!=(0|e)&&(e=e+.5|0),"rgba("+i+","+t+","+e+","+(s[3]===void 0?1:Math.round(100*s[3])/100)+")"}function ps(s){return op.test(s)&&(s=hs(s)),Ju.test(s)||s.indexOf("rgba(")===0||s.indexOf("rgb(")===0}var al=function(){function s(){this.Ht={},this.Jt=0,this.Qt=32}return s.prototype.clear=function(){this.Ht={},this.Jt=0},s.prototype.canExpireCache=function(){return this.Jt>this.Qt},s.prototype.expire=function(){if(this.canExpireCache()){var i=0;for(var t in this.Ht){var e=this.Ht[t];(3&i++)!=0||e.hasListener()||(delete this.Ht[t],--this.Jt)}}},s.prototype.get=function(i,t,e){var o=th(i,t,e);return o in this.Ht?this.Ht[o]:null},s.prototype.set=function(i,t,e,o){var l=th(i,t,e);this.Ht[l]=o,++this.Jt},s.prototype.setSize=function(i){this.Qt=i,this.expire()},s}();function th(s,i,t){return i+":"+s+":"+(t?Pi(t):"null")}var Gm=al,Al=new al,dc="opacity",eh="visible",tu="extent",rh="zIndex",ih="maxResolution",nh="minResolution",Tn="maxZoom",wf="minZoom",ll="source",eu="map",Ts=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Hs=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un,e.tn=t.background;var o=Vt({},t);return typeof t.properties=="object"&&(delete o.properties,Vt(o,t.properties)),o[dc]=t.opacity!==void 0?t.opacity:1,Me(typeof o[dc]=="number",64),o[eh]=t.visible===void 0||t.visible,o[rh]=t.zIndex,o[ih]=t.maxResolution!==void 0?t.maxResolution:1/0,o[nh]=t.minResolution!==void 0?t.minResolution:0,o[wf]=t.minZoom!==void 0?t.minZoom:-1/0,o[Tn]=t.maxZoom!==void 0?t.maxZoom:1/0,e.nn=o.className!==void 0?o.className:"ol-layer",delete o.className,e.setProperties(o),e.rn=null,e}return Ts(i,s),i.prototype.getBackground=function(){return this.tn},i.prototype.getClassName=function(){return this.nn},i.prototype.getLayerState=function(t){var e=this.rn||{layer:this,managed:t===void 0||t},o=this.getZIndex();return e.opacity=Y(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=o!==void 0||e.managed?o:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.rn=e,e},i.prototype.getLayersArray=function(t){return E()},i.prototype.getLayerStatesArray=function(t){return E()},i.prototype.getExtent=function(){return this.get(tu)},i.prototype.getMaxResolution=function(){return this.get(ih)},i.prototype.getMinResolution=function(){return this.get(nh)},i.prototype.getMinZoom=function(){return this.get(wf)},i.prototype.getMaxZoom=function(){return this.get(Tn)},i.prototype.getOpacity=function(){return this.get(dc)},i.prototype.getSourceState=function(){return E()},i.prototype.getVisible=function(){return this.get(eh)},i.prototype.getZIndex=function(){return this.get(rh)},i.prototype.setBackground=function(t){this.tn=t,this.changed()},i.prototype.setExtent=function(t){this.set(tu,t)},i.prototype.setMaxResolution=function(t){this.set(ih,t)},i.prototype.setMinResolution=function(t){this.set(nh,t)},i.prototype.setMaxZoom=function(t){this.set(Tn,t)},i.prototype.setMinZoom=function(t){this.set(wf,t)},i.prototype.setOpacity=function(t){Me(typeof t=="number",64),this.set(dc,t)},i.prototype.setVisible=function(t){this.set(eh,t)},i.prototype.setZIndex=function(t){this.set(rh,t)},i.prototype.disposeInternal=function(){this.rn&&(this.rn.layer=null,this.rn=null),s.prototype.disposeInternal.call(this)},i}(cn),Ol="prerender",bf="postrender",sp="precompose",Sf="postcompose",ha="rendercomplete",Ef=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function cl(s,i){if(!s.visible)return!1;var t=i.resolution;if(t<s.minResolution||t>=s.maxResolution)return!1;var e=i.zoom;return e>s.minZoom&&e<=s.maxZoom}var pa=function(s){function i(t){var e=this,o=Vt({},t);delete o.source,(e=s.call(this,o)||this).on,e.once,e.un,e.en=null,e.sn=null,e.an=null,e.hn=null,e.rendered=!1,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addChangeListener(ll,e.fn);var l=t.source?t.source:null;return e.setSource(l),e}return Ef(i,s),i.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},i.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},i.prototype.getSource=function(){return this.get(ll)||null},i.prototype.getRenderSource=function(){return this.getSource()},i.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},i.prototype.cn=function(){this.changed()},i.prototype.fn=function(){this.an&&(Or(this.an),this.an=null);var t=this.getSource();t&&(this.an=Ee(t,ne,this.cn,this)),this.changed()},i.prototype.getFeatures=function(t){return this.hn?this.hn.getFeatures(t):new Promise(function(e){return e([])})},i.prototype.getData=function(t){return this.hn&&this.rendered?this.hn.getData(t):null},i.prototype.render=function(t,e){var o=this.getRenderer();if(o.prepareFrame(t))return this.rendered=!0,o.renderFrame(t,e)},i.prototype.unrender=function(){this.rendered=!1},i.prototype.setMapInternal=function(t){t||this.unrender(),this.set(eu,t)},i.prototype.getMapInternal=function(){return this.get(eu)},i.prototype.setMap=function(t){this.en&&(Or(this.en),this.en=null),t||this.changed(),this.sn&&(Or(this.sn),this.sn=null),t&&(this.en=Ee(t,sp,function(e){var o=e.frameState.layerStatesArray,l=this.getLayerState(!1);Me(!o.some(function(f){return f.layer===l.layer}),67),o.push(l)},this),this.sn=Ee(this,ne,t.render,t),this.changed())},i.prototype.setSource=function(t){this.set(ll,t)},i.prototype.getRenderer=function(){return this.hn||(this.hn=this.createRenderer()),this.hn},i.prototype.hasRenderer=function(){return!!this.hn},i.prototype.createRenderer=function(){return null},i.prototype.disposeInternal=function(){this.hn&&(this.hn.dispose(),delete this.hn),this.setSource(null),s.prototype.disposeInternal.call(this)},i}(Hs),ul=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function ru(s,i){Al.expire()}var iu=function(s){function i(t){var e=s.call(this)||this;return e.vn=t,e}return ul(i,s),i.prototype.dispatchRenderEvent=function(t,e){E()},i.prototype.calculateMatrices2D=function(t){var e=t.viewState,o=t.coordinateToPixelTransform,l=t.pixelToCoordinateTransform;At(o,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Qt(l,o)},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f,y,w,b){var I,N=e.viewState;function D(Re,qe,Ge,Qe){return f.call(y,qe,Re?Ge:null,Qe)}var j=N.projection,H=tt(t.slice(),j),Z=[[0,0]];if(j.canWrapX()&&l){var it=Gr(j.getExtent());Z.push([-it,0],[it,0])}for(var at=e.layerStatesArray,wt=at.length,gt=[],yt=[],It=0;It<Z.length;It++)for(var Rt=wt-1;Rt>=0;--Rt){var kt=at[Rt],Dt=kt.layer;if(Dt.hasRenderer()&&cl(kt,N)&&w.call(b,Dt)){var Xt=Dt.getRenderer(),ee=Dt.getSource();if(Xt&&ee){var pe=ee.getWrapX()?H:t,xe=D.bind(null,kt.managed);yt[0]=pe[0]+Z[It][0],yt[1]=pe[1]+Z[It][1],I=Xt.forEachFeatureAtCoordinate(yt,e,o,xe,gt)}if(I)return I}}if(gt.length!==0){var fe=1/gt.length;return gt.forEach(function(Re,qe){return Re.distanceSq+=qe*fe}),gt.sort(function(Re,qe){return Re.distanceSq-qe.distanceSq}),gt.some(function(Re){return I=Re.callback(Re.feature,Re.layer,Re.geometry)}),I}},i.prototype.forEachLayerAtPixel=function(t,e,o,l,f){return E()},i.prototype.hasFeatureAtCoordinate=function(t,e,o,l,f,y){return this.forEachFeatureAtCoordinate(t,e,o,l,rt,this,f,y)!==void 0},i.prototype.getMap=function(){return this.vn},i.prototype.renderFrame=function(t){E()},i.prototype.scheduleExpireIconCache=function(t){Al.canExpireCache()&&t.postRenderFunctions.push(ru)},i}(Q),gc=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),hl=function(s){function i(t,e,o,l){var f=s.call(this,t)||this;return f.inversePixelTransform=e,f.frameState=o,f.context=l,f}return gc(i,s),i}(O),Nl="ol-hidden",jm="ol-selectable",mc="ol-unselectable",yc="ol-unsupported",fa="ol-control",nu="ol-collapsed",Rl=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),vc=["style","variant","weight","size","lineHeight","family"],oh=function(s){var i=s.match(Rl);if(!i)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},e=0,o=vc.length;e<o;++e){var l=i[e+1];l!==void 0&&(t[vc[e]]=l)}return t.families=t.family.split(/,\s?/),t},ou="10px sans-serif",Xs="#000",ka="round",pl=[],Fa="round",Da=10,Ps="#000",Ga="center",kl="middle",Fl=[0,0,0,0],da=new cn,sh=new ue;sh.setSize=function(){console.warn("labelCache is deprecated.")};var fl,Oo,su=null,au={},fo=function(){var s,i,t="32px ",e=["monospace","serif"],o=e.length,l="wmytzilWMYTZIL@#/&?$%10\uF013";function f(w,b,I){for(var N=!0,D=0;D<o;++D){var j=e[D];if(i=Rn(w+" "+b+" "+t+j,l),I!=j){var H=Rn(w+" "+b+" "+t+I+","+j,l);N=N&&H!=i}}return!!N}function y(){for(var w=!0,b=da.getKeys(),I=0,N=b.length;I<N;++I){var D=b[I];da.get(D)<100&&(f.apply(this,D.split(`
`))?(Lt(au),su=null,fl=void 0,da.set(D,100)):(da.set(D,da.get(D)+1,!0),w=!1))}w&&(clearInterval(s),s=void 0)}return function(w){var b=oh(w);if(b)for(var I=b.families,N=0,D=I.length;N<D;++N){var j=I[N],H=b.style+`
`+b.weight+`
`+j;da.get(H)===void 0&&(da.set(H,100,!0),f(b.style,b.weight,j)||(da.set(H,0,!0),s===void 0&&(s=setInterval(y,32))))}}}(),Ji=function(s){var i=au[s];if(i==null){if(gr){var t=oh(s),e=Dl(s,"\u017Dg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(e.actualBoundingBoxAscent+e.actualBoundingBoxDescent)}else Oo||((Oo=document.createElement("div")).innerHTML="M",Oo.style.minHeight="0",Oo.style.maxHeight="none",Oo.style.height="auto",Oo.style.padding="0",Oo.style.border="none",Oo.style.position="absolute",Oo.style.display="block",Oo.style.left="-99999px"),Oo.style.font=s,document.body.appendChild(Oo),i=Oo.offsetHeight,document.body.removeChild(Oo);au[s]=i}return i};function Dl(s,i){return su||(su=Cn(1,1)),s!=fl&&(su.font=s,fl=su.font),su.measureText(i)}function Rn(s,i){return Dl(s,i).width}function _c(s,i,t){if(i in t)return t[i];var e=i.split(`
`).reduce(function(o,l){return Math.max(o,Rn(s,l))},0);return t[i]=e,e}function ah(s,i){for(var t=[],e=[],o=[],l=0,f=0,y=0,w=0,b=0,I=i.length;b<=I;b+=2){var N=i[b];if(N!==`
`&&b!==I){var D=i[b+1]||s.font,j=Rn(D,N);t.push(j),f+=j;var H=Ji(D);e.push(H),w=Math.max(w,H)}else l=Math.max(l,f),o.push(f),f=0,y+=w}return{width:l,height:y,widths:t,heights:e,lineWidths:o}}function lh(s,i,t,e,o,l,f,y,w,b,I){s.save(),t!==1&&(s.globalAlpha*=t),i&&s.setTransform.apply(s,i),e.contextInstructions?(s.translate(w,b),s.scale(I[0],I[1]),function(N,D){for(var j=N.contextInstructions,H=0,Z=j.length;H<Z;H+=2)Array.isArray(j[H+1])?D[j[H]].apply(D,j[H+1]):D[j[H]]=j[H+1]}(e,s)):I[0]<0||I[1]<0?(s.translate(w,b),s.scale(I[0],I[1]),s.drawImage(e,o,l,f,y,0,0,f,y)):s.drawImage(e,o,l,f,y,w,b,f*I[0],y*I[1]),s.restore()}var Is=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ap=function(s){function i(t){var e=s.call(this,t)||this;e.dn=Ee(da,K,t.redrawText.bind(t)),e.pn=document.createElement("div");var o=e.pn.style;o.position="absolute",o.width="100%",o.height="100%",o.zIndex="1",e.pn.className="ol-unselectable ol-layers";var l=t.getViewport();return l.insertBefore(e.pn,l.firstChild||null),e.yn=[],e.mn=!0,e}return Is(i,s),i.prototype.dispatchRenderEvent=function(t,e){var o=this.getMap();if(o.hasListener(t)){var l=new hl(t,void 0,e);o.dispatchEvent(l)}},i.prototype.disposeInternal=function(){Or(this.dn),this.pn.parentNode.removeChild(this.pn),s.prototype.disposeInternal.call(this)},i.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(sp,t);var e=t.layerStatesArray.sort(function(j,H){return j.zIndex-H.zIndex}),o=t.viewState;this.yn.length=0;for(var l=[],f=null,y=0,w=e.length;y<w;++y){var b=e[y];t.layerIndex=y;var I=b.layer,N=I.getSourceState();if(!cl(b,o)||N!="ready"&&N!="undefined")I.unrender();else{var D=I.render(t,f);D&&(D!==f&&(this.yn.push(D),f=D),"getDeclutter"in I&&l.push(I))}}for(y=l.length-1;y>=0;--y)l[y].renderDeclutter(t);Ud(this.pn,this.yn),this.dispatchRenderEvent(Sf,t),this.mn||(this.pn.style.display="",this.mn=!0),this.scheduleExpireIconCache(t)}else this.mn&&(this.pn.style.display="none",this.mn=!1)},i.prototype.forEachLayerAtPixel=function(t,e,o,l,f){for(var y=e.viewState,w=e.layerStatesArray,b=w.length-1;b>=0;--b){var I=w[b],N=I.layer;if(N.hasRenderer()&&cl(I,y)&&f(N)){var D=N.getRenderer().getDataAtPixel(t,e,o);if(D){var j=l(N,D);if(j)return j}}}},i}(iu),ch=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ws=function(s){function i(t,e){var o=s.call(this,t)||this;return o.layer=e,o}return ch(i,s),i}(O),lu="layers",Gl=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);delete l.layers;var f=o.layers;return(e=s.call(this,l)||this).on,e.once,e.un,e.wn=[],e.gn={},e.addChangeListener(lu,e.bn),f?Array.isArray(f)?f=new Be(f.slice(),{unique:!0}):Me(typeof f.getArray=="function",43):f=new Be(void 0,{unique:!0}),e.setLayers(f),e}return ch(i,s),i.prototype.xn=function(){this.changed()},i.prototype.bn=function(){this.wn.forEach(Or),this.wn.length=0;var t=this.getLayers();for(var e in this.wn.push(Ee(t,Ft,this.Mn,this),Ee(t,Ot,this._n,this)),this.gn)this.gn[e].forEach(Or);Lt(this.gn);for(var o=t.getArray(),l=0,f=o.length;l<f;l++){var y=o[l];this.Sn(y),this.dispatchEvent(new Ws("addlayer",y))}this.changed()},i.prototype.Sn=function(t){var e=[Ee(t,K,this.xn,this),Ee(t,ne,this.xn,this)];t instanceof i&&e.push(Ee(t,"addlayer",this.On,this),Ee(t,"removelayer",this.jn,this)),this.gn[L(t)]=e},i.prototype.On=function(t){this.dispatchEvent(new Ws("addlayer",t.layer))},i.prototype.jn=function(t){this.dispatchEvent(new Ws("removelayer",t.layer))},i.prototype.Mn=function(t){var e=t.element;this.Sn(e),this.dispatchEvent(new Ws("addlayer",e)),this.changed()},i.prototype._n=function(t){var e=t.element,o=L(e);this.gn[o].forEach(Or),delete this.gn[o],this.dispatchEvent(new Ws("removelayer",e)),this.changed()},i.prototype.getLayers=function(){return this.get(lu)},i.prototype.setLayers=function(t){var e=this.getLayers();if(e)for(var o=e.getArray(),l=0,f=o.length;l<f;++l)this.dispatchEvent(new Ws("removelayer",o[l]));this.set(lu,t)},i.prototype.getLayersArray=function(t){var e=t!==void 0?t:[];return this.getLayers().forEach(function(o){o.getLayersArray(e)}),e},i.prototype.getLayerStatesArray=function(t){var e=t!==void 0?t:[],o=e.length;this.getLayers().forEach(function(I){I.getLayerStatesArray(e)});var l=this.getLayerState(),f=l.zIndex;t||l.zIndex!==void 0||(f=0);for(var y=o,w=e.length;y<w;y++){var b=e[y];b.opacity*=l.opacity,b.visible=b.visible&&l.visible,b.maxResolution=Math.min(b.maxResolution,l.maxResolution),b.minResolution=Math.max(b.minResolution,l.minResolution),b.minZoom=Math.max(b.minZoom,l.minZoom),b.maxZoom=Math.min(b.maxZoom,l.maxZoom),l.extent!==void 0&&(b.extent!==void 0?b.extent=fn(b.extent,l.extent):b.extent=l.extent),b.zIndex===void 0&&(b.zIndex=f)}return e},i.prototype.getSourceState=function(){return"ready"},i}(Hs),jl=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),go=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.map=e,l.frameState=o!==void 0?o:null,l}return jl(i,s),i}(O),uh=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ms=function(s){function i(t,e,o,l,f,y){var w=s.call(this,t,e,f)||this;return w.originalEvent=o,w.En=null,w.Tn=null,w.dragging=l!==void 0&&l,w.activePointers=y,w}return uh(i,s),Object.defineProperty(i.prototype,"pixel",{get:function(){return this.En||(this.En=this.map.getEventPixel(this.originalEvent)),this.En},set:function(t){this.En=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"coordinate",{get:function(){return this.Tn||(this.Tn=this.map.getCoordinateFromPixel(this.pixel)),this.Tn},set:function(t){this.Tn=t},enumerable:!1,configurable:!0}),i.prototype.preventDefault=function(){s.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},i.prototype.stopPropagation=function(){s.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},i}(go),zi={SINGLECLICK:"singleclick",CLICK:Br,DBLCLICK:Ue,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},lp="pointermove",Ls="pointerdown",Bl="pointerup",cp="pointerout",hh=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),jn=function(s){function i(t,e){var o=s.call(this,t)||this;o.vn=t,o.An,o.Pn=!1,o.Cn=!1,o.kn=[],o.In=e===void 0?1:e,o.Nn=null;var l=o.vn.getViewport();return o.Ln=[],o.zn={},o.pn=l,o.Rn=Ee(l,Ls,o.Fn,o),o.Gn,o.Dn=Ee(l,lp,o.qn,o),o.Un=o.Bn.bind(o),o.pn.addEventListener(Kr,o.Un,!!_i&&{passive:!1}),o}return hh(i,s),i.prototype.Xn=function(t){var e=new Ms(zi.CLICK,this.vn,t);this.dispatchEvent(e),this.An!==void 0?(clearTimeout(this.An),this.An=void 0,e=new Ms(zi.DBLCLICK,this.vn,t),this.dispatchEvent(e)):this.An=setTimeout(function(){this.An=void 0;var o=new Ms(zi.SINGLECLICK,this.vn,t);this.dispatchEvent(o)}.bind(this),250)},i.prototype.Vn=function(t){var e=t,o=e.pointerId;if(e.type==zi.POINTERUP||e.type==zi.POINTERCANCEL){for(var l in delete this.zn[o],this.zn)if(this.zn[l].target!==e.target){delete this.zn[l];break}}else e.type!=zi.POINTERDOWN&&e.type!=zi.POINTERMOVE||(this.zn[o]=e);this.Ln=Ne(this.zn)},i.prototype.Wn=function(t){this.Vn(t);var e=new Ms(zi.POINTERUP,this.vn,t,void 0,void 0,this.Ln);this.dispatchEvent(e),this.Pn&&!e.defaultPrevented&&!this.Cn&&this.Yn(t)&&this.Xn(this.Nn),this.Ln.length===0&&(this.kn.forEach(Or),this.kn.length=0,this.Cn=!1,this.Nn=null)},i.prototype.Yn=function(t){return t.button===0},i.prototype.Fn=function(t){this.Pn=this.Ln.length===0,this.Vn(t);var e=new Ms(zi.POINTERDOWN,this.vn,t,void 0,void 0,this.Ln);for(var o in this.dispatchEvent(e),this.Nn={},t){var l=t[o];this.Nn[o]=typeof l=="function"?vt:l}if(this.kn.length===0){var f=this.vn.getOwnerDocument();this.kn.push(Ee(f,zi.POINTERMOVE,this.Zn,this),Ee(f,zi.POINTERUP,this.Wn,this),Ee(this.pn,zi.POINTERCANCEL,this.Wn,this)),this.pn.getRootNode&&this.pn.getRootNode()!==f&&this.kn.push(Ee(this.pn.getRootNode(),zi.POINTERUP,this.Wn,this))}},i.prototype.Zn=function(t){if(this.$n(t)){this.Vn(t),this.Cn=!0;var e=new Ms(zi.POINTERDRAG,this.vn,t,this.Cn,void 0,this.Ln);this.dispatchEvent(e)}},i.prototype.qn=function(t){this.Gn=t;var e=!(!this.Nn||!this.$n(t));this.dispatchEvent(new Ms(zi.POINTERMOVE,this.vn,t,e))},i.prototype.Bn=function(t){var e=this.Gn;e&&!e.defaultPrevented||typeof t.cancelable=="boolean"&&t.cancelable!==!0||t.preventDefault()},i.prototype.$n=function(t){return this.Cn||Math.abs(t.clientX-this.Nn.clientX)>this.In||Math.abs(t.clientY-this.Nn.clientY)>this.In},i.prototype.disposeInternal=function(){this.Dn&&(Or(this.Dn),this.Dn=null),this.pn.removeEventListener(Kr,this.Un),this.Rn&&(Or(this.Rn),this.Rn=null),this.kn.forEach(Or),this.kn.length=0,this.pn=null,s.prototype.disposeInternal.call(this)},i}(ue),ga="postrender",ph="movestart",As="moveend",up="loadstart",hp="loadend",pp="layergroup",fh="size",dl="target",zl="view",Vl=1/0,dh=function(){function s(i,t){this.Kn=i,this.Hn=t,this.Jn=[],this.Qn=[],this.ti={}}return s.prototype.clear=function(){this.Jn.length=0,this.Qn.length=0,Lt(this.ti)},s.prototype.dequeue=function(){var i=this.Jn,t=this.Qn,e=i[0];i.length==1?(i.length=0,t.length=0):(i[0]=i.pop(),t[0]=t.pop(),this.ni(0));var o=this.Hn(e);return delete this.ti[o],e},s.prototype.enqueue=function(i){Me(!(this.Hn(i)in this.ti),31);var t=this.Kn(i);return t!=Vl&&(this.Jn.push(i),this.Qn.push(t),this.ti[this.Hn(i)]=!0,this.ii(0,this.Jn.length-1),!0)},s.prototype.getCount=function(){return this.Jn.length},s.prototype.ri=function(i){return 2*i+1},s.prototype.ei=function(i){return 2*i+2},s.prototype.oi=function(i){return i-1>>1},s.prototype.si=function(){var i;for(i=(this.Jn.length>>1)-1;i>=0;i--)this.ni(i)},s.prototype.isEmpty=function(){return this.Jn.length===0},s.prototype.isKeyQueued=function(i){return i in this.ti},s.prototype.isQueued=function(i){return this.isKeyQueued(this.Hn(i))},s.prototype.ni=function(i){for(var t=this.Jn,e=this.Qn,o=t.length,l=t[i],f=e[i],y=i;i<o>>1;){var w=this.ri(i),b=this.ei(i),I=b<o&&e[b]<e[w]?b:w;t[i]=t[I],e[i]=e[I],i=I}t[i]=l,e[i]=f,this.ii(y,i)},s.prototype.ii=function(i,t){for(var e=this.Jn,o=this.Qn,l=e[t],f=o[t];t>i;){var y=this.oi(t);if(!(o[y]>f))break;e[t]=e[y],o[t]=o[y],t=y}e[t]=l,o[t]=f},s.prototype.reprioritize=function(){var i,t,e,o=this.Kn,l=this.Jn,f=this.Qn,y=0,w=l.length;for(t=0;t<w;++t)(e=o(i=l[t]))==Vl?delete this.ti[this.Hn(i)]:(f[y]=e,l[y++]=i);l.length=y,f.length=y,this.si()},s}(),Cf=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Tf=function(s){function i(t,e){var o=s.call(this,function(l){return t.apply(null,l)},function(l){return l[0].getKey()})||this;return o.ui=o.handleTileChange.bind(o),o.ai=e,o.hi=0,o.fi={},o}return Cf(i,s),i.prototype.enqueue=function(t){var e=s.prototype.enqueue.call(this,t);return e&&t[0].addEventListener(ne,this.ui),e},i.prototype.getTilesLoading=function(){return this.hi},i.prototype.handleTileChange=function(t){var e=t.target,o=e.getState();if(o===Oe||o===ur||o===ar){e.removeEventListener(ne,this.ui);var l=e.getKey();l in this.fi&&(delete this.fi[l],--this.hi),this.ai()}},i.prototype.loadMoreTiles=function(t,e){for(var o,l,f=0;this.hi<t&&f<e&&this.getCount()>0;)l=(o=this.dequeue()[0]).getKey(),o.getState()!==Er||l in this.fi||(this.fi[l]=!0,++this.hi,++f,o.load())},i}(dh);function qd(s,i,t,e,o){if(!s||!(t in s.wantedTiles)||!s.wantedTiles[t][i.getKey()])return Vl;var l=s.viewState.center,f=e[0]-l[0],y=e[1]-l[1];return 65536*Math.log(o)+Math.sqrt(f*f+y*y)/o}var is=0,Os=1,Ns={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Ys=256;function Pf(s,i,t){return function(e,o,l,f,y){if(e){if(!o&&!i)return e;var w=i?0:l[0]*o,b=i?0:l[1]*o,I=y?y[0]:0,N=y?y[1]:0,D=s[0]+w/2+I,j=s[2]-w/2+I,H=s[1]+b/2+N,Z=s[3]-b/2+N;D>j&&(j=D=(j+D)/2),H>Z&&(Z=H=(Z+H)/2);var it=Y(e[0],D,j),at=Y(e[1],H,Z);if(f&&t&&o){var wt=30*o;it+=-wt*Math.log(1+Math.max(0,D-e[0])/wt)+wt*Math.log(1+Math.max(0,e[0]-j)/wt),at+=-wt*Math.log(1+Math.max(0,H-e[1])/wt)+wt*Math.log(1+Math.max(0,e[1]-Z)/wt)}return[it,at]}}}function dt(s){return s}function r(s,i,t,e){var o=Gr(i)/t[0],l=Ki(i)/t[1];return e?Math.min(s,Math.max(o,l)):Math.min(s,Math.min(o,l))}function a(s,i,t){var e=Math.min(s,i);return e*=Math.log(1+50*Math.max(0,s/i-1))/50+1,t&&(e=Math.max(e,t),e/=Math.log(1+50*Math.max(0,t/s-1))/50+1),Y(e,t/2,2*i)}function p(s,i,t,e){return function(o,l,f,y){if(o!==void 0){var w=s[0],b=s[s.length-1],I=t?r(w,t,f,e):w;if(y)return i===void 0||i?a(o,I,b):Y(o,b,I);var N=Math.min(I,o),D=Math.floor(T(s,N,l));return s[D]>I&&D<s.length-1?s[D+1]:s[D]}}}function _(s,i,t,e,o,l){return function(f,y,w,b){if(f!==void 0){var I=o?r(i,o,w,l):i,N=t!==void 0?t:0;if(b)return e===void 0||e?a(f,I,N):Y(f,N,I);var D=Math.ceil(Math.log(i/I)/Math.log(s)-1e-9),j=-y*(.5-1e-9)+.5,H=Math.min(I,f),Z=Math.floor(Math.log(i/H)/Math.log(s)+j),it=Math.max(D,Z);return Y(i/Math.pow(s,it),N,I)}}}function C(s,i,t,e,o){return function(l,f,y,w){if(l!==void 0){var b=e?r(s,e,y,o):s;return(t===void 0||t)&&w?a(l,b,i):Y(l,i,b)}}}function k(s){return s!==void 0?0:void 0}function X(s){return s!==void 0?s:void 0}function J(s){var i=2*Math.PI/s;return function(t,e){return e?t:t!==void 0?t=Math.floor(t/i+.5)*i:void 0}}function Ct(s){var i=s||qt(5);return function(t,e){return e?t:t!==void 0?Math.abs(t)<=i?0:t:void 0}}var te=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function ce(s,i){setTimeout(function(){s(i)},0)}function Ye(s){if(s.extent!==void 0){var i=s.smoothExtentConstraint===void 0||s.smoothExtentConstraint;return Pf(s.extent,s.constrainOnlyCenter,i)}var t=Yi(s.projection,"EPSG:3857");if(s.multiWorld!==!0&&t.isGlobal()){var e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Pf(e,!1,!1)}return dt}function sr(s){var i,t,e,o=s.minZoom!==void 0?s.minZoom:0,l=s.maxZoom!==void 0?s.maxZoom:28,f=s.zoomFactor!==void 0?s.zoomFactor:2,y=s.multiWorld!==void 0&&s.multiWorld,w=s.smoothResolutionConstraint===void 0||s.smoothResolutionConstraint,b=s.showFullExtent!==void 0&&s.showFullExtent,I=Yi(s.projection,"EPSG:3857"),N=I.getExtent(),D=s.constrainOnlyCenter,j=s.extent;if(y||j||!I.isGlobal()||(D=!1,j=N),s.resolutions!==void 0){var H=s.resolutions;t=H[o],e=H[l]!==void 0?H[l]:H[H.length-1],i=s.constrainResolution?p(H,w,!D&&j,b):C(t,e,w,!D&&j,b)}else{var Z=(N?Math.max(Gr(N),Ki(N)):360*Di[Mi.DEGREES]/I.getMetersPerUnit())/Ys/Math.pow(2,0),it=Z/Math.pow(2,28);(t=s.maxResolution)!==void 0?o=0:t=Z/Math.pow(f,o),(e=s.minResolution)===void 0&&(e=s.maxZoom!==void 0?s.maxResolution!==void 0?t/Math.pow(f,l):Z/Math.pow(f,l):it),l=o+Math.floor(Math.log(t/e)/Math.log(f)),e=t/Math.pow(f,l-o),i=s.constrainResolution?_(f,t,e,w,!D&&j,b):C(t,e,w,!D&&j,b)}return{constraint:i,maxResolution:t,minResolution:e,minZoom:o,zoomFactor:f}}function Cr(s){if(s.enableRotation===void 0||s.enableRotation){var i=s.constrainRotation;return i===void 0||i===!0?Ct():i===!1?X:typeof i=="number"?J(i):X}return k}function Ii(s){return!(s.sourceCenter&&s.targetCenter&&!mn(s.sourceCenter,s.targetCenter))&&s.sourceResolution===s.targetResolution&&s.sourceRotation===s.targetRotation}function Vn(s,i,t,e,o){var l=Math.cos(-o),f=Math.sin(-o),y=s[0]*l-s[1]*f,w=s[1]*l+s[0]*f;return[(y+=(i[0]/2-t[0])*e)*l-(w+=(t[1]-i[1]/2)*e)*(f=-f),w*l+y*f]}var no=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un;var o=Vt({},t);return e.ci=[0,0],e.li=[],e.vi,e.di=Yi(o.projection,"EPSG:3857"),e.yi=[100,100],e.mi=null,e.wi,e.gi,e.bi=null,e.xi,e.Mi,e._i=void 0,o.projection&&me(),o.center&&(o.center=$i(o.center,e.di)),o.extent&&(o.extent=Mo(o.extent,e.di)),e.Si(o),e}return te(i,s),i.prototype.Si=function(t){var e=Vt({},t);for(var o in Ns)delete e[o];this.setProperties(e,!0);var l=sr(t);this.Oi=l.maxResolution,this.ji=l.minResolution,this.Ei=l.zoomFactor,this.Ti=t.resolutions,this.Ai=t.padding,this.Pi=l.minZoom;var f=Ye(t),y=l.constraint,w=Cr(t);this.Ci={center:f,resolution:y,rotation:w},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(i.prototype,"padding",{get:function(){return this.Ai},set:function(t){var e=this.Ai;this.Ai=t;var o=this.getCenter();if(o){var l=t||[0,0,0,0];e=e||[0,0,0,0];var f=this.getResolution(),y=f/2*(l[3]-e[3]+e[1]-l[1]),w=f/2*(l[0]-e[0]+e[2]-l[2]);this.setCenterInternal([o[0]+y,o[1]-w])}},enumerable:!1,configurable:!0}),i.prototype.ki=function(t){var e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Vt({},e,t)},i.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),o=0;o<e.length;++o){var l=arguments[o];l.center&&((l=Vt({},l)).center=$i(l.center,this.getProjection())),l.anchor&&((l=Vt({},l)).anchor=$i(l.anchor,this.getProjection())),e[o]=l}this.animateInternal.apply(this,e)},i.prototype.animateInternal=function(t){var e,o=arguments.length;o>1&&typeof arguments[o-1]=="function"&&(e=arguments[o-1],--o);for(var l=0;l<o&&!this.isDef();++l){var f=arguments[l];f.center&&this.setCenterInternal(f.center),f.zoom!==void 0?this.setZoom(f.zoom):f.resolution&&this.setResolution(f.resolution),f.rotation!==void 0&&this.setRotation(f.rotation)}if(l!==o){for(var y=Date.now(),w=this.mi.slice(),b=this.wi,I=this.gi,N=[];l<o;++l){var D=arguments[l],j={start:y,complete:!1,anchor:D.anchor,duration:D.duration!==void 0?D.duration:1e3,easing:D.easing||Wt,callback:e};if(D.center&&(j.sourceCenter=w,j.targetCenter=D.center.slice(),w=j.targetCenter),D.zoom!==void 0?(j.sourceResolution=b,j.targetResolution=this.getResolutionForZoom(D.zoom),b=j.targetResolution):D.resolution&&(j.sourceResolution=b,j.targetResolution=D.resolution,b=j.targetResolution),D.rotation!==void 0){j.sourceRotation=I;var H=be(D.rotation-I+Math.PI,2*Math.PI)-Math.PI;j.targetRotation=I+H,I=j.targetRotation}Ii(j)?j.complete=!0:y+=j.duration,N.push(j)}this.li.push(N),this.setHint(is,1),this.Ii()}else e&&ce(e,!0)},i.prototype.getAnimating=function(){return this.ci[is]>0},i.prototype.getInteracting=function(){return this.ci[Os]>0},i.prototype.cancelAnimations=function(){var t;this.setHint(is,-this.ci[is]);for(var e=0,o=this.li.length;e<o;++e){var l=this.li[e];if(l[0].callback&&ce(l[0].callback,!1),!t)for(var f=0,y=l.length;f<y;++f){var w=l[f];if(!w.complete){t=w.anchor;break}}}this.li.length=0,this._i=t,this.bi=null,this.xi=NaN,this.Mi=NaN},i.prototype.Ii=function(){if(this.vi!==void 0&&(cancelAnimationFrame(this.vi),this.vi=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,o=this.li.length-1;o>=0;--o){for(var l=this.li[o],f=!0,y=0,w=l.length;y<w;++y){var b=l[y];if(!b.complete){var I=t-b.start,N=b.duration>0?I/b.duration:1;N>=1?(b.complete=!0,N=1):f=!1;var D=b.easing(N);if(b.sourceCenter){var j=b.sourceCenter[0],H=b.sourceCenter[1],Z=b.targetCenter[0],it=b.targetCenter[1];this.bi=b.targetCenter;var at=j+D*(Z-j),wt=H+D*(it-H);this.mi=[at,wt]}if(b.sourceResolution&&b.targetResolution){var gt=D===1?b.targetResolution:b.sourceResolution+D*(b.targetResolution-b.sourceResolution);if(b.anchor){var yt=this.Ni(this.getRotation()),It=this.Ci.resolution(gt,0,yt,!0);this.mi=this.calculateCenterZoom(It,b.anchor)}this.xi=b.targetResolution,this.wi=gt,this.Li(!0)}if(b.sourceRotation!==void 0&&b.targetRotation!==void 0){var Rt=D===1?be(b.targetRotation+Math.PI,2*Math.PI)-Math.PI:b.sourceRotation+D*(b.targetRotation-b.sourceRotation);if(b.anchor){var kt=this.Ci.rotation(Rt,!0);this.mi=this.calculateCenterRotate(kt,b.anchor)}this.Mi=b.targetRotation,this.gi=Rt}if(this.Li(!0),e=!0,!b.complete)break}}if(f){this.li[o]=null,this.setHint(is,-1),this.bi=null,this.xi=NaN,this.Mi=NaN;var Dt=l[0].callback;Dt&&ce(Dt,!0)}}this.li=this.li.filter(Boolean),e&&this.vi===void 0&&(this.vi=requestAnimationFrame(this.Ii.bind(this)))}},i.prototype.calculateCenterRotate=function(t,e){var o,l=this.getCenterInternal();return l!==void 0&&(es(o=[l[0]-e[0],l[1]-e[1]],t-this.getRotation()),bs(o,e)),o},i.prototype.calculateCenterZoom=function(t,e){var o,l=this.getCenterInternal(),f=this.getResolution();return l!==void 0&&f!==void 0&&(o=[e[0]-t*(e[0]-l[0])/f,e[1]-t*(e[1]-l[1])/f]),o},i.prototype.Ni=function(t){var e=this.yi;if(t){var o=e[0],l=e[1];return[Math.abs(o*Math.cos(t))+Math.abs(l*Math.sin(t)),Math.abs(o*Math.sin(t))+Math.abs(l*Math.cos(t))]}return e},i.prototype.setViewportSize=function(t){this.yi=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},i.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&Io(t,this.getProjection())},i.prototype.getCenterInternal=function(){return this.get(Ns.CENTER)},i.prototype.getConstraints=function(){return this.Ci},i.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},i.prototype.getHints=function(t){return t!==void 0?(t[0]=this.ci[0],t[1]=this.ci[1],t):this.ci.slice()},i.prototype.calculateExtent=function(t){return na(this.calculateExtentInternal(t),this.getProjection())},i.prototype.calculateExtentInternal=function(t){var e=t||this.zi(),o=this.getCenterInternal();Me(o,1);var l=this.getResolution();Me(l!==void 0,2);var f=this.getRotation();return Me(f!==void 0,3),Po(o,l,f,e)},i.prototype.getMaxResolution=function(){return this.Oi},i.prototype.getMinResolution=function(){return this.ji},i.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.ji)},i.prototype.setMaxZoom=function(t){this.Si(this.ki({maxZoom:t}))},i.prototype.getMinZoom=function(){return this.getZoomForResolution(this.Oi)},i.prototype.setMinZoom=function(t){this.Si(this.ki({minZoom:t}))},i.prototype.setConstrainResolution=function(t){this.Si(this.ki({constrainResolution:t}))},i.prototype.getProjection=function(){return this.di},i.prototype.getResolution=function(){return this.get(Ns.RESOLUTION)},i.prototype.getResolutions=function(){return this.Ti},i.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(Mo(t,this.getProjection()),e)},i.prototype.getResolutionForExtentInternal=function(t,e){var o=e||this.zi(),l=Gr(t)/o[0],f=Ki(t)/o[1];return Math.max(l,f)},i.prototype.getResolutionForValueFunction=function(t){var e=t||2,o=this.getConstrainedResolution(this.Oi),l=this.ji,f=Math.log(o/l)/Math.log(e);return function(y){return o/Math.pow(e,y*f)}},i.prototype.getRotation=function(){return this.get(Ns.ROTATION)},i.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),o=this.getConstrainedResolution(this.Oi),l=this.ji,f=Math.log(o/l)/e;return function(y){return Math.log(o/y)/e/f}},i.prototype.zi=function(t){var e=this.Ni(t),o=this.Ai;return o&&(e=[e[0]-o[1]-o[3],e[1]-o[0]-o[2]]),e},i.prototype.getState=function(){var t=this.getProjection(),e=this.getResolution(),o=this.getRotation(),l=this.getCenterInternal(),f=this.Ai;if(f){var y=this.zi();l=Vn(l,this.Ni(),[y[0]/2+f[3],y[1]/2+f[0]],e,o)}return{center:l.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.bi,nextResolution:this.xi,nextRotation:this.Mi,rotation:o,zoom:this.getZoom()}},i.prototype.getZoom=function(){var t,e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t},i.prototype.getZoomForResolution=function(t){var e,o,l=this.Pi||0;if(this.Ti){var f=T(this.Ti,t,1);l=f,e=this.Ti[f],o=f==this.Ti.length-1?2:e/this.Ti[f+1]}else e=this.Oi,o=this.Ei;return l+Math.log(e/t)/Math.log(o)},i.prototype.getResolutionForZoom=function(t){if(this.Ti){if(this.Ti.length<=1)return 0;var e=Y(Math.floor(t),0,this.Ti.length-2),o=this.Ti[e]/this.Ti[e+1];return this.Ti[e]/Math.pow(o,Y(t-e,0,1))}return this.Oi/Math.pow(this.Ei,t-this.Pi)},i.prototype.fit=function(t,e){var o;if(Me(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t))Me(!ws(t),25),o=Ao(l=Mo(t,this.getProjection()));else if(t.getType()==="Circle"){var l;(o=Ao(l=Mo(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),Gi(l))}else{var f=wo();o=f?t.clone().transform(f,this.getProjection()):t}this.fitInternal(o,e)},i.prototype.rotatedExtentForGeometry=function(t){for(var e=this.getRotation(),o=Math.cos(e),l=Math.sin(-e),f=t.getFlatCoordinates(),y=t.getStride(),w=1/0,b=1/0,I=-1/0,N=-1/0,D=0,j=f.length;D<j;D+=y){var H=f[D]*o-f[D+1]*l,Z=f[D]*l+f[D+1]*o;w=Math.min(w,H),b=Math.min(b,Z),I=Math.max(I,H),N=Math.max(N,Z)}return[w,b,I,N]},i.prototype.fitInternal=function(t,e){var o=e||{},l=o.size;l||(l=this.zi());var f,y=o.padding!==void 0?o.padding:[0,0,0,0],w=o.nearest!==void 0&&o.nearest;f=o.minResolution!==void 0?o.minResolution:o.maxZoom!==void 0?this.getResolutionForZoom(o.maxZoom):0;var b=this.rotatedExtentForGeometry(t),I=this.getResolutionForExtentInternal(b,[l[0]-y[1]-y[3],l[1]-y[0]-y[2]]);I=isNaN(I)?f:Math.max(I,f),I=this.getConstrainedResolution(I,w?0:1);var N=this.getRotation(),D=Math.sin(N),j=Math.cos(N),H=Gi(b);H[0]+=(y[1]-y[3])/2*I,H[1]+=(y[0]-y[2])/2*I;var Z=H[0]*j-H[1]*D,it=H[1]*j+H[0]*D,at=this.getConstrainedCenter([Z,it],I),wt=o.callback?o.callback:vt;o.duration!==void 0?this.animateInternal({resolution:I,center:at,duration:o.duration,easing:o.easing},wt):(this.wi=I,this.mi=at,this.Li(!1,!0),ce(wt,!0))},i.prototype.centerOn=function(t,e,o){this.centerOnInternal($i(t,this.getProjection()),e,o)},i.prototype.centerOnInternal=function(t,e,o){this.setCenterInternal(Vn(t,e,o,this.getResolution(),this.getRotation()))},i.prototype.calculateCenterShift=function(t,e,o,l){var f,y=this.Ai;if(y&&t){var w=this.zi(-o),b=Vn(t,l,[w[0]/2+y[3],w[1]/2+y[0]],e,o);f=[t[0]-b[0],t[1]-b[1]]}return f},i.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},i.prototype.adjustCenter=function(t){var e=Io(this.mi,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},i.prototype.adjustCenterInternal=function(t){var e=this.mi;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},i.prototype.adjustResolution=function(t,e){var o=e&&$i(e,this.getProjection());this.adjustResolutionInternal(t,o)},i.prototype.adjustResolutionInternal=function(t,e){var o=this.getAnimating()||this.getInteracting(),l=this.Ni(this.getRotation()),f=this.Ci.resolution(this.wi*t,0,l,o);e&&(this.mi=this.calculateCenterZoom(f,e)),this.wi*=t,this.Li()},i.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.Ei,-t),e)},i.prototype.adjustRotation=function(t,e){e&&(e=$i(e,this.getProjection())),this.adjustRotationInternal(t,e)},i.prototype.adjustRotationInternal=function(t,e){var o=this.getAnimating()||this.getInteracting(),l=this.Ci.rotation(this.gi+t,o);e&&(this.mi=this.calculateCenterRotate(l,e)),this.gi+=t,this.Li()},i.prototype.setCenter=function(t){this.setCenterInternal(t&&$i(t,this.getProjection()))},i.prototype.setCenterInternal=function(t){this.mi=t,this.Li()},i.prototype.setHint=function(t,e){return this.ci[t]+=e,this.changed(),this.ci[t]},i.prototype.setResolution=function(t){this.wi=t,this.Li()},i.prototype.setRotation=function(t){this.gi=t,this.Li()},i.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},i.prototype.Li=function(t,e){var o=this.getAnimating()||this.getInteracting()||e,l=this.Ci.rotation(this.gi,o),f=this.Ni(l),y=this.Ci.resolution(this.wi,0,f,o),w=this.Ci.center(this.mi,y,f,o,this.calculateCenterShift(this.mi,y,l,f));this.get(Ns.ROTATION)!==l&&this.set(Ns.ROTATION,l),this.get(Ns.RESOLUTION)!==y&&(this.set(Ns.RESOLUTION,y),this.set("zoom",this.getZoom(),!0)),w&&this.get(Ns.CENTER)&&mn(this.get(Ns.CENTER),w)||this.set(Ns.CENTER,w),this.getAnimating()&&!t&&this.cancelAnimations(),this._i=void 0},i.prototype.resolveConstraints=function(t,e,o){var l=t!==void 0?t:200,f=e||0,y=this.Ci.rotation(this.gi),w=this.Ni(y),b=this.Ci.resolution(this.wi,f,w),I=this.Ci.center(this.mi,b,w,!1,this.calculateCenterShift(this.mi,b,y,w));if(l===0&&!this._i)return this.wi=b,this.gi=y,this.mi=I,void this.Li();var N=o||(l===0?this._i:void 0);this._i=void 0,this.getResolution()===b&&this.getRotation()===y&&this.getCenterInternal()&&mn(this.getCenterInternal(),I)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:y,center:I,resolution:b,duration:l,easing:zt,anchor:N}))},i.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Os,1)},i.prototype.endInteraction=function(t,e,o){var l=o&&$i(o,this.getProjection());this.endInteractionInternal(t,e,l)},i.prototype.endInteractionInternal=function(t,e,o){this.setHint(Os,-1),this.resolveConstraints(t,e,o)},i.prototype.getConstrainedCenter=function(t,e){var o=this.Ni(this.getRotation());return this.Ci.center(t,e||this.getResolution(),o)},i.prototype.getConstrainedZoom=function(t,e){var o=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(o,e))},i.prototype.getConstrainedResolution=function(t,e){var o=e||0,l=this.Ni(this.getRotation());return this.Ci.resolution(t,o,l)},i}(cn);function ma(s,i,t){return t===void 0&&(t=[0,0]),t[0]=s[0]+2*i,t[1]=s[1]+2*i,t}function fp(s){return s[0]>0&&s[1]>0}function gh(s,i,t){return t===void 0&&(t=[0,0]),t[0]=s[0]*i+.5|0,t[1]=s[1]*i+.5|0,t}function Pn(s,i){return Array.isArray(s)?s:(i===void 0?i=[s,s]:(i[0]=s,i[1]=s),i)}var Hd=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function If(s){s instanceof pa?s.setMapInternal(null):s instanceof Gl&&s.getLayers().forEach(If)}function Mf(s,i){if(s instanceof pa)s.setMapInternal(i);else if(s instanceof Gl)for(var t=s.getLayers().getArray(),e=0,o=t.length;e<o;++e)Mf(t[e],i)}var dp=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un;var o=function(f){var y=null;f.keyboardEventTarget!==void 0&&(y=typeof f.keyboardEventTarget=="string"?document.getElementById(f.keyboardEventTarget):f.keyboardEventTarget);var w,b,I,N={},D=f.layers&&typeof f.layers.getLayers=="function"?f.layers:new Gl({layers:f.layers});return N[pp]=D,N[dl]=f.target,N[zl]=f.view instanceof no?f.view:new no,f.controls!==void 0&&(Array.isArray(f.controls)?w=new Be(f.controls.slice()):(Me(typeof f.controls.getArray=="function",47),w=f.controls)),f.interactions!==void 0&&(Array.isArray(f.interactions)?b=new Be(f.interactions.slice()):(Me(typeof f.interactions.getArray=="function",48),b=f.interactions)),f.overlays!==void 0?Array.isArray(f.overlays)?I=new Be(f.overlays.slice()):(Me(typeof f.overlays.getArray=="function",49),I=f.overlays):I=new Be,{controls:w,interactions:b,keyboardEventTarget:y,overlays:I,values:N}}(t);e.Ri,e.Fi=!0,e.Gi=e.handleBrowserEvent.bind(e),e.Di=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,e.kt=t.pixelRatio!==void 0?t.pixelRatio:tn,e.qi,e.Ui,e.Bi=function(){this.Ui=void 0,this.Xi(Date.now())}.bind(e),e.Vi=[1,0,0,1,0,0],e.Wi=[1,0,0,1,0,0],e.Yi=0,e.Zi=null,e.$i=null,e.Ki=null,e.Hi=null,e.Ji=null,e.Qi=document.createElement("div"),e.Qi.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),e.Qi.style.position="relative",e.Qi.style.overflow="hidden",e.Qi.style.width="100%",e.Qi.style.height="100%",e.tr=document.createElement("div"),e.tr.style.position="absolute",e.tr.style.zIndex="1",e.tr.style.width="100%",e.tr.style.height="100%",e.tr.style.pointerEvents="none",e.tr.className="ol-overlaycontainer",e.Qi.appendChild(e.tr),e.nr=document.createElement("div"),e.nr.style.position="absolute",e.nr.style.zIndex="1",e.nr.style.width="100%",e.nr.style.height="100%",e.nr.style.pointerEvents="none",e.nr.className="ol-overlaycontainer-stopevent",e.Qi.appendChild(e.nr),e.ir=null,e.In=t.moveTolerance,e.rr=o.keyboardEventTarget,e.er=null,e.controls=o.controls||new Be,e.interactions=o.interactions||new Be,e.sr=o.overlays,e.ur={},e.hn=null,e.ar=[],e.hr=new Tf(e.getTilePriority.bind(e),e.cr.bind(e)),e.addChangeListener(pp,e.lr),e.addChangeListener(zl,e.vr),e.addChangeListener(fh,e.dr),e.addChangeListener(dl,e.pr),e.setProperties(o.values);var l=e;return!t.view||t.view instanceof no||t.view.then(function(f){l.setView(new no(f))}),e.controls.addEventListener(Ft,function(f){f.element.setMap(this)}.bind(e)),e.controls.addEventListener(Ot,function(f){f.element.setMap(null)}.bind(e)),e.interactions.addEventListener(Ft,function(f){f.element.setMap(this)}.bind(e)),e.interactions.addEventListener(Ot,function(f){f.element.setMap(null)}.bind(e)),e.sr.addEventListener(Ft,function(f){this.yr(f.element)}.bind(e)),e.sr.addEventListener(Ot,function(f){var y=f.element.getId();y!==void 0&&delete this.ur[y.toString()],f.element.setMap(null)}.bind(e)),e.controls.forEach(function(f){f.setMap(this)}.bind(e)),e.interactions.forEach(function(f){f.setMap(this)}.bind(e)),e.sr.forEach(e.yr.bind(e)),e}return Hd(i,s),i.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},i.prototype.addControl=function(t){this.getControls().push(t)},i.prototype.addInteraction=function(t){this.getInteractions().push(t)},i.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},i.prototype.mr=function(t){Mf(t.layer,this)},i.prototype.addOverlay=function(t){this.getOverlays().push(t)},i.prototype.yr=function(t){var e=t.getId();e!==void 0&&(this.ur[e.toString()]=t),t.setMap(this)},i.prototype.disposeInternal=function(){this.controls.clear(),this.interactions.clear(),this.sr.clear(),this.setTarget(null),s.prototype.disposeInternal.call(this)},i.prototype.forEachFeatureAtPixel=function(t,e,o){if(this.Zi&&this.hn){var l=this.getCoordinateFromPixelInternal(t),f=(o=o!==void 0?o:{}).hitTolerance!==void 0?o.hitTolerance:0,y=o.layerFilter!==void 0?o.layerFilter:rt,w=o.checkWrapped!==!1;return this.hn.forEachFeatureAtCoordinate(l,this.Zi,f,w,e,null,y,null)}},i.prototype.getFeaturesAtPixel=function(t,e){var o=[];return this.forEachFeatureAtPixel(t,function(l){o.push(l)},e),o},i.prototype.getAllLayers=function(){var t=[];return function e(o){o.forEach(function(l){l instanceof Gl?e(l.getLayers()):t.push(l)})}(this.getLayers()),t},i.prototype.forEachLayerAtPixel=function(t,e,o){if(this.Zi&&this.hn){var l=o||{},f=l.hitTolerance!==void 0?l.hitTolerance:0,y=l.layerFilter||rt;return this.hn.forEachLayerAtPixel(t,this.Zi,f,e,y)}},i.prototype.hasFeatureAtPixel=function(t,e){if(!this.Zi||!this.hn)return!1;var o=this.getCoordinateFromPixelInternal(t),l=(e=e!==void 0?e:{}).layerFilter!==void 0?e.layerFilter:rt,f=e.hitTolerance!==void 0?e.hitTolerance:0,y=e.checkWrapped!==!1;return this.hn.hasFeatureAtCoordinate(o,this.Zi,f,y,l,null)},i.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},i.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},i.prototype.getEventPixel=function(t){var e=this.Qi.getBoundingClientRect(),o="changedTouches"in t?t.changedTouches[0]:t;return[o.clientX-e.left,o.clientY-e.top]},i.prototype.getTarget=function(){return this.get(dl)},i.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},i.prototype.getCoordinateFromPixel=function(t){return Io(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},i.prototype.getCoordinateFromPixelInternal=function(t){var e=this.Zi;return e?Ei(e.pixelToCoordinateTransform,t.slice()):null},i.prototype.getControls=function(){return this.controls},i.prototype.getOverlays=function(){return this.sr},i.prototype.getOverlayById=function(t){var e=this.ur[t.toString()];return e!==void 0?e:null},i.prototype.getInteractions=function(){return this.interactions},i.prototype.getLayerGroup=function(){return this.get(pp)},i.prototype.setLayers=function(t){var e=this.getLayerGroup();if(t instanceof Be)e.setLayers(t);else{var o=e.getLayers();o.clear(),o.extend(t)}},i.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},i.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,o=t.length;e<o;++e){var l=t[e];if(l.visible){var f=l.layer.getRenderer();if(f&&!f.ready)return!0;var y=l.layer.getSource();if(y&&y.loading)return!0}}return!1},i.prototype.getPixelFromCoordinate=function(t){var e=$i(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},i.prototype.getPixelFromCoordinateInternal=function(t){var e=this.Zi;return e?Ei(e.coordinateToPixelTransform,t.slice(0,2)):null},i.prototype.getRenderer=function(){return this.hn},i.prototype.getSize=function(){return this.get(fh)},i.prototype.getView=function(){return this.get(zl)},i.prototype.getViewport=function(){return this.Qi},i.prototype.getOverlayContainer=function(){return this.tr},i.prototype.getOverlayContainerStopEvent=function(){return this.nr},i.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},i.prototype.getTilePriority=function(t,e,o,l){return qd(this.Zi,t,e,o,l)},i.prototype.handleBrowserEvent=function(t,e){var o=e||t.type,l=new Ms(o,this,t);this.handleMapBrowserEvent(l)},i.prototype.handleMapBrowserEvent=function(t){if(this.Zi){var e=t.originalEvent,o=e.type;if(o===Ls||o===wi||o===se){var l=this.getOwnerDocument(),f=this.Qi.getRootNode?this.Qi.getRootNode():l,y=e.target;if(this.nr.contains(y)||!(f===l?l.documentElement:f).contains(y))return}if(t.frameState=this.Zi,this.dispatchEvent(t)!==!1)for(var w=this.getInteractions().getArray().slice(),b=w.length-1;b>=0;b--){var I=w[b];if(I.getMap()===this&&I.getActive()&&this.getTargetElement()&&(!I.handleEvent(t)||t.propagationStopped))break}}},i.prototype.handlePostRender=function(){var t=this.Zi,e=this.hr;if(!e.isEmpty()){var o=this.Di,l=o;if(t){var f=t.viewHints;if(f[is]||f[Os]){var y=Date.now()-t.time>8;o=y?0:8,l=y?0:2}}e.getTilesLoading()<o&&(e.reprioritize(),e.loadMoreTiles(o,l))}t&&this.hn&&!t.animate&&(this.Ri===!0?(this.hasListener(ha)&&this.hn.dispatchRenderEvent(ha,t),this.Fi===!1&&(this.Fi=!0,this.dispatchEvent(new go(hp,this,t)))):this.Fi===!0&&(this.Fi=!1,this.dispatchEvent(new go(up,this,t))));for(var w=this.ar,b=0,I=w.length;b<I;++b)w[b](this,t);w.length=0},i.prototype.dr=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},i.prototype.pr=function(){if(this.ir){for(var t=0,e=this.er.length;t<e;++t)Or(this.er[t]);this.er=null,this.Qi.removeEventListener(je,this.Gi),this.Qi.removeEventListener(wi,this.Gi),this.ir.dispose(),this.ir=null,Kc(this.Qi)}var o=this.getTargetElement();if(o){for(var l in o.appendChild(this.Qi),this.hn||(this.hn=this.createRenderer()),this.ir=new jn(this,this.In),zi)this.ir.addEventListener(zi[l],this.handleMapBrowserEvent.bind(this));this.Qi.addEventListener(je,this.Gi,!1),this.Qi.addEventListener(wi,this.Gi,!!_i&&{passive:!1});var f=this.getOwnerDocument().defaultView,y=this.rr?this.rr:o;this.er=[Ee(y,se,this.handleBrowserEvent,this),Ee(y,oe,this.handleBrowserEvent,this),Ee(f,vr,this.updateSize,this)]}else this.hn&&(clearTimeout(this.qi),this.qi=void 0,this.ar.length=0,this.hn.dispose(),this.hn=null),this.Ui&&(cancelAnimationFrame(this.Ui),this.Ui=void 0);this.updateSize()},i.prototype.cr=function(){this.render()},i.prototype.wr=function(){this.render()},i.prototype.vr=function(){this.Ki&&(Or(this.Ki),this.Ki=null),this.Hi&&(Or(this.Hi),this.Hi=null);var t=this.getView();t&&(this.gr(),this.Ki=Ee(t,K,this.wr,this),this.Hi=Ee(t,ne,this.wr,this),t.resolveConstraints(0)),this.render()},i.prototype.lr=function(){this.Ji&&(this.Ji.forEach(Or),this.Ji=null);var t=this.getLayerGroup();t&&(this.mr(new Ws("addlayer",t)),this.Ji=[Ee(t,K,this.render,this),Ee(t,ne,this.render,this),Ee(t,"addlayer",this.mr,this),Ee(t,"removelayer",this.br,this)]),this.render()},i.prototype.isRendered=function(){return!!this.Zi},i.prototype.renderSync=function(){this.Ui&&cancelAnimationFrame(this.Ui),this.Bi()},i.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,o=t.length;e<o;++e){var l=t[e].layer;l.hasRenderer()&&l.getRenderer().handleFontsChanged()}},i.prototype.render=function(){this.hn&&this.Ui===void 0&&(this.Ui=requestAnimationFrame(this.Bi))},i.prototype.removeControl=function(t){return this.getControls().remove(t)},i.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},i.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},i.prototype.br=function(t){If(t.layer)},i.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},i.prototype.Xi=function(t){var e=this,o=this.getSize(),l=this.getView(),f=this.Zi,y=null;if(o!==void 0&&fp(o)&&l&&l.isDef()){var w=l.getHints(this.Zi?this.Zi.viewHints:void 0),b=l.getState();if(y={animate:!1,coordinateToPixelTransform:this.Vi,declutterTree:null,extent:Po(b.center,b.resolution,b.rotation,o),index:this.Yi++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.kt,pixelToCoordinateTransform:this.Wi,postRenderFunctions:[],size:o,tileQueue:this.hr,time:t,usedTiles:{},viewState:b,viewHints:w,wantedTiles:{},mapId:L(this),renderTargets:{}},b.nextCenter&&b.nextResolution){var I=isNaN(b.nextRotation)?b.rotation:b.nextRotation;y.nextExtent=Po(b.nextCenter,b.nextResolution,I,o)}}this.Zi=y,this.hn.renderFrame(y),y&&(y.animate&&this.render(),Array.prototype.push.apply(this.ar,y.postRenderFunctions),f&&(!this.$i||!ws(this.$i)&&!ko(y.extent,this.$i))&&(this.dispatchEvent(new go(ph,this,f)),this.$i=ao(this.$i)),this.$i&&!y.viewHints[is]&&!y.viewHints[Os]&&!ko(y.extent,this.$i)&&(this.dispatchEvent(new go(As,this,y)),Ur(y.extent,this.$i))),this.dispatchEvent(new go(ga,this,y)),this.Ri=this.hasListener(up)||this.hasListener(hp)||this.hasListener(ha)?!this.hr.getTilesLoading()&&!this.hr.getCount()&&!this.getLoadingOrNotReady():void 0,this.qi||(this.qi=setTimeout(function(){e.qi=void 0,e.handlePostRender()},0))},i.prototype.setLayerGroup=function(t){var e=this.getLayerGroup();e&&this.br(new Ws("removelayer",e)),this.set(pp,t)},i.prototype.setSize=function(t){this.set(fh,t)},i.prototype.setTarget=function(t){this.set(dl,t)},i.prototype.setView=function(t){if(!t||t instanceof no)this.set(zl,t);else{this.set(zl,new no);var e=this;t.then(function(o){e.setView(new no(o))})}},i.prototype.updateSize=function(){var t=this.getTargetElement(),e=void 0;if(t){var o=getComputedStyle(t),l=t.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),f=t.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth);isNaN(l)||isNaN(f)||!fp(e=[l,f])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")}this.setSize(e),this.gr()},i.prototype.gr=function(){var t=this.getView();if(t){var e=void 0,o=getComputedStyle(this.Qi);o.width&&o.height&&(e=[parseInt(o.width,10),parseInt(o.height,10)]),t.setViewportSize(e)}},i}(cn),Xd=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ya=function(s){function i(t){var e=s.call(this)||this,o=t.element;return!o||t.target||o.style.pointerEvents||(o.style.pointerEvents="auto"),e.element=o||null,e.Mr=null,e.vn=null,e.listenerKeys=[],t.render&&(e.render=t.render),t.target&&e.setTarget(t.target),e}return Xd(i,s),i.prototype.disposeInternal=function(){Kc(this.element),s.prototype.disposeInternal.call(this)},i.prototype.getMap=function(){return this.vn},i.prototype.setMap=function(t){this.vn&&Kc(this.element);for(var e=0,o=this.listenerKeys.length;e<o;++e)Or(this.listenerKeys[e]);this.listenerKeys.length=0,this.vn=t,t&&((this.Mr?this.Mr:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==vt&&this.listenerKeys.push(Ee(t,ga,this.render,this)),t.render())},i.prototype.render=function(t){},i.prototype.setTarget=function(t){this.Mr=typeof t=="string"?document.getElementById(t):t},i}(cn),Wd=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Lf=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{element:document.createElement("div"),render:o.render,target:o.target})||this)._r=document.createElement("ul"),e.Sr=o.collapsed===void 0||o.collapsed,e.jr=e.Sr,e.Er=o.collapsible!==void 0,e.Tr=o.collapsible===void 0||o.collapsible,e.Tr||(e.Sr=!1);var l=o.className!==void 0?o.className:"ol-attribution",f=o.tipLabel!==void 0?o.tipLabel:"Attributions",y=o.expandClassName!==void 0?o.expandClassName:l+"-expand",w=o.collapseLabel!==void 0?o.collapseLabel:"\u203A",b=o.collapseClassName!==void 0?o.collapseClassName:l+"-collapse";typeof w=="string"?(e.Ar=document.createElement("span"),e.Ar.textContent=w,e.Ar.className=b):e.Ar=w;var I=o.label!==void 0?o.label:"i";typeof I=="string"?(e.Pr=document.createElement("span"),e.Pr.textContent=I,e.Pr.className=y):e.Pr=I;var N=e.Tr&&!e.Sr?e.Ar:e.Pr;e.Cr=document.createElement("button"),e.Cr.setAttribute("type","button"),e.Cr.setAttribute("aria-expanded",String(!e.Sr)),e.Cr.title=f,e.Cr.appendChild(N),e.Cr.addEventListener(Br,e.kr.bind(e),!1);var D=l+" ol-unselectable "+fa+(e.Sr&&e.Tr?" ol-collapsed":"")+(e.Tr?"":" ol-uncollapsible"),j=e.element;return j.className=D,j.appendChild(e.Cr),j.appendChild(e._r),e.Ir=[],e.mn=!0,e}return Wd(i,s),i.prototype.Nr=function(t){for(var e={},o=[],l=!0,f=t.layerStatesArray,y=0,w=f.length;y<w;++y){var b=f[y];if(cl(b,t.viewState)){var I=b.layer.getSource();if(I){var N=I.getAttributions();if(N){var D=N(t);if(D)if(l=l&&I.getAttributionsCollapsible()!==!1,Array.isArray(D))for(var j=0,H=D.length;j<H;++j)D[j]in e||(o.push(D[j]),e[D[j]]=!0);else D in e||(o.push(D),e[D]=!0)}}}}return this.Er||this.setCollapsible(l),o},i.prototype.Lr=function(t){if(t){var e=this.Nr(t),o=e.length>0;if(this.mn!=o&&(this.element.style.display=o?"":"none",this.mn=o),!$(e,this.Ir)){Jc(this._r);for(var l=0,f=e.length;l<f;++l){var y=document.createElement("li");y.innerHTML=e[l],this._r.appendChild(y)}this.Ir=e}}else this.mn&&(this.element.style.display="none",this.mn=!1)},i.prototype.kr=function(t){t.preventDefault(),this.zr(),this.jr=this.Sr},i.prototype.zr=function(){this.element.classList.toggle(nu),this.Sr?Na(this.Ar,this.Pr):Na(this.Pr,this.Ar),this.Sr=!this.Sr,this.Cr.setAttribute("aria-expanded",String(!this.Sr))},i.prototype.getCollapsible=function(){return this.Tr},i.prototype.setCollapsible=function(t){this.Tr!==t&&(this.Tr=t,this.element.classList.toggle("ol-uncollapsible"),this.jr&&this.zr())},i.prototype.setCollapsed=function(t){this.jr=t,this.Tr&&this.Sr!==t&&this.zr()},i.prototype.getCollapsed=function(){return this.Sr},i.prototype.render=function(t){this.Lr(t.frameState)},i}(ya),Af=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),gp=function(s){function i(t){var e=this,o=t||{};e=s.call(this,{element:document.createElement("div"),render:o.render,target:o.target})||this;var l=o.className!==void 0?o.className:"ol-rotate",f=o.label!==void 0?o.label:"\u21E7",y=o.compassClassName!==void 0?o.compassClassName:"ol-compass";e.Pr=null,typeof f=="string"?(e.Pr=document.createElement("span"),e.Pr.className=y,e.Pr.textContent=f):(e.Pr=f,e.Pr.classList.add(y));var w=o.tipLabel?o.tipLabel:"Reset rotation",b=document.createElement("button");b.className=l+"-reset",b.setAttribute("type","button"),b.title=w,b.appendChild(e.Pr),b.addEventListener(Br,e.kr.bind(e),!1);var I=l+" ol-unselectable "+fa,N=e.element;return N.className=I,N.appendChild(b),e.Rr=o.resetNorth?o.resetNorth:void 0,e.Fr=o.duration!==void 0?o.duration:250,e.Gr=o.autoHide===void 0||o.autoHide,e.Dr=void 0,e.Gr&&e.element.classList.add(Nl),e}return Af(i,s),i.prototype.kr=function(t){t.preventDefault(),this.Rr!==void 0?this.Rr():this.qr()},i.prototype.qr=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();e!==void 0&&(this.Fr>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.Fr,easing:zt}):t.setRotation(0))}},i.prototype.render=function(t){var e=t.frameState;if(e){var o=e.viewState.rotation;if(o!=this.Dr){var l="rotate("+o+"rad)";if(this.Gr){var f=this.element.classList.contains(Nl);f||o!==0?f&&o!==0&&this.element.classList.remove(Nl):this.element.classList.add(Nl)}this.Pr.style.transform=l}this.Dr=o}},i}(ya),dE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Y0=function(s){function i(t){var e=this,o=t||{};e=s.call(this,{element:document.createElement("div"),target:o.target})||this;var l=o.className!==void 0?o.className:"ol-zoom",f=o.delta!==void 0?o.delta:1,y=o.zoomInClassName!==void 0?o.zoomInClassName:l+"-in",w=o.zoomOutClassName!==void 0?o.zoomOutClassName:l+"-out",b=o.zoomInLabel!==void 0?o.zoomInLabel:"+",I=o.zoomOutLabel!==void 0?o.zoomOutLabel:"\u2013",N=o.zoomInTipLabel!==void 0?o.zoomInTipLabel:"Zoom in",D=o.zoomOutTipLabel!==void 0?o.zoomOutTipLabel:"Zoom out",j=document.createElement("button");j.className=y,j.setAttribute("type","button"),j.title=N,j.appendChild(typeof b=="string"?document.createTextNode(b):b),j.addEventListener(Br,e.kr.bind(e,f),!1);var H=document.createElement("button");H.className=w,H.setAttribute("type","button"),H.title=D,H.appendChild(typeof I=="string"?document.createTextNode(I):I),H.addEventListener(Br,e.kr.bind(e,-f),!1);var Z=l+" ol-unselectable "+fa,it=e.element;return it.className=Z,it.appendChild(j),it.appendChild(H),e.Fr=o.duration!==void 0?o.duration:250,e}return dE(i,s),i.prototype.kr=function(t,e){e.preventDefault(),this.Ur(t)},i.prototype.Ur=function(t){var e=this.getMap().getView();if(e){var o=e.getZoom();if(o!==void 0){var l=e.getConstrainedZoom(o+t);this.Fr>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:l,duration:this.Fr,easing:zt})):e.setZoom(l)}}},i}(ya);function Z0(s){var i=s||{},t=new Be;return(i.zoom===void 0||i.zoom)&&t.push(new Y0(i.zoomOptions)),(i.rotate===void 0||i.rotate)&&t.push(new gp(i.rotateOptions)),(i.attribution===void 0||i.attribution)&&t.push(new Lf(i.attributionOptions)),t}var Yd="active",gE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function $0(s,i,t){var e=s.getCenterInternal();if(e){var o=[e[0]+i[0],e[1]+i[1]];s.animateInternal({duration:t!==void 0?t:250,easing:Ut,center:s.getConstrainedCenter(o)})}}function Zd(s,i,t,e){var o=s.getZoom();if(o!==void 0){var l=s.getConstrainedZoom(o+i),f=s.getResolutionForZoom(l);s.getAnimating()&&s.cancelAnimations(),s.animate({resolution:f,anchor:t,duration:e!==void 0?e:250,easing:zt})}}var xc=function(s){function i(t){var e=s.call(this)||this;return e.on,e.once,e.un,t&&t.handleEvent&&(e.handleEvent=t.handleEvent),e.vn=null,e.setActive(!0),e}return gE(i,s),i.prototype.getActive=function(){return this.get(Yd)},i.prototype.getMap=function(){return this.vn},i.prototype.handleEvent=function(t){return!0},i.prototype.setActive=function(t){this.set(Yd,t)},i.prototype.setMap=function(t){this.vn=t},i}(cn),mE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),K0=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.Br=o.delta?o.delta:1,e.Fr=o.duration!==void 0?o.duration:250,e}return mE(i,s),i.prototype.handleEvent=function(t){var e=!1;if(t.type==zi.DBLCLICK){var o=t.originalEvent,l=t.map,f=t.coordinate,y=o.shiftKey?-this.Br:this.Br;Zd(l.getView(),y,f,this.Fr),o.preventDefault(),e=!0}return!e},i}(xc),yE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function $d(s){for(var i=s.length,t=0,e=0,o=0;o<i;o++)t+=s[o].clientX,e+=s[o].clientY;return[t/i,e/i]}var ja=function(s){function i(t){var e=this,o=t||{};return e=s.call(this,o)||this,o.handleDownEvent&&(e.handleDownEvent=o.handleDownEvent),o.handleDragEvent&&(e.handleDragEvent=o.handleDragEvent),o.handleMoveEvent&&(e.handleMoveEvent=o.handleMoveEvent),o.handleUpEvent&&(e.handleUpEvent=o.handleUpEvent),o.stopDown&&(e.stopDown=o.stopDown),e.handlingDownUpSequence=!1,e.targetPointers=[],e}return yE(i,s),i.prototype.getPointerCount=function(){return this.targetPointers.length},i.prototype.handleDownEvent=function(t){return!1},i.prototype.handleDragEvent=function(t){},i.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var e=!1;if(this.Xr(t),this.handlingDownUpSequence){if(t.type==zi.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==zi.POINTERUP){var o=this.handleUpEvent(t);this.handlingDownUpSequence=o&&this.targetPointers.length>0}}else if(t.type==zi.POINTERDOWN){var l=this.handleDownEvent(t);this.handlingDownUpSequence=l,e=this.stopDown(l)}else t.type==zi.POINTERMOVE&&this.handleMoveEvent(t);return!e},i.prototype.handleMoveEvent=function(t){},i.prototype.handleUpEvent=function(t){return!1},i.prototype.stopDown=function(t){return t},i.prototype.Xr=function(t){t.activePointers&&(this.targetPointers=t.activePointers)},i}(xc);function Kd(s){var i=arguments;return function(t){for(var e=!0,o=0,l=i.length;o<l&&(e=e&&i[o](t));++o);return e}}var J0=function(s){var i=s.originalEvent;return i.altKey&&!(i.metaKey||i.ctrlKey)&&!i.shiftKey},Q0=function(s){var i=s.originalEvent;return i.altKey&&!(i.metaKey||i.ctrlKey)&&i.shiftKey},t1=function(s){var i=s.map.getTargetElement(),t=s.map.getOwnerDocument().activeElement;return i.contains(t)},Bm=function(s){return!s.map.getTargetElement().hasAttribute("tabindex")||t1(s)},mp=rt,zm=function(s){var i=s.originalEvent;return i.button==0&&!(vi&&Jr&&i.ctrlKey)},Vm=nt,Um=function(s){return s.type==zi.SINGLECLICK},Jd=function(s){var i=s.originalEvent;return!i.altKey&&!(i.metaKey||i.ctrlKey)&&!i.shiftKey},Of=function(s){var i=s.originalEvent;return!i.altKey&&!(i.metaKey||i.ctrlKey)&&i.shiftKey},qm=function(s){var i=s.originalEvent,t=i.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!i.target.isContentEditable},mh=function(s){var i=s.originalEvent;return Me(i!==void 0,56),i.pointerType=="mouse"},Hm=function(s){var i=s.originalEvent;return Me(i!==void 0,56),i.isPrimary&&i.button===0},vE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),e1=function(s){function i(t){var e=s.call(this,{stopDown:nt})||this,o=t||{};e.Vr=o.kinetic,e.lastCentroid=null,e.Wr,e.Yr=!1;var l=o.condition?o.condition:Kd(Jd,Hm);return e.Zr=o.onFocusOnly?Kd(Bm,l):l,e.$r=!1,e}return vE(i,s),i.prototype.handleDragEvent=function(t){this.Yr||(this.Yr=!0,this.getMap().getView().beginInteraction());var e=this.targetPointers,o=$d(e);if(e.length==this.Wr){if(this.Vr&&this.Vr.update(o[0],o[1]),this.lastCentroid){var l=[this.lastCentroid[0]-o[0],o[1]-this.lastCentroid[1]],f=t.map.getView();On(l,f.getResolution()),es(l,f.getRotation()),f.adjustCenterInternal(l)}}else this.Vr&&this.Vr.begin();this.lastCentroid=o,this.Wr=e.length,t.originalEvent.preventDefault()},i.prototype.handleUpEvent=function(t){var e=t.map,o=e.getView();if(this.targetPointers.length===0){if(!this.$r&&this.Vr&&this.Vr.end()){var l=this.Vr.getDistance(),f=this.Vr.getAngle(),y=o.getCenterInternal(),w=e.getPixelFromCoordinateInternal(y),b=e.getCoordinateFromPixelInternal([w[0]-l*Math.cos(f),w[1]-l*Math.sin(f)]);o.animateInternal({center:o.getConstrainedCenter(b),duration:500,easing:zt})}return this.Yr&&(this.Yr=!1,o.endInteraction()),!1}return this.Vr&&this.Vr.begin(),this.lastCentroid=null,!0},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.Zr(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.Vr&&this.Vr.begin(),this.$r=this.targetPointers.length>1,!0}return!1},i}(ja),_E=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),r1=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this,{stopDown:nt})||this).Zr=o.condition?o.condition:Q0,e.Kr=void 0,e.Fr=o.duration!==void 0?o.duration:250,e}return _E(i,s),i.prototype.handleDragEvent=function(t){if(mh(t)){var e=t.map,o=e.getView();if(o.getConstraints().rotation!==k){var l=e.getSize(),f=t.pixel,y=Math.atan2(l[1]/2-f[1],f[0]-l[0]/2);if(this.Kr!==void 0){var w=y-this.Kr;o.adjustRotationInternal(-w)}this.Kr=y}}},i.prototype.handleUpEvent=function(t){return!mh(t)||(t.map.getView().endInteraction(this.Fr),!1)},i.prototype.handleDownEvent=function(t){return!!mh(t)&&!(!zm(t)||!this.Zr(t))&&(t.map.getView().beginInteraction(),this.Kr=void 0,!0)},i}(ja),xE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),i1=function(s){function i(t){var e=s.call(this)||this;return e.Hr=null,e.pn=document.createElement("div"),e.pn.style.position="absolute",e.pn.style.pointerEvents="auto",e.pn.className="ol-box "+t,e.vn=null,e.Jr=null,e.Qr=null,e}return xE(i,s),i.prototype.disposeInternal=function(){this.setMap(null)},i.prototype.te=function(){var t=this.Jr,e=this.Qr,o="px",l=this.pn.style;l.left=Math.min(t[0],e[0])+o,l.top=Math.min(t[1],e[1])+o,l.width=Math.abs(e[0]-t[0])+o,l.height=Math.abs(e[1]-t[1])+o},i.prototype.setMap=function(t){if(this.vn){this.vn.getOverlayContainer().removeChild(this.pn);var e=this.pn.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.vn=t,this.vn&&this.vn.getOverlayContainer().appendChild(this.pn)},i.prototype.setPixels=function(t,e){this.Jr=t,this.Qr=e,this.createOrUpdateGeometry(),this.te()},i.prototype.createOrUpdateGeometry=function(){var t=this.Jr,e=this.Qr,o=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.vn.getCoordinateFromPixelInternal,this.vn);o[4]=o[0].slice(),this.Hr?this.Hr.setCoordinates([o]):this.Hr=new Lo([o])},i.prototype.getGeometry=function(){return this.Hr},i}(Q),n1=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),wE="boxstart",bE="boxdrag",SE="boxend",EE="boxcancel",Qd=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.coordinate=e,l.mapBrowserEvent=o,l}return n1(i,s),i}(O),o1=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un;var o=t||{};return e.ne=new i1(o.className||"ol-dragbox"),e.ie=o.minArea!==void 0?o.minArea:64,o.onBoxEnd&&(e.onBoxEnd=o.onBoxEnd),e.Jr=null,e.Zr=o.condition?o.condition:zm,e.re=o.boxEndCondition?o.boxEndCondition:e.defaultBoxEndCondition,e}return n1(i,s),i.prototype.defaultBoxEndCondition=function(t,e,o){var l=o[0]-e[0],f=o[1]-e[1];return l*l+f*f>=this.ie},i.prototype.getGeometry=function(){return this.ne.getGeometry()},i.prototype.handleDragEvent=function(t){this.ne.setPixels(this.Jr,t.pixel),this.dispatchEvent(new Qd(bE,t.coordinate,t))},i.prototype.handleUpEvent=function(t){this.ne.setMap(null);var e=this.re(t,this.Jr,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Qd(e?SE:EE,t.coordinate,t)),!1},i.prototype.handleDownEvent=function(t){return!!this.Zr(t)&&(this.Jr=t.pixel,this.ne.setMap(t.map),this.ne.setPixels(this.Jr,this.Jr),this.dispatchEvent(new Qd(wE,t.coordinate,t)),!0)},i.prototype.onBoxEnd=function(t){},i}(ja),CE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),s1=function(s){function i(t){var e=this,o=t||{},l=o.condition?o.condition:Of;return(e=s.call(this,{condition:l,className:o.className||"ol-dragzoom",minArea:o.minArea})||this).Fr=o.duration!==void 0?o.duration:200,e.ee=o.out!==void 0&&o.out,e}return CE(i,s),i.prototype.onBoxEnd=function(t){var e=this.getMap().getView(),o=this.getGeometry();if(this.ee){var l=e.rotatedExtentForGeometry(o),f=e.getResolutionForExtentInternal(l),y=e.getResolution()/f;(o=o.clone()).scale(y*y)}e.fitInternal(o,{duration:this.Fr,easing:zt})},i}(o1),a1=37,TE=38,l1=39,c1=40,PE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),u1=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.oe=function(l){return Jd(l)&&qm(l)},e.Zr=o.condition!==void 0?o.condition:e.oe,e.Fr=o.duration!==void 0?o.duration:100,e.se=o.pixelDelta!==void 0?o.pixelDelta:128,e}return PE(i,s),i.prototype.handleEvent=function(t){var e=!1;if(t.type==se){var o=t.originalEvent,l=o.keyCode;if(this.Zr(t)&&(l==c1||l==a1||l==l1||l==TE)){var f=t.map.getView(),y=f.getResolution()*this.se,w=0,b=0;l==c1?b=-y:l==a1?w=-y:l==l1?w=y:b=y;var I=[w,b];es(I,f.getRotation()),$0(f,I,this.Fr),o.preventDefault(),e=!0}}return!e},i}(xc),IE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),h1=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.Zr=o.condition?o.condition:qm,e.Br=o.delta?o.delta:1,e.Fr=o.duration!==void 0?o.duration:100,e}return IE(i,s),i.prototype.handleEvent=function(t){var e=!1;if(t.type==se||t.type==oe){var o=t.originalEvent,l=o.charCode;if(this.Zr(t)&&(l==43||l==45)){var f=t.map,y=l==43?this.Br:-this.Br;Zd(f.getView(),y,void 0,this.Fr),o.preventDefault(),e=!0}}return!e},i}(xc),ME=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),p1="trackpad",LE="wheel",f1=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,o)||this).ue=0,e.ae=0,e.wt=o.maxDelta!==void 0?o.maxDelta:1,e.Fr=o.duration!==void 0?o.duration:250,e.he=o.timeout!==void 0?o.timeout:80,e.fe=o.useAnchor===void 0||o.useAnchor,e.ce=o.constrainResolution!==void 0&&o.constrainResolution;var l=o.condition?o.condition:mp;return e.Zr=o.onFocusOnly?Kd(Bm,l):l,e.le=null,e.ve=void 0,e.de,e.pe=void 0,e.ye=400,e.me,e.we=300,e}return ME(i,s),i.prototype.ge=function(){this.me=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.ae?this.ae>0?1:-1:0,this.le)},i.prototype.handleEvent=function(t){if(!this.Zr(t)||t.type!==wi)return!0;var e,o=t.map,l=t.originalEvent;if(l.preventDefault(),this.fe&&(this.le=t.coordinate),t.type==wi&&(e=l.deltaY,Qo&&l.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=tn),l.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),e===0)return!1;this.ae=e;var f=Date.now();this.ve===void 0&&(this.ve=f),(!this.pe||f-this.ve>this.ye)&&(this.pe=Math.abs(e)<4?p1:LE);var y=o.getView();if(this.pe===p1&&!y.getConstrainResolution()&&!this.ce)return this.me?clearTimeout(this.me):(y.getAnimating()&&y.cancelAnimations(),y.beginInteraction()),this.me=setTimeout(this.ge.bind(this),this.he),y.adjustZoom(-e/this.we,this.le),this.ve=f,!1;this.ue+=e;var w=Math.max(this.he-(f-this.ve),0);return clearTimeout(this.de),this.de=setTimeout(this.be.bind(this,o),w),!1},i.prototype.be=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=-Y(this.ue,-this.wt*this.we,this.wt*this.we)/this.we;(e.getConstrainResolution()||this.ce)&&(o=o?o>0?1:-1:0),Zd(e,o,this.le,this.Fr),this.pe=void 0,this.ue=0,this.le=null,this.ve=void 0,this.de=void 0},i.prototype.setMouseAnchor=function(t){this.fe=t,t||(this.le=null)},i}(xc),AE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),d1=function(s){function i(t){var e=this,o=t||{},l=o;return l.stopDown||(l.stopDown=nt),(e=s.call(this,l)||this).xe=null,e.Kr=void 0,e.Me=!1,e._e=0,e.Se=o.threshold!==void 0?o.threshold:.3,e.Fr=o.duration!==void 0?o.duration:250,e}return AE(i,s),i.prototype.handleDragEvent=function(t){var e=0,o=this.targetPointers[0],l=this.targetPointers[1],f=Math.atan2(l.clientY-o.clientY,l.clientX-o.clientX);if(this.Kr!==void 0){var y=f-this.Kr;this._e+=y,!this.Me&&Math.abs(this._e)>this.Se&&(this.Me=!0),e=y}this.Kr=f;var w=t.map,b=w.getView();if(b.getConstraints().rotation!==k){var I=w.getViewport().getBoundingClientRect(),N=$d(this.targetPointers);N[0]-=I.left,N[1]-=I.top,this.xe=w.getCoordinateFromPixelInternal(N),this.Me&&(w.render(),b.adjustRotationInternal(e,this.xe))}},i.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.Fr),!1)},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.xe=null,this.Kr=void 0,this.Me=!1,this._e=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},i}(ja),OE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),g1=function(s){function i(t){var e=this,o=t||{},l=o;return l.stopDown||(l.stopDown=nt),(e=s.call(this,l)||this).xe=null,e.Fr=o.duration!==void 0?o.duration:400,e.Oe=void 0,e.je=1,e}return OE(i,s),i.prototype.handleDragEvent=function(t){var e=1,o=this.targetPointers[0],l=this.targetPointers[1],f=o.clientX-l.clientX,y=o.clientY-l.clientY,w=Math.sqrt(f*f+y*y);this.Oe!==void 0&&(e=this.Oe/w),this.Oe=w;var b=t.map,I=b.getView();e!=1&&(this.je=e);var N=b.getViewport().getBoundingClientRect(),D=$d(this.targetPointers);D[0]-=N.left,D[1]-=N.top,this.xe=b.getCoordinateFromPixelInternal(D),b.render(),I.adjustResolutionInternal(e,this.xe)},i.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),o=this.je>1?1:-1;return e.endInteraction(this.Fr,o),!1}return!0},i.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.xe=null,this.Oe=void 0,this.je=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},i}(ja);function m1(s){var i=s||{},t=new Be,e=new np(-.005,.05,100);return(i.altShiftDragRotate===void 0||i.altShiftDragRotate)&&t.push(new r1),(i.doubleClickZoom===void 0||i.doubleClickZoom)&&t.push(new K0({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan===void 0||i.dragPan)&&t.push(new e1({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate===void 0||i.pinchRotate)&&t.push(new d1),(i.pinchZoom===void 0||i.pinchZoom)&&t.push(new g1({duration:i.zoomDuration})),(i.keyboard===void 0||i.keyboard)&&(t.push(new u1),t.push(new h1({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom===void 0||i.mouseWheelZoom)&&t.push(new f1({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom===void 0||i.shiftDragZoom)&&t.push(new s1({duration:i.zoomDuration})),t}var NE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),RE=function(s){function i(t){return(t=Vt({},t)).controls||(t.controls=Z0()),t.interactions||(t.interactions=m1({onFocusOnly:!0})),s.call(this,t)||this}return NE(i,s),i.prototype.createRenderer=function(){return new ap(this)},i}(dp),kE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Xm="element",Wm="map",Ym="offset",tg="position",Zm="positioning",y1=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un,e.options=t,e.id=t.id,e.insertFirst=t.insertFirst===void 0||t.insertFirst,e.stopEvent=t.stopEvent===void 0||t.stopEvent,e.element=document.createElement("div"),e.element.className=t.className!==void 0?t.className:"ol-overlay-container ol-selectable",e.element.style.position="absolute",e.element.style.pointerEvents="auto";var o=t.autoPan;return o&&typeof o!="object"&&(o={animation:t.autoPanAnimation,margin:t.autoPanMargin}),e.autoPan=o||!1,e.rendered={jt:"",visible:!0},e.mapPostrenderListenerKey=null,e.addChangeListener(Xm,e.handleElementChanged),e.addChangeListener(Wm,e.handleMapChanged),e.addChangeListener(Ym,e.handleOffsetChanged),e.addChangeListener(tg,e.handlePositionChanged),e.addChangeListener(Zm,e.handlePositioningChanged),t.element!==void 0&&e.setElement(t.element),e.setOffset(t.offset!==void 0?t.offset:[0,0]),e.setPositioning(t.positioning||"top-left"),t.position!==void 0&&e.setPosition(t.position),e}return kE(i,s),i.prototype.getElement=function(){return this.get(Xm)},i.prototype.getId=function(){return this.id},i.prototype.getMap=function(){return this.get(Wm)||null},i.prototype.getOffset=function(){return this.get(Ym)},i.prototype.getPosition=function(){return this.get(tg)},i.prototype.getPositioning=function(){return this.get(Zm)},i.prototype.handleElementChanged=function(){Jc(this.element);var t=this.getElement();t&&this.element.appendChild(t)},i.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Kc(this.element),Or(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Ee(t,ga,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}},i.prototype.render=function(){this.updatePixelPosition()},i.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},i.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},i.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},i.prototype.setElement=function(t){this.set(Xm,t)},i.prototype.setMap=function(t){this.set(Wm,t)},i.prototype.setOffset=function(t){this.set(Ym,t)},i.prototype.setPosition=function(t){this.set(tg,t)},i.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},i.prototype.panIntoView=function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(tg)){var o=this.getRect(e.getTargetElement(),e.getSize()),l=this.getElement(),f=this.getRect(l,[zd(l),Vd(l)]),y=t||{},w=y.margin===void 0?20:y.margin;if(!pn(o,f)){var b=f[0]-o[0],I=o[2]-f[2],N=f[1]-o[1],D=o[3]-f[3],j=[0,0];if(b<0?j[0]=b-w:I<0&&(j[0]=Math.abs(I)+w),N<0?j[1]=N-w:D<0&&(j[1]=Math.abs(D)+w),j[0]!==0||j[1]!==0){var H=e.getView().getCenterInternal(),Z=e.getPixelFromCoordinateInternal(H);if(!Z)return;var it=[Z[0]+j[0],Z[1]+j[1]],at=y.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(it),duration:at.duration,easing:at.easing})}}}},i.prototype.getRect=function(t,e){var o=t.getBoundingClientRect(),l=o.left+window.pageXOffset,f=o.top+window.pageYOffset;return[l,f,l+e[0],f+e[1]]},i.prototype.setPositioning=function(t){this.set(Zm,t)},i.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},i.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var o=t.getPixelFromCoordinate(e),l=t.getSize();this.updateRenderedPosition(o,l)}else this.setVisible(!1)},i.prototype.updateRenderedPosition=function(t,e){var o=this.element.style,l=this.getOffset(),f=this.getPositioning();this.setVisible(!0);var y=Math.round(t[0]+l[0])+"px",w=Math.round(t[1]+l[1])+"px",b="0%",I="0%";f=="bottom-right"||f=="center-right"||f=="top-right"?b="-100%":f!="bottom-center"&&f!="center-center"&&f!="top-center"||(b="-50%"),f=="bottom-left"||f=="bottom-center"||f=="bottom-right"?I="-100%":f!="center-left"&&f!="center-center"&&f!="center-right"||(I="-50%");var N="translate(".concat(b,", ").concat(I,") translate(").concat(y,", ").concat(w,")");this.rendered.jt!=N&&(this.rendered.jt=N,o.transform=N,o.msTransform=N)},i.prototype.getOptions=function(){return this.options},i}(cn),eg=function(){function s(i){this.highWaterMark=i!==void 0?i:2048,this.Ee=0,this.Te={},this.Ae=null,this.Pe=null}return s.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},s.prototype.expireCache=function(i){for(;this.canExpireCache();)this.pop()},s.prototype.clear=function(){this.Ee=0,this.Te={},this.Ae=null,this.Pe=null},s.prototype.containsKey=function(i){return this.Te.hasOwnProperty(i)},s.prototype.forEach=function(i){for(var t=this.Ae;t;)i(t.Ce,t.ke,this),t=t.newer},s.prototype.get=function(i,t){var e=this.Te[i];return Me(e!==void 0,15),e===this.Pe||(e===this.Ae?(this.Ae=this.Ae.newer,this.Ae.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.Pe,this.Pe.newer=e,this.Pe=e),e.Ce},s.prototype.remove=function(i){var t=this.Te[i];return Me(t!==void 0,15),t===this.Pe?(this.Pe=t.older,this.Pe&&(this.Pe.newer=null)):t===this.Ae?(this.Ae=t.newer,this.Ae&&(this.Ae.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.Te[i],--this.Ee,t.Ce},s.prototype.getCount=function(){return this.Ee},s.prototype.getKeys=function(){var i,t=new Array(this.Ee),e=0;for(i=this.Pe;i;i=i.older)t[e++]=i.ke;return t},s.prototype.getValues=function(){var i,t=new Array(this.Ee),e=0;for(i=this.Pe;i;i=i.older)t[e++]=i.Ce;return t},s.prototype.peekLast=function(){return this.Ae.Ce},s.prototype.peekLastKey=function(){return this.Ae.ke},s.prototype.peekFirstKey=function(){return this.Pe.ke},s.prototype.peek=function(i){if(this.containsKey(i))return this.Te[i].Ce},s.prototype.pop=function(){var i=this.Ae;return delete this.Te[i.ke],i.newer&&(i.newer.older=null),this.Ae=i.newer,this.Ae||(this.Pe=null),--this.Ee,i.Ce},s.prototype.replace=function(i,t){this.get(i),this.Te[i].Ce=t},s.prototype.set=function(i,t){Me(!(i in this.Te),16);var e={ke:i,newer:null,older:this.Pe,Ce:t};this.Pe?this.Pe.newer=e:this.Ae=e,this.Pe=e,this.Te[i]=e,++this.Ee},s.prototype.setSize=function(i){this.highWaterMark=i},s}();function yp(s,i,t,e){return e!==void 0?(e[0]=s,e[1]=i,e[2]=t,e):[s,i,t]}function Ul(s,i,t){return s+"/"+i+"/"+t}function vp(s){return Ul(s[0],s[1],s[2])}function v1(s){var i=s.substring(s.lastIndexOf("/")+1,s.length).split(",").map(Number);return Ul(i[0],i[1],i[2])}function $m(s){return s.split("/").map(Number)}function rg(s){return(s[1]<<s[0])+s[2]}function _1(s,i){var t=s[0],e=s[1],o=s[2];if(i.getMinZoom()>t||t>i.getMaxZoom())return!1;var l=i.getFullTileRange(t);return!l||l.containsXY(e,o)}var FE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ig=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return FE(i,s),i.prototype.expireCache=function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()},i.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=$m(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(vp(e.tileCoord)),e.release())}.bind(this))}},i}(eg),x1=function(){function s(i,t,e,o){this.minX=i,this.maxX=t,this.minY=e,this.maxY=o}return s.prototype.contains=function(i){return this.containsXY(i[1],i[2])},s.prototype.containsTileRange=function(i){return this.minX<=i.minX&&i.maxX<=this.maxX&&this.minY<=i.minY&&i.maxY<=this.maxY},s.prototype.containsXY=function(i,t){return this.minX<=i&&i<=this.maxX&&this.minY<=t&&t<=this.maxY},s.prototype.equals=function(i){return this.minX==i.minX&&this.minY==i.minY&&this.maxX==i.maxX&&this.maxY==i.maxY},s.prototype.extend=function(i){i.minX<this.minX&&(this.minX=i.minX),i.maxX>this.maxX&&(this.maxX=i.maxX),i.minY<this.minY&&(this.minY=i.minY),i.maxY>this.maxY&&(this.maxY=i.maxY)},s.prototype.getHeight=function(){return this.maxY-this.minY+1},s.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},s.prototype.getWidth=function(){return this.maxX-this.minX+1},s.prototype.intersects=function(i){return this.minX<=i.maxX&&this.maxX>=i.minX&&this.minY<=i.maxY&&this.maxY>=i.minY},s}();function yh(s,i,t,e,o){return o!==void 0?(o.minX=s,o.maxX=i,o.minY=t,o.maxY=e,o):new x1(s,i,t,e)}var ng=x1,DE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),w1=[],b1=function(s){function i(t,e,o,l){var f=s.call(this,t,e,{transition:0})||this;return f.Ne={},f.executorGroups={},f.declutterExecutorGroups={},f.loadingSourceTiles=0,f.hitDetectionImageData={},f.Le={},f.sourceTiles=[],f.errorTileKeys={},f.wantedResolution,f.getSourceTiles=l.bind(void 0,f),f.wrappedTileCoord=o,f}return DE(i,s),i.prototype.getContext=function(t){var e=L(t);return e in this.Ne||(this.Ne[e]=Cn(1,1,w1)),this.Ne[e]},i.prototype.hasContext=function(t){return L(t)in this.Ne},i.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},i.prototype.getReplayState=function(t){var e=L(t);return e in this.Le||(this.Le[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.Le[e]},i.prototype.load=function(){this.getSourceTiles()},i.prototype.release=function(){for(var t in this.Ne){var e=this.Ne[t];ip(e),w1.push(e.canvas),delete this.Ne[t]}s.prototype.release.call(this)},i}(Se),GE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),S1=function(s){function i(t,e,o,l,f,y){var w=s.call(this,t,e,y)||this;return w.extent=null,w.ze=l,w.Re=null,w.U,w.projection=null,w.resolution,w.Xt=f,w.Fe=o,w.key=o,w}return GE(i,s),i.prototype.getFormat=function(){return this.ze},i.prototype.getFeatures=function(){return this.Re},i.prototype.load=function(){this.state==Er&&(this.setState(br),this.Xt(this,this.Fe),this.U&&this.U(this.extent,this.resolution,this.projection))},i.prototype.onLoad=function(t,e){this.setFeatures(t)},i.prototype.onError=function(){this.setState(ur)},i.prototype.setFeatures=function(t){this.Re=t,this.setState(Oe)},i.prototype.setLoader=function(t){this.U=t},i}(Se);function gl(s){return Array.isArray(s)?Qu(s):s}var E1=!1;function Km(s,i,t,e,o,l,f){var y=new XMLHttpRequest;y.open("GET",typeof s=="function"?s(t,e,o):s,!0),i.getType()=="arraybuffer"&&(y.responseType="arraybuffer"),y.withCredentials=E1,y.onload=function(w){if(!y.status||y.status>=200&&y.status<300){var b=i.getType(),I=void 0;b=="json"||b=="text"?I=y.responseText:b=="xml"?(I=y.responseXML)||(I=new DOMParser().parseFromString(y.responseText,"application/xml")):b=="arraybuffer"&&(I=y.response),I?l(i.readFeatures(I,{extent:t,featureProjection:o}),i.readProjection(I)):f()}else f()},y.onerror=f,y.send()}function Jm(s,i){return function(t,e,o,l,f){var y=this;Km(s,i,t,e,o,function(w,b){y.addFeatures(w),l!==void 0&&l(w)},f||vt)}}function C1(s,i){return[[-1/0,-1/0,1/0,1/0]]}var T1=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Nf(s,i,t,e){var o=document.createElement("script"),l="olc_"+L(i);function f(){delete window[l],o.parentNode.removeChild(o)}o.async=!0,o.src=s+(s.indexOf("?")==-1?"?":"&")+(e||"callback")+"="+l;var y=setTimeout(function(){f(),t&&t()},1e4);window[l]=function(w){clearTimeout(y),f(),i(w)},document.head.appendChild(o)}var P1,I1=function(s){function i(t){var e=this,o="Unexpected response status: "+t.status;return(e=s.call(this,o)||this).name="ResponseError",e.response=t,e}return T1(i,s),i}(Error),M1=function(s){function i(t){var e=s.call(this,"Failed to issue request")||this;return e.name="ClientError",e.client=t,e}return T1(i,s),i}(Error);function Qm(s){return new Promise(function(i,t){var e=new XMLHttpRequest;e.addEventListener("load",function(o){var l=o.target;if(!l.status||l.status>=200&&l.status<300){var f=void 0;try{f=JSON.parse(l.responseText)}catch(w){var y="Error parsing response text as JSON: "+w.message;return void t(new Error(y))}i(f)}else t(new I1(l))}),e.addEventListener("error",function(o){t(new M1(o.target))}),e.open("GET",s),e.setRequestHeader("Accept","application/json"),e.send()})}function ty(s,i){return i.indexOf("://")>=0?i:new URL(i,s).href}var ey=function(){function s(){}return s.prototype.drawCustom=function(i,t,e,o){},s.prototype.drawGeometry=function(i){},s.prototype.setStyle=function(i){},s.prototype.drawCircle=function(i,t){},s.prototype.drawFeature=function(i,t){},s.prototype.drawGeometryCollection=function(i,t){},s.prototype.drawLineString=function(i,t){},s.prototype.drawMultiLineString=function(i,t){},s.prototype.drawMultiPoint=function(i,t){},s.prototype.drawMultiPolygon=function(i,t){},s.prototype.drawPoint=function(i,t){},s.prototype.drawPolygon=function(i,t){},s.prototype.drawText=function(i,t){},s.prototype.setFillStrokeStyle=function(i,t){},s.prototype.setImageStyle=function(i,t){},s.prototype.setTextStyle=function(i,t){},s}(),jE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),og=function(s){function i(t,e,o,l,f,y,w){var b=s.call(this)||this;return b.Ne=t,b.kt=e,b.st=o,b.jt=l,b.Ge=f,b.De=y,b.qe=w,b.Ue=null,b.Be=null,b.Xe=null,b.Ve=null,b.We=null,b.Lt=null,b.Ye=0,b.Ze=0,b.$e=0,b.Ke=0,b.He=0,b.Je=0,b.Qe=!1,b.no=0,b.io=[0,0],b.ro=0,b.eo="",b.oo=0,b.so=0,b.uo=!1,b.ao=0,b.ho=[0,0],b.fo=null,b.co=null,b.lo=null,b.vo=[],b.do=[1,0,0,1,0,0],b}return jE(i,s),i.prototype.po=function(t,e,o,l){if(this.Lt){var f=Sa(t,e,o,l,this.jt,this.vo),y=this.Ne,w=this.do,b=y.globalAlpha;this.Ke!=1&&(y.globalAlpha=b*this.Ke);var I=this.no;this.Qe&&(I+=this.Ge);for(var N=0,D=f.length;N<D;N+=2){var j=f[N]-this.Ye,H=f[N+1]-this.Ze;if(I!==0||this.io[0]!=1||this.io[1]!=1){var Z=j+this.Ye,it=H+this.Ze;At(w,Z,it,1,1,I,-Z,-it),y.setTransform.apply(y,w),y.translate(Z,it),y.scale(this.io[0],this.io[1]),y.drawImage(this.Lt,this.He,this.Je,this.ro,this.$e,-this.Ye,-this.Ze,this.ro,this.$e),y.setTransform(1,0,0,1,0,0)}else y.drawImage(this.Lt,this.He,this.Je,this.ro,this.$e,j,H,this.ro,this.$e)}this.Ke!=1&&(y.globalAlpha=b)}},i.prototype.yo=function(t,e,o,l){if(this.lo&&this.eo!==""){this.fo&&this.mo(this.fo),this.co&&this.wo(this.co),this.bo(this.lo);var f=Sa(t,e,o,l,this.jt,this.vo),y=this.Ne,w=this.ao;for(this.uo&&(w+=this.Ge);e<o;e+=l){var b=f[e]+this.oo,I=f[e+1]+this.so;if(w!==0||this.ho[0]!=1||this.ho[1]!=1){var N=At(this.do,b,I,1,1,w,-b,-I);y.setTransform.apply(y,N),y.translate(b,I),y.scale(this.ho[0],this.ho[1]),this.co&&y.strokeText(this.eo,0,0),this.fo&&y.fillText(this.eo,0,0),y.setTransform(1,0,0,1,0,0)}else this.co&&y.strokeText(this.eo,b,I),this.fo&&y.fillText(this.eo,b,I)}}},i.prototype.xo=function(t,e,o,l,f){var y=this.Ne,w=Sa(t,e,o,l,this.jt,this.vo);y.moveTo(w[0],w[1]);var b=w.length;f&&(b-=2);for(var I=2;I<b;I+=2)y.lineTo(w[I],w[I+1]);return f&&y.closePath(),o},i.prototype.Mo=function(t,e,o,l){for(var f=0,y=o.length;f<y;++f)e=this.xo(t,e,o[f],l,!0);return e},i.prototype.drawCircle=function(t){if(on(this.st,t.getExtent())){if(this.Ve||this.We){this.Ve&&this.mo(this.Ve),this.We&&this.wo(this.We);var e=El(t,this.jt,this.vo),o=e[2]-e[0],l=e[3]-e[1],f=Math.sqrt(o*o+l*l),y=this.Ne;y.beginPath(),y.arc(e[0],e[1],f,0,2*Math.PI),this.Ve&&y.fill(),this.We&&y.stroke()}this.eo!==""&&this.yo(t.getCenter(),0,2,2)}},i.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},i.prototype.setTransform=function(t){this.jt=t},i.prototype.drawGeometry=function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}},i.prototype.drawFeature=function(t,e){var o=e.getGeometryFunction()(t);o&&on(this.st,o.getExtent())&&(this.setStyle(e),this.drawGeometry(o))},i.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),o=0,l=e.length;o<l;++o)this.drawGeometry(e[o])},i.prototype.drawPoint=function(t){this.De&&(t=t.simplifyTransformed(this.De,this.qe));var e=t.getFlatCoordinates(),o=t.getStride();this.Lt&&this.po(e,0,e.length,o),this.eo!==""&&this.yo(e,0,e.length,o)},i.prototype.drawMultiPoint=function(t){this.De&&(t=t.simplifyTransformed(this.De,this.qe));var e=t.getFlatCoordinates(),o=t.getStride();this.Lt&&this.po(e,0,e.length,o),this.eo!==""&&this.yo(e,0,e.length,o)},i.prototype.drawLineString=function(t){if(this.De&&(t=t.simplifyTransformed(this.De,this.qe)),on(this.st,t.getExtent())){if(this.We){this.wo(this.We);var e=this.Ne,o=t.getFlatCoordinates();e.beginPath(),this.xo(o,0,o.length,t.getStride(),!1),e.stroke()}if(this.eo!==""){var l=t.getFlatMidpoint();this.yo(l,0,2,2)}}},i.prototype.drawMultiLineString=function(t){this.De&&(t=t.simplifyTransformed(this.De,this.qe));var e=t.getExtent();if(on(this.st,e)){if(this.We){this.wo(this.We);var o=this.Ne,l=t.getFlatCoordinates(),f=0,y=t.getEnds(),w=t.getStride();o.beginPath();for(var b=0,I=y.length;b<I;++b)f=this.xo(l,f,y[b],w,!1);o.stroke()}if(this.eo!==""){var N=t.getFlatMidpoints();this.yo(N,0,N.length,2)}}},i.prototype.drawPolygon=function(t){if(this.De&&(t=t.simplifyTransformed(this.De,this.qe)),on(this.st,t.getExtent())){if(this.We||this.Ve){this.Ve&&this.mo(this.Ve),this.We&&this.wo(this.We);var e=this.Ne;e.beginPath(),this.Mo(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.Ve&&e.fill(),this.We&&e.stroke()}if(this.eo!==""){var o=t.getFlatInteriorPoint();this.yo(o,0,2,2)}}},i.prototype.drawMultiPolygon=function(t){if(this.De&&(t=t.simplifyTransformed(this.De,this.qe)),on(this.st,t.getExtent())){if(this.We||this.Ve){this.Ve&&this.mo(this.Ve),this.We&&this.wo(this.We);var e=this.Ne,o=t.getOrientedFlatCoordinates(),l=0,f=t.getEndss(),y=t.getStride();e.beginPath();for(var w=0,b=f.length;w<b;++w){var I=f[w];l=this.Mo(o,l,I,y)}this.Ve&&e.fill(),this.We&&e.stroke()}if(this.eo!==""){var N=t.getFlatInteriorPoints();this.yo(N,0,N.length,2)}}},i.prototype.mo=function(t){var e=this.Ne,o=this.Ue;o?o.fillStyle!=t.fillStyle&&(o.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.Ue={fillStyle:t.fillStyle})},i.prototype.wo=function(t){var e=this.Ne,o=this.Be;o?(o.lineCap!=t.lineCap&&(o.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&($(o.lineDash,t.lineDash)||e.setLineDash(o.lineDash=t.lineDash),o.lineDashOffset!=t.lineDashOffset&&(o.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),o.lineJoin!=t.lineJoin&&(o.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),o.lineWidth!=t.lineWidth&&(o.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),o.miterLimit!=t.miterLimit&&(o.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),o.strokeStyle!=t.strokeStyle&&(o.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.Be={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},i.prototype.bo=function(t){var e=this.Ne,o=this.Xe,l=t.textAlign?t.textAlign:Ga;o?(o.font!=t.font&&(o.font=t.font,e.font=t.font),o.textAlign!=l&&(o.textAlign=l,e.textAlign=l),o.textBaseline!=t.textBaseline&&(o.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=l,e.textBaseline=t.textBaseline,this.Xe={font:t.font,textAlign:l,textBaseline:t.textBaseline})},i.prototype.setFillStrokeStyle=function(t,e){var o=this;if(t){var l=t.getColor();this.Ve={fillStyle:gl(l||Xs)}}else this.Ve=null;if(e){var f=e.getColor(),y=e.getLineCap(),w=e.getLineDash(),b=e.getLineDashOffset(),I=e.getLineJoin(),N=e.getWidth(),D=e.getMiterLimit(),j=w||pl;this.We={lineCap:y!==void 0?y:ka,lineDash:this.kt===1?j:j.map(function(H){return H*o.kt}),lineDashOffset:(b||0)*this.kt,lineJoin:I!==void 0?I:Fa,lineWidth:(N!==void 0?N:1)*this.kt,miterLimit:D!==void 0?D:Da,strokeStyle:gl(f||Ps)}}else this.We=null},i.prototype.setImageStyle=function(t){var e;if(t&&(e=t.getSize())){var o=t.getAnchor(),l=t.getOrigin();this.Lt=t.getImage(this.kt),this.Ye=o[0]*this.kt,this.Ze=o[1]*this.kt,this.$e=e[1]*this.kt,this.Ke=t.getOpacity(),this.He=l[0],this.Je=l[1],this.Qe=t.getRotateWithView(),this.no=t.getRotation(),this.io=t.getScaleArray(),this.ro=e[0]*this.kt}else this.Lt=null},i.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var o=e.getColor();this.fo={fillStyle:gl(o||Xs)}}else this.fo=null;var l=t.getStroke();if(l){var f=l.getColor(),y=l.getLineCap(),w=l.getLineDash(),b=l.getLineDashOffset(),I=l.getLineJoin(),N=l.getWidth(),D=l.getMiterLimit();this.co={lineCap:y!==void 0?y:ka,lineDash:w||pl,lineDashOffset:b||0,lineJoin:I!==void 0?I:Fa,lineWidth:N!==void 0?N:1,miterLimit:D!==void 0?D:Da,strokeStyle:gl(f||Ps)}}else this.co=null;var j=t.getFont(),H=t.getOffsetX(),Z=t.getOffsetY(),it=t.getRotateWithView(),at=t.getRotation(),wt=t.getScaleArray(),gt=t.getText(),yt=t.getTextAlign(),It=t.getTextBaseline();this.lo={font:j!==void 0?j:ou,textAlign:yt!==void 0?yt:Ga,textBaseline:It!==void 0?It:kl},this.eo=gt!==void 0?Array.isArray(gt)?gt.reduce(function(Rt,kt,Dt){return Rt+(Dt%2?" ":kt)},""):gt:"",this.oo=H!==void 0?this.kt*H:0,this.so=Z!==void 0?this.kt*Z:0,this.uo=it!==void 0&&it,this.ao=at!==void 0?at:0,this.ho=[this.kt*wt[0],this.kt*wt[1]]}else this.eo=""},i}(ey),L1={Point:function(s,i,t,e,o){var l,f=t.getImage(),y=t.getText();if(f){if(f.getImageState()!=Nn)return;var w=s;if(o){var b=f.getDeclutterMode();if(b!=="none")if(w=o,b==="obstacle"){var I=s.getBuilder(t.getZIndex(),"Image");I.setImageStyle(f,l),I.drawPoint(i,e)}else y&&y.getText()&&(l={})}var N=w.getBuilder(t.getZIndex(),"Image");N.setImageStyle(f,l),N.drawPoint(i,e)}if(y&&y.getText()){var D=s;o&&(D=o);var j=D.getBuilder(t.getZIndex(),"Text");j.setTextStyle(y,l),j.drawText(i,e)}},LineString:function(s,i,t,e,o){var l=t.getStroke();if(l){var f=s.getBuilder(t.getZIndex(),"LineString");f.setFillStrokeStyle(null,l),f.drawLineString(i,e)}var y=t.getText();if(y&&y.getText()){var w=(o||s).getBuilder(t.getZIndex(),"Text");w.setTextStyle(y),w.drawText(i,e)}},Polygon:function(s,i,t,e,o){var l=t.getFill(),f=t.getStroke();if(l||f){var y=s.getBuilder(t.getZIndex(),"Polygon");y.setFillStrokeStyle(l,f),y.drawPolygon(i,e)}var w=t.getText();if(w&&w.getText()){var b=(o||s).getBuilder(t.getZIndex(),"Text");b.setTextStyle(w),b.drawText(i,e)}},MultiPoint:function(s,i,t,e,o){var l,f=t.getImage(),y=t.getText();if(f){if(f.getImageState()!=Nn)return;var w=s;if(o){var b=f.getDeclutterMode();if(b!=="none")if(w=o,b==="obstacle"){var I=s.getBuilder(t.getZIndex(),"Image");I.setImageStyle(f,l),I.drawMultiPoint(i,e)}else y&&y.getText()&&(l={})}var N=w.getBuilder(t.getZIndex(),"Image");N.setImageStyle(f,l),N.drawMultiPoint(i,e)}if(y&&y.getText()){var D=s;o&&(D=o);var j=D.getBuilder(t.getZIndex(),"Text");j.setTextStyle(y,l),j.drawText(i,e)}},MultiLineString:function(s,i,t,e,o){var l=t.getStroke();if(l){var f=s.getBuilder(t.getZIndex(),"LineString");f.setFillStrokeStyle(null,l),f.drawMultiLineString(i,e)}var y=t.getText();if(y&&y.getText()){var w=(o||s).getBuilder(t.getZIndex(),"Text");w.setTextStyle(y),w.drawText(i,e)}},MultiPolygon:function(s,i,t,e,o){var l=t.getFill(),f=t.getStroke();if(f||l){var y=s.getBuilder(t.getZIndex(),"Polygon");y.setFillStrokeStyle(l,f),y.drawMultiPolygon(i,e)}var w=t.getText();if(w&&w.getText()){var b=(o||s).getBuilder(t.getZIndex(),"Text");b.setTextStyle(w),b.drawText(i,e)}},GeometryCollection:function(s,i,t,e,o){var l,f,y=i.getGeometriesArray();for(l=0,f=y.length;l<f;++l)(0,L1[y[l].getType()])(s,y[l],t,e,o)},Circle:function(s,i,t,e,o){var l=t.getFill(),f=t.getStroke();if(l||f){var y=s.getBuilder(t.getZIndex(),"Circle");y.setFillStrokeStyle(l,f),y.drawCircle(i,e)}var w=t.getText();if(w&&w.getText()){var b=(o||s).getBuilder(t.getZIndex(),"Text");b.setTextStyle(w),b.drawText(i,e)}}};function A1(s,i){return parseInt(L(s),10)-parseInt(L(i),10)}function sg(s,i){var t=ag(s,i);return t*t}function ag(s,i){return .5*s/i}function Rf(s,i,t,e,o,l,f){var y=!1,w=t.getImage();if(w){var b=w.getImageState();b==Nn||b==ca?w.unlistenImageChange(o):(b==co&&w.load(),w.listenImageChange(o),y=!0)}return function(I,N,D,j,H,Z){var it=D.getGeometryFunction()(N);if(it){var at=it.simplifyTransformed(j,H);D.getRenderer()?O1(I,at,D,N):(0,L1[at.getType()])(I,at,D,N,Z)}}(s,i,t,e,l,f),y}function O1(s,i,t,e){if(i.getType()!="GeometryCollection")s.getBuilder(t.getZIndex(),"Default").drawCustom(i,e,t.getRenderer(),t.getHitDetectionRenderer());else for(var o=i.getGeometries(),l=0,f=o.length;l<f;++l)O1(s,o[l],t,e)}function N1(s){if(!(s.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");var i,t=s.inversePixelTransform[0],e=s.frameState,o=qi(s.inversePixelTransform.slice(),e.coordinateToPixelTransform),l=sg(e.viewState.resolution,t),f=wo();return f&&(i=ji(f,e.viewState.projection)),new og(s.context,t,e.extent,o,e.viewState.rotation,l,i)}var ry,_p={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},iy={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},ny=[];function R1(s,i,t,e,o){s.beginPath(),s.moveTo(0,0),s.lineTo(i,t),s.lineTo(e,o),s.closePath(),s.save(),s.clip(),s.fillRect(0,0,Math.max(i,e)+1,Math.max(t,o)),s.restore()}function oy(s,i){return Math.abs(s[4*i]-210)>2||Math.abs(s[4*i+3]-191.25)>2}function xp(s,i,t,e){var o=xo(t,i,s),l=ti(i,e,t),f=i.getMetersPerUnit();f!==void 0&&(l*=f);var y=s.getMetersPerUnit();y!==void 0&&(l/=y);var w=s.getExtent();if(!w||nn(w,o)){var b=ti(s,l,o)/l;isFinite(b)&&b>0&&(l/=b)}return l}function k1(s,i,t,e){var o=Gi(t),l=xp(s,i,o,e);return(!isFinite(l)||l<=0)&&xs(t,function(f){return l=xp(s,i,f,e),isFinite(l)&&l>0}),l}function sy(s,i,t,e,o,l,f,y,w,b,I,N){var D=Cn(Math.round(t*s),Math.round(t*i),ny);if(N||Vt(D,_p),w.length===0)return D.canvas;function j(yt){return Math.round(yt*t)/t}D.scale(t,t),D.globalCompositeOperation="lighter";var H=[1/0,1/0,-1/0,-1/0];w.forEach(function(yt,It,Rt){_s(H,yt.extent)});var Z=Gr(H),it=Ki(H),at=Cn(Math.round(t*Z/e),Math.round(t*it/e));N||Vt(at,_p);var wt=t/e;w.forEach(function(yt,It,Rt){var kt=yt.extent[0]-H[0],Dt=-(yt.extent[3]-H[3]),Xt=Gr(yt.extent),ee=Ki(yt.extent);yt.image.width>0&&yt.image.height>0&&at.drawImage(yt.image,b,b,yt.image.width-2*b,yt.image.height-2*b,kt*wt,Dt*wt,Xt*wt,ee*wt)});var gt=Zr(f);return y.getTriangles().forEach(function(yt,It,Rt){var kt=yt.source,Dt=yt.target,Xt=kt[0][0],ee=kt[0][1],pe=kt[1][0],xe=kt[1][1],fe=kt[2][0],Re=kt[2][1],qe=j((Dt[0][0]-gt[0])/l),Ge=j(-(Dt[0][1]-gt[1])/l),Qe=j((Dt[1][0]-gt[0])/l),ir=j(-(Dt[1][1]-gt[1])/l),de=j((Dt[2][0]-gt[0])/l),Nr=j(-(Dt[2][1]-gt[1])/l),Pr=Xt,he=ee;Xt=0,ee=0;var $e=jt([[pe-=Pr,xe-=he,0,0,Qe-qe],[fe-=Pr,Re-=he,0,0,de-qe],[0,0,pe,xe,ir-Ge],[0,0,fe,Re,Nr-Ge]]);if($e){if(D.save(),D.beginPath(),function(){if(ry===void 0){var Sn=document.createElement("canvas").getContext("2d");Sn.globalCompositeOperation="lighter",Sn.fillStyle="rgba(210, 0, 0, 0.75)",R1(Sn,4,5,4,0),R1(Sn,4,5,0,5);var tr=Sn.getImageData(0,0,3,3).data;ry=oy(tr,0)||oy(tr,4)||oy(tr,8)}return ry}()||!N){D.moveTo(Qe,ir);for(var or=qe-Qe,fi=Ge-ir,ki=0;ki<4;ki++)D.lineTo(Qe+j((ki+1)*or/4),ir+j(ki*fi/3)),ki!=3&&D.lineTo(Qe+j((ki+1)*or/4),ir+j((ki+1)*fi/3));D.lineTo(de,Nr)}else D.moveTo(Qe,ir),D.lineTo(qe,Ge),D.lineTo(de,Nr);D.clip(),D.transform($e[0],$e[2],$e[1],$e[3],qe,Ge),D.translate(H[0]-Pr,H[3]-he),D.scale(e/t,-e/t),D.drawImage(at.canvas,0,0),D.restore()}}),I&&(D.save(),D.globalCompositeOperation="source-over",D.strokeStyle="black",D.lineWidth=1,y.getTriangles().forEach(function(yt,It,Rt){var kt=yt.target,Dt=(kt[0][0]-gt[0])/l,Xt=-(kt[0][1]-gt[1])/l,ee=(kt[1][0]-gt[0])/l,pe=-(kt[1][1]-gt[1])/l,xe=(kt[2][0]-gt[0])/l,fe=-(kt[2][1]-gt[1])/l;D.beginPath(),D.moveTo(ee,pe),D.lineTo(Dt,Xt),D.lineTo(xe,fe),D.closePath(),D.stroke()}),D.restore()),D.canvas}var BE=[0,0,0],ql=function(){function s(i){var t;if(this.minZoom=i.minZoom!==void 0?i.minZoom:0,this.Ti=i.resolutions,Me(W(this.Ti,function(f,y){return y-f},!0),17),!i.origins)for(var e=0,o=this.Ti.length-1;e<o;++e)if(t){if(this.Ti[e]/this.Ti[e+1]!==t){t=void 0;break}}else t=this.Ti[e]/this.Ti[e+1];this.Ei=t,this.maxZoom=this.Ti.length-1,this._o=i.origin!==void 0?i.origin:null,this.So=null,i.origins!==void 0&&(this.So=i.origins,Me(this.So.length==this.Ti.length,20));var l=i.extent;l===void 0||this._o||this.So||(this._o=Zr(l)),Me(!this._o&&this.So||this._o&&!this.So,18),this.Oo=null,i.tileSizes!==void 0&&(this.Oo=i.tileSizes,Me(this.Oo.length==this.Ti.length,19)),this.jo=i.tileSize!==void 0?i.tileSize:this.Oo?null:Ys,Me(!this.jo&&this.Oo||this.jo&&!this.Oo,22),this.st=l!==void 0?l:null,this.Eo=null,this.To=[0,0],this.Ao=[0,0,0,0],i.sizes!==void 0?this.Eo=i.sizes.map(function(f,y){var w=new ng(Math.min(0,f[0]),Math.max(f[0]-1,-1),Math.min(0,f[1]),Math.max(f[1]-1,-1));if(l){var b=this.getTileRangeForExtentAndZ(l,y);w.minX=Math.max(b.minX,w.minX),w.maxX=Math.min(b.maxX,w.maxX),w.minY=Math.max(b.minY,w.minY),w.maxY=Math.min(b.maxY,w.maxY)}return w},this):l&&this.Po(l)}return s.prototype.forEachTileCoord=function(i,t,e){for(var o=this.getTileRangeForExtentAndZ(i,t),l=o.minX,f=o.maxX;l<=f;++l)for(var y=o.minY,w=o.maxY;y<=w;++y)e([t,l,y])},s.prototype.forEachTileCoordParentTileRange=function(i,t,e,o){var l,f,y=null,w=i[0]-1;for(this.Ei===2?(l=i[1],f=i[2]):y=this.getTileCoordExtent(i,o);w>=this.minZoom;){if(t(w,this.Ei===2?yh(l=Math.floor(l/2),l,f=Math.floor(f/2),f,e):this.getTileRangeForExtentAndZ(y,w,e)))return!0;--w}return!1},s.prototype.getExtent=function(){return this.st},s.prototype.getMaxZoom=function(){return this.maxZoom},s.prototype.getMinZoom=function(){return this.minZoom},s.prototype.getOrigin=function(i){return this._o?this._o:this.So[i]},s.prototype.getResolution=function(i){return this.Ti[i]},s.prototype.getResolutions=function(){return this.Ti},s.prototype.getTileCoordChildTileRange=function(i,t,e){if(i[0]<this.maxZoom){if(this.Ei===2){var o=2*i[1],l=2*i[2];return yh(o,o+1,l,l+1,t)}var f=this.getTileCoordExtent(i,e||this.Ao);return this.getTileRangeForExtentAndZ(f,i[0]+1,t)}return null},s.prototype.getTileRangeForTileCoordAndZ=function(i,t,e){if(t>this.maxZoom||t<this.minZoom)return null;var o=i[0],l=i[1],f=i[2];if(t===o)return yh(l,f,l,f,e);if(this.Ei){var y=Math.pow(this.Ei,t-o),w=Math.floor(l*y),b=Math.floor(f*y);return t<o?yh(w,w,b,b,e):yh(w,Math.floor(y*(l+1))-1,b,Math.floor(y*(f+1))-1,e)}var I=this.getTileCoordExtent(i,this.Ao);return this.getTileRangeForExtentAndZ(I,t,e)},s.prototype.getTileRangeExtent=function(i,t,e){var o=this.getOrigin(i),l=this.getResolution(i),f=Pn(this.getTileSize(i),this.To),y=o[0]+t.minX*f[0]*l,w=o[0]+(t.maxX+1)*f[0]*l;return En(y,o[1]+t.minY*f[1]*l,w,o[1]+(t.maxY+1)*f[1]*l,e)},s.prototype.getTileRangeForExtentAndZ=function(i,t,e){var o=BE;this.Co(i[0],i[3],t,!1,o);var l=o[1],f=o[2];return this.Co(i[2],i[1],t,!0,o),yh(l,o[1],f,o[2],e)},s.prototype.getTileCoordCenter=function(i){var t=this.getOrigin(i[0]),e=this.getResolution(i[0]),o=Pn(this.getTileSize(i[0]),this.To);return[t[0]+(i[1]+.5)*o[0]*e,t[1]-(i[2]+.5)*o[1]*e]},s.prototype.getTileCoordExtent=function(i,t){var e=this.getOrigin(i[0]),o=this.getResolution(i[0]),l=Pn(this.getTileSize(i[0]),this.To),f=e[0]+i[1]*l[0]*o,y=e[1]-(i[2]+1)*l[1]*o;return En(f,y,f+l[0]*o,y+l[1]*o,t)},s.prototype.getTileCoordForCoordAndResolution=function(i,t,e){return this.ko(i[0],i[1],t,!1,e)},s.prototype.ko=function(i,t,e,o,l){var f=this.getZForResolution(e),y=e/this.getResolution(f),w=this.getOrigin(f),b=Pn(this.getTileSize(f),this.To),I=y*(i-w[0])/e/b[0],N=y*(w[1]-t)/e/b[1];return o?(I=dn(I,5)-1,N=dn(N,5)-1):(I=gi(I,5),N=gi(N,5)),yp(f,I,N,l)},s.prototype.Co=function(i,t,e,o,l){var f=this.getOrigin(e),y=this.getResolution(e),w=Pn(this.getTileSize(e),this.To),b=(i-f[0])/y/w[0],I=(f[1]-t)/y/w[1];return o?(b=dn(b,5)-1,I=dn(I,5)-1):(b=gi(b,5),I=gi(I,5)),yp(e,b,I,l)},s.prototype.getTileCoordForCoordAndZ=function(i,t,e){return this.Co(i[0],i[1],t,!1,e)},s.prototype.getTileCoordResolution=function(i){return this.Ti[i[0]]},s.prototype.getTileSize=function(i){return this.jo?this.jo:this.Oo[i]},s.prototype.getFullTileRange=function(i){return this.Eo?this.Eo[i]:this.st?this.getTileRangeForExtentAndZ(this.st,i):null},s.prototype.getZForResolution=function(i,t){return Y(T(this.Ti,i,t||0),this.minZoom,this.maxZoom)},s.prototype.tileCoordIntersectsViewport=function(i,t){return Wc(t,0,t.length,2,this.getTileCoordExtent(i))},s.prototype.Po=function(i){for(var t=this.Ti.length,e=new Array(t),o=this.minZoom;o<t;++o)e[o]=this.getTileRangeForExtentAndZ(i,o);this.Eo=e},s}();function ay(s){var i=s.getDefaultTileGrid();return i||(i=j1(s),s.setDefaultTileGrid(i)),i}function F1(s,i,t){var e=i[0],o=s.getTileCoordCenter(i),l=wc(t);if(nn(l,o))return i;var f=Gr(l),y=Math.ceil((l[0]-o[0])/f);return o[0]+=f*y,s.getTileCoordForCoordAndZ(o,e)}function D1(s,i,t,e){var o=e!==void 0?e:"top-left",l=G1(s,i,t);return new ql({extent:s,origin:Sl(s,o),resolutions:l,tileSize:t})}function vh(s){var i=s||{},t=i.extent||ie("EPSG:3857").getExtent(),e={extent:t,minZoom:i.minZoom,tileSize:i.tileSize,resolutions:G1(t,i.maxZoom,i.tileSize,i.maxResolution)};return new ql(e)}function G1(s,i,t,e){for(var o=i!==void 0?i:42,l=Ki(s),f=Gr(s),y=Pn(t!==void 0?t:Ys),w=e>0?e:Math.max(f/y[0],l/y[1]),b=o+1,I=new Array(b),N=0;N<b;++N)I[N]=w/Math.pow(2,N);return I}function j1(s,i,t,e){return D1(wc(s),i,t,e)}function wc(s){var i=(s=ie(s)).getExtent();if(!i){var t=180*Di[Mi.DEGREES]/s.getMetersPerUnit();i=En(-t,-t,t,t)}return i}function B1(s,i){var t=/\{z\}/g,e=/\{x\}/g,o=/\{y\}/g,l=/\{-y\}/g;return function(f,y,w){return f?s.replace(t,f[0].toString()).replace(e,f[1].toString()).replace(o,f[2].toString()).replace(l,function(){var b=f[0],I=i.getFullTileRange(b);return Me(I,55),(I.getHeight()-f[2]-1).toString()}):void 0}}function lg(s,i){for(var t=s.length,e=new Array(t),o=0;o<t;++o)e[o]=B1(s[o],i);return wp(e)}function wp(s){return s.length===1?s[0]:function(i,t,e){if(i){var o=be(rg(i),s.length);return s[o](i,t,e)}}}function z1(s,i,t){}function cg(s){var i=[],t=/\{([a-z])-([a-z])\}/.exec(s);if(t){var e=t[1].charCodeAt(0),o=t[2].charCodeAt(0),l=void 0;for(l=e;l<=o;++l)i.push(s.replace(t[0],String.fromCharCode(l)));return i}if(t=/\{(\d+)-(\d+)\}/.exec(s)){for(var f=parseInt(t[2],10),y=parseInt(t[1],10);y<=f;y++)i.push(s.replace(t[0],y.toString()));return i}return i.push(s),i}function Hl(s,i){var t=[];Object.keys(i).forEach(function(o){i[o]!==null&&i[o]!==void 0&&t.push(o+"="+encodeURIComponent(i[o]))});var e=t.join("&");return(s=(s=s.replace(/[?&]$/,"")).indexOf("?")===-1?s+"?":s+"&")+e}var ly,bp=34962,kf=34963,ug=35044,hg=35048,cy=5126,V1=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function pg(s,i){for(var t=Vt({preserveDrawingBuffer:!0,antialias:!wn},i),e=V1.length,o=0;o<e;++o)try{var l=s.getContext(V1[o],t);if(l)return l}catch{}return null}var cu="http://www.w3.org/2001/XMLSchema-instance";function ai(s,i){return _h().createElementNS(s,i)}function fs(s,i){return uy(s,i,[]).join("")}function uy(s,i,t){if(s.nodeType==Node.CDATA_SECTION_NODE||s.nodeType==Node.TEXT_NODE)i?t.push(String(s.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(s.nodeValue);else{var e=void 0;for(e=s.firstChild;e;e=e.nextSibling)uy(e,i,t)}return t}function ml(s){return"documentElement"in s}function U1(s,i,t){return s.getAttributeNS(i,t)||""}function yl(s){return new DOMParser().parseFromString(s,"application/xml")}function Ff(s,i){return function(t,e){var o=s.call(i!==void 0?i:this,t,e);o!==void 0&&ut(e[e.length-1],o)}}function kr(s,i){return function(t,e){var o=s.call(i!==void 0?i:this,t,e);o!==void 0&&e[e.length-1].push(o)}}function $r(s,i){return function(t,e){var o=s.call(i!==void 0?i:this,t,e);o!==void 0&&(e[e.length-1]=o)}}function Un(s,i,t){return function(e,o){var l=s.call(t!==void 0?t:this,e,o);if(l!==void 0){var f=o[o.length-1],y=i!==void 0?i:e.localName,w=void 0;y in f?w=f[y]:(w=[],f[y]=w),w.push(l)}}}function Zt(s,i,t){return function(e,o){var l=s.call(t!==void 0?t:this,e,o);l!==void 0&&(o[o.length-1][i!==void 0?i:e.localName]=l)}}function Jt(s,i){return function(t,e,o){s.call(i!==void 0?i:this,t,e,o),o[o.length-1].node.appendChild(t)}}function hy(s,i){var t,e;return function(o,l,f){if(t===void 0){t={};var y={};y[o.localName]=s,t[o.namespaceURI]=y,e=oo(o.localName)}py(t,e,l,f)}}function oo(s,i){var t=s;return function(e,o,l){var f=o[o.length-1].node,y=t;return y===void 0&&(y=l),ai(i!==void 0?i:f.namespaceURI,y)}}var Bo=oo();function Rs(s,i){for(var t=i.length,e=new Array(t),o=0;o<t;++o)e[o]=s[i[o]];return e}function Le(s,i,t){var e,o,l=t!==void 0?t:{};for(e=0,o=s.length;e<o;++e)l[s[e]]=i;return l}function ks(s,i,t,e){var o;for(o=i.firstElementChild;o;o=o.nextElementSibling){var l=s[o.namespaceURI];if(l!==void 0){var f=l[o.localName];f!==void 0&&f.call(e,o,t)}}}function He(s,i,t,e,o){return e.push(s),ks(i,t,e,o),e.pop()}function py(s,i,t,e,o,l){for(var f,y,w=(o!==void 0?o:t).length,b=0;b<w;++b)(f=t[b])!==void 0&&(y=i.call(l!==void 0?l:this,f,e,o!==void 0?o[b]:void 0))!==void 0&&s[y.namespaceURI][y.localName].call(l,y,f,e)}function li(s,i,t,e,o,l,f){return o.push(s),py(i,t,e,o,l,f),o.pop()}var fg=void 0;function q1(){return fg===void 0&&typeof XMLSerializer<"u"&&(fg=new XMLSerializer),fg}var dg=void 0;function _h(){return dg===void 0&&typeof document<"u"&&(dg=document.implementation.createDocument("","",null)),dg}var zE=ug;function gg(s){switch(s){case bp:return Float32Array;case kf:return Uint32Array;default:return Float32Array}}var Sp=function(){function s(i,t){this.array=null,this.type=i,Me(i===bp||i===kf,62),this.usage=t!==void 0?t:zE}return s.prototype.ofSize=function(i){this.array=new(gg(this.type))(i)},s.prototype.fromArray=function(i){var t=gg(this.type);this.array=t.from?t.from(i):new t(i)},s.prototype.fromArrayBuffer=function(i){this.array=new(gg(this.type))(i)},s.prototype.getType=function(){return this.type},s.prototype.getArray=function(){return this.array},s.prototype.getUsage=function(){return this.usage},s.prototype.getSize=function(){return this.array?this.array.length:0},s}(),H1="webglcontextlost",X1="webglcontextrestored",fy=function(){function s(i){this.Io=i.webGlContext;var t=this.Io;this.No=i.scaleRatio||1,this.Lo=t.createTexture(),this.zo=null,this.Ro=t.createFramebuffer();var e=t.createShader(t.VERTEX_SHADER);t.shaderSource(e,i.vertexShader||`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`),t.compileShader(e);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,i.fragmentShader||`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`),t.compileShader(o),this.Fo=t.createProgram(),t.attachShader(this.Fo,e),t.attachShader(this.Fo,o),t.linkProgram(this.Fo),this.Go=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.Go),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.Do=t.getAttribLocation(this.Fo,"a_position"),this.qo=t.getUniformLocation(this.Fo,"u_screenSize"),this.Uo=t.getUniformLocation(this.Fo,"u_opacity"),this.Bo=t.getUniformLocation(this.Fo,"u_image"),this.Xo=[],i.uniforms&&Object.keys(i.uniforms).forEach(function(l){this.Xo.push({value:i.uniforms[l],location:t.getUniformLocation(this.Fo,l)})}.bind(this))}return s.prototype.getGL=function(){return this.Io},s.prototype.init=function(i){var t=this.getGL(),e=[t.drawingBufferWidth*this.No,t.drawingBufferHeight*this.No];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,e[0],e[1]),!this.zo||this.zo[0]!==e[0]||this.zo[1]!==e[1]){this.zo=e;var o=t.RGBA,l=t.RGBA,f=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.Lo),t.texImage2D(t.TEXTURE_2D,0,o,e[0],e[1],0,l,f,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.Lo,0)}},s.prototype.apply=function(i,t,e,o){var l=this.getGL(),f=i.size;if(l.bindFramebuffer(l.FRAMEBUFFER,t?t.getFrameBuffer():null),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.Lo),!t){var y=L(l.canvas);if(!i.renderTargets[y]){var w=l.getContextAttributes();w&&w.preserveDrawingBuffer&&(l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT)),i.renderTargets[y]=!0}}l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.bindBuffer(l.ARRAY_BUFFER,this.Go),l.useProgram(this.Fo),l.enableVertexAttribArray(this.Do),l.vertexAttribPointer(this.Do,2,l.FLOAT,!1,0,0),l.uniform2f(this.qo,f[0],f[1]),l.uniform1i(this.Bo,0);var b=i.layerStatesArray[i.layerIndex].opacity;l.uniform1f(this.Uo,b),this.applyUniforms(i),e&&e(l,i),l.drawArrays(l.TRIANGLES,0,6),o&&o(l,i)},s.prototype.getFrameBuffer=function(){return this.Ro},s.prototype.applyUniforms=function(i){var t,e=this.getGL(),o=1;this.Xo.forEach(function(l){if((t=typeof l.value=="function"?l.value(i):l.value)instanceof HTMLCanvasElement||t instanceof ImageData)l.texture||(l.texture=e.createTexture()),e.activeTexture(e["TEXTURE".concat(o)]),e.bindTexture(e.TEXTURE_2D,l.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,t.width,t.height,0,e.UNSIGNED_BYTE,new Uint8Array(t.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.uniform1i(l.location,o++);else if(Array.isArray(t))switch(t.length){case 2:return void e.uniform2f(l.location,t[0],t[1]);case 3:return void e.uniform3f(l.location,t[0],t[1],t[2]);case 4:return void e.uniform4f(l.location,t[0],t[1],t[2],t[3]);default:return}else typeof t=="number"&&e.uniform1f(l.location,t)})},s}();function VE(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Df(s,i){return s[0]=i[0],s[1]=i[1],s[4]=i[2],s[5]=i[3],s[12]=i[4],s[13]=i[5],s}var UE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),qE="u_projectionMatrix",HE="u_offsetScaleMatrix",XE="u_offsetRotateMatrix",WE="u_time",YE="u_zoom",ZE="u_resolution",Ba={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:cy},mg={};function W1(s){return"shared/"+s}var Y1=0;function Z1(s){for(var i=0,t=0;t<s.length;t++){var e=s[t];i+=e.size*$1(e.type)}return i}function $1(s){switch(s){case Ba.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Ba.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Ba.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Ba.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var K1=function(s){function i(t){var e,o=s.call(this)||this,l=t||{};o.Vo=o.handleWebGLContextLost.bind(o),o.Wo=o.handleWebGLContextRestored.bind(o),o.Yo=l.canvasCacheKey?W1(l.canvasCacheKey):(e="unique/"+Y1,Y1+=1,e),o.qt=function(y){var w=mg[y];if(!w){var b=document.createElement("canvas");b.style.position="absolute",b.style.left="0",w={users:0,canvas:b},mg[y]=w}return w.users+=1,w.canvas}(o.Yo),o.Io=pg(o.qt),o.Zo={},o.$o={},o.Ko=null,o.qt.addEventListener(H1,o.Vo),o.qt.addEventListener(X1,o.Wo),o.Ho=[1,0,0,1,0,0],o.Jo=[1,0,0,1,0,0],o.Qo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.ts={},o.ns={},o.Xo=[],l.uniforms&&o.setUniforms(l.uniforms);var f=o.getGL();return o.rs=l.postProcesses?l.postProcesses.map(function(y){return new fy({webGlContext:f,scaleRatio:y.scaleRatio,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,uniforms:y.uniforms})}):[new fy({webGlContext:f})],o.es=null,o.ve=Date.now(),o}return UE(i,s),i.prototype.setUniforms=function(t){for(var e in this.Xo=[],t)this.Xo.push({name:e,value:t[e]});this.ts={}},i.prototype.canvasCacheKeyMatches=function(t){return this.Yo===W1(t)},i.prototype.getExtension=function(t){if(t in this.$o)return this.$o[t];var e=this.Io.getExtension(t);return this.$o[t]=e,e},i.prototype.bindBuffer=function(t){var e=this.getGL(),o=L(t),l=this.Zo[o];l||(l={buffer:t,webGlBuffer:e.createBuffer()},this.Zo[o]=l),e.bindBuffer(t.getType(),l.webGlBuffer)},i.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},i.prototype.deleteBuffer=function(t){var e=this.getGL(),o=L(t),l=this.Zo[o];l&&!e.isContextLost()&&e.deleteBuffer(l.webGlBuffer),delete this.Zo[o]},i.prototype.disposeInternal=function(){this.qt.removeEventListener(H1,this.Vo),this.qt.removeEventListener(X1,this.Wo),function(t){var e=mg[t];if(e&&(e.users-=1,!(e.users>0))){var o=pg(e.canvas).getExtension("WEBGL_lose_context");o&&o.loseContext(),delete mg[t]}}(this.Yo),delete this.Io,delete this.qt},i.prototype.prepareDraw=function(t,e){var o=this.getGL(),l=this.getCanvas(),f=t.size,y=t.pixelRatio;l.width=f[0]*y,l.height=f[1]*y,l.style.width=f[0]+"px",l.style.height=f[1]+"px",o.useProgram(this.Ko);for(var w=this.rs.length-1;w>=0;w--)this.rs[w].init(t);o.bindTexture(o.TEXTURE_2D,null),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,e?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.Ko),this.applyFrameState(t),this.applyUniforms(t)},i.prototype.prepareDrawToRenderTarget=function(t,e,o){var l=this.getGL(),f=e.getSize();l.bindFramebuffer(l.FRAMEBUFFER,e.getFramebuffer()),l.viewport(0,0,f[0],f[1]),l.bindTexture(l.TEXTURE_2D,e.getTexture()),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),l.enable(l.BLEND),l.blendFunc(l.ONE,o?l.ZERO:l.ONE_MINUS_SRC_ALPHA),l.useProgram(this.Ko),this.applyFrameState(t),this.applyUniforms(t)},i.prototype.drawElements=function(t,e){var o=this.getGL();this.getExtension("OES_element_index_uint");var l=o.UNSIGNED_INT,f=e-t,y=4*t;o.drawElements(o.TRIANGLES,f,l,y)},i.prototype.finalizeDraw=function(t,e,o){for(var l=0,f=this.rs.length;l<f;l++)l===f-1?this.rs[l].apply(t,null,e,o):this.rs[l].apply(t,this.rs[l+1])},i.prototype.getCanvas=function(){return this.qt},i.prototype.getGL=function(){return this.Io},i.prototype.applyFrameState=function(t){var e=t.size,o=t.viewState.rotation,l=In(this.Jo);Mn(l,2/e[0],2/e[1]);var f=In(this.Ho);o!==0&&hn(f,-o),this.setUniformMatrixValue(HE,Df(this.Qo,l)),this.setUniformMatrixValue(XE,Df(this.Qo,f)),this.setUniformFloatValue(WE,.001*(Date.now()-this.ve)),this.setUniformFloatValue(YE,t.viewState.zoom),this.setUniformFloatValue(ZE,t.viewState.resolution)},i.prototype.applyUniforms=function(t){var e,o=this.getGL(),l=0;this.Xo.forEach(function(f){if((e=typeof f.value=="function"?f.value(t):f.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)f.texture||(f.prevValue=void 0,f.texture=o.createTexture()),o.activeTexture(o["TEXTURE".concat(l)]),o.bindTexture(o.TEXTURE_2D,f.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),(!(e instanceof HTMLImageElement)||e.complete)&&f.prevValue!==e&&(f.prevValue=e,o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e)),o.uniform1i(this.getUniformLocation(f.name),l++);else if(Array.isArray(e)&&e.length===6)this.setUniformMatrixValue(f.name,Df(this.Qo,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void o.uniform2f(this.getUniformLocation(f.name),e[0],e[1]);case 3:return void o.uniform3f(this.getUniformLocation(f.name),e[0],e[1],e[2]);case 4:return void o.uniform4f(this.getUniformLocation(f.name),e[0],e[1],e[2],e[3]);default:return}else typeof e=="number"&&o.uniform1f(this.getUniformLocation(f.name),e)}.bind(this))},i.prototype.useProgram=function(t){return t!=this.Ko&&(this.getGL().useProgram(t),this.Ko=t,this.ts={},this.ns={},!0)},i.prototype.compileShader=function(t,e){var o=this.getGL(),l=o.createShader(e);return o.shaderSource(l,t),o.compileShader(l),l},i.prototype.getProgram=function(t,e){var o=this.getGL(),l=this.compileShader(t,o.FRAGMENT_SHADER),f=this.compileShader(e,o.VERTEX_SHADER),y=o.createProgram();if(o.attachShader(y,l),o.attachShader(y,f),o.linkProgram(y),!o.getShaderParameter(l,o.COMPILE_STATUS)){var w="Fragment shader compliation failed: ".concat(o.getShaderInfoLog(l));throw new Error(w)}if(o.deleteShader(l),!o.getShaderParameter(f,o.COMPILE_STATUS))throw w="Vertex shader compilation failed: ".concat(o.getShaderInfoLog(f)),new Error(w);if(o.deleteShader(f),!o.getProgramParameter(y,o.LINK_STATUS))throw w="GL program linking failed: ".concat(o.getShaderInfoLog(f)),new Error(w);return y},i.prototype.getUniformLocation=function(t){return this.ts[t]===void 0&&(this.ts[t]=this.getGL().getUniformLocation(this.Ko,t)),this.ts[t]},i.prototype.getAttributeLocation=function(t){return this.ns[t]===void 0&&(this.ns[t]=this.getGL().getAttribLocation(this.Ko,t)),this.ns[t]},i.prototype.makeProjectionTransform=function(t,e){var o=t.size,l=t.viewState.rotation,f=t.viewState.resolution,y=t.viewState.center;return In(e),At(e,0,0,2/(f*o[0]),2/(f*o[1]),-l,-y[0],-y[1]),e},i.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},i.prototype.setUniformFloatVec4=function(t,e){this.getGL().uniform4fv(this.getUniformLocation(t),e)},i.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},i.prototype.os=function(t,e,o,l,f){var y=this.getAttributeLocation(t);y<0||(this.getGL().enableVertexAttribArray(y),this.getGL().vertexAttribPointer(y,e,o,!1,l,f))},i.prototype.enableAttributes=function(t){for(var e=Z1(t),o=0,l=0;l<t.length;l++){var f=t[l];this.os(f.name,f.size,f.type||cy,e,o),o+=f.size*$1(f.type)}},i.prototype.handleWebGLContextLost=function(){Lt(this.Zo),this.Ko=null},i.prototype.handleWebGLContextRestored=function(){},i.prototype.createTexture=function(t,e,o){var l=this.getGL(),f=o||l.createTexture(),y=l.RGBA,w=l.RGBA,b=l.UNSIGNED_BYTE;return l.bindTexture(l.TEXTURE_2D,f),e?l.texImage2D(l.TEXTURE_2D,0,y,w,b,e):l.texImage2D(l.TEXTURE_2D,0,y,t[0],t[1],0,w,b,null),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),f},i}(Q),J1=function(){function s(i,t){this.name=i,this.data=t,this.ss=null}return s.prototype.getTexture=function(i){if(!this.ss){var t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.data.length/4,1,0,i.RGBA,i.UNSIGNED_BYTE,this.data),this.ss=t}return this.ss},s}(),Xl=new Uint8Array(4),Q1=function(){function s(i,t){this.us=i;var e=i.getGL();this.ss=e.createTexture(),this.hs=e.createFramebuffer(),this.W=t||[1,1],this.B=new Uint8Array(0),this.fs=!0,this.cs()}return s.prototype.setSize=function(i){$(i,this.W)||(this.W[0]=i[0],this.W[1]=i[1],this.cs())},s.prototype.getSize=function(){return this.W},s.prototype.clearCachedData=function(){this.fs=!0},s.prototype.readAll=function(){if(this.fs){var i=this.W,t=this.us.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.hs),t.readPixels(0,0,i[0],i[1],t.RGBA,t.UNSIGNED_BYTE,this.B),this.fs=!1}return this.B},s.prototype.readPixel=function(i,t){if(i<0||t<0||i>this.W[0]||t>=this.W[1])return Xl[0]=0,Xl[1]=0,Xl[2]=0,Xl[3]=0,Xl;this.readAll();var e=Math.floor(i)+(this.W[1]-Math.floor(t)-1)*this.W[0];return Xl[0]=this.B[4*e],Xl[1]=this.B[4*e+1],Xl[2]=this.B[4*e+2],Xl[3]=this.B[4*e+3],Xl},s.prototype.getTexture=function(){return this.ss},s.prototype.getFramebuffer=function(){return this.hs},s.prototype.cs=function(){var i=this.W,t=this.us.getGL();this.ss=this.us.createTexture(i,null,this.ss),t.bindFramebuffer(t.FRAMEBUFFER,this.hs),t.viewport(0,0,i[0],i[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.ss,0),this.B=new Uint8Array(i[0]*i[1]*4)},s}(),$E=!0,dy=function(){function s(i,t,e,o,l,f){this.ls=i,this.vs=t;var y={},w=zn(this.vs,this.ls);this.ds=function(gt){var yt=gt[0]+"/"+gt[1];return y[yt]||(y[yt]=w(gt)),y[yt]},this.ps=o,this.ys=l*l,this.ws=[],this.gs=!1,this.bs=this.ls.canWrapX()&&!!o&&!!this.ls.getExtent()&&Gr(o)==Gr(this.ls.getExtent()),this.xs=this.ls.getExtent()?Gr(this.ls.getExtent()):null,this.Ms=this.vs.getExtent()?Gr(this.vs.getExtent()):null;var b=Zr(e),I=Qn(e),N=Yo(e),D=To(e),j=this.ds(b),H=this.ds(I),Z=this.ds(N),it=this.ds(D),at=10+(f?Math.max(0,Math.ceil(st(_o(e)/(f*f*256*256)))):0);if(this._s(b,I,N,D,j,H,Z,it,at),this.gs){var wt=1/0;this.ws.forEach(function(gt,yt,It){wt=Math.min(wt,gt.source[0][0],gt.source[1][0],gt.source[2][0])}),this.ws.forEach(function(gt){if(Math.max(gt.source[0][0],gt.source[1][0],gt.source[2][0])-wt>this.xs/2){var yt=[[gt.source[0][0],gt.source[0][1]],[gt.source[1][0],gt.source[1][1]],[gt.source[2][0],gt.source[2][1]]];yt[0][0]-wt>this.xs/2&&(yt[0][0]-=this.xs),yt[1][0]-wt>this.xs/2&&(yt[1][0]-=this.xs),yt[2][0]-wt>this.xs/2&&(yt[2][0]-=this.xs);var It=Math.min(yt[0][0],yt[1][0],yt[2][0]);Math.max(yt[0][0],yt[1][0],yt[2][0])-It<this.xs/2&&(gt.source=yt)}}.bind(this))}y={}}return s.prototype.Ss=function(i,t,e,o,l,f){this.ws.push({source:[o,l,f],target:[i,t,e]})},s.prototype._s=function(i,t,e,o,l,f,y,w,b){var I=mr([l,f,y,w]),N=this.xs?Gr(I)/this.xs:null,D=this.xs,j=this.ls.canWrapX()&&N>.5&&N<1,H=!1;if(b>0&&(this.vs.isGlobal()&&this.Ms&&(H=Gr(mr([i,t,e,o]))/this.Ms>.25||H),!j&&this.ls.isGlobal()&&N&&(H=N>.25||H)),!(!H&&this.ps&&isFinite(I[0])&&isFinite(I[1])&&isFinite(I[2])&&isFinite(I[3]))||on(I,this.ps)){var Z=0;if(!(H||isFinite(l[0])&&isFinite(l[1])&&isFinite(f[0])&&isFinite(f[1])&&isFinite(y[0])&&isFinite(y[1])&&isFinite(w[0])&&isFinite(w[1]))){if(b>0)H=!0;else if((Z=(isFinite(l[0])&&isFinite(l[1])?0:8)+(isFinite(f[0])&&isFinite(f[1])?0:4)+(isFinite(y[0])&&isFinite(y[1])?0:2)+(isFinite(w[0])&&isFinite(w[1])?0:1))!=1&&Z!=2&&Z!=4&&Z!=8)return}if(b>0){if(!H){var it=[(i[0]+e[0])/2,(i[1]+e[1])/2],at=this.ds(it),wt=void 0;j?wt=(be(l[0],D)+be(y[0],D))/2-be(at[0],D):wt=(l[0]+y[0])/2-at[0];var gt=(l[1]+y[1])/2-at[1];H=wt*wt+gt*gt>this.ys}if(H){if(Math.abs(i[0]-e[0])<=Math.abs(i[1]-e[1])){var yt=[(t[0]+e[0])/2,(t[1]+e[1])/2],It=this.ds(yt),Rt=[(o[0]+i[0])/2,(o[1]+i[1])/2],kt=this.ds(Rt);this._s(i,t,yt,Rt,l,f,It,kt,b-1),this._s(Rt,yt,e,o,kt,It,y,w,b-1)}else{var Dt=[(i[0]+t[0])/2,(i[1]+t[1])/2],Xt=this.ds(Dt),ee=[(e[0]+o[0])/2,(e[1]+o[1])/2],pe=this.ds(ee);this._s(i,Dt,ee,o,l,Xt,pe,w,b-1),this._s(Dt,t,e,ee,Xt,f,y,pe,b-1)}return}}if(j){if(!this.bs)return;this.gs=!0}(11&Z)==0&&this.Ss(i,e,o,l,y,w),(14&Z)==0&&this.Ss(i,e,t,l,y,f),Z&&((13&Z)==0&&this.Ss(t,o,i,f,w,l),(7&Z)==0&&this.Ss(t,o,e,f,w,y))}},s.prototype.calculateSourceExtent=function(){var i=[1/0,1/0,-1/0,-1/0];return this.ws.forEach(function(t,e,o){var l=t.source;Wo(i,l[0]),Wo(i,l[1]),Wo(i,l[2])}),i},s.prototype.getTriangles=function(){return this.ws},s}(),KE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),yg=function(s){function i(t,e,o,l,f,y,w,b,I,N,D,j){var H=s.call(this,f,Er,{interpolate:!!j})||this;H.Os=D!==void 0&&D,H.kt=w,H.js=b,H.qt=null,H.Es=e,H.Ts=l,H.As=y||f,H.Ps=[],H.Cs=null,H.ks=0;var Z=l.getTileCoordExtent(H.As),it=H.Ts.getExtent(),at=H.Es.getExtent(),wt=it?fn(Z,it):Z;if(_o(wt)===0)return H.state=ar,H;var gt=t.getExtent();gt&&(at=at?fn(at,gt):gt);var yt=l.getResolution(H.As[0]),It=k1(t,o,wt,yt);if(!isFinite(It)||It<=0)return H.state=ar,H;var Rt=N!==void 0?N:.5;if(H.Is=new dy(t,o,wt,at,It*Rt,yt),H.Is.getTriangles().length===0)return H.state=ar,H;H.ks=e.getZForResolution(It);var kt=H.Is.calculateSourceExtent();if(at&&(t.canWrapX()?(kt[1]=Y(kt[1],at[1],at[3]),kt[3]=Y(kt[3],at[1],at[3])):kt=fn(kt,at)),_o(kt)){for(var Dt=e.getTileRangeForExtentAndZ(kt,H.ks),Xt=Dt.minX;Xt<=Dt.maxX;Xt++)for(var ee=Dt.minY;ee<=Dt.maxY;ee++){var pe=I(H.ks,Xt,ee,w);pe&&H.Ps.push(pe)}H.Ps.length===0&&(H.state=ar)}else H.state=ar;return H}return KE(i,s),i.prototype.getImage=function(){return this.qt},i.prototype.Ns=function(){var t=[];if(this.Ps.forEach(function(I,N,D){I&&I.getState()==Oe&&t.push({extent:this.Es.getTileCoordExtent(I.tileCoord),image:I.getImage()})}.bind(this)),this.Ps.length=0,t.length===0)this.state=ur;else{var e=this.As[0],o=this.Ts.getTileSize(e),l=typeof o=="number"?o:o[0],f=typeof o=="number"?o:o[1],y=this.Ts.getResolution(e),w=this.Es.getResolution(this.ks),b=this.Ts.getTileCoordExtent(this.As);this.qt=sy(l,f,this.kt,w,this.Es.getExtent(),y,b,this.Is,t,this.js,this.Os,this.interpolate),this.state=Oe}this.changed()},i.prototype.load=function(){if(this.state==Er){this.state=br,this.changed();var t=0;this.Cs=[],this.Ps.forEach(function(e,o,l){var f=e.getState();if(f==Er||f==br){t++;var y=Ee(e,ne,function(w){var b=e.getState();b!=Oe&&b!=ur&&b!=ar||(Or(y),--t===0&&(this.Ls(),this.Ns()))},this);this.Cs.push(y)}}.bind(this)),t===0?setTimeout(this.Ns.bind(this),0):this.Ps.forEach(function(e,o,l){e.getState()==Er&&e.load()})}},i.prototype.Ls=function(){this.Cs.forEach(Or),this.Cs=null},i.prototype.release=function(){this.qt&&(ip(this.qt.getContext("2d")),ny.push(this.qt),this.qt=null),s.prototype.release.call(this)},i}(Se),JE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function t_(s,i,t){var e=t?s.LINEAR:s.NEAREST;s.bindTexture(s.TEXTURE_2D,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e)}function e_(s,i,t,e,o,l){var f,y,w=s.getGL();t instanceof Float32Array?(f=w.FLOAT,s.getExtension("OES_texture_float"),y=s.getExtension("OES_texture_float_linear")!==null):(f=w.UNSIGNED_BYTE,y=!0),t_(w,i,l&&y);var b,I=t.byteLength/e[1],N=1;switch(I%8==0?N=8:I%4==0?N=4:I%2==0&&(N=2),o){case 1:b=w.LUMINANCE;break;case 2:b=w.LUMINANCE_ALPHA;break;case 3:b=w.RGB;break;case 4:b=w.RGBA;break;default:throw new Error("Unsupported number of bands: ".concat(o))}var D=w.getParameter(w.UNPACK_ALIGNMENT);w.pixelStorei(w.UNPACK_ALIGNMENT,N),w.texImage2D(w.TEXTURE_2D,0,b,e[0],e[1],0,b,f,t),w.pixelStorei(w.UNPACK_ALIGNMENT,D)}var Ep=null,r_=function(s){function i(t){var e=s.call(this)||this;e.tile,e.textures=[],e.cr=e.cr.bind(e),e.zs=Pn(t.grid.getTileSize(t.tile.tileCoord[0])),e.js=t.gutter||0,e.bandCount=NaN,e.us=t.helper;var o=new Sp(bp,ug);return o.fromArray([0,1,1,1,1,0,0,0]),e.us.flushBufferData(o),e.coords=o,e.setTile(t.tile),e}return JE(i,s),i.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(ne,this.cr),this.tile=t,this.textures.length=0,this.loaded=t.getState()===Oe,this.loaded)this.Rs();else{if(t instanceof fc){var e=t.getImage();e instanceof Image&&!e.crossOrigin&&(e.crossOrigin="anonymous")}t.addEventListener(ne,this.cr)}},i.prototype.Rs=function(){var t=this.us,e=t.getGL(),o=this.tile;if(o instanceof fc||o instanceof yg){var l=e.createTexture();return this.textures.push(l),this.bandCount=4,void function(pe,xe,fe,Re){t_(pe,xe,Re),pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,pe.RGBA,pe.UNSIGNED_BYTE,fe)}(e,l,o.getImage(),o.interpolate)}var f=o.getSize(),y=[f[0]+2*this.js,f[1]+2*this.js],w=o.getData(),b=w instanceof Float32Array,I=y[0]*y[1],N=b?Float32Array:Uint8Array,D=N.BYTES_PER_ELEMENT,j=w.byteLength/y[1];this.bandCount=Math.floor(j/D/y[0]);var H=Math.ceil(this.bandCount/4);if(H===1)return l=e.createTexture(),this.textures.push(l),void e_(t,l,w,y,this.bandCount,o.interpolate);for(var Z=new Array(H),it=0;it<H;++it){l=e.createTexture(),this.textures.push(l);var at=it<H-1?4:this.bandCount%4;Z[it]=new N(I*at)}for(var wt=0,gt=0,yt=y[0]*this.bandCount,It=0;It<y[1];++It){for(var Rt=0;Rt<yt;++Rt){var kt=w[gt+Rt],Dt=Math.floor(wt/this.bandCount),Xt=Rt%this.bandCount;(ee=Z[it=Math.floor(Xt/4)])[Dt*(at=ee.length/I)+Xt%4]=kt,++wt}gt+=j/D}for(it=0;it<H;++it){var ee;e_(t,l=this.textures[it],ee=Z[it],y,at=ee.length/I,o.interpolate)}},i.prototype.cr=function(){this.tile.getState()===Oe&&(this.loaded=!0,this.Rs(),this.dispatchEvent(ne))},i.prototype.disposeInternal=function(){var t=this.us.getGL();this.us.deleteBuffer(this.coords);for(var e=0;e<this.textures.length;++e)t.deleteTexture(this.textures[e]);this.tile.removeEventListener(ne,this.cr)},i.prototype.getPixelData=function(t,e){if(!this.loaded)return null;var o,l=this.zs[0],f=this.zs[1],y=this.js;if(this.tile instanceof xr){var w=this.tile.getSize(),b=w[0],I=w[1],N=b+2*y,D=I+2*y,j=y+Math.floor(b*(t/l)),H=y+Math.floor(I*(e/f)),Z=this.tile.getData();if(Z instanceof DataView){var it=Z.byteLength/(N*D),at=it*(H*N+j),wt=Z.buffer.slice(at,at+it);return new DataView(wt)}var gt=this.bandCount*(H*N+j);return Z.slice(gt,gt+this.bandCount)}Ep||((o=document.createElement("canvas")).width=1,o.height=1,Ep=o.getContext("2d")),Ep.clearRect(0,0,1,1);var yt,It=this.tile.getImage(),Rt=It.width-2*y,kt=It.height-2*y,Dt=y+Math.floor(Rt*(t/l)),Xt=y+Math.floor(kt*(e/f));try{Ep.drawImage(It,Dt,Xt,1,1,0,0,1,1),yt=Ep.getImageData(0,0,1,1).data}catch{return Ep=null,null}return yt},i}(ue),QE=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),gy=function(s){function i(t){var e=s.call(this)||this;return e.ready=!0,e.Fs=e.Gs.bind(e),e.Ds=t,e.declutterExecutorGroup=null,e}return QE(i,s),i.prototype.getFeatures=function(t){return E()},i.prototype.getData=function(t){return null},i.prototype.prepareFrame=function(t){return E()},i.prototype.renderFrame=function(t,e){return E()},i.prototype.loadedTileCallback=function(t,e,o){t[e]||(t[e]={}),t[e][o.tileCoord.toString()]=o},i.prototype.createLoadedTileFinder=function(t,e,o){return function(l,f){var y=this.loadedTileCallback.bind(this,o,l);return t.forEachLoadedTile(e,l,f,y)}.bind(this)},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f){},i.prototype.getDataAtPixel=function(t,e,o){return null},i.prototype.getLayer=function(){return this.Ds},i.prototype.handleFontsChanged=function(){},i.prototype.Gs=function(t){t.target.getState()===Nn&&this.renderIfReadyAndVisible()},i.prototype.loadImage=function(t){var e=t.getState();return e!=Nn&&e!=ca&&t.addEventListener(ne,this.Fs),e==co&&(t.load(),e=t.getState()),e==Nn},i.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()},i.prototype.disposeInternal=function(){delete this.Ds,s.prototype.disposeInternal.call(this)},i}(eo),tC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),my="GENERATE_BUFFERS",eC=function(s){function i(t,e){var o=s.call(this,t)||this,l=e||{};return o.qs=[1,0,0,1,0,0],o.Us=null,o.Bs=l.postProcesses,o.Xo=l.uniforms,o.helper,t.addChangeListener(eu,o.removeHelper.bind(o)),o.dispatchPreComposeEvent=o.dispatchPreComposeEvent.bind(o),o.dispatchPostComposeEvent=o.dispatchPostComposeEvent.bind(o),o}return tC(i,s),i.prototype.dispatchPreComposeEvent=function(t,e){var o=this.getLayer();if(o.hasListener(sp)){var l=new hl(sp,void 0,e,t);o.dispatchEvent(l)}},i.prototype.dispatchPostComposeEvent=function(t,e){var o=this.getLayer();if(o.hasListener(Sf)){var l=new hl(Sf,void 0,e,t);o.dispatchEvent(l)}},i.prototype.reset=function(t){this.Xo=t.uniforms,this.helper&&this.helper.setUniforms(this.Xo)},i.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},i.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var e=!0,o=-1,l=void 0,f=0,y=t.layerStatesArray.length;f<y;f++){var w=t.layerStatesArray[f].layer,b=w.getRenderer();if(b instanceof i){var I=w.getClassName();if((e||I!==l)&&(o+=1,e=!1),l=I,b===this)break}else e=!0}var N="map/"+t.mapId+"/group/"+o;this.helper&&this.helper.canvasCacheKeyMatches(N)||(this.removeHelper(),this.helper=new K1({postProcesses:this.Bs,uniforms:this.Xo,canvasCacheKey:N}),l&&(this.helper.getCanvas().className=l),this.afterHelperCreated())}return this.prepareFrameInternal(t)},i.prototype.afterHelperCreated=function(){},i.prototype.prepareFrameInternal=function(t){return!0},i.prototype.disposeInternal=function(){this.removeHelper(),s.prototype.disposeInternal.call(this)},i.prototype.Xs=function(t,e,o){var l=this.getLayer();if(l.hasListener(t)){At(this.qs,0,0,o.pixelRatio,-o.pixelRatio,0,0,-o.size[1]);var f=new hl(t,this.qs,o,e);l.dispatchEvent(f)}},i.prototype.preRender=function(t,e){this.Xs(Ol,t,e)},i.prototype.postRender=function(t,e){this.Xs(bf,t,e)},i.prototype.getDataAtPixel=function(t,e,o){var l=Ei([e.pixelRatio,0,0,e.pixelRatio,0,0],t.slice()),f=this.helper.getGL();if(!f)return null;var y=this.getLayer().getExtent();if(y&&!nn(y,Ei(e.pixelToCoordinateTransform,t.slice())))return null;var w=f.getContextAttributes();if(!w||!w.preserveDrawingBuffer)return new Uint8Array;var b,I=Math.round(l[0]),N=Math.round(l[1]),D=this.Us;if(!D){var j=document.createElement("canvas");j.width=1,j.height=1,D=j.getContext("2d"),this.Us=D}D.clearRect(0,0,1,1);try{D.drawImage(f.canvas,I,N,1,1,0,0,1,1),b=D.getImageData(0,0,1,1).data}catch{return b}return b[3]===0?null:b},i}(gy),rC=[],yy={vertexPosition:0,indexPosition:0};function vg(s,i,t,e,o){s[i+0]=t,s[i+1]=e,s[i+2]=o}function i_(s,i){var t=i||[],e=256,o=255;return t[0]=Math.floor(s/e/e/e)/o,t[1]=Math.floor(s/e/e)%e/o,t[2]=Math.floor(s/e)%e/o,t[3]=s%e/o,t}function n_(s){var i=0,t=256,e=255;return i+=Math.round(s[0]*t*t*t*e),i+=Math.round(s[1]*t*t*e),i+=Math.round(s[2]*t*e),i+=Math.round(s[3]*e)}var vy=eC,iC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ci={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},Gf={TEXTURE_COORD:"a_textureCoord"},nC=[{name:Gf.TEXTURE_COORD,size:2,type:Ba.FLOAT}],oC={};function sC(s){return 2*(1-1/(s+1))-1}function o_(s,i,t){t in s||(s[t]=[]),s[t].push(i)}function _y(s,i){var t=s.layerStatesArray[s.layerIndex];t.extent&&(i=fn(i,Mo(t.extent,s.viewState.projection)));var e=t.layer.getRenderSource();if(!e.getWrapX()){var o=e.getTileGridForProjection(s.viewState.projection).getExtent();o&&(i=fn(i,o))}return i}function xy(s,i){return"".concat(s.getKey(),",").concat(vp(i))}var s_=function(s){function i(t,e){var o=s.call(this,t,{uniforms:e.uniforms})||this;o.renderComplete=!1,o.Vs=[1,0,0,1,0,0],o.Ws=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.Ys=new ng(0,0,0,0),o.Zs=yp(0,0,0),o.$s=[0,0],o.Ks,o.Hs=e.vertexShader,o.Js=e.fragmentShader,o.Qs=new Sp(kf,ug),o.Qs.fromArray([0,1,3,1,2,3]);var l=e.cacheSize!==void 0?e.cacheSize:512;return o.tu=new eg(l),o.nu=e.paletteTextures||[],o.Zi=null,o}return iC(i,s),i.prototype.reset=function(t){s.prototype.reset.call(this,{uniforms:t.uniforms}),this.Hs=t.vertexShader,this.Js=t.fragmentShader,this.nu=t.paletteTextures||[],this.helper&&(this.Ks=this.helper.getProgram(this.Js,this.Hs))},i.prototype.afterHelperCreated=function(){this.Ks=this.helper.getProgram(this.Js,this.Hs),this.helper.flushBufferData(this.Qs)},i.prototype.iu=function(t){var e=this.getLayer(),o=t.getState(),l=e.getUseInterimTilesOnError();return o==Oe||o==ar||o==ur&&!l},i.prototype.prepareFrameInternal=function(t){var e=this.getLayer().getRenderSource();return!!e&&!ws(_y(t,t.extent))&&e.getState()==="ready"},i.prototype.enqueueTiles=function(t,e,o,l){var f=t.viewState,y=this.getLayer(),w=y.getRenderSource(),b=w.getTileGridForProjection(f.projection),I=w.getGutterForProjection(f.projection),N=L(w);N in t.wantedTiles||(t.wantedTiles[N]={});for(var D=t.wantedTiles[N],j=this.tu,H=Math.max(o-y.getPreload(),b.getMinZoom(),y.getMinZoom()),Z=o;Z>=H;--Z)for(var it=b.getTileRangeForExtentAndZ(e,Z,this.Ys),at=b.getResolution(Z),wt=it.minX;wt<=it.maxX;++wt)for(var gt=it.minY;gt<=it.maxY;++gt){var yt=yp(Z,wt,gt,this.Zs),It=xy(w,yt),Rt=void 0,kt=void 0;if(j.containsKey(It)&&(kt=(Rt=j.get(It)).tile),!Rt||Rt.tile.key!==w.getKey())if(kt=w.getTile(Z,wt,gt,t.pixelRatio,f.projection),Rt)if(this.iu(kt))Rt.setTile(kt);else{var Dt=kt.getInterimTile();Rt.setTile(Dt)}else Rt=new r_({tile:kt,grid:b,helper:this.helper,gutter:I}),j.set(It,Rt);o_(l,Rt,Z);var Xt=kt.getKey();D[Xt]=!0,kt.getState()===Er&&(t.tileQueue.isKeyQueued(Xt)||t.tileQueue.enqueue([kt,N,b.getTileCoordCenter(yt),at]))}},i.prototype.renderFrame=function(t){this.Zi=t,this.renderComplete=!0;var e=this.helper.getGL();this.preRender(e,t);var o=t.viewState,l=this.getLayer().getRenderSource(),f=l.getTileGridForProjection(o.projection),y=l.getGutterForProjection(o.projection),w=_y(t,t.extent),b=f.getZForResolution(o.resolution,l.zDirection),I={};if(t.nextExtent){var N=f.getZForResolution(o.nextResolution,l.zDirection),D=_y(t,t.nextExtent);this.enqueueTiles(t,D,N,I)}this.enqueueTiles(t,w,b,I);for(var j={},H=L(this),Z=t.time,it=!1,at=I[b],wt=0,gt=at.length;wt<gt;++wt){var yt=(or=(yr=at[wt]).tile).tileCoord;if(yr.loaded){if((fi=or.getAlpha(H,Z))===1){or.endTransition(H);continue}it=!0,j[ki=vp(yt)]=fi}if(this.renderComplete=!1,!this.ru(f,yt,b+1,I))for(var It=f.getMinZoom(),Rt=b-1;Rt>=It&&!this.ru(f,yt,Rt,I);--Rt);}this.helper.useProgram(this.Ks),this.helper.prepareDraw(t,!it);for(var kt=Object.keys(I).map(Number).sort(lt),Dt=o.center[0],Xt=o.center[1],ee=0,pe=kt.length;ee<pe;++ee){var xe=kt[ee],fe=f.getResolution(xe),Re=Pn(f.getTileSize(xe),this.$s),qe=f.getOrigin(xe),Ge=Re[0]+2*y,Qe=Re[1]+2*y,ir=Ge/Qe,de=(Dt-qe[0])/(Re[0]*fe),Nr=(qe[1]-Xt)/(Re[1]*fe),Pr=o.resolution/fe,he=sC(xe),$e=I[xe];for(wt=0,gt=$e.length;wt<gt;++wt)if((yr=$e[wt]).loaded){var or,fi,ki=vp(yt=(or=yr.tile).tileCoord),Sn=yt[1],tr=yt[2];In(this.Vs),Mn(this.Vs,2/(t.size[0]*Pr/Ge),-2/(t.size[1]*Pr/Ge)),hn(this.Vs,o.rotation),Mn(this.Vs,1,1/ir),Gt(this.Vs,(Re[0]*(Sn-de)-y)/Ge,(Re[1]*(tr-Nr)-y)/Qe),this.helper.setUniformMatrixValue(Ci.TILE_TRANSFORM,Df(this.Ws,this.Vs)),this.helper.bindBuffer(yr.coords),this.helper.bindBuffer(this.Qs),this.helper.enableAttributes(nC);for(var Jn=0;Jn<yr.textures.length;){var Vo="TEXTURE"+Jn,Hn="".concat(Ci.TILE_TEXTURE_ARRAY,"[").concat(Jn,"]");e.activeTexture(e[Vo]),e.bindTexture(e.TEXTURE_2D,yr.textures[Jn]),e.uniform1i(this.helper.getUniformLocation(Hn),Jn),++Jn}for(var _a=0;_a<this.nu.length;++_a){var Uo=this.nu[_a];e.activeTexture(e["TEXTURE"+Jn]);var ys=Uo.getTexture(e);e.bindTexture(e.TEXTURE_2D,ys),e.uniform1i(this.helper.getUniformLocation(Uo.name),Jn),++Jn}(fi=ki in j?j[ki]:1)<1&&(t.animate=!0),this.helper.setUniformFloatValue(Ci.TRANSITION_ALPHA,fi),this.helper.setUniformFloatValue(Ci.DEPTH,he),this.helper.setUniformFloatValue(Ci.TEXTURE_PIXEL_WIDTH,Ge),this.helper.setUniformFloatValue(Ci.TEXTURE_PIXEL_HEIGHT,Qe),this.helper.setUniformFloatValue(Ci.TEXTURE_RESOLUTION,fe),this.helper.setUniformFloatValue(Ci.TEXTURE_ORIGIN_X,qe[0]+Sn*Re[0]*fe-y*fe),this.helper.setUniformFloatValue(Ci.TEXTURE_ORIGIN_Y,qe[1]-tr*Re[1]*fe+y*fe);var Ya=w;y>0&&fn(Ya=f.getTileCoordExtent(yt),w,Ya),this.helper.setUniformFloatVec4(Ci.RENDER_EXTENT,Ya),this.helper.setUniformFloatValue(Ci.RESOLUTION,o.resolution),this.helper.setUniformFloatValue(Ci.ZOOM,o.zoom),this.helper.drawElements(0,this.Qs.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var ss=this.helper.getCanvas(),qo=this.tu;qo.canExpireCache();){var yr;(yr=qo.pop()).dispose()}return t.postRenderFunctions.push(function(ta,Za){l.expireCache(Za.viewState.projection,oC)}),this.postRender(e,t),ss},i.prototype.getData=function(t){if(!this.helper.getGL())return null;var e=this.Zi;if(!e)return null;var o=this.getLayer(),l=Ei(e.pixelToCoordinateTransform,t.slice()),f=e.viewState,y=o.getExtent();if(y&&!nn(Mo(y,f.projection),l))return null;var w,b,I,N=o.getSources(mr([l]),f.resolution);for(w=N.length-1;w>=0;--w)if((b=N[w]).getState()==="ready"){if(I=b.getTileGridForProjection(f.projection),b.getWrapX())break;var D=I.getExtent();if(!D||nn(D,l))break}if(w<0)return null;for(var j=this.tu,H=I.getZForResolution(f.resolution);H>=I.getMinZoom();--H){var Z=I.getTileCoordForCoordAndZ(l,H),it=xy(b,Z);if(j.containsKey(it)){var at=j.get(it);if(at.loaded){var wt=I.getOrigin(H),gt=Pn(I.getTileSize(H)),yt=I.getResolution(H),It=(l[0]-wt[0])/yt-Z[1]*gt[0],Rt=(wt[1]-l[1])/yt-Z[2]*gt[1];return at.getPixelData(It,Rt)}}}return null},i.prototype.ru=function(t,e,o,l){var f=t.getTileRangeForTileCoordAndZ(e,o,this.Ys);if(!f)return!1;for(var y=!0,w=this.tu,b=this.getLayer().getRenderSource(),I=f.minX;I<=f.maxX;++I)for(var N=f.minY;N<=f.maxY;++N){var D=xy(b,[o,I,N]),j=!1;if(w.containsKey(D)){var H=w.get(D);H.loaded&&(o_(l,H,o),j=!0)}j||(y=!1)}return y},i.prototype.removeHelper=function(){if(this.helper){var t=this.tu;t.forEach(function(e){return e.dispose()}),t.clear()}s.prototype.removeHelper.call(this)},i.prototype.disposeInternal=function(){var t=this.helper;t&&(t.getGL().deleteProgram(this.Ks),delete this.Ks,t.deleteBuffer(this.Qs)),s.prototype.disposeInternal.call(this),delete this.Qs,delete this.tu,delete this.Zi},i}(vy),_n=1,jf=2,Wl=4,za=8,uu=16,hu=31,aC=0,Li={};function vl(s){if(typeof s=="number")return _n;if(typeof s=="boolean")return za;if(typeof s=="string")return ps(s)?Wl|jf:jf;if(!Array.isArray(s))throw new Error("Unhandled value type: ".concat(JSON.stringify(s)));var i=s;if(i.every(function(e){return typeof e=="number"}))return i.length===3||i.length===4?Wl|uu:uu;if(typeof i[0]!="string")throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(i)));var t=Li[i[0]];if(t===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(i)));return t.getReturnType(i.slice(1))}function a_(s){return st(s)%1==0}function Bf(s){var i=s.toString();return i.indexOf(".")===-1?i+".0":i}function wy(s){if(s.length<2||s.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(s.length,"(").concat(s.map(Bf).join(", "),")")}function l_(s){var i=Ra(s).slice();return i.length<4&&i.push(1),wy(i.map(function(t,e){return e<3?t/255:t}))}function zf(s,i){return s.stringLiteralsMap[i]===void 0&&(s.stringLiteralsMap[i]=Object.keys(s.stringLiteralsMap).length),s.stringLiteralsMap[i]}function c_(s,i){return Bf(zf(s,i))}function Tr(s,i,t){if(Array.isArray(i)&&typeof i[0]=="string"){var e=Li[i[0]];if(e===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(i)));return e.toGlsl(s,i.slice(1),t)}var o=vl(i);if((o&_n)>0)return Bf(i);if((o&za)>0)return i.toString();if((o&jf)>0&&(t===void 0||t==jf))return c_(s,i.toString());if((o&Wl)>0&&(t===void 0||t==Wl))return l_(i);if((o&uu)>0)return wy(i);throw new Error("Unexpected expression ".concat(i," (expected type ").concat(t,")"))}function u_(s){if(!(vl(s)&_n))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(s)," instead"))}function bo(s){for(var i=0;i<s.length;i++)u_(s[i])}function h_(s){if(!(vl(s)&jf))throw new Error("A string value was expected, got ".concat(JSON.stringify(s)," instead"))}function by(s){if(!(vl(s)&za))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(s)," instead"))}function Kn(s,i){if(s.length!==i)throw new Error("Exactly ".concat(i," arguments were expected, got ").concat(s.length," instead"))}function pu(s,i){if(s.length<i)throw new Error("At least ".concat(i," arguments were expected, got ").concat(s.length," instead"))}function _g(s,i){if(s.length>i)throw new Error("At most ".concat(i," arguments were expected, got ").concat(s.length," instead"))}function p_(s){if(s.length%2!=0)throw new Error("An even amount of arguments was expected, got ".concat(s," instead"))}function Sy(s,i){if(!a_(i))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(s)))}function xg(s){return"u_var_"+s}Li.get={getReturnType:function(s){return hu},toGlsl:function(s,i){Kn(i,1),h_(i[0]);var t=i[0].toString();return s.attributes.indexOf(t)===-1&&s.attributes.push(t),(s.inFragmentShader?"v_":"a_")+t}},Li.var={getReturnType:function(s){return hu},toGlsl:function(s,i){Kn(i,1),h_(i[0]);var t=i[0].toString();return s.variables.indexOf(t)===-1&&s.variables.push(t),xg(t)}};var Ey="u_paletteTextures";Li.palette={getReturnType:function(s){return Wl},toGlsl:function(s,i){Kn(i,2),u_(i[0]);var t=Tr(s,i[0]),e=i[1];if(!Array.isArray(e))throw new Error("The second argument of palette must be an array");for(var o=e.length,l=new Uint8Array(4*o),f=0;f<o;f++){var y=e[f],w=void 0;if(typeof y=="string")w=ua(y);else{if(!Array.isArray(y))throw new Error("The second argument of palette must be an array of strings or colors");var b=y.length;if(b===4)w=y;else{if(b!==3)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(b));w=[y[0],y[1],y[2],1]}}var I=4*f;l[I]=w[0],l[I+1]=w[1],l[I+2]=w[2],l[I+3]=255*w[3]}s.paletteTextures||(s.paletteTextures=[]);var N="".concat(Ey,"[").concat(s.paletteTextures.length,"]"),D=new J1(N,l);return s.paletteTextures.push(D),"texture2D(".concat(N,", vec2((").concat(t," + 0.5) / ").concat(o,".0, 0.5))")}};var f_="getBandValue";function d_(s){return{getReturnType:function(i){return za},toGlsl:function(i,t){Kn(t,2);for(var e=hu,o=0;o<t.length;o++)e&=vl(t[o]);if(e===aC)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return e&=~Wl,"(".concat(Tr(i,t[0],e)," ").concat(s," ").concat(Tr(i,t[1],e),")")}}}function g_(s){return{getReturnType:function(i){return za},toGlsl:function(i,t){pu(t,2);for(var e=0;e<t.length;e++)by(t[e]);var o="";return o=t.map(function(l){return Tr(i,l)}).join(" ".concat(s," ")),o="(".concat(o,")")}}}Li.band={getReturnType:function(s){return _n},toGlsl:function(s,i){pu(i,1),_g(i,3);var t=i[0];if(!(f_ in s.functions)){for(var e="",o=s.bandCount||1,l=0;l<o;l++){var f=Math.floor(l/4),y=l%4;y===o-1&&y===1&&(y=3);var w="".concat(Ci.TILE_TEXTURE_ARRAY,"[").concat(f,"]");e+=`
          if (band == `.concat(l+1,`.0) {
            return texture2D(`).concat(w,", v_textureCoord + vec2(dx, dy))[").concat(y,`];
          }
        `)}s.functions.getBandValue=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `.concat(Ci.TEXTURE_PIXEL_WIDTH,`;
          float dy = yOffset / `).concat(Ci.TEXTURE_PIXEL_HEIGHT,`;
          `).concat(e,`
        }
      `)}var b=Tr(s,t),I=Tr(s,i[1]||0),N=Tr(s,i[2]||0);return"".concat(f_,"(").concat(b,", ").concat(I,", ").concat(N,")")}},Li.time={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,0),"u_time"}},Li.zoom={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,0),"u_zoom"}},Li.resolution={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,0),"u_resolution"}},Li["*"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," * ").concat(Tr(s,i[1]),")")}},Li["/"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," / ").concat(Tr(s,i[1]),")")}},Li["+"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," + ").concat(Tr(s,i[1]),")")}},Li["-"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," - ").concat(Tr(s,i[1]),")")}},Li.clamp={getReturnType:function(s){return _n},toGlsl:function(s,i){Kn(i,3),bo(i);var t=Tr(s,i[1]),e=Tr(s,i[2]);return"clamp(".concat(Tr(s,i[0]),", ").concat(t,", ").concat(e,")")}},Li["%"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"mod(".concat(Tr(s,i[0]),", ").concat(Tr(s,i[1]),")")}},Li["^"]={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,2),bo(i),"pow(".concat(Tr(s,i[0]),", ").concat(Tr(s,i[1]),")")}},Li.abs={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"abs(".concat(Tr(s,i[0]),")")}},Li.floor={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"floor(".concat(Tr(s,i[0]),")")}},Li.round={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"floor(".concat(Tr(s,i[0])," + 0.5)")}},Li.ceil={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"ceil(".concat(Tr(s,i[0]),")")}},Li.sin={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"sin(".concat(Tr(s,i[0]),")")}},Li.cos={getReturnType:function(s){return _n},toGlsl:function(s,i){return Kn(i,1),bo(i),"cos(".concat(Tr(s,i[0]),")")}},Li.atan={getReturnType:function(s){return _n},toGlsl:function(s,i){return pu(i,1),_g(i,2),bo(i),i.length===2?"atan(".concat(Tr(s,i[0]),", ").concat(Tr(s,i[1]),")"):"atan(".concat(Tr(s,i[0]),")")}},Li[">"]={getReturnType:function(s){return za},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," > ").concat(Tr(s,i[1]),")")}},Li[">="]={getReturnType:function(s){return za},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," >= ").concat(Tr(s,i[1]),")")}},Li["<"]={getReturnType:function(s){return za},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," < ").concat(Tr(s,i[1]),")")}},Li["<="]={getReturnType:function(s){return za},toGlsl:function(s,i){return Kn(i,2),bo(i),"(".concat(Tr(s,i[0])," <= ").concat(Tr(s,i[1]),")")}},Li["=="]=d_("=="),Li["!="]=d_("!="),Li["!"]={getReturnType:function(s){return za},toGlsl:function(s,i){return Kn(i,1),by(i[0]),"(!".concat(Tr(s,i[0]),")")}},Li.all=g_("&&"),Li.any=g_("||"),Li.between={getReturnType:function(s){return za},toGlsl:function(s,i){Kn(i,3),bo(i);var t=Tr(s,i[1]),e=Tr(s,i[2]),o=Tr(s,i[0]);return"(".concat(o," >= ").concat(t," && ").concat(o," <= ").concat(e,")")}},Li.array={getReturnType:function(s){return uu},toGlsl:function(s,i){pu(i,2),_g(i,4),bo(i);var t=i.map(function(e){return Tr(s,e,_n)});return"vec".concat(i.length,"(").concat(t.join(", "),")")}},Li.color={getReturnType:function(s){return Wl},toGlsl:function(s,i){pu(i,3),_g(i,4),bo(i);var t=i;i.length===3&&t.push(1);var e=i.map(function(o,l){return Tr(s,o,_n)+(l<3?" / 255.0":"")});return"vec".concat(i.length,"(").concat(e.join(", "),")")}},Li.interpolate={getReturnType:function(s){for(var i=Wl|_n,t=3;t<s.length;t+=2)i&=vl(s[t]);return i},toGlsl:function(s,i,t){p_(i),pu(i,6);var e,o=i[0];switch(o[0]){case"linear":e=1;break;case"exponential":e=o[1];break;default:e=null}if(!e)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(o)));var l=t!==void 0?t:hu,f=Li.interpolate.getReturnType(i)&l;Sy(i,f);for(var y=Tr(s,i[1]),w=Bf(e),b="",I=2;I<i.length-2;I+=2){var N=Tr(s,i[I]),D=b||Tr(s,i[I+1],f),j=Tr(s,i[I+2]),H=Tr(s,i[I+3],f);b="mix(".concat(D,", ").concat(H,", pow(clamp((").concat(y," - ").concat(N,") / (").concat(j," - ").concat(N,"), 0.0, 1.0), ").concat(w,"))")}return b}},Li.match={getReturnType:function(s){for(var i=hu,t=2;t<s.length;t+=2)i&=vl(s[t]);return i&=vl(s[s.length-1])},toGlsl:function(s,i,t){p_(i),pu(i,4);var e=t!==void 0?t:hu,o=Li.match.getReturnType(i)&e;Sy(i,o);for(var l=Tr(s,i[0]),f=Tr(s,i[i.length-1],o),y=null,w=i.length-3;w>=1;w-=2){var b=Tr(s,i[w]),I=Tr(s,i[w+1],o);y="(".concat(l," == ").concat(b," ? ").concat(I," : ").concat(y||f,")")}return y}},Li.case={getReturnType:function(s){for(var i=hu,t=1;t<s.length;t+=2)i&=vl(s[t]);return i&=vl(s[s.length-1])},toGlsl:function(s,i,t){(function(I){if(I.length%2==0)throw new Error("An odd amount of arguments was expected, got ".concat(I," instead"))})(i),pu(i,3);var e=t!==void 0?t:hu,o=Li.case.getReturnType(i)&e;Sy(i,o);for(var l=0;l<i.length-1;l+=2)by(i[l]);var f=Tr(s,i[i.length-1],o),y=null;for(l=i.length-3;l>=0;l-=2){var w=Tr(s,i[l]),b=Tr(s,i[l+1],o);y="(".concat(w," ? ").concat(b," : ").concat(y||f,")")}return y}};var m_=function(){function s(){this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression="vec2(1.0)",this.rotationExpression="0.0",this.offsetExpression="vec2(0.0)",this.colorExpression="vec4(1.0)",this.texCoordExpression="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression="false",this.rotateWithView=!1}return s.prototype.addUniform=function(i){return this.uniforms.push(i),this},s.prototype.addAttribute=function(i){return this.attributes.push(i),this},s.prototype.addVarying=function(i,t,e){return this.varyings.push({name:i,type:t,expression:e}),this},s.prototype.setSizeExpression=function(i){return this.sizeExpression=i,this},s.prototype.setRotationExpression=function(i){return this.rotationExpression=i,this},s.prototype.setSymbolOffsetExpression=function(i){return this.offsetExpression=i,this},s.prototype.setColorExpression=function(i){return this.colorExpression=i,this},s.prototype.setTextureCoordinateExpression=function(i){return this.texCoordExpression=i,this},s.prototype.setFragmentDiscardExpression=function(i){return this.discardExpression=i,this},s.prototype.setSymbolRotateWithView=function(i){return this.rotateWithView=i,this},s.prototype.getSizeExpression=function(){return this.sizeExpression},s.prototype.getOffsetExpression=function(){return this.offsetExpression},s.prototype.getColorExpression=function(){return this.colorExpression},s.prototype.getTextureCoordinateExpression=function(){return this.texCoordExpression},s.prototype.getFragmentDiscardExpression=function(){return this.discardExpression},s.prototype.getSymbolVertexShader=function(i){var t=this.rotateWithView?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix",e=this.attributes,o=this.varyings;return i&&(e=e.concat("vec4 a_hitColor"),o=o.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform mat4 u_projectionMatrix;
uniform mat4 u_offsetScaleMatrix;
uniform mat4 u_offsetRotateMatrix;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
`.concat(this.uniforms.map(function(l){return"uniform "+l+";"}).join(`
`),`
attribute vec2 a_position;
attribute float a_index;
`).concat(e.map(function(l){return"attribute "+l+";"}).join(`
`),`
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
`).concat(o.map(function(l){return"varying "+l.type+" "+l.name+";"}).join(`
`),`
void main(void) {
  mat4 offsetMatrix = `).concat(t,`;
  vec2 halfSize = `).concat(this.sizeExpression,` * 0.5;
  vec2 offset = `).concat(this.offsetExpression,`;
  float angle = `).concat(this.rotationExpression,`;
  float offsetX;
  float offsetY;
  if (a_index == 0.0) {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  } else if (a_index == 1.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);
    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else if (a_index == 2.0) {
    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);
  } else {
    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);
    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);
  }
  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
  vec4 texCoord = `).concat(this.texCoordExpression,`;
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;
  v_quadCoord = vec2(u, v);
`).concat(o.map(function(l){return"  "+l.name+" = "+l.expression+";"}).join(`
`),`
}`)},s.prototype.getSymbolFragmentShader=function(i){var t=i?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"",e=this.varyings;return i&&(e=e.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),`precision mediump float;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
`.concat(this.uniforms.map(function(o){return"uniform "+o+";"}).join(`
`),`
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
`).concat(e.map(function(o){return"varying "+o.type+" "+o.name+";"}).join(`
`),`
void main(void) {
  if (`).concat(this.discardExpression,`) { discard; }
  gl_FragColor = `).concat(this.colorExpression,`;
  gl_FragColor.rgb *= gl_FragColor.a;
`).concat(t,`
}`)},s}();function y_(s){var i=s.symbol,t=i.size!==void 0?i.size:1,e=i.color||"white",o=i.textureCoord||[0,0,1,1],l=i.offset||[0,0],f=i.opacity!==void 0?i.opacity:1,y=i.rotation!==void 0?i.rotation:0,w={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{},functions:{}},b=Tr(w,t,uu|_n),I=Tr(w,l,uu),N=Tr(w,o,uu),D=Tr(w,y,_n),j={inFragmentShader:!0,variables:w.variables,attributes:[],stringLiteralsMap:w.stringLiteralsMap,functions:{}},H=Tr(j,e,Wl),Z=Tr(j,f,_n),it="1.0",at="vec2(".concat(Tr(j,t,uu|_n),").x");switch(i.symbolType){case"square":case"image":break;case"circle":it="(1.0-smoothstep(1.-4./".concat(at,",1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))");break;case"triangle":var wt="(v_quadCoord*2.-1.)",gt="(atan(".concat(wt,".x,").concat(wt,".y))");it="(1.0-smoothstep(.5-3./".concat(at,",.5,cos(floor(.5+").concat(gt,"/2.094395102)*2.094395102-").concat(gt,")*length(").concat(wt,")))");break;default:throw new Error("Unexpected symbol type: "+i.symbolType)}var yt=new m_().setSizeExpression("vec2(".concat(b,")")).setRotationExpression(D).setSymbolOffsetExpression(I).setTextureCoordinateExpression(N).setSymbolRotateWithView(!!i.rotateWithView).setColorExpression("vec4(".concat(H,".rgb, ").concat(H,".a * ").concat(Z," * ").concat(it,")"));if(s.filter){var It=Tr(j,s.filter,za);yt.setFragmentDiscardExpression("!".concat(It))}var Rt={};if(j.variables.forEach(function(Dt){var Xt=xg(Dt);yt.addUniform("float ".concat(Xt)),Rt[Xt]=function(){if(!s.variables||s.variables[Dt]===void 0)throw new Error("The following variable is missing from the style: ".concat(Dt));var ee=s.variables[Dt];return typeof ee=="string"&&(ee=zf(w,ee)),ee!==void 0?ee:-9999999}}),i.symbolType==="image"&&i.src){var kt=new Image;kt.crossOrigin=i.crossOrigin===void 0?"anonymous":i.crossOrigin,kt.src=i.src,yt.addUniform("sampler2D u_texture").setColorExpression(yt.getColorExpression()+" * texture2D(u_texture, v_texCoord)"),Rt.u_texture=kt}return j.attributes.forEach(function(Dt){w.attributes.indexOf(Dt)===-1&&w.attributes.push(Dt),yt.addVarying("v_".concat(Dt),"float","a_".concat(Dt))}),w.attributes.forEach(function(Dt){yt.addAttribute("float a_".concat(Dt))}),{builder:yt,attributes:w.attributes.map(function(Dt){return{name:Dt,callback:function(Xt,ee){var pe=ee[Dt];return typeof pe=="string"&&(pe=zf(w,pe)),pe!==void 0?pe:-9999999}}}),uniforms:Rt}}var lC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),v_=function(s){function i(t){var e=s.call(this,{extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes})||this;return e.eu=t.matrixIds,e}return lC(i,s),i.prototype.getMatrixId=function(t){return this.eu[t]},i.prototype.getMatrixIds=function(){return this.eu},i}(ql),cC=v_;function __(s,i,t){var e=[],o=[],l=[],f=[],y=[],w=t!==void 0?t:[],b=ie(s.SupportedCRS),I=b.getMetersPerUnit(),N=b.getAxisOrientation().substr(0,2)=="ne";return s.TileMatrix.sort(function(D,j){return j.ScaleDenominator-D.ScaleDenominator}),s.TileMatrix.forEach(function(D){if(!(w.length>0)||ft(w,function(it){return D.Identifier==it.TileMatrix||D.Identifier.indexOf(":")===-1&&s.Identifier+":"+D.Identifier===it.TileMatrix})){o.push(D.Identifier);var j=28e-5*D.ScaleDenominator/I,H=D.TileWidth,Z=D.TileHeight;N?l.push([D.TopLeftCorner[1],D.TopLeftCorner[0]]):l.push(D.TopLeftCorner),e.push(j),f.push(H==Z?H:[H,Z]),y.push([D.MatrixWidth,D.MatrixHeight])}}),new v_({extent:i,origins:l,resolutions:e,matrixIds:o,tileSizes:f,sizes:y})}var Cy=function(){function s(i){this.ou=i.opacity,this.su=i.rotateWithView,this.Dr=i.rotation,this.uu=i.scale,this.au=Pn(i.scale),this.hu=i.displacement,this.fu=i.declutterMode}return s.prototype.clone=function(){var i=this.getScale();return new s({opacity:this.getOpacity(),scale:Array.isArray(i)?i.slice():i,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})},s.prototype.getOpacity=function(){return this.ou},s.prototype.getRotateWithView=function(){return this.su},s.prototype.getRotation=function(){return this.Dr},s.prototype.getScale=function(){return this.uu},s.prototype.getScaleArray=function(){return this.au},s.prototype.getDisplacement=function(){return this.hu},s.prototype.getDeclutterMode=function(){return this.fu},s.prototype.getAnchor=function(){return E()},s.prototype.getImage=function(i){return E()},s.prototype.getHitDetectionImage=function(){return E()},s.prototype.getPixelRatio=function(i){return 1},s.prototype.getImageState=function(){return E()},s.prototype.getImageSize=function(){return E()},s.prototype.getOrigin=function(){return E()},s.prototype.getSize=function(){return E()},s.prototype.setDisplacement=function(i){this.hu=i},s.prototype.setOpacity=function(i){this.ou=i},s.prototype.setRotateWithView=function(i){this.su=i},s.prototype.setRotation=function(i){this.Dr=i},s.prototype.setScale=function(i){this.uu=i,this.au=Pn(i)},s.prototype.listenImageChange=function(i){E()},s.prototype.load=function(){E()},s.prototype.unlistenImageChange=function(i){E()},s}(),uC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),x_=function(s){function i(t){var e=this,o=t.rotateWithView!==void 0&&t.rotateWithView;return(e=s.call(this,{opacity:1,rotateWithView:o,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})||this).qt=void 0,e.cu=null,e.lu=t.fill!==void 0?t.fill:null,e._o=[0,0],e.Zt=t.points,e.vu=t.radius!==void 0?t.radius:t.radius1,e.du=t.radius2,e.$t=t.angle!==void 0?t.angle:0,e.pu=t.stroke!==void 0?t.stroke:null,e.W=null,e.yu=null,e.render(),e}return uC(i,s),i.prototype.clone=function(){var t=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e},i.prototype.getAnchor=function(){var t=this.W;if(!t)return null;var e=this.getDisplacement();return[t[0]/2-e[0],t[1]/2+e[1]]},i.prototype.getAngle=function(){return this.$t},i.prototype.getFill=function(){return this.lu},i.prototype.setFill=function(t){this.lu=t,this.render()},i.prototype.getHitDetectionImage=function(){return this.cu||this.mu(this.yu),this.cu},i.prototype.getImage=function(t){var e=this.qt[t];if(!e){var o=this.yu,l=Cn(o.size*t,o.size*t);this.wu(o,l,t),e=l.canvas,this.qt[t]=e}return e},i.prototype.getPixelRatio=function(t){return t},i.prototype.getImageSize=function(){return this.W},i.prototype.getImageState=function(){return Nn},i.prototype.getOrigin=function(){return this._o},i.prototype.getPoints=function(){return this.Zt},i.prototype.getRadius=function(){return this.vu},i.prototype.getRadius2=function(){return this.du},i.prototype.getSize=function(){return this.W},i.prototype.getStroke=function(){return this.pu},i.prototype.setStroke=function(t){this.pu=t,this.render()},i.prototype.listenImageChange=function(t){},i.prototype.load=function(){},i.prototype.unlistenImageChange=function(t){},i.prototype.gu=function(t,e,o){if(e===0||this.Zt===1/0||t!=="bevel"&&t!=="miter")return e;var l=this.vu,f=this.du===void 0?l:this.du;if(l<f){var y=l;l=f,f=y}var w=this.du===void 0?this.Zt:2*this.Zt,b=2*Math.PI/w,I=f*Math.sin(b),N=l-Math.sqrt(f*f-I*I),D=Math.sqrt(I*I+N*N),j=D/I;if(t==="miter"&&j<=o)return j*e;var H=e/2/j,Z=e/2*(N/D),it=Math.sqrt((l+H)*(l+H)+Z*Z)-l;if(this.du===void 0||t==="bevel")return 2*it;var at=l*Math.sin(b),wt=f-Math.sqrt(l*l-at*at),gt=Math.sqrt(at*at+wt*wt)/at;if(gt<=o){var yt=gt*e/2-f-l;return 2*Math.max(it,yt)}return 2*it},i.prototype.createRenderOptions=function(){var t,e=Fa,o=0,l=null,f=0,y=0;this.pu&&((t=this.pu.getColor())===null&&(t=Ps),t=gl(t),(y=this.pu.getWidth())===void 0&&(y=1),l=this.pu.getLineDash(),f=this.pu.getLineDashOffset(),(e=this.pu.getLineJoin())===void 0&&(e=Fa),(o=this.pu.getMiterLimit())===void 0&&(o=Da));var w=this.gu(e,y,o),b=Math.max(this.vu,this.du||0);return{strokeStyle:t,strokeWidth:y,size:Math.ceil(2*b+w),lineDash:l,lineDashOffset:f,lineJoin:e,miterLimit:o}},i.prototype.render=function(){this.yu=this.createRenderOptions();var t=this.yu.size;this.qt={},this.W=[t,t]},i.prototype.wu=function(t,e,o){if(e.scale(o,o),e.translate(t.size/2,t.size/2),this.bu(e),this.lu){var l=this.lu.getColor();l===null&&(l=Xs),e.fillStyle=gl(l),e.fill()}this.pu&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},i.prototype.mu=function(t){if(this.lu){var e=this.lu.getColor(),o=0;if(typeof e=="string"&&(e=Ra(e)),e===null?o=1:Array.isArray(e)&&(o=e.length===4?e[3]:1),o===0){var l=Cn(t.size,t.size);this.cu=l.canvas,this.xu(t,l)}}this.cu||(this.cu=this.getImage(1))},i.prototype.bu=function(t){var e=this.Zt,o=this.vu;if(e===1/0)t.arc(0,0,o,0,2*Math.PI);else{var l=this.du===void 0?o:this.du;this.du!==void 0&&(e*=2);for(var f=this.$t-Math.PI/2,y=2*Math.PI/e,w=0;w<e;w++){var b=f+w*y,I=w%2==0?o:l;t.lineTo(I*Math.cos(b),I*Math.sin(b))}t.closePath()}},i.prototype.xu=function(t,e){e.translate(t.size/2,t.size/2),this.bu(e),e.fillStyle=Xs,e.fill(),this.pu&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())},i}(Cy),hC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),wg=function(s){function i(t){var e=t||{};return s.call(this,{points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0&&e.rotateWithView,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})||this}return hC(i,s),i.prototype.clone=function(){var t=this.getScale(),e=new i({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e},i.prototype.setRadius=function(t){this.vu=t,this.render()},i}(x_),Zs=function(){function s(i){var t=i||{};this.Mu=t.color!==void 0?t.color:null}return s.prototype.clone=function(){var i=this.getColor();return new s({color:Array.isArray(i)?i.slice():i||void 0})},s.prototype.getColor=function(){return this.Mu},s.prototype.setColor=function(i){this.Mu=i},s}(),xh="fraction",fu="pixels",Cp="bottom-left",Vf="bottom-right",Uf="top-left",Ty="top-right",pC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),qf=null,w_=function(s){function i(t,e,o,l,f,y){var w=s.call(this)||this;return w._u=null,w.Lt=t||new Image,l!==null&&(w.Lt.crossOrigin=l),w.qt={},w.Mu=y,w.zt=null,w.Su=f,w.W=o,w.Nt=e,w.Ou,w}return pC(i,s),i.prototype.ju=function(){if(this.Ou===void 0&&this.Su===Nn){qf||(qf=Cn(1,1)),qf.drawImage(this.Lt,0,0);try{qf.getImageData(0,0,1,1),this.Ou=!1}catch{qf=null,this.Ou=!0}}return this.Ou===!0},i.prototype.Eu=function(){this.dispatchEvent(ne)},i.prototype.Ft=function(){this.Su=ca,this.Gt(),this.Eu()},i.prototype.Dt=function(){this.Su=Nn,this.W?(this.Lt.width=this.W[0],this.Lt.height=this.W[1]):this.W=[this.Lt.width,this.Lt.height],this.Gt(),this.Eu()},i.prototype.getImage=function(t){return this.Tu(t),this.qt[t]?this.qt[t]:this.Lt},i.prototype.getPixelRatio=function(t){return this.Tu(t),this.qt[t]?t:1},i.prototype.getImageState=function(){return this.Su},i.prototype.getHitDetectionImage=function(){if(!this._u)if(this.ju()){var t=this.W[0],e=this.W[1],o=Cn(t,e);o.fillRect(0,0,t,e),this._u=o.canvas}else this._u=this.Lt;return this._u},i.prototype.getSize=function(){return this.W},i.prototype.getSrc=function(){return this.Nt},i.prototype.load=function(){if(this.Su==co){this.Su=Oa;try{this.Lt.src=this.Nt}catch{this.Ft()}this.zt=Ku(this.Lt,this.Dt.bind(this),this.Ft.bind(this))}},i.prototype.Tu=function(t){if(this.Mu&&!this.qt[t]&&this.Su===Nn){var e=document.createElement("canvas");this.qt[t]=e,e.width=Math.ceil(this.Lt.width*t),e.height=Math.ceil(this.Lt.height*t);var o=e.getContext("2d");if(o.scale(t,t),o.drawImage(this.Lt,0,0),o.globalCompositeOperation="multiply",o.globalCompositeOperation==="multiply"||this.ju())o.fillStyle=Pi(this.Mu),o.fillRect(0,0,e.width/t,e.height/t),o.globalCompositeOperation="destination-in",o.drawImage(this.Lt,0,0);else{for(var l=o.getImageData(0,0,e.width,e.height),f=l.data,y=this.Mu[0]/255,w=this.Mu[1]/255,b=this.Mu[2]/255,I=this.Mu[3],N=0,D=f.length;N<D;N+=4)f[N]*=y,f[N+1]*=w,f[N+2]*=b,f[N+3]*=I;o.putImageData(l,0,0)}}},i.prototype.Gt=function(){this.zt&&(this.zt(),this.zt=null)},i}(ue);function b_(s,i,t,e,o,l){var f=Al.get(i,e,l);return f||(f=new w_(s,i,t,e,o,l),Al.set(i,e,l,f)),f}var fC=w_,dC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Hf=function(s){function i(t){var e=this,o=t||{},l=o.opacity!==void 0?o.opacity:1,f=o.rotation!==void 0?o.rotation:0,y=o.scale!==void 0?o.scale:1,w=o.rotateWithView!==void 0&&o.rotateWithView;(e=s.call(this,{opacity:l,rotation:f,scale:y,displacement:o.displacement!==void 0?o.displacement:[0,0],rotateWithView:w,declutterMode:o.declutterMode})||this).xe=o.anchor!==void 0?o.anchor:[.5,.5],e.Au=null,e.Pu=o.anchorOrigin!==void 0?o.anchorOrigin:Uf,e.Cu=o.anchorXUnits!==void 0?o.anchorXUnits:xh,e.ku=o.anchorYUnits!==void 0?o.anchorYUnits:xh,e.Bt=o.crossOrigin!==void 0?o.crossOrigin:null;var b=o.img!==void 0?o.img:null;e.Iu=o.imgSize;var I=o.src;Me(!(I!==void 0&&b),4),Me(!b||b&&e.Iu,5),I!==void 0&&I.length!==0||!b||(I=b.src||L(b)),Me(I!==void 0&&I.length>0,6);var N=o.src!==void 0?co:Nn;return e.Mu=o.color!==void 0?Ra(o.color):null,e.Nu=b_(b,I,e.Iu!==void 0?e.Iu:null,e.Bt,N,e.Mu),e.Lu=o.offset!==void 0?o.offset:[0,0],e.zu=o.offsetOrigin!==void 0?o.offsetOrigin:Uf,e._o=null,e.W=o.size!==void 0?o.size:null,e}return dC(i,s),i.prototype.clone=function(){var t=this.getScale();return new i({anchor:this.xe.slice(),anchorOrigin:this.Pu,anchorXUnits:this.Cu,anchorYUnits:this.ku,color:this.Mu&&this.Mu.slice?this.Mu.slice():this.Mu||void 0,crossOrigin:this.Bt,imgSize:this.Iu,offset:this.Lu.slice(),offsetOrigin:this.zu,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:this.W!==null?this.W.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})},i.prototype.getAnchor=function(){var t=this.Au;if(!t){t=this.xe;var e=this.getSize();if(this.Cu==xh||this.ku==xh){if(!e)return null;t=this.xe.slice(),this.Cu==xh&&(t[0]*=e[0]),this.ku==xh&&(t[1]*=e[1])}if(this.Pu!=Uf){if(!e)return null;t===this.xe&&(t=this.xe.slice()),this.Pu!=Ty&&this.Pu!=Vf||(t[0]=-t[0]+e[0]),this.Pu!=Cp&&this.Pu!=Vf||(t[1]=-t[1]+e[1])}this.Au=t}var o=this.getDisplacement();return[t[0]-o[0],t[1]+o[1]]},i.prototype.setAnchor=function(t){this.xe=t,this.Au=null},i.prototype.getColor=function(){return this.Mu},i.prototype.getImage=function(t){return this.Nu.getImage(t)},i.prototype.getPixelRatio=function(t){return this.Nu.getPixelRatio(t)},i.prototype.getImageSize=function(){return this.Nu.getSize()},i.prototype.getImageState=function(){return this.Nu.getImageState()},i.prototype.getHitDetectionImage=function(){return this.Nu.getHitDetectionImage()},i.prototype.getOrigin=function(){if(this._o)return this._o;var t=this.Lu;if(this.zu!=Uf){var e=this.getSize(),o=this.Nu.getSize();if(!e||!o)return null;t=t.slice(),this.zu!=Ty&&this.zu!=Vf||(t[0]=o[0]-e[0]-t[0]),this.zu!=Cp&&this.zu!=Vf||(t[1]=o[1]-e[1]-t[1])}return this._o=t,this._o},i.prototype.getSrc=function(){return this.Nu.getSrc()},i.prototype.getSize=function(){return this.W?this.W:this.Nu.getSize()},i.prototype.listenImageChange=function(t){this.Nu.addEventListener(ne,t)},i.prototype.load=function(){this.Nu.load()},i.prototype.unlistenImageChange=function(t){this.Nu.removeEventListener(ne,t)},i}(Cy),Fs=function(){function s(i){var t=i||{};this.Mu=t.color!==void 0?t.color:null,this.Ru=t.lineCap,this.Fu=t.lineDash!==void 0?t.lineDash:null,this.Gu=t.lineDashOffset,this.Du=t.lineJoin,this.qu=t.miterLimit,this.Uu=t.width}return s.prototype.clone=function(){var i=this.getColor();return new s({color:Array.isArray(i)?i.slice():i||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},s.prototype.getColor=function(){return this.Mu},s.prototype.getLineCap=function(){return this.Ru},s.prototype.getLineDash=function(){return this.Fu},s.prototype.getLineDashOffset=function(){return this.Gu},s.prototype.getLineJoin=function(){return this.Du},s.prototype.getMiterLimit=function(){return this.qu},s.prototype.getWidth=function(){return this.Uu},s.prototype.setColor=function(i){this.Mu=i},s.prototype.setLineCap=function(i){this.Ru=i},s.prototype.setLineDash=function(i){this.Fu=i},s.prototype.setLineDashOffset=function(i){this.Gu=i},s.prototype.setLineJoin=function(i){this.Du=i},s.prototype.setMiterLimit=function(i){this.qu=i},s.prototype.setWidth=function(i){this.Uu=i},s}(),Tp=function(){function s(i){var t=i||{};this.Hr=null,this.Bu=C_,t.geometry!==void 0&&this.setGeometry(t.geometry),this.lu=t.fill!==void 0?t.fill:null,this.Lt=t.image!==void 0?t.image:null,this.hn=t.renderer!==void 0?t.renderer:null,this.Xu=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.pu=t.stroke!==void 0?t.stroke:null,this.eo=t.text!==void 0?t.text:null,this.Vu=t.zIndex}return s.prototype.clone=function(){var i=this.getGeometry();return i&&typeof i=="object"&&(i=i.clone()),new s({geometry:i,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},s.prototype.getRenderer=function(){return this.hn},s.prototype.setRenderer=function(i){this.hn=i},s.prototype.setHitDetectionRenderer=function(i){this.Xu=i},s.prototype.getHitDetectionRenderer=function(){return this.Xu},s.prototype.getGeometry=function(){return this.Hr},s.prototype.getGeometryFunction=function(){return this.Bu},s.prototype.getFill=function(){return this.lu},s.prototype.setFill=function(i){this.lu=i},s.prototype.getImage=function(){return this.Lt},s.prototype.setImage=function(i){this.Lt=i},s.prototype.getStroke=function(){return this.pu},s.prototype.setStroke=function(i){this.pu=i},s.prototype.getText=function(){return this.eo},s.prototype.setText=function(i){this.eo=i},s.prototype.getZIndex=function(){return this.Vu},s.prototype.setGeometry=function(i){typeof i=="function"?this.Bu=i:typeof i=="string"?this.Bu=function(t){return t.get(i)}:i?i!==void 0&&(this.Bu=function(){return i}):this.Bu=C_,this.Hr=i},s.prototype.setZIndex=function(i){this.Vu=i},s}();function S_(s){var i;if(typeof s=="function")i=s;else{var t;Array.isArray(s)?t=s:(Me(typeof s.getZIndex=="function",41),t=[s]),i=function(){return t}}return i}var Py=null;function E_(s,i){if(!Py){var t=new Zs({color:"rgba(255,255,255,0.4)"}),e=new Fs({color:"#3399CC",width:1.25});Py=[new Tp({image:new wg({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Py}function Pp(){var s={},i=[255,255,255,1],t=[0,153,255,1];return s.Polygon=[new Tp({fill:new Zs({color:[255,255,255,.5]})})],s.MultiPolygon=s.Polygon,s.LineString=[new Tp({stroke:new Fs({color:i,width:5})}),new Tp({stroke:new Fs({color:t,width:3})})],s.MultiLineString=s.LineString,s.Circle=s.Polygon.concat(s.LineString),s.Point=[new Tp({image:new wg({radius:6,fill:new Zs({color:t}),stroke:new Fs({color:i,width:1.5})}),zIndex:1/0})],s.MultiPoint=s.Point,s.GeometryCollection=s.Polygon.concat(s.LineString,s.Point),s}function C_(s){return s.getGeometry()}var ds=Tp,gC="point",mC="line",Ip=function(){function s(i){var t=i||{};this.Wu=t.font,this.Dr=t.rotation,this.su=t.rotateWithView,this.uu=t.scale,this.au=Pn(t.scale!==void 0?t.scale:1),this.eo=t.text,this.Yu=t.textAlign,this.Zu=t.justify,this.$u=t.textBaseline,this.lu=t.fill!==void 0?t.fill:new Zs({color:"#333"}),this.Ku=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.Hu=t.placement!==void 0?t.placement:gC,this.Ju=!!t.overflow,this.pu=t.stroke!==void 0?t.stroke:null,this.Qu=t.offsetX!==void 0?t.offsetX:0,this.ta=t.offsetY!==void 0?t.offsetY:0,this.na=t.backgroundFill?t.backgroundFill:null,this.ia=t.backgroundStroke?t.backgroundStroke:null,this.Ai=t.padding===void 0?null:t.padding}return s.prototype.clone=function(){var i=this.getScale();return new s({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(i)?i.slice():i,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},s.prototype.getOverflow=function(){return this.Ju},s.prototype.getFont=function(){return this.Wu},s.prototype.getMaxAngle=function(){return this.Ku},s.prototype.getPlacement=function(){return this.Hu},s.prototype.getOffsetX=function(){return this.Qu},s.prototype.getOffsetY=function(){return this.ta},s.prototype.getFill=function(){return this.lu},s.prototype.getRotateWithView=function(){return this.su},s.prototype.getRotation=function(){return this.Dr},s.prototype.getScale=function(){return this.uu},s.prototype.getScaleArray=function(){return this.au},s.prototype.getStroke=function(){return this.pu},s.prototype.getText=function(){return this.eo},s.prototype.getTextAlign=function(){return this.Yu},s.prototype.getJustify=function(){return this.Zu},s.prototype.getTextBaseline=function(){return this.$u},s.prototype.getBackgroundFill=function(){return this.na},s.prototype.getBackgroundStroke=function(){return this.ia},s.prototype.getPadding=function(){return this.Ai},s.prototype.setOverflow=function(i){this.Ju=i},s.prototype.setFont=function(i){this.Wu=i},s.prototype.setMaxAngle=function(i){this.Ku=i},s.prototype.setOffsetX=function(i){this.Qu=i},s.prototype.setOffsetY=function(i){this.ta=i},s.prototype.setPlacement=function(i){this.Hu=i},s.prototype.setRotateWithView=function(i){this.su=i},s.prototype.setFill=function(i){this.lu=i},s.prototype.setRotation=function(i){this.Dr=i},s.prototype.setScale=function(i){this.uu=i,this.au=Pn(i!==void 0?i:1)},s.prototype.setStroke=function(i){this.pu=i},s.prototype.setText=function(i){this.eo=i},s.prototype.setTextAlign=function(i){this.Yu=i},s.prototype.setJustify=function(i){this.Zu=i},s.prototype.setTextBaseline=function(i){this.$u=i},s.prototype.setBackgroundFill=function(i){this.na=i},s.prototype.setBackgroundStroke=function(i){this.ia=i},s.prototype.setPadding=function(i){this.Ai=i},s}(),yC=function(){function s(i){this.ra,this.ea,this.oa,this.sa=i===void 0||i,this.ua=0}return s.prototype.insertItem=function(i){var t={prev:void 0,next:void 0,data:i},e=this.oa;if(e){var o=e.next;t.prev=e,t.next=o,e.next=t,o&&(o.prev=t),e===this.ea&&(this.ea=t)}else this.ra=t,this.ea=t,this.sa&&(t.next=t,t.prev=t);this.oa=t,this.ua++},s.prototype.removeItem=function(){var i=this.oa;if(i){var t=i.next,e=i.prev;t&&(t.prev=e),e&&(e.next=t),this.oa=t||e,this.ra===this.ea?(this.oa=void 0,this.ra=void 0,this.ea=void 0):this.ra===i?this.ra=this.oa:this.ea===i&&(this.ea=e?this.oa.prev:this.oa),this.ua--}},s.prototype.firstItem=function(){if(this.oa=this.ra,this.oa)return this.oa.data},s.prototype.lastItem=function(){if(this.oa=this.ea,this.oa)return this.oa.data},s.prototype.nextItem=function(){if(this.oa&&this.oa.next)return this.oa=this.oa.next,this.oa.data},s.prototype.getNextItem=function(){if(this.oa&&this.oa.next)return this.oa.next.data},s.prototype.prevItem=function(){if(this.oa&&this.oa.prev)return this.oa=this.oa.prev,this.oa.data},s.prototype.getPrevItem=function(){if(this.oa&&this.oa.prev)return this.oa.prev.data},s.prototype.getCurrItem=function(){if(this.oa)return this.oa.data},s.prototype.setFirstItem=function(){this.sa&&this.oa&&(this.ra=this.oa,this.ea=this.oa.prev)},s.prototype.concat=function(i){if(i.oa){if(this.oa){var t=this.oa.next;this.oa.next=i.ra,i.ra.prev=this.oa,t.prev=i.ea,i.ea.next=t,this.ua+=i.ua}else this.oa=i.oa,this.ra=i.ra,this.ea=i.ea,this.ua=i.ua;i.oa=void 0,i.ra=void 0,i.ea=void 0,i.ua=0}},s.prototype.getLength=function(){return this.ua},s}(),Iy=x(72),Xf=function(){function s(i){this.aa=new Iy(i),this.ha={}}return s.prototype.insert=function(i,t){var e={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],value:t};this.aa.insert(e),this.ha[L(t)]=e},s.prototype.load=function(i,t){for(var e=new Array(t.length),o=0,l=t.length;o<l;o++){var f=i[o],y=t[o],w={minX:f[0],minY:f[1],maxX:f[2],maxY:f[3],value:y};e[o]=w,this.ha[L(y)]=w}this.aa.load(e)},s.prototype.remove=function(i){var t=L(i),e=this.ha[t];return delete this.ha[t],this.aa.remove(e)!==null},s.prototype.update=function(i,t){var e=this.ha[L(t)];ko([e.minX,e.minY,e.maxX,e.maxY],i)||(this.remove(t),this.insert(i,t))},s.prototype.getAll=function(){return this.aa.all().map(function(i){return i.value})},s.prototype.getInExtent=function(i){var t={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]};return this.aa.search(t).map(function(e){return e.value})},s.prototype.forEach=function(i){return this.fa(this.getAll(),i)},s.prototype.forEachInExtent=function(i,t){return this.fa(this.getInExtent(i),t)},s.prototype.fa=function(i,t){for(var e,o=0,l=i.length;o<l;o++)if(e=t(i[o]))return e;return e},s.prototype.isEmpty=function(){return ge(this.ha)},s.prototype.clear=function(){this.aa.clear(),this.ha={}},s.prototype.getExtent=function(i){var t=this.aa.toJSON();return En(t.minX,t.minY,t.maxX,t.maxY,i)},s.prototype.concat=function(i){for(var t in this.aa.load(i.aa.all()),i.ha)this.ha[t]=i.ha[t]},s}(),T_="tileloadstart",P_="tileloadend",I_="tileloaderror",vC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function M_(s){return s?Array.isArray(s)?function(i){return s}:typeof s=="function"?s:function(i){return[s]}:null}var Mp=function(s){function i(t){var e=s.call(this)||this;e.projection=ie(t.projection),e.ca=M_(t.attributions),e.la=t.attributionsCollapsible===void 0||t.attributionsCollapsible,e.loading=!1,e.rn=t.state!==void 0?t.state:"ready",e.va=t.wrapX!==void 0&&t.wrapX,e.da=!!t.interpolate,e.viewResolver=null,e.viewRejector=null;var o=e;return e.pa=new Promise(function(l,f){o.viewResolver=l,o.viewRejector=f}),e}return vC(i,s),i.prototype.getAttributions=function(){return this.ca},i.prototype.getAttributionsCollapsible=function(){return this.la},i.prototype.getProjection=function(){return this.projection},i.prototype.getResolutions=function(){return E()},i.prototype.getView=function(){return this.pa},i.prototype.getState=function(){return this.rn},i.prototype.getWrapX=function(){return this.va},i.prototype.getInterpolate=function(){return this.da},i.prototype.refresh=function(){this.changed()},i.prototype.setAttributions=function(t){this.ca=M_(t),this.changed()},i.prototype.setState=function(t){this.rn=t,this.changed()},i}(cn),L_=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),_C=function(s){function i(t){var e=s.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;return e.on,e.once,e.un,e.ya=t.opaque!==void 0&&t.opaque,e.ma=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,e.tileGrid=t.tileGrid!==void 0?t.tileGrid:null,e.tileGrid&&Pn(e.tileGrid.getTileSize(e.tileGrid.getMinZoom()),[256,256]),e.tileCache=new ig(t.cacheSize||0),e.tmpSize=[0,0],e.ke=t.key||"",e.tileOptions={transition:t.transition,interpolate:t.interpolate},e.zDirection=t.zDirection?t.zDirection:0,e}return L_(i,s),i.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},i.prototype.expireCache=function(t,e){var o=this.getTileCacheForProjection(t);o&&o.expireCache(e)},i.prototype.forEachLoadedTile=function(t,e,o,l){var f=this.getTileCacheForProjection(t);if(!f)return!1;for(var y,w,b,I=!0,N=o.minX;N<=o.maxX;++N)for(var D=o.minY;D<=o.maxY;++D)w=Ul(e,N,D),b=!1,f.containsKey(w)&&(b=(y=f.get(w)).getState()===Oe)&&(b=l(y)!==!1),b||(I=!1);return I},i.prototype.getGutterForProjection=function(t){return 0},i.prototype.getKey=function(){return this.ke},i.prototype.setKey=function(t){this.ke!==t&&(this.ke=t,this.changed())},i.prototype.getOpaque=function(t){return this.ya},i.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},i.prototype.getTile=function(t,e,o,l,f){return E()},i.prototype.getTileGrid=function(){return this.tileGrid},i.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:ay(t)},i.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return Me(e===null||an(e,t),68),this.tileCache},i.prototype.getTilePixelRatio=function(t){return this.ma},i.prototype.getTilePixelSize=function(t,e,o){var l=this.getTileGridForProjection(o),f=this.getTilePixelRatio(e),y=Pn(l.getTileSize(t),this.tmpSize);return f==1?y:gh(y,f,this.tmpSize)},i.prototype.getTileCoordForTileUrlFunction=function(t,e){var o=e!==void 0?e:this.getProjection(),l=this.getTileGridForProjection(o);return this.getWrapX()&&o.isGlobal()&&(t=F1(l,t,o)),_1(t,l)?t:null},i.prototype.clear=function(){this.tileCache.clear()},i.prototype.refresh=function(){this.clear(),s.prototype.refresh.call(this)},i.prototype.updateCacheSize=function(t,e){var o=this.getTileCacheForProjection(e);t>o.highWaterMark&&(o.highWaterMark=t)},i.prototype.useTile=function(t,e,o,l){},i}(Mp),My=function(s){function i(t,e){var o=s.call(this,t)||this;return o.tile=e,o}return L_(i,s),i}(O),Wf=_C,xC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ly=function(s){function i(t){var e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return e.wa=e.tileUrlFunction===i.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.ga={},e}return xC(i,s),i.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},i.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},i.prototype.getUrls=function(){return this.urls},i.prototype.handleTileChange=function(t){var e,o=t.target,l=L(o),f=o.getState();f==br?(this.ga[l]=!0,e=T_):l in this.ga&&(delete this.ga[l],e=f==ur?I_:f==Oe?P_:void 0),e!=null&&this.dispatchEvent(new My(e,o))},i.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},i.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),e!==void 0?this.setKey(e):this.changed()},i.prototype.setUrl=function(t){var e=cg(t);this.urls=e,this.setUrls(e)},i.prototype.setUrls=function(t){this.urls=t;var e=t.join(`
`);this.wa?this.setTileUrlFunction(lg(t,this.tileGrid),e):this.setKey(e)},i.prototype.tileUrlFunction=function(t,e,o){},i.prototype.useTile=function(t,e,o){var l=Ul(t,e,o);this.tileCache.containsKey(l)&&this.tileCache.get(l)},i}(Wf),wC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function bC(s,i){s.getImage().src=i}var Yl=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(o=t.interpolate),(e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:bC,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:o,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this).crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,e.tileClass=t.tileClass!==void 0?t.tileClass:fc,e.tileCacheForProjection={},e.tileGridForProjection={},e.ba=t.reprojectionErrorThreshold,e.xa=!1,e}return wC(i,s),i.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},i.prototype.expireCache=function(t,e){var o=this.getTileCacheForProjection(t);for(var l in this.tileCache.expireCache(this.tileCache==o?e:{}),this.tileCacheForProjection){var f=this.tileCacheForProjection[l];f.expireCache(f==o?e:{})}},i.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!an(this.getProjection(),t)?0:this.getGutter()},i.prototype.getGutter=function(){return 0},i.prototype.getKey=function(){var t=s.prototype.getKey.call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t},i.prototype.getOpaque=function(t){return!(this.getProjection()&&t&&!an(this.getProjection(),t))&&s.prototype.getOpaque.call(this,t)},i.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!an(e,t)){var o=L(t);return o in this.tileGridForProjection||(this.tileGridForProjection[o]=ay(t)),this.tileGridForProjection[o]}return this.tileGrid},i.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||an(e,t))return this.tileCache;var o=L(t);return o in this.tileCacheForProjection||(this.tileCacheForProjection[o]=new ig(this.tileCache.highWaterMark)),this.tileCacheForProjection[o]},i.prototype.Ma=function(t,e,o,l,f,y){var w=[t,e,o],b=this.getTileCoordForTileUrlFunction(w,f),I=b?this.tileUrlFunction(b,l,f):void 0,N=new this.tileClass(w,I!==void 0?Er:ar,I!==void 0?I:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return N.key=y,N.addEventListener(ne,this.handleTileChange.bind(this)),N},i.prototype.getTile=function(t,e,o,l,f){var y=this.getProjection();if(y&&f&&!an(y,f)){var w=this.getTileCacheForProjection(f),b=[t,e,o],I=void 0,N=vp(b);w.containsKey(N)&&(I=w.get(N));var D=this.getKey();if(I&&I.key==D)return I;var j=this.getTileGridForProjection(y),H=this.getTileGridForProjection(f),Z=this.getTileCoordForTileUrlFunction(b,f),it=new yg(y,j,f,H,b,Z,this.getTilePixelRatio(l),this.getGutter(),function(at,wt,gt,yt){return this.getTileInternal(at,wt,gt,yt,y)}.bind(this),this.ba,this.xa,this.getInterpolate());return it.key=D,I?(it.interimTile=I,it.refreshInterimChain(),w.replace(N,it)):w.set(N,it),it}return this.getTileInternal(t,e,o,l,y||f)},i.prototype.getTileInternal=function(t,e,o,l,f){var y=null,w=Ul(t,e,o),b=this.getKey();if(this.tileCache.containsKey(w)){if((y=this.tileCache.get(w)).key!=b){var I=y;y=this.Ma(t,e,o,l,f,b),I.getState()==Er?y.interimTile=I.interimTile:y.interimTile=I,y.refreshInterimChain(),this.tileCache.replace(w,y)}}else y=this.Ma(t,e,o,l,f,b),this.tileCache.set(w,y);return y},i.prototype.setRenderReprojectionEdges=function(t){if(this.xa!=t){for(var e in this.xa=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},i.prototype.setTileGridForProjection=function(t,e){var o=ie(t);if(o){var l=L(o);l in this.tileGridForProjection||(this.tileGridForProjection[l]=e)}},i}(Ly),SC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function A_(s){var i,t,e=s[0],o=new Array(e),l=1<<e-1;for(i=0;i<e;++i)t=48,s[1]&l&&(t+=1),s[2]&l&&(t+=2),o[i]=String.fromCharCode(t),l>>=1;return o.join("")}var EC=function(s){function i(t){var e=this,o=t.hidpi!==void 0&&t.hidpi,l=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(l=t.interpolate),(e=s.call(this,{cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:l,opaque:!0,projection:ie("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:o?2:1,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,zDirection:t.zDirection})||this)._a=o,e.Sa=t.culture!==void 0?t.culture:"en-us",e.Oa=t.maxZoom!==void 0?t.maxZoom:-1,e.ja=t.key,e.Ea=t.imagerySet,Nf("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+e.Ea+"?uriScheme=https&include=ImageryProviders&key="+e.ja+"&c="+e.Sa,e.handleImageryMetadataResponse.bind(e),void 0,"jsonp"),e}return SC(i,s),i.prototype.getApiKey=function(){return this.ja},i.prototype.getImagerySet=function(){return this.Ea},i.prototype.handleImageryMetadataResponse=function(t){if(t.statusCode==200&&t.statusDescription=="OK"&&t.authenticationResultCode=="ValidCredentials"&&t.resourceSets.length==1&&t.resourceSets[0].resources.length==1){var e=t.resourceSets[0].resources[0],o=this.Oa==-1?e.zoomMax:this.Oa,l=wc(this.getProjection()),f=this._a?2:1,y=e.imageWidth==e.imageHeight?e.imageWidth/f:[e.imageWidth/f,e.imageHeight/f],w=vh({extent:l,minZoom:e.zoomMin,maxZoom:o,tileSize:y});this.tileGrid=w;var b=this.Sa,I=this._a;if(this.tileUrlFunction=wp(e.imageUrlSubdomains.map(function(D){var j=[0,0,0],H=e.imageUrl.replace("{subdomain}",D).replace("{culture}",b);return function(Z,it,at){if(Z){yp(Z[0],Z[1],Z[2],j);var wt=H;return I&&(wt+="&dpi=d1&device=mobile"),wt.replace("{quadkey}",A_(j))}}})),e.imageryProviders){var N=ji(ie("EPSG:4326"),this.getProjection());this.setAttributions(function(D){var j=[],H=D.viewState,Z=this.getTileGrid(),it=Z.getZForResolution(H.resolution,this.zDirection),at=Z.getTileCoordForCoordAndZ(H.center,it)[0];return e.imageryProviders.map(function(wt){for(var gt=!1,yt=wt.coverageAreas,It=0,Rt=yt.length;It<Rt;++It){var kt=yt[It];if(at>=kt.zoomMin&&at<=kt.zoomMax){var Dt=kt.bbox;if(on(M([Dt[1],Dt[0],Dt[3],Dt[2]],N),D.extent)){gt=!0;break}}}gt&&j.push(wt.attribution)}),j.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),j}.bind(this))}this.setState("ready")}else this.setState("error")},i}(Yl),CC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Yf=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;o.interpolate!==void 0&&(l=o.interpolate);var f=o.projection!==void 0?o.projection:"EPSG:3857",y=o.tileGrid!==void 0?o.tileGrid:vh({extent:wc(f),maxResolution:o.maxResolution,maxZoom:o.maxZoom,minZoom:o.minZoom,tileSize:o.tileSize});return(e=s.call(this,{attributions:o.attributions,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:l,opaque:o.opaque,projection:f,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileGrid:y,tileLoadFunction:o.tileLoadFunction,tilePixelRatio:o.tilePixelRatio,tileUrlFunction:o.tileUrlFunction,url:o.url,urls:o.urls,wrapX:o.wrapX===void 0||o.wrapX,transition:o.transition,attributionsCollapsible:o.attributionsCollapsible,zDirection:o.zDirection})||this).js=o.gutter!==void 0?o.gutter:0,e}return CC(i,s),i.prototype.getGutter=function(){return this.js},i}(Yl),TC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),PC=function(s){function i(t){var e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:t.maxZoom!==void 0?t.maxZoom:18,minZoom:t.minZoom,projection:t.projection,transition:t.transition,wrapX:t.wrapX,zDirection:t.zDirection})||this;return e.Ta=t.account,e.Aa=t.map||"",e.Pa=t.config||{},e.Ca={},e.ka(),e}return TC(i,s),i.prototype.getConfig=function(){return this.Pa},i.prototype.updateConfig=function(t){Vt(this.Pa,t),this.ka()},i.prototype.setConfig=function(t){this.Pa=t||{},this.ka()},i.prototype.ka=function(){var t=JSON.stringify(this.Pa);if(this.Ca[t])this.Ia(this.Ca[t]);else{var e="https://"+this.Ta+".carto.com/api/v1/map";this.Aa&&(e+="/named/"+this.Aa);var o=new XMLHttpRequest;o.addEventListener("load",this.Na.bind(this,t)),o.addEventListener("error",this.La.bind(this)),o.open("POST",e),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify(this.Pa))}},i.prototype.Na=function(t,e){var o=e.target;if(!o.status||o.status>=200&&o.status<300){var l=void 0;try{l=JSON.parse(o.responseText)}catch{return void this.setState("error")}this.Ia(l),this.Ca[t]=l,this.setState("ready")}else this.setState("error")},i.prototype.La=function(t){this.setState("error")},i.prototype.Ia=function(t){var e="https://"+t.cdn_url.https+"/"+this.Ta+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},i}(Yf),wh="addfeature",O_="changefeature",N_="clear",Zf="removefeature",IC="featuresloadstart",MC="featuresloadend",LC="featuresloaderror",R_=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),bc=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.feature=e,l.features=o,l}return R_(i,s),i}(O),du=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{attributions:o.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:o.wrapX===void 0||o.wrapX})||this).on,e.once,e.un,e.U=vt,e.ze=o.format,e.za=o.overlaps===void 0||o.overlaps,e.Fe=o.url,o.loader!==void 0?e.U=o.loader:e.Fe!==void 0&&(Me(e.ze,7),e.U=Jm(e.Fe,e.ze)),e.Ra=o.strategy!==void 0?o.strategy:C1;var l,f,y=o.useSpatialIndex===void 0||o.useSpatialIndex;return e.Fa=y?new Xf:null,e.Ga=new Xf,e.Da=0,e.qa={},e.Ua={},e.Ba={},e.Xa={},e.Va=null,Array.isArray(o.features)?f=o.features:o.features&&(f=(l=o.features).getArray()),y||l!==void 0||(l=new Be(f)),f!==void 0&&e.addFeaturesInternal(f),l!==void 0&&e.Wa(l),e}return R_(i,s),i.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},i.prototype.addFeatureInternal=function(t){var e=L(t);if(this.Ya(e,t)){this.Za(e,t);var o=t.getGeometry();if(o){var l=o.getExtent();this.Fa&&this.Fa.insert(l,t)}else this.qa[e]=t;this.dispatchEvent(new bc(wh,t))}else this.Va&&this.Va.remove(t)},i.prototype.Za=function(t,e){this.Xa[t]=[Ee(e,ne,this.$a,this),Ee(e,K,this.$a,this)]},i.prototype.Ya=function(t,e){var o=!0,l=e.getId();return l!==void 0&&(l.toString()in this.Ua?o=!1:this.Ua[l.toString()]=e),o&&(Me(!(t in this.Ba),30),this.Ba[t]=e),o},i.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},i.prototype.addFeaturesInternal=function(t){for(var e=[],o=[],l=[],f=0,y=t.length;f<y;f++){var w=L(I=t[f]);this.Ya(w,I)&&o.push(I)}f=0;for(var b=o.length;f<b;f++){var I;w=L(I=o[f]),this.Za(w,I);var N=I.getGeometry();if(N){var D=N.getExtent();e.push(D),l.push(I)}else this.qa[w]=I}if(this.Fa&&this.Fa.load(e,l),this.hasListener(wh)){f=0;for(var j=o.length;f<j;f++)this.dispatchEvent(new bc(wh,o[f]))}},i.prototype.Wa=function(t){var e=!1;this.addEventListener(wh,function(o){e||(e=!0,t.push(o.feature),e=!1)}),this.addEventListener(Zf,function(o){e||(e=!0,t.remove(o.feature),e=!1)}),t.addEventListener(Ft,function(o){e||(e=!0,this.addFeature(o.element),e=!1)}.bind(this)),t.addEventListener(Ot,function(o){e||(e=!0,this.removeFeature(o.element),e=!1)}.bind(this)),this.Va=t},i.prototype.clear=function(t){if(t){for(var e in this.Xa)this.Xa[e].forEach(Or);this.Va||(this.Xa={},this.Ua={},this.Ba={})}else if(this.Fa){var o=function(y){this.removeFeatureInternal(y)}.bind(this);for(var l in this.Fa.forEach(o),this.qa)this.removeFeatureInternal(this.qa[l])}this.Va&&this.Va.clear(),this.Fa&&this.Fa.clear(),this.qa={};var f=new bc(N_);this.dispatchEvent(f),this.changed()},i.prototype.forEachFeature=function(t){if(this.Fa)return this.Fa.forEach(t);this.Va&&this.Va.forEach(t)},i.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var o=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(o,function(l){return l.getGeometry().intersectsCoordinate(t)?e(l):void 0})},i.prototype.forEachFeatureInExtent=function(t,e){if(this.Fa)return this.Fa.forEachInExtent(t,e);this.Va&&this.Va.forEach(e)},i.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,function(o){if(o.getGeometry().intersectsExtent(t)){var l=e(o);if(l)return l}})},i.prototype.getFeaturesCollection=function(){return this.Va},i.prototype.getFeatures=function(){var t;return this.Va?t=this.Va.getArray().slice(0):this.Fa&&(t=this.Fa.getAll(),ge(this.qa)||ut(t,Ne(this.qa))),t},i.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(o){e.push(o)}),e},i.prototype.getFeaturesInExtent=function(t,e){var o=this;if(this.Fa){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.Fa.getInExtent(t);var l=V(t,e);return[].concat.apply([],l.map(function(f){return o.Fa.getInExtent(f)}))}return this.Va?this.Va.getArray().slice(0):[]},i.prototype.getClosestFeatureToCoordinate=function(t,e){var o=t[0],l=t[1],f=null,y=[NaN,NaN],w=1/0,b=[-1/0,-1/0,1/0,1/0],I=e||rt;return this.Fa.forEachInExtent(b,function(N){if(I(N)){var D=N.getGeometry(),j=w;if((w=D.closestPointXY(o,l,y,w))<j){f=N;var H=Math.sqrt(w);b[0]=o-H,b[1]=l-H,b[2]=o+H,b[3]=l+H}}}),f},i.prototype.getExtent=function(t){return this.Fa.getExtent(t)},i.prototype.getFeatureById=function(t){var e=this.Ua[t.toString()];return e!==void 0?e:null},i.prototype.getFeatureByUid=function(t){var e=this.Ba[t];return e!==void 0?e:null},i.prototype.getFormat=function(){return this.ze},i.prototype.getOverlaps=function(){return this.za},i.prototype.getUrl=function(){return this.Fe},i.prototype.$a=function(t){var e=t.target,o=L(e),l=e.getGeometry();if(l){var f=l.getExtent();o in this.qa?(delete this.qa[o],this.Fa&&this.Fa.insert(f,e)):this.Fa&&this.Fa.update(f,e)}else o in this.qa||(this.Fa&&this.Fa.remove(e),this.qa[o]=e);var y=e.getId();if(y!==void 0){var w=y.toString();this.Ua[w]!==e&&(this.Ka(e),this.Ua[w]=e)}else this.Ka(e),this.Ba[o]=e;this.changed(),this.dispatchEvent(new bc(O_,e))},i.prototype.hasFeature=function(t){var e=t.getId();return e!==void 0?e in this.Ua:L(t)in this.Ba},i.prototype.isEmpty=function(){return this.Fa?this.Fa.isEmpty()&&ge(this.qa):!this.Va||this.Va.getLength()===0},i.prototype.loadFeatures=function(t,e,o){for(var l=this.Ga,f=this.Ra(t,e,o),y=function(N,D){var j=f[N];l.forEachInExtent(j,function(H){return pn(H.extent,j)})||(++w.Da,w.dispatchEvent(new bc(IC)),w.U.call(w,j,e,o,function(H){--this.Da,this.dispatchEvent(new bc(MC,void 0,H))}.bind(w),function(){--this.Da,this.dispatchEvent(new bc(LC))}.bind(w)),l.insert(j,{extent:j.slice()}))},w=this,b=0,I=f.length;b<I;++b)y(b);this.loading=!(this.U.length<4)&&this.Da>0},i.prototype.refresh=function(){this.clear(!0),this.Ga.clear(),s.prototype.refresh.call(this)},i.prototype.removeLoadedExtent=function(t){var e,o=this.Ga;o.forEachInExtent(t,function(l){if(ko(l.extent,t))return e=l,!0}),e&&o.remove(e)},i.prototype.removeFeature=function(t){if(t){var e=L(t);e in this.qa?delete this.qa[e]:this.Fa&&this.Fa.remove(t),this.removeFeatureInternal(t)&&this.changed()}},i.prototype.removeFeatureInternal=function(t){var e=L(t),o=this.Xa[e];if(o){o.forEach(Or),delete this.Xa[e];var l=t.getId();return l!==void 0&&delete this.Ua[l.toString()],delete this.Ba[e],this.dispatchEvent(new bc(Zf,t)),t}},i.prototype.Ka=function(t){var e=!1;for(var o in this.Ua)if(this.Ua[o]===t){delete this.Ua[o],e=!0;break}return e},i.prototype.setLoader=function(t){this.U=t},i.prototype.setUrl=function(t){Me(this.ze,7),this.Fe=t,this.setLoader(Jm(t,this.ze))},i}(Mp),AC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),OC=function(s){function i(t){var e=s.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return e.resolution=void 0,e.distance=t.distance!==void 0?t.distance:20,e.minDistance=t.minDistance||0,e.interpolationRatio=0,e.features=[],e.geometryFunction=t.geometryFunction||function(o){var l=o.getGeometry();return Me(l.getType()=="Point",10),l},e.Ha=t.createCluster,e.source=null,e.Ja=e.refresh.bind(e),e.updateDistance(e.distance,e.minDistance),e.setSource(t.source||null),e}return AC(i,s),i.prototype.clear=function(t){this.features.length=0,s.prototype.clear.call(this,t)},i.prototype.getDistance=function(){return this.distance},i.prototype.getSource=function(){return this.source},i.prototype.loadFeatures=function(t,e,o){this.source.loadFeatures(t,e,o),e!==this.resolution&&(this.resolution=e,this.refresh())},i.prototype.setDistance=function(t){this.updateDistance(t,this.minDistance)},i.prototype.setMinDistance=function(t){this.updateDistance(this.distance,t)},i.prototype.getMinDistance=function(){return this.minDistance},i.prototype.setSource=function(t){this.source&&this.source.removeEventListener(ne,this.Ja),this.source=t,t&&t.addEventListener(ne,this.Ja),this.refresh()},i.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},i.prototype.updateDistance=function(t,e){var o=t===0?0:Math.min(e,t)/t,l=t!==this.distance||this.interpolationRatio!==o;this.distance=t,this.minDistance=e,this.interpolationRatio=o,l&&this.refresh()},i.prototype.cluster=function(){if(this.resolution!==void 0&&this.source)for(var t=[1/0,1/0,-1/0,-1/0],e=this.distance*this.resolution,o=this.source.getFeatures(),l={},f=0,y=o.length;f<y;f++){var w=o[f];if(!(L(w)in l)){var b=this.geometryFunction(w);if(b){as(b.getCoordinates(),t),Fr(t,e,t);var I=this.source.getFeaturesInExtent(t).filter(function(N){var D=L(N);return!(D in l)&&(l[D]=!0,!0)});this.features.push(this.createCluster(I,t))}}}},i.prototype.createCluster=function(t,e){for(var o=[0,0],l=t.length-1;l>=0;--l){var f=this.geometryFunction(t[l]);f?bs(o,f.getCoordinates()):t.splice(l,1)}On(o,1/t.length);var y=Gi(e),w=this.interpolationRatio,b=new rn([o[0]*(1-w)+y[0]*w,o[1]*(1-w)+y[1]*w]);return this.Ha?this.Ha(b,t):new Mr({geometry:b,features:t})},i}(du),NC=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),k_=function(s){function i(t){var e=this,o=t.projection===void 0?"EPSG:3857":t.projection,l=t.tileGrid;if(l===void 0&&o&&(l=vh({extent:wc(o),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),(e=s.call(this,{cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:o,tileGrid:l,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this).js=t.gutter!==void 0?t.gutter:0,e.jo=t.tileSize?Pn(t.tileSize):null,!e.jo&&t.tilePixelRatio&&l){var f=Pn(l.getTileSize(0));e.jo=[f[0]*t.tilePixelRatio,f[1]*t.tilePixelRatio]}return e.Oo=null,e.ga={},e.U=t.loader,e.cr=e.cr.bind(e),e.bandCount=t.bandCount===void 0?4:t.bandCount,e}return NC(i,s),i.prototype.setTileSizes=function(t){this.Oo=t},i.prototype.getTileSize=function(t){if(this.Oo)return this.Oo[t];if(this.jo)return this.jo;var e=this.getTileGrid();return e?Pn(e.getTileSize(t)):[256,256]},i.prototype.getGutterForProjection=function(t){return this.js},i.prototype.setLoader=function(t){this.U=t},i.prototype.getTile=function(t,e,o,l,f){var y=this.getTileSize(t),w=Ul(t,e,o);if(this.tileCache.containsKey(w))return this.tileCache.get(w);var b=this.U,I=Vt({tileCoord:[t,e,o],loader:function(){return Bt(function(){return b(t,e,o)})},size:y},this.tileOptions),N=new xr(I);return N.key=this.getKey(),N.addEventListener(ne,this.cr),this.tileCache.set(w,N),N},i.prototype.cr=function(t){var e,o=t.target,l=L(o),f=o.getState();f==br?(this.ga[l]=!0,e=T_):l in this.ga&&(delete this.ga[l],e=f==ur?I_:f==Oe?P_:void 0),e&&this.dispatchEvent(new My(e,o))},i}(Wf);const F_=new ArrayBuffer(4),RC=new Float32Array(F_),kC=new Uint32Array(F_),Zl=new Uint32Array(512),$l=new Uint32Array(512);for(let s=0;s<256;++s){const i=s-127;i<-27?(Zl[s]=0,Zl[256|s]=32768,$l[s]=24,$l[256|s]=24):i<-14?(Zl[s]=1024>>-i-14,Zl[256|s]=1024>>-i-14|32768,$l[s]=-i-1,$l[256|s]=-i-1):i<=15?(Zl[s]=i+15<<10,Zl[256|s]=i+15<<10|32768,$l[s]=13,$l[256|s]=13):i<128?(Zl[s]=31744,Zl[256|s]=64512,$l[s]=24,$l[256|s]=24):(Zl[s]=31744,Zl[256|s]=64512,$l[s]=13,$l[256|s]=13)}const bg=new Uint32Array(2048),bh=new Uint32Array(64),Ay=new Uint32Array(64);bg[0]=0;for(let s=1;s<1024;++s){let i=s<<13,t=0;for(;(8388608&i)==0;)t-=8388608,i<<=1;i&=-8388609,t+=947912704,bg[s]=i|t}for(let s=1024;s<2048;++s)bg[s]=939524096+(s-1024<<13);bh[0]=0;for(let s=1;s<31;++s)bh[s]=s<<23;bh[31]=1199570944,bh[32]=2147483648;for(let s=33;s<63;++s)bh[s]=2147483648+(s-32<<23);bh[63]=3347054592,Ay[0]=0;for(let s=1;s<64;++s)Ay[s]=s===32?0:1024;function FC(s){const i=s>>10;return kC[0]=bg[Ay[i]+(1023&s)]+bh[i],RC[0]}const DC=Reflect.getPrototypeOf(Uint8Array).prototype,GC=Reflect.getOwnPropertyDescriptor(DC,Symbol.toStringTag).get;function jC(s){return GC.call(s)!==void 0}const BC=Object.prototype.toString;function zC(s){return!!ArrayBuffer.isView(s)&&!jC(s)&&BC.call(s)==="[object DataView]"}function D_(s,i){if(!zC(s))throw new TypeError("First argument to getFloat16 function must be a DataView");for(var t=arguments.length,e=new Array(t>2?t-2:0),o=2;o<t;o++)e[o-2]=arguments[o];return FC(s.getUint16(i,...e))}var Oy=x(802),VC=x(51),Hr=x(150);const G_=new Map;function gu(s,i){Array.isArray(s)||(s=[s]),s.forEach(t=>G_.set(t,i))}async function j_(s){const i=G_.get(s.Compression);if(!i)throw new Error(`Unknown compression method identifier: ${s.Compression}`);return new(await i())(s)}function Sg(s,i,t){let e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return new(Object.getPrototypeOf(s)).constructor(i*t*e)}function UC(s,i,t,e,o){const l=i/e,f=t/o;return s.map(y=>{const w=Sg(y,e,o);for(let b=0;b<o;++b){const I=Math.min(Math.round(f*b),t-1);for(let N=0;N<e;++N){const D=Math.min(Math.round(l*N),i-1),j=y[I*i+D];w[b*e+N]=j}}return w})}function Lp(s,i,t){return(1-t)*s+t*i}function qC(s,i,t,e,o){const l=i/e,f=t/o;return s.map(y=>{const w=Sg(y,e,o);for(let b=0;b<o;++b){const I=f*b,N=Math.floor(I),D=Math.min(Math.ceil(I),t-1);for(let j=0;j<e;++j){const H=l*j,Z=H%1,it=Math.floor(H),at=Math.min(Math.ceil(H),i-1),wt=y[N*i+it],gt=y[N*i+at],yt=y[D*i+it],It=y[D*i+at],Rt=Lp(Lp(wt,gt,Z),Lp(yt,It,Z),I%1);w[b*e+j]=Rt}}return w})}function HC(s,i,t,e,o,l){const f=i/e,y=t/o,w=Sg(s,e,o,l);for(let b=0;b<o;++b){const I=Math.min(Math.round(y*b),t-1);for(let N=0;N<e;++N){const D=Math.min(Math.round(f*N),i-1);for(let j=0;j<l;++j){const H=s[I*i*l+D*l+j];w[b*e*l+N*l+j]=H}}}return w}function XC(s,i,t,e,o,l){const f=i/e,y=t/o,w=Sg(s,e,o,l);for(let b=0;b<o;++b){const I=y*b,N=Math.floor(I),D=Math.min(Math.ceil(I),t-1);for(let j=0;j<e;++j){const H=f*j,Z=H%1,it=Math.floor(H),at=Math.min(Math.ceil(H),i-1);for(let wt=0;wt<l;++wt){const gt=s[N*i*l+it*l+wt],yt=s[N*i*l+at*l+wt],It=s[D*i*l+it*l+wt],Rt=s[D*i*l+at*l+wt],kt=Lp(Lp(gt,yt,Z),Lp(It,Rt,Z),I%1);w[b*e*l+j*l+wt]=kt}}}return w}function WC(s,i,t){let e=0;for(let o=i;o<t;++o)e+=s[o];return e}function Ny(s,i,t){switch(s){case 1:if(i<=8)return new Uint8Array(t);if(i<=16)return new Uint16Array(t);if(i<=32)return new Uint32Array(t);break;case 2:if(i===8)return new Int8Array(t);if(i===16)return new Int16Array(t);if(i===32)return new Int32Array(t);break;case 3:switch(i){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}}throw Error("Unsupported data format/bitsPerSample")}gu([void 0,1],()=>x.e(226).then(x.bind(x,966)).then(s=>s.default)),gu(5,()=>x.e(611).then(x.bind(x,611)).then(s=>s.default)),gu(6,()=>{throw new Error("old style JPEG compression is not supported.")}),gu(7,()=>x.e(382).then(x.bind(x,382)).then(s=>s.default)),gu([8,32946],()=>Promise.all([x.e(247),x.e(356)]).then(x.bind(x,356)).then(s=>s.default)),gu(32773,()=>x.e(395).then(x.bind(x,395)).then(s=>s.default)),gu(34887,()=>Promise.all([x.e(247),x.e(54)]).then(x.bind(x,54)).then(s=>s.default)),gu(50001,()=>x.e(629).then(x.bind(x,629)).then(s=>s.default));var B_=class{constructor(s,i,t,e,o,l){this.fileDirectory=s,this.geoKeys=i,this.dataView=t,this.littleEndian=e,this.tiles=o?{}:null,this.isTiled=!s.StripOffsets;const f=s.PlanarConfiguration;if(this.planarConfiguration=f===void 0?1:f,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=l}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel!==void 0?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:this.fileDirectory.RowsPerStrip!==void 0?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(s){return this.isTiled||(s+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-s*this.getTileHeight()}getBytesPerPixel(){let s=0;for(let i=0;i<this.fileDirectory.BitsPerSample.length;++i)s+=this.getSampleByteSize(i);return s}getSampleByteSize(s){if(s>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${s} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[s]/8)}getReaderForSample(s){const i=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[s]:1,t=this.fileDirectory.BitsPerSample[s];switch(i){case 1:if(t<=8)return DataView.prototype.getUint8;if(t<=16)return DataView.prototype.getUint16;if(t<=32)return DataView.prototype.getUint32;break;case 2:if(t<=8)return DataView.prototype.getInt8;if(t<=16)return DataView.prototype.getInt16;if(t<=32)return DataView.prototype.getInt32;break;case 3:switch(t){case 16:return function(e,o){return D_(this,e,o)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[s]:1}getBitsPerSample(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.fileDirectory.BitsPerSample[s]}getArrayForSample(s,i){return Ny(this.getSampleFormat(s),this.getBitsPerSample(s),i)}async getTileOrStrip(s,i,t,e,o){const l=Math.ceil(this.getWidth()/this.getTileWidth()),f=Math.ceil(this.getHeight()/this.getTileHeight());let y;const{tiles:w}=this;let b,I;this.planarConfiguration===1?y=i*l+s:this.planarConfiguration===2&&(y=t*l*f+i*l+s),this.isTiled?(b=this.fileDirectory.TileOffsets[y],I=this.fileDirectory.TileByteCounts[y]):(b=this.fileDirectory.StripOffsets[y],I=this.fileDirectory.StripByteCounts[y]);const N=(await this.source.fetch([{offset:b,length:I}],o))[0];let D;return w!==null&&w[y]?D=w[y]:(D=(async()=>{let j=await e.decode(this.fileDirectory,N);const H=this.getSampleFormat(),Z=this.getBitsPerSample();return function(it,at){return(it!==1&&it!==2||!(at<=32)||at%8!=0)&&(it!==3||at!==16&&at!==32&&at!==64)}(H,Z)&&(j=function(it,at,wt,gt,yt,It,Rt){const kt=new DataView(it),Dt=wt===2?1:gt,Xt=Ny(at,yt,wt===2?Rt*It:Rt*It*gt),ee=parseInt("1".repeat(yt),2);if(at===1){let pe;pe=wt===1?gt*yt:yt;let xe=It*pe;(7&xe)!=0&&(xe=xe+7&-8);for(let fe=0;fe<Rt;++fe){const Re=fe*xe;for(let qe=0;qe<It;++qe){const Ge=Re+qe*Dt*yt;for(let Qe=0;Qe<Dt;++Qe){const ir=Ge+Qe*yt,de=(fe*It+qe)*Dt+Qe,Nr=Math.floor(ir/8),Pr=ir%8;if(Pr+yt<=8)Xt[de]=kt.getUint8(Nr)>>8-yt-Pr&ee;else if(Pr+yt<=16)Xt[de]=kt.getUint16(Nr)>>16-yt-Pr&ee;else if(Pr+yt<=24){const he=kt.getUint16(Nr)<<8|kt.getUint8(Nr+2);Xt[de]=he>>24-yt-Pr&ee}else Xt[de]=kt.getUint32(Nr)>>32-yt-Pr&ee}}}}return Xt.buffer}(j,H,this.planarConfiguration,this.getSamplesPerPixel(),Z,this.getTileWidth(),this.getBlockHeight(i))),j})(),w!==null&&(w[y]=D)),{x:s,y:i,sample:t,data:await D}}async _readRaster(s,i,t,e,o,l,f,y,w){const b=this.getTileWidth(),I=this.getTileHeight(),N=this.getWidth(),D=this.getHeight(),j=Math.max(Math.floor(s[0]/b),0),H=Math.min(Math.ceil(s[2]/b),Math.ceil(N/b)),Z=Math.max(Math.floor(s[1]/I),0),it=Math.min(Math.ceil(s[3]/I),Math.ceil(D/I)),at=s[2]-s[0];let wt=this.getBytesPerPixel();const gt=[],yt=[];for(let kt=0;kt<i.length;++kt)this.planarConfiguration===1?gt.push(WC(this.fileDirectory.BitsPerSample,0,i[kt])/8):gt.push(0),yt.push(this.getReaderForSample(i[kt]));const It=[],{littleEndian:Rt}=this;for(let kt=Z;kt<it;++kt)for(let Dt=j;Dt<H;++Dt)for(let Xt=0;Xt<i.length;++Xt){const ee=Xt,pe=i[Xt];this.planarConfiguration===2&&(wt=this.getSampleByteSize(Xt));const xe=this.getTileOrStrip(Dt,kt,pe,o,w);It.push(xe),xe.then(fe=>{const Re=fe.data,qe=new DataView(Re),Ge=this.getBlockHeight(fe.y),Qe=fe.y*I,ir=fe.x*b,de=Qe+Ge,Nr=(fe.x+1)*b,Pr=yt[ee],he=Math.min(Ge,Ge-(de-s[3]),D-Qe),$e=Math.min(b,b-(Nr-s[2]),N-ir);for(let or=Math.max(0,s[1]-Qe);or<he;++or)for(let fi=Math.max(0,s[0]-ir);fi<$e;++fi){const ki=(or*b+fi)*wt,Sn=Pr.call(qe,ki+gt[ee],Rt);let tr;e?(tr=(or+Qe-s[1])*at*i.length+(fi+ir-s[0])*i.length+ee,t[tr]=Sn):(tr=(or+Qe-s[1])*at+fi+ir-s[0],t[ee][tr]=Sn)}})}if(await Promise.all(It),l&&s[2]-s[0]!==l||f&&s[3]-s[1]!==f){let kt;return kt=e?function(Dt,Xt,ee,pe,xe,fe){let Re=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"nearest";switch(Re.toLowerCase()){case"nearest":return HC(Dt,Xt,ee,pe,xe,fe);case"bilinear":case"linear":return XC(Dt,Xt,ee,pe,xe,fe);default:throw new Error(`Unsupported resampling method: '${Re}'`)}}(t,s[2]-s[0],s[3]-s[1],l,f,i.length,y):function(Dt,Xt,ee,pe,xe){let fe=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"nearest";switch(fe.toLowerCase()){case"nearest":return UC(Dt,Xt,ee,pe,xe);case"bilinear":case"linear":return qC(Dt,Xt,ee,pe,xe);default:throw new Error(`Unsupported resampling method: '${fe}'`)}}(t,s[2]-s[0],s[3]-s[1],l,f,y),kt.width=l,kt.height=f,kt}return t.width=l||s[2]-s[0],t.height=f||s[3]-s[1],t}async readRasters(){let{window:s,samples:i=[],interleave:t,pool:e=null,width:o,height:l,resampleMethod:f,fillValue:y,signal:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const b=s||[0,0,this.getWidth(),this.getHeight()];if(b[0]>b[2]||b[1]>b[3])throw new Error("Invalid subsets");const I=(b[2]-b[0])*(b[3]-b[1]),N=this.getSamplesPerPixel();if(i&&i.length){for(let H=0;H<i.length;++H)if(i[H]>=N)return Promise.reject(new RangeError(`Invalid sample index '${i[H]}'.`))}else for(let H=0;H<N;++H)i.push(H);let D;if(t)D=Ny(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),I*i.length),y&&D.fill(y);else{D=[];for(let H=0;H<i.length;++H){const Z=this.getArrayForSample(i[H],I);Array.isArray(y)&&H<y.length?Z.fill(y[H]):y&&!Array.isArray(y)&&Z.fill(y),D.push(Z)}}const j=e||await j_(this.fileDirectory);return await this._readRaster(b,i,D,t,j,o,l,f,w)}async readRGB(){let{window:s,interleave:i=!0,pool:t=null,width:e,height:o,resampleMethod:l,enableAlpha:f=!1,signal:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const w=s||[0,0,this.getWidth(),this.getHeight()];if(w[0]>w[2]||w[1]>w[3])throw new Error("Invalid subsets");const b=this.fileDirectory.PhotometricInterpretation;if(b===Hr.Ie.RGB){let it=[0,1,2];if(this.fileDirectory.ExtraSamples!==Hr.pd.Unspecified&&f){it=[];for(let at=0;at<this.fileDirectory.BitsPerSample.length;at+=1)it.push(at)}return this.readRasters({window:s,interleave:i,samples:it,pool:t,width:e,height:o,resampleMethod:l,signal:y})}let I;switch(b){case Hr.Ie.WhiteIsZero:case Hr.Ie.BlackIsZero:case Hr.Ie.Palette:I=[0];break;case Hr.Ie.CMYK:I=[0,1,2,3];break;case Hr.Ie.YCbCr:case Hr.Ie.CIELab:I=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const N={window:w,interleave:!0,samples:I,pool:t,width:e,height:o,resampleMethod:l,signal:y},{fileDirectory:D}=this,j=await this.readRasters(N),H=2**this.fileDirectory.BitsPerSample[0];let Z;switch(b){case Hr.Ie.WhiteIsZero:Z=function(it,at){const{width:wt,height:gt}=it,yt=new Uint8Array(wt*gt*3);let It;for(let Rt=0,kt=0;Rt<it.length;++Rt,kt+=3)It=256-it[Rt]/at*256,yt[kt]=It,yt[kt+1]=It,yt[kt+2]=It;return yt}(j,H);break;case Hr.Ie.BlackIsZero:Z=function(it,at){const{width:wt,height:gt}=it,yt=new Uint8Array(wt*gt*3);let It;for(let Rt=0,kt=0;Rt<it.length;++Rt,kt+=3)It=it[Rt]/at*256,yt[kt]=It,yt[kt+1]=It,yt[kt+2]=It;return yt}(j,H);break;case Hr.Ie.Palette:Z=function(it,at){const{width:wt,height:gt}=it,yt=new Uint8Array(wt*gt*3),It=at.length/3,Rt=at.length/3*2;for(let kt=0,Dt=0;kt<it.length;++kt,Dt+=3){const Xt=it[kt];yt[Dt]=at[Xt]/65536*256,yt[Dt+1]=at[Xt+It]/65536*256,yt[Dt+2]=at[Xt+Rt]/65536*256}return yt}(j,D.ColorMap);break;case Hr.Ie.CMYK:Z=function(it){const{width:at,height:wt}=it,gt=new Uint8Array(at*wt*3);for(let yt=0,It=0;yt<it.length;yt+=4,It+=3){const Rt=it[yt],kt=it[yt+1],Dt=it[yt+2],Xt=it[yt+3];gt[It]=(255-Rt)/256*255*((255-Xt)/256),gt[It+1]=(255-kt)/256*255*((255-Xt)/256),gt[It+2]=(255-Dt)/256*255*((255-Xt)/256)}return gt}(j);break;case Hr.Ie.YCbCr:Z=function(it){const{width:at,height:wt}=it,gt=new Uint8ClampedArray(at*wt*3);for(let yt=0,It=0;yt<it.length;yt+=3,It+=3){const Rt=it[yt],kt=it[yt+1],Dt=it[yt+2];gt[It]=Rt+1.402*(Dt-128),gt[It+1]=Rt-.34414*(kt-128)-.71414*(Dt-128),gt[It+2]=Rt+1.772*(kt-128)}return gt}(j);break;case Hr.Ie.CIELab:Z=function(it){const{width:at,height:wt}=it,gt=new Uint8Array(at*wt*3);for(let yt=0,It=0;yt<it.length;yt+=3,It+=3){let Rt,kt,Dt,Xt=(it[yt+0]+16)/116,ee=(it[yt+1]<<24>>24)/500+Xt,pe=Xt-(it[yt+2]<<24>>24)/200;ee=.95047*(ee*ee*ee>.008856?ee*ee*ee:(ee-16/116)/7.787),Xt=1*(Xt*Xt*Xt>.008856?Xt*Xt*Xt:(Xt-16/116)/7.787),pe=1.08883*(pe*pe*pe>.008856?pe*pe*pe:(pe-16/116)/7.787),Rt=3.2406*ee+-1.5372*Xt+-.4986*pe,kt=-.9689*ee+1.8758*Xt+.0415*pe,Dt=.0557*ee+-.204*Xt+1.057*pe,Rt=Rt>.0031308?1.055*Rt**(1/2.4)-.055:12.92*Rt,kt=kt>.0031308?1.055*kt**(1/2.4)-.055:12.92*kt,Dt=Dt>.0031308?1.055*Dt**(1/2.4)-.055:12.92*Dt,gt[It]=255*Math.max(0,Math.min(1,Rt)),gt[It+1]=255*Math.max(0,Math.min(1,kt)),gt[It+2]=255*Math.max(0,Math.min(1,Dt))}return gt}(j);break;default:throw new Error("Unsupported photometric interpretation.")}if(!i){const it=new Uint8Array(Z.length/3),at=new Uint8Array(Z.length/3),wt=new Uint8Array(Z.length/3);for(let gt=0,yt=0;gt<Z.length;gt+=3,++yt)it[yt]=Z[gt],at[yt]=Z[gt+1],wt[yt]=Z[gt+2];Z=[it,at,wt]}return Z.width=j.width,Z.height=j.height,Z}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const s=[];for(let i=0;i<this.fileDirectory.ModelTiepoint.length;i+=6)s.push({i:this.fileDirectory.ModelTiepoint[i],j:this.fileDirectory.ModelTiepoint[i+1],k:this.fileDirectory.ModelTiepoint[i+2],x:this.fileDirectory.ModelTiepoint[i+3],y:this.fileDirectory.ModelTiepoint[i+4],z:this.fileDirectory.ModelTiepoint[i+5]});return s}getGDALMetadata(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i={};if(!this.fileDirectory.GDAL_METADATA)return null;const t=this.fileDirectory.GDAL_METADATA;let e=VC(t,"Item");e=s===null?e.filter(o=>Oy(o,"sample")===void 0):e.filter(o=>Number(Oy(o,"sample"))===s);for(let o=0;o<e.length;++o){const l=e[o];i[Oy(l,"name")]=l.inner}return i}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const s=this.fileDirectory.GDAL_NODATA;return Number(s.substring(0,s.length-1))}getOrigin(){const s=this.fileDirectory.ModelTiepoint,i=this.fileDirectory.ModelTransformation;if(s&&s.length===6)return[s[3],s[4],s[5]];if(i)return[i[3],i[7],i[11]];throw new Error("The image does not have an affine transformation.")}getResolution(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.fileDirectory.ModelPixelScale,t=this.fileDirectory.ModelTransformation;if(i)return[i[0],-i[1],i[2]];if(t)return[t[0],t[5],t[10]];if(s){const[e,o,l]=s.getResolution();return[e*s.getWidth()/this.getWidth(),o*s.getHeight()/this.getHeight(),l*s.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const s=this.getOrigin(),i=this.getResolution(),t=s[0],e=s[1],o=t+i[0]*this.getWidth(),l=e+i[1]*this.getHeight();return[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)]}};class YC{constructor(i){this._dataView=new DataView(i)}get buffer(){return this._dataView.buffer}getUint64(i,t){const e=this.getUint32(i,t),o=this.getUint32(i+4,t);let l;if(t){if(l=e+4294967296*o,!Number.isSafeInteger(l))throw new Error(`${l} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return l}if(l=4294967296*e+o,!Number.isSafeInteger(l))throw new Error(`${l} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return l}getInt64(i,t){let e=0;const o=(128&this._dataView.getUint8(i+(t?7:0)))>0;let l=!0;for(let f=0;f<8;f++){let y=this._dataView.getUint8(i+(t?f:7-f));o&&(l?y!==0&&(y=255&~(y-1),l=!1):y=255&~y),e+=y*256**f}return o&&(e=-e),e}getUint8(i,t){return this._dataView.getUint8(i,t)}getInt8(i,t){return this._dataView.getInt8(i,t)}getUint16(i,t){return this._dataView.getUint16(i,t)}getInt16(i,t){return this._dataView.getInt16(i,t)}getUint32(i,t){return this._dataView.getUint32(i,t)}getInt32(i,t){return this._dataView.getInt32(i,t)}getFloat16(i,t){return D_(this._dataView,i,t)}getFloat32(i,t){return this._dataView.getFloat32(i,t)}getFloat64(i,t){return this._dataView.getFloat64(i,t)}}class ZC{constructor(i,t,e,o){this._dataView=new DataView(i),this._sliceOffset=t,this._littleEndian=e,this._bigTiff=o}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(i,t){return this.sliceOffset<=i&&this.sliceTop>=i+t}readUint8(i){return this._dataView.getUint8(i-this._sliceOffset,this._littleEndian)}readInt8(i){return this._dataView.getInt8(i-this._sliceOffset,this._littleEndian)}readUint16(i){return this._dataView.getUint16(i-this._sliceOffset,this._littleEndian)}readInt16(i){return this._dataView.getInt16(i-this._sliceOffset,this._littleEndian)}readUint32(i){return this._dataView.getUint32(i-this._sliceOffset,this._littleEndian)}readInt32(i){return this._dataView.getInt32(i-this._sliceOffset,this._littleEndian)}readFloat32(i){return this._dataView.getFloat32(i-this._sliceOffset,this._littleEndian)}readFloat64(i){return this._dataView.getFloat64(i-this._sliceOffset,this._littleEndian)}readUint64(i){const t=this.readUint32(i),e=this.readUint32(i+4);let o;if(this._littleEndian){if(o=t+4294967296*e,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}if(o=4294967296*t+e,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}readInt64(i){let t=0;const e=(128&this._dataView.getUint8(i+(this._littleEndian?7:0)))>0;let o=!0;for(let l=0;l<8;l++){let f=this._dataView.getUint8(i+(this._littleEndian?l:7-l));e&&(o?f!==0&&(f=255&~(f-1),o=!1):f=255&~f),t+=f*256**l}return e&&(t=-t),t}readOffset(i){return this._bigTiff?this.readUint64(i):this.readUint32(i)}}const z_=`\r
\r
`;function V_(s){if(Object.fromEntries!==void 0)return Object.fromEntries(s);const i={};for(const[t,e]of s)i[t.toLowerCase()]=e;return i}function $C(s){return V_(s.split(`\r
`).map(i=>{const t=i.split(":").map(e=>e.trim());return t[0]=t[0].toLowerCase(),t}))}function Ry(s){let i,t,e;return s&&([,i,t,e]=s.match(/bytes (\d+)-(\d+)\/(\d+)/),i=parseInt(i,10),t=parseInt(t,10),e=parseInt(e,10)),{start:i,end:t,total:e}}class ky{async fetch(i){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;return Promise.all(i.map(e=>this.fetchSlice(e,t)))}async fetchSlice(i){throw new Error(`fetching of slice ${i} not possible, not implemented`)}get fileSize(){return null}async close(){}}var KC=x(875);function U_(s,i){const t=Array.isArray(s)?s:Array.from(s),e=Array.isArray(i)?i:Array.from(i);return t.map((o,l)=>[o,e[l]])}class Ap extends Error{constructor(i){super(i),Error.captureStackTrace&&Error.captureStackTrace(this,Ap),this.name="AbortError"}}class JC extends Error{constructor(i,t){super(t),this.errors=i,this.message=t,this.name="AggregateError"}}const QC=JC;class tT{constructor(i,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.offset=i,this.length=t,this.data=e}get top(){return this.offset+this.length}}class q_{constructor(i,t,e){this.offset=i,this.length=t,this.blockIds=e}}class eT extends ky{constructor(i){let{blockSize:t=65536,cacheSize:e=100}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.source=i,this.blockSize=t,this.blockCache=new KC({max:e}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(i,t){const e=new Map,o=new Map,l=new Set;for(const{offset:b,length:I}of i){let N=b+I;const{fileSize:D}=this;D!==null&&(N=Math.min(N,D));for(let j=Math.floor(b/this.blockSize)*this.blockSize;j<N;j+=this.blockSize){const H=Math.floor(j/this.blockSize);this.blockCache.has(H)?e.set(H,this.blockCache.get(H)):this.blockRequests.has(H)?o.set(H,this.blockRequests.get(H)):(this.blockIdsToFetch.has(H)||this.blockIdsToFetch.add(H),l.add(H))}}await async function(b){return new Promise(I=>setTimeout(I,b))}(),this.fetchBlocks(t);for(const b of l){const I=this.blockRequests.get(b),N=this.blockCache.get(b);if(I)o.set(b,I);else{if(!N)throw new Error(`Block ${b} is not in the block requests`);e.set(b,N)}}let f=await Promise.allSettled(Array.from(o.values()));if(f.some(b=>b.status==="rejected")){const b=new Set;for(const[I,N]of U_(o.keys(),f)){const{rejected:D,reason:j}=N;D&&j.name==="AbortError"&&j.signal!==t&&(this.blockIdsToFetch.add(I),b.add(I))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(t);for(const I of b){const N=this.blockRequests.get(I);if(!N)throw new Error(`Block ${I} is not in the block requests`);o.set(I,N)}f=await Promise.allSettled(Array.from(o.values()))}}if(f.some(b=>b.status==="rejected"))throw t&&t.aborted?new Ap("Request was aborted"):new QC(f.filter(b=>b.status==="rejected").map(b=>b.reason),"Request failed");const y=f.map(b=>b.value),w=new Map(U_(Array.from(o.keys()),y));for(const[b,I]of e)w.set(b,I);return this.readSliceData(i,w)}fetchBlocks(i){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),e=this.source.fetch(t,i);for(let o=0;o<t.length;++o){const l=t[o];for(const f of l.blockIds){const y=(async()=>{try{const w=(await e)[o],b=f*this.blockSize,I=b-w.offset,N=Math.min(I+this.blockSize,w.data.byteLength),D=w.data.slice(I,N),j=new tT(b,D.byteLength,D);return this.blockCache.set(f,j),j}catch(w){throw w.name==="AbortError"&&(w.signal=i),w}finally{this.blockRequests.delete(f)}})();this.blockRequests.set(f,y)}}this.blockIdsToFetch.clear()}}groupBlocks(i){const t=Array.from(i).sort((f,y)=>f-y);if(t.length===0)return[];let e=[],o=null;const l=[];for(const f of t)o===null||o+1===f?(e.push(f),o=f):(l.push(new q_(e[0]*this.blockSize,e.length*this.blockSize,e)),e=[f],o=f);return l.push(new q_(e[0]*this.blockSize,e.length*this.blockSize,e)),l}readSliceData(i,t){return i.map(e=>{const o=e.offset+e.length,l=Math.floor(e.offset/this.blockSize),f=Math.floor((e.offset+e.length)/this.blockSize),y=new ArrayBuffer(e.length),w=new Uint8Array(y);for(let b=l;b<=f;++b){const I=t.get(b),N=I.offset-e.offset,D=I.top-o;let j,H=0,Z=0;N<0?H=-N:N>0&&(Z=N),j=D<0?I.length-H:o-I.offset-H;const it=new Uint8Array(I.data,H,j);w.set(it,Z)}return y})}}class Fy{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(i){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Dy{constructor(i){this.url=i}async request(){let{headers:i,credentials:t,signal:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};throw new Error("request is not implemented")}}class rT extends Fy{constructor(i){super(),this.response=i}get status(){return this.response.status}getHeader(i){return this.response.headers.get(i)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class iT extends Dy{constructor(i,t){super(i),this.credentials=t}async request(){let{headers:i,credentials:t,signal:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o=await fetch(this.url,{headers:i,credentials:t,signal:e});return new rT(o)}}class nT extends Fy{constructor(i,t){super(),this.xhr=i,this.data=t}get status(){return this.xhr.status}getHeader(i){return this.xhr.getResponseHeader(i)}async getData(){return this.data}}class oT extends Dy{constructRequest(i,t){return new Promise((e,o)=>{const l=new XMLHttpRequest;l.open("GET",this.url),l.responseType="arraybuffer";for(const[f,y]of Object.entries(i))l.setRequestHeader(f,y);l.onload=()=>{const f=l.response;e(new nT(l,f))},l.onerror=o,l.onabort=()=>o(new Ap("Request aborted")),l.send(),t&&(t.aborted&&l.abort(),t.addEventListener("abort",()=>l.abort()))})}async request(){let{headers:i,signal:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return await this.constructRequest(i,t)}}var sT=x(752),aT=x(640),lT=x(630);class cT extends Fy{constructor(i,t){super(),this.response=i,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(i){return this.response.headers[i]}async getData(){return await this.dataPromise}}class uT extends Dy{constructor(i){super(i),this.parsedUrl=lT.parse(this.url),this.httpApi=this.parsedUrl.protocol==="http:"?sT:aT}constructRequest(i,t){return new Promise((e,o)=>{const l=this.httpApi.get({...this.parsedUrl,headers:i},f=>{const y=new Promise(w=>{const b=[];f.on("data",I=>{b.push(I)}),f.on("end",()=>{const I=Buffer.concat(b).buffer;w(I)}),f.on("error",o)});e(new cT(f,y))});l.on("error",o),t&&(t.aborted&&l.destroy(new Ap("Request aborted")),t.addEventListener("abort",()=>l.destroy(new Ap("Request aborted"))))})}async request(){let{headers:i,signal:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return await this.constructRequest(i,t)}}class Gy extends ky{constructor(i,t,e,o){super(),this.client=i,this.headers=t,this.maxRanges=e,this.allowFullFile=o,this._fileSize=null}async fetch(i,t){return this.maxRanges>=i.length?this.fetchSlices(i,t):(this.maxRanges>0&&i.length,Promise.all(i.map(e=>this.fetchSlice(e,t))))}async fetchSlices(i,t){const e=await this.client.request({headers:{...this.headers,Range:`bytes=${i.map(o=>{let{offset:l,length:f}=o;return`${l}-${l+f}`}).join(",")}`},signal:t});if(e.ok){if(e.status===206){const{type:o,params:l}=function(N){const[D,...j]=N.split(";").map(H=>H.trim());return{type:D,params:V_(j.map(H=>H.split("=")))}}(e.getHeader("content-type"));if(o==="multipart/byteranges"){const N=function(D,j){let H=null;const Z=new TextDecoder("ascii"),it=[],at=`--${j}`,wt=`${at}--`;for(let gt=0;gt<10;++gt)Z.decode(new Uint8Array(D,gt,at.length))===at&&(H=gt);if(H===null)throw new Error("Could not find initial boundary");for(;H<D.byteLength;){const gt=Z.decode(new Uint8Array(D,H,Math.min(at.length+1024,D.byteLength-H)));if(gt.length===0||gt.startsWith(wt))break;if(!gt.startsWith(at))throw new Error("Part does not start with boundary");const yt=gt.substr(at.length+2);if(yt.length===0)break;const It=yt.indexOf(z_),Rt=$C(yt.substr(0,It)),{start:kt,end:Dt,total:Xt}=Ry(Rt["content-range"]),ee=H+at.length+It+z_.length,pe=parseInt(Dt,10)+1-parseInt(kt,10);it.push({headers:Rt,data:D.slice(ee,ee+pe),offset:kt,length:pe,fileSize:Xt}),H=ee+pe+4}return it}(await e.getData(),l.boundary);return this._fileSize=N[0].fileSize||null,N}const f=await e.getData(),{start:y,end:w,total:b}=Ry(e.getHeader("content-range"));this._fileSize=b||null;const I=[{data:f,offset:y,length:w-y}];if(i.length>1){const N=await Promise.all(i.slice(1).map(D=>this.fetchSlice(D,t)));return I.concat(N)}return I}{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await e.getData();return this._fileSize=o.byteLength,[{data:o,offset:0,length:o.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(i,t){const{offset:e,length:o}=i,l=await this.client.request({headers:{...this.headers,Range:`bytes=${e}-${e+o}`},signal:t});if(l.ok){if(l.status===206){const f=await l.getData(),{total:y}=Ry(l.getHeader("content-range"));return this._fileSize=y||null,{data:f,offset:e,length:o}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const f=await l.getData();return this._fileSize=f.byteLength,{data:f,offset:0,length:f.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function jy(s,i){let{blockSize:t,cacheSize:e}=i;return t===null?s:new eT(s,t,e)}function hT(s){let{headers:i={},credentials:t,maxRanges:e=0,allowFullFile:o=!1,...l}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const f=new iT(s,t),y=new Gy(f,i,e,o);return jy(y,l)}function pT(s){let{headers:i={},maxRanges:t=0,allowFullFile:e=!1,...o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=new oT(s),f=new Gy(l,i,t,e);return jy(f,o)}function fT(s){let{headers:i={},maxRanges:t=0,allowFullFile:e=!1,...o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=new uT(s),f=new Gy(l,i,t,e);return jy(f,o)}function By(s){let{forceXHR:i=!1,...t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return typeof fetch!="function"||i?typeof XMLHttpRequest<"u"?pT(s,t):fT(s,t):hT(s,t)}class dT extends ky{constructor(i){super(),this.file=i}async fetchSlice(i,t){return new Promise((e,o)=>{const l=this.file.slice(i.offset,i.offset+i.length),f=new FileReader;f.onload=y=>e(y.target.result),f.onerror=o,f.onabort=o,f.readAsArrayBuffer(l),t&&t.addEventListener("abort",()=>f.abort())})}}function zy(s){switch(s){case Hr.sf.BYTE:case Hr.sf.ASCII:case Hr.sf.SBYTE:case Hr.sf.UNDEFINED:return 1;case Hr.sf.SHORT:case Hr.sf.SSHORT:return 2;case Hr.sf.LONG:case Hr.sf.SLONG:case Hr.sf.FLOAT:case Hr.sf.IFD:return 4;case Hr.sf.RATIONAL:case Hr.sf.SRATIONAL:case Hr.sf.DOUBLE:case Hr.sf.LONG8:case Hr.sf.SLONG8:case Hr.sf.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${s}`)}}function Op(s,i,t,e){let o=null,l=null;const f=zy(i);switch(i){case Hr.sf.BYTE:case Hr.sf.ASCII:case Hr.sf.UNDEFINED:o=new Uint8Array(t),l=s.readUint8;break;case Hr.sf.SBYTE:o=new Int8Array(t),l=s.readInt8;break;case Hr.sf.SHORT:o=new Uint16Array(t),l=s.readUint16;break;case Hr.sf.SSHORT:o=new Int16Array(t),l=s.readInt16;break;case Hr.sf.LONG:case Hr.sf.IFD:o=new Uint32Array(t),l=s.readUint32;break;case Hr.sf.SLONG:o=new Int32Array(t),l=s.readInt32;break;case Hr.sf.LONG8:case Hr.sf.IFD8:o=new Array(t),l=s.readUint64;break;case Hr.sf.SLONG8:o=new Array(t),l=s.readInt64;break;case Hr.sf.RATIONAL:o=new Uint32Array(2*t),l=s.readUint32;break;case Hr.sf.SRATIONAL:o=new Int32Array(2*t),l=s.readInt32;break;case Hr.sf.FLOAT:o=new Float32Array(t),l=s.readFloat32;break;case Hr.sf.DOUBLE:o=new Float64Array(t),l=s.readFloat64;break;default:throw new RangeError(`Invalid field type: ${i}`)}if(i!==Hr.sf.RATIONAL&&i!==Hr.sf.SRATIONAL)for(let y=0;y<t;++y)o[y]=l.call(s,e+y*f);else for(let y=0;y<t;y+=2)o[y]=l.call(s,e+y*f),o[y+1]=l.call(s,e+(y*f+4));return i===Hr.sf.ASCII?new TextDecoder("utf-8").decode(o):o}class gT{constructor(i,t,e){this.fileDirectory=i,this.geoKeyDirectory=t,this.nextIFDByteOffset=e}}class Eg extends Error{constructor(i){super(`No image at index ${i}`),this.index=i}}class H_{async readRasters(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{window:t,width:e,height:o}=i;let{resX:l,resY:f,bbox:y}=i;const w=await this.getImage();let b=w;const I=await this.getImageCount(),N=w.getBoundingBox();if(t&&y)throw new Error('Both "bbox" and "window" passed.');if(e||o){if(t){const[H,Z]=w.getOrigin(),[it,at]=w.getResolution();y=[H+t[0]*it,Z+t[1]*at,H+t[2]*it,Z+t[3]*at]}const j=y||N;if(e){if(l)throw new Error("Both width and resX passed");l=(j[2]-j[0])/e}if(o){if(f)throw new Error("Both width and resY passed");f=(j[3]-j[1])/o}}if(l||f){const j=[];for(let H=0;H<I;++H){const Z=await this.getImage(H),{SubfileType:it,NewSubfileType:at}=Z.fileDirectory;(H===0||it===2||1&at)&&j.push(Z)}j.sort((H,Z)=>H.getWidth()-Z.getWidth());for(let H=0;H<j.length;++H){const Z=j[H],it=(N[2]-N[0])/Z.getWidth(),at=(N[3]-N[1])/Z.getHeight();if(b=Z,l&&l>it||f&&f>at)break}}let D=t;if(y){const[j,H]=w.getOrigin(),[Z,it]=b.getResolution(w);D=[Math.round((y[0]-j)/Z),Math.round((y[1]-H)/it),Math.round((y[2]-j)/Z),Math.round((y[3]-H)/it)],D=[Math.min(D[0],D[2]),Math.min(D[1],D[3]),Math.max(D[0],D[2]),Math.max(D[1],D[3])]}return b.readRasters({...i,window:D})}}class Np extends H_{constructor(i,t,e,o){let l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};super(),this.source=i,this.littleEndian=t,this.bigTiff=e,this.firstIFDOffset=o,this.cache=l.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(i,t){const e=this.bigTiff?4048:1024;return new ZC((await this.source.fetch([{offset:i,length:t!==void 0?t:e}]))[0],i,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(i){const t=this.bigTiff?20:12,e=this.bigTiff?8:2;let o=await this.getSlice(i);const l=this.bigTiff?o.readUint64(i):o.readUint16(i),f=l*t+(this.bigTiff?16:6);o.covers(i,f)||(o=await this.getSlice(i,f));const y={};let w=i+(this.bigTiff?8:2);for(let N=0;N<l;w+=t,++N){const D=o.readUint16(w),j=o.readUint16(w+2),H=this.bigTiff?o.readUint64(w+4):o.readUint32(w+4);let Z,it;const at=zy(j),wt=w+(this.bigTiff?12:8);if(at*H<=(this.bigTiff?8:4))Z=Op(o,j,H,wt);else{const gt=o.readOffset(wt),yt=zy(j)*H;o.covers(gt,yt)?Z=Op(o,j,H,gt):Z=Op(await this.getSlice(gt,yt),j,H,gt)}it=H===1&&Hr.It.indexOf(D)===-1&&j!==Hr.sf.RATIONAL&&j!==Hr.sf.SRATIONAL?Z[0]:Z,y[Hr.L[D]]=it}const b=function(N){const D=N.GeoKeyDirectory;if(!D)return null;const j={};for(let H=4;H<=4*D[3];H+=4){const Z=Hr.P1[D[H]],it=D[H+1]?Hr.L[D[H+1]]:null,at=D[H+2],wt=D[H+3];let gt=null;if(it){if(gt=N[it],gt==null)throw new Error(`Could not get value of geoKey '${Z}'.`);typeof gt=="string"?gt=gt.substring(wt,wt+at-1):gt.subarray&&(gt=gt.subarray(wt,wt+at),at===1&&(gt=gt[0]))}else gt=wt;j[Z]=gt}return j}(y),I=o.readOffset(i+e+t*l);return new gT(y,b,I)}async requestIFD(i){if(this.ifdRequests[i])return this.ifdRequests[i];if(i===0)return this.ifdRequests[i]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[i];if(!this.ifdRequests[i-1])try{this.ifdRequests[i-1]=this.requestIFD(i-1)}catch(t){throw t instanceof Eg?new Eg(i):t}return this.ifdRequests[i]=(async()=>{const t=await this.ifdRequests[i-1];if(t.nextIFDByteOffset===0)throw new Eg(i);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[i]}async getImage(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const t=await this.requestIFD(i);return new B_(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let i=0,t=!0;for(;t;)try{await this.requestIFD(i),++i}catch(e){if(!(e instanceof Eg))throw e;t=!1}return i}async getGhostValues(){const i=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",e=t.length+100;let o=await this.getSlice(i,e);if(t===Op(o,Hr.sf.ASCII,t.length,i)){const l=Op(o,Hr.sf.ASCII,e,i).split(`
`)[0],f=Number(l.split("=")[1].split(" ")[0])+l.length;f>e&&(o=await this.getSlice(i,f));const y=Op(o,Hr.sf.ASCII,f,i);this.ghostValues={},y.split(`
`).filter(w=>w.length>0).map(w=>w.split("=")).forEach(w=>{let[b,I]=w;this.ghostValues[b]=I})}return this.ghostValues}static async fromSource(i,t,e){const o=(await i.fetch([{offset:0,length:1024}],e))[0],l=new YC(o),f=l.getUint16(0,0);let y;if(f===18761)y=!0;else{if(f!==19789)throw new TypeError("Invalid byte order value.");y=!1}const w=l.getUint16(2,y);let b;if(w===42)b=!1;else{if(w!==43)throw new TypeError("Invalid magic number.");if(b=!0,l.getUint16(4,y)!==8)throw new Error("Unsupported offset byte-size.")}const I=b?l.getUint64(8,y):l.getUint32(4,y);return new Np(i,y,b,I,t)}close(){return typeof this.source.close=="function"&&this.source.close()}}class mT extends H_{constructor(i,t){super(),this.mainFile=i,this.overviewFiles=t,this.imageFiles=[i].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const i=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(i),this.fileDirectoriesPerFile}async getImage(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,e=0;for(let o=0;o<this.imageFiles.length;o++){const l=this.imageFiles[o];for(let f=0;f<this.imageCounts[o];f++){if(i===t){const y=await l.requestIFD(e);return new B_(y.fileDirectory,y.geoKeyDirectory,l.dataView,l.littleEndian,l.cache,l.source)}t++,e++}e=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const i=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(i),this.imageCount=this.imageCounts.reduce((t,e)=>t+e,0),this.imageCount}}async function yT(s,i){return Np.fromSource(new dT(s),i)}const vT=typeof navigator<"u"&&navigator.hardwareConcurrency||2;var Vy,_T=class{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vT,i=arguments.length>1?arguments[1]:void 0;this.workers=null,this._awaitingDecoder=null,this.size=s,this.messageId=0,s&&(this._awaitingDecoder=i?Promise.resolve(i):new Promise(t=>{x.e(231).then(x.bind(x,231)).then(e=>{t(e.create)})}),this._awaitingDecoder.then(t=>{this._awaitingDecoder=null,this.workers=[];for(let e=0;e<s;e++)this.workers.push({worker:t(),idle:!0})}))}async decode(s,i){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?j_(s).then(t=>t.decode(s,i)):new Promise(t=>{const e=this.workers.find(f=>f.idle)||this.workers[Math.floor(Math.random()*this.size)];e.idle=!1;const o=this.messageId++,l=f=>{f.data.id===o&&(e.idle=!0,t(f.data.decoded),e.worker.removeEventListener("message",l))};e.worker.addEventListener("message",l),e.worker.postMessage({fileDirectory:s,buffer:i,id:o},[i])})}destroy(){this.workers&&(this.workers.forEach(s=>{s.worker.terminate()}),this.workers=null)}},xT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),wT="STATISTICS_MAXIMUM",bT="STATISTICS_MINIMUM";function ST(s){try{return s.getBoundingBox()}catch{var i=s.fileDirectory;return[0,0,i.ImageWidth,i.ImageLength]}}function ET(s){try{return s.getOrigin().slice(0,2)}catch{return[0,s.fileDirectory.ImageLength]}}function CT(s,i){try{return s.getResolution(i)}catch{return[i.fileDirectory.ImageWidth/s.fileDirectory.ImageWidth,i.fileDirectory.ImageHeight/s.fileDirectory.ImageHeight]}}function TT(s){var i=s.geoKeys;if(!i)return null;if(i.ProjectedCSTypeGeoKey)return(e=ie(t="EPSG:"+i.ProjectedCSTypeGeoKey))||(o=Ln(i.ProjLinearUnitsGeoKey))&&(e=new q({code:t,units:o})),e;if(i.GeographicTypeGeoKey){var t,e,o;return(e=ie(t="EPSG:"+i.GeographicTypeGeoKey))||(o=Ln(i.GeogAngularUnitsGeoKey))&&(e=new q({code:t,units:o})),e}return null}function PT(s){return s.getImageCount().then(function(i){for(var t=new Array(i),e=0;e<i;++e)t[e]=s.getImage(e);return Promise.all(t)})}function IT(s,i){return(s.blob?yT(s.blob):s.overviews?async function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0;const f=await Np.fromSource(By(t,o),l),y=await Promise.all(e.map(w=>Np.fromSource(By(w,o))));return new mT(f,y)}(s.url,s.overviews,i):async function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Np.fromSource(By(t,e),o)}(s.url,i)).then(PT)}function $f(s,i,t,e,o){if(Array.isArray(s)){var l=s.length;if(!Array.isArray(i)||l!=i.length){var f=new Error(e);throw o(f),f}for(var y=0;y<l;++y)$f(s[y],i[y],t,e,o)}else if(i=i,Math.abs(s-i)>t*s)throw new Error(e)}function MT(s){return s instanceof Int8Array?-128:s instanceof Int16Array?-32768:s instanceof Int32Array?-2147483648:s instanceof Float32Array?12e-39:0}function LT(s){return s instanceof Int8Array?127:s instanceof Uint8Array||s instanceof Uint8ClampedArray?255:s instanceof Int16Array?32767:s instanceof Uint16Array?65535:s instanceof Int32Array?2147483647:s instanceof Uint32Array?4294967295:s instanceof Float32Array?34e37:255}var X_=function(s){function i(t){var e=s.call(this,{state:"loading",tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:t.interpolate!==!1,wrapX:t.wrapX})||this;e.Qa=t.sources;var o=e.Qa.length;e.th=t.sourceOptions,e.nh=new Array(o),e.ih=new Array(o),e.rh,e.eh,e.oh,e.sh=t.normalize!==!1,e.uh=!1,e.V=null,e.ah=t.convertToRGB?"readRGB":"readRasters",e.setKey(e.Qa.map(function(w){return w.url}).join(","));for(var l=e,f=new Array(o),y=0;y<o;++y)f[y]=IT(e.Qa[y],e.th);return Promise.all(f).then(function(w){l.hh(w)}).catch(function(w){console.error(w),l.V=w,l.setState("error")}),e}return xT(i,s),i.prototype.getError=function(){return this.V},i.prototype.hh=function(t){for(var e,o,l,f,y,w=new Array(t.length),b=new Array(t.length),I=new Array(t.length),N=0,D=t.length,j=function(ee){var pe=t[ee],xe=pe.length,fe=void 0,Re=void 0,qe=new Array(xe),Ge=new Array(xe),Qe=new Array(xe);b[ee]=new Array(xe),I[ee]=new Array(xe);for(var ir=0;ir<xe;++ir){var de=pe[ir],Nr=de.getGDALNoData();I[ee][ir]=de.getGDALMetadata(0),b[ee][ir]=Nr;var Pr=H.Qa[ee].bands;w[ee]=Pr?Pr.length:de.getSamplesPerPixel();var he=xe-(ir+1);fe||(fe=ST(de)),Re||(Re=ET(de));var $e=CT(de,pe[0]);Qe[he]=$e[0];var or=[de.getTileWidth(),de.getTileHeight()];qe[he]=or;var fi=$e[0]/Math.abs($e[1]);Ge[he]=[or[0],or[1]/fi]}if(e?fn(e,fe,e):e=fe,o){var ki="Origin mismatch for source ".concat(ee,", got [").concat(Re,"] but expected [").concat(o,"]");$f(o,Re,0,ki,H.viewRejector)}else o=Re;if(y){y.length-N>Qe.length&&(N=y.length-Qe.length);var Sn=y[y.length-1]/Qe[Qe.length-1];H.ih[ee]=Sn;var tr=Qe.map(function(Jn){return Jn*Sn});ki="Resolution mismatch for source ".concat(ee,", got [").concat(tr,"] but expected [").concat(y,"]"),$f(y.slice(N,y.length),tr,.02,ki,H.viewRejector)}else y=Qe,H.ih[ee]=1;l?$f(l.slice(N,l.length),Ge,.01,"Tile size mismatch for source ".concat(ee),H.viewRejector):l=Ge,f?$f(f.slice(N,f.length),qe,0,"Tile size mismatch for source ".concat(ee),H.viewRejector):f=qe,H.nh[ee]=pe.reverse()},H=this,Z=0;Z<D;++Z)j(Z);for(var it=0,at=this.nh.length;it<at;++it)for(var wt=this.nh[it];wt.length<y.length;)wt.unshift(void 0);if(!this.getProjection()){var gt=t[0];for(it=gt.length-1;it>=0;--it){var yt=TT(gt[it]);if(yt){this.projection=yt;break}}}this.rh=w,this.eh=b,this.oh=I;t:for(Z=0;Z<D;++Z){if(this.Qa[Z].nodata!==void 0){this.uh=!0;break}var It=b[Z],Rt=this.Qa[Z].bands;if(Rt){for(it=0;it<Rt.length;++it)if(It[Rt[it]-1]!==null){this.uh=!0;break t}}else for(var kt=0;kt<It.length;++kt)if(It[kt]!==null){this.uh=!0;break t}}var Dt=this.uh?1:0;this.bandCount=w.reduce(function(ee,pe){return ee+=pe},0)+Dt;var Xt=new ql({extent:e,minZoom:N,origin:o,resolutions:y,tileSizes:l});this.tileGrid=Xt,this.setTileSizes(f),this.setLoader(this.fh.bind(this)),this.setState("ready"),this.viewResolver({projection:this.projection,resolutions:y,center:Io(Gi(e),this.projection),extent:na(e,this.projection),zoom:0})},i.prototype.fh=function(t,e,o){for(var l=this.getTileSize(t),f=this.nh.length,y=new Array(f),w=this.uh,b=this.bandCount,I=this.rh,N=this.eh,D=this.Qa,j=function(yt){var It=D[yt],Rt=H.ih[yt],kt=[Math.round(e*(l[0]*Rt)),Math.round(o*(l[1]*Rt)),Math.round((e+1)*(l[0]*Rt)),Math.round((o+1)*(l[1]*Rt))],Dt=H.nh[yt][t],Xt=void 0;It.bands&&(Xt=It.bands.map(function(pe){return pe-1}));var ee=void 0;ee="nodata"in It&&It.nodata!==null?It.nodata:Xt?Xt.map(function(pe){return N[yt][pe]}):N[yt],y[yt]=Dt[H.ah]({window:kt,width:l[0],height:l[1],samples:Xt,fillValue:ee,pool:(Vy||(Vy=new _T),Vy),interleave:!1})},H=this,Z=0;Z<f;++Z)j(Z);var it=l[0]*l[1],at=it*b,wt=this.sh,gt=this.oh;return Promise.all(y).then(function(yt){var It;It=wt?new Uint8Array(at):new Float32Array(at);for(var Rt=0,kt=0;kt<it;++kt){for(var Dt=w,Xt=0;Xt<f;++Xt){var ee=D[Xt],pe=ee.min,xe=ee.max,fe=void 0,Re=void 0;if(wt){var qe=gt[Xt][0];pe===void 0&&(pe=qe&&bT in qe?parseFloat(qe.STATISTICS_MINIMUM):MT(yt[Xt][0])),xe===void 0&&(xe=qe&&wT in qe?parseFloat(qe.STATISTICS_MAXIMUM):LT(yt[Xt][0])),Re=-pe*(fe=255/(xe-pe))}for(var Ge=0;Ge<I[Xt];++Ge){var Qe=yt[Xt][Ge][kt],ir=void 0;if(ir=wt?Y(fe*Qe+Re,0,255):Qe,w){var de=ee.nodata;if(de===void 0){var Nr=void 0;Nr=ee.bands?ee.bands[Ge]-1:Ge,de=N[Xt][Nr]}var Pr=isNaN(de);(!Pr&&Qe!==de||Pr&&!isNaN(Qe))&&(Dt=!1,It[Rt]=ir)}else It[Rt]=ir;Rt++}}w&&(Dt||(It[Rt]=255),Rt++)}return It}).catch(function(yt){throw console.error(yt),yt})},i}(k_);X_.prototype.getView;var AT=X_,W_=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Y_="default",OT="truncated",Uy=function(s){function i(t,e,o,l,f,y,w){var b=s.call(this,e,o,l,f,y,w)||this;return b.lh=null,b.jo=t,b}return W_(i,s),i.prototype.getImage=function(){if(this.lh)return this.lh;var t=s.prototype.getImage.call(this);if(this.state==Oe){var e=this.jo;if(t.width==e[0]&&t.height==e[1])return this.lh=t,t;var o=Cn(e[0],e[1]);return o.drawImage(t,0,0),this.lh=o.canvas,o.canvas}return t},i}(fc),NT=function(s){function i(t){var e=this,o=t,l=o.imageSmoothing===void 0||o.imageSmoothing;o.interpolate!==void 0&&(l=o.interpolate);var f=o.size,y=o.tierSizeCalculation!==void 0?o.tierSizeCalculation:Y_,w=o.tilePixelRatio||1,b=f[0],I=f[1],N=[],D=o.tileSize||Ys,j=D*w;switch(y){case Y_:for(;b>j||I>j;)N.push([Math.ceil(b/j),Math.ceil(I/j)]),j+=j;break;case OT:for(var H=b,Z=I;H>j||Z>j;)N.push([Math.ceil(H/j),Math.ceil(Z/j)]),H>>=1,Z>>=1;break;default:Me(!1,53)}N.push([1,1]),N.reverse();for(var it=[w],at=[0],wt=1,gt=N.length;wt<gt;wt++)it.push(w<<wt),at.push(N[wt-1][0]*N[wt-1][1]+at[wt-1]);it.reverse();var yt=new ql({tileSize:D,extent:o.extent||[0,-I,b,0],resolutions:it}),It=o.url;It&&It.indexOf("{TileGroup}")==-1&&It.indexOf("{tileIndex}")==-1&&(It+="{TileGroup}/{z}-{x}-{y}.jpg");var Rt=cg(It),kt=D*w,Dt=wp(Rt.map(function(xe){return function(fe,Re,qe){if(fe){var Ge=fe[0],Qe=fe[1],ir=fe[2],de=Qe+ir*N[Ge][0],Nr={z:Ge,x:Qe,y:ir,tileIndex:de,TileGroup:"TileGroup"+((de+at[Ge])/kt|0)};return xe.replace(/\{(\w+?)\}/g,function(Pr,he){return Nr[he]})}}})),Xt=Uy.bind(null,Pn(D*w));(e=s.call(this,{attributions:o.attributions,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:l,projection:o.projection,tilePixelRatio:w,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileClass:Xt,tileGrid:yt,tileUrlFunction:Dt,transition:o.transition})||this).zDirection=o.zDirection;var ee=Dt(yt.getTileCoordForCoordAndResolution(Gi(yt.getExtent()),it[it.length-1]),1,null),pe=new Image;return pe.addEventListener("error",function(){kt=D,this.changed()}.bind(e)),pe.src=ee,e}return W_(i,s),i}(Yl),gs=function(s,i,t){if(t||arguments.length===2)for(var e,o=0,l=i.length;o<l;o++)!e&&o in i||(e||(e=Array.prototype.slice.call(i,0,o)),e[o]=i[o]);return s.concat(e||Array.prototype.slice.call(i))},mu="version1",Kf="version2",Sh="version3",Eh={};Eh[mu]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},Eh[Kf]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},Eh[Sh]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},Eh.none={none:{supports:[],formats:[],qualities:[]}};var RT=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,Z_=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,kT=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/,Cg={};Cg[mu]=function(s){var i=s.getComplianceLevelSupportedFeatures();return i===void 0&&(i=Eh[mu].level0),{url:s.imageInfo["@id"]===void 0?void 0:s.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:i.supports,formats:gs(gs([],i.formats,!0),[s.imageInfo.formats===void 0?[]:s.imageInfo.formats],!1),qualities:gs(gs([],i.qualities,!0),[s.imageInfo.qualities===void 0?[]:s.imageInfo.qualities],!1),resolutions:s.imageInfo.scale_factors,tileSize:s.imageInfo.tile_width!==void 0?s.imageInfo.tile_height!==void 0?[s.imageInfo.tile_width,s.imageInfo.tile_height]:[s.imageInfo.tile_width,s.imageInfo.tile_width]:s.imageInfo.tile_height!=null?[s.imageInfo.tile_height,s.imageInfo.tile_height]:void 0}},Cg[Kf]=function(s){var i=s.getComplianceLevelSupportedFeatures(),t=Array.isArray(s.imageInfo.profile)&&s.imageInfo.profile.length>1,e=t&&s.imageInfo.profile[1].supports?s.imageInfo.profile[1].supports:[],o=t&&s.imageInfo.profile[1].formats?s.imageInfo.profile[1].formats:[],l=t&&s.imageInfo.profile[1].qualities?s.imageInfo.profile[1].qualities:[];return{url:s.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:s.imageInfo.sizes===void 0?void 0:s.imageInfo.sizes.map(function(f){return[f.width,f.height]}),tileSize:s.imageInfo.tiles===void 0?void 0:[s.imageInfo.tiles.map(function(f){return f.width})[0],s.imageInfo.tiles.map(function(f){return f.height===void 0?f.width:f.height})[0]],resolutions:s.imageInfo.tiles===void 0?void 0:s.imageInfo.tiles.map(function(f){return f.scaleFactors})[0],supports:gs(gs([],i.supports,!0),e,!0),formats:gs(gs([],i.formats,!0),o,!0),qualities:gs(gs([],i.qualities,!0),l,!0)}},Cg[Sh]=function(s){var i=s.getComplianceLevelSupportedFeatures(),t=s.imageInfo.extraFormats===void 0?i.formats:gs(gs([],i.formats,!0),s.imageInfo.extraFormats,!0),e=s.imageInfo.preferredFormats!==void 0&&Array.isArray(s.imageInfo.preferredFormats)&&s.imageInfo.preferredFormats.length>0?s.imageInfo.preferredFormats.filter(function(o){return pt(["jpg","png","gif"],o)}).reduce(function(o,l){return o===void 0&&pt(t,l)?l:o},void 0):void 0;return{url:s.imageInfo.id,sizes:s.imageInfo.sizes===void 0?void 0:s.imageInfo.sizes.map(function(o){return[o.width,o.height]}),tileSize:s.imageInfo.tiles===void 0?void 0:[s.imageInfo.tiles.map(function(o){return o.width})[0],s.imageInfo.tiles.map(function(o){return o.height})[0]],resolutions:s.imageInfo.tiles===void 0?void 0:s.imageInfo.tiles.map(function(o){return o.scaleFactors})[0],supports:s.imageInfo.extraFeatures===void 0?i.supports:gs(gs([],i.supports,!0),s.imageInfo.extraFeatures,!0),formats:t,qualities:s.imageInfo.extraQualities===void 0?i.qualities:gs(gs([],i.qualities,!0),s.imageInfo.extraQualities,!0),preferredFormat:e}};var FT=function(){function s(i){this.setImageInfo(i)}return s.prototype.setImageInfo=function(i){this.imageInfo=typeof i=="string"?JSON.parse(i):i},s.prototype.getImageApiVersion=function(){if(this.imageInfo!==void 0){var i=this.imageInfo["@context"]||"ol-no-context";typeof i=="string"&&(i=[i]);for(var t=0;t<i.length;t++)switch(i[t]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return mu;case"http://iiif.io/api/image/2/context.json":return Kf;case"http://iiif.io/api/image/3/context.json":return Sh;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(mu)&&this.imageInfo.identifier)return mu}Me(!1,61)}},s.prototype.getComplianceLevelEntryFromProfile=function(i){if(this.imageInfo!==void 0&&this.imageInfo.profile!==void 0)switch(i===void 0&&(i=this.getImageApiVersion()),i){case mu:if(RT.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Sh:if(kT.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Kf:if(typeof this.imageInfo.profile=="string"&&Z_.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&typeof this.imageInfo.profile[0]=="string"&&Z_.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}},s.prototype.getComplianceLevelFromProfile=function(i){var t=this.getComplianceLevelEntryFromProfile(i);if(t!==void 0){var e=t.match(/level[0-2](?:\.json)?$/g);return Array.isArray(e)?e[0].replace(".json",""):void 0}},s.prototype.getComplianceLevelSupportedFeatures=function(){if(this.imageInfo!==void 0){var i=this.getImageApiVersion(),t=this.getComplianceLevelFromProfile(i);return t===void 0?Eh.none.none:Eh[i][t]}},s.prototype.getTileSourceOptions=function(i){var t=i||{},e=this.getImageApiVersion();if(e!==void 0){var o=e===void 0?void 0:Cg[e](this);if(o!==void 0)return{url:o.url,version:e,size:[this.imageInfo.width,this.imageInfo.height],sizes:o.sizes,format:t.format!==void 0&&pt(o.formats,t.format)?t.format:o.preferredFormat!==void 0?o.preferredFormat:"jpg",supports:o.supports,quality:t.quality&&pt(o.qualities,t.quality)?t.quality:pt(o.qualities,"native")?"native":"default",resolutions:Array.isArray(o.resolutions)?o.resolutions.sort(function(l,f){return f-l}):void 0,tileSize:o.tileSize}}},s}(),DT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Jf(s){return s.toLocaleString("en",{maximumFractionDigits:10})}var GT=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;o.interpolate!==void 0&&(l=o.interpolate);var f=o.url||"";f+=f.lastIndexOf("/")===f.length-1||f===""?"":"/";var y=o.version||Kf,w=o.sizes||[],b=o.size;Me(b!=null&&Array.isArray(b)&&b.length==2&&!isNaN(b[0])&&b[0]>0&&!isNaN(b[1])&&b[1]>0,60);var I,N,D,j=b[0],H=b[1],Z=o.tileSize,it=o.tilePixelRatio||1,at=o.format||"jpg",wt=o.quality||(o.version==mu?"native":"default"),gt=o.resolutions||[],yt=o.supports||[],It=o.extent||[0,-H,j,0],Rt=w!=null&&Array.isArray(w)&&w.length>0,kt=Z!==void 0&&(typeof Z=="number"&&Number.isInteger(Z)&&Z>0||Array.isArray(Z)&&Z.length>0),Dt=yt!=null&&Array.isArray(yt)&&(pt(yt,"regionByPx")||pt(yt,"regionByPct"))&&(pt(yt,"sizeByWh")||pt(yt,"sizeByH")||pt(yt,"sizeByW")||pt(yt,"sizeByPct"));if(gt.sort(function(qe,Ge){return Ge-qe}),kt||Dt)if(Z!=null&&(typeof Z=="number"&&Number.isInteger(Z)&&Z>0?(I=Z,N=Z):Array.isArray(Z)&&Z.length>0&&((Z.length==1||Z[1]==null&&Number.isInteger(Z[0]))&&(I=Z[0],N=Z[0]),Z.length==2&&(Number.isInteger(Z[0])&&Number.isInteger(Z[1])?(I=Z[0],N=Z[1]):Z[0]==null&&Number.isInteger(Z[1])&&(I=Z[1],N=Z[1])))),I!==void 0&&N!==void 0||(I=Ys,N=Ys),gt.length==0)for(var Xt=D=Math.max(Math.ceil(Math.log(j/I)/Math.LN2),Math.ceil(Math.log(H/N)/Math.LN2));Xt>=0;Xt--)gt.push(Math.pow(2,Xt));else{var ee=Math.max.apply(Math,gt);D=Math.round(Math.log(ee)/Math.LN2)}else if(I=j,N=H,gt=[],Rt){w.sort(function(qe,Ge){return qe[0]-Ge[0]}),D=-1;var pe=[];for(Xt=0;Xt<w.length;Xt++){var xe=j/w[Xt][0];gt.length>0&&gt[gt.length-1]==xe?pe.push(Xt):(gt.push(xe),D++)}if(pe.length>0)for(Xt=0;Xt<pe.length;Xt++)w.splice(pe[Xt]-Xt,1)}else gt.push(1),w.push([j,H]),D=0;var fe=new ql({tileSize:[I,N],extent:It,origin:Zr(It),resolutions:gt}),Re=Uy.bind(null,Pn(Z||256).map(function(qe){return qe*it}));return(e=s.call(this,{attributions:o.attributions,attributionsCollapsible:o.attributionsCollapsible,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:l,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,state:o.state,tileClass:Re,tileGrid:fe,tilePixelRatio:o.tilePixelRatio,tileUrlFunction:function(qe,Ge,Qe){var ir,de,Nr=qe[0];if(!(Nr>D)){var Pr=qe[1],he=qe[2],$e=gt[Nr];if(!(Pr===void 0||he===void 0||$e===void 0||Pr<0||Math.ceil(j/$e/I)<=Pr||he<0||Math.ceil(H/$e/N)<=he)){if(Dt||kt){var or=Pr*I*$e,fi=he*N*$e,ki=I*$e,Sn=N*$e,tr=I,Jn=N;or+ki>j&&(ki=j-or),fi+Sn>H&&(Sn=H-fi),or+I*$e>j&&(tr=Math.floor((j-or+$e-1)/$e)),fi+N*$e>H&&(Jn=Math.floor((H-fi+$e-1)/$e)),or==0&&ki==j&&fi==0&&Sn==H?ir="full":!Dt||pt(yt,"regionByPx")?ir=or+","+fi+","+ki+","+Sn:pt(yt,"regionByPct")&&(ir="pct:"+Jf(or/j*100)+","+Jf(fi/H*100)+","+Jf(ki/j*100)+","+Jf(Sn/H*100)),y!=Sh||Dt&&!pt(yt,"sizeByWh")?!Dt||pt(yt,"sizeByW")?de=tr+",":pt(yt,"sizeByH")?de=","+Jn:pt(yt,"sizeByWh")?de=tr+","+Jn:pt(yt,"sizeByPct")&&(de="pct:"+Jf(100/$e)):de=tr+","+Jn}else if(ir="full",Rt){var Vo=w[Nr][0],Hn=w[Nr][1];de=y==Sh?Vo==j&&Hn==H?"max":Vo+","+Hn:Vo==j?"full":Vo+","}else de=y==Sh?"max":"full";return f+ir+"/"+de+"/0/"+wt+"."+at}}},transition:o.transition})||this).zDirection=o.zDirection,e}return DT(i,s),i}(Yl),jT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$_=function(s){function i(t,e,o,l,f,y,w){var b=this,I=t.getExtent(),N=e.getExtent(),D=N?fn(o,N):o,j=xp(t,e,Gi(D),l),H=new dy(t,e,D,I,.5*j,l),Z=y(H.calculateSourceExtent(),j,f),it=Z?co:$u,at=Z?Z.getPixelRatio():1;return(b=s.call(this,o,l,at,it)||this).vs=e,b.ps=I,b.Is=H,b.wi=l,b.dh=o,b.ph=Z,b.yh=at,b.da=w,b.qt=null,b.mh=null,b}return jT(i,s),i.prototype.disposeInternal=function(){this.state==Oa&&this.wh(),s.prototype.disposeInternal.call(this)},i.prototype.getImage=function(){return this.qt},i.prototype.getProjection=function(){return this.vs},i.prototype.Ns=function(){var t=this.ph.getState();if(t==Nn){var e=Gr(this.dh)/this.wi,o=Ki(this.dh)/this.wi;this.qt=sy(e,o,this.yh,this.ph.getResolution(),this.ps,this.wi,this.dh,this.Is,[{extent:this.ph.getExtent(),image:this.ph.getImage()}],0,void 0,this.da)}this.state=t,this.changed()},i.prototype.load=function(){if(this.state==co){this.state=Oa,this.changed();var t=this.ph.getState();t==Nn||t==ca?this.Ns():(this.mh=Ee(this.ph,ne,function(e){var o=this.ph.getState();o!=Nn&&o!=ca||(this.wh(),this.Ns())},this),this.ph.load())}},i.prototype.wh=function(){Or(this.mh),this.mh=null},i}(hc),K_=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),BT="imageloadstart",zT="imageloadend",VT="imageloaderror",J_=function(s){function i(t,e){var o=s.call(this,t)||this;return o.image=e,o}return K_(i,s),i}(O);function Qf(s,i){s.getImage().src=i}var yu=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(o=t.interpolate),(e=s.call(this,{attributions:t.attributions,projection:t.projection,state:t.state,interpolate:o})||this).on,e.once,e.un,e.Ti=t.resolutions!==void 0?t.resolutions:null,e.gh=null,e.bh=0,e}return K_(i,s),i.prototype.getResolutions=function(){return this.Ti},i.prototype.findNearestResolution=function(t){if(this.Ti){var e=T(this.Ti,t,0);t=this.Ti[e]}return t},i.prototype.getImage=function(t,e,o,l){var f=this.getProjection();if(f&&l&&!an(f,l)){if(this.gh){if(this.bh==this.getRevision()&&an(this.gh.getProjection(),l)&&this.gh.getResolution()==e&&ko(this.gh.getExtent(),t))return this.gh;this.gh.dispose(),this.gh=null}return this.gh=new $_(f,l,t,e,o,function(y,w,b){return this.getImageInternal(y,w,b,f)}.bind(this),this.getInterpolate()),this.bh=this.getRevision(),this.gh}return f&&(l=f),this.getImageInternal(t,e,o,l)},i.prototype.getImageInternal=function(t,e,o,l){return E()},i.prototype.handleImageChange=function(t){var e,o=t.target;switch(o.getState()){case Oa:this.loading=!0,e=BT;break;case Nn:this.loading=!1,e=zT;break;case ca:this.loading=!1,e=VT;break;default:return}this.hasListener(e)&&this.dispatchEvent(new J_(e,o))},i}(Mp),UT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),qT=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;return o.interpolate!==void 0&&(l=o.interpolate),(e=s.call(this,{attributions:o.attributions,interpolate:l,projection:o.projection,resolutions:o.resolutions})||this).Bt=o.crossOrigin!==void 0?o.crossOrigin:null,e._a=o.hidpi===void 0||o.hidpi,e.Fe=o.url,e.Rt=o.imageLoadFunction!==void 0?o.imageLoadFunction:Qf,e.xh=o.params||{},e.Lt=null,e.Mh=[0,0],e._h=0,e.Sh=o.ratio!==void 0?o.ratio:1.5,e}return UT(i,s),i.prototype.getParams=function(){return this.xh},i.prototype.getImageInternal=function(t,e,o,l){if(this.Fe===void 0)return null;e=this.findNearestResolution(e),o=this._a?o:1;var f=this.Lt;if(f&&this._h==this.getRevision()&&f.getResolution()==e&&f.getPixelRatio()==o&&pn(f.getExtent(),t))return f;var y={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Vt(y,this.xh);var w=((t=t.slice())[0]+t[2])/2,b=(t[1]+t[3])/2;if(this.Sh!=1){var I=this.Sh*Gr(t)/2,N=this.Sh*Ki(t)/2;t[0]=w-I,t[1]=b-N,t[2]=w+I,t[3]=b+N}var D=e/o,j=Math.ceil(Gr(t)/D),H=Math.ceil(Ki(t)/D);t[0]=w-D*j/2,t[2]=w+D*j/2,t[1]=b-D*H/2,t[3]=b+D*H/2,this.Mh[0]=j,this.Mh[1]=H;var Z=this.Oh(t,this.Mh,o,l,y);return this.Lt=new pc(t,e,o,Z,this.Bt,this.Rt),this._h=this.getRevision(),this.Lt.addEventListener(ne,this.handleImageChange.bind(this)),this.Lt},i.prototype.getImageLoadFunction=function(){return this.Rt},i.prototype.Oh=function(t,e,o,l,f){var y=l.getCode().split(/:(?=\d+$)/).pop();f.SIZE=e[0]+","+e[1],f.BBOX=t.join(","),f.BBOXSR=y,f.IMAGESR=y,f.DPI=Math.round(90*o);var w=this.Fe,b=w.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return b==w&&Me(!1,50),Hl(b,f)},i.prototype.getUrl=function(){return this.Fe},i.prototype.setImageLoadFunction=function(t){this.Lt=null,this.Rt=t,this.changed()},i.prototype.setUrl=function(t){t!=this.Fe&&(this.Fe=t,this.Lt=null,this.changed())},i.prototype.updateParams=function(t){Vt(this.xh,t),this.Lt=null,this.changed()},i}(yu),HT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),XT=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;return o.interpolate!==void 0&&(l=o.interpolate),(e=s.call(this,{attributions:o.attributions,interpolate:l,projection:o.projection,resolutions:o.resolutions,state:o.state})||this).jh=o.canvasFunction,e.qt=null,e._h=0,e.Sh=o.ratio!==void 0?o.ratio:1.5,e}return HT(i,s),i.prototype.getImageInternal=function(t,e,o,l){e=this.findNearestResolution(e);var f=this.qt;if(f&&this._h==this.getRevision()&&f.getResolution()==e&&f.getPixelRatio()==o&&pn(f.getExtent(),t))return f;v(t=t.slice(),this.Sh);var y=[Gr(t)/e*o,Ki(t)/e*o],w=this.jh.call(this,t,e,o,y,l);return w&&(f=new $c(t,e,o,w)),this.qt=f,this._h=this.getRevision(),f},i}(yu),WT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),YT=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(o=t.interpolate),(e=s.call(this,{interpolate:o,projection:t.projection,resolutions:t.resolutions})||this).Bt=t.crossOrigin!==void 0?t.crossOrigin:null,e.Eh=t.displayDpi!==void 0?t.displayDpi:96,e.xh=t.params||{},e.Fe=t.url,e.Rt=t.imageLoadFunction!==void 0?t.imageLoadFunction:Qf,e._a=t.hidpi===void 0||t.hidpi,e.dt=t.metersPerUnit!==void 0?t.metersPerUnit:1,e.Sh=t.ratio!==void 0?t.ratio:1,e.Th=t.useOverlay!==void 0&&t.useOverlay,e.Lt=null,e._h=0,e}return WT(i,s),i.prototype.getParams=function(){return this.xh},i.prototype.getImageInternal=function(t,e,o,l){e=this.findNearestResolution(e),o=this._a?o:1;var f=this.Lt;if(f&&this._h==this.getRevision()&&f.getResolution()==e&&f.getPixelRatio()==o&&pn(f.getExtent(),t))return f;this.Sh!=1&&v(t=t.slice(),this.Sh);var y=[Gr(t)/e*o,Ki(t)/e*o];if(this.Fe!==void 0){var w=this.getUrl(this.Fe,this.xh,t,y,l);(f=new pc(t,e,o,w,this.Bt,this.Rt)).addEventListener(ne,this.handleImageChange.bind(this))}else f=null;return this.Lt=f,this._h=this.getRevision(),f},i.prototype.getImageLoadFunction=function(){return this.Rt},i.prototype.updateParams=function(t){Vt(this.xh,t),this.changed()},i.prototype.getUrl=function(t,e,o,l,f){var y=function(I,N,D,j){var H=Gr(I),Z=Ki(I),it=N[0],at=N[1],wt=.0254/j;return at*H>it*Z?H*D/(it*wt):Z*D/(at*wt)}(o,l,this.dt,this.Eh),w=Gi(o),b={OPERATION:this.Th?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.Eh,SETDISPLAYWIDTH:Math.round(l[0]),SETDISPLAYHEIGHT:Math.round(l[1]),SETVIEWSCALE:y,SETVIEWCENTERX:w[0],SETVIEWCENTERY:w[1]};return Vt(b,e),Hl(t,b)},i.prototype.setImageLoadFunction=function(t){this.Lt=null,this.Rt=t,this.changed()},i}(yu),ZT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$T=function(s){function i(t){var e=this,o=t.crossOrigin!==void 0?t.crossOrigin:null,l=t.imageLoadFunction!==void 0?t.imageLoadFunction:Qf,f=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(f=t.interpolate),(e=s.call(this,{attributions:t.attributions,interpolate:f,projection:ie(t.projection)})||this).Fe=t.url,e.Ah=t.imageExtent,e.Lt=new pc(e.Ah,void 0,1,e.Fe,o,l),e.Mh=t.imageSize?t.imageSize:null,e.Lt.addEventListener(ne,e.handleImageChange.bind(e)),e}return ZT(i,s),i.prototype.getImageExtent=function(){return this.Ah},i.prototype.getImageInternal=function(t,e,o,l){return on(t,this.Lt.getExtent())?this.Lt:null},i.prototype.getUrl=function(){return this.Fe},i.prototype.handleImageChange=function(t){if(this.Lt.getState()==Nn){var e=this.Lt.getExtent(),o=this.Lt.getImage(),l=void 0,f=void 0;this.Mh?(l=this.Mh[0],f=this.Mh[1]):(l=o.width,f=o.height);var y=Gr(e),w=Ki(e),b=y/l,I=w/f,N=l,D=f;if(b>I?N=Math.round(y/I):D=Math.round(w/b),N!==l||D!==f){var j=Cn(N,D);this.getInterpolate()||Vt(j,_p);var H=j.canvas;j.drawImage(o,0,0,l,f,0,0,H.width,H.height),this.Lt.setImage(H)}}s.prototype.handleImageChange.call(this,t)},i}(yu),Sc="1.3.0",KT=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Q_=[101,101],JT=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;return o.interpolate!==void 0&&(l=o.interpolate),(e=s.call(this,{attributions:o.attributions,interpolate:l,projection:o.projection,resolutions:o.resolutions})||this).Bt=o.crossOrigin!==void 0?o.crossOrigin:null,e.Fe=o.url,e.Rt=o.imageLoadFunction!==void 0?o.imageLoadFunction:Qf,e.xh=o.params||{},e.Ph=!0,e.Ch(),e.kh=o.serverType,e._a=o.hidpi===void 0||o.hidpi,e.Lt=null,e.Mh=[0,0],e._h=0,e.Sh=o.ratio!==void 0?o.ratio:1.5,e}return KT(i,s),i.prototype.getFeatureInfoUrl=function(t,e,o,l){if(this.Fe!==void 0){var f=ie(o),y=this.getProjection();y&&y!==f&&(e=xp(y,f,t,e),t=xo(t,f,y));var w=Po(t,e,0,Q_),b={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.xh.LAYERS};Vt(b,this.xh,l);var I=gi((t[0]-w[0])/e,4),N=gi((w[3]-t[1])/e,4);return b[this.Ph?"I":"X"]=I,b[this.Ph?"J":"Y"]=N,this.Oh(w,Q_,1,y||f,b)}},i.prototype.getLegendUrl=function(t,e){if(this.Fe!==void 0){var o={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){var l=this.xh.LAYERS;if(!(!Array.isArray(l)||l.length===1))return;o.LAYER=l}if(t!==void 0){var f=this.getProjection()?this.getProjection().getMetersPerUnit():1;o.SCALE=t*f/28e-5}return Vt(o,e),Hl(this.Fe,o)}},i.prototype.getParams=function(){return this.xh},i.prototype.getImageInternal=function(t,e,o,l){if(this.Fe===void 0)return null;e=this.findNearestResolution(e),o==1||this._a&&this.kh!==void 0||(o=1);var f=e/o,y=Gi(t),w=Po(y,f,0,[dn(Gr(t)/f,4),dn(Ki(t)/f,4)]),b=Po(y,f,0,[dn(this.Sh*Gr(t)/f,4),dn(this.Sh*Ki(t)/f,4)]),I=this.Lt;if(I&&this._h==this.getRevision()&&I.getResolution()==e&&I.getPixelRatio()==o&&pn(I.getExtent(),w))return I;var N={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Vt(N,this.xh),this.Mh[0]=si(Gr(b)/f,4),this.Mh[1]=si(Ki(b)/f,4);var D=this.Oh(b,this.Mh,o,l,N);return this.Lt=new pc(b,e,o,D,this.Bt,this.Rt),this._h=this.getRevision(),this.Lt.addEventListener(ne,this.handleImageChange.bind(this)),this.Lt},i.prototype.getImageLoadFunction=function(){return this.Rt},i.prototype.Oh=function(t,e,o,l,f){if(Me(this.Fe!==void 0,9),f[this.Ph?"CRS":"SRS"]=l.getCode(),"STYLES"in this.xh||(f.STYLES=""),o!=1)switch(this.kh){case"geoserver":var y=90*o+.5|0;"FORMAT_OPTIONS"in f?f.FORMAT_OPTIONS+=";dpi:"+y:f.FORMAT_OPTIONS="dpi:"+y;break;case"mapserver":f.MAP_RESOLUTION=90*o;break;case"carmentaserver":case"qgis":f.DPI=90*o;break;default:Me(!1,8)}f.WIDTH=e[0],f.HEIGHT=e[1];var w,b=l.getAxisOrientation();return w=this.Ph&&b.substr(0,2)=="ne"?[t[1],t[0],t[3],t[2]]:t,f.BBOX=w.join(","),Hl(this.Fe,f)},i.prototype.getUrl=function(){return this.Fe},i.prototype.setImageLoadFunction=function(t){this.Lt=null,this.Rt=t,this.changed()},i.prototype.setUrl=function(t){t!=this.Fe&&(this.Fe=t,this.Lt=null,this.changed())},i.prototype.updateParams=function(t){Vt(this.xh,t),this.Ch(),this.Lt=null,this.changed()},i.prototype.Ch=function(){var t=this.xh.VERSION||Sc;this.Ph=Bn(t,"1.3")>=0},i}(yu),QT={"image/png":!0,"image/jpeg":!0,"image/gif":!0,"image/webp":!0},tP={"application/vnd.mapbox-vector-tile":!0,"application/geo+json":!0};function tx(s,i){for(var t,e,o=0;o<s.length;++o){var l=s[o];if(l.rel==="item"){if(l.type===i){t=l.href;break}QT[l.type]?e=l.href:e||l.type.indexOf("image/")!==0||(e=l.href)}}if(!t){if(!e)throw new Error('Could not find "item" link');t=e}return t}function ex(s,i,t){for(var e,o,l={},f=0;f<s.length;++f){var y=s[f];if(l[y.type]=y.href,y.rel==="item"){if(y.type===i){e=y.href;break}tP[y.type]&&(o=y.href)}}if(!e&&t)for(f=0;f<t.length;++f){var w=t[f];if(l[w]){e=l[w];break}}if(!e){if(!o)throw new Error('Could not find "item" link');e=o}return e}function rx(s,i,t,e){var o=s.projection;if(!o&&!(o=ie(i.crs)))throw new Error("Unsupported CRS: ".concat(i.crs));for(var l=o.getAxisOrientation().substr(0,2)!=="en",f=i.tileMatrices,y={},w=0;w<f.length;++w){var b=f[w];y[b.id]=b}var I={},N=[];if(e)for(w=0;w<e.length;++w){var D=(gt=e[w]).tileMatrix;N.push(D),I[D]=gt}else for(w=0;w<f.length;++w)D=f[w].id,N.push(D);var j=N.length,H=new Array(j),Z=new Array(j),it=new Array(j),at=new Array(j),wt=[-1/0,-1/0,1/0,1/0];for(w=0;w<j;++w){D=N[w];var gt,yt=(b=y[D]).pointOfOrigin;if(H[w]=l?[yt[1],yt[0]]:yt,Z[w]=b.cellSize,it[w]=[b.matrixWidth,b.matrixHeight],at[w]=[b.tileWidth,b.tileHeight],gt=I[D]){var It=b.cellSize*b.tileWidth,Rt=H[w][0]+gt.minTileCol*It,kt=H[w][0]+(gt.maxTileCol+1)*It,Dt=b.cellSize*b.tileHeight,Xt=void 0,ee=void 0;b.cornerOfOrigin==="bottomLeft"?(Xt=H[w][1]+gt.minTileRow*Dt,ee=H[w][1]+(gt.maxTileRow+1)*Dt):(Xt=H[w][1]-(gt.maxTileRow+1)*Dt,ee=H[w][1]-gt.minTileRow*Dt),fn(wt,[Rt,Xt,kt,ee],wt)}}var pe=new ql({origins:H,resolutions:Z,sizes:it,tileSizes:at,extent:e?wt:void 0}),xe=s.context,fe=s.url;return{grid:pe,urlTemplate:t,urlFunction:function(Re,qe,Ge){if(Re){var Qe=N[Re[0]],ir=y[Qe],de=ir.cornerOfOrigin==="bottomLeft",Nr={tileMatrix:Qe,tileCol:Re[1],tileRow:de?-Re[2]-1:Re[2]};if(e){var Pr=I[ir.id];if(Nr.tileCol<Pr.minTileCol||Nr.tileCol>Pr.maxTileCol||Nr.tileRow<Pr.minTileRow||Nr.tileRow>Pr.maxTileRow)return}Vt(Nr,xe);var he=t.replace(/\{(\w+?)\}/g,function($e,or){return Nr[or]});return ty(fe,he)}}}}function qy(s){return Qm(s.url).then(function(i){return function(t,e){var o,l=e.tileMatrixSetLimits;if(e.dataType==="map")o=tx(e.links,t.mediaType);else{if(e.dataType!=="vector")throw new Error('Expected tileset data type to be "map" or "vector"');o=ex(e.links,t.mediaType,t.supportedMediaTypes)}if(e.tileMatrixSet)return rx(t,e.tileMatrixSet,o,l);var f=e.links.find(function(w){return w.rel==="http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"});if(!f)throw new Error("Expected http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme link or tileMatrixSet");var y=f.href;return Qm(ty(t.url,y)).then(function(w){return rx(t,w,o,l)})}(s,i)})}var eP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),rP=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;return t.interpolate!==void 0&&(o=t.interpolate),e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:o,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition})||this,qy({url:t.url,projection:e.getProjection(),mediaType:t.mediaType,context:t.context||null}).then(e.Ih.bind(e)).catch(e.Nh.bind(e)),e}return eP(i,s),i.prototype.Ih=function(t){this.tileGrid=t.grid,this.setTileUrlFunction(t.urlFunction,t.urlTemplate),this.setState("ready")},i.prototype.Nh=function(t){console.error(t),this.setState("error")},i}(Yl),iP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Tg=function(s){function i(t){var e=this,o=t.projection||"EPSG:3857",l=t.extent||wc(o),f=t.tileGrid||vh({extent:l,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});return(e=s.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,opaque:!1,projection:o,state:t.state,tileGrid:f,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Hy,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection})||this).ze=t.format?t.format:null,e.sourceTileCache=new ig(e.tileCache.highWaterMark),e.za=t.overlaps==null||t.overlaps,e.tileClass=t.tileClass?t.tileClass:S1,e.Lh={},e}return iP(i,s),i.prototype.getFeaturesInExtent=function(t){var e=[],o=this.tileCache;if(o.getCount()===0)return e;var l=$m(o.peekFirstKey())[0],f=this.tileGrid;return o.forEach(function(y){if(y.tileCoord[0]===l&&y.getState()===Oe)for(var w=y.getSourceTiles(),b=0,I=w.length;b<I;++b){var N=w[b],D=N.tileCoord;if(on(t,f.getTileCoordExtent(D))){var j=N.getFeatures();if(j)for(var H=0,Z=j.length;H<Z;++H){var it=j[H],at=it.getGeometry();on(t,at.getExtent())&&e.push(it)}}}}),e},i.prototype.getOverlaps=function(){return this.za},i.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},i.prototype.expireCache=function(t,e){var o=this.getTileCacheForProjection(t),l=Object.keys(e).reduce(function(f,y){var w=v1(y),b=o.peek(w);if(b)for(var I=b.sourceTiles,N=0,D=I.length;N<D;++N)f[I[N].getKey()]=!0;return f},{});s.prototype.expireCache.call(this,t,e),this.sourceTileCache.expireCache(l)},i.prototype.getSourceTiles=function(t,e,o){var l=this;if(o.getState()===Er){o.setState(br);var f=o.wrappedTileCoord,y=this.getTileGridForProjection(e),w=y.getTileCoordExtent(f),b=f[0],I=y.getResolution(b);Fr(w,-I,w);var N=this.tileGrid,D=N.getExtent();D&&fn(w,D,w);var j=N.getZForResolution(I,this.zDirection);N.forEachTileCoord(w,j,function(H){var Z=l.tileUrlFunction(H,t,e),it=l.sourceTileCache.containsKey(Z)?l.sourceTileCache.get(Z):new l.tileClass(H,Z?Er:ar,Z,l.ze,l.tileLoadFunction);o.sourceTiles.push(it);var at=it.getState();if(at<Oe){var wt=function(gt){l.handleTileChange(gt);var yt=it.getState();if(yt===Oe||yt===ur){var It=it.getKey();It in o.errorTileKeys?it.getState()===Oe&&delete o.errorTileKeys[It]:o.loadingSourceTiles--,yt===ur?o.errorTileKeys[It]=!0:it.removeEventListener(ne,wt),o.loadingSourceTiles===0&&o.setState(ge(o.errorTileKeys)?Oe:ur)}};it.addEventListener(ne,wt),o.loadingSourceTiles++}at===Er&&(it.extent=N.getTileCoordExtent(H),it.projection=e,it.resolution=N.getResolution(H[0]),l.sourceTileCache.set(Z,it),it.load())}),o.loadingSourceTiles||o.setState(o.sourceTiles.some(function(H){return H.getState()===ur})?ur:Oe)}return o.sourceTiles},i.prototype.getTile=function(t,e,o,l,f){var y,w=Ul(t,e,o),b=this.getKey();if(this.tileCache.containsKey(w)&&(y=this.tileCache.get(w)).key===b)return y;var I=[t,e,o],N=this.getTileCoordForTileUrlFunction(I,f),D=this.getTileGrid().getExtent(),j=this.getTileGridForProjection(f);if(N&&D){var H=j.getTileCoordExtent(N);Fr(H,-j.getResolution(t),H),on(D,H)||(N=null)}var Z=!0;if(N!==null){var it=this.tileGrid,at=j.getResolution(t),wt=it.getZForResolution(at,1),gt=j.getTileCoordExtent(N);Fr(gt,-at,gt),it.forEachTileCoord(gt,wt,function(It){Z=Z&&!this.tileUrlFunction(It,l,f)}.bind(this))}var yt=new b1(I,Z?ar:Er,N,this.getSourceTiles.bind(this,l,f));return yt.key=b,y?(yt.interimTile=y,yt.refreshInterimChain(),this.tileCache.replace(w,yt)):this.tileCache.set(w,yt),yt},i.prototype.getTileGridForProjection=function(t){var e=t.getCode(),o=this.Lh[e];if(!o){for(var l=this.tileGrid,f=l.getResolutions().slice(),y=f.map(function(I,N){return l.getOrigin(N)}),w=f.map(function(I,N){return l.getTileSize(N)}),b=f.length;b<43;++b)f.push(f[b-1]/2),y.push(y[b-1]),w.push(w[b-1]);o=new ql({extent:l.getExtent(),origins:y,resolutions:f,tileSizes:w}),this.Lh[e]=o}return o},i.prototype.getTilePixelRatio=function(t){return t},i.prototype.getTilePixelSize=function(t,e,o){var l=Pn(this.getTileGridForProjection(o).getTileSize(t),this.tmpSize);return[Math.round(l[0]*e),Math.round(l[1]*e)]},i.prototype.updateCacheSize=function(t,e){s.prototype.updateCacheSize.call(this,2*t,e),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(e).highWaterMark},i}(Ly);function Hy(s,i){s.setLoader(function(t,e,o){Km(i,s.getFormat(),t,e,o,s.onLoad.bind(s),s.onError.bind(s))})}var nP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),oP=function(s){function i(t){var e=s.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,format:t.format,overlaps:t.overlaps,projection:t.projection,tileClass:t.tileClass,transition:t.transition,wrapX:t.wrapX,zDirection:t.zDirection,state:"loading"})||this;return qy({url:t.url,projection:e.getProjection(),mediaType:t.mediaType,supportedMediaTypes:t.format.supportedMediaTypes,context:t.context||null}).then(e.Ih.bind(e)).catch(e.Nh.bind(e)),e}return nP(i,s),i.prototype.Ih=function(t){this.tileGrid=t.grid,this.setTileUrlFunction(t.urlFunction,t.urlTemplate),this.setState("ready")},i.prototype.Nh=function(t){console.error(t),this.setState("error")},i}(Tg),sP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Xy='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',aP=function(s){function i(t){var e,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;o.interpolate!==void 0&&(l=o.interpolate),e=o.attributions!==void 0?o.attributions:[Xy];var f=o.crossOrigin!==void 0?o.crossOrigin:"anonymous",y=o.url!==void 0?o.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return s.call(this,{attributions:e,attributionsCollapsible:!1,cacheSize:o.cacheSize,crossOrigin:f,interpolate:l,maxZoom:o.maxZoom!==void 0?o.maxZoom:19,opaque:o.opaque===void 0||o.opaque,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileLoadFunction:o.tileLoadFunction,transition:o.transition,url:y,wrapX:o.wrapX,zDirection:o.zDirection})||this}return sP(i,s),i}(Yf),lP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ix=function(s){function i(t){var e=t||{};return s.call(this,e)||this}return lP(i,s),i}(pa),cP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Wy=[],Rp=null,Yy,Pg=function(s){function i(t){var e=s.call(this,t)||this;return e.container=null,e.renderedResolution,e.tempTransform=[1,0,0,1,0,0],e.pixelTransform=[1,0,0,1,0,0],e.inversePixelTransform=[1,0,0,1,0,0],e.context=null,e.containerReused=!1,e.Us=null,e.frameState=null,e}return cP(i,s),i.prototype.getImageData=function(t,e,o){var l,f;Rp||((l=document.createElement("canvas")).width=1,l.height=1,Rp=l.getContext("2d")),Rp.clearRect(0,0,1,1);try{Rp.drawImage(t,e,o,1,1,0,0,1,1),f=Rp.getImageData(0,0,1,1).data}catch{return Rp=null,null}return f},i.prototype.getBackground=function(t){var e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0},i.prototype.useContainer=function(t,e,o){var l,f,y=this.getLayer().getClassName();if(t&&t.className===y&&(!o||t&&t.style.backgroundColor&&$(Ra(t.style.backgroundColor),Ra(o)))&&(b=t.firstElementChild)instanceof HTMLCanvasElement&&(f=b.getContext("2d")),f&&f.canvas.style.transform===e?(this.container=t,this.context=f,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(l=document.createElement("div")).className=y;var w=l.style;w.position="absolute",w.width="100%",w.height="100%";var b=(f=Cn()).canvas;l.appendChild(b),(w=b.style).position="absolute",w.left="0",w.transformOrigin="top left",this.container=l,this.context=f}this.containerReused||!o||this.container.style.backgroundColor||(this.container.style.backgroundColor=o)},i.prototype.clipUnrotated=function(t,e,o){var l=Zr(o),f=Qn(o),y=Yo(o),w=To(o);Ei(e.coordinateToPixelTransform,l),Ei(e.coordinateToPixelTransform,f),Ei(e.coordinateToPixelTransform,y),Ei(e.coordinateToPixelTransform,w);var b=this.inversePixelTransform;Ei(b,l),Ei(b,f),Ei(b,y),Ei(b,w),t.save(),t.beginPath(),t.moveTo(Math.round(l[0]),Math.round(l[1])),t.lineTo(Math.round(f[0]),Math.round(f[1])),t.lineTo(Math.round(y[0]),Math.round(y[1])),t.lineTo(Math.round(w[0]),Math.round(w[1])),t.clip()},i.prototype.Xs=function(t,e,o){var l=this.getLayer();if(l.hasListener(t)){var f=new hl(t,this.inversePixelTransform,o,e);l.dispatchEvent(f)}},i.prototype.preRender=function(t,e){this.frameState=e,this.Xs(Ol,t,e)},i.prototype.postRender=function(t,e){this.Xs(bf,t,e)},i.prototype.getRenderTransform=function(t,e,o,l,f,y,w){var b=f/2,I=y/2,N=l/e,D=-N,j=-t[0]+w,H=-t[1];return At(this.tempTransform,b,I,N,D,-o,j,H)},i.prototype.getDataAtPixel=function(t,e,o){var l=Ei(this.inversePixelTransform,t.slice()),f=this.context,y=this.getLayer().getExtent();if(y&&!nn(y,Ei(e.pixelToCoordinateTransform,t.slice())))return null;var w,b=Math.round(l[0]),I=Math.round(l[1]),N=this.Us;if(!N){var D=document.createElement("canvas");D.width=1,D.height=1,N=D.getContext("2d"),this.Us=N}N.clearRect(0,0,1,1);try{N.drawImage(f.canvas,b,I,1,1,0,0,1,1),w=N.getImageData(0,0,1,1).data}catch(j){return j.name==="SecurityError"?(this.Us=null,new Uint8Array):w}return w[3]===0?null:w},i.prototype.disposeInternal=function(){delete this.frameState,s.prototype.disposeInternal.call(this)},i}(gy),uP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Zy=function(s){function i(t){var e=s.call(this,t)||this;return e.Lt=null,e}return uP(i,s),i.prototype.getImage=function(){return this.Lt?this.Lt.getImage():null},i.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],o=t.pixelRatio,l=t.viewState,f=l.resolution,y=this.getLayer().getSource(),w=t.viewHints,b=t.extent;if(e.extent!==void 0&&(b=fn(b,Mo(e.extent,l.projection))),!w[is]&&!w[Os]&&!ws(b))if(y){var I=l.projection,N=y.getImage(b,f,o,I);N&&(this.loadImage(N)?this.Lt=N:N.getState()===$u&&(this.Lt=null))}else this.Lt=null;return!!this.Lt},i.prototype.getData=function(t){var e=this.frameState;if(!e)return null;var o=this.getLayer(),l=Ei(e.pixelToCoordinateTransform,t.slice()),f=o.getExtent();if(f&&!nn(f,l))return null;var y=this.Lt.getExtent(),w=this.Lt.getImage(),b=Gr(y),I=Math.floor(w.width*((l[0]-y[0])/b));if(I<0||I>=w.width)return null;var N=Ki(y),D=Math.floor(w.height*((y[3]-l[1])/N));return D<0||D>=w.height?null:this.getImageData(w,I,D)},i.prototype.renderFrame=function(t,e){var o=this.Lt,l=o.getExtent(),f=o.getResolution(),y=o.getPixelRatio(),w=t.layerStatesArray[t.layerIndex],b=t.pixelRatio,I=t.viewState,N=I.center,D=b*f/(I.resolution*y),j=t.extent,H=I.resolution,Z=I.rotation,it=Math.round(Gr(j)/H*b),at=Math.round(Ki(j)/H*b);At(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/b,1/b,Z,-it/2,-at/2),Qt(this.inversePixelTransform,this.pixelTransform);var wt=re(this.pixelTransform);this.useContainer(e,wt,this.getBackground(t));var gt=this.context,yt=gt.canvas;yt.width!=it||yt.height!=at?(yt.width=it,yt.height=at):this.containerReused||gt.clearRect(0,0,it,at);var It=!1,Rt=!0;if(w.extent){var kt=Mo(w.extent,I.projection);(It=(Rt=on(kt,t.extent))&&!pn(kt,t.extent))&&this.clipUnrotated(gt,t,kt)}var Dt=o.getImage(),Xt=At(this.tempTransform,it/2,at/2,D,D,0,y*(l[0]-N[0])/f,y*(N[1]-l[3])/f);this.renderedResolution=f*b/y;var ee=Dt.width*Xt[0],pe=Dt.height*Xt[3];if(this.getLayer().getSource().getInterpolate()||Vt(gt,_p),this.preRender(gt,t),Rt&&ee>=.5&&pe>=.5){var xe=Xt[4],fe=Xt[5],Re=w.opacity,qe=void 0;Re!==1&&(qe=gt.globalAlpha,gt.globalAlpha=Re),gt.drawImage(Dt,0,0,+Dt.width,+Dt.height,xe,fe,ee,pe),Re!==1&&(gt.globalAlpha=qe)}return this.postRender(gt,t),It&&gt.restore(),Vt(gt,iy),wt!==yt.style.transform&&(yt.style.transform=wt),this.container},i}(Pg),hP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),nx=function(s){function i(t){return s.call(this,t)||this}return hP(i,s),i.prototype.createRenderer=function(){return new Zy(this)},i.prototype.getData=function(t){return s.prototype.getData.call(this,t)},i}(ix),Ig="preload",Mg="useInterimTilesOnError",pP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$y=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);return delete l.preload,delete l.useInterimTilesOnError,(e=s.call(this,l)||this).on,e.once,e.un,e.setPreload(o.preload!==void 0?o.preload:0),e.setUseInterimTilesOnError(o.useInterimTilesOnError===void 0||o.useInterimTilesOnError),e}return pP(i,s),i.prototype.getPreload=function(){return this.get(Ig)},i.prototype.setPreload=function(t){this.set(Ig,t)},i.prototype.getUseInterimTilesOnError=function(){return this.get(Mg)},i.prototype.setUseInterimTilesOnError=function(t){this.set(Mg,t)},i.prototype.getData=function(t){return s.prototype.getData.call(this,t)},i}(pa),fP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ky=function(s){function i(t){var e=s.call(this,t)||this;return e.extentChanged=!0,e.zh=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.Rh=!1,e.tmpExtent=[1/0,1/0,-1/0,-1/0],e.Fh=new ng(0,0,0,0),e}return fP(i,s),i.prototype.isDrawableTile=function(t){var e=this.getLayer(),o=t.getState(),l=e.getUseInterimTilesOnError();return o==Oe||o==ar||o==ur&&!l},i.prototype.getTile=function(t,e,o,l){var f=l.pixelRatio,y=l.viewState.projection,w=this.getLayer(),b=w.getSource().getTile(t,e,o,f,y);return b.getState()==ur&&(w.getUseInterimTilesOnError()?w.getPreload()>0&&(this.Rh=!0):b.setState(Oe)),this.isDrawableTile(b)||(b=b.getInterimTile()),b},i.prototype.getData=function(t){var e=this.frameState;if(!e)return null;var o=this.getLayer(),l=Ei(e.pixelToCoordinateTransform,t.slice()),f=o.getExtent();if(f&&!nn(f,l))return null;for(var y=e.pixelRatio,w=e.viewState.projection,b=e.viewState,I=o.getRenderSource(),N=I.getTileGridForProjection(b.projection),D=I.getTilePixelRatio(e.pixelRatio),j=N.getZForResolution(b.resolution);j>=N.getMinZoom();--j){var H=N.getTileCoordForCoordAndZ(l,j),Z=I.getTile(j,H[1],H[2],y,w);if(!(Z instanceof fc||Z instanceof yg))return null;if(Z.getState()===Oe){var it=N.getOrigin(j),at=Pn(N.getTileSize(j)),wt=N.getResolution(j),gt=Math.floor(D*((l[0]-it[0])/wt-H[1]*at[0])),yt=Math.floor(D*((it[1]-l[1])/wt-H[2]*at[1])),It=Math.round(D*I.getGutterForProjection(b.projection));return this.getImageData(Z.getImage(),gt+It,yt+It)}}return null},i.prototype.loadedTileCallback=function(t,e,o){return!!this.isDrawableTile(o)&&s.prototype.loadedTileCallback.call(this,t,e,o)},i.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},i.prototype.renderFrame=function(t,e){var o=t.layerStatesArray[t.layerIndex],l=t.viewState,f=l.projection,y=l.resolution,w=l.center,b=l.rotation,I=t.pixelRatio,N=this.getLayer(),D=N.getSource(),j=D.getRevision(),H=D.getTileGridForProjection(f),Z=H.getZForResolution(y,D.zDirection),it=H.getResolution(Z),at=t.extent,wt=t.viewState.resolution,gt=D.getTilePixelRatio(I),yt=Math.round(Gr(at)/wt*I),It=Math.round(Ki(at)/wt*I),Rt=o.extent&&Mo(o.extent,f);Rt&&(at=fn(at,Mo(o.extent,f)));var kt=it*yt/2/gt,Dt=it*It/2/gt,Xt=[w[0]-kt,w[1]-Dt,w[0]+kt,w[1]+Dt],ee=H.getTileRangeForExtentAndZ(at,Z),pe={};pe[Z]={};var xe=this.createLoadedTileFinder(D,f,pe),fe=this.tmpExtent,Re=this.Fh;this.Rh=!1;for(var qe=b?Yn(l.center,wt,b,t.size):void 0,Ge=ee.minX;Ge<=ee.maxX;++Ge)for(var Qe=ee.minY;Qe<=ee.maxY;++Qe)if(!b||H.tileCoordIntersectsViewport([Z,Ge,Qe],qe)){var ir=this.getTile(Z,Ge,Qe,t);if(this.isDrawableTile(ir)){var de=L(this);if(ir.getState()==Oe&&(pe[Z][ir.tileCoord.toString()]=ir,($a=ir.inTransition(de))&&o.opacity!==1&&(ir.endTransition(de),$a=!1),this.Rh||!$a&&this.renderedTiles.indexOf(ir)!==-1||(this.Rh=!0)),ir.getAlpha(de,t.time)===1)continue}var Nr=H.getTileCoordChildTileRange(ir.tileCoord,Re,fe),Pr=!1;Nr&&(Pr=xe(Z+1,Nr)),Pr||H.forEachTileCoordParentTileRange(ir.tileCoord,xe,Re,fe)}var he=it/y*I/gt;At(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/I,1/I,b,-yt/2,-It/2);var $e=re(this.pixelTransform);this.useContainer(e,$e,this.getBackground(t));var or=this.context,fi=or.canvas;Qt(this.inversePixelTransform,this.pixelTransform),At(this.tempTransform,yt/2,It/2,he,he,0,-yt/2,-It/2),fi.width!=yt||fi.height!=It?(fi.width=yt,fi.height=It):this.containerReused||or.clearRect(0,0,yt,It),Rt&&this.clipUnrotated(or,t,Rt),D.getInterpolate()||Vt(or,_p),this.preRender(or,t),this.renderedTiles.length=0;var ki,Sn,tr,Jn=Object.keys(pe).map(Number);Jn.sort(lt),o.opacity!==1||this.containerReused&&!D.getOpaque(t.viewState.projection)?(ki=[],Sn=[]):Jn=Jn.reverse();for(var Vo=Jn.length-1;Vo>=0;--Vo){var Hn=Jn[Vo],_a=D.getTilePixelSize(Hn,I,f),Uo=H.getResolution(Hn)/it,ys=_a[0]*Uo*he,Ya=_a[1]*Uo*he,ss=H.getTileCoordForCoordAndZ(Zr(Xt),Hn),qo=H.getTileCoordExtent(ss),yr=Ei(this.tempTransform,[gt*(qo[0]-Xt[0])/it,gt*(Xt[3]-qo[3])/it]),ta=gt*D.getGutterForProjection(f),Za=pe[Hn];for(var xl in Za){var $a,Nc=(ir=Za[xl]).tileCoord,xa=ss[1]-Nc[1],ju=Math.round(yr[0]-(xa-1)*ys),ic=ss[2]-Nc[2],nc=Math.round(yr[1]-(ic-1)*Ya),Bs=ju-(Ge=Math.round(yr[0]-xa*ys)),Fn=nc-(Qe=Math.round(yr[1]-ic*Ya)),Bu=Z===Hn,wa=!1;if(!($a=Bu&&ir.getAlpha(L(this),t.time)!==1))if(ki){tr=[Ge,Qe,Ge+Bs,Qe,Ge+Bs,Qe+Fn,Ge,Qe+Fn];for(var So=0,oc=ki.length;So<oc;++So)if(Z!==Hn&&Hn<Sn[So]){var Ro=ki[So];on([Ge,Qe,Ge+Bs,Qe+Fn],[Ro[0],Ro[3],Ro[4],Ro[7]])&&(wa||(or.save(),wa=!0),or.beginPath(),or.moveTo(tr[0],tr[1]),or.lineTo(tr[2],tr[3]),or.lineTo(tr[4],tr[5]),or.lineTo(tr[6],tr[7]),or.moveTo(Ro[6],Ro[7]),or.lineTo(Ro[4],Ro[5]),or.lineTo(Ro[2],Ro[3]),or.lineTo(Ro[0],Ro[1]),or.clip())}ki.push(tr),Sn.push(Hn)}else or.clearRect(Ge,Qe,Bs,Fn);this.drawTileImage(ir,t,Ge,Qe,Bs,Fn,ta,Bu),ki&&!$a?(wa&&or.restore(),this.renderedTiles.unshift(ir)):this.renderedTiles.push(ir),this.updateUsedTiles(t.usedTiles,D,ir)}}return this.renderedRevision=j,this.renderedResolution=it,this.extentChanged=!this.zh||!ko(this.zh,Xt),this.zh=Xt,this.renderedPixelRatio=I,this.renderedProjection=f,this.manageTilePyramid(t,D,H,I,f,at,Z,N.getPreload()),this.scheduleExpireCache(t,D),this.postRender(or,t),o.extent&&or.restore(),Vt(or,iy),$e!==fi.style.transform&&(fi.style.transform=$e),this.container},i.prototype.drawTileImage=function(t,e,o,l,f,y,w,b){var I=this.getTileImage(t);if(I){var N=L(this),D=e.layerStatesArray[e.layerIndex],j=D.opacity*(b?t.getAlpha(N,e.time):1),H=j!==this.context.globalAlpha;H&&(this.context.save(),this.context.globalAlpha=j),this.context.drawImage(I,w,w,I.width-2*w,I.height-2*w,o,l,f,y),H&&this.context.restore(),j!==D.opacity?e.animate=!0:b&&t.endTransition(N)}},i.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},i.prototype.getTileImage=function(t){return t.getImage()},i.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var o=function(l,f,y){var w=L(l);w in y.usedTiles&&l.expireCache(y.viewState.projection,y.usedTiles[w])}.bind(null,e);t.postRenderFunctions.push(o)}},i.prototype.updateUsedTiles=function(t,e,o){var l=L(e);l in t||(t[l]={}),t[l][o.getKey()]=!0},i.prototype.manageTilePyramid=function(t,e,o,l,f,y,w,b,I){var N=L(e);N in t.wantedTiles||(t.wantedTiles[N]={});var D,j,H,Z,it,at,wt=t.wantedTiles[N],gt=t.tileQueue,yt=o.getMinZoom(),It=t.viewState.rotation,Rt=It?Yn(t.viewState.center,t.viewState.resolution,It,t.size):void 0,kt=0;for(at=yt;at<=w;++at)for(j=o.getTileRangeForExtentAndZ(y,at,j),H=o.getResolution(at),Z=j.minX;Z<=j.maxX;++Z)for(it=j.minY;it<=j.maxY;++it)It&&!o.tileCoordIntersectsViewport([at,Z,it],Rt)||(w-at<=b?(++kt,(D=e.getTile(at,Z,it,l,f)).getState()==Er&&(wt[D.getKey()]=!0,gt.isKeyQueued(D.getKey())||gt.enqueue([D,N,o.getTileCoordCenter(D.tileCoord),H])),I!==void 0&&I(D)):e.useTile(at,Z,it,f));e.updateCacheSize(kt,f)},i}(Pg),dP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ox=function(s){function i(t){return s.call(this,t)||this}return dP(i,s),i.prototype.createRenderer=function(){return new Ky(this)},i}($y),Jy=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),sx=!0;try{new ImageData(10,10)}catch{sx=!1}function ax(s,i,t){if(sx)return new ImageData(s,i,t);Yy||(Yy=document.createElement("canvas").getContext("2d"));var e=Yy.createImageData(i,t);return e.data.set(s),e}function lx(s){var i=!0;try{new ImageData(10,10)}catch{i=!1}function t(e,o,l){return i?new ImageData(e,o,l):{data:e,width:o,height:l}}return function(e){var o=e.buffers,l=e.meta,f=e.imageOps,y=e.width,w=e.height,b=o.length,I=o[0].byteLength;if(f){for(var N=new Array(b),D=0;D<b;++D)N[D]=t(new Uint8ClampedArray(o[D]),y,w);return s(N,l).data.buffer}var j=new Uint8ClampedArray(I),H=new Array(b),Z=new Array(b);for(D=0;D<b;++D)H[D]=new Uint8ClampedArray(o[D]),Z[D]=[0,0,0,0];for(var it=0;it<I;it+=4){for(var at=0;at<b;++at){var wt=H[at];Z[at][0]=wt[it],Z[at][1]=wt[it+1],Z[at][2]=wt[it+2],Z[at][3]=wt[it+3]}var gt=s(Z,l);j[it]=gt[0],j[it+1]=gt[1],j[it+2]=gt[2],j[it+3]=gt[3]}return j.buffer}}function gP(s,i){var t=Object.keys(s.lib||{}).map(function(o){return"var "+o+" = "+s.lib[o].toString()+";"}).concat(["var __minion__ = ("+lx.toString()+")(",s.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),e=new Worker(typeof Blob>"u"?"data:text/javascript;base64,"+Buffer.from(t.join(`
`),"binary").toString("base64"):URL.createObjectURL(new Blob(t,{type:"text/javascript"})));return e.addEventListener("message",i),e}var cx=function(s){function i(t){var e,o=s.call(this)||this;o._imageOps=!!t.imageOps,e=t.threads===0?0:o._imageOps?1:t.threads||1;var l=new Array(e);if(e)for(var f=0;f<e;++f)l[f]=gP(t,o._onWorkerMessage.bind(o,f));else l[0]=function(y,w){var b=lx(y.operation),I=!1;return{postMessage:function(N){setTimeout(function(){I||w({data:{buffer:b(N),meta:N.meta}})},0)},terminate:function(){I=!0}}}(t,o._onWorkerMessage.bind(o,0));return o._workers=l,o._queue=[],o._maxQueueLength=t.queue||1/0,o._running=0,o._dataLookup={},o._job=null,o}return Jy(i,s),i.prototype.process=function(t,e,o){this._enqueue({inputs:t,meta:e,callback:o}),this._dispatch()},i.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},i.prototype._dispatch=function(){if(!this._running&&this._queue.length!==0){var t=this._queue.shift();this._job=t;var e=t.inputs[0].width,o=t.inputs[0].height,l=t.inputs.map(function(H){return H.data.buffer}),f=this._workers.length;if(this._running=f,f!==1)for(var y=t.inputs[0].data.length,w=4*Math.ceil(y/4/f),b=0;b<f;++b){for(var I=b*w,N=[],D=0,j=l.length;D<j;++D)N.push(l[D].slice(I,I+w));this._workers[b].postMessage({buffers:N,meta:t.meta,imageOps:this._imageOps,width:e,height:o},N)}else this._workers[0].postMessage({buffers:l,meta:t.meta,imageOps:this._imageOps,width:e,height:o},l)}},i.prototype._onWorkerMessage=function(t,e){this.disposed||(this._dataLookup[t]=e.data,--this._running,this._running===0&&this._resolveJob())},i.prototype._resolveJob=function(){var t,e,o=this._job,l=this._workers.length;if(l===1)t=new Uint8ClampedArray(this._dataLookup[0].buffer),e=this._dataLookup[0].meta;else{var f=o.inputs[0].data.length;t=new Uint8ClampedArray(f),e=new Array(l);for(var y=4*Math.ceil(f/4/l),w=0;w<l;++w){var b=this._dataLookup[w].buffer,I=w*y;t.set(new Uint8ClampedArray(b),I),e[w]=this._dataLookup[w].meta}}this._job=null,this._dataLookup={},o.callback(null,ax(t,o.inputs[0].width,o.inputs[0].height),e),this._dispatch()},i.prototype.disposeInternal=function(){for(var t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0},i}(Q),mP="beforeoperations",yP="afteroperations",vP="pixel",_P="image",Qy=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.extent=e.extent,l.resolution=e.viewState.resolution/e.pixelRatio,l.data=o,l}return Jy(i,s),i}(O),ux=function(s){function i(t){var e=s.call(this,{projection:null})||this;e.on,e.once,e.un,e.Gh=null,e.Dh=t.operationType!==void 0?t.operationType:vP,e.qh=t.threads!==void 0?t.threads:1,e.Uh=function(w){for(var b=w.length,I=new Array(b),N=0;N<b;++N)I[N]=wP(w[N]);return I}(t.sources);for(var o,l=e.changed.bind(e),f=0,y=e.Uh.length;f<y;++f)e.Uh[f].addEventListener(ne,l);return e.hr=new Tf(function(){return 1},e.changed.bind(e)),e.Bh,e.Xh=null,e._h,e.Zi={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:(o=e.Uh,o.map(function(w){return w.getLayerState()})),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:e.hr,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:L(e),renderTargets:{}},e.setAttributions(function(w){for(var b=[],I=0,N=t.sources.length;I<N;++I){var D=t.sources[I],j=(D instanceof Mp?D:D.getSource()).getAttributions();if(typeof j=="function"){var H=j(w);b.push.apply(b,H)}}return b.length!==0?b:null}),t.operation!==void 0&&e.setOperation(t.operation,t.lib),e}return Jy(i,s),i.prototype.setOperation=function(t,e){this.Gh&&this.Gh.dispose(),this.Gh=new cx({operation:t,imageOps:this.Dh===_P,queue:1,lib:e,threads:this.qh}),this.changed()},i.prototype.Vh=function(t,e,o){var l=Vt({},this.Zi);l.viewState=Vt({},l.viewState);var f=Gi(t);l.extent=t.slice(),l.size[0]=Math.round(Gr(t)/e),l.size[1]=Math.round(Ki(t)/e),l.time=Date.now();var y=l.viewState;return y.center=f,y.projection=o,y.resolution=e,l},i.prototype.Wh=function(){for(var t=!0,e=0,o=this.Uh.length;e<o;++e)if(this.Uh[e].getSource().getState()!=="ready"){t=!1;break}return t},i.prototype.getImage=function(t,e,o,l){if(!this.Wh())return null;var f=this.Vh(t,e,l);if(this.Bh=f,this.Xh){var y=this.Xh.getResolution(),w=this.Xh.getExtent();e===y&&ko(t,w)||(this.Xh=null)}return this.Xh&&this.getRevision()===this._h||this.Yh(),f.tileQueue.loadMoreTiles(16,16),f.animate&&requestAnimationFrame(this.changed.bind(this)),this.Xh},i.prototype.Yh=function(){for(var t=this.Bh,e=this.Uh.length,o=new Array(e),l=0;l<e;++l){t.layerIndex=l;var f=xP(this.Uh[l],t);if(!f)return;o[l]=f}var y={};this.dispatchEvent(new Qy(mP,t,y)),this.Gh.process(o,y,this.Zh.bind(this,t))},i.prototype.Zh=function(t,e,o,l){if(!e&&o){var f=t.extent,y=t.viewState.resolution;if(y===this.Bh.viewState.resolution&&ko(f,this.Bh.extent)){var w;this.Xh?w=this.Xh.getImage().getContext("2d"):(w=Cn(Math.round(Gr(f)/y),Math.round(Ki(f)/y)),this.Xh=new $c(f,y,1,w.canvas)),w.putImageData(o,0,0),this.changed(),this._h=this.getRevision(),this.dispatchEvent(new Qy(yP,t,l)),t.animate&&requestAnimationFrame(this.changed.bind(this))}}},i.prototype.disposeInternal=function(){this.Gh&&this.Gh.dispose(),s.prototype.disposeInternal.call(this)},i}(yu);ux.prototype.dispose;var Ch=null;function xP(s,i){var t=s.getRenderer();if(!t)throw new Error("Unsupported layer type: "+s);if(!t.prepareFrame(i))return null;var e=i.size[0],o=i.size[1];if(e===0||o===0)return null;var l,f=t.renderFrame(i,null);if(f instanceof HTMLCanvasElement)l=f;else{if(f&&(l=f.firstElementChild),!(l instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+l);if(l.width===e&&l.height===o)return l.getContext("2d").getImageData(0,0,e,o)}if(Ch){var y=Ch.canvas;y.width!==e||y.height!==o?Ch=Cn(e,o):Ch.clearRect(0,0,e,o)}else Ch=Cn(e,o);return Ch.drawImage(l,0,0,e,o),Ch.getImageData(0,0,e,o)}function wP(s){var i;return s instanceof Mp?s instanceof Wf?i=new ox({source:s}):s instanceof yu&&(i=new nx({source:s})):i=s,i}var bP=ux,SP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),EP=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',Xy],CP={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},TP={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},PP=function(s){function i(t){var e=t.imageSmoothing===void 0||t.imageSmoothing;t.interpolate!==void 0&&(e=t.interpolate);var o=t.layer.indexOf("-"),l=o==-1?t.layer:t.layer.slice(0,o),f=TP[l],y=CP[t.layer],w=t.url!==void 0?t.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+t.layer+"/{z}/{x}/{y}."+y.extension;return s.call(this,{attributions:EP,cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:e,maxZoom:t.maxZoom!=null?t.maxZoom:f.maxZoom,minZoom:t.minZoom!=null?t.minZoom:f.minZoom,opaque:y.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:w,wrapX:t.wrapX,zDirection:t.zDirection})||this}return SP(i,s),i}(Yf),IP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),MP=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;return o.interpolate!==void 0&&(l=o.interpolate),(e=s.call(this,{attributions:o.attributions,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:l,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileGrid:o.tileGrid,tileLoadFunction:o.tileLoadFunction,url:o.url,urls:o.urls,wrapX:o.wrapX===void 0||o.wrapX,transition:o.transition,zDirection:o.zDirection})||this).xh=o.params||{},e._a=o.hidpi===void 0||o.hidpi,e.Ao=[1/0,1/0,-1/0,-1/0],e.setKey(e.$h()),e}return IP(i,s),i.prototype.$h=function(){var t=0,e=[];for(var o in this.xh)e[t++]=o+"-"+this.xh[o];return e.join("/")},i.prototype.getParams=function(){return this.xh},i.prototype.Oh=function(t,e,o,l,f,y){var w=this.urls;if(w){var b,I=f.getCode().split(/:(?=\d+$)/).pop();return y.SIZE=e[0]+","+e[1],y.BBOX=o.join(","),y.BBOXSR=I,y.IMAGESR=I,y.DPI=Math.round(y.DPI?y.DPI*l:90*l),w.length==1?b=w[0]:b=w[be(rg(t),w.length)],Hl(b.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),y)}},i.prototype.getTilePixelRatio=function(t){return this._a?t:1},i.prototype.updateParams=function(t){Vt(this.xh,t),this.setKey(this.$h())},i.prototype.tileUrlFunction=function(t,e,o){var l=this.getTileGrid();if(l||(l=this.getTileGridForProjection(o)),!(l.getResolutions().length<=t[0])){e==1||this._a||(e=1);var f=l.getTileCoordExtent(t,this.Ao),y=Pn(l.getTileSize(t[0]),this.tmpSize);e!=1&&(y=gh(y,e,this.tmpSize));var w={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Vt(w,this.xh),this.Oh(t,y,f,e,o,w)}},i}(Yl),LP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),AP=function(s){function i(t){var e=this,o=t||{};return e=s.call(this,{opaque:!1,projection:o.projection,tileGrid:o.tileGrid,wrapX:o.wrapX===void 0||o.wrapX,zDirection:o.zDirection,url:o.template||"z:{z} x:{x} y:{y}",tileLoadFunction:function(l,f){var y=l.getTileCoord()[0],w=Pn(e.tileGrid.getTileSize(y)),b=Cn(w[0],w[1]);b.strokeStyle="grey",b.strokeRect(.5,.5,w[0]+.5,w[1]+.5),b.fillStyle="grey",b.strokeStyle="white",b.textAlign="center",b.textBaseline="middle",b.font="24px sans-serif",b.lineWidth=4,b.strokeText(f,w[0]/2,w[1]/2,w[0]),b.fillText(f,w[0]/2,w[1]/2,w[0]),l.setImage(b.canvas)}})||this}return LP(i,s),i}(Yf),OP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),hx=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;if(t.interpolate!==void 0&&(o=t.interpolate),(e=s.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:o,projection:ie("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:t.wrapX===void 0||t.wrapX,transition:t.transition,zDirection:t.zDirection})||this).Kh=null,e.jo=t.tileSize,t.url)if(t.jsonp)Nf(t.url,e.handleTileJSONResponse.bind(e),e.handleTileJSONError.bind(e));else{var l=new XMLHttpRequest;l.addEventListener("load",e.Hh.bind(e)),l.addEventListener("error",e.Jh.bind(e)),l.open("GET",t.url),l.send()}else t.tileJSON?e.handleTileJSONResponse(t.tileJSON):Me(!1,51);return e}return OP(i,s),i.prototype.Hh=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var o=void 0;try{o=JSON.parse(e.responseText)}catch{return void this.handleTileJSONError()}this.handleTileJSONResponse(o)}else this.handleTileJSONError()},i.prototype.Jh=function(t){this.handleTileJSONError()},i.prototype.getTileJSON=function(){return this.Kh},i.prototype.handleTileJSONResponse=function(t){var e,o=ie("EPSG:4326"),l=this.getProjection();if(t.bounds!==void 0){var f=ji(o,l);e=M(t.bounds,f)}var y=wc(l),w=t.minzoom||0,b=vh({extent:y,maxZoom:t.maxzoom||22,minZoom:w,tileSize:this.jo});if(this.tileGrid=b,this.tileUrlFunction=lg(t.tiles,b),t.attribution!==void 0&&!this.getAttributions()){var I=e!==void 0?e:y;this.setAttributions(function(N){return on(I,N.extent)?[t.attribution]:null})}this.Kh=t,this.setState("ready")},i.prototype.handleTileJSONError=function(){this.setState("error")},i}(Yl),NP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),RP=function(s){function i(t){var e=this,o=t||{},l=o.imageSmoothing===void 0||o.imageSmoothing;o.interpolate!==void 0&&(l=o.interpolate);var f=o.params||{},y=!("TRANSPARENT"in f)||f.TRANSPARENT;return(e=s.call(this,{attributions:o.attributions,attributionsCollapsible:o.attributionsCollapsible,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,interpolate:l,opaque:!y,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileClass:o.tileClass,tileGrid:o.tileGrid,tileLoadFunction:o.tileLoadFunction,url:o.url,urls:o.urls,wrapX:o.wrapX===void 0||o.wrapX,transition:o.transition,zDirection:o.zDirection})||this).js=o.gutter!==void 0?o.gutter:0,e.xh=f,e.Ph=!0,e.kh=o.serverType,e._a=o.hidpi===void 0||o.hidpi,e.Ao=[1/0,1/0,-1/0,-1/0],e.Ch(),e.setKey(e.$h()),e}return NP(i,s),i.prototype.getFeatureInfoUrl=function(t,e,o,l){var f=ie(o),y=this.getProjection(),w=this.getTileGrid();w||(w=this.getTileGridForProjection(f));var b=w.getZForResolution(e,this.zDirection),I=w.getTileCoordForCoordAndZ(t,b);if(!(w.getResolutions().length<=I[0])){var N=w.getResolution(I[0]),D=w.getTileCoordExtent(I,this.Ao),j=Pn(w.getTileSize(I[0]),this.tmpSize),H=this.js;H!==0&&(j=ma(j,H,this.tmpSize),D=Fr(D,N*H,D)),y&&y!==f&&(N=xp(y,f,t,N),D=Vi(D,f,y),t=xo(t,f,y));var Z={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.xh.LAYERS};Vt(Z,this.xh,l);var it=Math.floor((t[0]-D[0])/N),at=Math.floor((D[3]-t[1])/N);return Z[this.Ph?"I":"X"]=it,Z[this.Ph?"J":"Y"]=at,this.Oh(I,j,D,1,y||f,Z)}},i.prototype.getLegendUrl=function(t,e){if(this.urls[0]!==void 0){var o={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){var l=this.xh.LAYERS;if(!(!Array.isArray(l)||l.length===1))return;o.LAYER=l}if(t!==void 0){var f=this.getProjection()?this.getProjection().getMetersPerUnit():1;o.SCALE=t*f/28e-5}return Vt(o,e),Hl(this.urls[0],o)}},i.prototype.getGutter=function(){return this.js},i.prototype.getParams=function(){return this.xh},i.prototype.Oh=function(t,e,o,l,f,y){var w=this.urls;if(w){if(y.WIDTH=e[0],y.HEIGHT=e[1],y[this.Ph?"CRS":"SRS"]=f.getCode(),"STYLES"in this.xh||(y.STYLES=""),l!=1)switch(this.kh){case"geoserver":var b=90*l+.5|0;"FORMAT_OPTIONS"in y?y.FORMAT_OPTIONS+=";dpi:"+b:y.FORMAT_OPTIONS="dpi:"+b;break;case"mapserver":y.MAP_RESOLUTION=90*l;break;case"carmentaserver":case"qgis":y.DPI=90*l;break;default:Me(!1,52)}var I,N=f.getAxisOrientation(),D=o;if(this.Ph&&N.substr(0,2)=="ne"){var j=void 0;j=o[0],D[0]=o[1],D[1]=j,j=o[2],D[2]=o[3],D[3]=j}return y.BBOX=D.join(","),w.length==1?I=w[0]:I=w[be(rg(t),w.length)],Hl(I,y)}},i.prototype.getTilePixelRatio=function(t){return this._a&&this.kh!==void 0?t:1},i.prototype.$h=function(){var t=0,e=[];for(var o in this.xh)e[t++]=o+"-"+this.xh[o];return e.join("/")},i.prototype.updateParams=function(t){Vt(this.xh,t),this.Ch(),this.setKey(this.$h())},i.prototype.Ch=function(){var t=this.xh.VERSION||Sc;this.Ph=Bn(t,"1.3")>=0},i.prototype.tileUrlFunction=function(t,e,o){var l=this.getTileGrid();if(l||(l=this.getTileGridForProjection(o)),!(l.getResolutions().length<=t[0])){e==1||this._a&&this.kh!==void 0||(e=1);var f=l.getResolution(t[0]),y=l.getTileCoordExtent(t,this.Ao),w=Pn(l.getTileSize(t[0]),this.tmpSize),b=this.js;b!==0&&(w=ma(w,b,this.tmpSize),y=Fr(y,f*b,y)),e!=1&&(w=gh(w,e,this.tmpSize));var I={SERVICE:"WMS",VERSION:Sc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Vt(I,this.xh),this.Oh(t,w,y,e,o,I)}},i}(Yl),px=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),fx=function(s){function i(t,e,o,l,f,y){var w=s.call(this,t,e)||this;return w.Nt=o,w.st=l,w.Qh=f,w.tf=null,w.nf=null,w.B=null,w.if=y,w}return px(i,s),i.prototype.getImage=function(){return null},i.prototype.getData=function(t){if(!this.tf||!this.nf)return null;var e=(t[0]-this.st[0])/(this.st[2]-this.st[0]),o=(t[1]-this.st[1])/(this.st[3]-this.st[1]),l=this.tf[Math.floor((1-o)*this.tf.length)];if(typeof l!="string")return null;var f=l.charCodeAt(Math.floor(e*l.length));f>=93&&f--,f>=35&&f--;var y=null;if((f-=32)in this.nf){var w=this.nf[f];y=this.B&&w in this.B?this.B[w]:w}return y},i.prototype.forDataAtCoordinate=function(t,e,o){this.state==ar&&o===!0?(this.state=Er,Sr(this,ne,function(l){e(this.getData(t))},this),this.rf()):o===!0?setTimeout(function(){e(this.getData(t))}.bind(this),0):e(this.getData(t))},i.prototype.getKey=function(){return this.Nt},i.prototype.Nh=function(){this.state=ur,this.changed()},i.prototype.Ut=function(t){this.tf=t.grid,this.nf=t.keys,this.B=t.data,this.state=Oe,this.changed()},i.prototype.rf=function(){if(this.state==Er)if(this.state=br,this.if)Nf(this.Nt,this.Ut.bind(this),this.Nh.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.Hh.bind(this)),t.addEventListener("error",this.Jh.bind(this)),t.open("GET",this.Nt),t.send()}},i.prototype.Hh=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var o=void 0;try{o=JSON.parse(e.responseText)}catch{return void this.Nh()}this.Ut(o)}else this.Nh()},i.prototype.Jh=function(t){this.Nh()},i.prototype.load=function(){this.Qh?this.rf():this.setState(ar)},i}(Se),kP=function(s){function i(t){var e=s.call(this,{projection:ie("EPSG:3857"),state:"loading",zDirection:t.zDirection})||this;if(e.Qh=t.preemptive===void 0||t.preemptive,e.ef=z1,e.uf=void 0,e.if=t.jsonp||!1,t.url)if(e.if)Nf(t.url,e.handleTileJSONResponse.bind(e),e.handleTileJSONError.bind(e));else{var o=new XMLHttpRequest;o.addEventListener("load",e.Hh.bind(e)),o.addEventListener("error",e.Jh.bind(e)),o.open("GET",t.url),o.send()}else t.tileJSON?e.handleTileJSONResponse(t.tileJSON):Me(!1,51);return e}return px(i,s),i.prototype.Hh=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var o=void 0;try{o=JSON.parse(e.responseText)}catch{return void this.handleTileJSONError()}this.handleTileJSONResponse(o)}else this.handleTileJSONError()},i.prototype.Jh=function(t){this.handleTileJSONError()},i.prototype.getTemplate=function(){return this.uf},i.prototype.forDataAtCoordinateAndResolution=function(t,e,o,l){if(this.tileGrid){var f=this.tileGrid.getZForResolution(e,this.zDirection),y=this.tileGrid.getTileCoordForCoordAndZ(t,f);this.getTile(y[0],y[1],y[2],1,this.getProjection()).forDataAtCoordinate(t,o,l)}else l===!0?setTimeout(function(){o(null)},0):o(null)},i.prototype.handleTileJSONError=function(){this.setState("error")},i.prototype.handleTileJSONResponse=function(t){var e,o=ie("EPSG:4326"),l=this.getProjection();if(t.bounds!==void 0){var f=ji(o,l);e=M(t.bounds,f)}var y=wc(l),w=t.minzoom||0,b=vh({extent:y,maxZoom:t.maxzoom||22,minZoom:w});this.tileGrid=b,this.uf=t.template;var I=t.grids;if(I){if(this.ef=lg(I,b),t.attribution!==void 0){var N=e!==void 0?e:y;this.setAttributions(function(D){return on(N,D.extent)?[t.attribution]:null})}this.setState("ready")}else this.setState("error")},i.prototype.getTile=function(t,e,o,l,f){var y=Ul(t,e,o);if(this.tileCache.containsKey(y))return this.tileCache.get(y);var w=[t,e,o],b=this.getTileCoordForTileUrlFunction(w,f),I=this.ef(b,l,f),N=new fx(w,I!==void 0?Er:ar,I!==void 0?I:"",this.tileGrid.getTileCoordExtent(w),this.Qh,this.if);return this.tileCache.set(y,N),N},i.prototype.useTile=function(t,e,o){var l=Ul(t,e,o);this.tileCache.containsKey(l)&&this.tileCache.get(l)},i}(Wf),FP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),DP=function(s){function i(t){var e=this,o=t.imageSmoothing===void 0||t.imageSmoothing;t.interpolate!==void 0&&(o=t.interpolate);var l=t.requestEncoding!==void 0?t.requestEncoding:"KVP",f=t.tileGrid,y=t.urls;return y===void 0&&t.url!==void 0&&(y=cg(t.url)),(e=s.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:o,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:f,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:y,wrapX:t.wrapX!==void 0&&t.wrapX,transition:t.transition,zDirection:t.zDirection})||this).af=t.version!==void 0?t.version:"1.0.0",e.ze=t.format!==void 0?t.format:"image/jpeg",e.hf=t.dimensions!==void 0?t.dimensions:{},e.Ds=t.layer,e.ff=t.matrixSet,e.H=t.style,e.cf=l,e.setKey(e.lf()),y&&y.length>0&&(e.tileUrlFunction=wp(y.map(e.createFromWMTSTemplate.bind(e)))),e}return FP(i,s),i.prototype.setUrls=function(t){this.urls=t;var e=t.join(`
`);this.setTileUrlFunction(wp(t.map(this.createFromWMTSTemplate.bind(this))),e)},i.prototype.getDimensions=function(){return this.hf},i.prototype.getFormat=function(){return this.ze},i.prototype.getLayer=function(){return this.Ds},i.prototype.getMatrixSet=function(){return this.ff},i.prototype.getRequestEncoding=function(){return this.cf},i.prototype.getStyle=function(){return this.H},i.prototype.getVersion=function(){return this.af},i.prototype.lf=function(){var t=0,e=[];for(var o in this.hf)e[t++]=o+"-"+this.hf[o];return e.join("/")},i.prototype.updateDimensions=function(t){Vt(this.hf,t),this.setKey(this.lf())},i.prototype.createFromWMTSTemplate=function(t){var e=this.cf,o={layer:this.Ds,style:this.H,tilematrixset:this.ff};e=="KVP"&&Vt(o,{Service:"WMTS",Request:"GetTile",Version:this.af,Format:this.ze}),t=e=="KVP"?Hl(t,o):t.replace(/\{(\w+?)\}/g,function(y,w){return w.toLowerCase()in o?o[w.toLowerCase()]:y});var l=this.tileGrid,f=this.hf;return function(y,w,b){if(y){var I={TileMatrix:l.getMatrixId(y[0]),TileCol:y[1],TileRow:y[2]};Vt(I,f);var N=t;return N=e=="KVP"?Hl(N,I):N.replace(/\{(\w+?)\}/g,function(D,j){return I[j]})}}},i}(Yl),GP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),dx="renderOrder",kp=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);return delete l.style,delete l.renderBuffer,delete l.updateWhileAnimating,delete l.updateWhileInteracting,(e=s.call(this,l)||this).vf=o.declutter!==void 0&&o.declutter,e.df=o.renderBuffer!==void 0?o.renderBuffer:100,e.H=null,e.tt=void 0,e.setStyle(o.style),e.pf=o.updateWhileAnimating!==void 0&&o.updateWhileAnimating,e.yf=o.updateWhileInteracting!==void 0&&o.updateWhileInteracting,e}return GP(i,s),i.prototype.getDeclutter=function(){return this.vf},i.prototype.getFeatures=function(t){return s.prototype.getFeatures.call(this,t)},i.prototype.getRenderBuffer=function(){return this.df},i.prototype.getRenderOrder=function(){return this.get(dx)},i.prototype.getStyle=function(){return this.H},i.prototype.getStyleFunction=function(){return this.tt},i.prototype.getUpdateWhileAnimating=function(){return this.pf},i.prototype.getUpdateWhileInteracting=function(){return this.yf},i.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new Iy(9)),this.getRenderer().renderDeclutter(t)},i.prototype.setRenderOrder=function(t){this.set(dx,t)},i.prototype.setStyle=function(t){this.H=t!==void 0?t:E_,this.tt=t===null?void 0:S_(this.H),this.changed()},i}(pa),jP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),tv=function(s){function i(t,e){var o=this,l=e.uniforms||{},f=[1,0,0,1,0,0];l[qE]=f,(o=s.call(this,t,{uniforms:l,postProcesses:e.postProcesses})||this).ready=!1,o.mf=-1,o.wf=new Sp(bp,hg),o.gf=new Sp(bp,hg),o.bf=new Sp(kf,hg),o.Hs=e.vertexShader,o.Js=e.fragmentShader,o.Ks,o.xf=!(!e.hitFragmentShader||!e.hitVertexShader),o.Mf=e.hitVertexShader,o._f=e.hitFragmentShader,o.Sf;var y=e.attributes?e.attributes.map(function(b){return{name:"a_"+b.name,size:1,type:Ba.FLOAT}}):[];o.attributes=[{name:"a_position",size:2,type:Ba.FLOAT},{name:"a_index",size:1,type:Ba.FLOAT}].concat(y),o.hitDetectionAttributes=[{name:"a_position",size:2,type:Ba.FLOAT},{name:"a_index",size:1,type:Ba.FLOAT},{name:"a_hitColor",size:4,type:Ba.FLOAT},{name:"a_featureUid",size:1,type:Ba.FLOAT}].concat(y),o.customAttributes=e.attributes?e.attributes:[],o.$i=[1/0,1/0,-1/0,-1/0],o.Of=f,o.jf=[1,0,0,1,0,0],o.Ef=[1,0,0,1,0,0],o.Tf=new Float32Array(0),o.Af=new Float32Array(0),o.Pf,o.Cf=0,o.kf=function(){var b='const e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1,n=arguments.length;e<n;++e){const n=arguments[e];if(null!=n)for(const e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}return t},n="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";n.indexOf("firefox");-1!==n.indexOf("safari")&&-1==n.indexOf("chrom")&&(n.indexOf("version/15.4")>=0||n.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==n.indexOf("webkit")&&n.indexOf("edge"),n.indexOf("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){let e=!1;try{const n=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,n),window.removeEventListener("_",null,n)}catch(e){}}(),new Array(6);const t="GENERATE_BUFFERS",o=[],r={vertexPosition:0,indexPosition:0};function i(e,n,t,o,r){e[n+0]=t,e[n+1]=o,e[n+2]=r}function s(e,n,t,s,f,c){const l=3+f,a=e[n+0],u=e[n+1],d=o;d.length=f;for(let t=0;t<d.length;t++)d[t]=e[n+2+t];let g=c?c.vertexPosition:0,x=c?c.indexPosition:0;const h=g/l;return i(t,g,a,u,0),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,1),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,2),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,3),d.length&&t.set(d,g+3),g+=l,s[x++]=h,s[x++]=h+1,s[x++]=h+3,s[x++]=h+1,s[x++]=h+2,s[x++]=h+3,r.vertexPosition=g,r.indexPosition=x,r}const f=self;f.onmessage=n=>{const o=n.data;if(o.type===t){const n=3,t=2,r=o.customAttributesCount,i=t+r,c=new Float32Array(o.renderInstructions),l=c.length/i,a=4*l*(r+n),u=new Uint32Array(6*l),d=new Float32Array(a);let g;for(let e=0;e<c.length;e+=i)g=s(c,e,d,u,r,g);const x=e({vertexBuffer:d.buffer,indexBuffer:u.buffer,renderInstructions:c.buffer},o);f.postMessage(x,[d.buffer,u.buffer,c.buffer])}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(b,"binary").toString("base64"):URL.createObjectURL(new Blob([b],{type:"application/javascript"})))}(),o.kf.addEventListener("message",function(b){var I=b.data;if(I.type===my){var N=I.projectionTransform;I.hitDetection?(this.gf.fromArrayBuffer(I.vertexBuffer),this.helper.flushBufferData(this.gf)):(this.wf.fromArrayBuffer(I.vertexBuffer),this.helper.flushBufferData(this.wf)),this.bf.fromArrayBuffer(I.indexBuffer),this.helper.flushBufferData(this.bf),this.jf=N,Qt(this.Ef,this.jf),I.hitDetection?this.Af=new Float32Array(b.data.renderInstructions):(this.Tf=new Float32Array(b.data.renderInstructions),I.generateBuffersRun===this.Cf&&(this.ready=!0)),this.getLayer().changed()}}.bind(o)),o.If={},o.Nf=0;var w=o.getLayer().getSource();return o.Lf=[Ee(w,wh,o.zf,o),Ee(w,O_,o.Rf,o),Ee(w,Zf,o.Ff,o),Ee(w,N_,o.Gf,o)],w.forEachFeature(function(b){this.If[L(b)]={feature:b,properties:b.getProperties(),geometry:b.getGeometry()},this.Nf++}.bind(o)),o}return jP(i,s),i.prototype.afterHelperCreated=function(){this.Ks=this.helper.getProgram(this.Js,this.Hs),this.xf&&(this.Sf=this.helper.getProgram(this._f,this.Mf),this.Pf=new Q1(this.helper))},i.prototype.zf=function(t){var e=t.feature;this.If[L(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.Nf++},i.prototype.Rf=function(t){var e=t.feature;this.If[L(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}},i.prototype.Ff=function(t){var e=t.feature;delete this.If[L(e)],this.Nf--},i.prototype.Gf=function(){this.If={},this.Nf=0},i.prototype.renderFrame=function(t){var e=this.helper.getGL();this.preRender(e,t);var o=t.viewState.projection,l=this.getLayer().getSource().getWrapX()&&o.canWrapX(),f=o.getExtent(),y=t.extent,w=l?Gr(f):null,b=l?Math.ceil((y[2]-f[2])/w)+1:1,I=l?Math.floor((y[0]-f[0])/w):0,N=I,D=this.bf.getSize();do this.helper.makeProjectionTransform(t,this.Of),Gt(this.Of,N*w,0),qi(this.Of,this.Ef),this.helper.applyUniforms(t),this.helper.drawElements(0,D);while(++N<b);this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var j=this.helper.getCanvas();return this.xf&&(this.renderHitDetection(t,I,b,w),this.Pf.clearCachedData()),this.postRender(e,t),j},i.prototype.prepareFrameInternal=function(t){var e=this.getLayer(),o=e.getSource(),l=t.viewState,f=!t.viewHints[is]&&!t.viewHints[Os],y=!ko(this.$i,t.extent),w=this.mf<o.getRevision();if(w&&(this.mf=o.getRevision()),f&&(y||w)){var b=l.projection,I=l.resolution,N=e instanceof kp?e.getRenderBuffer():0,D=Fr(t.extent,N*I);o.loadFeatures(D,I,b),this.Df(t),this.$i=t.extent.slice()}return this.helper.useProgram(this.Ks),this.helper.prepareDraw(t),this.helper.bindBuffer(this.wf),this.helper.bindBuffer(this.bf),this.helper.enableAttributes(this.attributes),!0},i.prototype.Df=function(t){var e=[1,0,0,1,0,0];this.helper.makeProjectionTransform(t,e);var o,l,f=(2+this.customAttributes.length)*this.Nf;if(this.Tf&&this.Tf.length===f||(this.Tf=new Float32Array(f)),this.xf){var y=(7+this.customAttributes.length)*this.Nf;this.Af&&this.Af.length===y||(this.Af=new Float32Array(y))}var w,b=[],I=[],N=0,D=0;for(var j in this.If)if((l=(o=this.If[j]).geometry)&&l.getType()==="Point"){b[0]=l.getFlatCoordinates()[0],b[1]=l.getFlatCoordinates()[1],Ei(e,b),w=i_(D+6,I),this.Tf[N++]=b[0],this.Tf[N++]=b[1],this.xf&&(this.Af[D++]=b[0],this.Af[D++]=b[1],this.Af[D++]=w[0],this.Af[D++]=w[1],this.Af[D++]=w[2],this.Af[D++]=w[3],this.Af[D++]=Number(j));for(var H=void 0,Z=0;Z<this.customAttributes.length;Z++)H=this.customAttributes[Z].callback(o.feature,o.properties),this.Tf[N++]=H,this.xf&&(this.Af[D++]=H)}var it={type:my,renderInstructions:this.Tf.buffer,customAttributesCount:this.customAttributes.length};if(it.projectionTransform=e,it.generateBuffersRun=++this.Cf,this.ready=!1,this.kf.postMessage(it,[this.Tf.buffer]),this.Tf=null,this.xf){var at={type:my,renderInstructions:this.Af.buffer,customAttributesCount:5+this.customAttributes.length};at.projectionTransform=e,at.hitDetection=!0,this.kf.postMessage(at,[this.Af.buffer]),this.Af=null}},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f){if(Me(this.xf,66),this.Af){var y=Ei(e.coordinateToPixelTransform,t.slice()),w=this.Pf.readPixel(y[0]/2,y[1]/2),b=n_([w[0]/255,w[1]/255,w[2]/255,w[3]/255]),I=this.Af[b],N=Math.floor(I).toString(),D=this.getLayer().getSource().getFeatureByUid(N);return D?l(D,this.getLayer(),null):void 0}},i.prototype.renderHitDetection=function(t,e,o,l){if(this.gf.getSize()){var f=e;this.Pf.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.Sf),this.helper.prepareDrawToRenderTarget(t,this.Pf,!0),this.helper.bindBuffer(this.gf),this.helper.bindBuffer(this.bf),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(t,this.Of),Gt(this.Of,f*l,0),qi(this.Of,this.Ef),this.helper.applyUniforms(t);var y=this.bf.getSize();this.helper.drawElements(0,y)}while(++f<o)}},i.prototype.disposeInternal=function(){this.kf.terminate(),this.Ds=null,this.Lf.forEach(function(t){Or(t)}),this.Lf=null,s.prototype.disposeInternal.call(this)},i}(vy),td={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},ed=[td.FILL],Ec=[td.STROKE],vu=[td.BEGIN_PATH],ev=[td.CLOSE_PATH],pi=td,BP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Fp=function(s){function i(t,e,o,l){var f=s.call(this)||this;return f.tolerance=t,f.maxExtent=e,f.pixelRatio=l,f.maxLineWidth=0,f.resolution=o,f.qf=null,f.Uf=null,f.Bf=null,f.instructions=[],f.coordinates=[],f.Xf=[],f.hitDetectionInstructions=[],f.state={},f}return BP(i,s),i.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return e==1?t:t.map(function(o){return o*e})},i.prototype.appendFlatPointCoordinates=function(t,e){for(var o=this.getBufferedMaxExtent(),l=this.Xf,f=this.coordinates,y=f.length,w=0,b=t.length;w<b;w+=e)l[0]=t[w],l[1]=t[w+1],nn(o,l)&&(f[y++]=l[0],f[y++]=l[1]);return y},i.prototype.appendFlatLineCoordinates=function(t,e,o,l,f,y){var w=this.coordinates,b=w.length,I=this.getBufferedMaxExtent();y&&(e+=l);var N,D,j,H=t[e],Z=t[e+1],it=this.Xf,at=!0;for(N=e+l;N<o;N+=l)it[0]=t[N],it[1]=t[N+1],(j=Us(I,it))!==D?(at&&(w[b++]=H,w[b++]=Z,at=!1),w[b++]=it[0],w[b++]=it[1]):j===Ce?(w[b++]=it[0],w[b++]=it[1],at=!1):at=!0,H=it[0],Z=it[1],D=j;return(f&&at||N===e+l)&&(w[b++]=H,w[b++]=Z),b},i.prototype.Vf=function(t,e,o,l,f){for(var y=0,w=o.length;y<w;++y){var b=o[y],I=this.appendFlatLineCoordinates(t,e,b,l,!1,!1);f.push(I),e=b}return e},i.prototype.drawCustom=function(t,e,o,l){this.beginGeometry(t,e);var f,y,w,b,I,N=t.getType(),D=t.getStride(),j=this.coordinates.length;switch(N){case"MultiPolygon":f=t.getOrientedFlatCoordinates(),b=[];var H=t.getEndss();I=0;for(var Z=0,it=H.length;Z<it;++Z){var at=[];I=this.Vf(f,I,H[Z],D,at),b.push(at)}this.instructions.push([pi.CUSTOM,j,b,t,o,La]),this.hitDetectionInstructions.push([pi.CUSTOM,j,b,t,l||o,La]);break;case"Polygon":case"MultiLineString":w=[],f=N=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),I=this.Vf(f,0,t.getEnds(),D,w),this.instructions.push([pi.CUSTOM,j,w,t,o,Ma]),this.hitDetectionInstructions.push([pi.CUSTOM,j,w,t,l||o,Ma]);break;case"LineString":case"Circle":f=t.getFlatCoordinates(),y=this.appendFlatLineCoordinates(f,0,f.length,D,!1,!1),this.instructions.push([pi.CUSTOM,j,y,t,o,cs]),this.hitDetectionInstructions.push([pi.CUSTOM,j,y,t,l||o,cs]);break;case"MultiPoint":f=t.getFlatCoordinates(),(y=this.appendFlatPointCoordinates(f,D))>j&&(this.instructions.push([pi.CUSTOM,j,y,t,o,cs]),this.hitDetectionInstructions.push([pi.CUSTOM,j,y,t,l||o,cs]));break;case"Point":f=t.getFlatCoordinates(),this.coordinates.push(f[0],f[1]),y=this.coordinates.length,this.instructions.push([pi.CUSTOM,j,y,t,o]),this.hitDetectionInstructions.push([pi.CUSTOM,j,y,t,l||o])}this.endGeometry(e)},i.prototype.beginGeometry=function(t,e){this.qf=[pi.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.qf),this.Uf=[pi.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.Uf)},i.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},i.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var o,l,f=e.length,y=-1;for(t=0;t<f;++t)(l=(o=e[t])[0])==pi.END_GEOMETRY?y=t:l==pi.BEGIN_GEOMETRY&&(o[2]=t,ct(this.hitDetectionInstructions,y,t),y=-1)},i.prototype.setFillStrokeStyle=function(t,e){var o=this.state;if(t){var l=t.getColor();o.fillStyle=gl(l||Xs)}else o.fillStyle=void 0;if(e){var f=e.getColor();o.strokeStyle=gl(f||Ps);var y=e.getLineCap();o.lineCap=y!==void 0?y:ka;var w=e.getLineDash();o.lineDash=w?w.slice():pl;var b=e.getLineDashOffset();o.lineDashOffset=b||0;var I=e.getLineJoin();o.lineJoin=I!==void 0?I:Fa;var N=e.getWidth();o.lineWidth=N!==void 0?N:1;var D=e.getMiterLimit();o.miterLimit=D!==void 0?D:Da,o.lineWidth>this.maxLineWidth&&(this.maxLineWidth=o.lineWidth,this.Bf=null)}else o.strokeStyle=void 0,o.lineCap=void 0,o.lineDash=null,o.lineDashOffset=void 0,o.lineJoin=void 0,o.lineWidth=void 0,o.miterLimit=void 0},i.prototype.createFill=function(t){var e=t.fillStyle,o=[pi.SET_FILL_STYLE,e];return typeof e!="string"&&o.push(!0),o},i.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},i.prototype.createStroke=function(t){return[pi.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},i.prototype.updateFillStyle=function(t,e){var o=t.fillStyle;typeof o=="string"&&t.currentFillStyle==o||(o!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=o)},i.prototype.updateStrokeStyle=function(t,e){var o=t.strokeStyle,l=t.lineCap,f=t.lineDash,y=t.lineDashOffset,w=t.lineJoin,b=t.lineWidth,I=t.miterLimit;(t.currentStrokeStyle!=o||t.currentLineCap!=l||f!=t.currentLineDash&&!$(t.currentLineDash,f)||t.currentLineDashOffset!=y||t.currentLineJoin!=w||t.currentLineWidth!=b||t.currentMiterLimit!=I)&&(o!==void 0&&e.call(this,t),t.currentStrokeStyle=o,t.currentLineCap=l,t.currentLineDash=f,t.currentLineDashOffset=y,t.currentLineJoin=w,t.currentLineWidth=b,t.currentMiterLimit=I)},i.prototype.endGeometry=function(t){this.qf[2]=this.instructions.length,this.qf=null,this.Uf[2]=this.hitDetectionInstructions.length,this.Uf=null;var e=[pi.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},i.prototype.getBufferedMaxExtent=function(){if(!this.Bf&&(this.Bf=Ur(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Fr(this.Bf,t,this.Bf)}return this.Bf},i}(ey),zP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),gx=function(s){function i(t,e,o,l){var f=s.call(this,t,e,o,l)||this;return f._u=null,f.Lt=null,f.Wf=void 0,f.Yf=void 0,f.Zf=void 0,f.$f=void 0,f.ou=void 0,f.Kf=void 0,f.Hf=void 0,f.su=void 0,f.Dr=void 0,f.uu=void 0,f.Uu=void 0,f.fu=void 0,f.Jf=void 0,f}return zP(i,s),i.prototype.drawPoint=function(t,e){if(this.Lt){this.beginGeometry(t,e);var o=t.getFlatCoordinates(),l=t.getStride(),f=this.coordinates.length,y=this.appendFlatPointCoordinates(o,l);this.instructions.push([pi.DRAW_IMAGE,f,y,this.Lt,this.Yf*this.Wf,this.Zf*this.Wf,Math.ceil(this.$f*this.Wf),this.ou,this.Kf*this.Wf,this.Hf*this.Wf,this.su,this.Dr,[this.uu[0]*this.pixelRatio/this.Wf,this.uu[1]*this.pixelRatio/this.Wf],Math.ceil(this.Uu*this.Wf),this.fu,this.Jf]),this.hitDetectionInstructions.push([pi.DRAW_IMAGE,f,y,this._u,this.Yf,this.Zf,this.$f,this.ou,this.Kf,this.Hf,this.su,this.Dr,this.uu,this.Uu,this.fu,this.Jf]),this.endGeometry(e)}},i.prototype.drawMultiPoint=function(t,e){if(this.Lt){this.beginGeometry(t,e);var o=t.getFlatCoordinates(),l=t.getStride(),f=this.coordinates.length,y=this.appendFlatPointCoordinates(o,l);this.instructions.push([pi.DRAW_IMAGE,f,y,this.Lt,this.Yf*this.Wf,this.Zf*this.Wf,Math.ceil(this.$f*this.Wf),this.ou,this.Kf*this.Wf,this.Hf*this.Wf,this.su,this.Dr,[this.uu[0]*this.pixelRatio/this.Wf,this.uu[1]*this.pixelRatio/this.Wf],Math.ceil(this.Uu*this.Wf),this.fu,this.Jf]),this.hitDetectionInstructions.push([pi.DRAW_IMAGE,f,y,this._u,this.Yf,this.Zf,this.$f,this.ou,this.Kf,this.Hf,this.su,this.Dr,this.uu,this.Uu,this.fu,this.Jf]),this.endGeometry(e)}},i.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.Yf=void 0,this.Zf=void 0,this._u=null,this.Lt=null,this.Wf=void 0,this.$f=void 0,this.uu=void 0,this.ou=void 0,this.Kf=void 0,this.Hf=void 0,this.su=void 0,this.Dr=void 0,this.Uu=void 0,s.prototype.finish.call(this)},i.prototype.setImageStyle=function(t,e){var o=t.getAnchor(),l=t.getSize(),f=t.getOrigin();this.Wf=t.getPixelRatio(this.pixelRatio),this.Yf=o[0],this.Zf=o[1],this._u=t.getHitDetectionImage(),this.Lt=t.getImage(this.pixelRatio),this.$f=l[1],this.ou=t.getOpacity(),this.Kf=f[0],this.Hf=f[1],this.su=t.getRotateWithView(),this.Dr=t.getRotation(),this.uu=t.getScaleArray(),this.Uu=l[0],this.fu=t.getDeclutterMode(),this.Jf=e},i}(Fp),VP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),mx=function(s){function i(t,e,o,l){return s.call(this,t,e,o,l)||this}return VP(i,s),i.prototype.Qf=function(t,e,o,l){var f=this.coordinates.length,y=this.appendFlatLineCoordinates(t,e,o,l,!1,!1),w=[pi.MOVE_TO_LINE_TO,f,y];return this.instructions.push(w),this.hitDetectionInstructions.push(w),o},i.prototype.drawLineString=function(t,e){var o=this.state,l=o.strokeStyle,f=o.lineWidth;if(l!==void 0&&f!==void 0){this.updateStrokeStyle(o,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([pi.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,pl,0],vu);var y=t.getFlatCoordinates(),w=t.getStride();this.Qf(y,0,y.length,w),this.hitDetectionInstructions.push(Ec),this.endGeometry(e)}},i.prototype.drawMultiLineString=function(t,e){var o=this.state,l=o.strokeStyle,f=o.lineWidth;if(l!==void 0&&f!==void 0){this.updateStrokeStyle(o,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([pi.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset],vu);for(var y=t.getEnds(),w=t.getFlatCoordinates(),b=t.getStride(),I=0,N=0,D=y.length;N<D;++N)I=this.Qf(w,I,y[N],b);this.hitDetectionInstructions.push(Ec),this.endGeometry(e)}},i.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ec),this.reverseHitDetectionInstructions(),this.state=null,s.prototype.finish.call(this)},i.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ec),t.lastStroke=this.coordinates.length),t.lastStroke=0,s.prototype.applyStroke.call(this,t),this.instructions.push(vu)},i}(Fp),UP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),rv=function(s){function i(t,e,o,l){return s.call(this,t,e,o,l)||this}return UP(i,s),i.prototype.tc=function(t,e,o,l){var f=this.state,y=f.fillStyle!==void 0,w=f.strokeStyle!==void 0,b=o.length;this.instructions.push(vu),this.hitDetectionInstructions.push(vu);for(var I=0;I<b;++I){var N=o[I],D=this.coordinates.length,j=this.appendFlatLineCoordinates(t,e,N,l,!0,!w),H=[pi.MOVE_TO_LINE_TO,D,j];this.instructions.push(H),this.hitDetectionInstructions.push(H),w&&(this.instructions.push(ev),this.hitDetectionInstructions.push(ev)),e=N}return y&&(this.instructions.push(ed),this.hitDetectionInstructions.push(ed)),w&&(this.instructions.push(Ec),this.hitDetectionInstructions.push(Ec)),e},i.prototype.drawCircle=function(t,e){var o=this.state,l=o.fillStyle,f=o.strokeStyle;if(l!==void 0||f!==void 0){this.ic(),this.beginGeometry(t,e),o.fillStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_FILL_STYLE,Xs]),o.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset]);var y=t.getFlatCoordinates(),w=t.getStride(),b=this.coordinates.length;this.appendFlatLineCoordinates(y,0,y.length,w,!1,!1);var I=[pi.CIRCLE,b];this.instructions.push(vu,I),this.hitDetectionInstructions.push(vu,I),o.fillStyle!==void 0&&(this.instructions.push(ed),this.hitDetectionInstructions.push(ed)),o.strokeStyle!==void 0&&(this.instructions.push(Ec),this.hitDetectionInstructions.push(Ec)),this.endGeometry(e)}},i.prototype.drawPolygon=function(t,e){var o=this.state,l=o.fillStyle,f=o.strokeStyle;if(l!==void 0||f!==void 0){this.ic(),this.beginGeometry(t,e),o.fillStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_FILL_STYLE,Xs]),o.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset]);var y=t.getEnds(),w=t.getOrientedFlatCoordinates(),b=t.getStride();this.tc(w,0,y,b),this.endGeometry(e)}},i.prototype.drawMultiPolygon=function(t,e){var o=this.state,l=o.fillStyle,f=o.strokeStyle;if(l!==void 0||f!==void 0){this.ic(),this.beginGeometry(t,e),o.fillStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_FILL_STYLE,Xs]),o.strokeStyle!==void 0&&this.hitDetectionInstructions.push([pi.SET_STROKE_STYLE,o.strokeStyle,o.lineWidth,o.lineCap,o.lineJoin,o.miterLimit,o.lineDash,o.lineDashOffset]);for(var y=t.getEndss(),w=t.getOrientedFlatCoordinates(),b=t.getStride(),I=0,N=0,D=y.length;N<D;++N)I=this.tc(w,I,y[N],b);this.endGeometry(e)}},i.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var e=this.coordinates,o=0,l=e.length;o<l;++o)e[o]=jo(e[o],t);return s.prototype.finish.call(this)},i.prototype.ic=function(){var t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},i}(Fp);function yx(s,i,t,e,o){var l,f,y,w,b,I,N,D,j,H=t,Z=t,it=0,at=0,wt=t;for(l=t;l<e;l+=o){var gt=i[l],yt=i[l+1];w!==void 0&&(D=gt-w,j=yt-b,y=Math.sqrt(D*D+j*j),I!==void 0&&(at+=f,Math.acos((I*D+N*j)/(f*y))>s&&(at>it&&(it=at,H=wt,Z=l),at=0,wt=l-o)),f=y,I=D,N=j),w=gt,b=yt}return(at+=y)>it?[wt,l]:[H,Z]}var qP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),rd={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},vx=function(s){function i(t,e,o,l){var f=s.call(this,t,e,o,l)||this;return f.rc=null,f.eo="",f.oo=0,f.so=0,f.uo=void 0,f.ao=0,f.fo=null,f.fillStates={},f.co=null,f.strokeStates={},f.lo={},f.textStates={},f.ec="",f.oc="",f.sc="",f.Jf=void 0,f}return qP(i,s),i.prototype.finish=function(){var t=s.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},i.prototype.drawText=function(t,e){var o=this.fo,l=this.co,f=this.lo;if(this.eo!==""&&f&&(o||l)){var y=this.coordinates,w=y.length,b=t.getType(),I=null,N=t.getStride();if(f.placement!==mC||b!="LineString"&&b!="MultiLineString"&&b!="Polygon"&&b!="MultiPolygon"){var D=f.overflow?null:[];switch(b){case"Point":case"MultiPoint":I=t.getFlatCoordinates();break;case"LineString":I=t.getFlatMidpoint();break;case"Circle":I=t.getCenter();break;case"MultiLineString":I=t.getFlatMidpoints(),N=2;break;case"Polygon":I=t.getFlatInteriorPoint(),f.overflow||D.push(I[2]/this.resolution),N=3;break;case"MultiPolygon":var j=t.getFlatInteriorPoints();for(I=[],Dt=0,Xt=j.length;Dt<Xt;Dt+=3)f.overflow||D.push(j[Dt+2]/this.resolution),I.push(j[Dt],j[Dt+1]);if(I.length===0)return;N=2}if((Ge=this.appendFlatPointCoordinates(I,N))===w)return;if(D&&(Ge-w)/2!=I.length/N){var H=w/2;D=D.filter(function(Qe,ir){var de=y[2*(H+ir)]===I[ir*N]&&y[2*(H+ir)+1]===I[ir*N+1];return de||--H,de})}this.uc(),(f.backgroundFill||f.backgroundStroke)&&(this.setFillStrokeStyle(f.backgroundFill,f.backgroundStroke),f.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),f.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var Z=f.padding;if(Z!=Fl&&(f.scale[0]<0||f.scale[1]<0)){var it=f.padding[0],at=f.padding[1],wt=f.padding[2],gt=f.padding[3];f.scale[0]<0&&(at=-at,gt=-gt),f.scale[1]<0&&(it=-it,wt=-wt),Z=[it,at,wt,gt]}var yt=this.pixelRatio;this.instructions.push([pi.DRAW_IMAGE,w,Ge,null,NaN,NaN,NaN,1,0,0,this.uo,this.ao,[1,1],NaN,void 0,this.Jf,Z==Fl?Fl:Z.map(function(Qe){return Qe*yt}),!!f.backgroundFill,!!f.backgroundStroke,this.eo,this.ec,this.sc,this.oc,this.oo,this.so,D]);var It=1/yt;this.hitDetectionInstructions.push([pi.DRAW_IMAGE,w,Ge,null,NaN,NaN,NaN,1,0,0,this.uo,this.ao,[It,It],NaN,void 0,this.Jf,Z,!!f.backgroundFill,!!f.backgroundStroke,this.eo,this.ec,this.sc,this.oc,this.oo,this.so,D]),this.endGeometry(e)}else{if(!on(this.getBufferedMaxExtent(),t.getExtent()))return;var Rt=void 0;if(I=t.getFlatCoordinates(),b=="LineString")Rt=[I.length];else if(b=="MultiLineString")Rt=t.getEnds();else if(b=="Polygon")Rt=t.getEnds().slice(0,1);else if(b=="MultiPolygon"){var kt=t.getEndss();Rt=[];for(var Dt=0,Xt=kt.length;Dt<Xt;++Dt)Rt.push(kt[Dt][0])}this.beginGeometry(t,e);for(var ee=f.textAlign,pe=0,xe=void 0,fe=0,Re=Rt.length;fe<Re;++fe){if(ee==null){var qe=yx(f.maxAngle,I,pe,Rt[fe],N);pe=qe[0],xe=qe[1]}else xe=Rt[fe];for(var Dt=pe;Dt<xe;Dt+=N)y.push(I[Dt],I[Dt+1]);var Ge=y.length;pe=Rt[fe],this.ac(w,Ge),w=Ge}this.endGeometry(e)}}},i.prototype.uc=function(){var t=this.co,e=this.lo,o=this.fo,l=this.sc;t&&(l in this.strokeStates||(this.strokeStates[l]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var f=this.ec;f in this.textStates||(this.textStates[f]={font:e.font,textAlign:e.textAlign||Ga,justify:e.justify,textBaseline:e.textBaseline||kl,scale:e.scale});var y=this.oc;o&&(y in this.fillStates||(this.fillStates[y]={fillStyle:o.fillStyle}))},i.prototype.ac=function(t,e){var o=this.co,l=this.lo,f=this.sc,y=this.ec,w=this.oc;this.uc();var b=this.pixelRatio,I=rd[l.textBaseline],N=this.so*b,D=this.eo,j=o?o.lineWidth*Math.abs(l.scale[0])/2:0;this.instructions.push([pi.DRAW_CHARS,t,e,I,l.overflow,w,l.maxAngle,b,N,f,j*b,D,y,1]),this.hitDetectionInstructions.push([pi.DRAW_CHARS,t,e,I,l.overflow,w,l.maxAngle,1,N,f,j,D,y,1/b])},i.prototype.setTextStyle=function(t,e){var o,l,f;if(t){var y=t.getFill();y?((l=this.fo)||(l={},this.fo=l),l.fillStyle=gl(y.getColor()||Xs)):(l=null,this.fo=l);var w=t.getStroke();if(w){(f=this.co)||(f={},this.co=f);var b=w.getLineDash(),I=w.getLineDashOffset(),N=w.getWidth(),D=w.getMiterLimit();f.lineCap=w.getLineCap()||ka,f.lineDash=b?b.slice():pl,f.lineDashOffset=I===void 0?0:I,f.lineJoin=w.getLineJoin()||Fa,f.lineWidth=N===void 0?1:N,f.miterLimit=D===void 0?Da:D,f.strokeStyle=gl(w.getColor()||Ps)}else f=null,this.co=f;o=this.lo;var j=t.getFont()||ou;fo(j);var H=t.getScaleArray();o.overflow=t.getOverflow(),o.font=j,o.maxAngle=t.getMaxAngle(),o.placement=t.getPlacement(),o.textAlign=t.getTextAlign(),o.justify=t.getJustify(),o.textBaseline=t.getTextBaseline()||kl,o.backgroundFill=t.getBackgroundFill(),o.backgroundStroke=t.getBackgroundStroke(),o.padding=t.getPadding()||Fl,o.scale=H===void 0?[1,1]:H;var Z=t.getOffsetX(),it=t.getOffsetY(),at=t.getRotateWithView(),wt=t.getRotation();this.eo=t.getText()||"",this.oo=Z===void 0?0:Z,this.so=it===void 0?0:it,this.uo=at!==void 0&&at,this.ao=wt===void 0?0:wt,this.sc=f?(typeof f.strokeStyle=="string"?f.strokeStyle:L(f.strokeStyle))+f.lineCap+f.lineDashOffset+"|"+f.lineWidth+f.lineJoin+f.miterLimit+"["+f.lineDash.join()+"]":"",this.ec=o.font+o.scale+(o.textAlign||"?")+(o.justify||"?")+(o.textBaseline||"?"),this.oc=l?typeof l.fillStyle=="string"?l.fillStyle:"|"+L(l.fillStyle):""}else this.eo="";this.Jf=e},i}(Fp),HP={Circle:rv,Default:Fp,Image:gx,LineString:mx,Polygon:rv,Text:vx},id=function(){function s(i,t,e,o){this.hc=i,this.fc=t,this.kt=o,this.cc=e,this.lc={}}return s.prototype.finish=function(){var i={};for(var t in this.lc){i[t]=i[t]||{};var e=this.lc[t];for(var o in e){var l=e[o].finish();i[t][o]=l}}return i},s.prototype.getBuilder=function(i,t){var e=i!==void 0?i.toString():"0",o=this.lc[e];o===void 0&&(o={},this.lc[e]=o);var l=o[t];return l===void 0&&(l=new HP[t](this.hc,this.fc,this.cc,this.kt),o[t]=l),l},s}();function _x(s,i,t,e,o,l,f,y,w,b,I,N){var D=s[i],j=s[i+1],H=0,Z=0,it=0,at=0;function wt(){H=D,Z=j,D=s[i+=e],j=s[i+1],at+=it,it=Math.sqrt((D-H)*(D-H)+(j-Z)*(j-Z))}do wt();while(i<t-e&&at+it<l);for(var gt=it===0?0:(l-at)/it,yt=We(H,D,gt),It=We(Z,j,gt),Rt=i-e,kt=at,Dt=l+y*w(b,o,I);i<t-e&&at+it<Dt;)wt();var Xt,ee=We(H,D,gt=it===0?0:(Dt-at)/it),pe=We(Z,j,gt);if(N){var xe=[yt,It,ee,pe];Uu(xe,0,4,2,N,xe,xe),Xt=xe[0]>xe[2]}else Xt=yt>ee;var fe,Re=Math.PI,qe=[],Ge=Rt+e===i;if(it=0,at=kt,D=s[i=Rt],j=s[i+1],Ge){wt(),fe=Math.atan2(j-Z,D-H),Xt&&(fe+=fe>0?-Re:Re);var Qe=(ee+yt)/2,ir=(pe+It)/2;return qe[0]=[Qe,ir,(Dt-l)/2,fe,o],qe}for(var de=0,Nr=(o=o.replace(/\n/g," ")).length;de<Nr;){wt();var Pr=Math.atan2(j-Z,D-H);if(Xt&&(Pr+=Pr>0?-Re:Re),fe!==void 0){var he=Pr-fe;if(he+=he>Re?-2*Re:he<-Re?2*Re:0,Math.abs(he)>f)return null}fe=Pr;for(var $e=de,or=0;de<Nr;++de){var fi=y*w(b,o[Xt?Nr-de-1:de],I);if(i+e<t&&at+it<l+or+fi/2)break;or+=fi}if(de!==$e){var ki=Xt?o.substring(Nr-$e,Nr-de):o.substring($e,de);Qe=We(H,D,gt=it===0?0:(l+or/2-at)/it),ir=We(Z,j,gt),qe.push([Qe,ir,or/2,Pr,ki]),l+=or}}return qe}function Lg(s,i,t,e){for(var o=s[i],l=s[i+1],f=0,y=i+e;y<t;y+=e){var w=s[y],b=s[y+1];f+=Math.sqrt((w-o)*(w-o)+(b-l)*(b-l)),o=w,l=b}return f}var Dp=[1/0,1/0,-1/0,-1/0],_u=[],Cc=[],Tc=[],xu=[];function xx(s){return s[3].declutterBox}var XP=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function wx(s,i){return i!=="start"&&i!=="end"||XP.test(s)||(i=i==="start"?"left":"right"),rd[i]}function WP(s,i,t){return t>0&&s.push(`
`,""),s.push(i,""),s}var bx=function(){function s(i,t,e,o){this.overlaps=e,this.pixelRatio=t,this.resolution=i,this.vc,this.instructions=o.instructions,this.coordinates=o.coordinates,this.dc={},this.yc=[1,0,0,1,0,0],this.hitDetectionInstructions=o.hitDetectionInstructions,this.vo=null,this.Ge=0,this.fillStates=o.fillStates||{},this.strokeStates=o.strokeStates||{},this.textStates=o.textStates||{},this.mc={},this.rc={}}return s.prototype.createLabel=function(i,t,e,o){var l=i+t+e+o;if(this.rc[l])return this.rc[l];var f=o?this.strokeStates[o]:null,y=e?this.fillStates[e]:null,w=this.textStates[t],b=this.pixelRatio,I=[w.scale[0]*b,w.scale[1]*b],N=Array.isArray(i),D=w.justify?rd[w.justify]:wx(Array.isArray(i)?i[0]:i,w.textAlign||Ga),j=o&&f.lineWidth?f.lineWidth:0,H=N?i:i.split(`
`).reduce(WP,[]),Z=ah(w,H),it=Z.width,at=Z.height,wt=Z.widths,gt=Z.heights,yt=Z.lineWidths,It=it+j,Rt=[],kt=(It+2)*I[0],Dt=(at+j)*I[1],Xt={width:kt<0?Math.floor(kt):Math.ceil(kt),height:Dt<0?Math.floor(Dt):Math.ceil(Dt),contextInstructions:Rt};I[0]==1&&I[1]==1||Rt.push("scale",I),o&&(Rt.push("strokeStyle",f.strokeStyle),Rt.push("lineWidth",j),Rt.push("lineCap",f.lineCap),Rt.push("lineJoin",f.lineJoin),Rt.push("miterLimit",f.miterLimit),(gr?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(Rt.push("setLineDash",[f.lineDash]),Rt.push("lineDashOffset",f.lineDashOffset))),e&&Rt.push("fillStyle",y.fillStyle),Rt.push("textBaseline","middle"),Rt.push("textAlign","center");for(var ee,pe=.5-D,xe=D*It+pe*j,fe=[],Re=[],qe=0,Ge=0,Qe=0,ir=0,de=0,Nr=H.length;de<Nr;de+=2){var Pr=H[de];if(Pr!==`
`){var he=H[de+1]||w.font;he!==ee&&(o&&fe.push("font",he),e&&Re.push("font",he),ee=he),qe=Math.max(qe,gt[Qe]);var $e=[Pr,xe+pe*wt[Qe]+D*(wt[Qe]-yt[ir]),.5*(j+qe)+Ge];xe+=wt[Qe],o&&fe.push("strokeText",$e),e&&Re.push("fillText",$e),++Qe}else Ge+=qe,qe=0,xe=D*It+pe*j,++ir}return Array.prototype.push.apply(Rt,fe),Array.prototype.push.apply(Rt,Re),this.rc[l]=Xt,Xt},s.prototype.wc=function(i,t,e,o,l,f,y){i.beginPath(),i.moveTo.apply(i,t),i.lineTo.apply(i,e),i.lineTo.apply(i,o),i.lineTo.apply(i,l),i.lineTo.apply(i,t),f&&(this.vc=f[2],this.lu(i)),y&&(this.gc(i,y),i.stroke())},s.prototype.bc=function(i,t,e,o,l,f,y,w,b,I,N,D,j,H,Z,it){var at,wt=e-(y*=D[0]),gt=o-(w*=D[1]),yt=l+b>i?i-b:l,It=f+I>t?t-I:f,Rt=H[3]+yt*D[0]+H[1],kt=H[0]+It*D[1]+H[2],Dt=wt-H[3],Xt=gt-H[0];return(Z||N!==0)&&(_u[0]=Dt,xu[0]=Dt,_u[1]=Xt,Cc[1]=Xt,Cc[0]=Dt+Rt,Tc[0]=Cc[0],Tc[1]=Xt+kt,xu[1]=Tc[1]),N!==0?(Ei(at=At([1,0,0,1,0,0],e,o,1,1,N,-e,-o),_u),Ei(at,Cc),Ei(at,Tc),Ei(at,xu),En(Math.min(_u[0],Cc[0],Tc[0],xu[0]),Math.min(_u[1],Cc[1],Tc[1],xu[1]),Math.max(_u[0],Cc[0],Tc[0],xu[0]),Math.max(_u[1],Cc[1],Tc[1],xu[1]),Dp)):En(Math.min(Dt,Dt+Rt),Math.min(Xt,Xt+kt),Math.max(Dt,Dt+Rt),Math.max(Xt,Xt+kt),Dp),j&&(wt=Math.round(wt),gt=Math.round(gt)),{drawImageX:wt,drawImageY:gt,drawImageW:yt,drawImageH:It,originX:b,originY:I,declutterBox:{minX:Dp[0],minY:Dp[1],maxX:Dp[2],maxY:Dp[3],value:it},canvasTransform:at,scale:D}},s.prototype.xc=function(i,t,e,o,l,f,y){var w=!(!f&&!y),b=o.declutterBox,I=i.canvas,N=y?y[2]*o.scale[0]/2:0;return b.minX-N<=I.width/t&&b.maxX+N>=0&&b.minY-N<=I.height/t&&b.maxY+N>=0&&(w&&this.wc(i,_u,Cc,Tc,xu,f,y),lh(i,o.canvasTransform,l,e,o.originX,o.originY,o.drawImageW,o.drawImageH,o.drawImageX,o.drawImageY,o.scale)),!0},s.prototype.lu=function(i){if(this.vc){var t=Ei(this.yc,[0,0]),e=512*this.pixelRatio;i.save(),i.translate(t[0]%e,t[1]%e),i.rotate(this.Ge)}i.fill(),this.vc&&i.restore()},s.prototype.gc=function(i,t){i.strokeStyle=t[1],i.lineWidth=t[2],i.lineCap=t[3],i.lineJoin=t[4],i.miterLimit=t[5],i.setLineDash&&(i.lineDashOffset=t[7],i.setLineDash(t[6]))},s.prototype.Mc=function(i,t,e,o){var l=this.textStates[t],f=this.createLabel(i,t,o,e),y=this.strokeStates[e],w=this.pixelRatio,b=wx(Array.isArray(i)?i[0]:i,l.textAlign||Ga),I=rd[l.textBaseline||kl],N=y&&y.lineWidth?y.lineWidth:0;return{label:f,anchorX:b*(f.width/w-2*l.scale[0])+2*(.5-b)*N,anchorY:I*f.height/w+2*(.5-I)*N}},s.prototype._c=function(i,t,e,o,l,f,y,w){var b;this.vo&&$(e,this.yc)?b=this.vo:(this.vo||(this.vo=[]),b=Sa(this.coordinates,0,this.coordinates.length,2,e,this.vo),xi(this.yc,e));for(var I,N,D,j,H,Z,it,at,wt,gt,yt,It,Rt,kt,Dt,Xt,ee=0,pe=o.length,xe=0,fe=0,Re=0,qe=null,Ge=null,Qe=this.dc,ir=this.Ge,de=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,Nr={context:i,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ir},Pr=this.instructions!=o||this.overlaps?0:200;ee<pe;){var he=o[ee];switch(he[0]){case pi.BEGIN_GEOMETRY:Rt=he[1],Xt=he[3],Rt.getGeometry()?y===void 0||on(y,Xt.getExtent())?++ee:ee=he[2]+1:ee=he[2];break;case pi.BEGIN_PATH:fe>Pr&&(this.lu(i),fe=0),Re>Pr&&(i.stroke(),Re=0),fe||Re||(i.beginPath(),j=NaN,H=NaN),++ee;break;case pi.CIRCLE:var $e=b[xe=he[1]],or=b[xe+1],fi=b[xe+2]-$e,ki=b[xe+3]-or,Sn=Math.sqrt(fi*fi+ki*ki);i.moveTo($e+Sn,or),i.arc($e,or,Sn,0,2*Math.PI,!0),++ee;break;case pi.CLOSE_PATH:i.closePath(),++ee;break;case pi.CUSTOM:xe=he[1],I=he[2];var tr=he[3],Jn=he[4],Vo=he.length==6?he[5]:void 0;Nr.geometry=tr,Nr.feature=Rt,ee in Qe||(Qe[ee]=[]);var Hn=Qe[ee];Vo?Vo(b,xe,I,2,Hn):(Hn[0]=b[xe],Hn[1]=b[xe+1],Hn.length=2),Jn(Hn,Nr),++ee;break;case pi.DRAW_IMAGE:xe=he[1],I=he[2],at=he[3],N=he[4],D=he[5];var _a=he[6],Uo=he[7],ys=he[8],Ya=he[9],ss=he[10],qo=he[11],yr=he[12],ta=he[13],Za=he[14],xl=he[15];if(!at&&he.length>=20){wt=he[19],gt=he[20],yt=he[21],It=he[22];var $a=this.Mc(wt,gt,yt,It);at=$a.label,he[3]=at;var Nc=he[23];N=($a.anchorX-Nc)*this.pixelRatio,he[4]=N;var xa=he[24];D=($a.anchorY-xa)*this.pixelRatio,he[5]=D,_a=at.height,he[6]=_a,ta=at.width,he[13]=ta}var ju=void 0;he.length>25&&(ju=he[25]);var ic=void 0,nc=void 0,Bs=void 0;he.length>17?(ic=he[16],nc=he[17],Bs=he[18]):(ic=Fl,nc=!1,Bs=!1),ss&&de?qo+=ir:ss||de||(qo-=ir);for(var Fn=0;xe<I;xe+=2)if(!(ju&&ju[Fn++]<ta/this.pixelRatio)){var Bu=[i,t,at,Ja=this.bc(at.width,at.height,b[xe],b[xe+1],ta,_a,N,D,ys,Ya,qo,yr,l,ic,nc||Bs,Rt),Uo,nc?qe:null,Bs?Ge:null];if(w){if(Za==="none")continue;if(Za==="obstacle"){w.insert(Ja.declutterBox);continue}var wa=void 0,So=void 0;if(xl){var oc=I-xe;if(!xl[oc]){xl[oc]=Bu;continue}if(wa=xl[oc],delete xl[oc],So=xx(wa),w.collides(So))continue}if(w.collides(Ja.declutterBox))continue;wa&&(w.insert(So),this.xc.apply(this,wa)),w.insert(Ja.declutterBox)}this.xc.apply(this,Bu)}++ee;break;case pi.DRAW_CHARS:var Ro=he[1],Qp=he[2],tf=he[3],sc=he[4];It=he[5];var ef=he[6],Rc=he[7],Uh=he[8];yt=he[9];var kc=he[10];wt=he[11],gt=he[12];var Fc=[he[13],he[13]],Id=this.textStates[gt],Dc=Id.font,Gc=[Id.scale[0]*Rc,Id.scale[1]*Rc],jc=void 0;Dc in this.mc?jc=this.mc[Dc]:(jc={},this.mc[Dc]=jc);var rf=Lg(b,Ro,Qp,2),Nm=Math.abs(Gc[0])*_c(Dc,wt,jc);if(sc||Nm<=rf){var j0=this.textStates[gt].textAlign,qh=_x(b,Ro,Qp,2,wt,(rf-Nm)*rd[j0],ef,Math.abs(Gc[0]),_c,Dc,jc,de?0:this.Ge);t:if(qh){var Hh=[],wl=void 0,ea=void 0,zu=void 0,Eo=void 0,Ka=void 0;if(yt)for(wl=0,ea=qh.length;wl<ea;++wl){zu=(Ka=qh[wl])[4],Eo=this.createLabel(zu,gt,"",yt),N=Ka[2]+(Gc[0]<0?-kc:kc),D=tf*Eo.height+2*(.5-tf)*kc*Gc[1]/Gc[0]-Uh;var Ja=this.bc(Eo.width,Eo.height,Ka[0],Ka[1],Eo.width,Eo.height,N,D,0,0,Ka[3],Fc,!1,Fl,!1,Rt);if(w&&w.collides(Ja.declutterBox))break t;Hh.push([i,t,Eo,Ja,1,null,null])}if(It)for(wl=0,ea=qh.length;wl<ea;++wl){if(zu=(Ka=qh[wl])[4],Eo=this.createLabel(zu,gt,It,""),N=Ka[2],D=tf*Eo.height-Uh,Ja=this.bc(Eo.width,Eo.height,Ka[0],Ka[1],Eo.width,Eo.height,N,D,0,0,Ka[3],Fc,!1,Fl,!1,Rt),w&&w.collides(Ja.declutterBox))break t;Hh.push([i,t,Eo,Ja,1,null,null])}w&&w.load(Hh.map(xx));for(var Xh=0,Md=Hh.length;Xh<Md;++Xh)this.xc.apply(this,Hh[Xh])}}++ee;break;case pi.END_GEOMETRY:if(f!==void 0){var nf=f(Rt=he[1],Xt);if(nf)return nf}++ee;break;case pi.FILL:Pr?fe++:this.lu(i),++ee;break;case pi.MOVE_TO_LINE_TO:for(xe=he[1],I=he[2],kt=b[xe],it=(Dt=b[xe+1])+.5|0,(Z=kt+.5|0)===j&&it===H||(i.moveTo(kt,Dt),j=Z,H=it),xe+=2;xe<I;xe+=2)Z=(kt=b[xe])+.5|0,it=(Dt=b[xe+1])+.5|0,xe!=I-2&&Z===j&&it===H||(i.lineTo(kt,Dt),j=Z,H=it);++ee;break;case pi.SET_FILL_STYLE:qe=he,this.vc=he[2],fe&&(this.lu(i),fe=0,Re&&(i.stroke(),Re=0)),i.fillStyle=he[1],++ee;break;case pi.SET_STROKE_STYLE:Ge=he,Re&&(i.stroke(),Re=0),this.gc(i,he),++ee;break;case pi.STROKE:Pr?Re++:i.stroke(),++ee;break;default:++ee}}fe&&this.lu(i),Re&&i.stroke()},s.prototype.execute=function(i,t,e,o,l,f){this.Ge=o,this._c(i,t,e,this.instructions,l,void 0,void 0,f)},s.prototype.executeHitDetection=function(i,t,e,o,l){return this.Ge=e,this._c(i,1,t,this.hitDetectionInstructions,!0,o,l)},s}(),iv=["Polygon","Circle","LineString","Image","Text","Default"],YP=function(){function s(i,t,e,o,l,f){this.fc=i,this.za=o,this.kt=e,this.cc=t,this.df=f,this.Sc={},this.Oc=null,this.jc=[1,0,0,1,0,0],this.Ec(l)}return s.prototype.clip=function(i,t){var e=this.getClipCoords(t);i.beginPath(),i.moveTo(e[0],e[1]),i.lineTo(e[2],e[3]),i.lineTo(e[4],e[5]),i.lineTo(e[6],e[7]),i.clip()},s.prototype.Ec=function(i){for(var t in i){var e=this.Sc[t];e===void 0&&(e={},this.Sc[t]=e);var o=i[t];for(var l in o){var f=o[l];e[l]=new bx(this.cc,this.kt,this.za,f)}}},s.prototype.hasExecutors=function(i){for(var t in this.Sc)for(var e=this.Sc[t],o=0,l=i.length;o<l;++o)if(i[o]in e)return!0;return!1},s.prototype.forEachFeatureAtCoordinate=function(i,t,e,o,l,f){var y=2*(o=Math.round(o))+1,w=At(this.jc,o+.5,o+.5,1/t,-1/t,-e,-i[0],-i[1]),b=!this.Oc;b&&(this.Oc=Cn(y,y));var I,N=this.Oc;N.canvas.width!==y||N.canvas.height!==y?(N.canvas.width=y,N.canvas.height=y):b||N.clearRect(0,0,y,y),this.df!==void 0&&(Wo(I=[1/0,1/0,-1/0,-1/0],i),Fr(I,t*(this.df+o),I));var D,j=Sx(o);function H(Rt,kt){for(var Dt=N.getImageData(0,0,y,y).data,Xt=0,ee=j.length;Xt<ee;Xt++)if(Dt[j[Xt]]>0){if(!f||D!=="Image"&&D!=="Text"||f.indexOf(Rt)!==-1){var pe=(j[Xt]-3)/4,xe=o-pe%y,fe=o-(pe/y|0),Re=l(Rt,kt,xe*xe+fe*fe);if(Re)return Re}N.clearRect(0,0,y,y);break}}var Z,it,at,wt,gt,yt=Object.keys(this.Sc).map(Number);for(yt.sort(lt),Z=yt.length-1;Z>=0;--Z){var It=yt[Z].toString();for(at=this.Sc[It],it=iv.length-1;it>=0;--it)if((wt=at[D=iv[it]])!==void 0&&(gt=wt.executeHitDetection(N,w,e,H,I)))return gt}},s.prototype.getClipCoords=function(i){var t=this.fc;if(!t)return null;var e=t[0],o=t[1],l=t[2],f=t[3],y=[e,o,e,f,l,f,l,o];return Sa(y,0,8,2,i,y),y},s.prototype.isEmpty=function(){return ge(this.Sc)},s.prototype.execute=function(i,t,e,o,l,f,y){var w=Object.keys(this.Sc).map(Number);w.sort(lt),this.fc&&(i.save(),this.clip(i,e));var b,I,N,D,j,H,Z=f||iv;for(y&&w.reverse(),b=0,I=w.length;b<I;++b){var it=w[b].toString();for(j=this.Sc[it],N=0,D=Z.length;N<D;++N)(H=j[Z[N]])!==void 0&&H.execute(i,t,e,o,l,y)}this.fc&&i.restore()},s}(),nv={};function Sx(s){if(nv[s]!==void 0)return nv[s];for(var i=2*s+1,t=s*s,e=new Array(t+1),o=0;o<=s;++o)for(var l=0;l<=s;++l){var f=o*o+l*l;if(f>t)break;var y=e[f];y||(y=[],e[f]=y),y.push(4*((s+o)*i+(s+l))+3),o>0&&y.push(4*((s-o)*i+(s+l))+3),l>0&&(y.push(4*((s+o)*i+(s-l))+3),o>0&&y.push(4*((s-o)*i+(s-l))+3))}for(var w=[],b=(o=0,e.length);o<b;++o)e[o]&&w.push.apply(w,e[o]);return nv[s]=w,w}var nd=YP,$s=.5;function ov(s,i,t,e,o,l,f){var y=Cn(s[0]*$s,s[1]*$s);y.imageSmoothingEnabled=!1;for(var w=y.canvas,b=new og(y,$s,o,null,f),I=t.length,N=Math.floor(16777215/I),D={},j=1;j<=I;++j){var H=t[j-1],Z=H.getStyleFunction()||e;if(e){var it=Z(H,l);if(it){Array.isArray(it)||(it=[it]);for(var at="#"+("000000"+(j*N).toString(16)).slice(-6),wt=0,gt=it.length;wt<gt;++wt){var yt=it[wt],It=yt.getGeometryFunction()(H);if(It&&on(o,It.getExtent())){var Rt=yt.clone(),kt=Rt.getFill();kt&&kt.setColor(at);var Dt=Rt.getStroke();Dt&&(Dt.setColor(at),Dt.setLineDash(null)),Rt.setText(void 0);var Xt=yt.getImage();if(Xt&&Xt.getOpacity()!==0){var ee=Xt.getImageSize();if(!ee)continue;var pe=Cn(ee[0],ee[1],void 0,{alpha:!1}),xe=pe.canvas;pe.fillStyle=at,pe.fillRect(0,0,xe.width,xe.height),Rt.setImage(new Hf({img:xe,imgSize:ee,anchor:Xt.getAnchor(),anchorXUnits:fu,anchorYUnits:fu,offset:Xt.getOrigin(),opacity:1,size:Xt.getSize(),scale:Xt.getScale(),rotation:Xt.getRotation(),rotateWithView:Xt.getRotateWithView()}))}var fe=Rt.getZIndex()||0;(Ge=D[fe])||(Ge={},D[fe]=Ge,Ge.Polygon=[],Ge.Circle=[],Ge.LineString=[],Ge.Point=[]),Ge[It.getType().replace("Multi","")].push(It,Rt)}}}}}for(var Re=Object.keys(D).map(Number).sort(lt),qe=(j=0,Re.length);j<qe;++j){var Ge=D[Re[j]];for(var Qe in Ge){var ir=Ge[Qe];for(wt=0,gt=ir.length;wt<gt;wt+=2){b.setStyle(ir[wt+1]);for(var de=0,Nr=i.length;de<Nr;++de)b.setTransform(i[de]),b.drawGeometry(ir[wt])}}}return y.getImageData(0,0,w.width,w.height)}function sv(s,i,t){var e=[];if(t){var o=Math.floor(Math.round(s[0])*$s),l=Math.floor(Math.round(s[1])*$s),f=4*(Y(o,0,t.width-1)+Y(l,0,t.height-1)*t.width),y=t.data[f],w=t.data[f+1],b=t.data[f+2]+256*(w+256*y),I=Math.floor(16777215/i.length);b&&b%I==0&&e.push(i[b/I-1])}return e}var ZP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),av=function(s){function i(t){var e=s.call(this,t)||this;return e.Tc=e.Ac.bind(e),e.Pc,e.Cc=null,e.kc=null,e._h=-1,e.Ic=NaN,e.zh=[1/0,1/0,-1/0,-1/0],e.Nc=[1/0,1/0,-1/0,-1/0],e.Lc,e.zc=null,e.Rc=null,e.Fc=null,e.Gc=null,e.replayGroupChanged=!0,e.declutterExecutorGroup=null,e.clipping=!0,e.Dc=null,e.ou=1,e}return ZP(i,s),i.prototype.renderWorlds=function(t,e,o){var l=e.extent,f=e.viewState,y=f.center,w=f.resolution,b=f.projection,I=f.rotation,N=b.getExtent(),D=this.getLayer().getSource(),j=e.pixelRatio,H=e.viewHints,Z=!(H[is]||H[Os]),it=this.Dc,at=Math.round(e.size[0]*j),wt=Math.round(e.size[1]*j),gt=D.getWrapX()&&b.canWrapX(),yt=gt?Gr(N):null,It=gt?Math.ceil((l[2]-N[2])/yt)+1:1,Rt=gt?Math.floor((l[0]-N[0])/yt):0;do{var kt=this.getRenderTransform(y,w,I,j,at,wt,Rt*yt);t.execute(it,1,kt,I,Z,void 0,o)}while(++Rt<It)},i.prototype.qc=function(){if(this.ou!==1){var t=Cn(this.context.canvas.width,this.context.canvas.height,Wy);this.Dc=t}else this.Dc=this.context},i.prototype.Uc=function(){if(this.ou!==1){var t=this.context.globalAlpha;this.context.globalAlpha=this.ou,this.context.drawImage(this.Dc.canvas,0,0),this.context.globalAlpha=t,ip(this.Dc),Wy.push(this.Dc.canvas),this.Dc=null}},i.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&(this.qc(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.Uc())},i.prototype.renderFrame=function(t,e){var o=t.pixelRatio,l=t.layerStatesArray[t.layerIndex];bt(this.pixelTransform,1/o,1/o),Qt(this.inversePixelTransform,this.pixelTransform);var f=re(this.pixelTransform);this.useContainer(e,f,this.getBackground(t));var y=this.context,w=y.canvas,b=this.Gc,I=this.declutterExecutorGroup;if((!b||b.isEmpty())&&(!I||I.isEmpty()))return null;var N=Math.round(t.size[0]*o),D=Math.round(t.size[1]*o);w.width!=N||w.height!=D?(w.width=N,w.height=D,w.style.transform!==f&&(w.style.transform=f)):this.containerReused||y.clearRect(0,0,N,D),this.preRender(y,t);var j=t.viewState,H=j.projection;this.ou=l.opacity,this.qc();var Z=!1,it=!0;if(l.extent&&this.clipping){var at=Mo(l.extent,H);(Z=(it=on(at,t.extent))&&!pn(at,t.extent))&&this.clipUnrotated(this.Dc,t,at)}return it&&this.renderWorlds(b,t),Z&&this.Dc.restore(),this.Uc(),this.postRender(y,t),this.Lc!==j.rotation&&(this.Lc=j.rotation,this.Cc=null),this.container},i.prototype.getFeatures=function(t){return new Promise(function(e){if(!this.Cc&&!this.Pc){var o=[this.context.canvas.width,this.context.canvas.height];Ei(this.pixelTransform,o);var l=this.zc,f=this.Ic,y=this.Lc,w=this.Rc,b=this.Nc,I=this.getLayer(),N=[],D=o[0]*$s,j=o[1]*$s;N.push(this.getRenderTransform(l,f,y,$s,D,j,0).slice());var H=I.getSource(),Z=w.getExtent();if(H.getWrapX()&&w.canWrapX()&&!pn(Z,b)){for(var it=b[0],at=Gr(Z),wt=0,gt=void 0;it<Z[0];)gt=at*--wt,N.push(this.getRenderTransform(l,f,y,$s,D,j,gt).slice()),it+=at;for(wt=0,it=b[2];it>Z[2];)gt=at*++wt,N.push(this.getRenderTransform(l,f,y,$s,D,j,gt).slice()),it-=at}this.Cc=ov(o,N,this.kc,I.getStyleFunction(),b,f,y)}e(sv(t,this.kc,this.Cc))}.bind(this))},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f){var y=this;if(this.Gc){var w,b=e.viewState.resolution,I=e.viewState.rotation,N=this.getLayer(),D={},j=function(Z,it,at){var wt=L(Z),gt=D[wt];if(gt){if(gt!==!0&&at<gt.distanceSq){if(at===0)return D[wt]=!0,f.splice(f.lastIndexOf(gt),1),l(Z,N,it);gt.geometry=it,gt.distanceSq=at}}else{if(at===0)return D[wt]=!0,l(Z,N,it);f.push(D[wt]={feature:Z,layer:N,geometry:it,distanceSq:at,callback:l})}},H=[this.Gc];return this.declutterExecutorGroup&&H.push(this.declutterExecutorGroup),H.some(function(Z){return w=Z.forEachFeatureAtCoordinate(t,b,I,o,j,Z===y.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(function(it){return it.value}):null)}),w}},i.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.Gc&&t.changed()},i.prototype.Ac=function(t){this.renderIfReadyAndVisible()},i.prototype.prepareFrame=function(t){var e=this.getLayer(),o=e.getSource();if(!o)return!1;var l=t.viewHints[is],f=t.viewHints[Os],y=e.getUpdateWhileAnimating(),w=e.getUpdateWhileInteracting();if(this.ready&&!y&&l||!w&&f)return this.Pc=!0,!0;this.Pc=!1;var b=t.extent,I=t.viewState,N=I.projection,D=I.resolution,j=t.pixelRatio,H=e.getRevision(),Z=e.getRenderBuffer(),it=e.getRenderOrder();it===void 0&&(it=A1);var at=I.center.slice(),wt=Fr(b,Z*D),gt=wt.slice(),yt=[wt.slice()],It=N.getExtent();if(o.getWrapX()&&N.canWrapX()&&!pn(It,t.extent)){var Rt=Gr(It),kt=Math.max(Gr(wt)/2,Rt);wt[0]=It[0]-kt,wt[2]=It[2]+kt,tt(at,N);var Dt=R(yt[0],N);Dt[0]<It[0]&&Dt[2]<It[2]?yt.push([Dt[0]+Rt,Dt[1],Dt[2]+Rt,Dt[3]]):Dt[0]>It[0]&&Dt[2]>It[2]&&yt.push([Dt[0]-Rt,Dt[1],Dt[2]-Rt,Dt[3]])}if(this.ready&&this.Ic==D&&this._h==H&&this.Fc==it&&pn(this.Nc,wt))return $(this.zh,gt)||(this.Cc=null,this.zh=gt),this.zc=at,this.replayGroupChanged=!1,!0;this.Gc=null;var Xt,ee=new id(ag(D,j),wt,D,j);this.getLayer().getDeclutter()&&(Xt=new id(ag(D,j),wt,D,j));var pe,xe=wo();if(xe){for(var fe=0,Re=yt.length;fe<Re;++fe){var qe=na(yt[fe],N);o.loadFeatures(qe,Yh(D,N),xe)}pe=ji(xe,N)}else for(fe=0,Re=yt.length;fe<Re;++fe)o.loadFeatures(yt[fe],D,N);var Ge=sg(D,j),Qe=!0,ir=function($e){var or,fi=$e.getStyleFunction()||e.getStyleFunction();if(fi&&(or=fi($e,D)),or){var ki=this.renderFeature($e,Ge,or,ee,pe,Xt);Qe=Qe&&!ki}}.bind(this),de=na(wt,N),Nr=o.getFeaturesInExtent(de);for(it&&Nr.sort(it),fe=0,Re=Nr.length;fe<Re;++fe)ir(Nr[fe]);this.kc=Nr,this.ready=Qe;var Pr=ee.finish(),he=new nd(wt,D,j,o.getOverlaps(),Pr,e.getRenderBuffer());return Xt&&(this.declutterExecutorGroup=new nd(wt,D,j,o.getOverlaps(),Xt.finish(),e.getRenderBuffer())),this.Ic=D,this._h=H,this.Fc=it,this.zh=gt,this.Nc=wt,this.zc=at,this.Rc=N,this.Gc=he,this.Cc=null,this.replayGroupChanged=!0,!0},i.prototype.renderFeature=function(t,e,o,l,f,y){if(!o)return!1;var w=!1;if(Array.isArray(o))for(var b=0,I=o.length;b<I;++b)w=Rf(l,t,o[b],e,this.Tc,f,y)||w;else w=Rf(l,t,o,e,this.Tc,f,y);return w},i}(Pg),$P=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ex=function(s){function i(t){var e=s.call(this,t)||this;return e.Bc=new av(t),e.Xc=t.getImageRatio(),e.Vc=[1,0,0,1,0,0],e.Wc=null,e}return $P(i,s),i.prototype.disposeInternal=function(){this.Bc.dispose(),s.prototype.disposeInternal.call(this)},i.prototype.getFeatures=function(t){if(!this.Bc)return new Promise(function(o){return o([])});var e=Ei(this.Vc,Ei(this.Wc,t.slice()));return this.Bc.getFeatures(e)},i.prototype.handleFontsChanged=function(){this.Bc.handleFontsChanged()},i.prototype.prepareFrame=function(t){var e=t.pixelRatio,o=t.viewState,l=o.resolution,f=t.viewHints,y=this.Bc,w=t.extent;this.Xc!==1&&v(w=w.slice(0),this.Xc);var b=Gr(w)/l,I=Ki(w)/l;if(!f[is]&&!f[Os]&&!ws(w)){y.useContainer(null,null);var N=y.context,D=t.layerStatesArray[t.layerIndex];N.globalAlpha=D.opacity;var j=Vt({},D,{opacity:1}),H=Vt({},t,{declutterTree:new Iy(9),extent:w,size:[b,I],viewState:Vt({},t.viewState,{rotation:0}),layerStatesArray:[j],layerIndex:0}),Z=!0,it=new $c(w,l,e,N.canvas,function(at){y.prepareFrame(H)&&y.replayGroupChanged&&(y.clipping=!1,y.renderFrame(H,null)&&(y.renderDeclutter(H),Z=!1),at())});it.addEventListener(ne,function(){if(it.getState()===Nn){this.Lt=Z?null:it;var at=it.getResolution(),wt=it.getPixelRatio(),gt=at*e/wt;this.renderedResolution=gt,this.Vc=At(this.Vc,b/2,I/2,1/gt,-1/gt,0,-o.center[0],-o.center[1])}}.bind(this)),it.load()}return this.Lt&&(this.Wc=t.pixelToCoordinateTransform.slice()),!!this.Lt},i.prototype.preRender=function(){},i.prototype.postRender=function(){},i.prototype.renderDeclutter=function(){},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f){return this.Bc?this.Bc.forEachFeatureAtCoordinate(t,e,o,l,f):s.prototype.forEachFeatureAtCoordinate.call(this,t,e,o,l,f)},i}(Zy),KP="image",Cx="hybrid",od="vector",JP=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),QP={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},t2={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},Tx=function(s){function i(t){var e=s.call(this,t)||this;return e.Tc=e.Ac.bind(e),e.Yc,e.Wc=null,e.Lc,e.Zc=[1,0,0,1,0,0],e}return JP(i,s),i.prototype.prepareTile=function(t,e,o){var l,f=t.getState();return f!==Oe&&f!==ur||(this.$c(t,e,o),this.Kc(t)&&(l=!0)),l},i.prototype.getTile=function(t,e,o,l){var f=l.pixelRatio,y=l.viewState,w=y.resolution,b=y.projection,I=this.getLayer(),N=I.getSource().getTile(t,e,o,f,b),D=l.viewHints,j=!(D[is]||D[Os]);return!j&&N.wantedResolution||(N.wantedResolution=w),this.prepareTile(N,f,b)&&(j||Date.now()-l.time<8)&&I.getRenderMode()!==od&&this.Hc(N,l),s.prototype.getTile.call(this,t,e,o,l)},i.prototype.isDrawableTile=function(t){var e=this.getLayer();return s.prototype.isDrawableTile.call(this,t)&&(e.getRenderMode()===od?L(e)in t.executorGroups:t.hasContext(e))},i.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},i.prototype.prepareFrame=function(t){var e=this.getLayer().getRevision();return this.Yc!==e&&(this.Yc=e,this.renderedTiles.length=0),s.prototype.prepareFrame.call(this,t)},i.prototype.$c=function(t,e,o){var l=this.getLayer(),f=l.getRevision(),y=l.getRenderOrder()||null,w=t.wantedResolution,b=t.getReplayState(l);if(b.dirty||b.renderedResolution!==w||b.renderedRevision!=f||b.renderedRenderOrder!=y){var I=l.getSource(),N=l.getDeclutter(),D=I.getTileGrid(),j=I.getTileGridForProjection(o).getTileCoordExtent(t.wrappedTileCoord),H=I.getSourceTiles(e,o,t),Z=L(l);delete t.hitDetectionImageData[Z],t.executorGroups[Z]=[],N&&(t.declutterExecutorGroups[Z]=[]),b.dirty=!1;for(var it=function(yt,It){var Rt=H[yt];if(Rt.getState()!=Oe)return"continue";var kt=Rt.tileCoord,Dt=D.getTileCoordExtent(kt),Xt=fn(j,Dt),ee=Fr(Xt,l.getRenderBuffer()*w,at.tmpExtent),pe=ko(Dt,Xt)?null:ee,xe=new id(0,ee,w,e),fe=N?new id(0,Xt,w,e):void 0,Re=sg(w,e),qe=function(or){var fi,ki=or.getStyleFunction()||l.getStyleFunction();if(ki&&(fi=ki(or,w)),fi){var Sn=this.renderFeature(or,Re,fi,xe,fe);b.dirty=b.dirty||Sn}},Ge=Rt.getFeatures();y&&y!==b.renderedRenderOrder&&Ge.sort(y);for(var Qe=0,ir=Ge.length;Qe<ir;++Qe){var de=Ge[Qe];pe&&!on(pe,de.getGeometry().getExtent())||qe.call(at,de)}var Nr=xe.finish(),Pr=l.getRenderMode()!==od&&N&&H.length===1?null:Xt,he=new nd(Pr,w,e,I.getOverlaps(),Nr,l.getRenderBuffer());if(t.executorGroups[Z].push(he),fe){var $e=new nd(null,w,e,I.getOverlaps(),fe.finish(),l.getRenderBuffer());t.declutterExecutorGroups[Z].push($e)}},at=this,wt=0,gt=H.length;wt<gt;++wt)it(wt);b.renderedRevision=f,b.renderedRenderOrder=y,b.renderedResolution=w}},i.prototype.forEachFeatureAtCoordinate=function(t,e,o,l,f){var y=e.viewState.resolution,w=e.viewState.rotation;o=o??0;var b=this.getLayer(),I=b.getSource().getTileGridForProjection(e.viewState.projection),N=mr([t]);Fr(N,y*o,N);for(var D,j={},H=function(gt,yt,It){var Rt=gt.getId();Rt===void 0&&(Rt=L(gt));var kt=j[Rt];if(kt){if(kt!==!0&&It<kt.distanceSq){if(It===0)return j[Rt]=!0,f.splice(f.lastIndexOf(kt),1),l(gt,b,yt);kt.geometry=yt,kt.distanceSq=It}}else{if(It===0)return j[Rt]=!0,l(gt,b,yt);f.push(j[Rt]={feature:gt,layer:b,geometry:yt,distanceSq:It,callback:l})}},Z=this.renderedTiles,it=function(gt,yt){var It=Z[gt];if(!on(I.getTileCoordExtent(It.wrappedTileCoord),N))return"continue";var Rt=L(b),kt=[It.executorGroups[Rt]],Dt=It.declutterExecutorGroups[Rt];Dt&&kt.push(Dt),kt.some(function(Xt){for(var ee=Xt===Dt?e.declutterTree.all().map(function(Re){return Re.value}):null,pe=0,xe=Xt.length;pe<xe;++pe){var fe=Xt[pe];if(D=fe.forEachFeatureAtCoordinate(t,y,w,o,H,ee))return!0}})},at=0,wt=Z.length;!D&&at<wt;++at)it(at);return D},i.prototype.getFeatures=function(t){return new Promise(function(e,o){for(var l,f=this.getLayer(),y=L(f),w=f.getSource(),b=this.renderedProjection,I=b.getExtent(),N=this.renderedResolution,D=w.getTileGridForProjection(b),j=Ei(this.Wc,t.slice()),H=D.getTileCoordForCoordAndResolution(j,N),Z=0,it=this.renderedTiles.length;Z<it;++Z)if(H.toString()===this.renderedTiles[Z].tileCoord.toString()){if((l=this.renderedTiles[Z]).getState()===Oe){var at=D.getTileCoordExtent(l.tileCoord);w.getWrapX()&&b.canWrapX()&&!pn(I,at)&&tt(j,b);break}l=void 0}if(!l||l.loadingSourceTiles>0)e([]);else{var wt=Zr(D.getTileCoordExtent(l.wrappedTileCoord)),gt=[(j[0]-wt[0])/N,(wt[1]-j[1])/N],yt=l.getSourceTiles().reduce(function(Dt,Xt){return Dt.concat(Xt.getFeatures())},[]),It=l.hitDetectionImageData[y];if(!It&&!this.Pc){var Rt=Pn(D.getTileSize(D.getZForResolution(N,w.zDirection))),kt=this.Lc;It=ov(Rt,[this.getRenderTransform(D.getTileCoordCenter(l.wrappedTileCoord),N,0,$s,Rt[0]*$s,Rt[1]*$s,0)],yt,f.getStyleFunction(),D.getTileCoordExtent(l.wrappedTileCoord),l.getReplayState(f).renderedResolution,kt),l.hitDetectionImageData[y]=It}e(sv(gt,yt,It))}}.bind(this))},i.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.Yc!==void 0&&t.changed()},i.prototype.Ac=function(t){this.renderIfReadyAndVisible()},i.prototype.renderDeclutter=function(t){var e=this.context,o=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();for(var l=t.viewHints,f=!(l[is]||l[Os]),y=this.renderedTiles,w=0,b=y.length;w<b;++w){var I=y[w],N=I.declutterExecutorGroups[L(this.getLayer())];if(N)for(var D=N.length-1;D>=0;--D)N[D].execute(this.context,1,this.getTileRenderTransform(I,t),t.viewState.rotation,f,void 0,t.declutterTree)}e.globalAlpha=o},i.prototype.getTileRenderTransform=function(t,e){var o=e.pixelRatio,l=e.viewState,f=l.center,y=l.resolution,w=l.rotation,b=e.size,I=Math.round(b[0]*o),N=Math.round(b[1]*o),D=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),j=t.tileCoord,H=D.getTileCoordExtent(t.wrappedTileCoord),Z=D.getTileCoordExtent(j,this.tmpExtent)[0]-H[0];return qi(Mn(this.inversePixelTransform.slice(),1/o,1/o),this.getRenderTransform(f,y,w,o,I,N,Z))},i.prototype.renderFrame=function(t,e){var o=t.viewHints,l=!(o[is]||o[Os]);s.prototype.renderFrame.call(this,t,e),this.Wc=t.pixelToCoordinateTransform.slice(),this.Lc=t.viewState.rotation;var f=this.getLayer(),y=f.getRenderMode(),w=this.context,b=w.globalAlpha;w.globalAlpha=f.getOpacity();for(var I=t2[y],N=t.viewState,D=N.rotation,j=f.getSource(),H=j.getTileGridForProjection(N.projection).getZForResolution(N.resolution,j.zDirection),Z=this.renderedTiles,it=[],at=[],wt=!0,gt=Z.length-1;gt>=0;--gt){var yt=Z[gt];wt=wt&&!yt.getReplayState(f).dirty;var It=yt.executorGroups[L(f)].filter(function(qe){return qe.hasExecutors(I)});if(It.length!==0){var Rt=this.getTileRenderTransform(yt,t),kt=yt.tileCoord[0],Dt=!1,Xt=It[0].getClipCoords(Rt);if(Xt){for(var ee=0,pe=it.length;ee<pe;++ee)if(H!==kt&&kt<at[ee]){var xe=it[ee];on([Xt[0],Xt[3],Xt[4],Xt[7]],[xe[0],xe[3],xe[4],xe[7]])&&(Dt||(w.save(),Dt=!0),w.beginPath(),w.moveTo(Xt[0],Xt[1]),w.lineTo(Xt[2],Xt[3]),w.lineTo(Xt[4],Xt[5]),w.lineTo(Xt[6],Xt[7]),w.moveTo(xe[6],xe[7]),w.lineTo(xe[4],xe[5]),w.lineTo(xe[2],xe[3]),w.lineTo(xe[0],xe[1]),w.clip())}it.push(Xt),at.push(kt)}for(var fe=0,Re=It.length;fe<Re;++fe)It[fe].execute(w,1,Rt,D,l,I);Dt&&w.restore()}}return w.globalAlpha=b,this.ready=wt,this.container},i.prototype.renderFeature=function(t,e,o,l,f){if(!o)return!1;var y=!1;if(Array.isArray(o))for(var w=0,b=o.length;w<b;++w)y=Rf(l,t,o[w],e,this.Tc,void 0,f)||y;else y=Rf(l,t,o,e,this.Tc,void 0,f);return y},i.prototype.Kc=function(t){var e=this.getLayer();if(e.getRenderMode()===od)return!1;var o=t.getReplayState(e),l=e.getRevision(),f=t.wantedResolution;return o.renderedTileResolution!==f||o.renderedTileRevision!==l},i.prototype.Hc=function(t,e){var o=this.getLayer(),l=t.getReplayState(o),f=o.getRevision(),y=t.executorGroups[L(o)];l.renderedTileRevision=f;var w=t.wrappedTileCoord,b=w[0],I=o.getSource(),N=e.pixelRatio,D=e.viewState.projection,j=I.getTileGridForProjection(D),H=j.getResolution(t.tileCoord[0]),Z=e.pixelRatio/t.wantedResolution*H,it=j.getResolution(b),at=t.getContext(o);N=Math.round(Math.max(N,Z/N));var wt=I.getTilePixelSize(b,N,D);at.canvas.width=wt[0],at.canvas.height=wt[1];var gt=N/Z;if(gt!==1){var yt=In(this.Zc);Mn(yt,gt,gt),at.setTransform.apply(at,yt)}var It=j.getTileCoordExtent(w,this.tmpExtent),Rt=Z/it,kt=In(this.Zc);Mn(kt,Rt,-Rt),Gt(kt,-It[0],-It[3]);for(var Dt=0,Xt=y.length;Dt<Xt;++Dt)y[Dt].execute(at,gt,kt,0,!0,QP[o.getRenderMode()]);l.renderedTileResolution=t.wantedResolution},i}(Ky),e2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Va=function(s){function i(t,e){var o=s.call(this)||this;return e&&!Array.isArray(t[0])?o.setFlatCoordinates(e,t):o.setCoordinates(t,e),o}return e2(i,s),i.prototype.appendPoint=function(t){this.flatCoordinates?ut(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){if(l<ui(this.getExtent(),t,e))return l;for(var f=this.flatCoordinates,y=this.stride,w=0,b=f.length;w<b;w+=y){var I=Tt(t,e,f[w],f[w+1]);if(I<l){l=I;for(var N=0;N<y;++N)o[N]=f[w+N];o.length=y}}return l},i.prototype.getCoordinates=function(){return cs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new rn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},i.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,o=this.stride,l=[],f=0,y=t.length;f<y;f+=o){var w=new rn(t.slice(f,f+o),e);l.push(w)}return l},i.prototype.getType=function(){return"MultiPoint"},i.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,o=this.stride,l=0,f=e.length;l<f;l+=o)if(Co(t,e[l],e[l+1]))return!0;return!1},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ca(this.flatCoordinates,0,t,this.stride),this.changed()},i}(Cs);function sd(s,i,t,e,o,l,f){var y,w,b=(t-i)/e;if(b===1)y=i;else if(b===2)y=i,w=o;else if(b!==0){for(var I=s[i],N=s[i+1],D=0,j=[0],H=i+e;H<t;H+=e){var Z=s[H],it=s[H+1];D+=Math.sqrt((Z-I)*(Z-I)+(it-N)*(it-N)),j.push(D),I=Z,N=it}var at=o*D,wt=et(j,at);wt<0?(w=(at-j[-wt-2])/(j[-wt-1]-j[-wt-2]),y=i+(-wt-2)*e):y=i+wt*e}var gt=f>1?f:2,yt=l||new Array(gt);for(H=0;H<gt;++H)yt[H]=y===void 0?NaN:w===void 0?s[y+H]:We(s[y+H],s[y+e+H],w);return yt}function Ag(s,i,t,e,o,l){if(t==i)return null;var f;if(o<s[i+e-1])return l?((f=s.slice(i,i+e))[e-1]=o,f):null;if(s[t-1]<o)return l?((f=s.slice(t-e,t))[e-1]=o,f):null;if(o==s[i+e-1])return s.slice(i,i+e);for(var y=i/e,w=t/e;y<w;){var b=y+w>>1;o<s[(b+1)*e-1]?w=b:y=b+1}var I=s[y*e-1];if(o==I)return s.slice((y-1)*e,(y-1)*e+e);var N=(o-I)/(s[(y+1)*e-1]-I);f=[];for(var D=0;D<e-1;++D)f.push(We(s[(y-1)*e+D],s[y*e+D],N));return f.push(o),f}function Px(s,i,t,e,o,l,f){if(f)return Ag(s,i,t[t.length-1],e,o,l);var y;if(o<s[e-1])return l?((y=s.slice(0,e))[e-1]=o,y):null;if(s[s.length-1]<o)return l?((y=s.slice(s.length-e))[e-1]=o,y):null;for(var w=0,b=t.length;w<b;++w){var I=t[w];if(i!=I){if(o<s[i+e-1])return null;if(o<=s[I-1])return Ag(s,i,I,e,o,!1);i=I}}return null}var r2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),uo=function(s){function i(t,e){var o=s.call(this)||this;return o.Jc=null,o.Qc=-1,o.wt=-1,o.gt=-1,e===void 0||Array.isArray(t[0])?o.setCoordinates(t,e):o.setFlatCoordinates(e,t),o}return r2(i,s),i.prototype.appendCoordinate=function(t){this.flatCoordinates?ut(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){return l<ui(this.getExtent(),t,e)?l:(this.gt!=this.getRevision()&&(this.wt=Math.sqrt(Uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.gt=this.getRevision()),Ir(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.wt,!1,t,e,o,l))},i.prototype.forEachSegment=function(t){return Wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},i.prototype.getCoordinateAtM=function(t,e){if(this.layout!=yi&&this.layout!=Qr)return null;var o=e!==void 0&&e;return Ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,o)},i.prototype.getCoordinates=function(){return cs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getCoordinateAt=function(t,e){return sd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)},i.prototype.getLength=function(){return Lg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},i.prototype.getFlatMidpoint=function(){return this.Qc!=this.getRevision()&&(this.Jc=this.getCoordinateAt(.5,this.Jc),this.Qc=this.getRevision()),this.Jc},i.prototype.getSimplifiedGeometryInternal=function(t){var e=[];return e.length=Pa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,hr)},i.prototype.getType=function(){return"LineString"},i.prototype.intersectsExtent=function(t){return Cl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ca(this.flatCoordinates,0,t,this.stride),this.changed()},i}(Cs),i2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ks=function(s){function i(t,e,o){var l=s.call(this)||this;if(l.bt=[],l.wt=-1,l.gt=-1,Array.isArray(t[0]))l.setCoordinates(t,e);else if(e!==void 0&&o)l.setFlatCoordinates(e,t),l.bt=o;else{for(var f=l.getLayout(),y=t,w=[],b=[],I=0,N=y.length;I<N;++I){var D=y[I];I===0&&(f=D.getLayout()),ut(w,D.getFlatCoordinates()),b.push(w.length)}l.setFlatCoordinates(f,w),l.bt=b}return l}return i2(i,s),i.prototype.appendLineString=function(t){this.flatCoordinates?ut(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.bt.push(this.flatCoordinates.length),this.changed()},i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),this.layout,this.bt.slice());return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){return l<ui(this.getExtent(),t,e)?l:(this.gt!=this.getRevision()&&(this.wt=Math.sqrt(Go(this.flatCoordinates,0,this.bt,this.stride,0)),this.gt=this.getRevision()),sa(this.flatCoordinates,0,this.bt,this.stride,this.wt,!1,t,e,o,l))},i.prototype.getCoordinateAtM=function(t,e,o){if(this.layout!=yi&&this.layout!=Qr||this.flatCoordinates.length===0)return null;var l=e!==void 0&&e,f=o!==void 0&&o;return Px(this.flatCoordinates,0,this.bt,this.stride,t,l,f)},i.prototype.getCoordinates=function(){return Ma(this.flatCoordinates,0,this.bt,this.stride)},i.prototype.getEnds=function(){return this.bt},i.prototype.getLineString=function(t){return t<0||this.bt.length<=t?null:new uo(this.flatCoordinates.slice(t===0?0:this.bt[t-1],this.bt[t]),this.layout)},i.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.bt,o=this.layout,l=[],f=0,y=0,w=e.length;y<w;++y){var b=e[y],I=new uo(t.slice(f,b),o);l.push(I),f=b}return l},i.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,o=0,l=this.bt,f=this.stride,y=0,w=l.length;y<w;++y){var b=l[y];ut(t,sd(e,o,b,f,.5)),o=b}return t},i.prototype.getSimplifiedGeometryInternal=function(t){var e=[],o=[];return e.length=aa(this.flatCoordinates,0,this.bt,this.stride,t,e,0,o),new i(e,hr,o)},i.prototype.getType=function(){return"MultiLineString"},i.prototype.intersectsExtent=function(t){return Tl(this.flatCoordinates,0,this.bt,this.stride,t)},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var o=$h(this.flatCoordinates,0,t,this.stride,this.bt);this.flatCoordinates.length=o.length===0?0:o[o.length-1],this.changed()},i}(Cs);function lv(s,i,t,e){for(var o=[],l=[1/0,1/0,-1/0,-1/0],f=0,y=t.length;f<y;++f){var w=t[f];l=vs(s,i,w[0],e),o.push((l[0]+l[2])/2,(l[1]+l[3])/2),i=w[w.length-1]}return o}var n2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ua=function(s){function i(t,e,o){var l=s.call(this)||this;if(l.tl=[],l.nl=-1,l.il=null,l.wt=-1,l.gt=-1,l._t=-1,l.St=null,!o&&!Array.isArray(t[0])){for(var f=l.getLayout(),y=t,w=[],b=[],I=0,N=y.length;I<N;++I){var D=y[I];I===0&&(f=D.getLayout());for(var j=w.length,H=D.getEnds(),Z=0,it=H.length;Z<it;++Z)H[Z]+=j;ut(w,D.getFlatCoordinates()),b.push(H)}e=f,t=w,o=b}return e!==void 0&&o?(l.setFlatCoordinates(e,t),l.tl=o):l.setCoordinates(t,e),l}return n2(i,s),i.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var o=this.flatCoordinates.length;ut(this.flatCoordinates,t.getFlatCoordinates());for(var l=0,f=(e=t.getEnds().slice()).length;l<f;++l)e[l]+=o}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.tl.push();this.tl.push(e),this.changed()},i.prototype.clone=function(){for(var t=this.tl.length,e=new Array(t),o=0;o<t;++o)e[o]=this.tl[o].slice();var l=new i(this.flatCoordinates.slice(),this.layout,e);return l.applyProperties(this),l},i.prototype.closestPointXY=function(t,e,o,l){return l<ui(this.getExtent(),t,e)?l:(this.gt!=this.getRevision()&&(this.wt=Math.sqrt(rl(this.flatCoordinates,0,this.tl,this.stride,0)),this.gt=this.getRevision()),ls(this.getOrientedFlatCoordinates(),0,this.tl,this.stride,this.wt,!0,t,e,o,l))},i.prototype.containsXY=function(t,e){return Xu(this.getOrientedFlatCoordinates(),0,this.tl,this.stride,t,e)},i.prototype.getArea=function(){return lc(this.getOrientedFlatCoordinates(),0,this.tl,this.stride)},i.prototype.getCoordinates=function(t){var e;return t!==void 0?Ml(e=this.getOrientedFlatCoordinates().slice(),0,this.tl,this.stride,t):e=this.flatCoordinates,La(e,0,this.tl,this.stride)},i.prototype.getEndss=function(){return this.tl},i.prototype.getFlatInteriorPoints=function(){if(this.nl!=this.getRevision()){var t=lv(this.flatCoordinates,0,this.tl,this.stride);this.il=pf(this.getOrientedFlatCoordinates(),0,this.tl,this.stride,t),this.nl=this.getRevision()}return this.il},i.prototype.getInteriorPoints=function(){return new Va(this.getFlatInteriorPoints().slice(),yi)},i.prototype.getOrientedFlatCoordinates=function(){if(this._t!=this.getRevision()){var t=this.flatCoordinates;Zc(t,0,this.tl,this.stride)?this.St=t:(this.St=t.slice(),this.St.length=Ml(this.St,0,this.tl,this.stride)),this._t=this.getRevision()}return this.St},i.prototype.getSimplifiedGeometryInternal=function(t){var e=[],o=[];return e.length=Hc(this.flatCoordinates,0,this.tl,this.stride,Math.sqrt(t),e,0,o),new i(e,hr,o)},i.prototype.getPolygon=function(t){if(t<0||this.tl.length<=t)return null;var e;if(t===0)e=0;else{var o=this.tl[t-1];e=o[o.length-1]}var l=this.tl[t].slice(),f=l[l.length-1];if(e!==0)for(var y=0,w=l.length;y<w;++y)l[y]-=e;return new Lo(this.flatCoordinates.slice(e,f),this.layout,l)},i.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,o=this.tl,l=[],f=0,y=0,w=o.length;y<w;++y){var b=o[y].slice(),I=b[b.length-1];if(f!==0)for(var N=0,D=b.length;N<D;++N)b[N]-=f;var j=new Lo(e.slice(f,I),t,b);l.push(j),f=I}return l},i.prototype.getType=function(){return"MultiPolygon"},i.prototype.intersectsExtent=function(t){return il(this.getOrientedFlatCoordinates(),0,this.tl,this.stride,t)},i.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var o=Ta(this.flatCoordinates,0,t,this.stride,this.tl);if(o.length===0)this.flatCoordinates.length=0;else{var l=o[o.length-1];this.flatCoordinates.length=l.length===0?0:l[l.length-1]}this.changed()},i}(Cs),Ix=[1,0,0,1,0,0],ad=function(){function s(i,t,e,o,l){this.styleFunction,this.st,this.$=l,this.rl=i,this.el=t,this.il=null,this.sl=null,this.bt=e,this.ul=o}return s.prototype.get=function(i){return this.ul[i]},s.prototype.getExtent=function(){return this.st||(this.st=this.rl==="Point"?as(this.el):vs(this.el,0,this.el.length,2)),this.st},s.prototype.getFlatInteriorPoint=function(){if(!this.il){var i=Gi(this.getExtent());this.il=tp(this.el,0,this.bt,2,i,0)}return this.il},s.prototype.getFlatInteriorPoints=function(){if(!this.il){var i=lv(this.el,0,this.bt,2);this.il=pf(this.el,0,this.bt,2,i)}return this.il},s.prototype.getFlatMidpoint=function(){return this.sl||(this.sl=sd(this.el,0,this.el.length,2,.5)),this.sl},s.prototype.getFlatMidpoints=function(){if(!this.sl){this.sl=[];for(var i=this.el,t=0,e=this.bt,o=0,l=e.length;o<l;++o){var f=e[o],y=sd(i,t,f,2,.5);ut(this.sl,y),t=f}}return this.sl},s.prototype.getId=function(){return this.$},s.prototype.getOrientedFlatCoordinates=function(){return this.el},s.prototype.getGeometry=function(){return this},s.prototype.getSimplifiedGeometry=function(i){return this},s.prototype.simplifyTransformed=function(i,t){return this},s.prototype.getProperties=function(){return this.ul},s.prototype.getStride=function(){return 2},s.prototype.getStyleFunction=function(){return this.styleFunction},s.prototype.getType=function(){return this.rl},s.prototype.transform=function(i){var t=(i=ie(i)).getExtent(),e=i.getWorldExtent();if(t&&e){var o=Ki(e)/Ki(t);At(Ix,e[0],e[3],o,-o,0,0,0),Sa(this.el,0,this.el.length,2,Ix,this.el)}},s.prototype.getEnds=function(){return this.bt},s}();function Mx(s){var i=s.getType();switch(i){case"Point":return new rn(s.getFlatCoordinates());case"MultiPoint":return new Va(s.getFlatCoordinates(),hr);case"LineString":return new uo(s.getFlatCoordinates(),hr);case"MultiLineString":return new Ks(s.getFlatCoordinates(),hr,s.getEnds());case"Polygon":var t=s.getFlatCoordinates(),e=s.getEnds(),o=gf(t,e);return o.length>1?new Ua(t,hr,o):new Lo(t,hr,e);default:throw new Error("Invalid geometry type:"+i)}}ad.prototype.getEndss=ad.prototype.getEnds,ad.prototype.getFlatCoordinates=ad.prototype.getOrientedFlatCoordinates;var Og=ad,o2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),wu=function(s){function i(t){return s.call(this,t)||this}return o2(i,s),i.prototype.createRenderer=function(){return new av(this)},i}(kp);function cv(s,i,t){for(var e,o,l,f,y,w,b=[],I=s(0),N=s(1),D=i(I),j=i(N),H=[N,I],Z=[j,D],it=[1,0],at={},wt=1e5;--wt>0&&it.length>0;)l=it.pop(),I=H.pop(),D=Z.pop(),(w=l.toString())in at||(b.push(D[0],D[1]),at[w]=!0),f=it.pop(),N=H.pop(),j=Z.pop(),xt((o=i(e=s(y=(l+f)/2)))[0],o[1],D[0],D[1],j[0],j[1])<t?(b.push(j[0],j[1]),at[w=f.toString()]=!0):(it.push(f,y,y,l),Z.push(j,o,o,D),H.push(N,e,e,I));return b}function Lx(s,i,t,e,o){return cv(function(l){return[s,i+(t-i)*l]},zn(ie("EPSG:4326"),e),o)}function Ax(s,i,t,e,o){return cv(function(l){return[i+(t-i)*l,s]},zn(ie("EPSG:4326"),e),o)}var s2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),a2=new Fs({color:"rgba(0,0,0,0.2)"}),l2=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],c2=function(s){function i(t){var e=this,o=t||{},l=Vt({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},o);return delete l.maxLines,delete l.strokeStyle,delete l.targetSize,delete l.showLabels,delete l.lonLabelFormatter,delete l.latLabelFormatter,delete l.lonLabelPosition,delete l.latLabelPosition,delete l.lonLabelStyle,delete l.latLabelStyle,delete l.intervals,(e=s.call(this,l)||this).di=null,e.al=1/0,e.hl=1/0,e.fl=-1/0,e.cl=-1/0,e.ll=1/0,e.vl=1/0,e.dl=-1/0,e.pl=-1/0,e.yl=o.targetSize!==void 0?o.targetSize:100,e.ml=o.maxLines!==void 0?o.maxLines:100,e.wl=[],e.gl=[],e.bl=o.strokeStyle!==void 0?o.strokeStyle:a2,e.xl=void 0,e.Ml=void 0,e._l=null,e.Sl=null,e.Ol=null,e.jl=null,e.El=null,e.Tl=null,e.Al=null,o.showLabels&&(e.Pl=o.lonLabelFormatter==null?en.bind(e,"EW"):o.lonLabelFormatter,e.Cl=o.latLabelFormatter==null?en.bind(e,"NS"):o.latLabelFormatter,e.kl=o.lonLabelPosition==null?0:o.lonLabelPosition,e.Il=o.latLabelPosition==null?1:o.latLabelPosition,e.Nl=new ds({text:o.lonLabelStyle!==void 0?o.lonLabelStyle.clone():new Ip({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new Zs({color:"rgba(0,0,0,1)"}),stroke:new Fs({color:"rgba(255,255,255,1)",width:3})})}),e.Ll=function(f){var y=f.get("graticule_label");return this.Nl.getText().setText(y),this.Nl}.bind(e),e.zl=new ds({text:o.latLabelStyle!==void 0?o.latLabelStyle.clone():new Ip({font:"12px Calibri,sans-serif",textAlign:"right",fill:new Zs({color:"rgba(0,0,0,1)"}),stroke:new Fs({color:"rgba(255,255,255,1)",width:3})})}),e.Rl=function(f){var y=f.get("graticule_label");return this.zl.getText().setText(y),this.zl}.bind(e),e.Tl=[],e.Al=[],e.addEventListener(bf,e.Fl.bind(e))),e.Gl=o.intervals!==void 0?o.intervals:l2,e.setSource(new du({loader:e.loaderFunction.bind(e),strategy:e.strategyFunction.bind(e),features:new Be,overlaps:!1,useSpatialIndex:!1,wrapX:o.wrapX})),e.Dl=[],e.ql=new ds({stroke:e.bl}),e.Ul=null,e.zh=null,e.Ic=null,e.setRenderOrder(null),e}return s2(i,s),i.prototype.strategyFunction=function(t,e){var o=t.slice();return this.di&&this.getSource().getWrapX()&&R(o,this.di),this.Ul&&(ba(this.Ul,o,e)?o=this.Ul.slice():this.getSource().removeLoadedExtent(this.Ul)),[o]},i.prototype.loaderFunction=function(t,e,o){this.Ul=t;var l=this.getSource(),f=fn(this.getExtent()||[-1/0,-1/0,1/0,1/0],t);if(!(this.zh&&ko(this.zh,f)&&this.Ic===e||(this.zh=f,this.Ic=e,ws(f)))){var y=Gi(f),w=e*e/4;(!this.di||!an(this.di,o))&&this.Bl(o),this.Xl(f,y,e,w);var b,I=this.wl.length+this.gl.length;for(this.Tl&&(I+=this.wl.length),this.Al&&(I+=this.gl.length);I>this.Dl.length;)b=new Mr,this.Dl.push(b);var N=l.getFeaturesCollection();N.clear();var D,j,H=0;for(D=0,j=this.wl.length;D<j;++D)(b=this.Dl[H++]).setGeometry(this.wl[D]),b.setStyle(this.ql),N.push(b);for(D=0,j=this.gl.length;D<j;++D)(b=this.Dl[H++]).setGeometry(this.gl[D]),b.setStyle(this.ql),N.push(b)}},i.prototype.Vl=function(t,e,o,l,f,y){var w=this.Wl(t,e,o,l,y);if(on(w.getExtent(),f)){if(this.Tl){var b=this.Pl(t);y in this.Tl?this.Tl[y].text=b:this.Tl[y]={geom:new rn([]),text:b}}this.wl[y++]=w}return y},i.prototype.Yl=function(t,e,o,l,f,y){var w=this.Zl(t,e,o,l,y);if(on(w.getExtent(),f)){if(this.Al){var b=this.Cl(t);y in this.Al?this.Al[y].text=b:this.Al[y]={geom:new rn([]),text:b}}this.gl[y++]=w}return y},i.prototype.Fl=function(t){var e=t.frameState.viewState.rotation,o=t.frameState.viewState.resolution,l=t.frameState.size,f=t.frameState.extent,y=Gi(f),w=f;if(e){var b=l[0]*o,I=l[1]*o;w=[y[0]-b/2,y[1]-I/2,y[0]+b/2,y[1]+I/2]}var N=0,D=0,j=this.Il<.5,H=this.di.getExtent(),Z=Gr(H);this.getSource().getWrapX()&&this.di.canWrapX()&&!pn(H,f)&&(N=Math.floor((f[0]-H[0])/Z),D=Math.ceil((f[2]-H[2])/Z),j=j!==Math.abs(e)>Math.PI/2);for(var it=N1(t),at=N;at<=D;++at){var wt=this.wl.length+this.gl.length,gt=void 0,yt=void 0,It=void 0,Rt=void 0;if(this.Tl)for(yt=0,It=this.Tl.length;yt<It;++yt){var kt=this.wl[yt];e||at!==0?((Dt=kt.clone()).translate(at*Z,0),Dt.rotate(-e,y),(Rt=this.$l(Dt,w,yt)).rotate(e,y)):Rt=this.$l(kt,f,yt),(gt=this.Dl[wt++]).setGeometry(Rt),gt.set("graticule_label",this.Tl[yt].text),it.drawFeature(gt,this.Ll(gt))}if(this.Al&&(at===N&&j||at===D&&!j))for(yt=0,It=this.gl.length;yt<It;++yt){var Dt;kt=this.gl[yt],e||at!==0?((Dt=kt.clone()).translate(at*Z,0),Dt.rotate(-e,y),(Rt=this.Kl(Dt,w,yt)).rotate(e,y)):Rt=this.Kl(kt,f,yt),(gt=this.Dl[wt++]).setGeometry(Rt),gt.set("graticule_label",this.Al[yt].text),it.drawFeature(gt,this.Rl(gt))}}},i.prototype.Xl=function(t,e,o,l){var f=this.Hl(o);if(f==-1)return this.wl.length=0,this.gl.length=0,this.Tl&&(this.Tl.length=0),void(this.Al&&(this.Al.length=0));var y=!1,w=this.di.getExtent(),b=Gr(w);this.getSource().getWrapX()&&this.di.canWrapX()&&!pn(w,t)&&(Gr(t)>=b?(t[0]=w[0],t[2]=w[2]):y=!0);var I=[Y(e[0],this.dl,this.ll),Y(e[1],this.pl,this.vl)],N=this.Ml(I);isNaN(N[1])&&(N[1]=Math.abs(this.al)>=Math.abs(this.fl)?this.al:this.fl);var D,j,H,Z,it=Y(N[0],this.cl,this.hl),at=Y(N[1],this.fl,this.al),wt=this.ml,gt=t;y||(gt=[Y(t[0],this.dl,this.ll),Y(t[1],this.pl,this.vl),Y(t[2],this.dl,this.ll),Y(t[3],this.pl,this.vl)]);var yt=M(gt,this.Ml,void 0,8),It=yt[3],Rt=yt[2],kt=yt[1],Dt=yt[0];if(y||(nn(gt,this.Sl)&&(Dt=this.cl,kt=this.fl),nn(gt,this.Ol)&&(Rt=this.hl,kt=this.fl),nn(gt,this.jl)&&(Dt=this.cl,It=this.al),nn(gt,this.El)&&(Rt=this.hl,It=this.al),It=Y(It,at,this.al),Rt=Y(Rt,it,this.hl),kt=Y(kt,this.fl,at),Dt=Y(Dt,this.cl,it)),Z=Y(it=Math.floor(it/f)*f,this.cl,this.hl),j=this.Vl(Z,kt,It,l,t,0),D=0,y)for(;(Z-=f)>=Dt&&D++<wt;)j=this.Vl(Z,kt,It,l,t,j);else for(;Z!=this.cl&&D++<wt;)Z=Math.max(Z-f,this.cl),j=this.Vl(Z,kt,It,l,t,j);if(Z=Y(it,this.cl,this.hl),D=0,y)for(;(Z+=f)<=Rt&&D++<wt;)j=this.Vl(Z,kt,It,l,t,j);else for(;Z!=this.hl&&D++<wt;)Z=Math.min(Z+f,this.hl),j=this.Vl(Z,kt,It,l,t,j);for(this.wl.length=j,this.Tl&&(this.Tl.length=j),H=Y(at=Math.floor(at/f)*f,this.fl,this.al),j=this.Yl(H,Dt,Rt,l,t,0),D=0;H!=this.fl&&D++<wt;)H=Math.max(H-f,this.fl),j=this.Yl(H,Dt,Rt,l,t,j);for(H=Y(at,this.fl,this.al),D=0;H!=this.al&&D++<wt;)H=Math.min(H+f,this.al),j=this.Yl(H,Dt,Rt,l,t,j);this.gl.length=j,this.Al&&(this.Al.length=j)},i.prototype.Hl=function(t){for(var e=this._l[0],o=this._l[1],l=-1,f=Math.pow(this.yl*t,2),y=[],w=[],b=0,I=this.Gl.length;b<I;++b){var N=Y(this.Gl[b]/2,0,90),D=Y(o,-90+N,90-N);if(y[0]=e-N,y[1]=D-N,w[0]=e+N,w[1]=D+N,this.xl(y,y),this.xl(w,w),Math.pow(w[0]-y[0],2)+Math.pow(w[1]-y[1],2)<=f)break;l=this.Gl[b]}return l},i.prototype.Wl=function(t,e,o,l,f){var y=Lx(t,e,o,this.di,l),w=this.wl[f];return w?(w.setFlatCoordinates(hr,y),w.changed()):(w=new uo(y,hr),this.wl[f]=w),w},i.prototype.$l=function(t,e,o){var l=t.getFlatCoordinates(),f=1,y=l.length-1;l[f]>l[y]&&(f=y,y=1);var w=Math.max(e[1],l[f]),b=Math.min(e[3],l[y]),I=Y(e[1]+Math.abs(e[1]-e[3])*this.kl,w,b),N=[l[f-1]+(l[y-1]-l[f-1])*(I-l[f])/(l[y]-l[f]),I],D=this.Tl[o].geom;return D.setCoordinates(N),D},i.prototype.getMeridians=function(){return this.wl},i.prototype.Zl=function(t,e,o,l,f){var y=Ax(t,e,o,this.di,l),w=this.gl[f];return w?(w.setFlatCoordinates(hr,y),w.changed()):w=new uo(y,hr),w},i.prototype.Kl=function(t,e,o){var l=t.getFlatCoordinates(),f=0,y=l.length-2;l[f]>l[y]&&(f=y,y=0);var w=Math.max(e[0],l[f]),b=Math.min(e[2],l[y]),I=Y(e[0]+Math.abs(e[0]-e[2])*this.Il,w,b),N=[I,l[f+1]+(l[y+1]-l[f+1])*(I-l[f])/(l[y]-l[f])],D=this.Al[o].geom;return D.setCoordinates(N),D},i.prototype.getParallels=function(){return this.gl},i.prototype.Bl=function(t){var e=ie("EPSG:4326"),o=t.getWorldExtent();this.al=o[3],this.hl=o[2],this.fl=o[1],this.cl=o[0];var l=zn(t,e);if(this.cl<this.hl)this.Ml=l;else{var f=this.cl+this.hl/2;this.hl+=360,this.Ml=function(w,b,I){for(var N=I||2,D=l(w,b,N),j=0,H=D.length;j<H;j+=N)D[j]<f&&(D[j]+=360);return D}}this.xl=zn(e,t);var y=M([this.cl,this.fl,this.hl,this.al],this.xl,void 0,8);this.dl=y[0],this.ll=y[2],this.pl=y[1],this.vl=y[3],this.Sl=this.xl([this.cl,this.fl]),this.Ol=this.xl([this.hl,this.fl]),this.jl=this.xl([this.cl,this.al]),this.El=this.xl([this.hl,this.al]),this._l=this.Ml(Gi(t.getExtent())),isNaN(this._l[1])&&(this._l[1]=Math.abs(this.al)>=Math.abs(this.fl)?this.al:this.fl),this.di=t},i}(wu),u2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ng="blur",uv="gradient",Rg="radius",h2=["#00f","#0ff","#0f0","#ff0","#f00"],p2=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);delete l.gradient,delete l.radius,delete l.blur,delete l.weight,(e=s.call(this,l)||this).Jl=null,e.addChangeListener(uv,e.Ql),e.setGradient(o.gradient?o.gradient:h2),e.setBlur(o.blur!==void 0?o.blur:15),e.setRadius(o.radius!==void 0?o.radius:8);var f=o.weight?o.weight:"weight";return e.tv=typeof f=="string"?function(y){return y.get(f)}:f,e.setRenderOrder(null),e}return u2(i,s),i.prototype.getBlur=function(){return this.get(Ng)},i.prototype.getGradient=function(){return this.get(uv)},i.prototype.getRadius=function(){return this.get(Rg)},i.prototype.Ql=function(){this.Jl=function(t){for(var e=1,o=256,l=Cn(e,o),f=l.createLinearGradient(0,0,e,o),y=1/(t.length-1),w=0,b=t.length;w<b;++w)f.addColorStop(w*y,t[w]);return l.fillStyle=f,l.fillRect(0,0,e,o),l.canvas}(this.getGradient())},i.prototype.setBlur=function(t){this.set(Ng,t)},i.prototype.setGradient=function(t){this.set(uv,t)},i.prototype.setRadius=function(t){this.set(Rg,t)},i.prototype.createRenderer=function(){return new tv(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(t){var e=this.tv(t);return e!==void 0?Y(e,0,1):1}.bind(this)}],vertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_weight = a_weight;
        }`,fragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          gl_FragColor = vec4(alpha, alpha, alpha, alpha);
        }`,hitVertexShader:`
        precision mediump float;
        uniform mat4 u_projectionMatrix;
        uniform mat4 u_offsetScaleMatrix;
        uniform float u_size;
        attribute vec2 a_position;
        attribute float a_index;
        attribute float a_weight;
        attribute vec4 a_hitColor;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          mat4 offsetMatrix = u_offsetScaleMatrix;
          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;
          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;
          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);
          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;
          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;
          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;
          v_texCoord = vec2(u, v);
          v_hitColor = a_hitColor;
          v_weight = a_weight;
        }`,hitFragmentShader:`
        precision mediump float;
        uniform float u_blurSlope;

        varying vec2 v_texCoord;
        varying float v_weight;
        varying vec4 v_hitColor;

        void main(void) {
          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);
          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;
          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;
          float alpha = smoothstep(0.0, 1.0, value) * v_weight;
          if (alpha < 0.05) {
            discard;
          }

          gl_FragColor = v_hitColor;
        }`,uniforms:{u_size:function(){return 2*(this.get(Rg)+this.get(Ng))}.bind(this),u_blurSlope:function(){return this.get(Rg)/Math.max(1,this.get(Ng))}.bind(this)},postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:function(){return this.Jl}.bind(this),u_opacity:function(){return this.getOpacity()}.bind(this)}}]})},i.prototype.renderDeclutter=function(){},i}(kp),Gp=function(){function s(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return s.prototype.getReadOptions=function(i,t){var e;if(t){var o=t.dataProjection?ie(t.dataProjection):this.readProjection(i);t.extent&&o&&o.getUnits()===Mi.TILE_PIXELS&&(o=ie(o)).setWorldExtent(t.extent),e={dataProjection:o,featureProjection:t.featureProjection}}return this.adaptOptions(e)},s.prototype.adaptOptions=function(i){return Vt({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},i)},s.prototype.getType=function(){return E()},s.prototype.readFeature=function(i,t){return E()},s.prototype.readFeatures=function(i,t){return E()},s.prototype.readGeometry=function(i,t){return E()},s.prototype.readProjection=function(i){return E()},s.prototype.writeFeature=function(i,t){return E()},s.prototype.writeFeatures=function(i,t){return E()},s.prototype.writeGeometry=function(i,t){return E()},s}();function qn(s,i,t){var e,o=t?ie(t.featureProjection):null,l=t?ie(t.dataProjection):null;if(e=o&&l&&!an(o,l)?(i?s.clone():s).transform(i?o:l,i?l:o):s,i&&t&&t.decimals!==void 0){var f=Math.pow(10,t.decimals);e===s&&(e=s.clone()),e.applyTransform(function(y){for(var w=0,b=y.length;w<b;++w)y[w]=Math.round(y[w]*f)/f;return y})}return e}function kg(s,i){var t=i?ie(i.featureProjection):null,e=i?ie(i.dataProjection):null;return t&&e&&!an(t,e)?Vi(s,e,t):s}var f2=x(98),d2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function g2(s,i,t){if(s===3){var e={keys:[],values:[],features:[]},o=t.readVarint()+t.pos;t.readFields(m2,e,o),e.length=e.features.length,e.length&&(i[e.name]=e)}}function m2(s,i,t){if(s===15)i.version=t.readVarint();else if(s===1)i.name=t.readString();else if(s===5)i.extent=t.readVarint();else if(s===2)i.features.push(t.pos);else if(s===3)i.keys.push(t.readString());else if(s===4){for(var e=null,o=t.readVarint()+t.pos;t.pos<o;)e=(s=t.readVarint()>>3)===1?t.readString():s===2?t.readFloat():s===3?t.readDouble():s===4?t.readVarint64():s===5?t.readVarint():s===6?t.readSVarint():s===7?t.readBoolean():null;i.values.push(e)}}function y2(s,i,t){if(s==1)i.id=t.readVarint();else if(s==2)for(var e=t.readVarint()+t.pos;t.pos<e;){var o=i.layer.keys[t.readVarint()],l=i.layer.values[t.readVarint()];i.properties[o]=l}else s==3?i.type=t.readVarint():s==4&&(i.geometry=t.pos)}function v2(s,i,t){s.pos=i.features[t];var e=s.readVarint()+s.pos,o={layer:i,type:0,properties:{}};return s.readFields(y2,o,e),o}var hv=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.dataProjection=new q({code:"",units:Mi.TILE_PIXELS}),e.nv=o.featureClass?o.featureClass:Og,e.K=o.geometryName,e.iv=o.layerName?o.layerName:"layer",e.Uh=o.layers?o.layers:null,e.rv=o.idProperty,e.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],e}return d2(i,s),i.prototype.ev=function(t,e,o,l){t.pos=e.geometry;for(var f=t.readVarint()+t.pos,y=1,w=0,b=0,I=0,N=0,D=0;t.pos<f;){if(!w){var j=t.readVarint();y=7&j,w=j>>3}w--,y===1||y===2?(b+=t.readSVarint(),I+=t.readSVarint(),y===1&&N>D&&(l.push(N),D=N),o.push(b,I),N+=2):y===7?N>D&&(o.push(o[D],o[D+1]),N+=2):Me(!1,59)}N>D&&(l.push(N),D=N)},i.prototype.ov=function(t,e,o){var l,f=e.type;if(f===0)return null;var y,w=e.properties;this.rv?(y=w[this.rv],delete w[this.rv]):y=e.id,w[this.iv]=e.layer.name;var b=[],I=[];this.ev(t,e,b,I);var N=function(Z,it){var at;return Z===1?at=it===1?"Point":"MultiPoint":Z===2?at=it===1?"LineString":"MultiLineString":Z===3&&(at="Polygon"),at}(f,I.length);if(this.nv===Og)(l=new this.nv(N,b,I,w,y)).transform(o.dataProjection);else{var D=void 0;if(N=="Polygon"){var j=gf(b,I);D=j.length>1?new Ua(b,hr,j):new Lo(b,hr,I)}else D=N==="Point"?new rn(b,hr):N==="LineString"?new uo(b,hr):N==="MultiPoint"?new Va(b,hr):N==="MultiLineString"?new Ks(b,hr,I):null;l=new this.nv,this.K&&l.setGeometryName(this.K);var H=qn(D,!1,o);l.setGeometry(H),y!==void 0&&l.setId(y),l.setProperties(w,!0)}return l},i.prototype.getType=function(){return"arraybuffer"},i.prototype.readFeatures=function(t,e){var o=this.Uh,l=this.adaptOptions(e),f=ie(l.dataProjection);f.setWorldExtent(l.extent),l.dataProjection=f;var y=new f2(t),w=y.readFields(g2,{}),b=[];for(var I in w)if(!o||o.indexOf(I)!=-1){var N=w[I],D=N?[0,0,N.extent,N.extent]:null;f.setExtent(D);for(var j=0,H=N.length;j<H;++j){var Z=v2(y,N,j),it=this.ov(y,Z,l);it!==null&&b.push(it)}}return b},i.prototype.readProjection=function(t){return this.dataProjection},i.prototype.setLayers=function(t){this.Uh=t},i}(Gp),_2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ld=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);delete l.preload,delete l.useInterimTilesOnError,(e=s.call(this,l)||this).on,e.once,e.un,o.renderMode===KP&&(console.warn('renderMode: "image" is deprecated. Option ignored.'),o.renderMode=void 0);var f=o.renderMode||Cx;return Me(f==Cx||f==od,28),e.sv=f,e.setPreload(o.preload?o.preload:0),e.setUseInterimTilesOnError(o.useInterimTilesOnError===void 0||o.useInterimTilesOnError),e.getBackground,e.setBackground,e}return _2(i,s),i.prototype.createRenderer=function(){return new Tx(this)},i.prototype.getFeatures=function(t){return s.prototype.getFeatures.call(this,t)},i.prototype.getRenderMode=function(){return this.sv},i.prototype.getPreload=function(){return this.get(Ig)},i.prototype.getUseInterimTilesOnError=function(){return this.get(Mg)},i.prototype.setPreload=function(t){this.set(Ig,t)},i.prototype.setUseInterimTilesOnError=function(t){this.set(Mg,t)},i}(kp),x2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Ox(s){for(var i=[],t=0,e=s.length;t<e;++t)i.push(s[t].clone());return i}var ns=function(s){function i(t){var e=s.call(this)||this;return e.uv=t||null,e.av=[],e.hv(),e}return x2(i,s),i.prototype.fv=function(){this.av.forEach(Or),this.av.length=0},i.prototype.hv=function(){if(this.uv)for(var t=0,e=this.uv.length;t<e;++t)this.av.push(Ee(this.uv[t],ne,this.changed,this))},i.prototype.clone=function(){var t=new i(null);return t.setGeometries(this.uv),t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){if(l<ui(this.getExtent(),t,e))return l;for(var f=this.uv,y=0,w=f.length;y<w;++y)l=f[y].closestPointXY(t,e,o,l);return l},i.prototype.containsXY=function(t,e){for(var o=this.uv,l=0,f=o.length;l<f;++l)if(o[l].containsXY(t,e))return!0;return!1},i.prototype.computeExtent=function(t){ao(t);for(var e=this.uv,o=0,l=e.length;o<l;++o)_s(t,e[o].getExtent());return t},i.prototype.getGeometries=function(){return Ox(this.uv)},i.prototype.getGeometriesArray=function(){return this.uv},i.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.uv,o=0,l=e.length;o<l;++o)e[o].getType()===this.getType()?t=t.concat(e[o].getGeometriesArrayRecursive()):t.push(e[o]);return t},i.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],o=this.uv,l=!1,f=0,y=o.length;f<y;++f){var w=o[f],b=w.getSimplifiedGeometry(t);e.push(b),b!==w&&(l=!0)}if(l){var I=new i(null);return I.setGeometriesArray(e),I}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},i.prototype.getType=function(){return"GeometryCollection"},i.prototype.intersectsExtent=function(t){for(var e=this.uv,o=0,l=e.length;o<l;++o)if(e[o].intersectsExtent(t))return!0;return!1},i.prototype.isEmpty=function(){return this.uv.length===0},i.prototype.rotate=function(t,e){for(var o=this.uv,l=0,f=o.length;l<f;++l)o[l].rotate(t,e);this.changed()},i.prototype.scale=function(t,e,o){var l=o;l||(l=Gi(this.getExtent()));for(var f=this.uv,y=0,w=f.length;y<w;++y)f[y].scale(t,e,l);this.changed()},i.prototype.setGeometries=function(t){this.setGeometriesArray(Ox(t))},i.prototype.setGeometriesArray=function(t){this.fv(),this.uv=t,this.hv(),this.changed()},i.prototype.applyTransform=function(t){for(var e=this.uv,o=0,l=e.length;o<l;++o)e[o].applyTransform(t);this.changed()},i.prototype.translate=function(t,e){for(var o=this.uv,l=0,f=o.length;l<f;++l)o[l].translate(t,e);this.changed()},i.prototype.disposeInternal=function(){this.fv(),s.prototype.disposeInternal.call(this)},i}(zc),w2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Fg(s){if(typeof s=="string"){var i=JSON.parse(s);return i||null}return s!==null?s:null}var Dg=function(s){function i(){return s.call(this)||this}return w2(i,s),i.prototype.getType=function(){return"json"},i.prototype.readFeature=function(t,e){return this.readFeatureFromObject(Fg(t),this.getReadOptions(t,e))},i.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(Fg(t),this.getReadOptions(t,e))},i.prototype.readFeatureFromObject=function(t,e){return E()},i.prototype.readFeaturesFromObject=function(t,e){return E()},i.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(Fg(t),this.getReadOptions(t,e))},i.prototype.readGeometryFromObject=function(t,e){return E()},i.prototype.readProjection=function(t){return this.readProjectionFromObject(Fg(t))},i.prototype.readProjectionFromObject=function(t){return E()},i.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},i.prototype.writeFeatureObject=function(t,e){return E()},i.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},i.prototype.writeFeaturesObject=function(t,e){return E()},i.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},i.prototype.writeGeometryObject=function(t,e){return E()},i}(Gp),b2=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function pv(s,i){if(!s)return null;var t;switch(s.type){case"Point":t=function(e){return new rn(e.coordinates)}(s);break;case"LineString":t=function(e){return new uo(e.coordinates)}(s);break;case"Polygon":t=function(e){return new Lo(e.coordinates)}(s);break;case"MultiPoint":t=function(e){return new Va(e.coordinates)}(s);break;case"MultiLineString":t=function(e){return new Ks(e.coordinates)}(s);break;case"MultiPolygon":t=function(e){return new Ua(e.coordinates)}(s);break;case"GeometryCollection":t=function(e,o){var l=e.geometries.map(function(f){return pv(f,o)});return new ns(l)}(s);break;default:throw new Error("Unsupported GeoJSON type: "+s.type)}return qn(t,!1,i)}function fv(s,i){var t,e=(s=qn(s,!0,i)).getType();switch(e){case"Point":t=function(o,l){return{type:"Point",coordinates:o.getCoordinates()}}(s);break;case"LineString":t=function(o,l){return{type:"LineString",coordinates:o.getCoordinates()}}(s);break;case"Polygon":t=function(o,l){var f;return l&&(f=l.rightHanded),{type:"Polygon",coordinates:o.getCoordinates(f)}}(s,i);break;case"MultiPoint":t=function(o,l){return{type:"MultiPoint",coordinates:o.getCoordinates()}}(s);break;case"MultiLineString":t=function(o,l){return{type:"MultiLineString",coordinates:o.getCoordinates()}}(s);break;case"MultiPolygon":t=function(o,l){var f;return l&&(f=l.rightHanded),{type:"MultiPolygon",coordinates:o.getCoordinates(f)}}(s,i);break;case"GeometryCollection":t=function(o,l){return{type:"GeometryCollection",geometries:o.getGeometriesArray().map(function(f){var y=Vt({},l);return delete y.featureProjection,fv(f,y)})}}(s,i);break;case"Circle":t={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e)}return t}var Nx,Rx=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this)||this).dataProjection=ie(o.dataProjection?o.dataProjection:"EPSG:4326"),o.featureProjection&&(e.defaultFeatureProjection=ie(o.featureProjection)),e.K=o.geometryName,e.cv=o.extractGeometryName,e.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],e}return b2(i,s),i.prototype.readFeatureFromObject=function(t,e){var o=null,l=pv((o=t.type==="Feature"?t:{type:"Feature",geometry:t,properties:null}).geometry,e),f=new Mr;return this.K?f.setGeometryName(this.K):this.cv&&"geometry_name"in o!==void 0&&f.setGeometryName(o.geometry_name),f.setGeometry(l),"id"in o&&f.setId(o.id),o.properties&&f.setProperties(o.properties,!0),f},i.prototype.readFeaturesFromObject=function(t,e){var o=null;if(t.type==="FeatureCollection"){o=[];for(var l=t.features,f=0,y=l.length;f<y;++f)o.push(this.readFeatureFromObject(l[f],e))}else o=[this.readFeatureFromObject(t,e)];return o},i.prototype.readGeometryFromObject=function(t,e){return pv(t,e)},i.prototype.readProjectionFromObject=function(t){var e,o=t.crs;return o?o.type=="name"?e=ie(o.properties.name):o.type==="EPSG"?e=ie("EPSG:"+o.properties.code):Me(!1,36):e=this.dataProjection,e},i.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var o={type:"Feature",geometry:null,properties:null},l=t.getId();if(l!==void 0&&(o.id=l),!t.hasProperties())return o;var f=t.getProperties(),y=t.getGeometry();return y&&(o.geometry=fv(y,e),delete f[t.getGeometryName()]),ge(f)||(o.properties=f),o},i.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var o=[],l=0,f=t.length;l<f;++l)o.push(this.writeFeatureObject(t[l],e));return{type:"FeatureCollection",features:o}},i.prototype.writeGeometryObject=function(t,e){return fv(t,this.adaptOptions(e))},i}(Dg),kx={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function cd(s){return(s=Math.round(s))<0?0:s>255?255:s}function Fx(s){return s<0?0:s>1?1:s}function dv(s){return s[s.length-1]==="%"?cd(parseFloat(s)/100*255):cd(parseInt(s))}function Gg(s){return s[s.length-1]==="%"?Fx(parseFloat(s)/100):Fx(parseFloat(s))}function gv(s,i,t){return t<0?t+=1:t>1&&(t-=1),6*t<1?s+(i-s)*t*6:2*t<1?i:3*t<2?s+(i-s)*(.6666666666666666-t)*6:s}try{Nx={}.parseCSSColor=function(s){var i,t=s.replace(/ /g,"").toLowerCase();if(t in kx)return kx[t].slice();if(t[0]==="#")return t.length===4?(i=parseInt(t.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:t.length===7&&(i=parseInt(t.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var e=t.indexOf("("),o=t.indexOf(")");if(e!==-1&&o+1===t.length){var l=t.substr(0,e),f=t.substr(e+1,o-(e+1)).split(","),y=1;switch(l){case"rgba":if(f.length!==4)return null;y=Gg(f.pop());case"rgb":return f.length!==3?null:[dv(f[0]),dv(f[1]),dv(f[2]),y];case"hsla":if(f.length!==4)return null;y=Gg(f.pop());case"hsl":if(f.length!==3)return null;var w=(parseFloat(f[0])%360+360)%360/360,b=Gg(f[1]),I=Gg(f[2]),N=I<=.5?I*(b+1):I+b-I*b,D=2*I-N;return[cd(255*gv(D,N,w+.3333333333333333)),cd(255*gv(D,N,w)),cd(255*gv(D,N,w-.3333333333333333)),y];default:return null}}return null}}catch{}var kn=function(s,i,t,e){e===void 0&&(e=1),this.r=s,this.g=i,this.b=t,this.a=e};function ud(s){return typeof s=="object"?["literal",s]:s}function S2(s,i){var t=s.stops;if(!t)return function(f,y){var w=["get",f.property];if(f.default===void 0)return y.type==="string"?["string",w]:w;if(y.type==="enum")return["match",w,Object.keys(y.values),w,f.default];var b=[y.type==="color"?"to-color":y.type,w,ud(f.default)];return y.type==="array"&&b.splice(1,0,y.value,y.length||null),b}(s,i);var e=t&&typeof t[0][0]=="object",o=e||s.property!==void 0,l=e||!o;return t=t.map(function(f){return!o&&i.tokens&&typeof f[1]=="string"?[f[0],E2(f[1])]:[f[0],ud(f[1])]}),e?function(f,y,w){for(var b={},I={},N=[],D=0;D<w.length;D++){var j=w[D],H=j[0].zoom;b[H]===void 0&&(b[H]={zoom:H,type:f.type,property:f.property,default:f.default},I[H]=[],N.push(H)),I[H].push([j[0].value,j[1]])}if(_v({},y)==="exponential"){for(var Z=[mv(f),["linear"],["zoom"]],it=0,at=N;it<at.length;it+=1){var wt=at[it];jp(Z,wt,yv(b[wt],y,I[wt]),!1)}return Z}for(var gt=["step",["zoom"]],yt=0,It=N;yt<It.length;yt+=1){var Rt=It[yt];jp(gt,Rt,yv(b[Rt],y,I[Rt]),!0)}return vv(gt),gt}(s,i,t):l?function(f,y,w,b){b===void 0&&(b=["zoom"]);var I,N=_v(f,y),D=!1;if(N==="interval")I=["step",b],D=!0;else{if(N!=="exponential")throw new Error('Unknown zoom function type "'+N+'"');var j=f.base!==void 0?f.base:1;I=[mv(f),j===1?["linear"]:["exponential",j],b]}for(var H=0,Z=w;H<Z.length;H+=1){var it=Z[H];jp(I,it[0],it[1],D)}return vv(I),I}(s,i,t):yv(s,i,t)}function mv(s){switch(s.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function Dx(s,i){var t,e,o=ud((t=s.default,e=i.default,t!==void 0?t:e!==void 0?e:void 0));return o===void 0&&i.type==="resolvedImage"?"":o}function yv(s,i,t){var e=_v(s,i),o=["get",s.property];if(e==="categorical"&&typeof t[0][0]=="boolean"){for(var l=["case"],f=0,y=t;f<y.length;f+=1){var w=y[f];l.push(["==",o,w[0]],w[1])}return l.push(Dx(s,i)),l}if(e==="categorical"){for(var b=["match",o],I=0,N=t;I<N.length;I+=1){var D=N[I];jp(b,D[0],D[1],!1)}return b.push(Dx(s,i)),b}if(e==="interval"){for(var j=["step",["number",o]],H=0,Z=t;H<Z.length;H+=1){var it=Z[H];jp(j,it[0],it[1],!0)}return vv(j),s.default===void 0?j:["case",["==",["typeof",o],"number"],j,ud(s.default)]}if(e==="exponential"){for(var at=s.base!==void 0?s.base:1,wt=[mv(s),at===1?["linear"]:["exponential",at],["number",o]],gt=0,yt=t;gt<yt.length;gt+=1){var It=yt[gt];jp(wt,It[0],It[1],!1)}return s.default===void 0?wt:["case",["==",["typeof",o],"number"],wt,ud(s.default)]}throw new Error("Unknown property function type "+e)}function vv(s){s[0]==="step"&&s.length===3&&(s.push(0),s.push(s[3]))}function jp(s,i,t,e){s.length>3&&i===s[s.length-2]||(e&&s.length===2||s.push(i),s.push(t))}function _v(s,i){return s.type?s.type:i.expression.interpolated?"exponential":"interval"}function E2(s){for(var i=["concat"],t=/{([^{}]+)}/g,e=0,o=t.exec(s);o!==null;o=t.exec(s)){var l=s.slice(e,t.lastIndex-o[0].length);e=t.lastIndex,l.length>0&&i.push(l),i.push(["get",o[1]])}if(i.length===1)return s;if(e<s.length)i.push(s.slice(e));else if(i.length===2)return["to-string",i[1]];return i}kn.parse=function(s){if(s){if(s instanceof kn)return s;if(typeof s=="string"){var i=Nx(s);if(i)return new kn(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3])}}},kn.prototype.toString=function(){var s=this.toArray(),i=s[0],t=s[1],e=s[2],o=s[3];return"rgba("+Math.round(i)+","+Math.round(t)+","+Math.round(e)+","+o+")"},kn.prototype.toArray=function(){var s=this,i=s.r,t=s.g,e=s.b,o=s.a;return o===0?[0,0,0,0]:[255*i/o,255*t/o,255*e/o,o]},kn.black=new kn(0,0,0,1),kn.white=new kn(1,1,1,1),kn.transparent=new kn(0,0,0,0),kn.red=new kn(1,0,0,1),kn.blue=new kn(0,0,1,1);var Kl=function(s){function i(t,e){s.call(this,e),this.message=e,this.key=t}return s&&(i.__proto__=s),i.prototype=Object.create(s&&s.prototype),i.prototype.constructor=i,i}(Error),hd=function(s,i){i===void 0&&(i=[]),this.parent=s,this.bindings={};for(var t=0,e=i;t<e.length;t+=1){var o=e[t],l=o[0],f=o[1];this.bindings[l]=f}};hd.prototype.concat=function(s){return new hd(this,s)},hd.prototype.get=function(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(s+" not found in scope.")},hd.prototype.has=function(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)};var jg={kind:"null"},cr={kind:"number"},Ui={kind:"string"},Ai={kind:"boolean"},Pc={kind:"color"},Bp={kind:"object"},Oi={kind:"value"},Bg={kind:"collator"},zg={kind:"formatted"},pd={kind:"resolvedImage"};function qa(s,i){return{kind:"array",itemType:s,N:i}}function so(s){if(s.kind==="array"){var i=so(s.itemType);return typeof s.N=="number"?"array<"+i+", "+s.N+">":s.itemType.kind==="value"?"array":"array<"+i+">"}return s.kind}var C2=[jg,cr,Ui,Ai,Pc,zg,Bp,qa(Oi),pd];function fd(s,i){if(i.kind==="error")return null;if(s.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!fd(s.itemType,i.itemType))&&(typeof s.N!="number"||s.N===i.N))return null}else{if(s.kind===i.kind)return null;if(s.kind==="value"){for(var t=0,e=C2;t<e.length;t+=1)if(!fd(e[t],i))return null}}return"Expected "+so(s)+" but found "+so(i)+" instead."}function xv(s,i){return i.some(function(t){return t.kind===s.kind})}function dd(s,i){return i.some(function(t){return t==="null"?s===null:t==="array"?Array.isArray(s):t==="object"?s&&!Array.isArray(s)&&typeof s=="object":t===typeof s})}var gd=function(s,i,t){this.sensitivity=s?i?"variant":"case":i?"accent":"base",this.locale=t,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};gd.prototype.compare=function(s,i){return this.collator.compare(s,i)},gd.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var wv=function(s,i,t,e,o){this.text=s.normalize?s.normalize():s,this.image=i,this.scale=t,this.fontStack=e,this.textColor=o},Js=function(s){this.sections=s};Js.fromString=function(s){return new Js([new wv(s,null,null,null,null)])},Js.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(s){return s.text.length!==0||s.image&&s.image.name.length!==0})},Js.factory=function(s){return s instanceof Js?s:Js.fromString(s)},Js.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(s){return s.text}).join("")},Js.prototype.serialize=function(){for(var s=["format"],i=0,t=this.sections;i<t.length;i+=1){var e=t[i];if(e.image)s.push(["image",e.image.name]);else{s.push(e.text);var o={};e.fontStack&&(o["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(o["font-scale"]=e.scale),e.textColor&&(o["text-color"]=["rgba"].concat(e.textColor.toArray())),s.push(o)}}return s};var Jl=function(s){this.name=s.name,this.available=s.available};function Gx(s,i,t,e){return typeof s=="number"&&s>=0&&s<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255?e===void 0||typeof e=="number"&&e>=0&&e<=1?null:"Invalid rgba value ["+[s,i,t,e].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof e=="number"?[s,i,t,e]:[s,i,t]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Vg(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof kn||s instanceof gd||s instanceof Js||s instanceof Jl)return!0;if(Array.isArray(s)){for(var i=0,t=s;i<t.length;i+=1)if(!Vg(t[i]))return!1;return!0}if(typeof s=="object"){for(var e in s)if(!Vg(s[e]))return!1;return!0}return!1}function zo(s){if(s===null)return jg;if(typeof s=="string")return Ui;if(typeof s=="boolean")return Ai;if(typeof s=="number")return cr;if(s instanceof kn)return Pc;if(s instanceof gd)return Bg;if(s instanceof Js)return zg;if(s instanceof Jl)return pd;if(Array.isArray(s)){for(var i,t=s.length,e=0,o=s;e<o.length;e+=1){var l=zo(o[e]);if(i){if(i===l)continue;i=Oi;break}i=l}return qa(i||Oi,t)}return Bp}function md(s){var i=typeof s;return s===null?"":i==="string"||i==="number"||i==="boolean"?String(s):s instanceof kn||s instanceof Js||s instanceof Jl?s.toString():JSON.stringify(s)}Jl.prototype.toString=function(){return this.name},Jl.fromString=function(s){return s?new Jl({name:s,available:!1}):null},Jl.prototype.serialize=function(){return["image",this.name]};var Ql=function(s,i){this.type=s,this.value=i};Ql.parse=function(s,i){if(s.length!==2)return i.error("'literal' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(!Vg(s[1]))return i.error("invalid value");var t=s[1],e=zo(t),o=i.expectedType;return e.kind!=="array"||e.N!==0||!o||o.kind!=="array"||typeof o.N=="number"&&o.N!==0||(e=o),new Ql(e,t)},Ql.prototype.evaluate=function(){return this.value},Ql.prototype.eachChild=function(){},Ql.prototype.outputDefined=function(){return!0},Ql.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof kn?["rgba"].concat(this.value.toArray()):this.value instanceof Js?this.value.serialize():this.value};var Jo=function(s){this.name="ExpressionEvaluationError",this.message=s};Jo.prototype.toJSON=function(){return this.message};var bv={string:Ui,number:cr,boolean:Ai,object:Bp},Ds=function(s,i){this.type=s,this.args=i};Ds.parse=function(s,i){if(s.length<2)return i.error("Expected at least one argument.");var t,e=1,o=s[0];if(o==="array"){var l,f;if(s.length>2){var y=s[1];if(typeof y!="string"||!(y in bv)||y==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);l=bv[y],e++}else l=Oi;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return i.error('The length argument to "array" must be a positive integer literal',2);f=s[2],e++}t=qa(l,f)}else t=bv[o];for(var w=[];e<s.length;e++){var b=i.parse(s[e],e,Oi);if(!b)return null;w.push(b)}return new Ds(t,w)},Ds.prototype.evaluate=function(s){for(var i=0;i<this.args.length;i++){var t=this.args[i].evaluate(s);if(!fd(this.type,zo(t)))return t;if(i===this.args.length-1)throw new Jo("Expected value to be of type "+so(this.type)+", but found "+so(zo(t))+" instead.")}return null},Ds.prototype.eachChild=function(s){this.args.forEach(s)},Ds.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},Ds.prototype.serialize=function(){var s=this.type,i=[s.kind];if(s.kind==="array"){var t=s.itemType;if(t.kind==="string"||t.kind==="number"||t.kind==="boolean"){i.push(t.kind);var e=s.N;(typeof e=="number"||this.args.length>1)&&i.push(e)}}return i.concat(this.args.map(function(o){return o.serialize()}))};var bu=function(s){this.type=zg,this.sections=s};bu.parse=function(s,i){if(s.length<2)return i.error("Expected at least one argument.");var t=s[1];if(!Array.isArray(t)&&typeof t=="object")return i.error("First argument must be an image or text section.");for(var e=[],o=!1,l=1;l<=s.length-1;++l){var f=s[l];if(o&&typeof f=="object"&&!Array.isArray(f)){o=!1;var y=null;if(f["font-scale"]&&!(y=i.parse(f["font-scale"],1,cr)))return null;var w=null;if(f["text-font"]&&!(w=i.parse(f["text-font"],1,qa(Ui))))return null;var b=null;if(f["text-color"]&&!(b=i.parse(f["text-color"],1,Pc)))return null;var I=e[e.length-1];I.scale=y,I.font=w,I.textColor=b}else{var N=i.parse(s[l],1,Oi);if(!N)return null;var D=N.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,e.push({content:N,scale:null,font:null,textColor:null})}}return new bu(e)},bu.prototype.evaluate=function(s){return new Js(this.sections.map(function(i){var t=i.content.evaluate(s);return zo(t)===pd?new wv("",t,null,null,null):new wv(md(t),null,i.scale?i.scale.evaluate(s):null,i.font?i.font.evaluate(s).join(","):null,i.textColor?i.textColor.evaluate(s):null)}))},bu.prototype.eachChild=function(s){for(var i=0,t=this.sections;i<t.length;i+=1){var e=t[i];s(e.content),e.scale&&s(e.scale),e.font&&s(e.font),e.textColor&&s(e.textColor)}},bu.prototype.outputDefined=function(){return!1},bu.prototype.serialize=function(){for(var s=["format"],i=0,t=this.sections;i<t.length;i+=1){var e=t[i];s.push(e.content.serialize());var o={};e.scale&&(o["font-scale"]=e.scale.serialize()),e.font&&(o["text-font"]=e.font.serialize()),e.textColor&&(o["text-color"]=e.textColor.serialize()),s.push(o)}return s};var Su=function(s){this.type=pd,this.input=s};Su.parse=function(s,i){if(s.length!==2)return i.error("Expected two arguments.");var t=i.parse(s[1],1,Ui);return t?new Su(t):i.error("No image name provided.")},Su.prototype.evaluate=function(s){var i=this.input.evaluate(s),t=Jl.fromString(i);return t&&s.availableImages&&(t.available=s.availableImages.indexOf(i)>-1),t},Su.prototype.eachChild=function(s){s(this.input)},Su.prototype.outputDefined=function(){return!1},Su.prototype.serialize=function(){return["image",this.input.serialize()]};var T2={"to-boolean":Ai,"to-color":Pc,"to-number":cr,"to-string":Ui},Ha=function(s,i){this.type=s,this.args=i};Ha.parse=function(s,i){if(s.length<2)return i.error("Expected at least one argument.");var t=s[0];if((t==="to-boolean"||t==="to-string")&&s.length!==2)return i.error("Expected one argument.");for(var e=T2[t],o=[],l=1;l<s.length;l++){var f=i.parse(s[l],l,Oi);if(!f)return null;o.push(f)}return new Ha(e,o)},Ha.prototype.evaluate=function(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){for(var i,t,e=0,o=this.args;e<o.length;e+=1){if(t=null,(i=o[e].evaluate(s))instanceof kn)return i;if(typeof i=="string"){var l=s.parseColor(i);if(l)return l}else if(Array.isArray(i)&&!(t=i.length<3||i.length>4?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":Gx(i[0],i[1],i[2],i[3])))return new kn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Jo(t||"Could not parse color from value '"+(typeof i=="string"?i:String(JSON.stringify(i)))+"'")}if(this.type.kind==="number"){for(var f=null,y=0,w=this.args;y<w.length;y+=1){if((f=w[y].evaluate(s))===null)return 0;var b=Number(f);if(!isNaN(b))return b}throw new Jo("Could not convert "+JSON.stringify(f)+" to number.")}return this.type.kind==="formatted"?Js.fromString(md(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?Jl.fromString(md(this.args[0].evaluate(s))):md(this.args[0].evaluate(s))},Ha.prototype.eachChild=function(s){this.args.forEach(s)},Ha.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},Ha.prototype.serialize=function(){if(this.type.kind==="formatted")return new bu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Su(this.args[0]).serialize();var s=["to-"+this.type.kind];return this.eachChild(function(i){s.push(i.serialize())}),s};var P2=["Unknown","Point","LineString","Polygon"],Ic=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};Ic.prototype.id=function(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null},Ic.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?P2[this.feature.type]:this.feature.type:null},Ic.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ic.prototype.canonicalID=function(){return this.canonical},Ic.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ic.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var s=this.featureDistanceData.center,i=this.featureDistanceData.scale,t=this.featureTileCoord,e=t.x,o=t.y,l=e*i-s[0],f=o*i-s[1];return this.featureDistanceData.bearing[0]*l+this.featureDistanceData.bearing[1]*f}return 0},Ic.prototype.parseColor=function(s){var i=this._parseColorCache[s];return i||(i=this._parseColorCache[s]=kn.parse(s)),i};var ms=function(s,i,t,e){this.name=s,this.type=i,this._evaluate=t,this.args=e};ms.prototype.evaluate=function(s){return this._evaluate(s,this.args)},ms.prototype.eachChild=function(s){this.args.forEach(s)},ms.prototype.outputDefined=function(){return!1},ms.prototype.serialize=function(){return[this.name].concat(this.args.map(function(s){return s.serialize()}))},ms.parse=function(s,i){var t,e=s[0],o=ms.definitions[e];if(!o)return i.error('Unknown expression "'+e+'". If you wanted a literal array, use ["literal", [...]].',0);for(var l=Array.isArray(o)?o[0]:o.type,f=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,y=f.filter(function(pe){var xe=pe[0];return!Array.isArray(xe)||xe.length===s.length-1}),w=null,b=0,I=y;b<I.length;b+=1){var N=I[b],D=N[0],j=N[1];w=new Pu(i.registry,i.path,null,i.scope);for(var H=[],Z=!1,it=1;it<s.length;it++){var at=s[it],wt=Array.isArray(D)?D[it-1]:D.type,gt=w.parse(at,1+H.length,wt);if(!gt){Z=!0;break}H.push(gt)}if(!Z)if(Array.isArray(D)&&D.length!==H.length)w.error("Expected "+D.length+" arguments, but found "+H.length+" instead.");else{for(var yt=0;yt<H.length;yt++){var It=Array.isArray(D)?D[yt]:D.type,Rt=H[yt];w.concat(yt+1).checkSubtype(It,Rt.type)}if(w.errors.length===0)return new ms(e,l,j,H)}}if(y.length===1)(t=i.errors).push.apply(t,w.errors);else{for(var kt=(y.length?y:f).map(function(pe){var xe,fe=pe[0];return xe=fe,Array.isArray(xe)?"("+xe.map(so).join(", ")+")":"("+so(xe.type)+"...)"}).join(" | "),Dt=[],Xt=1;Xt<s.length;Xt++){var ee=i.parse(s[Xt],1+Dt.length);if(!ee)return null;Dt.push(so(ee.type))}i.error("Expected arguments of type "+kt+", but found ("+Dt.join(", ")+") instead.")}return null},ms.register=function(s,i){for(var t in ms.definitions=i,i)s[t]=ms};var Eu=function(s,i,t){this.type=Bg,this.locale=t,this.caseSensitive=s,this.diacriticSensitive=i};Eu.parse=function(s,i){if(s.length!==2)return i.error("Expected one argument.");var t=s[1];if(typeof t!="object"||Array.isArray(t))return i.error("Collator options argument must be an object.");var e=i.parse(t["case-sensitive"]!==void 0&&t["case-sensitive"],1,Ai);if(!e)return null;var o=i.parse(t["diacritic-sensitive"]!==void 0&&t["diacritic-sensitive"],1,Ai);if(!o)return null;var l=null;return t.locale&&!(l=i.parse(t.locale,1,Ui))?null:new Eu(e,o,l)},Eu.prototype.evaluate=function(s){return new gd(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)},Eu.prototype.eachChild=function(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)},Eu.prototype.outputDefined=function(){return!1},Eu.prototype.serialize=function(){var s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]};var Cu=8192;function Sv(s,i){s[0]=Math.min(s[0],i[0]),s[1]=Math.min(s[1],i[1]),s[2]=Math.max(s[2],i[0]),s[3]=Math.max(s[3],i[1])}function Ug(s,i){return!(s[0]<=i[0])&&!(s[2]>=i[2])&&!(s[1]<=i[1])&&!(s[3]>=i[3])}function I2(s,i){var t,e=(180+s[0])/360,o=(t=s[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360),l=Math.pow(2,i.z);return[Math.round(e*l*Cu),Math.round(o*l*Cu)]}function M2(s,i,t){var e=s[0]-i[0],o=s[1]-i[1],l=s[0]-t[0],f=s[1]-t[1];return e*f-l*o==0&&e*l<=0&&o*f<=0}function L2(s,i,t){return i[1]>s[1]!=t[1]>s[1]&&s[0]<(t[0]-i[0])*(s[1]-i[1])/(t[1]-i[1])+i[0]}function Ev(s,i){for(var t=!1,e=0,o=i.length;e<o;e++)for(var l=i[e],f=0,y=l.length;f<y-1;f++){if(M2(s,l[f],l[f+1]))return!1;L2(s,l[f],l[f+1])&&(t=!t)}return t}function A2(s,i){for(var t=0;t<i.length;t++)if(Ev(s,i[t]))return!0;return!1}function jx(s,i,t,e){var o=s[0]-t[0],l=s[1]-t[1],f=i[0]-t[0],y=i[1]-t[1],w=e[0]-t[0],b=e[1]-t[1],I=o*b-w*l,N=f*b-w*y;return I>0&&N<0||I<0&&N>0}function O2(s,i,t){for(var e=0,o=t;e<o.length;e+=1)for(var l=o[e],f=0;f<l.length-1;++f)if(y=s,w=i,b=l[f],I=l[f+1],N=void 0,D=void 0,j=void 0,H=void 0,j=[w[0]-y[0],w[1]-y[1]],H=[I[0]-b[0],I[1]-b[1]],(N=H)[0]*(D=j)[1]-N[1]*D[0]!=0&&jx(y,w,b,I)&&jx(b,I,y,w))return!0;var y,w,b,I,N,D,j,H;return!1}function Bx(s,i){for(var t=0;t<s.length;++t)if(!Ev(s[t],i))return!1;for(var e=0;e<s.length-1;++e)if(O2(s[e],s[e+1],i))return!1;return!0}function N2(s,i){for(var t=0;t<i.length;t++)if(Bx(s,i[t]))return!0;return!1}function Cv(s,i,t){for(var e=[],o=0;o<s.length;o++){for(var l=[],f=0;f<s[o].length;f++){var y=I2(s[o][f],t);Sv(i,y),l.push(y)}e.push(l)}return e}function zx(s,i,t){for(var e=[],o=0;o<s.length;o++){var l=Cv(s[o],i,t);e.push(l)}return e}function Vx(s,i,t,e){if(s[0]<t[0]||s[0]>t[2]){var o=.5*e,l=s[0]-t[0]>o?-e:t[0]-s[0]>o?e:0;l===0&&(l=s[0]-t[2]>o?-e:t[2]-s[0]>o?e:0),s[0]+=l}Sv(i,s)}function Ux(s,i,t,e){var o=Math.pow(2,e.z)*Cu,l=[e.x*Cu,e.y*Cu],f=[];if(!s)return f;for(var y=0,w=s;y<w.length;y+=1)for(var b=0,I=w[y];b<I.length;b+=1){var N=I[b],D=[N.x+l[0],N.y+l[1]];Vx(D,i,t,o),f.push(D)}return f}function qx(s,i,t,e){var o=Math.pow(2,e.z)*Cu,l=[e.x*Cu,e.y*Cu],f=[];if(!s)return f;for(var y=0,w=s;y<w.length;y+=1){for(var b=[],I=0,N=w[y];I<N.length;I+=1){var D=N[I],j=[D.x+l[0],D.y+l[1]];Sv(i,j),b.push(j)}f.push(b)}if(i[2]-i[0]<=o/2){(function(wt){wt[0]=wt[1]=1/0,wt[2]=wt[3]=-1/0})(i);for(var H=0,Z=f;H<Z.length;H+=1)for(var it=0,at=Z[H];it<at.length;it+=1)Vx(at[it],i,t,o)}return f}var _l=function(s,i){this.type=Ai,this.geojson=s,this.geometries=i};function qg(s){if(s instanceof ms&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof _l)return!1;var i=!0;return s.eachChild(function(t){i&&!qg(t)&&(i=!1)}),i}function Tv(s){if(s instanceof ms&&s.name==="feature-state")return!1;var i=!0;return s.eachChild(function(t){i&&!Tv(t)&&(i=!1)}),i}function Pv(s,i){if(s instanceof ms&&i.indexOf(s.name)>=0)return!1;var t=!0;return s.eachChild(function(e){t&&!Pv(e,i)&&(t=!1)}),t}_l.parse=function(s,i){if(s.length!==2)return i.error("'within' expression requires exactly one argument, but found "+(s.length-1)+" instead.");if(Vg(s[1])){var t=s[1];if(t.type==="FeatureCollection")for(var e=0;e<t.features.length;++e){var o=t.features[e].geometry.type;if(o==="Polygon"||o==="MultiPolygon")return new _l(t,t.features[e].geometry)}else if(t.type==="Feature"){var l=t.geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new _l(t,t.geometry)}else if(t.type==="Polygon"||t.type==="MultiPolygon")return new _l(t,t)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")},_l.prototype.evaluate=function(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(i,t){var e=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],l=i.canonicalID();if(!l)return!1;if(t.type==="Polygon"){var f=Cv(t.coordinates,o,l),y=Ux(i.geometry(),e,o,l);if(!Ug(e,o))return!1;for(var w=0,b=y;w<b.length;w+=1)if(!Ev(b[w],f))return!1}if(t.type==="MultiPolygon"){var I=zx(t.coordinates,o,l),N=Ux(i.geometry(),e,o,l);if(!Ug(e,o))return!1;for(var D=0,j=N;D<j.length;D+=1)if(!A2(j[D],I))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(i,t){var e=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],l=i.canonicalID();if(!l)return!1;if(t.type==="Polygon"){var f=Cv(t.coordinates,o,l),y=qx(i.geometry(),e,o,l);if(!Ug(e,o))return!1;for(var w=0,b=y;w<b.length;w+=1)if(!Bx(b[w],f))return!1}if(t.type==="MultiPolygon"){var I=zx(t.coordinates,o,l),N=qx(i.geometry(),e,o,l);if(!Ug(e,o))return!1;for(var D=0,j=N;D<j.length;D+=1)if(!N2(j[D],I))return!1}return!0}(s,this.geometries)}return!1},_l.prototype.eachChild=function(){},_l.prototype.outputDefined=function(){return!0},_l.prototype.serialize=function(){return["within",this.geojson]};var Tu=function(s,i){this.type=i.type,this.name=s,this.boundExpression=i};Tu.parse=function(s,i){if(s.length!==2||typeof s[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");var t=s[1];return i.scope.has(t)?new Tu(t,i.scope.get(t)):i.error('Unknown variable "'+t+'". Make sure "'+t+'" has been bound in an enclosing "let" expression before using it.',1)},Tu.prototype.evaluate=function(s){return this.boundExpression.evaluate(s)},Tu.prototype.eachChild=function(){},Tu.prototype.outputDefined=function(){return!1},Tu.prototype.serialize=function(){return["var",this.name]};var Pu=function(s,i,t,e,o){i===void 0&&(i=[]),e===void 0&&(e=new hd),o===void 0&&(o=[]),this.registry=s,this.path=i,this.key=i.map(function(l){return"["+l+"]"}).join(""),this.scope=e,this.errors=o,this.expectedType=t};function Iv(s){if(s instanceof Tu)return Iv(s.boundExpression);if(s instanceof ms&&s.name==="error"||s instanceof Eu||s instanceof _l)return!1;var i=s instanceof Ha||s instanceof Ds,t=!0;return s.eachChild(function(e){t=i?t&&Iv(e):t&&e instanceof Ql}),!!t&&qg(s)&&Pv(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Hx(s,i){for(var t,e,o=s.length-1,l=0,f=o,y=0;l<=f;)if(t=s[y=Math.floor((l+f)/2)],e=s[y+1],t<=i){if(y===o||i<e)return y;l=y+1}else{if(!(t>i))throw new Jo("Input is not a number.");f=y-1}return 0}Pu.prototype.parse=function(s,i,t,e,o){return o===void 0&&(o={}),i?this.concat(i,t,e)._parse(s,o):this._parse(s,o)},Pu.prototype._parse=function(s,i){function t(b,I,N){return N==="assert"?new Ds(I,[b]):N==="coerce"?new Ha(I,[b]):b}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var e=s[0];if(typeof e!="string")return this.error("Expression name must be a string, but found "+typeof e+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var o=this.registry[e];if(o){var l=o.parse(s,this);if(!l)return null;if(this.expectedType){var f=this.expectedType,y=l.type;if(f.kind!=="string"&&f.kind!=="number"&&f.kind!=="boolean"&&f.kind!=="object"&&f.kind!=="array"||y.kind!=="value")if(f.kind!=="color"&&f.kind!=="formatted"&&f.kind!=="resolvedImage"||y.kind!=="value"&&y.kind!=="string"){if(this.checkSubtype(f,y))return null}else l=t(l,f,i.typeAnnotation||"coerce");else l=t(l,f,i.typeAnnotation||"assert")}if(!(l instanceof Ql)&&l.type.kind!=="resolvedImage"&&Iv(l)){var w=new Ic;try{l=new Ql(l.type,l.evaluate(w))}catch(b){return this.error(b.message),null}}return l}return this.error('Unknown expression "'+e+'". If you wanted a literal array, use ["literal", [...]].',0)}return s===void 0?this.error("'undefined' value invalid. Use null instead."):typeof s=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof s+" instead.")},Pu.prototype.concat=function(s,i,t){var e=typeof s=="number"?this.path.concat(s):this.path,o=t?this.scope.concat(t):this.scope;return new Pu(this.registry,e,i||null,o,this.errors)},Pu.prototype.error=function(s){for(var i=[],t=arguments.length-1;t-- >0;)i[t]=arguments[t+1];var e=""+this.key+i.map(function(o){return"["+o+"]"}).join("");this.errors.push(new Kl(e,s))},Pu.prototype.checkSubtype=function(s,i){var t=fd(s,i);return t&&this.error(t),t};var Iu=function(s,i,t){this.type=s,this.input=i,this.labels=[],this.outputs=[];for(var e=0,o=t;e<o.length;e+=1){var l=o[e],f=l[0],y=l[1];this.labels.push(f),this.outputs.push(y)}};Iu.parse=function(s,i){if(s.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return i.error("Expected an even number of arguments.");var t=i.parse(s[1],1,cr);if(!t)return null;var e=[],o=null;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);for(var l=1;l<s.length;l+=2){var f=l===1?-1/0:s[l],y=s[l+1],w=l,b=l+1;if(typeof f!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(e.length&&e[e.length-1][0]>=f)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);var I=i.parse(y,b,o);if(!I)return null;o=o||I.type,e.push([f,I])}return new Iu(o,t,e)},Iu.prototype.evaluate=function(s){var i=this.labels,t=this.outputs;if(i.length===1)return t[0].evaluate(s);var e=this.input.evaluate(s);if(e<=i[0])return t[0].evaluate(s);var o=i.length;return e>=i[o-1]?t[o-1].evaluate(s):t[Hx(i,e)].evaluate(s)},Iu.prototype.eachChild=function(s){s(this.input);for(var i=0,t=this.outputs;i<t.length;i+=1)s(t[i])},Iu.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},Iu.prototype.serialize=function(){for(var s=["step",this.input.serialize()],i=0;i<this.labels.length;i++)i>0&&s.push(this.labels[i]),s.push(this.outputs[i].serialize());return s};var R2=zp;function zp(s,i,t,e){this.cx=3*s,this.bx=3*(t-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(e-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=e,this.p2x=t,this.p2y=e}function va(s,i,t){return s*(1-t)+i*t}zp.prototype.sampleCurveX=function(s){return((this.ax*s+this.bx)*s+this.cx)*s},zp.prototype.sampleCurveY=function(s){return((this.ay*s+this.by)*s+this.cy)*s},zp.prototype.sampleCurveDerivativeX=function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},zp.prototype.solveCurveX=function(s,i){var t,e,o,l,f;for(i===void 0&&(i=1e-6),o=s,f=0;f<8;f++){if(l=this.sampleCurveX(o)-s,Math.abs(l)<i)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=l/y}if((o=s)<(t=0))return t;if(o>(e=1))return e;for(;t<e;){if(l=this.sampleCurveX(o),Math.abs(l-s)<i)return o;s>l?t=o:e=o,o=.5*(e-t)+t}return o},zp.prototype.solve=function(s,i){return this.sampleCurveY(this.solveCurveX(s,i))};var k2=Object.freeze({__proto__:null,number:va,color:function(s,i,t){return new kn(va(s.r,i.r,t),va(s.g,i.g,t),va(s.b,i.b,t),va(s.a,i.a,t))},array:function(s,i,t){return s.map(function(e,o){return va(e,i[o],t)})}}),Xx=.95047,Wx=1.08883,Yx=4/29,Mv=6/29,Zx=3*Mv*Mv,F2=Math.PI/180,D2=180/Math.PI;function Lv(s){return s>.008856451679035631?Math.pow(s,.3333333333333333):s/Zx+Yx}function Av(s){return s>Mv?s*s*s:Zx*(s-Yx)}function Ov(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,.4166666666666667)-.055)}function Nv(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function $x(s){var i=Nv(s.r),t=Nv(s.g),e=Nv(s.b),o=Lv((.4124564*i+.3575761*t+.1804375*e)/Xx),l=Lv((.2126729*i+.7151522*t+.072175*e)/1);return{l:116*l-16,a:500*(o-l),b:200*(l-Lv((.0193339*i+.119192*t+.9503041*e)/Wx)),alpha:s.a}}function Kx(s){var i=(s.l+16)/116,t=isNaN(s.a)?i:i+s.a/500,e=isNaN(s.b)?i:i-s.b/200;return i=1*Av(i),t=Xx*Av(t),e=Wx*Av(e),new kn(Ov(3.2404542*t-1.5371385*i-.4985314*e),Ov(-.969266*t+1.8760108*i+.041556*e),Ov(.0556434*t-.2040259*i+1.0572252*e),s.alpha)}function G2(s,i,t){var e=i-s;return s+t*(e>180||e<-180?e-360*Math.round(e/360):e)}var Hg={forward:$x,reverse:Kx,interpolate:function(s,i,t){return{l:va(s.l,i.l,t),a:va(s.a,i.a,t),b:va(s.b,i.b,t),alpha:va(s.alpha,i.alpha,t)}}},Xg={forward:function(s){var i=$x(s),t=i.l,e=i.a,o=i.b,l=Math.atan2(o,e)*D2;return{h:l<0?l+360:l,c:Math.sqrt(e*e+o*o),l:t,alpha:s.a}},reverse:function(s){var i=s.h*F2,t=s.c;return Kx({l:s.l,a:Math.cos(i)*t,b:Math.sin(i)*t,alpha:s.alpha})},interpolate:function(s,i,t){return{h:G2(s.h,i.h,t),c:va(s.c,i.c,t),l:va(s.l,i.l,t),alpha:va(s.alpha,i.alpha,t)}}},Gs=function(s,i,t,e,o){this.type=s,this.operator=i,this.interpolation=t,this.input=e,this.labels=[],this.outputs=[];for(var l=0,f=o;l<f.length;l+=1){var y=f[l],w=y[0],b=y[1];this.labels.push(w),this.outputs.push(b)}};function Rv(s,i,t,e){var o=e-t,l=s-t;return o===0?0:i===1?l/o:(Math.pow(i,l)-1)/(Math.pow(i,o)-1)}Gs.interpolationFactor=function(s,i,t,e){var o=0;if(s.name==="exponential")o=Rv(i,s.base,t,e);else if(s.name==="linear")o=Rv(i,1,t,e);else if(s.name==="cubic-bezier"){var l=s.controlPoints;o=new R2(l[0],l[1],l[2],l[3]).solve(Rv(i,1,t,e))}return o},Gs.parse=function(s,i){var t=s[0],e=s[1],o=s[2],l=s.slice(3);if(!Array.isArray(e)||e.length===0)return i.error("Expected an interpolation type expression.",1);if(e[0]==="linear")e={name:"linear"};else if(e[0]==="exponential"){var f=e[1];if(typeof f!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);e={name:"exponential",base:f}}else{if(e[0]!=="cubic-bezier")return i.error("Unknown interpolation type "+String(e[0]),1,0);var y=e.slice(1);if(y.length!==4||y.some(function(it){return typeof it!="number"||it<0||it>1}))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);e={name:"cubic-bezier",controlPoints:y}}if(s.length-1<4)return i.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if((s.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(!(o=i.parse(o,2,cr)))return null;var w=[],b=null;t==="interpolate-hcl"||t==="interpolate-lab"?b=Pc:i.expectedType&&i.expectedType.kind!=="value"&&(b=i.expectedType);for(var I=0;I<l.length;I+=2){var N=l[I],D=l[I+1],j=I+3,H=I+4;if(typeof N!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(w.length&&w[w.length-1][0]>=N)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);var Z=i.parse(D,H,b);if(!Z)return null;b=b||Z.type,w.push([N,Z])}return b.kind==="number"||b.kind==="color"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new Gs(b,t,e,o,w):i.error("Type "+so(b)+" is not interpolatable.")},Gs.prototype.evaluate=function(s){var i=this.labels,t=this.outputs;if(i.length===1)return t[0].evaluate(s);var e=this.input.evaluate(s);if(e<=i[0])return t[0].evaluate(s);var o=i.length;if(e>=i[o-1])return t[o-1].evaluate(s);var l=Hx(i,e),f=i[l],y=i[l+1],w=Gs.interpolationFactor(this.interpolation,e,f,y),b=t[l].evaluate(s),I=t[l+1].evaluate(s);return this.operator==="interpolate"?k2[this.type.kind.toLowerCase()](b,I,w):this.operator==="interpolate-hcl"?Xg.reverse(Xg.interpolate(Xg.forward(b),Xg.forward(I),w)):Hg.reverse(Hg.interpolate(Hg.forward(b),Hg.forward(I),w))},Gs.prototype.eachChild=function(s){s(this.input);for(var i=0,t=this.outputs;i<t.length;i+=1)s(t[i])},Gs.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})},Gs.prototype.serialize=function(){var s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var i=[this.operator,s,this.input.serialize()],t=0;t<this.labels.length;t++)i.push(this.labels[t],this.outputs[t].serialize());return i};var Mu=function(s,i){this.type=s,this.args=i};Mu.parse=function(s,i){if(s.length<2)return i.error("Expectected at least one argument.");var t=null,e=i.expectedType;e&&e.kind!=="value"&&(t=e);for(var o=[],l=0,f=s.slice(1);l<f.length;l+=1){var y=f[l],w=i.parse(y,1+o.length,t,void 0,{typeAnnotation:"omit"});if(!w)return null;t=t||w.type,o.push(w)}var b=e&&o.some(function(I){return fd(e,I.type)});return new Mu(b?Oi:t,o)},Mu.prototype.evaluate=function(s){for(var i,t=null,e=0,o=0,l=this.args;o<l.length;o+=1){if(e++,(t=l[o].evaluate(s))&&t instanceof Jl&&!t.available&&(i||(i=t),t=null,e===this.args.length))return i;if(t!==null)break}return t},Mu.prototype.eachChild=function(s){this.args.forEach(s)},Mu.prototype.outputDefined=function(){return this.args.every(function(s){return s.outputDefined()})},Mu.prototype.serialize=function(){var s=["coalesce"];return this.eachChild(function(i){s.push(i.serialize())}),s};var Lu=function(s,i){this.type=i.type,this.bindings=[].concat(s),this.result=i};Lu.prototype.evaluate=function(s){return this.result.evaluate(s)},Lu.prototype.eachChild=function(s){for(var i=0,t=this.bindings;i<t.length;i+=1)s(t[i][1]);s(this.result)},Lu.parse=function(s,i){if(s.length<4)return i.error("Expected at least 3 arguments, but found "+(s.length-1)+" instead.");for(var t=[],e=1;e<s.length-1;e+=2){var o=s[e];if(typeof o!="string")return i.error("Expected string, but found "+typeof o+" instead.",e);if(/[^a-zA-Z0-9_]/.test(o))return i.error("Variable names must contain only alphanumeric characters or '_'.",e);var l=i.parse(s[e+1],e+1);if(!l)return null;t.push([o,l])}var f=i.parse(s[s.length-1],s.length-1,i.expectedType,t);return f?new Lu(t,f):null},Lu.prototype.outputDefined=function(){return this.result.outputDefined()},Lu.prototype.serialize=function(){for(var s=["let"],i=0,t=this.bindings;i<t.length;i+=1){var e=t[i],o=e[0],l=e[1];s.push(o,l.serialize())}return s.push(this.result.serialize()),s};var Th=function(s,i,t){this.type=s,this.index=i,this.input=t};Th.parse=function(s,i){if(s.length!==3)return i.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var t=i.parse(s[1],1,cr),e=i.parse(s[2],2,qa(i.expectedType||Oi));if(!t||!e)return null;var o=e.type;return new Th(o.itemType,t,e)},Th.prototype.evaluate=function(s){var i=this.index.evaluate(s),t=this.input.evaluate(s);if(i<0)throw new Jo("Array index out of bounds: "+i+" < 0.");if(i>=t.length)throw new Jo("Array index out of bounds: "+i+" > "+(t.length-1)+".");if(i!==Math.floor(i))throw new Jo("Array index must be an integer, but found "+i+" instead.");return t[i]},Th.prototype.eachChild=function(s){s(this.index),s(this.input)},Th.prototype.outputDefined=function(){return!1},Th.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ph=function(s,i){this.type=Ai,this.needle=s,this.haystack=i};Ph.parse=function(s,i){if(s.length!==3)return i.error("Expected 2 arguments, but found "+(s.length-1)+" instead.");var t=i.parse(s[1],1,Oi),e=i.parse(s[2],2,Oi);return t&&e?xv(t.type,[Ai,Ui,cr,jg,Oi])?new Ph(t,e):i.error("Expected first argument to be of type boolean, string, number or null, but found "+so(t.type)+" instead"):null},Ph.prototype.evaluate=function(s){var i=this.needle.evaluate(s),t=this.haystack.evaluate(s);if(t==null)return!1;if(!dd(i,["boolean","string","number","null"]))throw new Jo("Expected first argument to be of type boolean, string, number or null, but found "+so(zo(i))+" instead.");if(!dd(t,["string","array"]))throw new Jo("Expected second argument to be of type array or string, but found "+so(zo(t))+" instead.");return t.indexOf(i)>=0},Ph.prototype.eachChild=function(s){s(this.needle),s(this.haystack)},Ph.prototype.outputDefined=function(){return!0},Ph.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Au=function(s,i,t){this.type=cr,this.needle=s,this.haystack=i,this.fromIndex=t};Au.parse=function(s,i){if(s.length<=2||s.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var t=i.parse(s[1],1,Oi),e=i.parse(s[2],2,Oi);if(!t||!e)return null;if(!xv(t.type,[Ai,Ui,cr,jg,Oi]))return i.error("Expected first argument to be of type boolean, string, number or null, but found "+so(t.type)+" instead");if(s.length===4){var o=i.parse(s[3],3,cr);return o?new Au(t,e,o):null}return new Au(t,e)},Au.prototype.evaluate=function(s){var i=this.needle.evaluate(s),t=this.haystack.evaluate(s);if(!dd(i,["boolean","string","number","null"]))throw new Jo("Expected first argument to be of type boolean, string, number or null, but found "+so(zo(i))+" instead.");if(!dd(t,["string","array"]))throw new Jo("Expected second argument to be of type array or string, but found "+so(zo(t))+" instead.");if(this.fromIndex){var e=this.fromIndex.evaluate(s);return t.indexOf(i,e)}return t.indexOf(i)},Au.prototype.eachChild=function(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)},Au.prototype.outputDefined=function(){return!1},Au.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ih=function(s,i,t,e,o,l){this.inputType=s,this.type=i,this.input=t,this.cases=e,this.outputs=o,this.otherwise=l};Ih.parse=function(s,i){if(s.length<5)return i.error("Expected at least 4 arguments, but found only "+(s.length-1)+".");if(s.length%2!=1)return i.error("Expected an even number of arguments.");var t,e;i.expectedType&&i.expectedType.kind!=="value"&&(e=i.expectedType);for(var o={},l=[],f=2;f<s.length-1;f+=2){var y=s[f],w=s[f+1];Array.isArray(y)||(y=[y]);var b=i.concat(f);if(y.length===0)return b.error("Expected at least one branch label.");for(var I=0,N=y;I<N.length;I+=1){var D=N[I];if(typeof D!="number"&&typeof D!="string")return b.error("Branch labels must be numbers or strings.");if(typeof D=="number"&&Math.abs(D)>Number.MAX_SAFE_INTEGER)return b.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof D=="number"&&Math.floor(D)!==D)return b.error("Numeric branch labels must be integer values.");if(t){if(b.checkSubtype(t,zo(D)))return null}else t=zo(D);if(o[String(D)]!==void 0)return b.error("Branch labels must be unique.");o[String(D)]=l.length}var j=i.parse(w,f,e);if(!j)return null;e=e||j.type,l.push(j)}var H=i.parse(s[1],1,Oi);if(!H)return null;var Z=i.parse(s[s.length-1],s.length-1,e);return Z?H.type.kind!=="value"&&i.concat(1).checkSubtype(t,H.type)?null:new Ih(t,e,H,o,l,Z):null},Ih.prototype.evaluate=function(s){var i=this.input.evaluate(s);return(zo(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(s)},Ih.prototype.eachChild=function(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)},Ih.prototype.outputDefined=function(){return this.outputs.every(function(s){return s.outputDefined()})&&this.otherwise.outputDefined()},Ih.prototype.serialize=function(){for(var s=this,i=["match",this.input.serialize()],t=[],e={},o=0,l=Object.keys(this.cases).sort();o<l.length;o+=1){var f=l[o];(N=e[this.cases[f]])===void 0?(e[this.cases[f]]=t.length,t.push([this.cases[f],[f]])):t[N][1].push(f)}for(var y=function(j){return s.inputType.kind==="number"?Number(j):j},w=0,b=t;w<b.length;w+=1){var I=b[w],N=I[0],D=I[1];D.length===1?i.push(y(D[0])):i.push(D.map(y)),i.push(this.outputs[outputIndex$1].serialize())}return i.push(this.otherwise.serialize()),i};var Mh=function(s,i,t){this.type=s,this.branches=i,this.otherwise=t};Mh.parse=function(s,i){if(s.length<4)return i.error("Expected at least 3 arguments, but found only "+(s.length-1)+".");if(s.length%2!=0)return i.error("Expected an odd number of arguments.");var t;i.expectedType&&i.expectedType.kind!=="value"&&(t=i.expectedType);for(var e=[],o=1;o<s.length-1;o+=2){var l=i.parse(s[o],o,Ai);if(!l)return null;var f=i.parse(s[o+1],o+1,t);if(!f)return null;e.push([l,f]),t=t||f.type}var y=i.parse(s[s.length-1],s.length-1,t);return y?new Mh(t,e,y):null},Mh.prototype.evaluate=function(s){for(var i=0,t=this.branches;i<t.length;i+=1){var e=t[i],o=e[0],l=e[1];if(o.evaluate(s))return l.evaluate(s)}return this.otherwise.evaluate(s)},Mh.prototype.eachChild=function(s){for(var i=0,t=this.branches;i<t.length;i+=1){var e=t[i],o=e[0],l=e[1];s(o),s(l)}s(this.otherwise)},Mh.prototype.outputDefined=function(){return this.branches.every(function(s){return s[0],s[1].outputDefined()})&&this.otherwise.outputDefined()},Mh.prototype.serialize=function(){var s=["case"];return this.eachChild(function(i){s.push(i.serialize())}),s};var Ou=function(s,i,t,e){this.type=s,this.input=i,this.beginIndex=t,this.endIndex=e};function Jx(s,i){return s==="=="||s==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Qx(s,i,t,e){return e.compare(i,t)===0}function Vp(s,i,t){var e=s!=="=="&&s!=="!=";return function(){function o(l,f,y){this.type=Ai,this.lhs=l,this.rhs=f,this.collator=y,this.hasUntypedArgument=l.type.kind==="value"||f.type.kind==="value"}return o.parse=function(l,f){if(l.length!==3&&l.length!==4)return f.error("Expected two or three arguments.");var y=l[0],w=f.parse(l[1],1,Oi);if(!w)return null;if(!Jx(y,w.type))return f.concat(1).error('"'+y+`" comparisons are not supported for type '`+so(w.type)+"'.");var b=f.parse(l[2],2,Oi);if(!b)return null;if(!Jx(y,b.type))return f.concat(2).error('"'+y+`" comparisons are not supported for type '`+so(b.type)+"'.");if(w.type.kind!==b.type.kind&&w.type.kind!=="value"&&b.type.kind!=="value")return f.error("Cannot compare types '"+so(w.type)+"' and '"+so(b.type)+"'.");e&&(w.type.kind==="value"&&b.type.kind!=="value"?w=new Ds(b.type,[w]):w.type.kind!=="value"&&b.type.kind==="value"&&(b=new Ds(w.type,[b])));var I=null;if(l.length===4){if(w.type.kind!=="string"&&b.type.kind!=="string"&&w.type.kind!=="value"&&b.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(!(I=f.parse(l[3],3,Bg)))return null}return new o(w,b,I)},o.prototype.evaluate=function(l){var f=this.lhs.evaluate(l),y=this.rhs.evaluate(l);if(e&&this.hasUntypedArgument){var w=zo(f),b=zo(y);if(w.kind!==b.kind||w.kind!=="string"&&w.kind!=="number")throw new Jo('Expected arguments for "'+s+'" to be (string, string) or (number, number), but found ('+w.kind+", "+b.kind+") instead.")}if(this.collator&&!e&&this.hasUntypedArgument){var I=zo(f),N=zo(y);if(I.kind!=="string"||N.kind!=="string")return i(l,f,y)}return this.collator?t(l,f,y,this.collator.evaluate(l)):i(l,f,y)},o.prototype.eachChild=function(l){l(this.lhs),l(this.rhs),this.collator&&l(this.collator)},o.prototype.outputDefined=function(){return!0},o.prototype.serialize=function(){var l=[s];return this.eachChild(function(f){l.push(f.serialize())}),l},o}()}Ou.parse=function(s,i){if(s.length<=2||s.length>=5)return i.error("Expected 3 or 4 arguments, but found "+(s.length-1)+" instead.");var t=i.parse(s[1],1,Oi),e=i.parse(s[2],2,cr);if(!t||!e)return null;if(!xv(t.type,[qa(Oi),Ui,Oi]))return i.error("Expected first argument to be of type array or string, but found "+so(t.type)+" instead");if(s.length===4){var o=i.parse(s[3],3,cr);return o?new Ou(t.type,t,e,o):null}return new Ou(t.type,t,e)},Ou.prototype.evaluate=function(s){var i=this.input.evaluate(s),t=this.beginIndex.evaluate(s);if(!dd(i,["string","array"]))throw new Jo("Expected first argument to be of type array or string, but found "+so(zo(i))+" instead.");if(this.endIndex){var e=this.endIndex.evaluate(s);return i.slice(t,e)}return i.slice(t)},Ou.prototype.eachChild=function(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)},Ou.prototype.outputDefined=function(){return!1},Ou.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var j2=Vp("==",function(s,i,t){return i===t},Qx),B2=Vp("!=",function(s,i,t){return i!==t},function(s,i,t,e){return!Qx(0,i,t,e)}),z2=Vp("<",function(s,i,t){return i<t},function(s,i,t,e){return e.compare(i,t)<0}),V2=Vp(">",function(s,i,t){return i>t},function(s,i,t,e){return e.compare(i,t)>0}),U2=Vp("<=",function(s,i,t){return i<=t},function(s,i,t,e){return e.compare(i,t)<=0}),q2=Vp(">=",function(s,i,t){return i>=t},function(s,i,t,e){return e.compare(i,t)>=0}),Lh=function(s,i,t,e,o){this.type=Ui,this.number=s,this.locale=i,this.currency=t,this.minFractionDigits=e,this.maxFractionDigits=o};Lh.parse=function(s,i){if(s.length!==3)return i.error("Expected two arguments.");var t=i.parse(s[1],1,cr);if(!t)return null;var e=s[2];if(typeof e!="object"||Array.isArray(e))return i.error("NumberFormat options argument must be an object.");var o=null;if(e.locale&&!(o=i.parse(e.locale,1,Ui)))return null;var l=null;if(e.currency&&!(l=i.parse(e.currency,1,Ui)))return null;var f=null;if(e["min-fraction-digits"]&&!(f=i.parse(e["min-fraction-digits"],1,cr)))return null;var y=null;return e["max-fraction-digits"]&&!(y=i.parse(e["max-fraction-digits"],1,cr))?null:new Lh(t,o,l,f,y)},Lh.prototype.evaluate=function(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))},Lh.prototype.eachChild=function(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)},Lh.prototype.outputDefined=function(){return!1},Lh.prototype.serialize=function(){var s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]};var Ah=function(s){this.type=cr,this.input=s};Ah.parse=function(s,i){if(s.length!==2)return i.error("Expected 1 argument, but found "+(s.length-1)+" instead.");var t=i.parse(s[1],1);return t?t.type.kind!=="array"&&t.type.kind!=="string"&&t.type.kind!=="value"?i.error("Expected argument of type string or array, but found "+so(t.type)+" instead."):new Ah(t):null},Ah.prototype.evaluate=function(s){var i=this.input.evaluate(s);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Jo("Expected value to be of type string or array, but found "+so(zo(i))+" instead.")},Ah.prototype.eachChild=function(s){s(this.input)},Ah.prototype.outputDefined=function(){return!1},Ah.prototype.serialize=function(){var s=["length"];return this.eachChild(function(i){s.push(i.serialize())}),s};var kv={"==":j2,"!=":B2,">":V2,"<":z2,">=":q2,"<=":U2,array:Ds,at:Th,boolean:Ds,case:Mh,coalesce:Mu,collator:Eu,format:bu,image:Su,in:Ph,"index-of":Au,interpolate:Gs,"interpolate-hcl":Gs,"interpolate-lab":Gs,length:Ah,let:Lu,literal:Ql,match:Ih,number:Ds,"number-format":Lh,object:Ds,slice:Ou,step:Iu,string:Ds,"to-boolean":Ha,"to-color":Ha,"to-number":Ha,"to-string":Ha,var:Tu,within:_l};function tw(s,i){var t=i[0],e=i[1],o=i[2],l=i[3];t=t.evaluate(s),e=e.evaluate(s),o=o.evaluate(s);var f=l?l.evaluate(s):1,y=Gx(t,e,o,f);if(y)throw new Jo(y);return new kn(t/255*f,e/255*f,o/255*f,f)}function ew(s,i){return s in i}function Fv(s,i){var t=i[s];return t===void 0?null:t}function Oh(s){return{type:s}}function Dv(s){return{result:"success",value:s}}function Up(s){return{result:"error",value:s}}function rw(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}ms.register(kv,{error:[{kind:"error"},[Ui],function(s,i){var t=i[0];throw new Jo(t.evaluate(s))}],typeof:[Ui,[Oi],function(s,i){return so(zo(i[0].evaluate(s)))}],"to-rgba":[qa(cr,4),[Pc],function(s,i){return i[0].evaluate(s).toArray()}],rgb:[Pc,[cr,cr,cr],tw],rgba:[Pc,[cr,cr,cr,cr],tw],has:{type:Ai,overloads:[[[Ui],function(s,i){return ew(i[0].evaluate(s),s.properties())}],[[Ui,Bp],function(s,i){var t=i[0],e=i[1];return ew(t.evaluate(s),e.evaluate(s))}]]},get:{type:Oi,overloads:[[[Ui],function(s,i){return Fv(i[0].evaluate(s),s.properties())}],[[Ui,Bp],function(s,i){var t=i[0],e=i[1];return Fv(t.evaluate(s),e.evaluate(s))}]]},"feature-state":[Oi,[Ui],function(s,i){return Fv(i[0].evaluate(s),s.featureState||{})}],properties:[Bp,[],function(s){return s.properties()}],"geometry-type":[Ui,[],function(s){return s.geometryType()}],id:[Oi,[],function(s){return s.id()}],zoom:[cr,[],function(s){return s.globals.zoom}],pitch:[cr,[],function(s){return s.globals.pitch||0}],"distance-from-center":[cr,[],function(s){return s.distanceFromCenter()}],"heatmap-density":[cr,[],function(s){return s.globals.heatmapDensity||0}],"line-progress":[cr,[],function(s){return s.globals.lineProgress||0}],"sky-radial-progress":[cr,[],function(s){return s.globals.skyRadialProgress||0}],accumulated:[Oi,[],function(s){return s.globals.accumulated===void 0?null:s.globals.accumulated}],"+":[cr,Oh(cr),function(s,i){for(var t=0,e=0,o=i;e<o.length;e+=1)t+=o[e].evaluate(s);return t}],"*":[cr,Oh(cr),function(s,i){for(var t=1,e=0,o=i;e<o.length;e+=1)t*=o[e].evaluate(s);return t}],"-":{type:cr,overloads:[[[cr,cr],function(s,i){var t=i[0],e=i[1];return t.evaluate(s)-e.evaluate(s)}],[[cr],function(s,i){return-i[0].evaluate(s)}]]},"/":[cr,[cr,cr],function(s,i){var t=i[0],e=i[1];return t.evaluate(s)/e.evaluate(s)}],"%":[cr,[cr,cr],function(s,i){var t=i[0],e=i[1];return t.evaluate(s)%e.evaluate(s)}],ln2:[cr,[],function(){return Math.LN2}],pi:[cr,[],function(){return Math.PI}],e:[cr,[],function(){return Math.E}],"^":[cr,[cr,cr],function(s,i){var t=i[0],e=i[1];return Math.pow(t.evaluate(s),e.evaluate(s))}],sqrt:[cr,[cr],function(s,i){var t=i[0];return Math.sqrt(t.evaluate(s))}],log10:[cr,[cr],function(s,i){var t=i[0];return Math.log(t.evaluate(s))/Math.LN10}],ln:[cr,[cr],function(s,i){var t=i[0];return Math.log(t.evaluate(s))}],log2:[cr,[cr],function(s,i){var t=i[0];return Math.log(t.evaluate(s))/Math.LN2}],sin:[cr,[cr],function(s,i){var t=i[0];return Math.sin(t.evaluate(s))}],cos:[cr,[cr],function(s,i){var t=i[0];return Math.cos(t.evaluate(s))}],tan:[cr,[cr],function(s,i){var t=i[0];return Math.tan(t.evaluate(s))}],asin:[cr,[cr],function(s,i){var t=i[0];return Math.asin(t.evaluate(s))}],acos:[cr,[cr],function(s,i){var t=i[0];return Math.acos(t.evaluate(s))}],atan:[cr,[cr],function(s,i){var t=i[0];return Math.atan(t.evaluate(s))}],min:[cr,Oh(cr),function(s,i){return Math.min.apply(Math,i.map(function(t){return t.evaluate(s)}))}],max:[cr,Oh(cr),function(s,i){return Math.max.apply(Math,i.map(function(t){return t.evaluate(s)}))}],abs:[cr,[cr],function(s,i){var t=i[0];return Math.abs(t.evaluate(s))}],round:[cr,[cr],function(s,i){var t=i[0].evaluate(s);return t<0?-Math.round(-t):Math.round(t)}],floor:[cr,[cr],function(s,i){var t=i[0];return Math.floor(t.evaluate(s))}],ceil:[cr,[cr],function(s,i){var t=i[0];return Math.ceil(t.evaluate(s))}],"filter-==":[Ai,[Ui,Oi],function(s,i){var t=i[0],e=i[1];return s.properties()[t.value]===e.value}],"filter-id-==":[Ai,[Oi],function(s,i){var t=i[0];return s.id()===t.value}],"filter-type-==":[Ai,[Ui],function(s,i){var t=i[0];return s.geometryType()===t.value}],"filter-<":[Ai,[Ui,Oi],function(s,i){var t=i[0],e=i[1],o=s.properties()[t.value],l=e.value;return typeof o==typeof l&&o<l}],"filter-id-<":[Ai,[Oi],function(s,i){var t=i[0],e=s.id(),o=t.value;return typeof e==typeof o&&e<o}],"filter->":[Ai,[Ui,Oi],function(s,i){var t=i[0],e=i[1],o=s.properties()[t.value],l=e.value;return typeof o==typeof l&&o>l}],"filter-id->":[Ai,[Oi],function(s,i){var t=i[0],e=s.id(),o=t.value;return typeof e==typeof o&&e>o}],"filter-<=":[Ai,[Ui,Oi],function(s,i){var t=i[0],e=i[1],o=s.properties()[t.value],l=e.value;return typeof o==typeof l&&o<=l}],"filter-id-<=":[Ai,[Oi],function(s,i){var t=i[0],e=s.id(),o=t.value;return typeof e==typeof o&&e<=o}],"filter->=":[Ai,[Ui,Oi],function(s,i){var t=i[0],e=i[1],o=s.properties()[t.value],l=e.value;return typeof o==typeof l&&o>=l}],"filter-id->=":[Ai,[Oi],function(s,i){var t=i[0],e=s.id(),o=t.value;return typeof e==typeof o&&e>=o}],"filter-has":[Ai,[Oi],function(s,i){return i[0].value in s.properties()}],"filter-has-id":[Ai,[],function(s){return s.id()!==null&&s.id()!==void 0}],"filter-type-in":[Ai,[qa(Ui)],function(s,i){return i[0].value.indexOf(s.geometryType())>=0}],"filter-id-in":[Ai,[qa(Oi)],function(s,i){return i[0].value.indexOf(s.id())>=0}],"filter-in-small":[Ai,[Ui,qa(Oi)],function(s,i){var t=i[0];return i[1].value.indexOf(s.properties()[t.value])>=0}],"filter-in-large":[Ai,[Ui,qa(Oi)],function(s,i){var t=i[0],e=i[1];return function(o,l,f,y){for(;f<=y;){var w=f+y>>1;if(l[w]===o)return!0;l[w]>o?y=w-1:f=w+1}return!1}(s.properties()[t.value],e.value,0,e.value.length-1)}],all:{type:Ai,overloads:[[[Ai,Ai],function(s,i){var t=i[0],e=i[1];return t.evaluate(s)&&e.evaluate(s)}],[Oh(Ai),function(s,i){for(var t=0,e=i;t<e.length;t+=1)if(!e[t].evaluate(s))return!1;return!0}]]},any:{type:Ai,overloads:[[[Ai,Ai],function(s,i){var t=i[0],e=i[1];return t.evaluate(s)||e.evaluate(s)}],[Oh(Ai),function(s,i){for(var t=0,e=i;t<e.length;t+=1)if(e[t].evaluate(s))return!0;return!1}]]},"!":[Ai,[Ai],function(s,i){return!i[0].evaluate(s)}],"is-supported-script":[Ai,[Ui],function(s,i){var t=i[0],e=s.globals&&s.globals.isSupportedScript;return!e||e(t.evaluate(s))}],upcase:[Ui,[Ui],function(s,i){return i[0].evaluate(s).toUpperCase()}],downcase:[Ui,[Ui],function(s,i){return i[0].evaluate(s).toLowerCase()}],concat:[Ui,Oh(Oi),function(s,i){return i.map(function(t){return md(t.evaluate(s))}).join("")}],"resolved-locale":[Ui,[Bg],function(s,i){return i[0].evaluate(s).resolvedLocale()}]});var Gv=function(s,i){this.expression=s,this._warningHistory={},this._evaluator=new Ic,this._defaultValue=i?function(t){return t.type==="color"&&rw(t.default)?new kn(0,0,0,0):t.type==="color"?kn.parse(t.default)||null:t.default===void 0?null:t.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null};function jv(s,i){var t=new Pu(kv,[],i?function(o){var l={color:Pc,string:Ui,number:cr,enum:Ui,boolean:Ai,formatted:zg,resolvedImage:pd};return o.type==="array"?qa(l[o.value]||Oi,o.length):l[o.type]}(i):void 0),e=t.parse(s,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return e?Dv(new Gv(e,i)):Up(t.errors)}Gv.prototype.evaluateWithoutErrorHandling=function(s,i,t,e,o,l,f,y){return this._evaluator.globals=s,this._evaluator.feature=i,this._evaluator.featureState=t,this._evaluator.canonical=e||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=l,this._evaluator.featureTileCoord=f||null,this._evaluator.featureDistanceData=y||null,this.expression.evaluate(this._evaluator)},Gv.prototype.evaluate=function(s,i,t,e,o,l,f,y){this._evaluator.globals=s,this._evaluator.feature=i||null,this._evaluator.featureState=t||null,this._evaluator.canonical=e||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=l||null,this._evaluator.featureTileCoord=f||null,this._evaluator.featureDistanceData=y||null;try{var w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Jo("Expected value to be one of "+Object.keys(this._enumValues).map(function(b){return JSON.stringify(b)}).join(", ")+", but found "+JSON.stringify(w)+" instead.");return w}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}};var Bv=function(s,i){this.kind=s,this._styleExpression=i,this.isStateDependent=s!=="constant"&&!Tv(i.expression)};Bv.prototype.evaluateWithoutErrorHandling=function(s,i,t,e,o,l){return this._styleExpression.evaluateWithoutErrorHandling(s,i,t,e,o,l)},Bv.prototype.evaluate=function(s,i,t,e,o,l){return this._styleExpression.evaluate(s,i,t,e,o,l)};var Wg=function(s,i,t,e){this.kind=s,this.zoomStops=t,this._styleExpression=i,this.isStateDependent=s!=="camera"&&!Tv(i.expression),this.interpolationType=e};function H2(s,i){if((s=jv(s,i)).result==="error")return s;var t=s.value.expression,e=qg(t);if(!e&&!function(y){return y["property-type"]==="data-driven"||y["property-type"]==="cross-faded-data-driven"}(i))return Up([new Kl("","data expressions not supported")]);var o=Pv(t,["zoom","pitch","distance-from-center"]);if(!o&&!function(y){return!!y.expression&&y.expression.parameters.indexOf("zoom")>-1}(i))return Up([new Kl("","zoom expressions not supported")]);var l=Yg(t);if(!l&&!o)return Up([new Kl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(l instanceof Kl)return Up([l]);if(l instanceof Gs&&!function(y){return!!y.expression&&y.expression.interpolated}(i))return Up([new Kl("",'"interpolate" expressions cannot be used with this property')]);if(!l)return Dv(new Bv(e?"constant":"source",s.value));var f=l instanceof Gs?l.interpolation:void 0;return Dv(new Wg(e?"camera":"composite",s.value,l.labels,f))}function Yg(s){var i=null;if(s instanceof Lu)i=Yg(s.result);else if(s instanceof Mu)for(var t=0,e=s.args;t<e.length;t+=1){var o=e[t];if(i=Yg(o))break}else(s instanceof Iu||s instanceof Gs)&&s.input instanceof ms&&s.input.name==="zoom"&&(i=s);return i instanceof Kl||s.eachChild(function(l){var f=Yg(l);f instanceof Kl?i=f:!i&&f?i=new Kl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&f&&i!==f&&(i=new Kl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function zv(s){if(Array.isArray(s))return s.map(zv);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){var i={};for(var t in s)i[t]=zv(s[t]);return i}return function(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}(s)}Wg.prototype.evaluateWithoutErrorHandling=function(s,i,t,e,o,l){return this._styleExpression.evaluateWithoutErrorHandling(s,i,t,e,o,l)},Wg.prototype.evaluate=function(s,i,t,e,o,l){return this._styleExpression.evaluate(s,i,t,e,o,l)},Wg.prototype.interpolationFactor=function(s,i,t){return this.interpolationType?Gs.interpolationFactor(this.interpolationType,s,i,t):0};var iw={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function nw(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(var i=0,t=s.slice(1);i<t.length;i+=1){var e=t[i];if(!nw(e)&&typeof e!="boolean")return!1}return!0;default:return!0}}function X2(s,i){if(i===void 0&&(i="fill"),s==null)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};nw(s)||(s=Zg(s));var t=s,e=!0;try{e=function(I){if(!qp(I))return I;var N=zv(I);return sw(N),N=ow(N)}(t)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
`+JSON.stringify(t,null,2)+`
        `)}var o=iw["filter_"+i],l=jv(e,o),f=null;if(l.result==="error")throw new Error(l.value.map(function(I){return I.key+": "+I.message}).join(", "));f=function(I,N,D){return l.value.evaluate(I,N,{},D)};var y=null,w=null;if(e!==t){var b=jv(t,o);if(b.result==="error")throw new Error(b.value.map(function(I){return I.key+": "+I.message}).join(", "));y=function(I,N,D,j,H){return b.value.evaluate(I,N,{},D,void 0,void 0,j,H)},w=!qg(b.value.expression)}return{filter:f=f,dynamicFilter:y||void 0,needGeometry:aw(e),needFeature:!!w}}function ow(s){if(!Array.isArray(s))return s;var i=function(t){if(W2.has(t[0])){for(var e=1;e<t.length;e++)if(qp(t[e]))return!0}return t}(s);return i===!0?i:i.map(function(t){return ow(t)})}function sw(s){var i=!1,t=[];if(s[0]==="case"){for(var e=1;e<s.length-1;e+=2)i=i||qp(s[e]),t.push(s[e+1]);t.push(s[s.length-1])}else if(s[0]==="match"){i=i||qp(s[1]);for(var o=2;o<s.length-1;o+=2)t.push(s[o+1]);t.push(s[s.length-1])}else if(s[0]==="step"){i=i||qp(s[1]);for(var l=1;l<s.length-1;l+=2)t.push(s[l+1])}i&&(s.length=0,s.push.apply(s,["any"].concat(t)));for(var f=1;f<s.length;f++)sw(s[f])}function qp(s){if(!Array.isArray(s))return!1;if((i=s[0])==="pitch"||i==="distance-from-center")return!0;for(var i,t=1;t<s.length;t++)if(qp(s[t]))return!0;return!1}var W2=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Y2(s,i){return s<i?-1:s>i?1:0}function aw(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(var i=1;i<s.length;i++)if(aw(s[i]))return!0;return!1}function Zg(s){if(!s)return!0;var i,t=s[0];return s.length<=1?t!=="any":t==="=="?Vv(s[1],s[2],"=="):t==="!="?$g(Vv(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Vv(s[1],s[2],t):t==="any"?(i=s.slice(1),["any"].concat(i.map(Zg))):t==="all"?["all"].concat(s.slice(1).map(Zg)):t==="none"?["all"].concat(s.slice(1).map(Zg).map($g)):t==="in"?lw(s[1],s.slice(2)):t==="!in"?$g(lw(s[1],s.slice(2))):t==="has"?cw(s[1]):t==="!has"?$g(cw(s[1])):t!=="within"||s}function Vv(s,i,t){switch(s){case"$type":return["filter-type-"+t,i];case"$id":return["filter-id-"+t,i];default:return["filter-"+t,s,i]}}function lw(s,i){if(i.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(function(t){return typeof t!=typeof i[0]})?["filter-in-large",s,["literal",i.sort(Y2)]]:["filter-in-small",s,["literal",i]]}}function cw(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function $g(s){return["!",s]}var Z2=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $2(s,i){var t={};for(var e in s)e!=="ref"&&(t[e]=s[e]);return Z2.forEach(function(o){o in i&&(t[o]=i[o])}),t}var uw={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},yd=" ",hw=/(italic|oblique)$/i,pw={},Uv=function(s,i,t){var e=pw[s];if(!e){Array.isArray(s)||(s=[s]);for(var o=400,l="normal",f=[],y=0,w=s.length;y<w;++y){var b=s[y].split(" "),I=b[b.length-1].toLowerCase();for(var N in I=="normal"||I=="italic"||I=="oblique"?(l=I,b.pop(),I=b[b.length-1].toLowerCase()):hw.test(I)&&(I=I.replace(hw,""),l=b[b.length-1].replace(I,"")),uw){var D=b.length>1?b[b.length-2].toLowerCase():"";if(I==N||I==N.replace("-","")||D+"-"+I==N){o=uw[N],b.pop(),D&&N.startsWith(D)&&b.pop();break}}typeof I=="number"&&(o=I);var j=b.join(yd).replace("Klokantech Noto Sans","Noto Sans");j.indexOf(yd)!==-1&&(j='"'+j+'"'),f.push(j)}e=pw[s]=[l,o,f]}return e[0]+yd+e[1]+yd+i+"px"+(t?"/"+t:"")+yd+e[2]},fw="https://api.mapbox.com";function qv(s){var i="mapbox://";return s.indexOf(i)!==0?"":s.slice(i.length)}function dw(s,i){var t=qv(s);if(!t)return decodeURI(new URL(s,location.href).href);var e="styles/";if(t.indexOf(e)!==0)throw new Error("unexpected style url: "+s);var o=t.slice(e.length);return fw+"/styles/v1/"+o+"?&access_token="+i}function Kg(s,i,t,e){var o=new URL(s,e),l=qv(s);return l?"https://{a-d}.tiles.mapbox.com/v4/"+l+"/{z}/{x}/{y}.vector.pbf?access_token="+i:(i&&o.searchParams.set(t,i),decodeURI(o.href))}function Hv(s){return s*Math.PI/180}var gw=function(){for(var s=[],i=78271.51696402048;s.length<=24;i/=2)s.push(i);return s}();function mw(s,i){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(s,i);var t=document.createElement("canvas");return t.width=s,t.height=i,t}var vd={};function Jg(s,i,t){if(t===void 0&&(t={}),i in vd)return vd[i];var e=t.transformRequest&&t.transformRequest(i,s)||new Request(i);e.headers.get("Accept")||e.headers.set("Accept","application/json");var o=fetch(e).then(function(l){return delete vd[i],l.ok?l.json():Promise.reject(new Error("Error fetching source "+i))}).catch(function(l){return delete vd[i],Promise.reject(new Error("Error fetching source "+i))});return vd[i]=o,o}function yw(s,i){if(typeof s!="string")return Promise.resolve(s);if(!s.trim().startsWith("{"))return Jg("Style",s=dw(s,i.accessToken),i);try{var t=JSON.parse(s);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}var vw={};function K2(s,i,t){t===void 0&&(t={});var e=[i,JSON.stringify(s)].toString(),o=vw[e];if(!o||t.transformRequest){var l=s.url;if(l){var f=Kg(l,t.accessToken,t.accessTokenParam||"access_token",i||location.href);o=l.startsWith("mapbox://")?Promise.resolve(Vt({},s,{url:void 0,tiles:f})):Jg("Source",f,t).then(function(y){for(var w=0,b=y.tiles.length;w<b;++w){var I=y.tiles[w];if(t.transformRequest){var N=t.transformRequest(f,"Source");N&&(f=N.url)}var D=Kg(I,t.accessToken,t.accessTokenParam||"access_token",f);if(t.transformRequest){var j=t.transformRequest(D,"Tiles");j instanceof Request&&(D=decodeURI(j.url))}y.tiles[w]=D}return Promise.resolve(y)})}else s=Vt({},s,{tiles:s.tiles.map(function(y){return Kg(y,t.accessToken,t.accessTokenParam||"access_token",i||location.href)})}),o=Promise.resolve(Vt({},s));vw[e]=o}return o}var Xv,J2=Array(256).join("\u200A");function Wv(s,i){if(i>=.05){for(var t="",e=s.split(`
`),o=J2.slice(0,Math.round(i/.1)),l=0,f=e.length;l<f;++l)l>0&&(t+=`
`),t+=e[l].split("").join(o);return t}return s}function _w(){return Xv||(Xv=mw(1,1).getContext("2d")),Xv}function Nh(s,i){return _w().measureText(s).width+(s.length-1)*i}var xw={};function Yv(s,i,t,e){if(s.indexOf(`
`)!==-1){for(var o=s.split(`
`),l=[],f=0,y=o.length;f<y;++f)l.push(Yv(o[f],i,t,e));return l.join(`
`)}var w=t+","+i+","+s+","+e,b=xw[w];if(!b){var I=s.split(" ");if(I.length>1){var N=_w();N.font=i;for(var D=N.measureText("M").width*t,j="",H=[],Z=0,it=I.length;Z<it;++Z){var at=I[Z],wt=j+(j?" ":"")+at;Nh(wt,e)<=D?j=wt:(j&&H.push(j),j=at)}j&&H.push(j);for(var gt=0,yt=H.length;gt<yt&&yt>1;++gt){var It=H[gt];if(Nh(It,e)<.35*D){var Rt=gt>0?Nh(H[gt-1],e):1/0,kt=gt<yt-1?Nh(H[gt+1],e):1/0;H.splice(gt,1),yt-=1,Rt<kt?(H[gt-1]+=" "+It,gt-=1):H[gt]=It+" "+H[gt]}}for(var Dt=0,Xt=H.length-1;Dt<Xt;++Dt){var ee=H[Dt],pe=H[Dt+1];if(Nh(ee,e)>.7*D&&Nh(pe,e)<.6*D){var xe=ee.split(" "),fe=xe.pop();Nh(fe,e)<.2*D&&(H[Dt]=xe.join(" "),H[Dt+1]=fe+" "+pe),Xt-=1}}b=H.join(`
`)}else b=s;b=Wv(b,e),xw[w]=b}return b}var Qg,Q2=/font-family: ?([^;]*);/,tI=/("|')/g;function eI(s){if(!Qg){Qg={};for(var i=document.styleSheets,t=0,e=i.length;t<e;++t){var o=i[t];try{var l=o.rules||o.cssRules;if(l)for(var f=0,y=l.length;f<y;++f){var w=l[f];if(w.type==5){var b=w.cssText.match(Q2);Qg[b[1].replace(tI,"")]=!0}}}catch{}}}return s in Qg}var Zv={};function rI(s){var i=s.toString();if(i in Zv)return Zv[i];for(var t=[],e=0,o=s.length;e<o;++e){s[e]=s[e].replace("Arial Unicode MS","Arial");var l=s[e],f=Uv(l,1);fo(f);var y=f.split(" ");t.push([y.slice(3).join(" ").replace(/"/g,""),y[1],y[0]])}for(var w=0,b=t.length;w<b;++w){var I=t[w],N=I[0];if(!eI(N)&&da.get(I[2]+`
`+I[1]+` 
`+N)!==100){var D="https://fonts.googleapis.com/css?family="+N.replace(/ /g,"+")+":"+I[1]+I[2];if(!document.querySelector('link[href="'+D+'"]')){var j=document.createElement("link");j.href=D,j.rel="stylesheet",document.head.appendChild(j)}}}return Zv[i]=s,s}var $v,Kv,iI={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},nI={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},Jv={},tm={zoom:0};function di(s,i,t,e,o,l,f){var y=s.id;l||(l={},console.warn("No functionCache provided to getValue()")),l[y]||(l[y]={});var w,b=l[y];if(!b[t]){var I=(s[i]||Jv)[t],N=iw[i+"_"+s.type][t];I===void 0&&(I=N.default);var D=(w=I,Array.isArray(w)&&w.length>0&&typeof w[0]=="string"&&w[0]in kv);if(!D&&rw(I)&&(I=S2(I,N),D=!0),D){var j=function(H,Z){var it=H2(H,Z);if(it.result==="error")throw new Error(it.value.map(function(at){return at.key+": "+at.message}).join(", "));return it.value}(I,N);b[t]=j.evaluate.bind(j)}else N.type=="color"&&(I=kn.parse(I)),b[t]=function(){return I}}return tm.zoom=e,b[t](tm,o,f)}function oI(s,i,t,e){return di(s,"layout","icon-allow-overlap",i,t,e)?di(s,"layout","icon-ignore-placement",i,t,e)?"none":"obstacle":"declutter"}function sI(s,i,t,e,o){return o||console.warn("No filterCache provided to evaluateFilter()"),s in o||(o[s]=X2(i).filter),tm.zoom=e,o[s](tm,t)}var aI=!1;function Nu(s,i){if(s){if(!aI&&(s.a===0||i===0))return;var t=s.a;return i=i===void 0?1:i,t===0?"transparent":"rgba("+Math.round(255*s.r/t)+","+Math.round(255*s.g/t)+","+Math.round(255*s.b/t)+","+t*i+")"}return s}var lI=/^([^]*)\{(.*)\}([^]*)$/;function Qv(s,i){var t;do if(t=s.match(lI)){var e=i[t[2]]||"";s=t[1]+e+t[3]}while(t);return s}var cI=!1;function uI(s,i,t,e,o,l,f){if(e===void 0&&(e=gw),o===void 0&&(o=void 0),l===void 0&&(l=void 0),f===void 0&&(f=void 0),typeof i=="string"&&(i=JSON.parse(i)),i.version!=8)throw new Error("glStyle version 8 required.");var y,w;if(l){if(typeof Image<"u"){var b=new Image;b.crossOrigin="anonymous",b.onload=function(){y=b,w=[b.width,b.height],s.changed(),b.onload=null},b.src=l}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){var I=self;I.postMessage({action:"loadImage",src:l}),I.addEventListener("message",function(qe){qe.data.action==="imageLoaded"&&qe.data.src===l&&(y=qe.data.image,w=[y.width,y.height])})}}for(var N,D=function(qe){qe=qe.slice();for(var Ge=Object.create(null),Qe=0;Qe<qe.length;Qe++)Ge[qe[Qe].id]=qe[Qe];for(var ir=0;ir<qe.length;ir++)"ref"in qe[ir]&&(qe[ir]=$2(qe[ir],Ge[qe[ir].ref]));return qe}(i.layers),j={},H=[],Z={},it={},at={},wt={},gt=0,yt=D.length;gt<yt;++gt){var It=D[gt],Rt=It.id;if(typeof t=="string"&&It.source==t||t.indexOf(Rt)!==-1){var kt=It["source-layer"];if(N){if(It.source!==N)throw new Error('Layer "'+Rt+'" does not use source "'+N)}else{N=It.source;var Dt=i.sources[N];if(!Dt)throw new Error('Source "'+N+'" is not defined');var Xt=Dt.type;if(Xt!=="vector"&&Xt!=="geojson")throw new Error('Source "'+N+'" is not of type "vector" or "geojson", but "'+Xt+'"')}var ee=j[kt];ee||(ee=[],j[kt]=ee),ee.push({layer:It,index:gt}),H.push(Rt)}}var pe=new Fs,xe=new Zs,fe=[],Re=function(qe,Ge){var Qe=qe.getProperties(),ir=j[Qe.layer];if(ir){var de=e.indexOf(Ge);de==-1&&(de=function(Ho,ra){for(var Bc=0,sf=ra.length;Bc<sf;++Bc)if(ra[Bc]<Ho&&Bc+1<sf){var Rd=ra[Bc]/ra[Bc+1];return Bc+Math.log(ra[Bc]/Ho)/Math.log(Rd)}return sf-1}(Ge,e));for(var Nr,Pr=iI[qe.getGeometry().getType()],he={properties:Qe,type:Pr},$e=s.get("mapbox-featurestate")[qe.getId()],or=-1,fi=0,ki=ir.length;fi<ki;++fi){var Sn=ir[fi],tr=Sn.layer,Jn=tr.id,Vo=tr.layout||Jv,Hn=tr.paint||Jv;if(!(Vo.visibility==="none"||"minzoom"in tr&&de<tr.minzoom||"maxzoom"in tr&&de>=tr.maxzoom)){var _a=tr.filter;if(!_a||sI(Jn,_a,he,de,wt)){Nr=tr;var Uo=void 0,ys=void 0,Ya=void 0,ss=void 0,qo=void 0,yr=void 0,ta=Sn.index;if(Pr==3&&(tr.type=="fill"||tr.type=="fill-extrusion"))if(ys=di(tr,"paint",tr.type+"-opacity",de,he,at,$e),tr.type+"-pattern"in Hn){var Za=di(tr,"paint",tr.type+"-pattern",de,he,at,$e);if(Za){var xl=typeof Za=="string"?Qv(Za,Qe):Za.toString();if(y&&o&&o[xl]){++or,(yr=fe[or])&&yr.getFill()&&!yr.getStroke()&&!yr.getText()||(yr=new ds({fill:new Zs}),fe[or]=yr),Ya=yr.getFill(),yr.setZIndex(ta);var $a=xl+"."+ys,Nc=it[$a];if(!Nc){var xa=o[xl],ju=mw(xa.width,xa.height),ic=ju.getContext("2d");ic.globalAlpha=ys,ic.drawImage(y,xa.x,xa.y,xa.width,xa.height,0,0,xa.width,xa.height),Nc=ic.createPattern(ju,"repeat"),it[$a]=Nc}Ya.setColor(Nc)}}}else Uo=Nu(di(tr,"paint",tr.type+"-color",de,he,at,$e),ys),tr.type+"-outline-color"in Hn&&(qo=Nu(di(tr,"paint",tr.type+"-outline-color",de,he,at,$e),ys)),qo||(qo=Uo),(Uo||qo)&&(++or,(!(yr=fe[or])||Uo&&!yr.getFill()||!Uo&&yr.getFill()||qo&&!yr.getStroke()||!qo&&yr.getStroke()||yr.getText())&&(yr=new ds({fill:Uo?new Zs:void 0,stroke:qo?new Fs:void 0}),fe[or]=yr),Uo&&(Ya=yr.getFill()).setColor(Uo),qo&&((ss=yr.getStroke()).setColor(qo),ss.setWidth(.5)),yr.setZIndex(ta));if(Pr!=1&&tr.type=="line"){Uo=!("line-pattern"in Hn)&&"line-color"in Hn?Nu(di(tr,"paint","line-color",de,he,at,$e),di(tr,"paint","line-opacity",de,he,at,$e)):void 0;var nc=di(tr,"paint","line-width",de,he,at,$e);Uo&&nc>0&&(++or,(yr=fe[or])&&yr.getStroke()&&!yr.getFill()&&!yr.getText()||(yr=new ds({stroke:new Fs}),fe[or]=yr),(ss=yr.getStroke()).setLineCap(di(tr,"layout","line-cap",de,he,at,$e)),ss.setLineJoin(di(tr,"layout","line-join",de,he,at,$e)),ss.setMiterLimit(di(tr,"layout","line-miter-limit",de,he,at,$e)),ss.setColor(Uo),ss.setWidth(nc),ss.setLineDash(Hn["line-dasharray"]?di(tr,"paint","line-dasharray",de,he,at,$e).map(function(Ho){return Ho*nc}):null),yr.setZIndex(ta))}var Bs=!1,Fn=null,Bu=0,wa=void 0,So=void 0,oc=void 0;if((Pr==1||Pr==2)&&"icon-image"in Vo){var Ro=di(tr,"layout","icon-image",de,he,at,$e);if(Ro){wa=typeof Ro=="string"?Qv(Ro,Qe):Ro.toString();var Qp=void 0;if(y&&o&&o[wa]){var tf=di(tr,"layout","icon-rotation-alignment",de,he,at,$e);if(Pr==2){var sc=qe.getGeometry();if(sc.getFlatMidpoint||sc.getFlatMidpoints){var ef=sc.getExtent();if(Math.sqrt(Math.max(Math.pow((ef[2]-ef[0])/Ge,2),Math.pow((ef[3]-ef[1])/Ge,2)))>150){var Rc=sc.getType()==="MultiLineString"?sc.getFlatMidpoints():sc.getFlatMidpoint();if(Kv||(Kv=new Og("Point",$v=[NaN,NaN],[],{},null)),Qp=Kv,$v[0]=Rc[0],$v[1]=Rc[1],di(tr,"layout","symbol-placement",de,he,at,$e)==="line"&&tf==="map")for(var Uh=sc.getStride(),kc=sc.getFlatCoordinates(),Fc=0,Id=kc.length-Uh;Fc<Id;Fc+=Uh){var Dc=kc[Fc],Gc=kc[Fc+1],jc=kc[Fc+Uh],rf=kc[Fc+Uh+1],Nm=Math.min(Dc,jc),j0=Math.min(Gc,rf),qh=Math.max(Dc,jc),Hh=Math.max(Gc,rf);if(Rc[0]>=Nm&&Rc[0]<=qh&&Rc[1]>=j0&&Rc[1]<=Hh){Bu=Math.atan2(Gc-rf,jc-Dc);break}}}}}if(Pr!==2||Qp){var wl=di(tr,"layout","icon-size",de,he,at,$e),ea=Hn["icon-color"]!==void 0?di(tr,"paint","icon-color",de,he,at,$e):null;if(!ea||ea.a!==0){var zu=wa+"."+wl;if(ea!==null&&(zu+="."+ea),!(So=Z[zu])){var Eo=o[wa],Ka=oI(tr,de,he,at);So=new Hf({color:ea?[255*ea.r,255*ea.g,255*ea.b,ea.a]:void 0,img:y,imgSize:w,size:[Eo.width,Eo.height],offset:[Eo.x,Eo.y],rotateWithView:tf==="map",scale:wl/Eo.pixelRatio,displacement:"icon-offset"in Vo?di(tr,"layout","icon-offset",de,he,at,$e).map(function(Ho){return-Ho*Eo.pixelRatio}):void 0,declutterMode:Ka}),Z[zu]=So}}So&&(++or,(yr=fe[or])&&yr.getImage()&&!yr.getFill()&&!yr.getStroke()||(yr=new ds,fe[or]=yr),yr.setGeometry(Qp),So.setRotation(Bu+Hv(di(tr,"layout","icon-rotate",de,he,at,$e))),So.setOpacity(di(tr,"paint","icon-opacity",de,he,at,$e)),So.setAnchor(nI[di(tr,"layout","icon-anchor",de,he,at,$e)]),yr.setImage(So),Fn=yr.getText(),yr.setText(void 0),yr.setZIndex(ta),Bs=!0,oc=!1)}else oc=!0}}}if(Pr==1&&tr.type==="circle"){++or,(yr=fe[or])&&yr.getImage()&&!yr.getFill()&&!yr.getStroke()||(yr=new ds,fe[or]=yr);var Ja="circle-radius"in Hn?di(tr,"paint","circle-radius",de,he,at,$e):5,Xh=Nu(di(tr,"paint","circle-stroke-color",de,he,at,$e),di(tr,"paint","circle-stroke-opacity",de,he,at,$e)),Md=Nu(di(tr,"paint","circle-color",de,he,at,$e),di(tr,"paint","circle-opacity",de,he,at,$e)),nf=di(tr,"paint","circle-stroke-width",de,he,at,$e),QS=Ja+"."+Xh+"."+Md+"."+nf;(So=Z[QS])||(So=new wg({radius:Ja,stroke:Xh&&nf>0?new Fs({width:nf,color:Xh}):void 0,fill:Md?new Zs({color:Md}):void 0,declutterMode:"none"}),Z[QS]=So),yr.setImage(So),Fn=yr.getText(),yr.setText(void 0),yr.setGeometry(void 0),yr.setZIndex(ta),Bs=!0}var zs=void 0,Rm=void 0,Ld=void 0,Vu=void 0,Ad=void 0,B0=void 0;if("text-field"in Vo){Vu=Math.round(di(tr,"layout","text-size",de,he,at,$e));var z0=di(tr,"layout","text-font",de,he,at,$e);Ld=di(tr,"layout","text-line-height",de,he,at,$e),(Rm=Uv(f?f(z0):z0,Vu,Ld)).includes("sans-serif")||(Rm+=",sans-serif"),Ad=di(tr,"layout","text-letter-spacing",de,he,at,$e),B0=di(tr,"layout","text-max-width",de,he,at,$e);var of=di(tr,"layout","text-field",de,he,at,$e);zs=typeof of=="object"&&of.sections?of.sections.length===1?of.toString():of.sections.reduce(function(Ho,ra,Bc){var sf=ra.fontStack?ra.fontStack.split(","):z0,Rd=Uv(f?f(sf):sf,Vu*(ra.scale||1),Ld),kd=ra.text;if(kd===`
`)return Ho.push(`
`,""),Ho;if(Pr!=2){for(var Fm=0,dN=(kd=Yv(kd,Rd,B0,Ad).split(`
`)).length;Fm<dN;++Fm)Fm>0&&Ho.push(`
`,""),Ho.push(kd[Fm],Rd);return Ho}Ho.push(Wv(kd,Ad),Rd)},[]):Qv(of,Qe).trim(),ys=di(tr,"paint","text-opacity",de,he,at,$e)}if(zs&&ys&&!oc){Bs||(++or,(yr=fe[or])&&yr.getText()&&!yr.getFill()&&!yr.getStroke()||(yr=new ds,fe[or]=yr),yr.setImage(void 0),yr.setGeometry(void 0)),yr.getText()||yr.setText(Fn||new Ip({padding:[2,2,2,2]})),Fn=yr.getText();var tE=Vo["text-transform"];tE=="uppercase"?zs=Array.isArray(zs)?zs.map(function(Ho,ra){return ra%2?Ho:Ho.toUpperCase()}):zs.toUpperCase():tE=="lowercase"&&(zs=Array.isArray(zs)?zs.map(function(Ho,ra){return ra%2?Ho:Ho.toLowerCase()}):zs.toLowerCase());var eE=Array.isArray(zs)?zs:Pr==2?Wv(zs,Ad):Yv(zs,Rm,B0,Ad);Fn.setText(eE),Fn.setFont(Rm),Fn.setRotation(Hv(di(tr,"layout","text-rotate",de,he,at,$e)));var km=di(tr,"layout","text-anchor",de,he,at,$e),V0=Bs||Pr==1?"point":di(tr,"layout","symbol-placement",de,he,at,$e);Fn.setPlacement(V0),Fn.setOverflow(V0==="point");var Wh=di(tr,"paint","text-halo-width",de,he,at,$e),rE=di(tr,"layout","text-offset",de,he,at,$e),iE=di(tr,"paint","text-translate",de,he,at,$e),U0=0,q0=0;if(V0=="point"){var H0="center";km.indexOf("left")!==-1?(H0="left",q0=Wh):km.indexOf("right")!==-1&&(H0="right",q0=-Wh),Fn.setTextAlign(H0);var fN=di(tr,"layout","text-rotation-alignment",de,he,at,$e);Fn.setRotateWithView(fN=="map")}else Fn.setMaxAngle(Hv(di(tr,"layout","text-max-angle",de,he,at,$e))*zs.length/eE.length),Fn.setTextAlign(),Fn.setRotateWithView(!1);var X0="middle";km.indexOf("bottom")==0?(X0="bottom",U0=-Wh-.5*(Ld-1)*Vu):km.indexOf("top")==0&&(X0="top",U0=Wh+.5*(Ld-1)*Vu),Fn.setTextBaseline(X0),Fn.setOffsetX(rE[0]*Vu+q0+iE[0]),Fn.setOffsetY(rE[1]*Vu+U0+iE[1]),xe.setColor(Nu(di(tr,"paint","text-color",de,he,at,$e),ys)),Fn.setFill(xe);var nE=Nu(di(tr,"paint","text-halo-color",de,he,at,$e),ys);if(nE){pe.setColor(nE),Wh*=2;var oE=.5*Vu;pe.setWidth(Wh<=oE?Wh:oE),Fn.setStroke(pe)}else Fn.setStroke(void 0);var Od=di(tr,"layout","text-padding",de,he,at,$e),Nd=Fn.getPadding();Od!==Nd[0]&&(Nd[0]=Od,Nd[1]=Od,Nd[2]=Od,Nd[3]=Od),yr.setZIndex(ta)}}}}return or>-1?(fe.length=or+1,cI&&(typeof qe.set=="function"?qe.set("mapbox-layer",Nr):qe.getProperties()["mapbox-layer"]=Nr),fe):void 0}};return s.setStyle(Re),s.set("mapbox-source",N),s.set("mapbox-layers",H),s.set("mapbox-featurestate",{}),Re}function hI(s,i){return i.accessToken||(i=Vt({},i),new URL(s).searchParams.forEach(function(t,e){i.accessToken=t,i.accessTokenParam=e})),i}function pI(s,i,t,e,o){var l,f,y;return t===void 0&&(t=""),e===void 0&&(e={}),o===void 0&&(o=void 0),typeof e=="string"?(l=e,y={}):(l=e.styleUrl,y=e),o||(o=y.resolutions),l||typeof i!="string"||i.trim().startsWith("{")||(l=i),l&&(l=l.startsWith("data:")?location.href:dw(l,y.accessToken),y=hI(l,y)),new Promise(function(w,b){yw(i,y).then(function(I){if(I.version!=8)return b(new Error("glStyle version 8 required."));if(!(s instanceof wu||s instanceof ld))return b(new Error("Can only apply to VectorLayer or VectorTileLayer"));var N,D,j,H=s instanceof ld?"vector":"geojson";if(t?f=Array.isArray(t)?I.layers.find(function(yt){return yt.id===t[0]}).source:t:(f=Object.keys(I.sources).find(function(yt){return I.sources[yt].type===H}),t=f),!f)return b(new Error("No "+H+" source found in the glStyle."));function Z(){if(s instanceof ld)return gI(I.sources[f],l,y).then(function(kt){var Dt=s.getSource();if(Dt?kt!==Dt&&(Dt.setTileUrlFunction(kt.getTileUrlFunction()),Dt.ze||(Dt.ze=kt.ze),Dt.getAttributions()||Dt.setAttributions(kt.getAttributions()),Dt.getTileLoadFunction()===Hy&&Dt.setTileLoadFunction(kt.getTileLoadFunction()),an(Dt.getProjection(),kt.getProjection())&&(Dt.tileGrid=kt.getTileGrid())):s.setSource(kt),!isFinite(s.getMaxResolution())&&!isFinite(s.getMinZoom())){var Xt=s.getSource().getTileGrid();s.setMaxResolution(Xt.getResolution(Xt.getMinZoom()))}});var yt=I.sources[f],It=s.getSource();It&&It.get("mapbox-source")===yt||(It=mI(yt,l,y));var Rt=s.getSource();return Rt?It!==Rt&&(Rt.getAttributions()||Rt.setAttributions(It.getAttributions()),Rt.ze||(Rt.ze=It.getFormat()),Rt.Fe=It.getUrl()):s.setSource(It),Promise.resolve()}function it(){j||I.sprite&&!N?j?(s.setStyle(j),Z().then(w).catch(b)):b(new Error("Something went wrong trying to apply style.")):(j=uI(s,I,t,o,N,D,rI),s.getStyle()?Z().then(w).catch(b):b(new Error("Nothing to show for source ["+f+"]")))}if(I.sprite){var at=new URL(function(yt,It,Rt){var kt=qv(yt);if(!kt)return decodeURI(new URL(yt,Rt).href);var Dt="sprites/";if(kt.indexOf(Dt)!==0)throw new Error("unexpected sprites url: "+yt);var Xt=kt.slice(Dt.length);return fw+"/styles/v1/"+Xt+"/sprite?access_token="+It}(I.sprite,y.accessToken,l||location.href)),wt=(window.devicePixelRatio>=1.5?.5:1)==.5?"@2x":"",gt=at.origin+at.pathname+wt+".json"+at.search;new Promise(function(yt,It){Jg("Sprite",gt,y).then(yt).catch(function(Rt){Jg("Sprite",gt=at.origin+at.pathname+".json"+at.search,y).then(yt).catch(It)})}).then(function(yt){yt===void 0&&b(new Error("No sprites found.")),N=yt,D=at.origin+at.pathname+wt+".png"+at.search,it()}).catch(function(yt){b(new Error("Sprites cannot be loaded: "+gt+": "+yt.message))})}else it()}).catch(b)})}var ww={};function fI(s,i){var t={id:i.id,type:i.type},e={};function o(l){var f=i.layout||{},y=i.paint||{};t.paint=y;var w,b,I=typeof s.getSource=="function"?s.getSource().getTileGrid().getZForResolution(l):s.getView().getZoom(),N=typeof s.getTargetElement=="function"?s.getTargetElement():void 0;if(y["background-color"]!==void 0&&(w=di(t,"paint","background-color",I,ww,e),N&&(N.style.background=kn.parse(w).toString())),y["background-opacity"]!==void 0&&(b=di(t,"paint","background-opacity",I,ww,e),N&&(N.style.opacity=b)),f.visibility!="none")return Nu(w,b);N&&(N.style.backgroundColor="",N.style.opacity="")}if(typeof s.getTargetElement=="function")s.getTargetElement()&&o(),s.on(["change:resolution","change:target"],o);else{if(typeof s.setBackground!="function")throw new Error("Unable to apply background.");s.setBackground(o)}}function bw(s,i){i.layers.some(function(t){if(t.type==="background")return fI(s,t),!0})}function dI(s){var i=s.bounds;if(i){var t=jr([i[0],i[1]]),e=jr([i[2],i[3]]);return[t[0],t[1],e[0],e[1]]}}function gI(s,i,t){return new Promise(function(e,o){K2(s,i,t).then(function(l){var f=new hx({tileJSON:l}),y=f.getTileJSON(),w=f.getTileGrid(),b=dI(y),I=y.minzoom||0,N=y.maxzoom||22,D={attributions:f.getAttributions(),format:new hv,tileGrid:new ql({origin:w.getOrigin(0),extent:b||w.getExtent(),minZoom:I,resolutions:gw.slice(0,N+1),tileSize:512})};Array.isArray(y.tiles)?D.urls=y.tiles:D.url=y.tiles,l.olSourceOptions&&Object.assign(D,l.olSourceOptions),e(new Tg(D))}).catch(o)})}var Sw=new Rx;function mI(s,i,t){var e=s.data,o={};if(typeof e=="string"){var l=Kg(e,t.accessToken,t.accessTokenParam||"access_token",i||location.href);if(t.transformRequest){var f=t.transformRequest(l,"GeoJSON");f instanceof Request&&(l=encodeURI(f.url))}o.url=l}else o.features=Sw.readFeatures(e,{featureProjection:wo()||"EPSG:3857"});var y=new du(Vt({attributions:s.attribution,format:Sw},o));return y.set("mapbox-source",s),y}var Ew=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),yI=function(s){function i(t){var e=s.call(this,dr)||this;return e.error=t,e}return Ew(i,s),i}(O),vI=function(s){function i(t){var e=this,o=!("declutter"in t)||t.declutter,l=new Tg({state:"loading",format:new hv});e=s.call(this,{source:l,background:t.background,declutter:o,className:t.className,opacity:t.opacity,visible:t.visible,zIndex:t.zIndex,minResolution:t.minResolution,maxResolution:t.maxResolution,minZoom:t.minZoom,maxZoom:t.maxZoom,renderOrder:t.renderOrder,renderBuffer:t.renderBuffer,renderMode:t.renderMode,map:t.map,updateWhileAnimating:t.updateWhileAnimating,updateWhileInteracting:t.updateWhileInteracting,preload:t.preload,useInterimTilesOnError:t.useInterimTilesOnError,properties:t.properties})||this,t.accessToken&&(e.accessToken=t.accessToken);var f=t.styleUrl;return pI(e,f,t.layers||t.source,{accessToken:e.accessToken}).then(function(){l.setState("ready")}).catch(function(y){e.dispatchEvent(new yI(y)),e.getSource().setState("error")}),e.getBackground()===void 0&&function(y,w,b){b===void 0&&(b={}),typeof w=="object"?(bw(y,w),Promise.resolve()):yw(w,b).then(function(I){bw(y,I)})}(e,t.styleUrl,{accessToken:e.accessToken}),e}return Ew(i,s),i}(ld),_I=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),xI=function(s){function i(t){var e=this,o=t||{},l=Vt({},o);return delete l.imageRatio,(e=s.call(this,l)||this).lv=o.imageRatio!==void 0?o.imageRatio:1,e}return _I(i,s),i.prototype.getImageRatio=function(){return this.lv},i.prototype.createRenderer=function(){return new Ex(this)},i}(kp),wI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),bI=function(s){function i(t){var e=this,o=Vt({},t);return(e=s.call(this,o)||this).vv=y_(t.style),e.dv=t.style.variables||{},e.pv=!!t.disableHitDetection,e}return wI(i,s),i.prototype.createRenderer=function(){return new tv(this,{vertexShader:this.vv.builder.getSymbolVertexShader(),fragmentShader:this.vv.builder.getSymbolFragmentShader(),hitVertexShader:!this.pv&&this.vv.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.pv&&this.vv.builder.getSymbolFragmentShader(!0),uniforms:this.vv.uniforms,attributes:this.vv.attributes})},i.prototype.updateStyleVariables=function(t){Vt(this.dv,t),this.changed()},i}(pa),SI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Cw(s,i){var t=`
    attribute vec2 `.concat(Gf.TEXTURE_COORD,`;
    uniform mat4 `).concat(Ci.TILE_TRANSFORM,`;
    uniform float `).concat(Ci.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(Ci.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(Ci.TEXTURE_RESOLUTION,`;
    uniform float `).concat(Ci.TEXTURE_ORIGIN_X,`;
    uniform float `).concat(Ci.TEXTURE_ORIGIN_Y,`;
    uniform float `).concat(Ci.DEPTH,`;

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = `).concat(Gf.TEXTURE_COORD,`;
      v_mapCoord = vec2(
        `).concat(Ci.TEXTURE_ORIGIN_X," + ").concat(Ci.TEXTURE_RESOLUTION," * ").concat(Ci.TEXTURE_PIXEL_WIDTH,` * v_textureCoord[0],
        `).concat(Ci.TEXTURE_ORIGIN_Y," - ").concat(Ci.TEXTURE_RESOLUTION," * ").concat(Ci.TEXTURE_PIXEL_HEIGHT,` * v_textureCoord[1]
      );
      gl_Position = `).concat(Ci.TILE_TRANSFORM," * vec4(").concat(Gf.TEXTURE_COORD,", ").concat(Ci.DEPTH,`, 1.0);
    }
  `),e={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:i},o=[];if(s.color!==void 0){var l=Tr(e,s.color,Wl);o.push("color = ".concat(l,";"))}if(s.contrast!==void 0){var f=Tr(e,s.contrast,_n);o.push("color.rgb = clamp((".concat(f," + 1.0) * color.rgb - (").concat(f," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(s.exposure!==void 0){var y=Tr(e,s.exposure,_n);o.push("color.rgb = clamp((".concat(y," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(s.saturation!==void 0){var w=Tr(e,s.saturation,_n);o.push(`
      float saturation = `.concat(w,` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `))}if(s.gamma!==void 0){var b=Tr(e,s.gamma,_n);o.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(b,"));"))}if(s.brightness!==void 0){var I=Tr(e,s.brightness,_n);o.push("color.rgb = clamp(color.rgb + ".concat(I,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var N={},D=e.variables.length;if(D>1&&!s.variables)throw new Error("Missing variables in style (expected ".concat(e.variables,")"));for(var j=function(wt){var gt=e.variables[wt];if(!(gt in s.variables))throw new Error("Missing '".concat(gt,"' in style variables"));var yt=xg(gt);N[yt]=function(){var It=s.variables[gt];return typeof It=="string"&&(It=zf(e,It)),It!==void 0?It:-9999999}},H=0;H<D;++H)j(H);var Z=Object.keys(N).map(function(wt){return"uniform float ".concat(wt,";")}),it=Math.ceil(i/4);Z.push("uniform sampler2D ".concat(Ci.TILE_TEXTURE_ARRAY,"[").concat(it,"];")),e.paletteTextures&&Z.push("uniform sampler2D ".concat(Ey,"[").concat(e.paletteTextures.length,"];"));var at=Object.keys(e.functions).map(function(wt){return e.functions[wt]});return{vertexShader:t,fragmentShader:`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 `.concat(Ci.RENDER_EXTENT,`;
    uniform float `).concat(Ci.TRANSITION_ALPHA,`;
    uniform float `).concat(Ci.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(Ci.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(Ci.RESOLUTION,`;
    uniform float `).concat(Ci.ZOOM,`;

    `).concat(Z.join(`
`),`

    `).concat(at.join(`
`),`

    void main() {
      if (
        v_mapCoord[0] < `).concat(Ci.RENDER_EXTENT,`[0] ||
        v_mapCoord[1] < `).concat(Ci.RENDER_EXTENT,`[1] ||
        v_mapCoord[0] > `).concat(Ci.RENDER_EXTENT,`[2] ||
        v_mapCoord[1] > `).concat(Ci.RENDER_EXTENT,`[3]
      ) {
        discard;
      }

      vec4 color = texture2D(`).concat(Ci.TILE_TEXTURE_ARRAY,`[0],  v_textureCoord);

      `).concat(o.join(`
`),`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `).concat(Ci.TRANSITION_ALPHA,`;
    }`),uniforms:N,paletteTextures:e.paletteTextures}}var Tw=function(s){function i(t){var e=this,o=t?Vt({},t):{},l=o.style||{};delete o.style;var f=o.cacheSize;return delete o.cacheSize,(e=s.call(this,o)||this).yv=o.sources,e.mv=null,e.Ic=NaN,e.H=l,e.Jt=f,e.dv=e.H.variables||{},e.addChangeListener(ll,e.wv),e}return SI(i,s),i.prototype.getSources=function(t,e){var o=this.getSource();return this.yv?typeof this.yv=="function"?this.yv(t,e):this.yv:o?[o]:[]},i.prototype.getRenderSource=function(){return this.mv||this.getSource()},i.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():"undefined"},i.prototype.wv=function(){this.getSource()&&this.setStyle(this.H)},i.prototype.gv=function(){var t=Number.MAX_SAFE_INTEGER,e=this.getSources([-t,-t,t,t],t);return e&&e.length&&"bandCount"in e[0]?e[0].bandCount:4},i.prototype.createRenderer=function(){var t=Cw(this.H,this.gv());return new s_(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.Jt,paletteTextures:t.paletteTextures})},i.prototype.renderSources=function(t,e){for(var o,l=this.getRenderer(),f=0,y=e.length;f<y;++f)this.mv=e[f],l.prepareFrame(t)&&(o=l.renderFrame(t));return o},i.prototype.render=function(t,e){var o=this;this.rendered=!0;for(var l=t.viewState,f=this.getSources(t.extent,l.resolution),y=!0,w=function(j,H){var Z=f[j],it=Z.getState();if(it=="loading"){var at=function(){Z.getState()=="ready"&&(Z.removeEventListener("change",at),o.changed())};Z.addEventListener("change",at)}y=y&&it=="ready"},b=0,I=f.length;b<I;++b)w(b);var N=this.renderSources(t,f);if(this.getRenderer().renderComplete&&y)return this.Ic=l.resolution,N;if(this.Ic>.5*l.resolution){var D=this.getSources(t.extent,this.Ic).filter(function(j){return!f.includes(j)});if(D.length>0)return this.renderSources(t,D)}return N},i.prototype.setStyle=function(t){this.dv=t.variables||{},this.H=t;var e=Cw(this.H,this.gv());this.getRenderer().reset({vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,paletteTextures:e.paletteTextures}),this.changed()},i.prototype.updateStyleVariables=function(t){Vt(this.dv,t),this.changed()},i}($y);Tw.prototype.dispose;var EI=Tw,Pw=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),CI="addfeatures",Iw=function(s){function i(t,e,o,l){var f=s.call(this,t)||this;return f.features=o,f.file=e,f.projection=l,f}return Pw(i,s),i}(O),TI=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{handleEvent:rt})||this).on,e.once,e.un,e.bv=!1,e.xv=[];for(var l=o.formatConstructors?o.formatConstructors:[],f=0,y=l.length;f<y;++f){var w=l[f];typeof w=="function"&&(w=new w),e.xv.push(w),e.bv=e.bv||w.getType()==="arraybuffer"}return e.di=o.projection?ie(o.projection):null,e.Mv=null,e._v=o.source||null,e.target=o.target?o.target:null,e}return Pw(i,s),i.prototype.Sv=function(t,e){var o,l=e.target.result,f=this.getMap(),y=this.di;y||(y=f.getView().getProjection());for(var w=this.xv,b=0,I=w.length;b<I;++b){var N=w[b],D=l;this.bv&&N.getType()!=="arraybuffer"&&(o===void 0&&(o=new TextDecoder().decode(l)),D=o);var j=this.Ov(N,D,{featureProjection:y});if(j&&j.length>0){this._v&&(this._v.clear(),this._v.addFeatures(j)),this.dispatchEvent(new Iw(CI,t,j,y));break}}},i.prototype.jv=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.Mv=[Ee(e,De,this.handleDrop,this),Ee(e,Fe,this.handleStop,this),Ee(e,Lr,this.handleStop,this),Ee(e,De,this.handleStop,this)]}},i.prototype.setActive=function(t){!this.getActive()&&t&&this.jv(),this.getActive()&&!t&&this.Ev(),s.prototype.setActive.call(this,t)},i.prototype.setMap=function(t){this.Ev(),s.prototype.setMap.call(this,t),this.getActive()&&this.jv()},i.prototype.Ov=function(t,e,o){try{return t.readFeatures(e,o)}catch{return null}},i.prototype.Ev=function(){this.Mv&&(this.Mv.forEach(Or),this.Mv=null)},i.prototype.handleDrop=function(t){for(var e=t.dataTransfer.files,o=0,l=e.length;o<l;++o){var f=e.item(o),y=new FileReader;y.addEventListener(Ar,this.Sv.bind(this,f)),this.bv?y.readAsArrayBuffer(f):y.readAsText(f)}},i.prototype.handleStop=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},i}(xc),PI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),II=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this,o)||this).Zr=o.condition?o.condition:Of,e.Kr=void 0,e.Tv=void 0,e.je=0,e.Fr=o.duration!==void 0?o.duration:400,e}return PI(i,s),i.prototype.handleDragEvent=function(t){if(mh(t)){var e=t.map,o=e.getSize(),l=t.pixel,f=l[0]-o[0]/2,y=o[1]/2-l[1],w=Math.atan2(y,f),b=Math.sqrt(f*f+y*y),I=e.getView();if(this.Kr!==void 0){var N=this.Kr-w;I.adjustRotationInternal(N)}this.Kr=w,this.Tv!==void 0&&I.adjustResolutionInternal(this.Tv/b),this.Tv!==void 0&&(this.je=this.Tv/b),this.Tv=b}},i.prototype.handleUpEvent=function(t){if(!mh(t))return!0;var e=t.map.getView(),o=this.je>1?1:-1;return e.endInteraction(this.Fr,o),this.je=0,!1},i.prototype.handleDownEvent=function(t){return!!mh(t)&&!!this.Zr(t)&&(t.map.getView().beginInteraction(),this.Kr=void 0,this.Tv=void 0,!0)},i}(ja),MI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Mw=function(s){function i(t,e,o){var l=s.call(this)||this;if(o!==void 0&&e===void 0)l.setFlatCoordinates(o,t);else{var f=e||0;l.setCenterAndRadius(t,f,o)}return l}return MI(i,s),i.prototype.clone=function(){var t=new i(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},i.prototype.closestPointXY=function(t,e,o,l){var f=this.flatCoordinates,y=t-f[0],w=e-f[1],b=y*y+w*w;if(b<l){if(b===0)for(var I=0;I<this.stride;++I)o[I]=f[I];else{var N=this.getRadius()/Math.sqrt(b);for(o[0]=f[0]+N*y,o[1]=f[1]+N*w,I=2;I<this.stride;++I)o[I]=f[I]}return o.length=this.stride,b}return l},i.prototype.containsXY=function(t,e){var o=this.flatCoordinates,l=t-o[0],f=e-o[1];return l*l+f*f<=this.Av()},i.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},i.prototype.computeExtent=function(t){var e=this.flatCoordinates,o=e[this.stride]-e[0];return En(e[0]-o,e[1]-o,e[0]+o,e[1]+o,t)},i.prototype.getRadius=function(){return Math.sqrt(this.Av())},i.prototype.Av=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},i.prototype.getType=function(){return"Circle"},i.prototype.intersectsExtent=function(t){if(on(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||xs(t,this.intersectsCoordinate.bind(this))}return!1},i.prototype.setCenter=function(t){var e=this.stride,o=this.flatCoordinates[e]-this.flatCoordinates[0],l=t.slice();l[e]=l[0]+o;for(var f=1;f<e;++f)l[e+f]=t[f];this.setFlatCoordinates(this.layout,l),this.changed()},i.prototype.setCenterAndRadius=function(t,e,o){this.setLayout(o,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var l=this.flatCoordinates,f=ac(l,0,t,this.stride);l[f++]=l[0]+e;for(var y=1,w=this.stride;y<w;++y)l[f++]=l[y];l.length=f,this.changed()},i.prototype.getCoordinates=function(){return null},i.prototype.setCoordinates=function(t,e){},i.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},i.prototype.rotate=function(t,e){var o=this.getCenter(),l=this.getStride();this.setCenter(Uu(o,0,o.length,l,t,e,o)),this.changed()},i.prototype.translate=function(t,e){var o=this.getCenter(),l=this.getStride();this.setCenter(Ea(o,0,o.length,l,t,e,o)),this.changed()},i}(Cs);Mw.prototype.transform;var t0=Mw,Lw=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Rh="Point",kh="LineString",Xa="Polygon",Fh="Circle",Aw="drawstart",LI="drawend",AI="drawabort",_d=function(s){function i(t,e){var o=s.call(this,t)||this;return o.feature=e,o}return Lw(i,s),i}(O),OI=function(s){function i(t){var e=this,o=t;o.stopDown||(o.stopDown=nt),(e=s.call(this,o)||this).on,e.once,e.un,e.Pv=!1,e.Cv=null,e.kv,e.Iv,e.Nv,e.Lv=!1,e._v=t.source?t.source:null,e.Re=t.features?t.features:null,e.zv=t.snapTolerance?t.snapTolerance:12,e.rl=t.type,e.pe=function(b){switch(b){case"Point":case"MultiPoint":return Rh;case"LineString":case"MultiLineString":return kh;case"Polygon":case"MultiPolygon":return Xa;case"Circle":return Fh;default:throw new Error("Invalid type: "+b)}}(e.rl),e.Rv=!!t.stopClick,e.Fv=t.minPoints?t.minPoints:e.pe===Xa?3:2,e.Gv=e.pe===Fh?2:t.maxPoints?t.maxPoints:1/0,e.Dv=t.finishCondition?t.finishCondition:rt,e.qv=t.geometryLayout?t.geometryLayout:hr;var l,f=t.geometryFunction;if(!f){var y,w=e.pe;w===Fh?f=function(b,I,N){var D=I||new t0([NaN,NaN]),j=$i(b[0],N),H=mi(j,$i(b[b.length-1],N));D.setCenterAndRadius(j,Math.sqrt(H),this.qv);var Z=wo();return Z&&D.transform(N,Z),D}:(w===Rh?y=rn:w===kh?y=uo:w===Xa&&(y=Lo),f=function(b,I,N){return I?w===Xa?b[0].length?I.setCoordinates([b[0].concat([b[0][0]])],this.qv):I.setCoordinates([],this.qv):I.setCoordinates(b,this.qv):I=new y(b,this.qv),I})}return e.Bu=f,e.Uv=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,e.Bv=null,e.Xv=null,e.Vv=null,e.Wv=null,e.Yv=null,e.Zv=null,e.$v=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,e.Kv=new wu({source:new du({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(l=Pp(),function(b,I){return l[b.getGeometry().getType()]}),updateWhileInteracting:!0}),e.K=t.geometryName,e.Zr=t.condition?t.condition:Jd,e.Hv,t.freehand?e.Hv=mp:e.Hv=t.freehandCondition?t.freehandCondition:Of,e.addChangeListener(Yd,e.Jv),e}return Lw(i,s),i.prototype.setMap=function(t){s.prototype.setMap.call(this,t),this.Jv()},i.prototype.getOverlay=function(){return this.Kv},i.prototype.handleEvent=function(t){t.originalEvent.type===je&&t.originalEvent.preventDefault(),this.Lv=this.pe!==Rh&&this.Hv(t);var e=t.type===zi.POINTERMOVE,o=!0;return!this.Lv&&this.Iv&&t.type===zi.POINTERDRAG&&(Date.now()-this.Iv>=this.Uv?(this.Cv=t.pixel,this.Pv=!this.Lv,e=!0):this.Iv=void 0,this.Pv&&this.kv!==void 0&&(clearTimeout(this.kv),this.kv=void 0)),this.Lv&&t.type===zi.POINTERDRAG&&this.Xv!==null?(this.Qv(t.coordinate),o=!1):this.Lv&&t.type===zi.POINTERDOWN?o=!1:e&&this.getPointerCount()<2?(o=t.type===zi.POINTERMOVE)&&this.Lv?(this.Zn(t),this.Pv&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===zi.POINTERDRAG&&this.kv===void 0)&&this.Zn(t):t.type===zi.DBLCLICK&&(o=!1),s.prototype.handleEvent.call(this,t)&&o},i.prototype.handleDownEvent=function(t){return this.Pv=!this.Lv,this.Lv?(this.Cv=t.pixel,this.Bv||this.td(t.coordinate),!0):this.Zr(t)?(this.Iv=Date.now(),this.kv=setTimeout(function(){this.Zn(new Ms(zi.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}.bind(this),this.Uv),this.Cv=t.pixel,!0):(this.Iv=void 0,!1)},i.prototype.handleUpEvent=function(t){var e=!0;if(this.getPointerCount()===0)if(this.kv&&(clearTimeout(this.kv),this.kv=void 0),this.Zn(t),this.Pv){var o=!this.Bv;o&&this.td(t.coordinate),!o&&this.Lv?this.finishDrawing():this.Lv||o&&this.pe!==Rh||(this.rd(t.pixel)?this.Dv(t)&&this.finishDrawing():this.Qv(t.coordinate)),e=!1}else this.Lv&&this.abortDrawing();return!e&&this.Rv&&t.preventDefault(),e},i.prototype.Zn=function(t){if(this.Nv=t.originalEvent.pointerType,this.Cv&&(!this.Lv&&this.Pv||this.Lv&&!this.Pv)){var e=this.Cv,o=t.pixel,l=e[0]-o[0],f=e[1]-o[1],y=l*l+f*f;if(this.Pv=this.Lv?y>this.$v:y<=this.$v,!this.Pv)return}this.Bv?this.ed(t.coordinate):this.od(t.coordinate.slice())},i.prototype.rd=function(t){var e=!1;if(this.Xv){var o=!1,l=[this.Bv],f=this.pe;if(f===Rh)e=!0;else if(f===Fh)e=this.Wv.length===2;else if(f===kh)o=this.Wv.length>this.Fv;else if(f===Xa){var y=this.Wv;o=y[0].length>this.Fv,l=[y[0][0],y[0][y[0].length-2]]}if(o)for(var w=this.getMap(),b=0,I=l.length;b<I;b++){var N=l[b],D=w.getPixelFromCoordinate(N),j=t[0]-D[0],H=t[1]-D[1],Z=this.Lv?1:this.zv;if(e=Math.sqrt(j*j+H*H)<=Z){this.Bv=N;break}}}return e},i.prototype.od=function(t){this.Vv?this.Vv.getGeometry().setCoordinates(t):(this.Vv=new Mr(new rn(t)),this.sd())},i.prototype.ud=function(t){this.Yv||(this.Yv=new Mr);var e=t.getLinearRing(0),o=this.Yv.getGeometry();o?(o.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),o.changed()):(o=new uo(e.getFlatCoordinates(),e.getLayout()),this.Yv.setGeometry(o))},i.prototype.td=function(t){for(var e=this.getMap().getView().getProjection(),o=Vc(this.qv);t.length<o;)t.push(0);this.Bv=t,this.pe===Rh?this.Wv=t.slice():this.pe===Xa?(this.Wv=[[t.slice(),t.slice()]],this.Zv=this.Wv[0]):this.Wv=[t.slice(),t.slice()],this.Zv&&(this.Yv=new Mr(new uo(this.Zv)));var l=this.Bu(this.Wv,void 0,e);this.Xv=new Mr,this.K&&this.Xv.setGeometryName(this.K),this.Xv.setGeometry(l),this.sd(),this.dispatchEvent(new _d(Aw,this.Xv))},i.prototype.ed=function(t){for(var e,o,l=this.getMap(),f=this.Xv.getGeometry(),y=l.getView().getProjection(),w=Vc(this.qv);t.length<w;)t.push(0);this.pe===Rh?o=this.Wv:this.pe===Xa?(o=(e=this.Wv[0])[e.length-1],this.rd(l.getPixelFromCoordinate(t))&&(t=this.Bv.slice())):o=(e=this.Wv)[e.length-1],o[0]=t[0],o[1]=t[1],this.Bu(this.Wv,f,y),this.Vv&&this.Vv.getGeometry().setCoordinates(t),f.getType()==="Polygon"&&this.pe!==Xa?this.ud(f):this.Zv&&this.Yv.getGeometry().setCoordinates(this.Zv),this.sd()},i.prototype.Qv=function(t){var e,o,l=this.Xv.getGeometry(),f=this.getMap().getView().getProjection(),y=this.pe;y===kh||y===Fh?(this.Bv=t.slice(),(o=this.Wv).length>=this.Gv&&(this.Lv?o.pop():e=!0),o.push(t.slice()),this.Bu(o,l,f)):y===Xa&&((o=this.Wv[0]).length>=this.Gv&&(this.Lv?o.pop():e=!0),o.push(t.slice()),e&&(this.Bv=o[0]),this.Bu(this.Wv,l,f)),this.od(t.slice()),this.sd(),e&&this.finishDrawing()},i.prototype.removeLastPoint=function(){if(this.Xv){var t,e=this.Xv.getGeometry(),o=this.getMap().getView().getProjection(),l=this.pe;if(l===kh||l===Fh){if((t=this.Wv).splice(-2,1),t.length>=2){this.Bv=t[t.length-2].slice();var f=this.Bv.slice();t[t.length-1]=f,this.od(f)}this.Bu(t,e,o),e.getType()==="Polygon"&&this.Yv&&this.ud(e)}else if(l===Xa){(t=this.Wv[0]).splice(-2,1);var y=this.Yv.getGeometry();t.length>=2&&(f=t[t.length-2].slice(),t[t.length-1]=f,this.od(f)),y.setCoordinates(t),this.Bu(this.Wv,e,o)}t.length===1&&this.abortDrawing(),this.sd()}},i.prototype.finishDrawing=function(){var t=this.ad();if(t){var e=this.Wv,o=t.getGeometry(),l=this.getMap().getView().getProjection();this.pe===kh?(e.pop(),this.Bu(e,o,l)):this.pe===Xa&&(e[0].pop(),this.Bu(e,o,l),e=o.getCoordinates()),this.rl==="MultiPoint"?t.setGeometry(new Va([e])):this.rl==="MultiLineString"?t.setGeometry(new Ks([e])):this.rl==="MultiPolygon"&&t.setGeometry(new Ua([e])),this.dispatchEvent(new _d(LI,t)),this.Re&&this.Re.push(t),this._v&&this._v.addFeature(t)}},i.prototype.ad=function(){this.Bv=null;var t=this.Xv;return this.Xv=null,this.Vv=null,this.Yv=null,this.Kv.getSource().clear(!0),t},i.prototype.abortDrawing=function(){var t=this.ad();t&&this.dispatchEvent(new _d(AI,t))},i.prototype.appendCoordinates=function(t){var e,o=this.pe,l=!this.Xv;if(l&&this.td(t[0]),o===kh||o===Fh)e=this.Wv;else{if(o!==Xa)return;e=this.Wv&&this.Wv.length?this.Wv[0]:[]}l&&e.shift(),e.pop();for(var f=0;f<t.length;f++)this.Qv(t[f]);var y=t[t.length-1];this.Qv(y),this.ed(y)},i.prototype.extend=function(t){var e=t.getGeometry();this.Xv=t,this.Wv=e.getCoordinates();var o=this.Wv[this.Wv.length-1];this.Bv=o.slice(),this.Wv.push(o.slice()),this.Vv=new Mr(new rn(o)),this.sd(),this.dispatchEvent(new _d(Aw,this.Xv))},i.prototype.sd=function(){var t=[];this.Xv&&t.push(this.Xv),this.Yv&&t.push(this.Yv),this.Vv&&t.push(this.Vv);var e=this.Kv.getSource();e.clear(!0),e.addFeatures(t)},i.prototype.Jv=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.Kv.setMap(e?t:null)},i}(ja),Ow=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),NI="extentchanged",Nw=function(s){function i(t){var e=s.call(this,NI)||this;return e.extent=t,e}return Ow(i,s),i}(O);function RI(){var s=Pp();return function(i,t){return s.Point}}function Rw(s){return function(i){return mr([s,i])}}function kw(s,i){return s[0]==i[0]?function(t){return mr([s,[t[0],i[1]]])}:s[1]==i[1]?function(t){return mr([s,[i[0],t[1]]])}:null}var kI=function(s){function i(t){var e,o=this,l=t||{};return(o=s.call(this,l)||this).on,o.once,o.un,o.Zr=l.condition?l.condition:mp,o.st=null,o.hd=null,o.fd=l.pixelTolerance!==void 0?l.pixelTolerance:10,o.ld=!1,o.vd=null,o.dd=null,t||(t={}),o.yd=new wu({source:new du({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:(e=Pp(),function(f,y){return e.Polygon}),updateWhileAnimating:!0,updateWhileInteracting:!0}),o.md=new wu({source:new du({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:RI(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&o.setExtent(t.extent),o}return Ow(i,s),i.prototype.wd=function(t,e){var o=e.getCoordinateFromPixelInternal(t),l=this.getExtentInternal();if(l){var f=function(Z){return[[[Z[0],Z[1]],[Z[0],Z[3]]],[[Z[0],Z[3]],[Z[2],Z[3]]],[[Z[2],Z[3]],[Z[2],Z[1]]],[[Z[2],Z[1]],[Z[0],Z[1]]]]}(l);f.sort(function(Z,it){return Do(o,Z)-Do(o,it)});var y=f[0],w=Ss(o,y),b=e.getPixelFromCoordinateInternal(w);if(Es(t,b)<=this.fd){var I=e.getPixelFromCoordinateInternal(y[0]),N=e.getPixelFromCoordinateInternal(y[1]),D=mi(b,I),j=mi(b,N),H=Math.sqrt(Math.min(D,j));return this.ld=H<=this.fd,this.ld&&(w=D>j?y[1]:y[0]),w}}return null},i.prototype.Zn=function(t){var e=t.pixel,o=t.map,l=this.wd(e,o);l||(l=o.getCoordinateFromPixelInternal(e)),this.gd(l)},i.prototype.bd=function(t){var e=this.vd;return e?t?e.setGeometry(Ao(t)):e.setGeometry(void 0):(e=new Mr(t?Ao(t):{}),this.vd=e,this.yd.getSource().addFeature(e)),e},i.prototype.gd=function(t){var e=this.dd;return e?e.getGeometry().setCoordinates(t):(e=new Mr(new rn(t)),this.dd=e,this.md.getSource().addFeature(e)),e},i.prototype.handleEvent=function(t){return!t.originalEvent||!this.Zr(t)||(t.type!=zi.POINTERMOVE||this.handlingDownUpSequence||this.Zn(t),s.prototype.handleEvent.call(this,t),!1)},i.prototype.handleDownEvent=function(t){var e=t.pixel,o=t.map,l=this.getExtentInternal(),f=this.wd(e,o),y=function(I){var N=null,D=null;return I[0]==l[0]?N=l[2]:I[0]==l[2]&&(N=l[0]),I[1]==l[1]?D=l[3]:I[1]==l[3]&&(D=l[1]),N!==null&&D!==null?[N,D]:null};if(f&&l){var w=f[0]==l[0]||f[0]==l[2]?f[0]:null,b=f[1]==l[1]||f[1]==l[3]?f[1]:null;w!==null&&b!==null?this.hd=Rw(y(f)):w!==null?this.hd=kw(y([w,l[1]]),y([w,l[3]])):b!==null&&(this.hd=kw(y([l[0],b]),y([l[2],b])))}else f=o.getCoordinateFromPixelInternal(e),this.setExtent([f[0],f[1],f[0],f[1]]),this.hd=Rw(f);return!0},i.prototype.handleDragEvent=function(t){if(this.hd){var e=t.coordinate;this.setExtent(this.hd(e)),this.gd(e)}},i.prototype.handleUpEvent=function(t){this.hd=null;var e=this.getExtentInternal();return e&&_o(e)!==0||this.setExtent(null),!1},i.prototype.setMap=function(t){this.yd.setMap(t),this.md.setMap(t),s.prototype.setMap.call(this,t)},i.prototype.getExtent=function(){return na(this.getExtentInternal(),this.getMap().getView().getProjection())},i.prototype.getExtentInternal=function(){return this.st},i.prototype.setExtent=function(t){this.st=t||null,this.bd(t),this.dispatchEvent(new Nw(this.st))},i}(ja),FI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function xd(s){return parseFloat(s)}function wd(s){return function(i){return Ze(i,5)}(s).toString()}function em(s,i){return!isNaN(s)&&s!==xd(wd(i))}var DI=function(s){function i(t){var e,o=s.call(this)||this,l=Vt({animate:!0,replace:!1,prefix:""},t||{});return e=l.animate===!0?{duration:250}:l.animate?l.animate:null,o.xd=e,o.Md=l.replace,o._d=l.prefix,o.gn=[],o.Sd=!0,o.Jv=o.Jv.bind(o),o}return FI(i,s),i.prototype.Od=function(t){return this._d?this._d+t:t},i.prototype.jd=function(t,e){return t.get(this.Od(e))},i.prototype.Ed=function(t,e,o){t.set(this.Od(e),o)},i.prototype.Td=function(t,e){t.delete(this.Od(e))},i.prototype.setMap=function(t){var e=this.getMap();s.prototype.setMap.call(this,t),t!==e&&(e&&this.Ev(e),t&&(this.Sd=!0,this.Jv(),this.jv(t)))},i.prototype.jv=function(t){this.gn.push(Ee(t,As,this.Ad,this),Ee(t.getLayerGroup(),ne,this.Ad,this),Ee(t,"change:layergroup",this.Pd,this)),this.Md||addEventListener("popstate",this.Jv)},i.prototype.Ev=function(t){for(var e=0,o=this.gn.length;e<o;++e)Or(this.gn[e]);this.gn.length=0,this.Md||removeEventListener("popstate",this.Jv);var l=new URL(window.location.href),f=l.searchParams;this.Td(f,"x"),this.Td(f,"y"),this.Td(f,"z"),this.Td(f,"r"),this.Td(f,"l"),window.history.replaceState(null,"",l)},i.prototype.Pd=function(){var t=this.getMap();t&&(this.Ev(t),this.jv(t),this.Sd=!0,this.Ad())},i.prototype.Jv=function(){var t=this.getMap();if(t){var e=t.getView();if(e){var o=new URL(window.location.href).searchParams,l=!1,f={},y=xd(this.jd(o,"z"));em(y,e.getZoom())&&(l=!0,f.zoom=y);var w=xd(this.jd(o,"r"));em(w,e.getRotation())&&(l=!0,f.rotation=w);var b,I,N=[xd(this.jd(o,"x")),xd(this.jd(o,"y"))];b=N,I=e.getCenter(),(em(b[0],I[0])||em(b[1],I[1]))&&(l=!0,f.center=N),l&&(!this.Sd&&this.xd?e.animate(Vt(f,this.xd)):(f.center&&e.setCenter(f.center),"zoom"in f&&e.setZoom(f.zoom),"rotation"in f&&e.setRotation(f.rotation)));var D=t.getAllLayers(),j=this.jd(o,"l");if(j&&j.length===D.length)for(var H=0,Z=D.length;H<Z;++H){var it=parseInt(j[H]);if(!isNaN(it)){var at=!!it,wt=D[H];wt.getVisible()!==at&&wt.setVisible(at)}}}}},i.prototype.Ad=function(){var t=this.getMap();if(t){var e=t.getView();if(e){var o=this.Sd;this.Sd=!1;for(var l=e.getCenter(),f=e.getZoom(),y=e.getRotation(),w=t.getAllLayers(),b=new Array(w.length),I=0,N=w.length;I<N;++I)b[I]=w[I].getVisible()?"1":"0";var D=new URL(window.location.href),j=D.searchParams;this.Ed(j,"x",wd(l[0])),this.Ed(j,"y",wd(l[1])),this.Ed(j,"z",wd(f)),this.Ed(j,"r",wd(y)),this.Ed(j,"l",b.join("")),D.href!==window.location.href&&(o||this.Md?window.history.replaceState(null,"",D):window.history.pushState(null,"",D))}}},i}(xc),Fw=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Dw=[0,0,0,0],Hp=[],GI="modifystart",Gw="modifyend",rm=function(s){function i(t,e,o){var l=s.call(this,t)||this;return l.features=e,l.mapBrowserEvent=o,l}return Fw(i,s),i}(O);function jI(s,i){return s.index-i.index}function jw(s,i,t){var e=i.geometry;if(e.getType()==="Circle"){var o=e;if(i.index===1){var l=wo();l&&(o=o.clone().transform(l,t));var f=mi(o.getCenter(),$i(s,t)),y=Math.sqrt(f)-o.getRadius();return y*y}}var w=$i(s,t);return Hp[0]=$i(i.segment[0],t),Hp[1]=$i(i.segment[1],t),Do(w,Hp)}function Bw(s,i,t){var e=i.geometry;if(e.getType()==="Circle"&&i.index===1){var o=e,l=wo();return l&&(o=o.clone().transform(l,t)),Io(o.getClosestPoint($i(s,t)),t)}var f=$i(s,t);return Hp[0]=$i(i.segment[0],t),Hp[1]=$i(i.segment[1],t),Io(Ss(f,Hp),t)}var BI=function(s){function i(t){var e,o,l=s.call(this,t)||this;if(l.on,l.once,l.un,l.Cd=l.$a.bind(l),l.Zr=t.condition?t.condition:Hm,l.kd=function(f){return J0(f)&&Um(f)},l.Id=t.deleteCondition?t.deleteCondition:l.kd,l.Nd=t.insertVertexCondition?t.insertVertexCondition:mp,l.dd=null,l.Ld=null,l.zd=[0,0],l.Rd=!1,l.Fd=null,l.Gd=new Xf,l.fd=t.pixelTolerance!==void 0?t.pixelTolerance:10,l.ld=!1,l.Dd=!1,l.qd=[],l.Kv=new wu({source:new du({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(e=Pp(),function(f,y){return e.Point}),updateWhileAnimating:!0,updateWhileInteracting:!0}),l.Ud={Point:l.Bd.bind(l),LineString:l.Xd.bind(l),LinearRing:l.Xd.bind(l),Polygon:l.Vd.bind(l),MultiPoint:l.Wd.bind(l),MultiLineString:l.Yd.bind(l),MultiPolygon:l.Zd.bind(l),Circle:l.$d.bind(l),GeometryCollection:l.Kd.bind(l)},l._v=null,l.Hd=null,t.features?o=t.features:t.source&&(l._v=t.source,o=new Be(l._v.getFeatures()),l._v.addEventListener(wh,l.Jd.bind(l)),l._v.addEventListener(Zf,l.Qd.bind(l))),!o)throw new Error("The modify interaction requires features, a source or a layer");return t.hitDetection&&(l.Hd=t.hitDetection),l.Re=o,l.Re.forEach(l.tp.bind(l)),l.Re.addEventListener(Ft,l.np.bind(l)),l.Re.addEventListener(Ot,l.ip.bind(l)),l.rp=null,l.Br=[0,0],l.ep=t.snapToPointer===void 0?!l.Hd:t.snapToPointer,l}return Fw(i,s),i.prototype.tp=function(t){var e=t.getGeometry();if(e){var o=this.Ud[e.getType()];o&&o(t,e)}var l=this.getMap();l&&l.isRendered()&&this.getActive()&&this.op(this.zd,l),t.addEventListener(ne,this.Cd)},i.prototype.sp=function(t,e){if(!this.Fd){this.Fd=new Be;for(var o=this.Fd.getArray(),l=0,f=e.length;l<f;++l)for(var y=e[l],w=0,b=y.length;w<b;++w){var I=y[w].feature;I&&o.indexOf(I)===-1&&this.Fd.push(I)}this.Fd.getLength()===0?this.Fd=null:this.dispatchEvent(new rm(GI,this.Fd,t))}},i.prototype.up=function(t){this.ap(t),this.dd&&this.Re.getLength()===0&&(this.Kv.getSource().removeFeature(this.dd),this.dd=null),t.removeEventListener(ne,this.Cd)},i.prototype.ap=function(t){var e=this.Gd,o=[];e.forEach(function(w){t===w.feature&&o.push(w)});for(var l=o.length-1;l>=0;--l){for(var f=o[l],y=this.qd.length-1;y>=0;--y)this.qd[y][0]===f&&this.qd.splice(y,1);e.remove(f)}},i.prototype.setActive=function(t){this.dd&&!t&&(this.Kv.getSource().removeFeature(this.dd),this.dd=null),s.prototype.setActive.call(this,t)},i.prototype.setMap=function(t){this.Kv.setMap(t),s.prototype.setMap.call(this,t)},i.prototype.getOverlay=function(){return this.Kv},i.prototype.Jd=function(t){t.feature&&this.Re.push(t.feature)},i.prototype.Qd=function(t){t.feature&&this.Re.remove(t.feature)},i.prototype.np=function(t){this.tp(t.element)},i.prototype.$a=function(t){if(!this.Dd){var e=t.target;this.up(e),this.tp(e)}},i.prototype.ip=function(t){var e=t.element;this.up(e)},i.prototype.Bd=function(t,e){var o=e.getCoordinates(),l={feature:t,geometry:e,segment:[o,o]};this.Gd.insert(e.getExtent(),l)},i.prototype.Wd=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l){var y=o[l],w={feature:t,geometry:e,depth:[l],index:l,segment:[y,y]};this.Gd.insert(e.getExtent(),w)}},i.prototype.Xd=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length-1;l<f;++l){var y=o.slice(l,l+2),w={feature:t,geometry:e,index:l,segment:y};this.Gd.insert(mr(y),w)}},i.prototype.Yd=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length-1;w<b;++w){var I=y.slice(w,w+2),N={feature:t,geometry:e,depth:[l],index:w,segment:I};this.Gd.insert(mr(I),N)}},i.prototype.Vd=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length-1;w<b;++w){var I=y.slice(w,w+2),N={feature:t,geometry:e,depth:[l],index:w,segment:I};this.Gd.insert(mr(I),N)}},i.prototype.Zd=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length;w<b;++w)for(var I=y[w],N=0,D=I.length-1;N<D;++N){var j=I.slice(N,N+2),H={feature:t,geometry:e,depth:[w,l],index:N,segment:j};this.Gd.insert(mr(j),H)}},i.prototype.$d=function(t,e){var o=e.getCenter(),l={feature:t,geometry:e,index:0,segment:[o,o]},f={feature:t,geometry:e,index:1,segment:[o,o]},y=[l,f];l.featureSegments=y,f.featureSegments=y,this.Gd.insert(as(o),l);var w=e,b=wo();if(b&&this.getMap()){var I=this.getMap().getView().getProjection();w=us(w=w.clone().transform(b,I)).transform(I,b)}this.Gd.insert(w.getExtent(),f)},i.prototype.Kd=function(t,e){for(var o=e.getGeometriesArray(),l=0;l<o.length;++l){var f=o[l];(0,this.Ud[f.getType()])(t,f)}},i.prototype.hp=function(t,e,o){var l=this.dd;return l?l.getGeometry().setCoordinates(t):(l=new Mr(new rn(t)),this.dd=l,this.Kv.getSource().addFeature(l)),l.set("features",e),l.set("geometries",o),l},i.prototype.handleEvent=function(t){return!t.originalEvent||(this.rp=t,t.map.getView().getInteracting()||t.type!=zi.POINTERMOVE||this.handlingDownUpSequence||this.Zn(t),this.dd&&this.Id(t)&&(e=!(t.type!=zi.SINGLECLICK||!this.Rd)||this.removePoint()),t.type==zi.SINGLECLICK&&(this.Rd=!1),s.prototype.handleEvent.call(this,t)&&!e);var e},i.prototype.handleDragEvent=function(t){this.Rd=!1,this.sp(t,this.qd);for(var e=[t.coordinate[0]+this.Br[0],t.coordinate[1]+this.Br[1]],o=[],l=[],f=0,y=this.qd.length;f<y;++f){var w=this.qd[f],b=w[0],I=b.feature;o.indexOf(I)===-1&&o.push(I);var N=b.geometry;l.indexOf(N)===-1&&l.push(N);for(var D=b.depth,j=void 0,H=b.segment,Z=w[1];e.length<N.getStride();)e.push(H[Z][e.length]);switch(N.getType()){case"Point":j=e,H[0]=e,H[1]=e;break;case"MultiPoint":(j=N.getCoordinates())[b.index]=e,H[0]=e,H[1]=e;break;case"LineString":(j=N.getCoordinates())[b.index+Z]=e,H[Z]=e;break;case"MultiLineString":case"Polygon":(j=N.getCoordinates())[D[0]][b.index+Z]=e,H[Z]=e;break;case"MultiPolygon":(j=N.getCoordinates())[D[1]][D[0]][b.index+Z]=e,H[Z]=e;break;case"Circle":if(H[0]=e,H[1]=e,b.index===0)this.Dd=!0,N.setCenter(e),this.Dd=!1;else{this.Dd=!0;var it=t.map.getView().getProjection(),at=Es($i(N.getCenter(),it),$i(e,it)),wt=wo();if(wt){var gt=N.clone().transform(wt,it);gt.setRadius(at),at=gt.transform(it,wt).getRadius()}N.setRadius(at),this.Dd=!1}}j&&this.fp(N,j)}this.hp(e,o,l)},i.prototype.handleDownEvent=function(t){if(!this.Zr(t))return!1;var e=t.coordinate;this.op(t.pixel,t.map,e),this.qd.length=0,this.Fd=null;var o=this.dd;if(o){var l=t.map.getView().getProjection(),f=[],y=o.getGeometry().getCoordinates(),w=mr([y]),b=this.Gd.getInExtent(w),I={};b.sort(jI);for(var N=0,D=b.length;N<D;++N){var j=b[N],H=j.segment,Z=L(j.geometry),it=j.depth;if(it&&(Z+="-"+it.join("-")),I[Z]||(I[Z]=new Array(2)),j.geometry.getType()!=="Circle"||j.index!==1)if(!mn(H[0],y)||I[Z][0])if(!mn(H[1],y)||I[Z][1])L(H)in this.Ld&&!I[Z][0]&&!I[Z][1]&&this.Nd(t)&&f.push(j);else{if(I[Z][0]&&I[Z][0].index===0){var at=j.geometry.getCoordinates();switch(j.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":at=at[it[1]];case"Polygon":if(j.index!==at[it[0]].length-2)continue}}this.qd.push([j,1]),I[Z][1]=j}else this.qd.push([j,0]),I[Z][0]=j;else mn(Bw(e,j,l),y)&&!I[Z][0]&&(this.qd.push([j,0]),I[Z][0]=j)}f.length&&this.sp(t,[f]);for(var wt=f.length-1;wt>=0;--wt)this.cp(f[wt],y)}return!!this.dd},i.prototype.handleUpEvent=function(t){for(var e=this.qd.length-1;e>=0;--e){var o=this.qd[e][0],l=o.geometry;if(l.getType()==="Circle"){var f=l.getCenter(),y=o.featureSegments[0],w=o.featureSegments[1];y.segment[0]=f,y.segment[1]=f,w.segment[0]=f,w.segment[1]=f,this.Gd.update(as(f),y);var b=l,I=wo();if(I){var N=t.map.getView().getProjection();b=us(b=b.clone().transform(I,N)).transform(N,I)}this.Gd.update(b.getExtent(),w)}else this.Gd.update(mr(o.segment),o)}return this.Fd&&(this.dispatchEvent(new rm(Gw,this.Fd,t)),this.Fd=null),!1},i.prototype.Zn=function(t){this.zd=t.pixel,this.op(t.pixel,t.map,t.coordinate)},i.prototype.op=function(t,e,o){var l,f,y=this,w=o||e.getCoordinateFromPixel(t),b=e.getView().getProjection();if(this.Hd){var I=typeof this.Hd=="object"?function(pe){return pe===y.Hd}:void 0;e.forEachFeatureAtPixel(t,function(pe,xe,fe){if((fe=fe||pe.getGeometry()).getType()==="Point"&&pt(y.Re.getArray(),pe)){f=fe;var Re=fe.getFlatCoordinates().slice(0,2);l=[{feature:pe,geometry:fe,segment:[Re,Re]}]}return!0},{layerFilter:I})}if(!l){var N=na(Fr(Mo(as(w,Dw),b),e.getView().getResolution()*this.fd,Dw),b);l=this.Gd.getInExtent(N)}if(l&&l.length>0){var D=l.sort(function(pe,xe){return jw(w,pe,b)-jw(w,xe,b)})[0],j=D.segment,H=Bw(w,D,b),Z=e.getPixelFromCoordinate(H),it=Es(t,Z);if(f||it<=this.fd){var at={};if(at[L(j)]=!0,this.ep||(this.Br[0]=H[0]-w[0],this.Br[1]=H[1]-w[1]),D.geometry.getType()==="Circle"&&D.index===1)this.ld=!0,this.hp(H,[D.feature],[D.geometry]);else{var wt=e.getPixelFromCoordinate(j[0]),gt=e.getPixelFromCoordinate(j[1]),yt=mi(Z,wt),It=mi(Z,gt);it=Math.sqrt(Math.min(yt,It)),this.ld=it<=this.fd,this.ld&&(H=yt>It?j[1]:j[0]),this.hp(H,[D.feature],[D.geometry]);var Rt={};Rt[L(D.geometry)]=!0;for(var kt=1,Dt=l.length;kt<Dt;++kt){var Xt=l[kt].segment;if(!(mn(j[0],Xt[0])&&mn(j[1],Xt[1])||mn(j[0],Xt[1])&&mn(j[1],Xt[0])))break;var ee=L(l[kt].geometry);ee in Rt||(Rt[ee]=!0,at[L(Xt)]=!0)}}return void(this.Ld=at)}}this.dd&&(this.Kv.getSource().removeFeature(this.dd),this.dd=null)},i.prototype.cp=function(t,e){for(var o,l=t.segment,f=t.feature,y=t.geometry,w=t.depth,b=t.index;e.length<y.getStride();)e.push(0);switch(y.getType()){case"MultiLineString":case"Polygon":(o=y.getCoordinates())[w[0]].splice(b+1,0,e);break;case"MultiPolygon":(o=y.getCoordinates())[w[1]][w[0]].splice(b+1,0,e);break;case"LineString":(o=y.getCoordinates()).splice(b+1,0,e);break;default:return}this.fp(y,o);var I=this.Gd;I.remove(t),this.lp(y,b,w,1);var N={segment:[l[0],e],feature:f,geometry:y,depth:w,index:b};I.insert(mr(N.segment),N),this.qd.push([N,1]);var D={segment:[e,l[1]],feature:f,geometry:y,depth:w,index:b+1};I.insert(mr(D.segment),D),this.qd.push([D,0]),this.Rd=!0},i.prototype.removePoint=function(){if(this.rp&&this.rp.type!=zi.POINTERDRAG){var t=this.rp;this.sp(t,this.qd);var e=this.vp();return this.Fd&&this.dispatchEvent(new rm(Gw,this.Fd,t)),this.Fd=null,e}return!1},i.prototype.vp=function(){var t,e,o,l,f,y,w,b,I,N,D,j=this.qd,H={},Z=!1;for(f=j.length-1;f>=0;--f)D=L((N=(o=j[f])[0]).feature),N.depth&&(D+="-"+N.depth.join("-")),D in H||(H[D]={}),o[1]===0?(H[D].right=N,H[D].index=N.index):o[1]==1&&(H[D].left=N,H[D].index=N.index+1);for(D in H){switch(I=H[D].right,w=H[D].left,(b=(y=H[D].index)-1)<0&&(b=0),t=e=(l=(N=w!==void 0?w:I).geometry).getCoordinates(),Z=!1,l.getType()){case"MultiLineString":e[N.depth[0]].length>2&&(e[N.depth[0]].splice(y,1),Z=!0);break;case"LineString":e.length>2&&(e.splice(y,1),Z=!0);break;case"MultiPolygon":t=t[N.depth[1]];case"Polygon":(t=t[N.depth[0]]).length>4&&(y==t.length-1&&(y=0),t.splice(y,1),Z=!0,y===0&&(t.pop(),t.push(t[0]),b=t.length-1))}if(Z){this.fp(l,e);var it=[];if(w!==void 0&&(this.Gd.remove(w),it.push(w.segment[0])),I!==void 0&&(this.Gd.remove(I),it.push(I.segment[1])),w!==void 0&&I!==void 0){var at={depth:N.depth,feature:N.feature,geometry:N.geometry,index:b,segment:it};this.Gd.insert(mr(at.segment),at)}this.lp(l,y,N.depth,-1),this.dd&&(this.Kv.getSource().removeFeature(this.dd),this.dd=null),j.length=0}}return Z},i.prototype.fp=function(t,e){this.Dd=!0,t.setCoordinates(e),this.Dd=!1},i.prototype.lp=function(t,e,o,l){this.Gd.forEachInExtent(t.getExtent(),function(f){f.geometry===t&&(o===void 0||f.depth===void 0||$(f.depth,o))&&f.index>e&&(f.index+=l)})},i}(ja),zw=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),zI="select",Vw=function(s){function i(t,e,o,l){var f=s.call(this,t)||this;return f.selected=e,f.deselected=o,f.mapBrowserEvent=l,f}return zw(i,s),i}(O),im={},VI=function(s){function i(t){var e=s.call(this)||this;e.on,e.once,e.un;var o,l,f=t||{};if(e.dp=e.tp.bind(e),e.pp=e.up.bind(e),e.Zr=f.condition?f.condition:Um,e.yp=f.addCondition?f.addCondition:Vm,e.mp=f.removeCondition?f.removeCondition:Vm,e.wp=f.toggleCondition?f.toggleCondition:Of,e.gp=!!f.multi&&f.multi,e.bp=f.filter?f.filter:rt,e.xp=f.hitTolerance?f.hitTolerance:0,e.H=f.style!==void 0?f.style:(ut((o=Pp()).Polygon,o.LineString),ut(o.GeometryCollection,o.LineString),function(w){return w.getGeometry()?o[w.getGeometry().getType()]:null}),e.Re=f.features||new Be,f.layers)if(typeof f.layers=="function")l=f.layers;else{var y=f.layers;l=function(w){return pt(y,w)}}else l=rt;return e.Mp=l,e._p={},e}return zw(i,s),i.prototype.Sp=function(t,e){this._p[L(t)]=e},i.prototype.getFeatures=function(){return this.Re},i.prototype.getHitTolerance=function(){return this.xp},i.prototype.getLayer=function(t){return this._p[L(t)]},i.prototype.setHitTolerance=function(t){this.xp=t},i.prototype.setMap=function(t){this.getMap()&&this.H&&this.Re.forEach(this.Op.bind(this)),s.prototype.setMap.call(this,t),t?(this.Re.addEventListener(Ft,this.dp),this.Re.addEventListener(Ot,this.pp),this.H&&this.Re.forEach(this.jp.bind(this))):(this.Re.removeEventListener(Ft,this.dp),this.Re.removeEventListener(Ot,this.pp))},i.prototype.tp=function(t){var e=t.element;if(this.H&&this.jp(e),!this.getLayer(e)){var o=this.getMap().getAllLayers().find(function(l){if(l instanceof wu&&l.getSource()&&l.getSource().hasFeature(e))return l});o&&this.Sp(e,o)}},i.prototype.up=function(t){var e=t.element;this.H&&this.Op(e)},i.prototype.getStyle=function(){return this.H},i.prototype.jp=function(t){var e=L(t);e in im||(im[e]=t.getStyle()),t.setStyle(this.H)},i.prototype.Op=function(t){for(var e=this.getMap().getInteractions().getArray(),o=e.length-1;o>=0;--o){var l=e[o];if(l!==this&&l instanceof i&&l.getStyle()&&l.getFeatures().getArray().lastIndexOf(t)!==-1)return void t.setStyle(l.getStyle())}var f=L(t);t.setStyle(im[f]),delete im[f]},i.prototype.Ep=function(t){delete this._p[L(t)]},i.prototype.handleEvent=function(t){if(!this.Zr(t))return!0;var e=this.yp(t),o=this.mp(t),l=this.wp(t),f=!e&&!o&&!l,y=t.map,w=this.getFeatures(),b=[],I=[];if(f){Lt(this._p),y.forEachFeatureAtPixel(t.pixel,function(Z,it){if(this.bp(Z,it))return this.Sp(Z,it),I.push(Z),!this.gp}.bind(this),{layerFilter:this.Mp,hitTolerance:this.xp});for(var N=w.getLength()-1;N>=0;--N){var D=w.item(N),j=I.indexOf(D);j>-1?I.splice(j,1):(w.remove(D),b.push(D))}I.length!==0&&w.extend(I)}else{y.forEachFeatureAtPixel(t.pixel,function(Z,it){if(this.bp(Z,it))return!e&&!l||pt(w.getArray(),Z)?(o||l)&&pt(w.getArray(),Z)&&(b.push(Z),this.Ep(Z)):(this.Sp(Z,it),I.push(Z)),!this.gp}.bind(this),{layerFilter:this.Mp,hitTolerance:this.xp});for(var H=b.length-1;H>=0;--H)w.remove(b[H]);w.extend(I)}return(I.length>0||b.length>0)&&this.dispatchEvent(new Vw(zI,I,b,t)),!0},i}(xc),UI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Uw(s){return s.feature?s.feature:s.element?s.element:void 0}var e0=[],qI=function(s){function i(t){var e=this,o=t||{},l=o;return l.handleDownEvent||(l.handleDownEvent=rt),l.stopDown||(l.stopDown=nt),(e=s.call(this,l)||this)._v=o.source?o.source:null,e.Tp=o.vertex===void 0||o.vertex,e.Ap=o.edge===void 0||o.edge,e.Re=o.features?o.features:null,e.Pp=[],e.Cp={},e.kp={},e.Ip={},e.fd=o.pixelTolerance!==void 0?o.pixelTolerance:10,e.Gd=new Xf,e.Np={Point:e.Lp.bind(e),LineString:e.zp.bind(e),LinearRing:e.zp.bind(e),Polygon:e.Rp.bind(e),MultiPoint:e.Fp.bind(e),MultiLineString:e.Gp.bind(e),MultiPolygon:e.Dp.bind(e),GeometryCollection:e.qp.bind(e),Circle:e.Up.bind(e)},e}return UI(i,s),i.prototype.addFeature=function(t,e){var o=e===void 0||e,l=L(t),f=t.getGeometry();if(f){var y=this.Np[f.getType()];if(y){this.kp[l]=f.getExtent([1/0,1/0,-1/0,-1/0]);var w=[];if(y(w,f),w.length===1)this.Gd.insert(mr(w[0]),{feature:t,segment:w[0]});else if(w.length>1){var b=w.map(function(N){return mr(N)}),I=w.map(function(N){return{feature:t,segment:N}});this.Gd.load(b,I)}}}o&&(this.Cp[l]=Ee(t,ne,this.$a,this))},i.prototype.Bp=function(t){this.addFeature(t)},i.prototype.Xp=function(t){this.removeFeature(t)},i.prototype.Vp=function(){var t;return this.Re?t=this.Re:this._v&&(t=this._v.getFeatures()),t},i.prototype.handleEvent=function(t){var e=this.snapTo(t.pixel,t.coordinate,t.map);return e&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel),s.prototype.handleEvent.call(this,t)},i.prototype.np=function(t){var e=Uw(t);this.addFeature(e)},i.prototype.ip=function(t){var e=Uw(t);this.removeFeature(e)},i.prototype.$a=function(t){var e=t.target;if(this.handlingDownUpSequence){var o=L(e);o in this.Ip||(this.Ip[o]=e)}else this.Wp(e)},i.prototype.handleUpEvent=function(t){var e=Ne(this.Ip);return e.length&&(e.forEach(this.Wp.bind(this)),this.Ip={}),!1},i.prototype.removeFeature=function(t,e){var o=e===void 0||e,l=L(t),f=this.kp[l];if(f){var y=this.Gd,w=[];y.forEachInExtent(f,function(I){t===I.feature&&w.push(I)});for(var b=w.length-1;b>=0;--b)y.remove(w[b])}o&&(Or(this.Cp[l]),delete this.Cp[l])},i.prototype.setMap=function(t){var e=this.getMap(),o=this.Pp,l=this.Vp();e&&(o.forEach(Or),o.length=0,l.forEach(this.Xp.bind(this))),s.prototype.setMap.call(this,t),t&&(this.Re?o.push(Ee(this.Re,Ft,this.np,this),Ee(this.Re,Ot,this.ip,this)):this._v&&o.push(Ee(this._v,wh,this.np,this),Ee(this._v,Zf,this.ip,this)),l.forEach(this.Bp.bind(this)))},i.prototype.snapTo=function(t,e,o){var l=mr([o.getCoordinateFromPixel([t[0]-this.fd,t[1]+this.fd]),o.getCoordinateFromPixel([t[0]+this.fd,t[1]-this.fd])]),f=this.Gd.getInExtent(l),y=f.length;if(y===0)return null;var w,b=o.getView().getProjection(),I=$i(e,b),N=1/0,D=this.fd*this.fd,j=function(){if(w){var Dt=o.getPixelFromCoordinate(w);if(mi(t,Dt)<=D)return{vertex:w,vertexPixel:[Math.round(Dt[0]),Math.round(Dt[1])]}}return null};if(this.Tp){for(var H=0;H<y;++H)(Z=f[H]).feature.getGeometry().getType()!=="Circle"&&Z.segment.forEach(function(Dt){var Xt=$i(Dt,b),ee=mi(I,Xt);ee<N&&(w=Dt,N=ee)});if(kt=j())return kt}if(this.Ap){for(H=0;H<y;++H){var Z,it=null;if((Z=f[H]).feature.getGeometry().getType()==="Circle"){var at=Z.feature.getGeometry(),wt=wo();wt&&(at=at.clone().transform(wt,b)),it=Io(io(I,at),b)}else{var gt=Z.segment,yt=gt[0],It=gt[1];It&&(e0[0]=$i(yt,b),e0[1]=$i(It,b),it=Ss(I,e0))}if(it){var Rt=mi(I,it);Rt<N&&(w=it,N=Rt)}}var kt;if(kt=j())return kt}return null},i.prototype.Wp=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},i.prototype.Up=function(t,e){var o=this.getMap().getView().getProjection(),l=e,f=wo();f&&(l=l.clone().transform(f,o));var y=us(l);f&&y.transform(o,f);for(var w=y.getCoordinates()[0],b=0,I=w.length-1;b<I;++b)t.push(w.slice(b,b+2))},i.prototype.qp=function(t,e){for(var o=e.getGeometriesArray(),l=0;l<o.length;++l){var f=this.Np[o[l].getType()];f&&f(t,o[l])}},i.prototype.zp=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length-1;l<f;++l)t.push(o.slice(l,l+2))},i.prototype.Gp=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length-1;w<b;++w)t.push(y.slice(w,w+2))},i.prototype.Fp=function(t,e){e.getCoordinates().forEach(function(o){t.push([o])})},i.prototype.Dp=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length;w<b;++w)for(var I=y[w],N=0,D=I.length-1;N<D;++N)t.push(I.slice(N,N+2))},i.prototype.Lp=function(t,e){t.push([e.getCoordinates()])},i.prototype.Rp=function(t,e){for(var o=e.getCoordinates(),l=0,f=o.length;l<f;++l)for(var y=o[l],w=0,b=y.length-1;w<b;++w)t.push(y.slice(w,w+2))},i}(ja),qw=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),HI="translatestart",XI="translating",WI="translateend",nm=function(s){function i(t,e,o,l,f){var y=s.call(this,t)||this;return y.features=e,y.coordinate=o,y.startCoordinate=l,y.mapBrowserEvent=f,y}return qw(i,s),i}(O),YI=function(s){function i(t){var e,o=this,l=t||{};if((o=s.call(this,l)||this).on,o.once,o.un,o.Yp=null,o.Zp=null,o.Re=l.features!==void 0?l.features:null,l.layers&&!o.Re)if(typeof l.layers=="function")e=l.layers;else{var f=l.layers;e=function(y){return pt(f,y)}}else e=rt;return o.Mp=e,o.bp=l.filter&&!o.Re?l.filter:rt,o.xp=l.hitTolerance?l.hitTolerance:0,o.Zr=l.condition?l.condition:mp,o.$p=null,o.addChangeListener(Yd,o.Kp),o}return qw(i,s),i.prototype.handleDownEvent=function(t){if(!t.originalEvent||!this.Zr(t))return!1;if(this.$p=this.Hp(t.pixel,t.map),!this.Yp&&this.$p){this.Zp=t.coordinate,this.Yp=t.coordinate,this.handleMoveEvent(t);var e=this.Re||new Be([this.$p]);return this.dispatchEvent(new nm(HI,e,t.coordinate,this.Zp,t)),!0}return!1},i.prototype.handleUpEvent=function(t){if(this.Yp){this.Yp=null,this.handleMoveEvent(t);var e=this.Re||new Be([this.$p]);return this.dispatchEvent(new nm(WI,e,t.coordinate,this.Zp,t)),this.Zp=null,!0}return!1},i.prototype.handleDragEvent=function(t){if(this.Yp){var e=t.coordinate,o=e[0]-this.Yp[0],l=e[1]-this.Yp[1],f=this.Re||new Be([this.$p]);f.forEach(function(y){var w=y.getGeometry();w.translate(o,l),y.setGeometry(w)}),this.Yp=e,this.dispatchEvent(new nm(XI,f,e,this.Zp,t))}},i.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.Hp(t.pixel,t.map)?(e.classList.remove(this.Yp?"ol-grab":"ol-grabbing"),e.classList.add(this.Yp?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},i.prototype.Hp=function(t,e){return e.forEachFeatureAtPixel(t,function(o,l){if(this.bp(o,l)&&(!this.Re||pt(this.Re.getArray(),o)))return o}.bind(this),{layerFilter:this.Mp,hitTolerance:this.xp})},i.prototype.getHitTolerance=function(){return this.xp},i.prototype.setHitTolerance=function(t){this.xp=t},i.prototype.setMap=function(t){var e=this.getMap();s.prototype.setMap.call(this,t),this.Jv(e)},i.prototype.Kp=function(){this.Jv(null)},i.prototype.Jv=function(t){var e=this.getMap(),o=this.getActive();e&&o||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},i}(ja);function r0(s,i,t,e,o,l){var f,y;o!==void 0?(f=o,y=l!==void 0?l:0):(f=[],y=0);for(var w=i;w<t;){var b=s[w++];f[y++]=s[w++],f[y++]=b;for(var I=2;I<e;++I)f[y++]=s[w++]}return f.length=y,f}var ZI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$I={Point:function(s){var i;return i=s.m!==void 0&&s.z!==void 0?new rn([s.x,s.y,s.z,s.m],Qr):s.z!==void 0?new rn([s.x,s.y,s.z],Vr):s.m!==void 0?new rn([s.x,s.y,s.m],yi):new rn([s.x,s.y]),i},LineString:function(s){var i=Xp(s);return new uo(s.paths[0],i)},Polygon:function(s){var i=Xp(s);return new Lo(s.rings,i)},MultiPoint:function(s){var i=Xp(s);return new Va(s.points,i)},MultiLineString:function(s){var i=Xp(s);return new Ks(s.paths,i)},MultiPolygon:function(s){var i=Xp(s);return new Ua(s.rings,i)}},KI={Point:function(s,i){var t,e=s.getCoordinates(),o=s.getLayout();return o===Vr?t={x:e[0],y:e[1],z:e[2]}:o===yi?t={x:e[0],y:e[1],m:e[2]}:o===Qr?t={x:e[0],y:e[1],z:e[2],m:e[3]}:o===hr?t={x:e[0],y:e[1]}:Me(!1,34),t},LineString:function(s,i){var t=bd(s);return{hasZ:t.hasZ,hasM:t.hasM,paths:[s.getCoordinates()]}},Polygon:function(s,i){var t=bd(s);return{hasZ:t.hasZ,hasM:t.hasM,rings:s.getCoordinates(!1)}},MultiPoint:function(s,i){var t=bd(s);return{hasZ:t.hasZ,hasM:t.hasM,points:s.getCoordinates()}},MultiLineString:function(s,i){var t=bd(s);return{hasZ:t.hasZ,hasM:t.hasM,paths:s.getCoordinates()}},MultiPolygon:function(s,i){for(var t=bd(s),e=s.getCoordinates(!1),o=[],l=0;l<e.length;l++)for(var f=e[l].length-1;f>=0;f--)o.push(e[l][f]);return{hasZ:t.hasZ,hasM:t.hasM,rings:o}}};function Hw(s,i){var t,e,o;if(!s)return null;if(typeof s.x=="number"&&typeof s.y=="number")o="Point";else if(s.points)o="MultiPoint";else if(s.paths)o=s.paths.length===1?"LineString":"MultiLineString";else if(s.rings){var l=s,f=Xp(l),y=function(w,b){var I,N,D=[],j=[],H=[];for(I=0,N=w.length;I<N;++I)D.length=0,Ca(D,0,w[I],b.length),Pl(D,0,D.length,b.length)?j.push([w[I]]):H.push(w[I]);for(;H.length;){var Z=H.shift(),it=!1;for(I=j.length-1;I>=0;I--){var at=j[I][0];if(pn(new Xc(at).getExtent(),new Xc(Z).getExtent())){j[I].push(Z),it=!0;break}}it||j.push([Z.reverse()])}return j}(l.rings,f);y.length===1?(o="Polygon",s=Vt({},s,((t={}).rings=y[0],t))):(o="MultiPolygon",s=Vt({},s,((e={}).rings=y,e)))}return qn((0,$I[o])(s),!1,i)}function Xp(s){var i=hr;return s.hasZ===!0&&s.hasM===!0?i=Qr:s.hasZ===!0?i=Vr:s.hasM===!0&&(i=yi),i}function bd(s){var i=s.getLayout();return{hasZ:i===Vr||i===Qr,hasM:i===yi||i===Qr}}function Xw(s,i){return(0,KI[s.getType()])(qn(s,!0,i),i)}var JI=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this)||this).K=o.geometryName,e}return ZI(i,s),i.prototype.readFeatureFromObject=function(t,e,o){var l=t,f=Hw(l.geometry,e),y=new Mr;if(this.K&&y.setGeometryName(this.K),y.setGeometry(f),l.attributes){y.setProperties(l.attributes,!0);var w=l.attributes[o];w!==void 0&&y.setId(w)}return y},i.prototype.readFeaturesFromObject=function(t,e){var o=e||{};if(t.features){for(var l=[],f=t.features,y=0,w=f.length;y<w;++y)l.push(this.readFeatureFromObject(f[y],o,t.objectIdFieldName));return l}return[this.readFeatureFromObject(t,o)]},i.prototype.readGeometryFromObject=function(t,e){return Hw(t,e)},i.prototype.readProjectionFromObject=function(t){return t.spatialReference&&t.spatialReference.wkid!==void 0?ie("EPSG:"+t.spatialReference.wkid):null},i.prototype.writeGeometryObject=function(t,e){return Xw(t,this.adaptOptions(e))},i.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var o={};if(!t.hasProperties())return o.attributes={},o;var l=t.getProperties(),f=t.getGeometry();if(f){o.geometry=Xw(f,e);var y=e&&(e.dataProjection||e.featureProjection);y&&(o.geometry.spatialReference={wkid:Number(ie(y).getCode().split(":").pop())}),delete l[t.getGeometryName()]}return ge(l)?o.attributes={}:o.attributes=l,o},i.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var o=[],l=0,f=t.length;l<f;++l)o.push(this.writeFeatureObject(t[l],e));return{features:o}},i}(Dg),QI=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Dh=function(s){function i(){var t=s.call(this)||this;return t.Jp=q1(),t}return QI(i,s),i.prototype.getType=function(){return"xml"},i.prototype.readFeature=function(t,e){if(t){if(typeof t=="string"){var o=yl(t);return this.readFeatureFromDocument(o,e)}return ml(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}return null},i.prototype.readFeatureFromDocument=function(t,e){var o=this.readFeaturesFromDocument(t,e);return o.length>0?o[0]:null},i.prototype.readFeatureFromNode=function(t,e){return null},i.prototype.readFeatures=function(t,e){if(t){if(typeof t=="string"){var o=yl(t);return this.readFeaturesFromDocument(o,e)}return ml(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}return[]},i.prototype.readFeaturesFromDocument=function(t,e){for(var o=[],l=t.firstChild;l;l=l.nextSibling)l.nodeType==Node.ELEMENT_NODE&&ut(o,this.readFeaturesFromNode(l,e));return o},i.prototype.readFeaturesFromNode=function(t,e){return E()},i.prototype.readGeometry=function(t,e){if(t){if(typeof t=="string"){var o=yl(t);return this.readGeometryFromDocument(o,e)}return ml(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}return null},i.prototype.readGeometryFromDocument=function(t,e){return null},i.prototype.readGeometryFromNode=function(t,e){return null},i.prototype.readProjection=function(t){if(t){if(typeof t=="string"){var e=yl(t);return this.readProjectionFromDocument(e)}return ml(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}return null},i.prototype.readProjectionFromDocument=function(t){return this.dataProjection},i.prototype.readProjectionFromNode=function(t){return this.dataProjection},i.prototype.writeFeature=function(t,e){var o=this.writeFeatureNode(t,e);return this.Jp.serializeToString(o)},i.prototype.writeFeatureNode=function(t,e){return null},i.prototype.writeFeatures=function(t,e){var o=this.writeFeaturesNode(t,e);return this.Jp.serializeToString(o)},i.prototype.writeFeaturesNode=function(t,e){return null},i.prototype.writeGeometry=function(t,e){var o=this.writeGeometryNode(t,e);return this.Jp.serializeToString(o)},i.prototype.writeGeometryNode=function(t,e){return null},i}(Gp),tM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ru="http://www.opengis.net/gml",eM=/^[\s\xa0]*$/,mo=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.featureType=o.featureType,e.featureNS=o.featureNS,e.srsName=o.srsName,e.schemaLocation="",e.FEATURE_COLLECTION_PARSERS={},e.FEATURE_COLLECTION_PARSERS[e.namespace]={featureMember:kr(e.readFeaturesInternal),featureMembers:$r(e.readFeaturesInternal)},e.supportedMediaTypes=["application/gml+xml"],e}return tM(i,s),i.prototype.readFeaturesInternal=function(t,e){var o=t.localName,l=null;if(o=="FeatureCollection")l=He([],this.FEATURE_COLLECTION_PARSERS,t,e,this);else if(o=="featureMembers"||o=="featureMember"||o=="member"){var f=e[0],y=f.featureType,w=f.featureNS;if(!y&&t.childNodes){y=[],w={};for(var b=0,I=t.childNodes.length;b<I;++b){var N=t.childNodes[b];if(N.nodeType===1){var D=N.nodeName.split(":").pop();if(y.indexOf(D)===-1){var j="",H=0,Z=N.namespaceURI;for(var it in w){if(w[it]===Z){j=it;break}++H}j||(w[j="p"+H]=Z),y.push(j+":"+D)}}}o!="featureMember"&&(f.featureType=y,f.featureNS=w)}if(typeof w=="string"){var at=w;(w={}).p0=at}var wt={},gt=Array.isArray(y)?y:[y];for(var yt in w){var It={};for(b=0,I=gt.length;b<I;++b)(gt[b].indexOf(":")===-1?"p0":gt[b].split(":")[0])===yt&&(It[gt[b].split(":").pop()]=o=="featureMembers"?kr(this.readFeatureElement,this):$r(this.readFeatureElement,this));wt[w[yt]]=It}l=He(o=="featureMember"||o=="member"?void 0:[],wt,t,e)}return l===null&&(l=[]),l},i.prototype.readGeometryOrExtent=function(t,e){var o=e[0];return o.srsName=t.firstElementChild.getAttribute("srsName"),o.srsDimension=t.firstElementChild.getAttribute("srsDimension"),He(null,this.GEOMETRY_PARSERS,t,e,this)},i.prototype.readExtentElement=function(t,e){var o=e[0],l=this.readGeometryOrExtent(t,e);return l?kg(l,o):void 0},i.prototype.readGeometryElement=function(t,e){var o=e[0],l=this.readGeometryOrExtent(t,e);return l?qn(l,!1,o):void 0},i.prototype.readFeatureElementInternal=function(t,e,o){for(var l,f={},y=t.firstElementChild;y;y=y.nextElementSibling){var w=void 0,b=y.localName;y.childNodes.length===0||y.childNodes.length===1&&(y.firstChild.nodeType===3||y.firstChild.nodeType===4)?(w=fs(y,!1),eM.test(w)&&(w=void 0)):(o&&(w=b==="boundedBy"?this.readExtentElement(y,e):this.readGeometryElement(y,e)),w?b!=="boundedBy"&&(l=b):w=this.readFeatureElementInternal(y,e,!1));var I=y.attributes.length;if(I>0){w={Qp:w};for(var N=0;N<I;N++)w[y.attributes[N].name]=y.attributes[N].value}f[b]?(f[b]instanceof Array||(f[b]=[f[b]]),f[b].push(w)):f[b]=w}if(o){var D=new Mr(f);l&&D.setGeometryName(l);var j=t.getAttribute("fid")||U1(t,this.namespace,"id");return j&&D.setId(j),D}return f},i.prototype.readFeatureElement=function(t,e){return this.readFeatureElementInternal(t,e,!0)},i.prototype.readPoint=function(t,e){var o=this.readFlatCoordinatesFromNode(t,e);if(o)return new rn(o,Vr)},i.prototype.readMultiPoint=function(t,e){var o=He([],this.MULTIPOINT_PARSERS,t,e,this);return o?new Va(o):void 0},i.prototype.readMultiLineString=function(t,e){var o=He([],this.MULTILINESTRING_PARSERS,t,e,this);if(o)return new Ks(o)},i.prototype.readMultiPolygon=function(t,e){var o=He([],this.MULTIPOLYGON_PARSERS,t,e,this);if(o)return new Ua(o)},i.prototype.pointMemberParser=function(t,e){ks(this.POINTMEMBER_PARSERS,t,e,this)},i.prototype.lineStringMemberParser=function(t,e){ks(this.LINESTRINGMEMBER_PARSERS,t,e,this)},i.prototype.polygonMemberParser=function(t,e){ks(this.POLYGONMEMBER_PARSERS,t,e,this)},i.prototype.readLineString=function(t,e){var o=this.readFlatCoordinatesFromNode(t,e);return o?new uo(o,Vr):void 0},i.prototype.readFlatLinearRing=function(t,e){var o=He(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this);return o||void 0},i.prototype.readLinearRing=function(t,e){var o=this.readFlatCoordinatesFromNode(t,e);if(o)return new Xc(o,Vr)},i.prototype.readPolygon=function(t,e){var o=He([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this);if(o&&o[0]){var l,f=o[0],y=[f.length],w=void 0;for(w=1,l=o.length;w<l;++w)ut(f,o[w]),y.push(f.length);return new Lo(f,Vr,y)}},i.prototype.readFlatCoordinatesFromNode=function(t,e){return He(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},i.prototype.readGeometryFromNode=function(t,e){var o=this.readGeometryElement(t,[this.getReadOptions(t,e||{})]);return o||null},i.prototype.readFeaturesFromNode=function(t,e){var o={featureType:this.featureType,featureNS:this.featureNS};return e&&Vt(o,this.getReadOptions(t,e)),this.readFeaturesInternal(t,[o])||[]},i.prototype.readProjectionFromNode=function(t){return ie(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},i}(Dh);mo.prototype.namespace=Ru,mo.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},mo.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},mo.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},mo.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:kr(mo.prototype.pointMemberParser),pointMembers:kr(mo.prototype.pointMemberParser)}},mo.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:kr(mo.prototype.lineStringMemberParser),lineStringMembers:kr(mo.prototype.lineStringMemberParser)}},mo.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:kr(mo.prototype.polygonMemberParser),polygonMembers:kr(mo.prototype.polygonMemberParser)}},mo.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:kr(mo.prototype.readFlatCoordinatesFromNode)}},mo.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:kr(mo.prototype.readLineString)}},mo.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:kr(mo.prototype.readPolygon)}},mo.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:$r(mo.prototype.readFlatLinearRing)}};var Ni=mo;function Mc(s){return ku(fs(s,!1))}function ku(s){var i=/^\s*(true|1)|(false|0)\s*$/.exec(s);return i?i[1]!==void 0||!1:void 0}function om(s){var i=fs(s,!1),t=Date.parse(i);return isNaN(t)?void 0:t/1e3}function yn(s){return tc(fs(s,!1))}function tc(s){var i=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(s);return i?parseFloat(i[1]):void 0}function yo(s){return ec(fs(s,!1))}function ec(s){var i=/^\s*(\d+)\s*$/.exec(s);return i?parseInt(i[1],10):void 0}function Je(s){return fs(s,!1).trim()}function Gh(s,i){ni(s,i?"1":"0")}function Ww(s,i){s.appendChild(_h().createCDATASection(i))}function Yw(s,i){var t=new Date(1e3*i),e=t.getUTCFullYear()+"-"+lo(t.getUTCMonth()+1,2)+"-"+lo(t.getUTCDate(),2)+"T"+lo(t.getUTCHours(),2)+":"+lo(t.getUTCMinutes(),2)+":"+lo(t.getUTCSeconds(),2)+"Z";s.appendChild(_h().createTextNode(e))}function js(s,i){var t=i.toPrecision();s.appendChild(_h().createTextNode(t))}function Sd(s,i){var t=i.toString();s.appendChild(_h().createTextNode(t))}function ni(s,i){s.appendChild(_h().createTextNode(i))}var rM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),iM={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},ln=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this,o)||this).FEATURE_COLLECTION_PARSERS[Ru].featureMember=kr(e.readFeaturesInternal),e.schemaLocation=o.schemaLocation?o.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",e}return rM(i,s),i.prototype.readFlatCoordinates=function(t,e){var o=fs(t,!1).replace(/^\s*|\s*$/g,""),l=e[0].srsName,f="enu";if(l){var y=ie(l);y&&(f=y.getAxisOrientation())}for(var w=o.trim().split(/\s+/),b=[],I=0,N=w.length;I<N;I++){var D=w[I].split(/,+/),j=parseFloat(D[0]),H=parseFloat(D[1]),Z=D.length===3?parseFloat(D[2]):0;f.substr(0,2)==="en"?b.push(j,H,Z):b.push(H,j,Z)}return b},i.prototype.readBox=function(t,e){var o=He([null],this.ty,t,e,this);return En(o[1][0],o[1][1],o[1][3],o[1][4])},i.prototype.innerBoundaryIsParser=function(t,e){var o=He(void 0,this.RING_PARSERS,t,e,this);o&&e[e.length-1].push(o)},i.prototype.outerBoundaryIsParser=function(t,e){var o=He(void 0,this.RING_PARSERS,t,e,this);o&&(e[e.length-1][0]=o)},i.prototype.ny=function(t,e,o){var l,f=e[e.length-1],y=f.multiSurface,w=f.surface,b=f.multiCurve;return Array.isArray(t)?l="Envelope":(l=t.getType())==="MultiPolygon"&&y===!0?l="MultiSurface":l==="Polygon"&&w===!0?l="Surface":l==="MultiLineString"&&b===!0&&(l="MultiCurve"),ai("http://www.opengis.net/gml",l)},i.prototype.writeFeatureElement=function(t,e,o){var l=e.getId();l&&t.setAttribute("fid",l);var f=o[o.length-1],y=f.featureNS,w=e.getGeometryName();f.serializers||(f.serializers={},f.serializers[y]={});var b=[],I=[];if(e.hasProperties()){var N=e.getProperties();for(var D in N){var j=N[D];j!==null&&(b.push(D),I.push(j),D==w||typeof j.getSimplifiedGeometry=="function"?D in f.serializers[y]||(f.serializers[y][D]=Jt(this.writeGeometryElement,this)):D in f.serializers[y]||(f.serializers[y][D]=Jt(ni)))}}var H=Vt({},f);H.node=t,li(H,f.serializers,oo(void 0,y),I,o,b)},i.prototype.writeCurveOrLineString=function(t,e,o){var l=o[o.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&l&&t.setAttribute("srsName",l),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){var f=this.iy(t.namespaceURI);t.appendChild(f),this.ey(f,e,o)}else if(t.nodeName==="Curve"){var y=ai(t.namespaceURI,"segments");t.appendChild(y),this.oy(y,e,o)}},i.prototype.writeLineStringOrCurveMember=function(t,e,o){var l=this.ny(e,o);l&&(t.appendChild(l),this.writeCurveOrLineString(l,e,o))},i.prototype.writeMultiCurveOrLineString=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName,w=l.curve;y&&t.setAttribute("srsName",y);var b=e.getLineStrings();li({node:t,hasZ:f,srsName:y,curve:w},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.sy,b,o,void 0,this)},i.prototype.writeGeometryElement=function(t,e,o){var l,f=o[o.length-1],y=Vt({},f);y.node=t,l=Array.isArray(e)?kg(e,f):qn(e,!0,f),li(y,this.GEOMETRY_SERIALIZERS,this.ny,[l],o,void 0,this)},i.prototype.iy=function(t){var e=ai(t,"coordinates");return e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," "),e},i.prototype.ey=function(t,e,o){for(var l=o[o.length-1],f=l.hasZ,y=l.srsName,w=e.getCoordinates(),b=w.length,I=new Array(b),N=0;N<b;++N){var D=w[N];I[N]=this.uy(D,y,f)}ni(t,I.join(" "))},i.prototype.oy=function(t,e,o){var l=ai(t.namespaceURI,"LineStringSegment");t.appendChild(l),this.writeCurveOrLineString(l,e,o)},i.prototype.writeSurfaceOrPolygon=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName;if(t.nodeName!=="PolygonPatch"&&y&&t.setAttribute("srsName",y),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){var w=e.getLinearRings();li({node:t,hasZ:f,srsName:y},this.RING_SERIALIZERS,this.hy,w,o,void 0,this)}else if(t.nodeName==="Surface"){var b=ai(t.namespaceURI,"patches");t.appendChild(b),this.ly(b,e,o)}},i.prototype.hy=function(t,e,o){var l=e[e.length-1],f=l.node,y=l.exteriorWritten;return y===void 0&&(l.exteriorWritten=!0),ai(f.namespaceURI,y!==void 0?"innerBoundaryIs":"outerBoundaryIs")},i.prototype.ly=function(t,e,o){var l=ai(t.namespaceURI,"PolygonPatch");t.appendChild(l),this.writeSurfaceOrPolygon(l,e,o)},i.prototype.writeRing=function(t,e,o){var l=ai(t.namespaceURI,"LinearRing");t.appendChild(l),this.writeLinearRing(l,e,o)},i.prototype.uy=function(t,e,o){var l="enu";e&&(l=ie(e).getAxisOrientation());var f=l.substr(0,2)==="en"?t[0]+","+t[1]:t[1]+","+t[0];return o&&(f+=","+(t[2]||0)),f},i.prototype.writePoint=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName;y&&t.setAttribute("srsName",y);var w=this.iy(t.namespaceURI);t.appendChild(w);var b=e.getCoordinates();ni(w,this.uy(b,y,f))},i.prototype.writeMultiPoint=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName;y&&t.setAttribute("srsName",y);var w=e.getPoints();li({node:t,hasZ:f,srsName:y},this.POINTMEMBER_SERIALIZERS,oo("pointMember"),w,o,void 0,this)},i.prototype.writePointMember=function(t,e,o){var l=ai(t.namespaceURI,"Point");t.appendChild(l),this.writePoint(l,e,o)},i.prototype.writeLinearRing=function(t,e,o){var l=o[o.length-1].srsName;l&&t.setAttribute("srsName",l);var f=this.iy(t.namespaceURI);t.appendChild(f),this.ey(f,e,o)},i.prototype.writeMultiSurfaceOrPolygon=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName,w=l.surface;y&&t.setAttribute("srsName",y);var b=e.getPolygons();li({node:t,hasZ:f,srsName:y,surface:w},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.sy,b,o,void 0,this)},i.prototype.writeSurfaceOrPolygonMember=function(t,e,o){var l=this.ny(e,o);l&&(t.appendChild(l),this.writeSurfaceOrPolygon(l,e,o))},i.prototype.writeEnvelope=function(t,e,o){var l=o[o.length-1].srsName;l&&t.setAttribute("srsName",l);var f=[e[0]+" "+e[1],e[2]+" "+e[3]];li({node:t},this.ENVELOPE_SERIALIZERS,Bo,f,o,["lowerCorner","upperCorner"],this)},i.prototype.sy=function(t,e,o){var l=e[e.length-1].node;return ai("http://www.opengis.net/gml",iM[l.nodeName])},i}(Ni);ln.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:$r(ln.prototype.readFlatCoordinates)}},ln.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:ln.prototype.innerBoundaryIsParser,outerBoundaryIs:ln.prototype.outerBoundaryIsParser}},ln.prototype.ty={"http://www.opengis.net/gml":{coordinates:kr(ln.prototype.readFlatCoordinates)}},ln.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:$r(Ni.prototype.readPoint),MultiPoint:$r(Ni.prototype.readMultiPoint),LineString:$r(Ni.prototype.readLineString),MultiLineString:$r(Ni.prototype.readMultiLineString),LinearRing:$r(Ni.prototype.readLinearRing),Polygon:$r(Ni.prototype.readPolygon),MultiPolygon:$r(Ni.prototype.readMultiPolygon),Box:$r(ln.prototype.readBox)}},ln.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:Jt(ln.prototype.writeCurveOrLineString),MultiCurve:Jt(ln.prototype.writeMultiCurveOrLineString),Point:Jt(ln.prototype.writePoint),MultiPoint:Jt(ln.prototype.writeMultiPoint),LineString:Jt(ln.prototype.writeCurveOrLineString),MultiLineString:Jt(ln.prototype.writeMultiCurveOrLineString),LinearRing:Jt(ln.prototype.writeLinearRing),Polygon:Jt(ln.prototype.writeSurfaceOrPolygon),MultiPolygon:Jt(ln.prototype.writeMultiSurfaceOrPolygon),Surface:Jt(ln.prototype.writeSurfaceOrPolygon),MultiSurface:Jt(ln.prototype.writeMultiSurfaceOrPolygon),Envelope:Jt(ln.prototype.writeEnvelope)}},ln.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:Jt(ln.prototype.writeLineStringOrCurveMember),curveMember:Jt(ln.prototype.writeLineStringOrCurveMember)}},ln.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:Jt(ln.prototype.writeRing),innerBoundaryIs:Jt(ln.prototype.writeRing)}},ln.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:Jt(ln.prototype.writePointMember)}},ln.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:Jt(ln.prototype.writeSurfaceOrPolygonMember),polygonMember:Jt(ln.prototype.writeSurfaceOrPolygonMember)}},ln.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:Jt(ni),upperCorner:Jt(ni)}};var jh=ln,nM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),oM={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Dr=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this,o)||this).vy=o.surface!==void 0&&o.surface,e.py=o.curve!==void 0&&o.curve,e.yy=o.multiCurve===void 0||o.multiCurve,e.my=o.multiSurface===void 0||o.multiSurface,e.schemaLocation=o.schemaLocation?o.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",e.hasZ=o.hasZ!==void 0&&o.hasZ,e}return nM(i,s),i.prototype.readMultiCurve=function(t,e){var o=He([],this.MULTICURVE_PARSERS,t,e,this);return o?new Ks(o):void 0},i.prototype.readFlatCurveRing=function(t,e){for(var o=He([],this.MULTICURVE_PARSERS,t,e,this),l=[],f=0,y=o.length;f<y;++f)ut(l,o[f].getFlatCoordinates());return l},i.prototype.readMultiSurface=function(t,e){var o=He([],this.MULTISURFACE_PARSERS,t,e,this);if(o)return new Ua(o)},i.prototype.curveMemberParser=function(t,e){ks(this.CURVEMEMBER_PARSERS,t,e,this)},i.prototype.surfaceMemberParser=function(t,e){ks(this.SURFACEMEMBER_PARSERS,t,e,this)},i.prototype.readPatch=function(t,e){return He([null],this.PATCHES_PARSERS,t,e,this)},i.prototype.readSegment=function(t,e){return He([],this.SEGMENTS_PARSERS,t,e,this)},i.prototype.readPolygonPatch=function(t,e){return He([null],this.FLAT_LINEAR_RINGS_PARSERS,t,e,this)},i.prototype.readLineStringSegment=function(t,e){return He([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,e,this)},i.prototype.interiorParser=function(t,e){var o=He(void 0,this.RING_PARSERS,t,e,this);o&&e[e.length-1].push(o)},i.prototype.exteriorParser=function(t,e){var o=He(void 0,this.RING_PARSERS,t,e,this);o&&(e[e.length-1][0]=o)},i.prototype.readSurface=function(t,e){var o=He([null],this.SURFACE_PARSERS,t,e,this);if(o&&o[0]){var l,f=o[0],y=[f.length],w=void 0;for(w=1,l=o.length;w<l;++w)ut(f,o[w]),y.push(f.length);return new Lo(f,Vr,y)}},i.prototype.readCurve=function(t,e){var o=He([null],this.CURVE_PARSERS,t,e,this);return o?new uo(o,Vr):void 0},i.prototype.readEnvelope=function(t,e){var o=He([null],this.ENVELOPE_PARSERS,t,e,this);return En(o[1][0],o[1][1],o[2][0],o[2][1])},i.prototype.readFlatPos=function(t,e){for(var o,l=fs(t,!1),f=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,y=[];o=f.exec(l);)y.push(parseFloat(o[1])),l=l.substr(o[0].length);if(l===""){var w=e[0].srsName,b="enu";if(w&&(b=ie(w).getAxisOrientation()),b==="neu"){var I,N=void 0;for(N=0,I=y.length;N<I;N+=3){var D=y[N],j=y[N+1];y[N]=j,y[N+1]=D}}var H=y.length;if(H==2&&y.push(0),H!==0)return y}},i.prototype.readFlatPosList=function(t,e){var o=fs(t,!1).replace(/^\s*|\s*$/g,""),l=e[0],f=l.srsName,y=l.srsDimension,w="enu";f&&(w=ie(f).getAxisOrientation());var b,I,N,D=o.split(/\s+/),j=2;t.getAttribute("srsDimension")?j=ec(t.getAttribute("srsDimension")):t.getAttribute("dimension")?j=ec(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?j=ec(t.parentNode.getAttribute("srsDimension")):y&&(j=ec(y));for(var H=[],Z=0,it=D.length;Z<it;Z+=j)b=parseFloat(D[Z]),I=parseFloat(D[Z+1]),N=j===3?parseFloat(D[Z+2]):0,w.substr(0,2)==="en"?H.push(b,I,N):H.push(I,b,N);return H},i.prototype.wy=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=f?"3":"2";t.setAttribute("srsDimension",y);var w=l.srsName,b="enu";w&&(b=ie(w).getAxisOrientation());var I,N=e.getCoordinates();I=b.substr(0,2)==="en"?N[0]+" "+N[1]:N[1]+" "+N[0],f&&(I+=" "+(N[2]||0)),ni(t,I)},i.prototype.uy=function(t,e,o){var l="enu";e&&(l=ie(e).getAxisOrientation());var f=l.substr(0,2)==="en"?t[0]+" "+t[1]:t[1]+" "+t[0];return o&&(f+=" "+(t[2]||0)),f},i.prototype.gy=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=f?"3":"2";t.setAttribute("srsDimension",y);for(var w,b=l.srsName,I=e.getCoordinates(),N=I.length,D=new Array(N),j=0;j<N;++j)w=I[j],D[j]=this.uy(w,b,f);ni(t,D.join(" "))},i.prototype.writePoint=function(t,e,o){var l=o[o.length-1].srsName;l&&t.setAttribute("srsName",l);var f=ai(t.namespaceURI,"pos");t.appendChild(f),this.wy(f,e,o)},i.prototype.writeEnvelope=function(t,e,o){var l=o[o.length-1].srsName;l&&t.setAttribute("srsName",l);var f=[e[0]+" "+e[1],e[2]+" "+e[3]];li({node:t},this.ENVELOPE_SERIALIZERS,Bo,f,o,["lowerCorner","upperCorner"],this)},i.prototype.writeLinearRing=function(t,e,o){var l=o[o.length-1].srsName;l&&t.setAttribute("srsName",l);var f=ai(t.namespaceURI,"posList");t.appendChild(f),this.gy(f,e,o)},i.prototype.hy=function(t,e,o){var l=e[e.length-1],f=l.node,y=l.exteriorWritten;return y===void 0&&(l.exteriorWritten=!0),ai(f.namespaceURI,y!==void 0?"interior":"exterior")},i.prototype.writeSurfaceOrPolygon=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName;if(t.nodeName!=="PolygonPatch"&&y&&t.setAttribute("srsName",y),t.nodeName==="Polygon"||t.nodeName==="PolygonPatch"){var w=e.getLinearRings();li({node:t,hasZ:f,srsName:y},this.RING_SERIALIZERS,this.hy,w,o,void 0,this)}else if(t.nodeName==="Surface"){var b=ai(t.namespaceURI,"patches");t.appendChild(b),this.ly(b,e,o)}},i.prototype.writeCurveOrLineString=function(t,e,o){var l=o[o.length-1].srsName;if(t.nodeName!=="LineStringSegment"&&l&&t.setAttribute("srsName",l),t.nodeName==="LineString"||t.nodeName==="LineStringSegment"){var f=ai(t.namespaceURI,"posList");t.appendChild(f),this.gy(f,e,o)}else if(t.nodeName==="Curve"){var y=ai(t.namespaceURI,"segments");t.appendChild(y),this.oy(y,e,o)}},i.prototype.writeMultiSurfaceOrPolygon=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName,w=l.surface;y&&t.setAttribute("srsName",y);var b=e.getPolygons();li({node:t,hasZ:f,srsName:y,surface:w},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.sy,b,o,void 0,this)},i.prototype.writeMultiPoint=function(t,e,o){var l=o[o.length-1],f=l.srsName,y=l.hasZ;f&&t.setAttribute("srsName",f);var w=e.getPoints();li({node:t,hasZ:y,srsName:f},this.POINTMEMBER_SERIALIZERS,oo("pointMember"),w,o,void 0,this)},i.prototype.writeMultiCurveOrLineString=function(t,e,o){var l=o[o.length-1],f=l.hasZ,y=l.srsName,w=l.curve;y&&t.setAttribute("srsName",y);var b=e.getLineStrings();li({node:t,hasZ:f,srsName:y,curve:w},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.sy,b,o,void 0,this)},i.prototype.writeRing=function(t,e,o){var l=ai(t.namespaceURI,"LinearRing");t.appendChild(l),this.writeLinearRing(l,e,o)},i.prototype.writeSurfaceOrPolygonMember=function(t,e,o){var l=this.ny(e,o);l&&(t.appendChild(l),this.writeSurfaceOrPolygon(l,e,o))},i.prototype.writePointMember=function(t,e,o){var l=ai(t.namespaceURI,"Point");t.appendChild(l),this.writePoint(l,e,o)},i.prototype.writeLineStringOrCurveMember=function(t,e,o){var l=this.ny(e,o);l&&(t.appendChild(l),this.writeCurveOrLineString(l,e,o))},i.prototype.ly=function(t,e,o){var l=ai(t.namespaceURI,"PolygonPatch");t.appendChild(l),this.writeSurfaceOrPolygon(l,e,o)},i.prototype.oy=function(t,e,o){var l=ai(t.namespaceURI,"LineStringSegment");t.appendChild(l),this.writeCurveOrLineString(l,e,o)},i.prototype.writeGeometryElement=function(t,e,o){var l,f=o[o.length-1],y=Vt({},f);y.node=t,l=Array.isArray(e)?kg(e,f):qn(e,!0,f),li(y,this.GEOMETRY_SERIALIZERS,this.ny,[l],o,void 0,this)},i.prototype.writeFeatureElement=function(t,e,o){var l=e.getId();l&&t.setAttribute("fid",l);var f=o[o.length-1],y=f.featureNS,w=e.getGeometryName();f.serializers||(f.serializers={},f.serializers[y]={});var b=[],I=[];if(e.hasProperties()){var N=e.getProperties();for(var D in N){var j=N[D];j!==null&&(b.push(D),I.push(j),D==w||typeof j.getSimplifiedGeometry=="function"?D in f.serializers[y]||(f.serializers[y][D]=Jt(this.writeGeometryElement,this)):D in f.serializers[y]||(f.serializers[y][D]=Jt(ni)))}}var H=Vt({},f);H.node=t,li(H,f.serializers,oo(void 0,y),I,o,b)},i.prototype.xy=function(t,e,o){var l=o[o.length-1],f=l.featureType,y=l.featureNS,w={};w[y]={},w[y][f]=Jt(this.writeFeatureElement,this);var b=Vt({},l);b.node=t,li(b,w,oo(f,y),e,o)},i.prototype.sy=function(t,e,o){var l=e[e.length-1].node;return ai(this.namespace,oM[l.nodeName])},i.prototype.ny=function(t,e,o){var l,f=e[e.length-1],y=f.multiSurface,w=f.surface,b=f.curve,I=f.multiCurve;return Array.isArray(t)?l="Envelope":(l=t.getType())==="MultiPolygon"&&y===!0?l="MultiSurface":l==="Polygon"&&w===!0?l="Surface":l==="LineString"&&b===!0?l="Curve":l==="MultiLineString"&&I===!0&&(l="MultiCurve"),ai(this.namespace,l)},i.prototype.writeGeometryNode=function(t,e){e=this.adaptOptions(e);var o=ai(this.namespace,"geom"),l={node:o,hasZ:this.hasZ,srsName:this.srsName,curve:this.py,surface:this.vy,multiSurface:this.my,multiCurve:this.yy};return e&&Vt(l,e),this.writeGeometryElement(o,t,[l]),o},i.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var o=ai(this.namespace,"featureMembers");o.setAttributeNS(cu,"xsi:schemaLocation",this.schemaLocation);var l={srsName:this.srsName,hasZ:this.hasZ,curve:this.py,surface:this.vy,multiSurface:this.my,multiCurve:this.yy,featureNS:this.featureNS,featureType:this.featureType};return e&&Vt(l,e),this.xy(o,t,[l]),o},i}(Ni);Dr.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:$r(Dr.prototype.readFlatPos),posList:$r(Dr.prototype.readFlatPosList),coordinates:$r(jh.prototype.readFlatCoordinates)}},Dr.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:Dr.prototype.interiorParser,exterior:Dr.prototype.exteriorParser}},Dr.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:$r(Ni.prototype.readPoint),MultiPoint:$r(Ni.prototype.readMultiPoint),LineString:$r(Ni.prototype.readLineString),MultiLineString:$r(Ni.prototype.readMultiLineString),LinearRing:$r(Ni.prototype.readLinearRing),Polygon:$r(Ni.prototype.readPolygon),MultiPolygon:$r(Ni.prototype.readMultiPolygon),Surface:$r(Dr.prototype.readSurface),MultiSurface:$r(Dr.prototype.readMultiSurface),Curve:$r(Dr.prototype.readCurve),MultiCurve:$r(Dr.prototype.readMultiCurve),Envelope:$r(Dr.prototype.readEnvelope)}},Dr.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:kr(Dr.prototype.curveMemberParser),curveMembers:kr(Dr.prototype.curveMemberParser)}},Dr.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:kr(Dr.prototype.surfaceMemberParser),surfaceMembers:kr(Dr.prototype.surfaceMemberParser)}},Dr.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:kr(Ni.prototype.readLineString),Curve:kr(Dr.prototype.readCurve)}},Dr.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:kr(Ni.prototype.readPolygon),Surface:kr(Dr.prototype.readSurface)}},Dr.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:$r(Dr.prototype.readPatch)}},Dr.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:$r(Dr.prototype.readSegment)}},Dr.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:kr(Dr.prototype.readFlatPosList),upperCorner:kr(Dr.prototype.readFlatPosList)}},Dr.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:$r(Dr.prototype.readPolygonPatch)}},Dr.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:Ff(Dr.prototype.readLineStringSegment)}},Ni.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:$r(Ni.prototype.readFlatLinearRing),Ring:$r(Dr.prototype.readFlatCurveRing)}},Dr.prototype.writeFeatures,Dr.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:Jt(Dr.prototype.writeRing),interior:Jt(Dr.prototype.writeRing)}},Dr.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:Jt(ni),upperCorner:Jt(ni)}},Dr.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:Jt(Dr.prototype.writeSurfaceOrPolygonMember),polygonMember:Jt(Dr.prototype.writeSurfaceOrPolygonMember)}},Dr.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:Jt(Dr.prototype.writePointMember)}},Dr.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:Jt(Dr.prototype.writeLineStringOrCurveMember),curveMember:Jt(Dr.prototype.writeLineStringOrCurveMember)}},Dr.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:Jt(Dr.prototype.writeCurveOrLineString),MultiCurve:Jt(Dr.prototype.writeMultiCurveOrLineString),Point:Jt(Dr.prototype.writePoint),MultiPoint:Jt(Dr.prototype.writeMultiPoint),LineString:Jt(Dr.prototype.writeCurveOrLineString),MultiLineString:Jt(Dr.prototype.writeMultiCurveOrLineString),LinearRing:Jt(Dr.prototype.writeLinearRing),Polygon:Jt(Dr.prototype.writeSurfaceOrPolygon),MultiPolygon:Jt(Dr.prototype.writeMultiSurfaceOrPolygon),Surface:Jt(Dr.prototype.writeSurfaceOrPolygon),MultiSurface:Jt(Dr.prototype.writeMultiSurfaceOrPolygon),Envelope:Jt(Dr.prototype.writeEnvelope)}};var Ri=Dr,i0=Ri;i0.prototype.writeFeatures,i0.prototype.writeFeaturesNode;var sM=i0,aM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),bn=function(s){function i(t){var e=this,o=t||{};return(e=s.call(this,o)||this).schemaLocation=o.schemaLocation?o.schemaLocation:e.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",e}return aM(i,s),i}(Ri);bn.prototype.namespace="http://www.opengis.net/gml/3.2",bn.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:$r(Ri.prototype.readFlatPos),posList:$r(Ri.prototype.readFlatPosList),coordinates:$r(jh.prototype.readFlatCoordinates)}},bn.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:Ri.prototype.interiorParser,exterior:Ri.prototype.exteriorParser}},bn.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:$r(Ni.prototype.readPoint),MultiPoint:$r(Ni.prototype.readMultiPoint),LineString:$r(Ni.prototype.readLineString),MultiLineString:$r(Ni.prototype.readMultiLineString),LinearRing:$r(Ni.prototype.readLinearRing),Polygon:$r(Ni.prototype.readPolygon),MultiPolygon:$r(Ni.prototype.readMultiPolygon),Surface:$r(bn.prototype.readSurface),MultiSurface:$r(Ri.prototype.readMultiSurface),Curve:$r(bn.prototype.readCurve),MultiCurve:$r(Ri.prototype.readMultiCurve),Envelope:$r(bn.prototype.readEnvelope)}},bn.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:kr(Ri.prototype.curveMemberParser),curveMembers:kr(Ri.prototype.curveMemberParser)}},bn.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:kr(Ri.prototype.surfaceMemberParser),surfaceMembers:kr(Ri.prototype.surfaceMemberParser)}},bn.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:kr(Ni.prototype.readLineString),Curve:kr(Ri.prototype.readCurve)}},bn.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:kr(Ni.prototype.readPolygon),Surface:kr(Ri.prototype.readSurface)}},bn.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:$r(Ri.prototype.readPatch)}},bn.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:$r(Ri.prototype.readSegment)}},bn.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:kr(Ri.prototype.readFlatPosList),upperCorner:kr(Ri.prototype.readFlatPosList)}},bn.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:$r(Ri.prototype.readPolygonPatch)}},bn.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:Ff(Ri.prototype.readLineStringSegment)}},bn.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:kr(Ni.prototype.pointMemberParser),pointMembers:kr(Ni.prototype.pointMemberParser)}},bn.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:kr(Ni.prototype.lineStringMemberParser),lineStringMembers:kr(Ni.prototype.lineStringMemberParser)}},bn.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:kr(Ni.prototype.polygonMemberParser),polygonMembers:kr(Ni.prototype.polygonMemberParser)}},bn.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:kr(Ni.prototype.readFlatCoordinatesFromNode)}},bn.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:kr(Ni.prototype.readLineString)}},bn.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:kr(Ni.prototype.readPolygon)}},bn.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:$r(Ni.prototype.readFlatLinearRing),Ring:$r(bn.prototype.readFlatCurveRing)}},bn.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:Jt(Ri.prototype.writeRing),interior:Jt(Ri.prototype.writeRing)}},bn.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:Jt(ni),upperCorner:Jt(ni)}},bn.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:Jt(Ri.prototype.writeSurfaceOrPolygonMember),polygonMember:Jt(Ri.prototype.writeSurfaceOrPolygonMember)}},bn.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:Jt(Ri.prototype.writePointMember)}},bn.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:Jt(Ri.prototype.writeLineStringOrCurveMember),curveMember:Jt(Ri.prototype.writeLineStringOrCurveMember)}},bn.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:Jt(Ri.prototype.writeCurveOrLineString),MultiCurve:Jt(Ri.prototype.writeMultiCurveOrLineString),Point:Jt(bn.prototype.writePoint),MultiPoint:Jt(Ri.prototype.writeMultiPoint),LineString:Jt(Ri.prototype.writeCurveOrLineString),MultiLineString:Jt(Ri.prototype.writeMultiCurveOrLineString),LinearRing:Jt(Ri.prototype.writeLinearRing),Polygon:Jt(Ri.prototype.writeSurfaceOrPolygon),MultiPolygon:Jt(Ri.prototype.writeMultiSurfaceOrPolygon),Surface:Jt(Ri.prototype.writeSurfaceOrPolygon),MultiSurface:Jt(Ri.prototype.writeMultiSurfaceOrPolygon),Envelope:Jt(Ri.prototype.writeEnvelope)}};var sm=bn,lM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),No=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],cM={rte:Zw,trk:$w,wpt:Kw},uM=Le(No,{rte:kr(Zw),trk:kr($w),wpt:kr(Kw)}),hM=Le(No,{text:Zt(Je,"linkText"),type:Zt(Je,"linkType")}),pM=Le(No,{rte:Jt(function(s,i,t){var e=t[0],o=i.getProperties(),l={node:s};l.properties=o;var f=i.getGeometry();if(f.getType()=="LineString"){var y=qn(f,!0,e);l.geometryLayout=y.getLayout(),o.rtept=y.getCoordinates()}var w=t[t.length-1].node,b=bM[w.namespaceURI],I=Rs(o,b);li(l,SM,Bo,I,t,b)}),trk:Jt(function(s,i,t){var e=t[0],o=i.getProperties(),l={node:s};l.properties=o;var f=i.getGeometry();if(f.getType()=="MultiLineString"){var y=qn(f,!0,e);o.trkseg=y.getLineStrings()}var w=t[t.length-1].node,b=CM[w.namespaceURI],I=Rs(o,b);li(l,TM,Bo,I,t,b)}),wpt:Jt(function(s,i,t){var e=t[0],o=t[t.length-1];o.properties=i.getProperties();var l=i.getGeometry();if(l.getType()=="Point"){var f=qn(l,!0,e);o.geometryLayout=f.getLayout(),c0(s,f.getCoordinates(),t)}})}),fM=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.dataProjection=ie("EPSG:4326"),e.My=o.readExtensions,e}return lM(i,s),i.prototype._y=function(t){t||(t=[]);for(var e=0,o=t.length;e<o;++e){var l=t[e];if(this.My){var f=l.get("extensionsNode_")||null;this.My(l,f)}l.set("extensionsNode_",void 0)}},i.prototype.readFeatureFromNode=function(t,e){if(!pt(No,t.namespaceURI))return null;var o=cM[t.localName];if(!o)return null;var l=o(t,[this.getReadOptions(t,e)]);return l?(this._y([l]),l):null},i.prototype.readFeaturesFromNode=function(t,e){if(!pt(No,t.namespaceURI))return[];if(t.localName=="gpx"){var o=He([],uM,t,[this.getReadOptions(t,e)]);return o?(this._y(o),o):[]}return[]},i.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var o=ai("http://www.topografix.com/GPX/1/1","gpx");return o.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",cu),o.setAttributeNS(cu,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),o.setAttribute("version","1.1"),o.setAttribute("creator","OpenLayers"),li({node:o},pM,OM,t,[e]),o},i}(Dh),dM=Le(No,{name:Zt(Je),cmt:Zt(Je),desc:Zt(Je),src:Zt(Je),link:s0,number:Zt(yo),extensions:a0,type:Zt(Je),rtept:function(s,i){var t=He({},gM,s,i);if(t){var e=i[i.length-1],o=e.flatCoordinates,l=e.layoutOptions;n0(o,l,s,t)}}}),gM=Le(No,{ele:Zt(yn),time:Zt(om)}),mM=Le(No,{name:Zt(Je),cmt:Zt(Je),desc:Zt(Je),src:Zt(Je),link:s0,number:Zt(yo),type:Zt(Je),extensions:a0,trkseg:function(s,i){var t=i[i.length-1];ks(yM,s,i);var e=t.flatCoordinates;t.ends.push(e.length)}}),yM=Le(No,{trkpt:function(s,i){var t=He({},vM,s,i);if(t){var e=i[i.length-1],o=e.flatCoordinates,l=e.layoutOptions;n0(o,l,s,t)}}}),vM=Le(No,{ele:Zt(yn),time:Zt(om)}),_M=Le(No,{ele:Zt(yn),time:Zt(om),magvar:Zt(yn),geoidheight:Zt(yn),name:Zt(Je),cmt:Zt(Je),desc:Zt(Je),src:Zt(Je),link:s0,sym:Zt(Je),type:Zt(Je),fix:Zt(Je),sat:Zt(yo),hdop:Zt(yn),vdop:Zt(yn),pdop:Zt(yn),ageofdgpsdata:Zt(yn),dgpsid:Zt(yo),extensions:a0}),xM=["text","type"],wM=Le(No,{text:Jt(ni),type:Jt(ni)}),bM=Le(No,["name","cmt","desc","src","link","number","type","rtept"]),SM=Le(No,{name:Jt(ni),cmt:Jt(ni),desc:Jt(ni),src:Jt(ni),link:Jt(l0),number:Jt(Sd),type:Jt(ni),rtept:hy(Jt(c0))}),EM=Le(No,["ele","time"]),CM=Le(No,["name","cmt","desc","src","link","number","type","trkseg"]),TM=Le(No,{name:Jt(ni),cmt:Jt(ni),desc:Jt(ni),src:Jt(ni),link:Jt(l0),number:Jt(Sd),type:Jt(ni),trkseg:hy(Jt(function(s,i,t){var e={node:s};e.geometryLayout=i.getLayout(),e.properties={},li(e,IM,PM,i.getCoordinates(),t)}))}),PM=oo("trkpt"),IM=Le(No,{trkpt:Jt(c0)}),MM=Le(No,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),LM=Le(No,{ele:Jt(js),time:Jt(Yw),magvar:Jt(js),geoidheight:Jt(js),name:Jt(ni),cmt:Jt(ni),desc:Jt(ni),src:Jt(ni),link:Jt(l0),sym:Jt(ni),type:Jt(ni),fix:Jt(ni),sat:Jt(Sd),hdop:Jt(js),vdop:Jt(js),pdop:Jt(js),ageofdgpsdata:Jt(js),dgpsid:Jt(Sd)}),AM={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function OM(s,i,t){var e=s.getGeometry();if(e){var o=AM[e.getType()];if(o)return ai(i[i.length-1].node.namespaceURI,o)}}function n0(s,i,t,e){return s.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in e?(s.push(e.ele),delete e.ele,i.hasZ=!0):s.push(0),"time"in e?(s.push(e.time),delete e.time,i.hasM=!0):s.push(0),s}function o0(s,i,t){var e=hr,o=2;if(s.hasZ&&s.hasM?(e=Qr,o=4):s.hasZ?(e=Vr,o=3):s.hasM&&(e=yi,o=3),o!==4){for(var l=0,f=i.length/4;l<f;l++)i[l*o]=i[4*l],i[l*o+1]=i[4*l+1],s.hasZ&&(i[l*o+2]=i[4*l+2]),s.hasM&&(i[l*o+2]=i[4*l+3]);if(i.length=i.length/4*o,t)for(l=0,f=t.length;l<f;l++)t[l]=t[l]/4*o}return e}function s0(s,i){var t=i[i.length-1],e=s.getAttribute("href");e!==null&&(t.link=e),ks(hM,s,i)}function a0(s,i){i[i.length-1].Sy=s}function Zw(s,i){var t=i[0],e=He({flatCoordinates:[],layoutOptions:{}},dM,s,i);if(e){var o=e.flatCoordinates;delete e.flatCoordinates;var l=e.layoutOptions;delete e.layoutOptions;var f=o0(l,o),y=new uo(o,f);qn(y,!1,t);var w=new Mr(y);return w.setProperties(e,!0),w}}function $w(s,i){var t=i[0],e=He({flatCoordinates:[],ends:[],layoutOptions:{}},mM,s,i);if(e){var o=e.flatCoordinates;delete e.flatCoordinates;var l=e.ends;delete e.ends;var f=e.layoutOptions;delete e.layoutOptions;var y=o0(f,o,l),w=new Ks(o,y,l);qn(w,!1,t);var b=new Mr(w);return b.setProperties(e,!0),b}}function Kw(s,i){var t=i[0],e=He({},_M,s,i);if(e){var o={},l=n0([],o,s,e),f=o0(o,l),y=new rn(l,f);qn(y,!1,t);var w=new Mr(y);return w.setProperties(e,!0),w}}function l0(s,i,t){s.setAttribute("href",i);var e=t[t.length-1].properties,o=[e.linkText,e.linkType];li({node:s},wM,Bo,o,t,xM)}function c0(s,i,t){var e=t[t.length-1],o=e.node.namespaceURI,l=e.properties;switch(s.setAttributeNS(null,"lat",String(i[1])),s.setAttributeNS(null,"lon",String(i[0])),e.geometryLayout){case Qr:i[3]!==0&&(l.time=i[3]);case Vr:i[2]!==0&&(l.ele=i[2]);break;case yi:i[2]!==0&&(l.time=i[2])}var f=s.nodeName=="rtept"?EM[o]:MM[o],y=Rs(l,f);li({node:s,properties:l},LM,Bo,y,t,f)}var NM=fM,RM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function am(s){return typeof s=="string"?s:""}var Ed,Jw,lm,cm,um,hm,pm=function(s){function i(){return s.call(this)||this}return RM(i,s),i.prototype.getType=function(){return"text"},i.prototype.readFeature=function(t,e){return this.readFeatureFromText(am(t),this.adaptOptions(e))},i.prototype.readFeatureFromText=function(t,e){return E()},i.prototype.readFeatures=function(t,e){return this.readFeaturesFromText(am(t),this.adaptOptions(e))},i.prototype.readFeaturesFromText=function(t,e){return E()},i.prototype.readGeometry=function(t,e){return this.readGeometryFromText(am(t),this.adaptOptions(e))},i.prototype.readGeometryFromText=function(t,e){return E()},i.prototype.readProjection=function(t){return this.readProjectionFromText(am(t))},i.prototype.readProjectionFromText=function(t){return this.dataProjection},i.prototype.writeFeature=function(t,e){return this.writeFeatureText(t,this.adaptOptions(e))},i.prototype.writeFeatureText=function(t,e){return E()},i.prototype.writeFeatures=function(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))},i.prototype.writeFeaturesText=function(t,e){return E()},i.prototype.writeGeometry=function(t,e){return this.writeGeometryText(t,this.adaptOptions(e))},i.prototype.writeGeometryText=function(t,e){return E()},i}(Gp),kM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),FM="barometric",DM="gps",u0="none",GM=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,jM=/^H.([A-Z]{3}).*?:(.*)/,BM=/^HFDTE(\d{2})(\d{2})(\d{2})/,zM=/\r\n|\r|\n/,VM=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.dataProjection=ie("EPSG:4326"),e.Oy=o.altitudeMode?o.altitudeMode:u0,e}return kM(i,s),i.prototype.readFeatureFromText=function(t,e){var o,l,f=this.Oy,y=t.split(zM),w={},b=[],I=2e3,N=0,D=1,j=-1;for(o=0,l=y.length;o<l;++o){var H=y[o],Z=void 0;if(H.charAt(0)=="B"){if(Z=GM.exec(H)){var it=parseInt(Z[1],10),at=parseInt(Z[2],10),wt=parseInt(Z[3],10),gt=parseInt(Z[4],10)+parseInt(Z[5],10)/6e4;Z[6]=="S"&&(gt=-gt);var yt=parseInt(Z[7],10)+parseInt(Z[8],10)/6e4;if(Z[9]=="W"&&(yt=-yt),b.push(yt,gt),f!=u0){var It=void 0;It=f==DM?parseInt(Z[11],10):f==FM?parseInt(Z[12],10):0,b.push(It)}var Rt=Date.UTC(I,N,D,it,at,wt);Rt<j&&(Rt=Date.UTC(I,N,D+1,it,at,wt)),b.push(Rt/1e3),j=Rt}}else H.charAt(0)=="H"&&((Z=BM.exec(H))?(D=parseInt(Z[1],10),N=parseInt(Z[2],10)-1,I=2e3+parseInt(Z[3],10)):(Z=jM.exec(H))&&(w[Z[1]]=Z[2].trim()))}if(b.length===0)return null;var kt=new uo(b,f==u0?yi:Qr),Dt=new Mr(qn(kt,!1,e));return Dt.setProperties(w,!0),Dt},i.prototype.readFeaturesFromText=function(t,e){var o=this.readFeatureFromText(t,e);return o?[o]:[]},i}(pm),UM=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Lc=["http://www.google.com/kml/ext/2.2"],Xr=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Qw={fraction:xh,pixels:fu,insetPixels:fu},qM=Le(Xr,{ExtendedData:fb,Region:db,MultiGeometry:Zt(ub,"geometry"),LineString:Zt(lb,"geometry"),LinearRing:Zt(cb,"geometry"),Point:Zt(hb,"geometry"),Polygon:Zt(pb,"geometry"),Style:Zt(m0),StyleMap:function(s,i){var t=ob.call(this,s,i);if(t){var e=i[i.length-1];Array.isArray(t)?e.Style=t:typeof t=="string"?e.styleUrl=t:Me(!1,38)}},address:Zt(Je),description:Zt(Je),name:Zt(Je),open:Zt(Mc),phoneNumber:Zt(Je),styleUrl:Zt(ib),visibility:Zt(Mc)},Le(Lc,{MultiTrack:Zt(function(s,i){var t=He([],iL,s,i);if(t)return new Ks(t)},"geometry"),Track:Zt(ab,"geometry")})),HM=Le(Xr,{ExtendedData:fb,Region:db,Link:function(s,i){ks(XM,s,i)},address:Zt(Je),description:Zt(Je),name:Zt(Je),open:Zt(Mc),phoneNumber:Zt(Je),visibility:Zt(Mc)}),XM=Le(Xr,{href:Zt(rb)}),tb=Le(Xr,{LatLonAltBox:function(s,i){var t=He({},dL,s,i);if(t){var e=i[i.length-1],o=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];e.extent=o,e.altitudeMode=t.altitudeMode,e.minAltitude=parseFloat(t.minAltitude),e.maxAltitude=parseFloat(t.maxAltitude)}},Lod:function(s,i){var t=He({},gL,s,i);if(t){var e=i[i.length-1];e.minLodPixels=parseFloat(t.minLodPixels),e.maxLodPixels=parseFloat(t.maxLodPixels),e.minFadeExtent=parseFloat(t.minFadeExtent),e.maxFadeExtent=parseFloat(t.maxFadeExtent)}}}),WM=Le(Xr,["Document","Placemark"]),YM=Le(Xr,{Document:Jt(function(s,i,t){li({node:s},vL,_L,i,t,void 0,this)}),Placemark:Jt(xb)}),Cd=null,h0,fm=null,p0,dm=null,Fu=null,f0=null,gm,mm=null;function ym(s){return 32/Math.min(s[0],s[1])}function ZM(s){return s}var $M=function(s){function i(t){var e=s.call(this)||this,o=t||{};return mm||(Cd=new Zs({color:Ed=[255,255,255,1]}),hm="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",fm=new Hf({anchor:Jw=[20,2],anchorOrigin:Cp,anchorXUnits:lm=fu,anchorYUnits:cm=fu,crossOrigin:"anonymous",rotation:0,scale:ym(um=[64,64]),size:um,src:hm}),h0="NO_IMAGE",dm=new Fs({color:Ed,width:1}),p0=new Fs({color:[51,51,51,1],width:2}),Fu=new Ip({font:"bold 16px Helvetica",fill:Cd,stroke:p0,scale:.8}),f0=new ds({fill:Cd,image:fm,text:Fu,stroke:dm,zIndex:0}),mm=[f0]),e.dataProjection=ie("EPSG:4326"),e.jy=o.defaultStyle?o.defaultStyle:mm,e.Ey=o.extractStyles===void 0||o.extractStyles,e.Ty=o.writeStyles===void 0||o.writeStyles,e.Ay={},e.Py=o.showPointNames===void 0||o.showPointNames,e.Bt=o.crossOrigin!==void 0?o.crossOrigin:"anonymous",e.Cy=o.iconUrlFunction?o.iconUrlFunction:ZM,e.supportedMediaTypes=["application/vnd.google-earth.kml+xml"],e}return UM(i,s),i.prototype.ky=function(t,e){var o=He([],Le(Xr,{Document:Ff(this.ky,this),Folder:Ff(this.ky,this),Placemark:kr(this.Iy,this),Style:this.Ny.bind(this),StyleMap:this.Ly.bind(this)}),t,e,this);return o||void 0},i.prototype.Iy=function(t,e){var o=He({geometry:null},qM,t,e,this);if(o){var l=new Mr,f=t.getAttribute("id");f!==null&&l.setId(f);var y=e[0],w=o.geometry;if(w&&qn(w,!1,y),l.setGeometry(w),delete o.geometry,this.Ey){var b=function(I,N,D,j,H){return function(Z,it){var at=H,wt="",gt=[];if(at){var yt=Z.getGeometry();if(yt)if(yt instanceof ns)at=(gt=yt.getGeometriesArrayRecursive().filter(function(Dt){var Xt=Dt.getType();return Xt==="Point"||Xt==="MultiPoint"})).length>0;else{var It=yt.getType();at=It==="Point"||It==="MultiPoint"}}at&&(wt=Z.get("name"),(at=at&&!!wt)&&wt.search(/&[^&]+;/)>-1&&(gm||(gm=document.createElement("textarea")),gm.innerHTML=wt,wt=gm.value));var Rt=D;if(I?Rt=I:N&&(Rt=eb(N,D,j)),at){var kt=function(Dt,Xt){var ee=[0,0],pe="start",xe=Dt.getImage();if(xe){var fe=xe.getSize();if(fe&&fe.length==2){var Re=xe.getScaleArray(),qe=xe.getAnchor();ee[0]=Re[0]*(fe[0]-qe[0]),ee[1]=Re[1]*(fe[1]/2-qe[1]),pe="left"}}var Ge=Dt.getText();return Ge?((Ge=Ge.clone()).setFont(Ge.getFont()||Fu.getFont()),Ge.setScale(Ge.getScale()||Fu.getScale()),Ge.setFill(Ge.getFill()||Fu.getFill()),Ge.setStroke(Ge.getStroke()||p0)):Ge=Fu.clone(),Ge.setText(Xt),Ge.setOffsetX(ee[0]),Ge.setOffsetY(ee[1]),Ge.setTextAlign(pe),new ds({image:xe,text:Ge})}(Rt[0],wt);return gt.length>0?(kt.setGeometry(new ns(gt)),[kt,new ds({geometry:Rt[0].getGeometry(),image:null,fill:Rt[0].getFill(),stroke:Rt[0].getStroke(),text:null})].concat(Rt.slice(1))):kt}return Rt}}(o.Style,o.styleUrl,this.jy,this.Ay,this.Py);l.setStyle(b)}return delete o.Style,l.setProperties(o,!0),l}},i.prototype.Ny=function(t,e){var o=t.getAttribute("id");if(o!==null){var l=m0.call(this,t,e);if(l){var f=void 0,y=t.baseURI;y&&y!="about:blank"||(y=window.location.href),y?f=new URL("#"+o,y).href:f="#"+o,this.Ay[f]=l}}},i.prototype.Ly=function(t,e){var o=t.getAttribute("id");if(o!==null){var l=ob.call(this,t,e);if(l){var f,y=t.baseURI;y&&y!="about:blank"||(y=window.location.href),y?f=new URL("#"+o,y).href:f="#"+o,this.Ay[f]=l}}},i.prototype.readFeatureFromNode=function(t,e){if(!pt(Xr,t.namespaceURI))return null;var o=this.Iy(t,[this.getReadOptions(t,e)]);return o||null},i.prototype.readFeaturesFromNode=function(t,e){if(!pt(Xr,t.namespaceURI))return[];var o,l=t.localName;if(l=="Document"||l=="Folder")return(o=this.ky(t,[this.getReadOptions(t,e)]))||[];if(l=="Placemark"){var f=this.Iy(t,[this.getReadOptions(t,e)]);return f?[f]:[]}if(l=="kml"){o=[];for(var y=t.firstElementChild;y;y=y.nextElementSibling){var w=this.readFeaturesFromNode(y,e);w&&ut(o,w)}return o}return[]},i.prototype.readName=function(t){if(t){if(typeof t=="string"){var e=yl(t);return this.readNameFromDocument(e)}return ml(t)?this.readNameFromDocument(t):this.readNameFromNode(t)}},i.prototype.readNameFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE){var o=this.readNameFromNode(e);if(o)return o}},i.prototype.readNameFromNode=function(t){for(var e=t.firstElementChild;e;e=e.nextElementSibling)if(pt(Xr,e.namespaceURI)&&e.localName=="name")return Je(e);for(e=t.firstElementChild;e;e=e.nextElementSibling){var o=e.localName;if(pt(Xr,e.namespaceURI)&&(o=="Document"||o=="Folder"||o=="Placemark"||o=="kml")){var l=this.readNameFromNode(e);if(l)return l}}},i.prototype.readNetworkLinks=function(t){var e=[];if(typeof t=="string"){var o=yl(t);ut(e,this.readNetworkLinksFromDocument(o))}else ml(t)?ut(e,this.readNetworkLinksFromDocument(t)):ut(e,this.readNetworkLinksFromNode(t));return e},i.prototype.readNetworkLinksFromDocument=function(t){for(var e=[],o=t.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&ut(e,this.readNetworkLinksFromNode(o));return e},i.prototype.readNetworkLinksFromNode=function(t){for(var e=[],o=t.firstElementChild;o;o=o.nextElementSibling)if(pt(Xr,o.namespaceURI)&&o.localName=="NetworkLink"){var l=He({},HM,o,[]);e.push(l)}for(o=t.firstElementChild;o;o=o.nextElementSibling){var f=o.localName;!pt(Xr,o.namespaceURI)||f!="Document"&&f!="Folder"&&f!="kml"||ut(e,this.readNetworkLinksFromNode(o))}return e},i.prototype.readRegion=function(t){var e=[];if(typeof t=="string"){var o=yl(t);ut(e,this.readRegionFromDocument(o))}else ml(t)?ut(e,this.readRegionFromDocument(t)):ut(e,this.readRegionFromNode(t));return e},i.prototype.readRegionFromDocument=function(t){for(var e=[],o=t.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&ut(e,this.readRegionFromNode(o));return e},i.prototype.readRegionFromNode=function(t){for(var e=[],o=t.firstElementChild;o;o=o.nextElementSibling)if(pt(Xr,o.namespaceURI)&&o.localName=="Region"){var l=He({},tb,o,[]);e.push(l)}for(o=t.firstElementChild;o;o=o.nextElementSibling){var f=o.localName;!pt(Xr,o.namespaceURI)||f!="Document"&&f!="Folder"&&f!="kml"||ut(e,this.readRegionFromNode(o))}return e},i.prototype.writeFeaturesNode=function(t,e){e=this.adaptOptions(e);var o=ai(Xr[4],"kml"),l="http://www.w3.org/2000/xmlns/";o.setAttributeNS(l,"xmlns:gx",Lc[0]),o.setAttributeNS(l,"xmlns:xsi",cu),o.setAttributeNS(cu,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var f={node:o},y={};t.length>1?y.Document=t:t.length==1&&(y.Placemark=t[0]);var w=WM[o.namespaceURI],b=Rs(y,w);return li(f,YM,Bo,b,[e],w,this),o},i}(Dh);function eb(s,i,t){return Array.isArray(s)?s:typeof s=="string"?eb(t[s],i,t):i}function vm(s){var i=fs(s,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(i);if(t){var e=t[1];return[parseInt(e.substr(6,2),16),parseInt(e.substr(4,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(0,2),16)/255]}}function d0(s){var i=fs(s,!1),t=[];i=i.replace(/\s*,\s*/g,",");for(var e,o=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;e=o.exec(i);){var l=parseFloat(e[1]),f=parseFloat(e[2]),y=e[3]?parseFloat(e[3]):0;t.push(l,f,y),i=i.substr(e[0].length)}if(i==="")return t}function rb(s){var i=fs(s,!1).trim(),t=s.baseURI;return t&&t!="about:blank"||(t=window.location.href),t?new URL(i,t).href:i}function ib(s){var i=fs(s,!1).trim().replace(/^(?!.*#)/,"#"),t=s.baseURI;return t&&t!="about:blank"||(t=window.location.href),t?new URL(i,t).href:i}function nb(s){return yn(s)}var KM=Le(Xr,{Pair:function(s,i){var t=He({},pL,s,i,this);if(t){var e=t.key;if(e&&e=="normal"){var o=t.styleUrl;o&&(i[i.length-1]=o);var l=t.Style;l&&(i[i.length-1]=l)}}}});function ob(s,i){return He(void 0,KM,s,i,this)}var JM=Le(Xr,{Icon:Zt(function(s,i){var t=He({},oL,s,i);return t||null}),color:Zt(vm),heading:Zt(yn),hotSpot:Zt(function(s){var i,t=s.getAttribute("xunits"),e=s.getAttribute("yunits");return i=t!=="insetPixels"?e!=="insetPixels"?Cp:Uf:e!=="insetPixels"?Vf:Ty,{x:parseFloat(s.getAttribute("x")),xunits:Qw[t],y:parseFloat(s.getAttribute("y")),yunits:Qw[e],origin:i}}),scale:Zt(nb)}),QM=Le(Xr,{color:Zt(vm),scale:Zt(nb)}),tL=Le(Xr,{color:Zt(vm),width:Zt(yn)}),eL=Le(Xr,{color:Zt(vm),fill:Zt(Mc),outline:Zt(Mc)}),rL=Le(Xr,{coordinates:$r(d0)});function sb(s,i){return He(null,rL,s,i)}var iL=Le(Lc,{Track:kr(ab)}),nL=Le(Xr,{when:function(s,i){var t=i[i.length-1].whens,e=fs(s,!1),o=Date.parse(e);t.push(isNaN(o)?0:o)}},Le(Lc,{coord:function(s,i){var t=i[i.length-1].coordinates,e=fs(s,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(e);if(o){var l=parseFloat(o[1]),f=parseFloat(o[2]),y=parseFloat(o[3]);t.push([l,f,y])}else t.push([])}}));function ab(s,i){var t=He({coordinates:[],whens:[]},nL,s,i);if(t){for(var e=[],o=t.coordinates,l=t.whens,f=0,y=Math.min(o.length,l.length);f<y;++f)o[f].length==3&&e.push(o[f][0],o[f][1],o[f][2],l[f]);return new uo(e,Qr)}}var oL=Le(Xr,{href:Zt(rb)},Le(Lc,{x:Zt(yn),y:Zt(yn),w:Zt(yn),h:Zt(yn)})),sL=Le(Xr,{coordinates:$r(d0)});function g0(s,i){return He(null,sL,s,i)}var _m=Le(Xr,{extrude:Zt(Mc),tessellate:Zt(Mc),altitudeMode:Zt(Je)});function lb(s,i){var t=He({},_m,s,i),e=g0(s,i);if(e){var o=new uo(e,Vr);return o.setProperties(t,!0),o}}function cb(s,i){var t=He({},_m,s,i),e=g0(s,i);if(e){var o=new Lo(e,Vr,[e.length]);return o.setProperties(t,!0),o}}var aL=Le(Xr,{LineString:kr(lb),LinearRing:kr(cb),MultiGeometry:kr(ub),Point:kr(hb),Polygon:kr(pb)});function ub(s,i){var t,e=He([],aL,s,i);if(!e)return null;if(e.length===0)return new ns(e);for(var o=!0,l=e[0].getType(),f=1,y=e.length;f<y;++f)if(e[f].getType()!=l){o=!1;break}if(o){var w=void 0,b=void 0;if(l=="Point"){var I=e[0];for(w=I.getLayout(),b=I.getFlatCoordinates(),f=1,y=e.length;f<y;++f)ut(b,e[f].getFlatCoordinates());y0(t=new Va(b,w),e)}else l=="LineString"?y0(t=new Ks(e),e):l=="Polygon"?y0(t=new Ua(e),e):l=="GeometryCollection"?t=new ns(e):Me(!1,37)}else t=new ns(e);return t}function hb(s,i){var t=He({},_m,s,i),e=g0(s,i);if(e){var o=new rn(e,Vr);return o.setProperties(t,!0),o}}var lL=Le(Xr,{innerBoundaryIs:function(s,i){var t=He([],mL,s,i);if(t.length>0){var e=i[i.length-1];e.push.apply(e,t)}},outerBoundaryIs:function(s,i){var t=He(void 0,yL,s,i);t&&(i[i.length-1][0]=t)}});function pb(s,i){var t=He({},_m,s,i),e=He([null],lL,s,i);if(e&&e[0]){for(var o=e[0],l=[o.length],f=1,y=e.length;f<y;++f)ut(o,e[f]),l.push(o.length);var w=new Lo(o,Vr,l);return w.setProperties(t,!0),w}}var cL=Le(Xr,{IconStyle:function(s,i){var t=He({},JM,s,i);if(t){var e,o,l,f,y=i[i.length-1],w="Icon"in t?t.Icon:{},b=!("Icon"in t)||Object.keys(w).length>0,I=w.href;I?e=I:b&&(e=hm);var N,D=Cp,j=t.hotSpot;j?(o=[j.x,j.y],l=j.xunits,f=j.yunits,D=j.origin):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(e)&&(/pushpin/.test(e)?(o=Jw,l=lm,f=cm):/arrow-reverse/.test(e)?(o=[54,42],l=lm,f=cm):/paddle/.test(e)&&(o=[32,1],l=lm,f=cm));var H,Z=w.x,it=w.y;Z!==void 0&&it!==void 0&&(N=[Z,it]);var at,wt=w.w,gt=w.h;wt!==void 0&&gt!==void 0&&(H=[wt,gt]);var yt=t.heading;yt!==void 0&&(at=qt(yt));var It=t.scale,Rt=t.color;if(b){e==hm&&(H=um);var kt=new Hf({anchor:o,anchorOrigin:D,anchorXUnits:l,anchorYUnits:f,crossOrigin:this.Bt,offset:N,offsetOrigin:Cp,rotation:at,scale:It,size:H,src:this.Cy(e),color:Rt}),Dt=kt.getScaleArray()[0],Xt=kt.getSize();if(Xt===null){var ee=kt.getImageState();if(ee===co||ee===Oa){var pe=function(){var fe=kt.getImageState();if(fe!==co&&fe!==Oa){var Re=kt.getSize();if(Re&&Re.length==2){var qe=ym(Re);kt.setScale(Dt*qe)}kt.unlistenImageChange(pe)}};kt.listenImageChange(pe),ee===co&&kt.load()}}else if(Xt.length==2){var xe=ym(Xt);kt.setScale(Dt*xe)}y.imageStyle=kt}else y.imageStyle=h0}},LabelStyle:function(s,i){var t=He({},QM,s,i);if(t){var e=i[i.length-1],o=new Ip({fill:new Zs({color:"color"in t?t.color:Ed}),scale:t.scale});e.textStyle=o}},LineStyle:function(s,i){var t=He({},tL,s,i);if(t){var e=i[i.length-1],o=new Fs({color:"color"in t?t.color:Ed,width:"width"in t?t.width:1});e.strokeStyle=o}},PolyStyle:function(s,i){var t=He({},eL,s,i);if(t){var e=i[i.length-1],o=new Zs({color:"color"in t?t.color:Ed});e.fillStyle=o;var l=t.fill;l!==void 0&&(e.fill=l);var f=t.outline;f!==void 0&&(e.outline=f)}}});function m0(s,i){var t=He({},cL,s,i,this);if(!t)return null;var e,o="fillStyle"in t?t.fillStyle:Cd,l=t.fill;l===void 0||l||(o=null),"imageStyle"in t?t.imageStyle!=h0&&(e=t.imageStyle):e=fm;var f="textStyle"in t?t.textStyle:Fu,y="strokeStyle"in t?t.strokeStyle:dm,w=t.outline;return w===void 0||w?[new ds({fill:o,image:e,stroke:y,text:f,zIndex:void 0})]:[new ds({geometry:function(b){var I=b.getGeometry(),N=I.getType();return N==="GeometryCollection"?new ns(I.getGeometriesArrayRecursive().filter(function(D){var j=D.getType();return j!=="Polygon"&&j!=="MultiPolygon"})):N!=="Polygon"&&N!=="MultiPolygon"?I:void 0},fill:o,image:e,stroke:y,text:f,zIndex:void 0}),new ds({geometry:function(b){var I=b.getGeometry(),N=I.getType();return N==="GeometryCollection"?new ns(I.getGeometriesArrayRecursive().filter(function(D){var j=D.getType();return j==="Polygon"||j==="MultiPolygon"})):N==="Polygon"||N==="MultiPolygon"?I:void 0},fill:o,stroke:null,zIndex:void 0})]}function y0(s,i){var t,e,o,l=i.length,f=new Array(i.length),y=new Array(i.length),w=new Array(i.length);t=!1,e=!1,o=!1;for(var b=0;b<l;++b){var I=i[b];f[b]=I.get("extrude"),y[b]=I.get("tessellate"),w[b]=I.get("altitudeMode"),t=t||f[b]!==void 0,e=e||y[b]!==void 0,o=o||w[b]}t&&s.set("extrude",f),e&&s.set("tessellate",y),o&&s.set("altitudeMode",w)}var uL=Le(Xr,{displayName:Zt(Je),value:Zt(Je)}),hL=Le(Xr,{Data:function(s,i){var t=s.getAttribute("name");ks(uL,s,i);var e=i[i.length-1];t&&e.displayName?e[t]={value:e.value,displayName:e.displayName,toString:function(){return e.value}}:t!==null?e[t]=e.value:e.displayName!==null&&(e[e.displayName]=e.value),delete e.value},SchemaData:function(s,i){ks(fL,s,i)}});function fb(s,i){ks(hL,s,i)}function db(s,i){ks(tb,s,i)}var pL=Le(Xr,{Style:Zt(m0),key:Zt(Je),styleUrl:Zt(ib)}),fL=Le(Xr,{SimpleData:function(s,i){var t=s.getAttribute("name");if(t!==null){var e=Je(s);i[i.length-1][t]=e}}}),dL=Le(Xr,{altitudeMode:Zt(Je),minAltitude:Zt(yn),maxAltitude:Zt(yn),north:Zt(yn),south:Zt(yn),east:Zt(yn),west:Zt(yn)}),gL=Le(Xr,{minLodPixels:Zt(yn),maxLodPixels:Zt(yn),minFadeExtent:Zt(yn),maxFadeExtent:Zt(yn)}),mL=Le(Xr,{LinearRing:kr(sb)}),yL=Le(Xr,{LinearRing:$r(sb)});function xm(s,i){for(var t=Ra(i),e=[255*(t.length==4?t[3]:1),t[2],t[1],t[0]],o=0;o<4;++o){var l=Math.floor(e[o]).toString(16);e[o]=l.length==1?"0"+l:l}ni(s,e.join(""))}var wm=Le(Xr,{Data:Jt(function(s,i,t){s.setAttribute("name",i.name);var e={node:s},o=i.value;typeof o=="object"?(o!==null&&o.displayName&&li(e,wm,Bo,[o.displayName],t,["displayName"]),o!==null&&o.value&&li(e,wm,Bo,[o.value],t,["value"])):li(e,wm,Bo,[o],t,["value"])}),value:Jt(function(s,i){ni(s,i)}),displayName:Jt(function(s,i){Ww(s,i)})}),vL=Le(Xr,{Placemark:Jt(xb)}),_L=function(s,i,t){return ai(i[i.length-1].node.namespaceURI,"Placemark")},xL=oo("Data"),gb=Le(Xr,["href"],Le(Lc,["x","y","w","h"])),mb=Le(Xr,{href:Jt(ni)},Le(Lc,{x:Jt(js),y:Jt(js),w:Jt(js),h:Jt(js)})),wL=function(s,i,t){return ai(Lc[0],"gx:"+t)},bL=Le(Xr,["scale","heading","Icon","color","hotSpot"]),SL=Le(Xr,{Icon:Jt(function(s,i,t){var e={node:s},o=t[t.length-1].node,l=gb[o.namespaceURI],f=Rs(i,l);li(e,mb,Bo,f,t,l),f=Rs(i,l=gb[Lc[0]]),li(e,mb,wL,f,t,l)}),color:Jt(xm),heading:Jt(js),hotSpot:Jt(function(s,i){s.setAttribute("x",String(i.x)),s.setAttribute("y",String(i.y)),s.setAttribute("xunits",i.xunits),s.setAttribute("yunits",i.yunits)}),scale:Jt(Sb)}),EL=Le(Xr,["color","scale"]),CL=Le(Xr,{color:Jt(xm),scale:Jt(Sb)}),TL=Le(Xr,["color","width"]),PL=Le(Xr,{color:Jt(xm),width:Jt(js)}),IL={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},yb=function(s,i,t){if(s)return ai(i[i.length-1].node.namespaceURI,IL[s.getType()])},ML=oo("Point"),LL=oo("LineString"),AL=oo("LinearRing"),OL=oo("Polygon"),NL=Le(Xr,{LineString:Jt(Wp),Point:Jt(Wp),Polygon:Jt(bb),GeometryCollection:Jt(vb)});function vb(s,i,t){var e,o={node:s},l=i.getType(),f=[];l==="GeometryCollection"?(i.getGeometriesArrayRecursive().forEach(function(y){var w=y.getType();w==="MultiPoint"?f=f.concat(y.getPoints()):w==="MultiLineString"?f=f.concat(y.getLineStrings()):w==="MultiPolygon"?f=f.concat(y.getPolygons()):w==="Point"||w==="LineString"||w==="Polygon"?f.push(y):Me(!1,39)}),e=yb):l==="MultiPoint"?(f=i.getPoints(),e=ML):l==="MultiLineString"?(f=i.getLineStrings(),e=LL):l==="MultiPolygon"?(f=i.getPolygons(),e=OL):Me(!1,39),li(o,NL,e,f,t)}var RL=Le(Xr,{LinearRing:Jt(Wp)});function _b(s,i,t){li({node:s},RL,AL,[i],t)}var v0=Le(Xr,{ExtendedData:Jt(function(s,i,t){for(var e={node:s},o=i.names,l=i.values,f=o.length,y=0;y<f;y++)li(e,wm,xL,[{name:o[y],value:l[y]}],t)}),MultiGeometry:Jt(vb),LineString:Jt(Wp),LinearRing:Jt(Wp),Point:Jt(Wp),Polygon:Jt(bb),Style:Jt(function(s,i,t){var e={node:s},o={};if(i.pointStyles.length){var l=i.pointStyles[0].getText();l&&(o.LabelStyle=l);var f=i.pointStyles[0].getImage();f&&typeof f.getSrc=="function"&&(o.IconStyle=f)}if(i.lineStyles.length&&(y=i.lineStyles[0].getStroke())&&(o.LineStyle=y),i.polyStyles.length){var y;(y=i.polyStyles[0].getStroke())&&!o.LineStyle&&(o.LineStyle=y),o.PolyStyle=i.polyStyles[0]}var w=t[t.length-1].node,b=UL[w.namespaceURI],I=Rs(o,b);li(e,qL,Bo,I,t,b)}),address:Jt(ni),description:Jt(ni),name:Jt(ni),open:Jt(Gh),phoneNumber:Jt(ni),styleUrl:Jt(ni),visibility:Jt(Gh)}),kL=Le(Xr,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),FL=oo("ExtendedData");function xb(s,i,t){var e={node:s};i.getId()&&s.setAttribute("id",i.getId());var o=i.getProperties(),l={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};l[i.getGeometryName()]=1;var f=Object.keys(o||{}).sort().filter(function(yt){return!l[yt]}),y=i.getStyleFunction();if(y){var w=y(i,0);if(w){var b=Array.isArray(w)?w:[w],I=b;if(i.getGeometry()&&(I=b.filter(function(yt){var It=yt.getGeometryFunction()(i);if(It){var Rt=It.getType();return Rt==="GeometryCollection"?It.getGeometriesArrayRecursive().filter(function(kt){var Dt=kt.getType();return Dt==="Point"||Dt==="MultiPoint"}).length:Rt==="Point"||Rt==="MultiPoint"}})),this.Ty){var N=b,D=b;i.getGeometry()&&(N=b.filter(function(yt){var It=yt.getGeometryFunction()(i);if(It){var Rt=It.getType();return Rt==="GeometryCollection"?It.getGeometriesArrayRecursive().filter(function(kt){var Dt=kt.getType();return Dt==="LineString"||Dt==="MultiLineString"}).length:Rt==="LineString"||Rt==="MultiLineString"}}),D=b.filter(function(yt){var It=yt.getGeometryFunction()(i);if(It){var Rt=It.getType();return Rt==="GeometryCollection"?It.getGeometriesArrayRecursive().filter(function(kt){var Dt=kt.getType();return Dt==="Polygon"||Dt==="MultiPolygon"}).length:Rt==="Polygon"||Rt==="MultiPolygon"}})),o.Style={pointStyles:I,lineStyles:N,polyStyles:D}}if(I.length&&o.name===void 0){var j=I[0].getText();j&&(o.name=j.getText())}}}var H=t[t.length-1].node,Z=kL[H.namespaceURI],it=Rs(o,Z);if(li(e,v0,Bo,it,t,Z),f.length>0){var at=Rs(o,f);li(e,v0,FL,[{names:f,values:at}],t)}var wt=t[0],gt=i.getGeometry();gt&&(gt=qn(gt,!0,wt)),li(e,v0,yb,[gt],t)}var DL=Le(Xr,["extrude","tessellate","altitudeMode","coordinates"]),GL=Le(Xr,{extrude:Jt(Gh),tessellate:Jt(Gh),altitudeMode:Jt(ni),coordinates:Jt(function(s,i,t){var e,o=t[t.length-1],l=o.layout,f=o.stride;l==hr||l==yi?e=2:l==Vr||l==Qr?e=3:Me(!1,34);var y=i.length,w="";if(y>0){w+=i[0];for(var b=1;b<e;++b)w+=","+i[b];for(var I=f;I<y;I+=f)for(w+=" "+i[I],b=1;b<e;++b)w+=","+i[I+b]}ni(s,w)})});function Wp(s,i,t){var e=i.getFlatCoordinates(),o={node:s};o.layout=i.getLayout(),o.stride=i.getStride();var l=i.getProperties();l.coordinates=e;var f=t[t.length-1].node,y=DL[f.namespaceURI],w=Rs(l,y);li(o,GL,Bo,w,t,y)}var jL=Le(Xr,["color","fill","outline"]),wb=Le(Xr,{outerBoundaryIs:Jt(_b),innerBoundaryIs:Jt(_b)}),BL=oo("innerBoundaryIs"),zL=oo("outerBoundaryIs");function bb(s,i,t){var e=i.getLinearRings(),o=e.shift(),l={node:s};li(l,wb,BL,e,t),li(l,wb,zL,[o],t)}var VL=Le(Xr,{color:Jt(xm),fill:Jt(Gh),outline:Jt(Gh)});function Sb(s,i){js(s,Math.round(1e6*i)/1e6)}var UL=Le(Xr,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),qL=Le(Xr,{IconStyle:Jt(function(s,i,t){var e={node:s},o={},l=i.getSrc(),f=i.getSize(),y=i.getImageSize(),w={href:l};if(f){w.w=f[0],w.h=f[1];var b=i.getAnchor(),I=i.getOrigin();if(I&&y&&I[0]!==0&&I[1]!==f[1]&&(w.x=I[0],w.y=y[1]-(I[1]+f[1])),b&&(b[0]!==f[0]/2||b[1]!==f[1]/2)){var N={x:b[0],xunits:fu,y:f[1]-b[1],yunits:fu};o.hotSpot=N}}o.Icon=w;var D=i.getScaleArray()[0],j=f;j===null&&(j=um),j.length==2&&(D/=ym(j)),D!==1&&(o.scale=D);var H=i.getRotation();H!==0&&(o.heading=H);var Z=i.getColor();Z&&(o.color=Z);var it=t[t.length-1].node,at=bL[it.namespaceURI],wt=Rs(o,at);li(e,SL,Bo,wt,t,at)}),LabelStyle:Jt(function(s,i,t){var e={node:s},o={},l=i.getFill();l&&(o.color=l.getColor());var f=i.getScale();f&&f!==1&&(o.scale=f);var y=t[t.length-1].node,w=EL[y.namespaceURI],b=Rs(o,w);li(e,CL,Bo,b,t,w)}),LineStyle:Jt(function(s,i,t){var e={node:s},o={color:i.getColor(),width:Number(i.getWidth())||1},l=t[t.length-1].node,f=TL[l.namespaceURI],y=Rs(o,f);li(e,PL,Bo,y,t,f)}),PolyStyle:Jt(function(s,i,t){var e={node:s},o=i.getFill(),l=i.getStroke(),f={color:o?o.getColor():void 0,fill:!!o&&void 0,outline:!!l&&void 0},y=t[t.length-1].node,w=jL[y.namespaceURI],b=Rs(f,w);li(e,VL,Bo,b,t,w)})}),HL=$M,XL=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),_0=[null],WL=Le(_0,{nd:function(s,i){i[i.length-1].ndrefs.push(s.getAttribute("ref"))},tag:Eb}),YL=Le(_0,{node:function(s,i){var t=i[0],e=i[i.length-1],o=s.getAttribute("id"),l=[parseFloat(s.getAttribute("lon")),parseFloat(s.getAttribute("lat"))];e.nodes[o]=l;var f=He({tags:{}},$L,s,i);if(!ge(f.tags)){var y=new rn(l);qn(y,!1,t);var w=new Mr(y);o!==void 0&&w.setId(o),w.setProperties(f.tags,!0),e.features.push(w)}},way:function(s,i){var t=He({id:s.getAttribute("id"),ndrefs:[],tags:{}},WL,s,i);i[i.length-1].ways.push(t)}}),ZL=function(s){function i(){var t=s.call(this)||this;return t.dataProjection=ie("EPSG:4326"),t}return XL(i,s),i.prototype.readFeaturesFromNode=function(t,e){var o=this.getReadOptions(t,e);if(t.localName=="osm"){for(var l=He({nodes:{},ways:[],features:[]},YL,t,[o]),f=0;f<l.ways.length;f++){for(var y=l.ways[f],w=[],b=0,I=y.ndrefs.length;b<I;b++)ut(w,l.nodes[y.ndrefs[b]]);var N=void 0;qn(N=y.ndrefs[0]==y.ndrefs[y.ndrefs.length-1]?new Lo(w,hr,[w.length]):new uo(w,hr),!1,o);var D=new Mr(N);y.id!==void 0&&D.setId(y.id),D.setProperties(y.tags,!0),l.features.push(D)}if(l.features)return l.features}return[]},i}(Dh),$L=Le(_0,{tag:Eb});function Eb(s,i){i[i.length-1].tags[s.getAttribute("k")]=s.getAttribute("v")}var KL=ZL,bm=function(){function s(){}return s.prototype.read=function(i){if(i){if(typeof i=="string"){var t=yl(i);return this.readFromDocument(t)}return ml(i)?this.readFromDocument(i):this.readFromNode(i)}return null},s.prototype.readFromDocument=function(i){for(var t=i.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},s.prototype.readFromNode=function(i){},s}();function Bh(s){return s.getAttributeNS("http://www.w3.org/1999/xlink","href")}var JL=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Qs=[null,"http://www.opengis.net/ows/1.1"],QL=Le(Qs,{ServiceIdentification:Zt(function(s,i){return He({},pA,s,i)}),ServiceProvider:Zt(function(s,i){return He({},fA,s,i)}),OperationsMetadata:Zt(function(s,i){return He({},lA,s,i)})}),tA=function(s){function i(){return s.call(this)||this}return JL(i,s),i.prototype.readFromNode=function(t){var e=He({},QL,t,[]);return e||null},i}(bm),eA=Le(Qs,{DeliveryPoint:Zt(Je),City:Zt(Je),AdministrativeArea:Zt(Je),PostalCode:Zt(Je),Country:Zt(Je),ElectronicMailAddress:Zt(Je)}),rA=Le(Qs,{Value:Un(function(s,i){return Je(s)})}),iA=Le(Qs,{AllowedValues:Zt(function(s,i){return He({},rA,s,i)})}),nA=Le(Qs,{Phone:Zt(function(s,i){return He({},cA,s,i)}),Address:Zt(function(s,i){return He({},eA,s,i)})}),oA=Le(Qs,{HTTP:Zt(function(s,i){return He({},sA,s,i)})}),sA=Le(Qs,{Get:Un(function(s,i){var t=Bh(s);if(t)return He({href:t},uA,s,i)}),Post:void 0}),aA=Le(Qs,{DCP:Zt(function(s,i){return He({},oA,s,i)})}),lA=Le(Qs,{Operation:function(s,i){var t=s.getAttribute("name"),e=He({},aA,s,i);e&&(i[i.length-1][t]=e)}}),cA=Le(Qs,{Voice:Zt(Je),Facsimile:Zt(Je)}),uA=Le(Qs,{Constraint:Un(function(s,i){var t=s.getAttribute("name");if(t)return He({name:t},iA,s,i)})}),hA=Le(Qs,{IndividualName:Zt(Je),PositionName:Zt(Je),ContactInfo:Zt(function(s,i){return He({},nA,s,i)})}),pA=Le(Qs,{Abstract:Zt(Je),AccessConstraints:Zt(Je),Fees:Zt(Je),Title:Zt(Je),ServiceTypeVersion:Zt(Je),ServiceType:Zt(Je)}),fA=Le(Qs,{ProviderName:Zt(Je),ProviderSite:Zt(Bh),ServiceContact:Zt(function(s,i){return He({},hA,s,i)})}),Cb=tA,dA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}();function Tb(s,i,t){var e,o=t||1e5,l=new Array(i);for(e=0;e<i;++e)l[e]=0;for(var f=0,y=s.length;f<y;)for(e=0;e<i;++e,++f){var w=s[f],b=w-l[e];l[e]=w,s[f]=b}return Ib(s,o)}function Pb(s,i,t){var e,o=t||1e5,l=new Array(i);for(e=0;e<i;++e)l[e]=0;for(var f=Mb(s,o),y=0,w=f.length;y<w;)for(e=0;e<i;++e,++y)l[e]+=f[y],f[y]=l[e];return f}function Ib(s,i){for(var t=i||1e5,e=0,o=s.length;e<o;++e)s[e]=Math.round(s[e]*t);return Lb(s)}function Mb(s,i){for(var t=i||1e5,e=Ab(s),o=0,l=e.length;o<l;++o)e[o]/=t;return e}function Lb(s){for(var i=0,t=s.length;i<t;++i){var e=s[i];s[i]=e<0?~(e<<1):e<<1}return Ob(s)}function Ab(s){for(var i=Nb(s),t=0,e=i.length;t<e;++t){var o=i[t];i[t]=1&o?~(o>>1):o>>1}return i}function Ob(s){for(var i="",t=0,e=s.length;t<e;++t)i+=Rb(s[t]);return i}function Nb(s){for(var i=[],t=0,e=0,o=0,l=s.length;o<l;++o){var f=s.charCodeAt(o)-63;t|=(31&f)<<e,f<32?(i.push(t),t=0,e=0):e+=5}return i}function Rb(s){for(var i,t="";s>=32;)i=63+(32|31&s),t+=String.fromCharCode(i),s>>=5;return i=s+63,t+=String.fromCharCode(i)}var gA=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.dataProjection=ie("EPSG:4326"),e.zy=o.factor?o.factor:1e5,e.qv=o.geometryLayout?o.geometryLayout:hr,e}return dA(i,s),i.prototype.readFeatureFromText=function(t,e){var o=this.readGeometryFromText(t,e);return new Mr(o)},i.prototype.readFeaturesFromText=function(t,e){return[this.readFeatureFromText(t,e)]},i.prototype.readGeometryFromText=function(t,e){var o=Vc(this.qv),l=Pb(t,o,this.zy);r0(l,0,l.length,o,l);var f=cs(l,0,l.length,o);return qn(new uo(f,this.qv),!1,this.adaptOptions(e))},i.prototype.writeFeatureText=function(t,e){var o=t.getGeometry();return o?this.writeGeometryText(o,e):(Me(!1,40),"")},i.prototype.writeFeaturesText=function(t,e){return this.writeFeatureText(t[0],e)},i.prototype.writeGeometryText=function(t,e){var o=(t=qn(t,!0,this.adaptOptions(e))).getFlatCoordinates(),l=t.getStride();return r0(o,0,o.length,l,o),Tb(o,l,this.zy)},i}(pm),mA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),yA=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.iv=o.layerName,e.Uh=o.layers?o.layers:null,e.dataProjection=ie(o.dataProjection?o.dataProjection:"EPSG:4326"),e}return mA(i,s),i.prototype.readFeaturesFromObject=function(t,e){if(t.type=="Topology"){var o=t,l=void 0,f=null,y=null;o.transform&&(f=(l=o.transform).scale,y=l.translate);var w=o.arcs;l&&function(H,Z,it){for(var at=0,wt=H.length;at<wt;++at)xA(H[at],Z,it)}(w,f,y);var b=[],I=o.objects,N=this.iv,D=void 0;for(var j in I)this.Uh&&this.Uh.indexOf(j)==-1||(I[j].type==="GeometryCollection"?(D=I[j],b.push.apply(b,_A(D,w,f,y,N,j,e))):(D=I[j],b.push(kb(D,w,f,y,N,j,e))));return b}return[]},i.prototype.readProjectionFromObject=function(t){return this.dataProjection},i}(Dg),vA={Point:function(s,i,t){var e=s.coordinates;return i&&t&&x0(e,i,t),new rn(e)},LineString:function(s,i){var t=Sm(s.arcs,i);return new uo(t)},Polygon:function(s,i){for(var t=[],e=0,o=s.arcs.length;e<o;++e)t[e]=Sm(s.arcs[e],i);return new Lo(t)},MultiPoint:function(s,i,t){var e=s.coordinates;if(i&&t)for(var o=0,l=e.length;o<l;++o)x0(e[o],i,t);return new Va(e)},MultiLineString:function(s,i){for(var t=[],e=0,o=s.arcs.length;e<o;++e)t[e]=Sm(s.arcs[e],i);return new Ks(t)},MultiPolygon:function(s,i){for(var t=[],e=0,o=s.arcs.length;e<o;++e){for(var l=s.arcs[e],f=[],y=0,w=l.length;y<w;++y)f[y]=Sm(l[y],i);t[e]=f}return new Ua(t)}};function Sm(s,i){for(var t,e=[],o=0,l=s.length;o<l;++o)if(t=s[o],o>0&&e.pop(),t>=0)for(var f=0,y=(w=i[t]).length;f<y;++f)e.push(w[f].slice(0));else{var w;for(f=(w=i[~t]).length-1;f>=0;--f)e.push(w[f].slice(0))}return e}function _A(s,i,t,e,o,l,f){for(var y=s.geometries,w=[],b=0,I=y.length;b<I;++b)w[b]=kb(y[b],i,t,e,o,l,f);return w}function kb(s,i,t,e,o,l,f){var y=null,w=s.type;if(w){var b=vA[w];y=qn(y=w==="Point"||w==="MultiPoint"?b(s,t,e):b(s,i),!1,f)}var I=new Mr({geometry:y});s.id!==void 0&&I.setId(s.id);var N=s.properties;return o&&(N||(N={}),N[o]=l),N&&I.setProperties(N,!0),I}function xA(s,i,t){for(var e=0,o=0,l=0,f=s.length;l<f;++l){var y=s[l];e+=y[0],o+=y[1],y[0]=e,y[1]=o,x0(y,i,t)}}function x0(s,i,t){s[0]=s[0]*i[0]+t[0],s[1]=s[1]*i[1]+t[1]}var wA=yA,zh=function(){function s(i){this.Ry=i}return s.prototype.getTagName=function(){return this.Ry},s}(),bA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),w0=function(s){function i(t,e){var o=s.call(this,t)||this;return o.conditions=e,Me(o.conditions.length>=2,57),o}return bA(i,s),i}(zh),SA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Fb=function(s){function i(t){return s.call(this,"And",Array.prototype.slice.call(arguments))||this}return SA(i,s),i}(w0),EA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Db=function(s){function i(t,e,o){var l=s.call(this,"BBOX")||this;if(l.geometryName=t,l.extent=e,e.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return l.srsName=o,l}return EA(i,s),i}(zh),CA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Yp=function(s){function i(t,e,o,l){var f=s.call(this,t)||this;return f.geometryName=e||"the_geom",f.geometry=o,f.srsName=l,f}return CA(i,s),i}(zh),TA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Gb=function(s){function i(t,e,o){return s.call(this,"Contains",t,e,o)||this}return TA(i,s),i}(Yp),PA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),jb=function(s){function i(t,e,o,l,f){var y=s.call(this,"DWithin",t,e,f)||this;return y.distance=o,y.unit=l,y}return PA(i,s),i}(Yp),IA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Bb=function(s){function i(t,e,o){return s.call(this,"Disjoint",t,e,o)||this}return IA(i,s),i}(Yp),MA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Zp=function(s){function i(t,e){var o=s.call(this,t)||this;return o.propertyName=e,o}return MA(i,s),i}(zh),LA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),zb=function(s){function i(t,e,o){var l=s.call(this,"During",t)||this;return l.begin=e,l.end=o,l}return LA(i,s),i}(Zp),AA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Vh=function(s){function i(t,e,o,l){var f=s.call(this,t,e)||this;return f.expression=o,f.matchCase=l,f}return AA(i,s),i}(Zp),OA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Vb=function(s){function i(t,e,o){return s.call(this,"PropertyIsEqualTo",t,e,o)||this}return OA(i,s),i}(Vh),NA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Ub=function(s){function i(t,e){return s.call(this,"PropertyIsGreaterThan",t,e)||this}return NA(i,s),i}(Vh),RA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),qb=function(s){function i(t,e){return s.call(this,"PropertyIsGreaterThanOrEqualTo",t,e)||this}return RA(i,s),i}(Vh),kA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Hb=function(s){function i(t,e,o){return s.call(this,"Intersects",t,e,o)||this}return kA(i,s),i}(Yp),FA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Xb=function(s){function i(t,e,o){var l=s.call(this,"PropertyIsBetween",t)||this;return l.lowerBoundary=e,l.upperBoundary=o,l}return FA(i,s),i}(Zp),DA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Wb=function(s){function i(t,e,o,l,f,y){var w=s.call(this,"PropertyIsLike",t)||this;return w.pattern=e,w.wildCard=o!==void 0?o:"*",w.singleChar=l!==void 0?l:".",w.escapeChar=f!==void 0?f:"!",w.matchCase=y,w}return DA(i,s),i}(Zp),GA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Yb=function(s){function i(t){return s.call(this,"PropertyIsNull",t)||this}return GA(i,s),i}(Zp),jA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Zb=function(s){function i(t,e){return s.call(this,"PropertyIsLessThan",t,e)||this}return jA(i,s),i}(Vh),BA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),$b=function(s){function i(t,e){return s.call(this,"PropertyIsLessThanOrEqualTo",t,e)||this}return BA(i,s),i}(Vh),zA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Kb=function(s){function i(t){var e=s.call(this,"Not")||this;return e.condition=t,e}return zA(i,s),i}(zh),VA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Jb=function(s){function i(t,e,o){return s.call(this,"PropertyIsNotEqualTo",t,e,o)||this}return VA(i,s),i}(Vh),UA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Qb=function(s){function i(t){return s.call(this,"Or",Array.prototype.slice.call(arguments))||this}return UA(i,s),i}(w0),qA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),tS=function(s){function i(t){var e=s.call(this,"ResourceId")||this;return e.rid=t,e}return qA(i,s),i}(zh),HA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),eS=function(s){function i(t,e,o){return s.call(this,"Within",t,e,o)||this}return HA(i,s),i}(Yp);function rS(s){var i=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Fb,i))}function iS(s,i,t){return new Db(s,i,t)}var XA=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),nS={"http://www.opengis.net/gml":{boundedBy:Zt(Ni.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:kr(Ni.prototype.readFeaturesInternal)}},WA={"http://www.opengis.net/wfs":{totalInserted:Zt(yo),totalUpdated:Zt(yo),totalDeleted:Zt(yo)},"http://www.opengis.net/wfs/2.0":{totalInserted:Zt(yo),totalUpdated:Zt(yo),totalDeleted:Zt(yo)}},YA={"http://www.opengis.net/wfs":{TransactionSummary:Zt(lS,"transactionSummary"),InsertResults:Zt(uS,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:Zt(lS,"transactionSummary"),InsertResults:Zt(uS,"insertIds")}},ZA={"http://www.opengis.net/wfs":{PropertyName:Jt(ni)},"http://www.opengis.net/wfs/2.0":{PropertyName:Jt(ni)}},oS={"http://www.opengis.net/wfs":{Insert:Jt(hS),Update:Jt(dS),Delete:Jt(fS),Property:Jt(gS),Native:Jt(mS)},"http://www.opengis.net/wfs/2.0":{Insert:Jt(hS),Update:Jt(dS),Delete:Jt(fS),Property:Jt(gS),Native:Jt(mS)}},sS="feature",b0="http://www.w3.org/2000/xmlns/",S0={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},E0={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},C0={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},aS={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},T0={"2.0.0":sm,"1.1.0":Ri,"1.0.0":jh},$A=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.af=o.version?o.version:"1.1.0",e.Fy=o.featureType,e.Gy=o.featureNS,e.Dy=o.gmlFormat?o.gmlFormat:new T0[e.af],e.qy=o.schemaLocation?o.schemaLocation:aS[e.af],e}return XA(i,s),i.prototype.getFeatureType=function(){return this.Fy},i.prototype.setFeatureType=function(t){this.Fy=t},i.prototype.readFeaturesFromNode=function(t,e){var o={node:t};Vt(o,{featureType:this.Fy,featureNS:this.Gy}),Vt(o,this.getReadOptions(t,e||{}));var l=[o],f=He([],this.af==="2.0.0"?nS:this.Dy.FEATURE_COLLECTION_PARSERS,t,l,this.Dy);return f||(f=[]),f},i.prototype.readTransactionResponse=function(t){if(t){if(typeof t=="string"){var e=yl(t);return this.readTransactionResponseFromDocument(e)}return ml(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}},i.prototype.readFeatureCollectionMetadata=function(t){if(t){if(typeof t=="string"){var e=yl(t);return this.readFeatureCollectionMetadataFromDocument(e)}return ml(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}},i.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(e)},i.prototype.readFeatureCollectionMetadataFromNode=function(t){var e={},o=ec(t.getAttribute("numberOfFeatures"));return e.numberOfFeatures=o,He(e,nS,t,[],this.Dy)},i.prototype.readTransactionResponseFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(e)},i.prototype.readTransactionResponseFromNode=function(t){return He({},YA,t,[])},i.prototype.writeGetFeature=function(t){var e=this,o=ai(E0[this.af],"GetFeature");o.setAttribute("service","WFS"),o.setAttribute("version",this.af),t.handle&&o.setAttribute("handle",t.handle),t.outputFormat&&o.setAttribute("outputFormat",t.outputFormat),t.maxFeatures!==void 0&&o.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&o.setAttribute("resultType",t.resultType),t.startIndex!==void 0&&o.setAttribute("startIndex",String(t.startIndex)),t.count!==void 0&&o.setAttribute("count",String(t.count)),t.viewParams!==void 0&&o.setAttribute("viewParams",t.viewParams),o.setAttributeNS(cu,"xsi:schemaLocation",this.qy);var l={node:o};if(Vt(l,{version:this.af,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.Gy,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]}),Me(Array.isArray(t.featureTypes),11),typeof t.featureTypes[0]=="string"){var f=t.filter;t.bbox&&(Me(t.geometryName,12),f=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,f)),Vt(l,{geometryName:t.geometryName,filter:f}),PS(o,t.featureTypes,[l])}else t.featureTypes.forEach(function(y){var w=e.combineBboxAndFilter(y.geometryName,y.bbox,t.srsName,t.filter);Vt(l,{geometryName:y.geometryName,filter:w}),PS(o,[y.name],[l])});return o},i.prototype.combineBboxAndFilter=function(t,e,o,l){var f=iS(t,e,o);return l?rS(l,f):f},i.prototype.writeTransaction=function(t,e,o,l){var f,y=[],w=l.version?l.version:this.af,b=ai(E0[w],"Transaction");b.setAttribute("service","WFS"),b.setAttribute("version",w),l&&(f=l.gmlOptions?l.gmlOptions:{},l.handle&&b.setAttribute("handle",l.handle)),b.setAttributeNS(cu,"xsi:schemaLocation",aS[w]);var I=function(N,D,j,H){var Z,it=H.featurePrefix?H.featurePrefix:sS;return j==="1.0.0"?Z=2:j==="1.1.0"?Z=3:j==="2.0.0"&&(Z=3.2),Vt({node:N},{version:j,featureNS:H.featureNS,featureType:H.featureType,featurePrefix:it,gmlVersion:Z,hasZ:H.hasZ,srsName:H.srsName},D)}(b,f,w,l);return t&&Em("Insert",t,y,I),e&&Em("Update",e,y,I),o&&Em("Delete",o,y,I),l.nativeElements&&Em("Native",l.nativeElements,y,I),b},i.prototype.readProjectionFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(e);return null},i.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild){for(var e=(t=t.firstElementChild.firstElementChild).firstElementChild;e;e=e.nextElementSibling)if(e.childNodes.length!==0&&(e.childNodes.length!==1||e.firstChild.nodeType!==3)){var o=[{}];return this.Dy.readGeometryElement(e,o),ie(o.pop().srsName)}}return null},i}(Dh);function Em(s,i,t,e){li(e,oS,oo(s),i,t)}function lS(s,i){return He({},WA,s,i)}var KA={"http://www.opengis.net/ogc":{FeatureId:kr(function(s,i){return s.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:kr(function(s,i){return s.getAttribute("fid")})}};function cS(s,i){ks(KA,s,i)}var JA={"http://www.opengis.net/wfs":{Feature:cS},"http://www.opengis.net/wfs/2.0":{Feature:cS}};function uS(s,i){return He([],JA,s,i)}function hS(s,i,t){var e=t[t.length-1],o=e.featureType,l=e.featureNS,f=e.gmlVersion,y=ai(l,o);s.appendChild(y),f===2?jh.prototype.writeFeatureElement(y,i,t):f===3?Ri.prototype.writeFeatureElement(y,i,t):sm.prototype.writeFeatureElement(y,i,t)}function pS(s,i,t){var e=t[t.length-1].version,o=S0[e],l=ai(o,"Filter"),f=ai(o,"FeatureId");l.appendChild(f),f.setAttribute("fid",i),s.appendChild(l)}function P0(s,i){var t=(s=s||sS)+":";return i.indexOf(t)===0?i:t+i}function fS(s,i,t){var e=t[t.length-1];Me(i.getId()!==void 0,26);var o=e.featureType,l=e.featurePrefix,f=e.featureNS,y=P0(l,o);s.setAttribute("typeName",y),s.setAttributeNS(b0,"xmlns:"+l,f);var w=i.getId();w!==void 0&&pS(s,w,t)}function dS(s,i,t){var e=t[t.length-1];Me(i.getId()!==void 0,27);var o=e.version,l=e.featureType,f=e.featurePrefix,y=e.featureNS,w=P0(f,l),b=i.getGeometryName();s.setAttribute("typeName",w),s.setAttributeNS(b0,"xmlns:"+f,y);var I=i.getId();if(I!==void 0){for(var N=i.getKeys(),D=[],j=0,H=N.length;j<H;j++){var Z=i.get(N[j]);if(Z!==void 0){var it=N[j];Z&&typeof Z.getSimplifiedGeometry=="function"&&(it=b),D.push({name:it,value:Z})}}li({version:o,gmlVersion:e.gmlVersion,node:s,hasZ:e.hasZ,srsName:e.srsName},oS,oo("Property"),D,t),pS(s,I,t)}}function gS(s,i,t){var e=t[t.length-1],o=e.version,l=E0[o],f=ai(l,"Name"),y=e.gmlVersion;if(s.appendChild(f),ni(f,i.name),i.value!==void 0&&i.value!==null){var w=ai(l,"Value");s.appendChild(w),i.value&&typeof i.value.getSimplifiedGeometry=="function"?y===2?jh.prototype.writeGeometryElement(w,i.value,t):y===3?Ri.prototype.writeGeometryElement(w,i.value,t):sm.prototype.writeGeometryElement(w,i.value,t):ni(w,i.value)}}function mS(s,i,t){i.vendorId&&s.setAttribute("vendorId",i.vendorId),i.safeToIgnore!==void 0&&s.setAttribute("safeToIgnore",String(i.safeToIgnore)),i.value!==void 0&&ni(s,i.value)}var Cm={"http://www.opengis.net/wfs":{Query:Jt(yS)},"http://www.opengis.net/wfs/2.0":{Query:Jt(yS)},"http://www.opengis.net/ogc":{During:Jt(wS),And:Jt(Tm),Or:Jt(Tm),Not:Jt(bS),BBOX:Jt(_S),Contains:Jt(Du),Intersects:Jt(Du),Within:Jt(Du),DWithin:Jt(xS),PropertyIsEqualTo:Jt(Wa),PropertyIsNotEqualTo:Jt(Wa),PropertyIsLessThan:Jt(Wa),PropertyIsLessThanOrEqualTo:Jt(Wa),PropertyIsGreaterThan:Jt(Wa),PropertyIsGreaterThanOrEqualTo:Jt(Wa),PropertyIsNull:Jt(SS),PropertyIsBetween:Jt(ES),PropertyIsLike:Jt(CS)},"http://www.opengis.net/fes/2.0":{During:Jt(wS),And:Jt(Tm),Or:Jt(Tm),Not:Jt(bS),BBOX:Jt(_S),Contains:Jt(Du),Disjoint:Jt(Du),Intersects:Jt(Du),ResourceId:Jt(function(s,i,t){s.setAttribute("rid",i.rid)}),Within:Jt(Du),DWithin:Jt(xS),PropertyIsEqualTo:Jt(Wa),PropertyIsNotEqualTo:Jt(Wa),PropertyIsLessThan:Jt(Wa),PropertyIsLessThanOrEqualTo:Jt(Wa),PropertyIsGreaterThan:Jt(Wa),PropertyIsGreaterThanOrEqualTo:Jt(Wa),PropertyIsNull:Jt(SS),PropertyIsBetween:Jt(ES),PropertyIsLike:Jt(CS)}};function yS(s,i,t){var e,o,l=t[t.length-1],f=l.version,y=l.featurePrefix,w=l.featureNS,b=l.propertyNames,I=l.srsName;e=y?P0(y,i):i,o=f==="2.0.0"?"typeNames":"typeName",s.setAttribute(o,e),I&&s.setAttribute("srsName",I),w&&s.setAttributeNS(b0,"xmlns:"+y,w);var N=Vt({},l);N.node=s,li(N,ZA,oo("PropertyName"),b,t);var D=l.filter;if(D){var j=ai(Td(f),"Filter");s.appendChild(j),vS(j,D,t)}}function vS(s,i,t){var e=t[t.length-1],o={node:s};Vt(o,{context:e}),li(o,Cm,oo(i.getTagName()),[i],t)}function _S(s,i,t){var e=t[t.length-1],o=e.context.version;e.srsName=i.srsName;var l=T0[o];$p(o,s,i.geometryName),l.prototype.writeGeometryElement(s,i.extent,t)}function Du(s,i,t){var e=t[t.length-1],o=e.context.version;e.srsName=i.srsName;var l=T0[o];$p(o,s,i.geometryName),l.prototype.writeGeometryElement(s,i.geometry,t)}function xS(s,i,t){var e=t[t.length-1].context.version;Du(s,i,t);var o=ai(Td(e),"Distance");ni(o,i.distance.toString()),e==="2.0.0"?o.setAttribute("uom",i.unit):o.setAttribute("units",i.unit),s.appendChild(o)}function wS(s,i,t){var e=t[t.length-1].context.version;Pm(C0[e],"ValueReference",s,i.propertyName);var o=ai(Ru,"TimePeriod");s.appendChild(o);var l=ai(Ru,"begin");o.appendChild(l),TS(l,i.begin);var f=ai(Ru,"end");o.appendChild(f),TS(f,i.end)}function Tm(s,i,t){var e=t[t.length-1].context,o={node:s};Vt(o,{context:e});for(var l=i.conditions,f=0,y=l.length;f<y;++f){var w=l[f];li(o,Cm,oo(w.getTagName()),[w],t)}}function bS(s,i,t){var e=t[t.length-1].context,o={node:s};Vt(o,{context:e});var l=i.condition;li(o,Cm,oo(l.getTagName()),[l],t)}function Wa(s,i,t){var e=t[t.length-1].context.version;i.matchCase!==void 0&&s.setAttribute("matchCase",i.matchCase.toString()),$p(e,s,i.propertyName),Im(e,s,""+i.expression)}function SS(s,i,t){$p(t[t.length-1].context.version,s,i.propertyName)}function ES(s,i,t){var e=t[t.length-1].context.version,o=Td(e);$p(e,s,i.propertyName);var l=ai(o,"LowerBoundary");s.appendChild(l),Im(e,l,""+i.lowerBoundary);var f=ai(o,"UpperBoundary");s.appendChild(f),Im(e,f,""+i.upperBoundary)}function CS(s,i,t){var e=t[t.length-1].context.version;s.setAttribute("wildCard",i.wildCard),s.setAttribute("singleChar",i.singleChar),s.setAttribute("escapeChar",i.escapeChar),i.matchCase!==void 0&&s.setAttribute("matchCase",i.matchCase.toString()),$p(e,s,i.propertyName),Im(e,s,""+i.pattern)}function Pm(s,i,t,e){var o=ai(s,i);ni(o,e),t.appendChild(o)}function Im(s,i,t){Pm(Td(s),"Literal",i,t)}function $p(s,i,t){s==="2.0.0"?Pm(C0[s],"ValueReference",i,t):Pm(S0[s],"PropertyName",i,t)}function TS(s,i){var t=ai(Ru,"TimeInstant");s.appendChild(t);var e=ai(Ru,"timePosition");t.appendChild(e),ni(e,i)}function PS(s,i,t){var e=t[t.length-1],o=Vt({},e);o.node=s,li(o,Cm,oo("Query"),i,t)}function Td(s){return s==="2.0.0"?C0[s]:S0[s]}var QA=$A,tO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),Mm=1,Lm=2,Am=3,I0=4,M0=5,L0=6,A0=7,IS=15,MS=16,LS=17,AS=function(){function s(i){this.Uy=i,this.By=0,this.Xy=!1,this.Vy=!1,this.Wy=!1,this.Yy=!1,this.Zy=null,this.$y=hr}return s.prototype.readUint8=function(){return this.Uy.getUint8(this.By++)},s.prototype.readUint32=function(i){return this.Uy.getUint32((this.By+=4)-4,i!==void 0?i:this.Vy)},s.prototype.readDouble=function(i){return this.Uy.getFloat64((this.By+=8)-8,i!==void 0?i:this.Vy)},s.prototype.readPoint=function(){var i=[];return i.push(this.readDouble()),i.push(this.readDouble()),this.Wy&&i.push(this.readDouble()),this.Yy&&i.push(this.readDouble()),i},s.prototype.readLineString=function(){for(var i=this.readUint32(),t=[],e=0;e<i;e++)t.push(this.readPoint());return t},s.prototype.readPolygon=function(){for(var i=this.readUint32(),t=[],e=0;e<i;e++)t.push(this.readLineString());return t},s.prototype.readWkbHeader=function(i){var t=this.readUint8()>0,e=this.readUint32(t),o=Math.floor((268435455&e)/1e3),l=!!(2147483648&e)||o===1||o===3,f=!!(1073741824&e)||o===2||o===3,y=!!(536870912&e),w=(268435455&e)%1e3,b=["XY",l?"Z":"",f?"M":""].join(""),I=y?this.readUint32(t):null;if(i!==void 0&&i!==w)throw new Error("Unexpected WKB geometry type "+w);if(this.Xy){if(this.Vy!==t)throw new Error("Inconsistent endian");if(this.$y!==b)throw new Error("Inconsistent geometry layout");if(I&&this.Zy!==I)throw new Error("Inconsistent coordinate system (SRID)")}else this.Vy=t,this.Wy=l,this.Yy=f,this.$y=b,this.Zy=I,this.Xy=!0;return w},s.prototype.readWkbPayload=function(i){switch(i){case Mm:return this.readPoint();case Lm:return this.readLineString();case Am:case LS:return this.readPolygon();case I0:return this.readMultiPoint();case M0:return this.readMultiLineString();case L0:case IS:case MS:return this.readMultiPolygon();case A0:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+i+" is found")}},s.prototype.readWkbBlock=function(i){return this.readWkbPayload(this.readWkbHeader(i))},s.prototype.readWkbCollection=function(i,t){for(var e=this.readUint32(),o=[],l=0;l<e;l++){var f=i.call(this,t);f&&o.push(f)}return o},s.prototype.readMultiPoint=function(){return this.readWkbCollection(this.readWkbBlock,Mm)},s.prototype.readMultiLineString=function(){return this.readWkbCollection(this.readWkbBlock,Lm)},s.prototype.readMultiPolygon=function(){return this.readWkbCollection(this.readWkbBlock,Am)},s.prototype.readGeometryCollection=function(){return this.readWkbCollection(this.readGeometry)},s.prototype.readGeometry=function(){var i=this.readWkbHeader(),t=this.readWkbPayload(i);switch(i){case Mm:return new rn(t,this.$y);case Lm:return new uo(t,this.$y);case Am:case LS:return new Lo(t,this.$y);case I0:return new Va(t,this.$y);case M0:return new Ks(t,this.$y);case L0:case IS:case MS:return new Ua(t,this.$y);case A0:return new ns(t);default:return null}},s.prototype.getSrid=function(){return this.Zy},s}(),eO=function(){function s(i){i=i||{},this.$y=i.layout,this.Vy=i.littleEndian!==!1,this.Ky=i.ewkb!==!1,this.Hy=[],this.Jy=Vt({X:0,Y:0,Z:0,M:0},i.nodata)}return s.prototype.writeUint8=function(i){this.Hy.push([1,i])},s.prototype.writeUint32=function(i){this.Hy.push([4,i])},s.prototype.writeDouble=function(i){this.Hy.push([8,i])},s.prototype.writePoint=function(i,t){for(var e=Vt.apply(null,t.split("").map(function(y,w){var b;return(b={})[y]=i[w],b})),o=0,l=this.$y;o<l.length;o++){var f=l[o];this.writeDouble(f in e?e[f]:this.Jy[f])}},s.prototype.writeLineString=function(i,t){this.writeUint32(i.length);for(var e=0;e<i.length;e++)this.writePoint(i[e],t)},s.prototype.writePolygon=function(i,t){this.writeUint32(i.length);for(var e=0;e<i.length;e++)this.writeLineString(i[e],t)},s.prototype.writeWkbHeader=function(i,t){i%=1e3,this.$y.indexOf("Z")>=0&&(i+=this.Ky?2147483648:1e3),this.$y.indexOf("M")>=0&&(i+=this.Ky?1073741824:2e3),this.Ky&&Number.isInteger(t)&&(i|=536870912),this.writeUint8(this.Vy?1:0),this.writeUint32(i),this.Ky&&Number.isInteger(t)&&this.writeUint32(t)},s.prototype.writeMultiPoint=function(i,t){this.writeUint32(i.length);for(var e=0;e<i.length;e++)this.writeWkbHeader(1),this.writePoint(i[e],t)},s.prototype.writeMultiLineString=function(i,t){this.writeUint32(i.length);for(var e=0;e<i.length;e++)this.writeWkbHeader(2),this.writeLineString(i[e],t)},s.prototype.writeMultiPolygon=function(i,t){this.writeUint32(i.length);for(var e=0;e<i.length;e++)this.writeWkbHeader(3),this.writePolygon(i[e],t)},s.prototype.writeGeometryCollection=function(i){this.writeUint32(i.length);for(var t=0;t<i.length;t++)this.writeGeometry(i[t])},s.prototype.findMinimumLayout=function(i,t){t===void 0&&(t=Qr);var e,o;if(i instanceof Cs)return(e=i.getLayout())===(o=t)?e:e===Qr?o:o===Qr?e:hr;if(i instanceof ns)for(var l=i.getGeometriesArray(),f=0;f<l.length&&t!==hr;f++)t=this.findMinimumLayout(l[f],t);return t},s.prototype.writeGeometry=function(i,t){var e={Point:Mm,LineString:Lm,Polygon:Am,MultiPoint:I0,MultiLineString:M0,MultiPolygon:L0,GeometryCollection:A0},o=i.getType(),l=e[o];if(!l)throw new Error("GeometryType "+o+" is not supported");this.$y||(this.$y=this.findMinimumLayout(i)),this.writeWkbHeader(l,t),i instanceof Cs?{Point:this.writePoint,LineString:this.writeLineString,Polygon:this.writePolygon,MultiPoint:this.writeMultiPoint,MultiLineString:this.writeMultiLineString,MultiPolygon:this.writeMultiPolygon}[o].call(this,i.getCoordinates(),i.getLayout()):i instanceof ns&&this.writeGeometryCollection(i.getGeometriesArray())},s.prototype.getBuffer=function(){var i=this,t=this.Hy.reduce(function(f,y){return f+y[0]},0),e=new ArrayBuffer(t),o=new DataView(e),l=0;return this.Hy.forEach(function(f){switch(f[0]){case 1:o.setUint8(l,f[1]);break;case 4:o.setUint32(l,f[1],i.Vy);break;case 8:o.setFloat64(l,f[1],i.Vy)}l+=f[0]}),e},s}();function OS(s){return typeof s=="string"?function(i){for(var t=new Uint8Array(i.length/2),e=0;e<i.length/2;e++)t[e]=parseInt(i.substr(2*e,2),16);return new DataView(t.buffer)}(s):ArrayBuffer.isView(s)?s instanceof DataView?s:new DataView(s.buffer,s.byteOffset,s.byteLength):s instanceof ArrayBuffer?new DataView(s):null}var rO=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.splitCollection=!!o.splitCollection,e.Qy=null,e.tm=o.hex!==!1,e.nm=o.littleEndian!==!1,e.im=o.ewkb!==!1,e.$y=o.geometryLayout,e.rm=o.nodataZ||0,e.om=o.nodataM||0,e.Zy=o.srid,e}return tO(i,s),i.prototype.getType=function(){return this.tm?"text":"arraybuffer"},i.prototype.readFeature=function(t,e){return new Mr({geometry:this.readGeometry(t,e)})},i.prototype.readFeatures=function(t,e){var o=this.readGeometry(t,e);return(this.splitCollection&&o instanceof ns?o.getGeometriesArray():[o]).map(function(l){return new Mr({geometry:l})})},i.prototype.readGeometry=function(t,e){var o=OS(t);if(!o)return null;var l=new AS(o).readGeometry();this.Qy=o;var f=this.getReadOptions(t,e);return this.Qy=null,qn(l,!1,f)},i.prototype.readProjection=function(t){var e=this.Qy||OS(t);if(e){var o=new AS(e);return o.readWkbHeader(),o.getSrid()&&ie("EPSG:"+o.getSrid())||void 0}},i.prototype.writeFeature=function(t,e){return this.writeGeometry(t.getGeometry(),e)},i.prototype.writeFeatures=function(t,e){return this.writeGeometry(new ns(t.map(function(o){return o.getGeometry()})),e)},i.prototype.writeGeometry=function(t,e){var o=this.adaptOptions(e),l=new eO({layout:this.$y,littleEndian:this.nm,ewkb:this.im,nodata:{Z:this.rm,M:this.om}}),f=Number.isInteger(this.Zy)?Number(this.Zy):null;if(this.Zy!==!1&&!Number.isInteger(this.Zy)){var y=o.dataProjection&&ie(o.dataProjection);if(y){var w=y.getCode();w.indexOf("EPSG:")===0&&(f=Number(w.substring(5)))}}l.writeGeometry(qn(t,!0,o),f);var b=l.getBuffer();return this.tm?function(I){var N=new Uint8Array(I);return Array.from(N.values()).map(function(D){return(D<16?"0":"")+Number(D).toString(16).toUpperCase()}).join("")}(b):b},i}(Gp),iO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),nO={POINT:rn,LINESTRING:uo,POLYGON:Lo,MULTIPOINT:Va,MULTILINESTRING:Ks,MULTIPOLYGON:Ua},NS="EMPTY",oO=0,Om=1,Ac=2,Gu=3,RS=4,Kp=5,sO=6,aO={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"},lO=function(){function s(i){this.wkt=i,this.sm=-1}return s.prototype.um=function(i){return i>="a"&&i<="z"||i>="A"&&i<="Z"},s.prototype.am=function(i,t){return i>="0"&&i<="9"||i=="."&&!(t!==void 0&&t)},s.prototype.hm=function(i){return i==" "||i=="	"||i=="\r"||i==`
`},s.prototype.fm=function(){return this.wkt.charAt(++this.sm)},s.prototype.nextToken=function(){var i,t=this.fm(),e=this.sm,o=t;if(t=="(")i=Ac;else if(t==",")i=Kp;else if(t==")")i=Gu;else if(this.am(t)||t=="-")i=RS,o=this.lm();else if(this.um(t))i=Om,o=this.vm();else{if(this.hm(t))return this.nextToken();if(t!=="")throw new Error("Unexpected character: "+t);i=sO}return{position:e,value:o,type:i}},s.prototype.lm=function(){var i,t=this.sm,e=!1,o=!1;do i=="."?e=!0:i!="e"&&i!="E"||(o=!0),i=this.fm();while(this.am(i,e)||!o&&(i=="e"||i=="E")||o&&(i=="-"||i=="+"));return parseFloat(this.wkt.substring(t,this.sm--))},s.prototype.vm=function(){var i,t=this.sm;do i=this.fm();while(this.um(i));return this.wkt.substring(t,this.sm--).toUpperCase()},s}(),cO=function(){function s(i){this.dm=i,this.pm={position:0,type:oO},this.$y=hr}return s.prototype.ym=function(){this.pm=this.dm.nextToken()},s.prototype.isTokenType=function(i){return this.pm.type==i},s.prototype.match=function(i){var t=this.isTokenType(i);return t&&this.ym(),t},s.prototype.parse=function(){return this.ym(),this.wm()},s.prototype.gm=function(){var i=hr,t=this.pm;if(this.isTokenType(Om)){var e=t.value;e==="Z"?i=Vr:e==="M"?i=yi:e==="ZM"&&(i=Qr),i!==hr&&this.ym()}return i},s.prototype.bm=function(){if(this.match(Ac)){var i=[];do i.push(this.wm());while(this.match(Kp));if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype.Mm=function(){if(this.match(Ac)){var i=this._m();if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype.Sm=function(){if(this.match(Ac)){var i=this.Om();if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype.jm=function(){if(this.match(Ac)){var i=this.Em();if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype.Tm=function(){if(this.match(Ac)){var i=void 0;if(i=this.pm.type==Ac?this.Am():this.Om(),this.match(Gu))return i}throw new Error(this.xm())},s.prototype.Pm=function(){if(this.match(Ac)){var i=this.Em();if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype.Cm=function(){if(this.match(Ac)){var i=this.km();if(this.match(Gu))return i}throw new Error(this.xm())},s.prototype._m=function(){for(var i=[],t=this.$y.length,e=0;e<t;++e){var o=this.pm;if(!this.match(RS))break;i.push(o.value)}if(i.length==t)return i;throw new Error(this.xm())},s.prototype.Om=function(){for(var i=[this._m()];this.match(Kp);)i.push(this._m());return i},s.prototype.Am=function(){for(var i=[this.Mm()];this.match(Kp);)i.push(this.Mm());return i},s.prototype.Em=function(){for(var i=[this.Sm()];this.match(Kp);)i.push(this.Sm());return i},s.prototype.km=function(){for(var i=[this.jm()];this.match(Kp);)i.push(this.jm());return i},s.prototype.Im=function(){var i=this.isTokenType(Om)&&this.pm.value==NS;return i&&this.ym(),i},s.prototype.xm=function(){return"Unexpected `"+this.pm.value+"` at position "+this.pm.position+" in `"+this.dm.wkt+"`"},s.prototype.wm=function(){var i=this.pm;if(this.match(Om)){var t=i.value;this.$y=this.gm();var e=this.Im();if(t=="GEOMETRYCOLLECTION"){if(e)return new ns([]);var o=this.bm();return new ns(o)}var l=nO[t];if(!l)throw new Error("Invalid geometry type: "+t);var f=void 0;if(e)f=t=="POINT"?[NaN,NaN]:[];else switch(t){case"POINT":f=this.Mm();break;case"LINESTRING":f=this.Sm();break;case"POLYGON":f=this.jm();break;case"MULTIPOINT":f=this.Tm();break;case"MULTILINESTRING":f=this.Pm();break;case"MULTIPOLYGON":f=this.Cm()}return new l(f,this.$y)}throw new Error(this.xm())},s}(),uO=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.Nm=o.splitCollection!==void 0&&o.splitCollection,e}return iO(i,s),i.prototype.Lm=function(t){var e=new lO(t);return new cO(e).parse()},i.prototype.readFeatureFromText=function(t,e){var o=this.readGeometryFromText(t,e),l=new Mr;return l.setGeometry(o),l},i.prototype.readFeaturesFromText=function(t,e){for(var o=[],l=this.readGeometryFromText(t,e),f=[],y=0,w=(o=this.Nm&&l.getType()=="GeometryCollection"?l.getGeometriesArray():[l]).length;y<w;++y){var b=new Mr;b.setGeometry(o[y]),f.push(b)}return f},i.prototype.readGeometryFromText=function(t,e){return qn(this.Lm(t),!1,e)},i.prototype.writeFeatureText=function(t,e){var o=t.getGeometry();return o?this.writeGeometryText(o,e):""},i.prototype.writeFeaturesText=function(t,e){if(t.length==1)return this.writeFeatureText(t[0],e);for(var o=[],l=0,f=t.length;l<f;++l)o.push(t[l].getGeometry());var y=new ns(o);return this.writeGeometryText(y,e)},i.prototype.writeGeometryText=function(t,e){return DS(qn(t,!0,e))},i}(pm);function kS(s){var i=s.getCoordinates();return i.length===0?"":i.join(" ")}function O0(s){for(var i=s.getCoordinates(),t=[],e=0,o=i.length;e<o;++e)t.push(i[e].join(" "));return t.join(",")}function FS(s){for(var i=[],t=s.getLinearRings(),e=0,o=t.length;e<o;++e)i.push("("+O0(t[e])+")");return i.join(",")}var hO={Point:kS,LineString:O0,Polygon:FS,MultiPoint:function(s){for(var i=[],t=s.getPoints(),e=0,o=t.length;e<o;++e)i.push("("+kS(t[e])+")");return i.join(",")},MultiLineString:function(s){for(var i=[],t=s.getLineStrings(),e=0,o=t.length;e<o;++e)i.push("("+O0(t[e])+")");return i.join(",")},MultiPolygon:function(s){for(var i=[],t=s.getPolygons(),e=0,o=t.length;e<o;++e)i.push("("+FS(t[e])+")");return i.join(",")},GeometryCollection:function(s){for(var i=[],t=s.getGeometries(),e=0,o=t.length;e<o;++e)i.push(DS(t[e]));return i.join(",")}};function DS(s){var i=s.getType(),t=(0,hO[i])(s),e=aO[i];if(typeof s.getFlatCoordinates=="function"){var o=function(l){var f=l.getLayout(),y="";return f!==Vr&&f!==Qr||(y+="Z"),f!==yi&&f!==Qr||(y+="M"),y}(s);o.length>0&&(e+=" "+o)}return t.length===0?e+" "+NS:e+"("+t+")"}var pO=uO,fO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),os=[null,"http://www.opengis.net/wms"],dO=Le(os,{Service:Zt(function(s,i){return He({},yO,s,i)}),Capability:Zt(function(s,i){return He({},gO,s,i)})}),gO=Le(os,{Request:Zt(function(s,i){return He({},EO,s,i)}),Exception:Zt(function(s,i){return He([],wO,s,i)}),Layer:Zt(function(s,i){var t=He({},GS,s,i);return t.Layer===void 0?Object.assign(t,jS(s,i)):t})}),mO=function(s){function i(){var t=s.call(this)||this;return t.version=void 0,t}return fO(i,s),i.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var e=He({version:this.version},dO,t,[]);return e||null},i}(bm),yO=Le(os,{Name:Zt(Je),Title:Zt(Je),Abstract:Zt(Je),KeywordList:Zt(zS),OnlineResource:Zt(Bh),ContactInformation:Zt(function(s,i){return He({},vO,s,i)}),Fees:Zt(Je),AccessConstraints:Zt(Je),LayerLimit:Zt(yo),MaxWidth:Zt(yo),MaxHeight:Zt(yo)}),vO=Le(os,{ContactPersonPrimary:Zt(function(s,i){return He({},_O,s,i)}),ContactPosition:Zt(Je),ContactAddress:Zt(function(s,i){return He({},xO,s,i)}),ContactVoiceTelephone:Zt(Je),ContactFacsimileTelephone:Zt(Je),ContactElectronicMailAddress:Zt(Je)}),_O=Le(os,{ContactPerson:Zt(Je),ContactOrganization:Zt(Je)}),xO=Le(os,{AddressType:Zt(Je),Address:Zt(Je),City:Zt(Je),StateOrProvince:Zt(Je),PostCode:Zt(Je),Country:Zt(Je)}),wO=Le(os,{Format:kr(Je)}),GS=Le(os,{Name:Zt(Je),Title:Zt(Je),Abstract:Zt(Je),KeywordList:Zt(zS),CRS:Un(Je),EX_GeographicBoundingBox:Zt(function(s,i){var t=He({},SO,s,i);if(t){var e=t.westBoundLongitude,o=t.southBoundLatitude,l=t.eastBoundLongitude,f=t.northBoundLatitude;if(!(e===void 0||o===void 0||l===void 0||f===void 0))return[e,o,l,f]}}),BoundingBox:Un(function(s,i){var t=[tc(s.getAttribute("minx")),tc(s.getAttribute("miny")),tc(s.getAttribute("maxx")),tc(s.getAttribute("maxy"))],e=[tc(s.getAttribute("resx")),tc(s.getAttribute("resy"))];return{crs:s.getAttribute("CRS"),extent:t,res:e}}),Dimension:Un(function(s,i){return{name:s.getAttribute("name"),units:s.getAttribute("units"),unitSymbol:s.getAttribute("unitSymbol"),default:s.getAttribute("default"),multipleValues:ku(s.getAttribute("multipleValues")),nearestValue:ku(s.getAttribute("nearestValue")),current:ku(s.getAttribute("current")),values:Je(s)}}),Attribution:Zt(function(s,i){return He({},bO,s,i)}),AuthorityURL:Un(function(s,i){var t=Oc(s,i);if(t)return t.name=s.getAttribute("name"),t}),Identifier:Un(Je),MetadataURL:Un(function(s,i){var t=Oc(s,i);if(t)return t.type=s.getAttribute("type"),t}),DataURL:Un(Oc),FeatureListURL:Un(Oc),Style:Un(function(s,i){return He({},IO,s,i)}),MinScaleDenominator:Zt(yn),MaxScaleDenominator:Zt(yn),Layer:Un(jS)}),bO=Le(os,{Title:Zt(Je),OnlineResource:Zt(Bh),LogoURL:Zt(BS)}),SO=Le(os,{westBoundLongitude:Zt(yn),eastBoundLongitude:Zt(yn),southBoundLatitude:Zt(yn),northBoundLatitude:Zt(yn)}),EO=Le(os,{GetCapabilities:Zt(N0),GetMap:Zt(N0),GetFeatureInfo:Zt(N0)}),CO=Le(os,{Format:Un(Je),DCPType:Un(function(s,i){return He({},TO,s,i)})}),TO=Le(os,{HTTP:Zt(function(s,i){return He({},PO,s,i)})}),PO=Le(os,{Get:Zt(Oc),Post:Zt(Oc)}),IO=Le(os,{Name:Zt(Je),Title:Zt(Je),Abstract:Zt(Je),LegendURL:Un(BS),StyleSheetURL:Zt(Oc),StyleURL:Zt(Oc)}),MO=Le(os,{Format:Zt(Je),OnlineResource:Zt(Bh)}),LO=Le(os,{Keyword:kr(Je)});function jS(s,i){var t=i[i.length-1],e=He({},GS,s,i);if(e){var o=ku(s.getAttribute("queryable"));o===void 0&&(o=t.queryable),e.queryable=o!==void 0&&o;var l=ec(s.getAttribute("cascaded"));l===void 0&&(l=t.cascaded),e.cascaded=l;var f=ku(s.getAttribute("opaque"));f===void 0&&(f=t.opaque),e.opaque=f!==void 0&&f;var y=ku(s.getAttribute("noSubsets"));y===void 0&&(y=t.noSubsets),e.noSubsets=y!==void 0&&y;var w=tc(s.getAttribute("fixedWidth"));w||(w=t.fixedWidth),e.fixedWidth=w;var b=tc(s.getAttribute("fixedHeight"));return b||(b=t.fixedHeight),e.fixedHeight=b,["Style","CRS","AuthorityURL"].forEach(function(I){if(I in t){var N=e[I]||[];e[I]=N.concat(t[I])}}),["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(I){if(!(I in e)){var N=t[I];e[I]=N}}),e}}function Oc(s,i){return He({},MO,s,i)}function N0(s,i){return He({},CO,s,i)}function BS(s,i){var t=Oc(s,i);if(t){var e=[ec(s.getAttribute("width")),ec(s.getAttribute("height"))];return t.size=e,t}}function zS(s,i){return He([],LO,s,i)}var AO=mO,OO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),NO=function(s){function i(t){var e=s.call(this)||this,o=t||{};return e.Gy="http://mapserver.gis.umn.edu/mapserver",e.Dy=new jh,e.Uh=o.layers?o.layers:null,e}return OO(i,s),i.prototype.getLayers=function(){return this.Uh},i.prototype.setLayers=function(t){this.Uh=t},i.prototype.zm=function(t,e){t.setAttribute("namespaceURI",this.Gy);var o=t.localName,l=[];if(t.childNodes.length===0)return l;if(o=="msGMLOutput")for(var f=0,y=t.childNodes.length;f<y;f++){var w=t.childNodes[f];if(w.nodeType===Node.ELEMENT_NODE){var b=w,I=e[0],N=b.localName.replace("_layer","");if(!this.Uh||pt(this.Uh,N)){var D=N+"_feature";I.featureType=D,I.featureNS=this.Gy;var j={};j[D]=kr(this.Dy.readFeatureElement,this.Dy);var H=Le([I.featureNS,null],j);b.setAttribute("namespaceURI",this.Gy);var Z=He([],H,b,e,this.Dy);Z&&ut(l,Z)}}}if(o=="FeatureCollection"){var it=He([],this.Dy.FEATURE_COLLECTION_PARSERS,t,[{}],this.Dy);it&&(l=it)}return l},i.prototype.readFeaturesFromNode=function(t,e){var o={};return e&&Vt(o,this.getReadOptions(t,e)),this.zm(t,[o])},i}(Dh),RO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),rc=[null,"http://www.opengis.net/wmts/1.0"],Jp=[null,"http://www.opengis.net/ows/1.1"],kO=Le(rc,{Contents:Zt(function(s,i){return He({},DO,s,i)})}),FO=function(s){function i(){var t=s.call(this)||this;return t.Rm=new Cb,t}return RO(i,s),i.prototype.readFromNode=function(t){var e=t.getAttribute("version");e&&(e=e.trim());var o=this.Rm.readFromNode(t);return o?(o.version=e,(o=He(o,kO,t,[]))||null):null},i}(bm),DO=Le(rc,{Layer:Un(function(s,i){return He({},GO,s,i)}),TileMatrixSet:Un(function(s,i){return He({},HO,s,i)})}),GO=Le(rc,{Style:Un(function(s,i){var t=He({},jO,s,i);if(t){var e=s.getAttribute("isDefault")==="true";return t.isDefault=e,t}}),Format:Un(Je),TileMatrixSetLink:Un(function(s,i){return He({},BO,s,i)}),Dimension:Un(function(s,i){return He({},UO,s,i)}),ResourceURL:Un(function(s,i){var t=s.getAttribute("format"),e=s.getAttribute("template"),o=s.getAttribute("resourceType"),l={};return t&&(l.format=t),e&&(l.template=e),o&&(l.resourceType=o),l})},Le(Jp,{Title:Zt(Je),Abstract:Zt(Je),WGS84BoundingBox:Zt(VS),Identifier:Zt(Je)})),jO=Le(rc,{LegendURL:Un(function(s,i){var t={};return t.format=s.getAttribute("format"),t.href=Bh(s),t})},Le(Jp,{Title:Zt(Je),Identifier:Zt(Je)})),BO=Le(rc,{TileMatrixSet:Zt(Je),TileMatrixSetLimits:Zt(function(s,i){return He([],zO,s,i)})}),zO=Le(rc,{TileMatrixLimits:kr(function(s,i){return He({},VO,s,i)})}),VO=Le(rc,{TileMatrix:Zt(Je),MinTileRow:Zt(yo),MaxTileRow:Zt(yo),MinTileCol:Zt(yo),MaxTileCol:Zt(yo)}),UO=Le(rc,{Default:Zt(Je),Value:Un(Je)},Le(Jp,{Identifier:Zt(Je)})),qO=Le(Jp,{LowerCorner:kr(R0),UpperCorner:kr(R0)}),HO=Le(rc,{WellKnownScaleSet:Zt(Je),TileMatrix:Un(function(s,i){return He({},XO,s,i)})},Le(Jp,{SupportedCRS:Zt(Je),Identifier:Zt(Je),BoundingBox:Zt(VS)})),XO=Le(rc,{TopLeftCorner:Zt(R0),ScaleDenominator:Zt(yn),TileWidth:Zt(yo),TileHeight:Zt(yo),MatrixWidth:Zt(yo),MatrixHeight:Zt(yo)},Le(Jp,{Identifier:Zt(Je)}));function VS(s,i){var t=He([],qO,s,i);if(t.length==2)return mr(t)}function R0(s,i){var t=Je(s).split(/\s+/);if(t&&t.length==2){var e=+t[0],o=+t[1];if(!isNaN(e)&&!isNaN(o))return[e,o]}}var WO=FO,YO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),US=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],ZO="enterfullscreen",$O="leavefullscreen";function qS(s){var i=s.body;return!!(i.webkitRequestFullscreen||i.msRequestFullscreen&&s.msFullscreenEnabled||i.requestFullscreen&&s.fullscreenEnabled)}function HS(s){return!!(s.webkitIsFullScreen||s.msFullscreenElement||s.fullscreenElement)}function XS(s){s.requestFullscreen?s.requestFullscreen():s.msRequestFullscreen?s.msRequestFullscreen():s.webkitRequestFullscreen&&s.webkitRequestFullscreen()}var KO=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{element:document.createElement("div"),target:o.target})||this).on,e.once,e.un,e.nf=o.keys!==void 0&&o.keys,e._v=o.source,e.Fm=!1,e.Gm=e.Dm.bind(e),e.qm=o.className!==void 0?o.className:"ol-full-screen",e.Um=[],e.Bm=o.activeClassName!==void 0?o.activeClassName.split(" "):[e.qm+"-true"],e.Xm=o.inactiveClassName!==void 0?o.inactiveClassName.split(" "):[e.qm+"-false"];var l=o.label!==void 0?o.label:"\u2922";e.Vm=typeof l=="string"?document.createTextNode(l):l;var f=o.labelActive!==void 0?o.labelActive:"\xD7";e.Wm=typeof f=="string"?document.createTextNode(f):f;var y=o.tipLabel?o.tipLabel:"Toggle full-screen";return e.Ym=document.createElement("button"),e.Ym.title=y,e.Ym.setAttribute("type","button"),e.Ym.appendChild(e.Vm),e.Ym.addEventListener(Br,e.kr.bind(e),!1),e.Zm(e.Ym,e.Fm),e.element.className="".concat(e.qm," ").concat(mc," ").concat(fa),e.element.appendChild(e.Ym),e}return YO(i,s),i.prototype.kr=function(t){t.preventDefault(),this.$m()},i.prototype.$m=function(){var t=this.getMap();if(t){var e=t.getOwnerDocument();if(qS(e))if(HS(e))(function(l){l.exitFullscreen?l.exitFullscreen():l.msExitFullscreen?l.msExitFullscreen():l.webkitExitFullscreen&&l.webkitExitFullscreen()})(e);else{var o=void 0;o=this._v?typeof this._v=="string"?e.getElementById(this._v):this._v:t.getTargetElement(),this.nf?function(l){l.webkitRequestFullscreen?l.webkitRequestFullscreen():XS(l)}(o):XS(o)}}},i.prototype.Km=function(){var t=this.getMap();if(t){var e=this.Fm;this.Fm=HS(t.getOwnerDocument()),e!==this.Fm&&(this.Zm(this.Ym,this.Fm),this.Fm?(Na(this.Wm,this.Vm),this.dispatchEvent(ZO)):(Na(this.Vm,this.Wm),this.dispatchEvent($O)),t.updateSize())}},i.prototype.Zm=function(t,e){var o,l,f,y;e?((o=t.classList).remove.apply(o,this.Xm),(l=t.classList).add.apply(l,this.Bm)):((f=t.classList).remove.apply(f,this.Bm),(y=t.classList).add.apply(y,this.Xm))},i.prototype.setMap=function(t){var e=this.getMap();e&&e.removeChangeListener(dl,this.Gm),s.prototype.setMap.call(this,t),this.Dm(),t&&t.addChangeListener(dl,this.Gm)},i.prototype.Dm=function(){for(var t=this.Um,e=0,o=t.length;e<o;++e)Or(t[e]);t.length=0;var l=this.getMap();if(l){var f=l.getOwnerDocument();for(qS(f)?this.element.classList.remove(yc):this.element.classList.add(yc),e=0,o=US.length;e<o;++e)t.push(Ee(f,US[e],this.Km,this));this.Km()}},i}(ya),JO=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),k0="projection",WS="coordinateFormat",QO=function(s){function i(t){var e=this,o=t||{},l=document.createElement("div");l.className=o.className!==void 0?o.className:"ol-mouse-position",(e=s.call(this,{element:l,render:o.render,target:o.target})||this).on,e.once,e.un,e.addChangeListener(k0,e.Tt),o.coordinateFormat&&e.setCoordinateFormat(o.coordinateFormat),o.projection&&e.setProjection(o.projection);var f=!0,y="&#160;";return"undefinedHTML"in o?(o.undefinedHTML!==void 0&&(y=o.undefinedHTML),f=!!y):"placeholder"in o&&(o.placeholder===!1?f=!1:y=String(o.placeholder)),e.Hm=y,e.Jm=f,e.Qm=l.innerHTML,e.tw=null,e.jt=null,e}return JO(i,s),i.prototype.Tt=function(){this.jt=null},i.prototype.getCoordinateFormat=function(){return this.get(WS)},i.prototype.getProjection=function(){return this.get(k0)},i.prototype.handleMouseMove=function(t){var e=this.getMap();this.nw(e.getEventPixel(t))},i.prototype.handleMouseOut=function(t){this.nw(null)},i.prototype.setMap=function(t){if(s.prototype.setMap.call(this,t),t){var e=t.getViewport();this.listenerKeys.push(Ee(e,lp,this.handleMouseMove,this)),this.Jm&&this.listenerKeys.push(Ee(e,cp,this.handleMouseOut,this)),this.nw(null)}},i.prototype.setCoordinateFormat=function(t){this.set(WS,t)},i.prototype.setProjection=function(t){this.set(k0,ie(t))},i.prototype.nw=function(t){var e=this.Hm;if(t&&this.tw){if(!this.jt){var o=this.getProjection();this.jt=o?ji(this.tw,o):Ke}var l=this.getMap().getCoordinateFromPixelInternal(t);if(l){var f=wo();f&&(this.jt=ji(this.tw,f)),this.jt(l,l);var y=this.getCoordinateFormat();e=y?y(l):l.toString()}}this.Qm&&e===this.Qm||(this.element.innerHTML=e,this.Qm=e)},i.prototype.render=function(t){var e=t.frameState;e?this.tw!=e.viewState.projection&&(this.tw=e.viewState.projection,this.jt=null):this.tw=null},i}(ya),YS=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),ZS=.75,F0=.1,tN=function(s){function i(){return s!==null&&s.apply(this,arguments)||this}return YS(i,s),i.prototype.createRenderer=function(){return new ap(this)},i}(dp),eN=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{element:document.createElement("div"),render:o.render,target:o.target})||this).iw=e.rw.bind(e),e.Sr=o.collapsed===void 0||o.collapsed,e.Tr=o.collapsible===void 0||o.collapsible,e.Tr||(e.Sr=!1),e.su=o.rotateWithView!==void 0&&o.rotateWithView,e.ew=void 0;var l=o.className!==void 0?o.className:"ol-overviewmap",f=o.tipLabel!==void 0?o.tipLabel:"Overview map",y=o.collapseLabel!==void 0?o.collapseLabel:"\u2039";typeof y=="string"?(e.Ar=document.createElement("span"),e.Ar.textContent=y):e.Ar=y;var w=o.label!==void 0?o.label:"\u203A";typeof w=="string"?(e.Pr=document.createElement("span"),e.Pr.textContent=w):e.Pr=w;var b=e.Tr&&!e.Sr?e.Ar:e.Pr,I=document.createElement("button");I.setAttribute("type","button"),I.title=f,I.appendChild(b),I.addEventListener(Br,e.kr.bind(e),!1),e.ow=document.createElement("div"),e.ow.className="ol-overviewmap-map",e.Uy=o.view,e.sw=new tN({view:o.view});var N=e.sw;o.layers&&o.layers.forEach(function(yt){N.addLayer(yt)});var D=document.createElement("div");D.className="ol-overviewmap-box",D.style.boxSizing="border-box",e.uw=new y1({position:[0,0],positioning:"center-center",element:D}),e.sw.addOverlay(e.uw);var j=l+" ol-unselectable "+fa+(e.Sr&&e.Tr?" ol-collapsed":"")+(e.Tr?"":" ol-uncollapsible"),H=e.element;H.className=j,H.appendChild(e.ow),H.appendChild(I);var Z=e,it=e.uw,at=e.uw.getElement(),wt=function(yt){var It,Rt={clientX:(It=yt).clientX,clientY:It.clientY},kt=N.getEventCoordinateInternal(Rt);it.setPosition(kt)},gt=function(yt){var It=N.getEventCoordinateInternal(yt);Z.getMap().getView().setCenterInternal(It),window.removeEventListener("mousemove",wt),window.removeEventListener("mouseup",gt)};return at.addEventListener("mousedown",function(){window.addEventListener("mousemove",wt),window.addEventListener("mouseup",gt)}),e}return YS(i,s),i.prototype.setMap=function(t){var e=this.getMap();if(t!==e){if(e){var o=e.getView();o&&this.aw(o),this.sw.setTarget(null)}if(s.prototype.setMap.call(this,t),t){this.sw.setTarget(this.ow),this.listenerKeys.push(Ee(t,K,this.hw,this));var l=t.getView();l&&(this.fw(l),l.isDef()&&(this.sw.updateSize(),this.cw())),this.sw.isRendered()||this.lw()}}},i.prototype.hw=function(t){if(t.key===zl){var e=t.oldValue;e&&this.aw(e);var o=this.getMap().getView();this.fw(o)}else this.sw.isRendered()||t.key!==dl&&t.key!==fh||this.sw.updateSize()},i.prototype.fw=function(t){if(!this.Uy){var e=new no({projection:t.getProjection()});this.sw.setView(e)}t.addChangeListener(Ns.ROTATION,this.iw),this.rw()},i.prototype.aw=function(t){t.removeChangeListener(Ns.ROTATION,this.iw)},i.prototype.rw=function(){this.su&&this.sw.getView().setRotation(this.getMap().getView().getRotation())},i.prototype.dw=function(){var t=this.getMap(),e=this.sw;if(t.isRendered()&&e.isRendered()){var o=t.getSize(),l=t.getView().calculateExtentInternal(o);if(!this.ew||!ko(l,this.ew)){this.ew=l;var f=e.getSize(),y=e.getView().calculateExtentInternal(f),w=e.getPixelFromCoordinateInternal(Zr(l)),b=e.getPixelFromCoordinateInternal(Yo(l)),I=Math.abs(w[0]-b[0]),N=Math.abs(w[1]-b[1]),D=f[0],j=f[1];I<D*F0||N<j*F0||I>D*ZS||N>j*ZS?this.cw():pn(y,l)||this.pw()}}},i.prototype.cw=function(){var t=this.getMap(),e=this.sw,o=t.getSize(),l=t.getView().calculateExtentInternal(o),f=e.getView(),y=Math.log(7.5)/Math.LN2;v(l,1/(Math.pow(2,y/2)*F0)),f.fitInternal(Ao(l))},i.prototype.pw=function(){var t=this.getMap(),e=this.sw,o=t.getView();e.getView().setCenterInternal(o.getCenterInternal())},i.prototype.yw=function(){var t=this.getMap(),e=this.sw;if(t.isRendered()&&e.isRendered()){var o=t.getSize(),l=t.getView(),f=e.getView(),y=this.su?0:-l.getRotation(),w=this.uw,b=this.uw.getElement(),I=l.getCenterInternal(),N=l.getResolution(),D=f.getResolution(),j=o[0]*N/D,H=o[1]*N/D;if(w.setPosition(I),b){b.style.width=j+"px",b.style.height=H+"px";var Z="rotate("+y+"rad)";b.style.transform=Z}}},i.prototype.lw=function(){this.mw||(this.mw=Sr(this.sw,ga,function(t){delete this.mw,this.yw()},this))},i.prototype.kr=function(t){t.preventDefault(),this.zr()},i.prototype.zr=function(){this.element.classList.toggle(nu),this.Sr?Na(this.Ar,this.Pr):Na(this.Pr,this.Ar),this.Sr=!this.Sr;var t=this.sw;if(!this.Sr){if(t.isRendered())return this.ew=void 0,void t.render();t.updateSize(),this.cw(),this.lw()}},i.prototype.getCollapsible=function(){return this.Tr},i.prototype.setCollapsible=function(t){this.Tr!==t&&(this.Tr=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.Sr&&this.zr())},i.prototype.setCollapsed=function(t){this.Tr&&this.Sr!==t&&this.zr()},i.prototype.getCollapsed=function(){return this.Sr},i.prototype.getRotateWithView=function(){return this.su},i.prototype.setRotateWithView=function(t){this.su!==t&&(this.su=t,this.getMap().getView().getRotation()!==0&&(this.su?this.rw():this.sw.getView().setRotation(0),this.ew=void 0,this.dw(),this.yw()))},i.prototype.getOverviewMap=function(){return this.sw},i.prototype.render=function(t){this.dw(),this.yw()},i}(ya),rN=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),D0="units",$S="degrees",iN="imperial",nN="nautical",KS="metric",oN="us",sN=[1,2,5],Pd=25.4/.28,aN=function(s){function i(t){var e=this,o=t||{},l=o.className!==void 0?o.className:o.bar?"ol-scale-bar":"ol-scale-line";return(e=s.call(this,{element:document.createElement("div"),render:o.render,target:o.target})||this).on,e.once,e.un,e.ww=document.createElement("div"),e.ww.className=l+"-inner",e.element.className=l+" "+mc,e.element.appendChild(e.ww),e.gw=null,e.bw=o.minWidth!==void 0?o.minWidth:64,e.xw=o.maxWidth,e.mn=!1,e.Mw=void 0,e.Qm="",e.addChangeListener(D0,e._w),e.setUnits(o.units||KS),e.Sw=o.bar||!1,e.Ow=o.steps||4,e.jw=o.text||!1,e.Ew=o.dpi||void 0,e}return rN(i,s),i.prototype.getUnits=function(){return this.get(D0)},i.prototype._w=function(){this.Lr()},i.prototype.setUnits=function(t){this.set(D0,t)},i.prototype.setDpi=function(t){this.Ew=t},i.prototype.Lr=function(){var t=this.gw;if(t){var e=t.center,o=t.projection,l=this.getUnits(),f=l==$S?Mi.DEGREES:Mi.METERS,y=ti(o,t.resolution,e,f),w=this.bw*(this.Ew||Pd)/Pd,b=this.xw!==void 0?this.xw*(this.Ew||Pd)/Pd:void 0,I=w*y,N="";if(l==$S){var D=Di[Mi.DEGREES];(I*=D)<D/60?(N="\u2033",y*=3600):I<D?(N="\u2032",y*=60):N="\xB0"}else l==iN?I<.9144?(N="in",y/=.0254):I<1609.344?(N="ft",y/=.3048):(N="mi",y/=1609.344):l==nN?(y/=1852,N="NM"):l==KS?I<.001?(N="\u03BCm",y*=1e6):I<1?(N="mm",y*=1e3):I<1e3?N="m":(N="km",y/=1e3):l==oN?I<.9144?(N="in",y*=39.37):I<1609.344?(N="ft",y/=.30480061):(N="mi",y/=1609.3472):Me(!1,33);for(var j,H,Z,it,at,wt,gt,yt=3*Math.floor(Math.log(w*y)/Math.log(10));;){Z=Math.floor(yt/3);var It=Math.pow(10,Z);if(j=sN[(yt%3+3)%3]*It,H=Math.round(j/y),isNaN(H))return this.element.style.display="none",void(this.mn=!1);if(b!==void 0&&H>=b){j=it,H=at,Z=wt;break}if(H>=w)break;it=j,at=H,wt=Z,++yt}gt=this.Sw?this.createScaleBar(H,j,N):j.toFixed(Z<0?-Z:0)+" "+N,this.Qm!=gt&&(this.ww.innerHTML=gt,this.Qm=gt),this.Mw!=H&&(this.ww.style.width=H+"px",this.Mw=H),this.mn||(this.element.style.display="",this.mn=!0)}else this.mn&&(this.element.style.display="none",this.mn=!1)},i.prototype.createScaleBar=function(t,e,o){for(var l="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),f=[],y=t/this.Ow,w="ol-scale-singlebar-odd",b=0;b<this.Ow;b++)b===0&&f.push(this.createMarker("absolute",b)),f.push('<div><div class="ol-scale-singlebar '+w+'" style="width: '+y+'px;"></div>'+this.createMarker("relative",b)+(b%2==0||this.Ow===2?this.createStepText(b,t,!1,e,o):"")+"</div>"),b===this.Ow-1&&f.push(this.createStepText(b+1,t,!0,e,o)),w=w==="ol-scale-singlebar-odd"?"ol-scale-singlebar-even":"ol-scale-singlebar-odd";return'<div style="display: flex;">'+(this.jw?'<div class="ol-scale-text" style="width: '+t+'px;">'+l+"</div>":"")+f.join("")+"</div>"},i.prototype.createMarker=function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+(t==="absolute"?3:-10)+'px;"></div>'},i.prototype.createStepText=function(t,e,o,l,f){var y=(t===0?0:Math.round(l/this.Ow*t*100)/100)+(t===0?"":" "+f);return'<div class="ol-scale-step-text" style="margin-left: '+(t===0?-3:e/this.Ow*-1)+"px;text-align: "+(t===0?"left":"center")+"; min-width: "+(t===0?0:e/this.Ow*2)+"px;left: "+(o?e+"px":"unset")+';">'+y+"</div>"},i.prototype.getScaleForResolution=function(){var t=ti(this.gw.projection,this.gw.resolution,this.gw.center,Mi.METERS),e=this.Ew||Pd;return parseFloat(t.toString())*(1e3/25.4)*e},i.prototype.render=function(t){var e=t.frameState;this.gw=e?e.viewState:null,this.Lr()},i}(ya),lN=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),JS=0,G0=1,cN=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{element:document.createElement("div"),render:o.render})||this).kn=[],e.Tw=void 0,e.Aw=JS,e.Cn,e.Pw=0,e.Cw=0,e.kw,e.Iw,e.Nw=null,e.Lw=!1,e.Fr=o.duration!==void 0?o.duration:200;var l=o.className!==void 0?o.className:"ol-zoomslider",f=document.createElement("button");f.setAttribute("type","button"),f.className=l+"-thumb "+mc;var y=e.element;return y.className=l+" ol-unselectable "+fa,y.appendChild(f),y.addEventListener(Ls,e.zw.bind(e),!1),y.addEventListener(lp,e.Rw.bind(e),!1),y.addEventListener(Bl,e.Fw.bind(e),!1),y.addEventListener(Br,e.Gw.bind(e),!1),f.addEventListener(Br,B,!1),e}return lN(i,s),i.prototype.setMap=function(t){s.prototype.setMap.call(this,t),t&&t.render()},i.prototype.Dw=function(){var t=this.element,e=t.offsetWidth,o=t.offsetHeight;if(e===0&&o===0)return this.Lw=!1;var l=getComputedStyle(t);e-=parseFloat(l.paddingRight)+parseFloat(l.paddingLeft),o-=parseFloat(l.paddingTop)+parseFloat(l.paddingBottom);var f=t.firstElementChild,y=getComputedStyle(f),w=f.offsetWidth+parseFloat(y.marginRight)+parseFloat(y.marginLeft),b=f.offsetHeight+parseFloat(y.marginTop)+parseFloat(y.marginBottom);return this.Nw=[w,b],e>o?(this.Aw=G0,this.Cw=e-w):(this.Aw=JS,this.Pw=o-b),this.Lw=!0},i.prototype.Gw=function(t){var e=this.getMap().getView(),o=this.qw(t.offsetX-this.Nw[0]/2,t.offsetY-this.Nw[1]/2),l=this.Uw(o),f=e.getConstrainedZoom(e.getZoomForResolution(l));e.animateInternal({zoom:f,duration:this.Fr,easing:zt})},i.prototype.zw=function(t){if(!this.Cn&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.kw=t.clientX-parseFloat(e.style.left),this.Iw=t.clientY-parseFloat(e.style.top),this.Cn=!0,this.kn.length===0){var o=this.Rw,l=this.Fw,f=this.getMap().getOwnerDocument();this.kn.push(Ee(f,lp,o,this),Ee(f,Bl,l,this))}}},i.prototype.Rw=function(t){if(this.Cn){var e=t.clientX-this.kw,o=t.clientY-this.Iw,l=this.qw(e,o);this.Tw=this.Uw(l),this.getMap().getView().setResolution(this.Tw)}},i.prototype.Fw=function(t){this.Cn&&(this.getMap().getView().endInteraction(),this.Cn=!1,this.kw=void 0,this.Iw=void 0,this.kn.forEach(Or),this.kn.length=0)},i.prototype.Bw=function(t){var e=this.Xw(t),o=this.element.firstElementChild;this.Aw==G0?o.style.left=this.Cw*e+"px":o.style.top=this.Pw*e+"px"},i.prototype.qw=function(t,e){return Y(this.Aw===G0?t/this.Cw:e/this.Pw,0,1)},i.prototype.Uw=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},i.prototype.Xw=function(t){return Y(1-this.getMap().getView().getValueForResolutionFunction()(t),0,1)},i.prototype.render=function(t){if(t.frameState&&(this.Lw||this.Dw())){var e=t.frameState.viewState.resolution;this.Tw=e,this.Bw(e)}},i}(ya),uN=function(){var s=function(i,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}s(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),hN=function(s){function i(t){var e=this,o=t||{};(e=s.call(this,{element:document.createElement("div"),target:o.target})||this).extent=o.extent?o.extent:null;var l=o.className!==void 0?o.className:"ol-zoom-extent",f=o.label!==void 0?o.label:"E",y=o.tipLabel!==void 0?o.tipLabel:"Fit to extent",w=document.createElement("button");w.setAttribute("type","button"),w.title=y,w.appendChild(typeof f=="string"?document.createTextNode(f):f),w.addEventListener(Br,e.kr.bind(e),!1);var b=l+" ol-unselectable "+fa,I=e.element;return I.className=b,I.appendChild(w),e}return uN(i,s),i.prototype.kr=function(t){t.preventDefault(),this.handleZoomToExtent()},i.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal(Ao(e))},i}(ya),z={};z.AssertionError=G,z.Collection=Be,z.Collection.CollectionEvent=Ve,z.DataTile=xr,z.Disposable=Q,z.Feature=Mr,z.Feature.createStyleFunction=fr,z.Geolocation=sl,z.Image=pc,z.Image.listenImage=Ku,z.ImageBase=hc,z.ImageCanvas=$c,z.ImageTile=fc,z.Kinetic=np,z.Map=RE,z.MapBrowserEvent=Ms,z.MapBrowserEventHandler=jn,z.MapEvent=go,z.Object=cn,z.Object.ObjectEvent=Xn,z.Observable=eo,z.Observable.unByKey=oi,z.Overlay=y1,z.PluggableMap=dp,z.Tile=Se,z.TileCache=ig,z.TileQueue=Tf,z.TileQueue.getTilePriority=qd,z.TileRange=ng,z.TileRange.createOrUpdate=yh,z.VectorRenderTile=b1,z.VectorTile=S1,z.View=no,z.View.createCenterConstraint=Ye,z.View.createResolutionConstraint=sr,z.View.createRotationConstraint=Cr,z.View.isNoopAnimation=Ii,z.array={},z.array.binarySearch=et,z.array.equals=$,z.array.extend=ut,z.array.find=ft,z.array.findIndex=_t,z.array.includes=pt,z.array.isSorted=W,z.array.linearFindNearest=T,z.array.numberSafeCompareFunction=lt,z.array.remove=function(s,i){var t=s.indexOf(i),e=t>-1;return e&&s.splice(t,1),e},z.array.reverseSubArray=ct,z.array.stableSort=function(s,i){var t,e=s.length,o=Array(s.length);for(t=0;t<e;t++)o[t]={index:t,value:s[t]};for(o.sort(function(l,f){return i(l.value,f.value)||l.index-f.index}),t=0;t<s.length;t++)s[t]=o[t].value},z.asserts={},z.asserts.assert=Me,z.centerconstraint={},z.centerconstraint.createExtent=Pf,z.centerconstraint.none=dt,z.color={},z.color.asArray=Ra,z.color.asString=Pi,z.color.fromString=ua,z.color.isStringColor=ps,z.color.normalize=Qc,z.color.toString=Qu,z.colorlike={},z.colorlike.asColorLike=gl,z.control={},z.control.Attribution=Lf,z.control.Control=ya,z.control.FullScreen=KO,z.control.MousePosition=QO,z.control.OverviewMap=eN,z.control.Rotate=gp,z.control.ScaleLine=aN,z.control.Zoom=Y0,z.control.ZoomSlider=cN,z.control.ZoomToExtent=hN,z.control.defaults=Z0,z.coordinate={},z.coordinate.add=bs,z.coordinate.closestOnCircle=io,z.coordinate.closestOnSegment=Ss,z.coordinate.createStringXY=function(s){return function(i){return ia(i,s)}},z.coordinate.degreesToStringHDMS=en,z.coordinate.distance=Es,z.coordinate.equals=mn,z.coordinate.format=Zo,z.coordinate.getWorldsAway=mt,z.coordinate.rotate=es,z.coordinate.scale=On,z.coordinate.squaredDistance=mi,z.coordinate.squaredDistanceToSegment=Do,z.coordinate.toStringHDMS=function(s,i){return s?en("NS",s[1],i)+" "+en("EW",s[0],i):""},z.coordinate.toStringXY=ia,z.coordinate.wrapX=tt,z.css={},z.css.CLASS_COLLAPSED=nu,z.css.CLASS_CONTROL=fa,z.css.CLASS_HIDDEN=Nl,z.css.CLASS_SELECTABLE=jm,z.css.CLASS_UNSELECTABLE=mc,z.css.CLASS_UNSUPPORTED=yc,z.css.getFontParameters=oh,z.dom={},z.dom.createCanvasContext2D=Cn,z.dom.outerHeight=Vd,z.dom.outerWidth=zd,z.dom.releaseCanvas=ip,z.dom.removeChildren=Jc,z.dom.removeNode=Kc,z.dom.replaceChildren=Ud,z.dom.replaceNode=Na,z.easing={},z.easing.easeIn=ot,z.easing.easeOut=zt,z.easing.inAndOut=Wt,z.easing.linear=Ut,z.easing.upAndDown=function(s){return s<.5?Wt(2*s):1-Wt(2*(s-.5))},z.events={},z.events.Event=O,z.events.Event.preventDefault=function(s){s.preventDefault()},z.events.Event.stopPropagation=B,z.events.Target=ue,z.events.condition={},z.events.condition.all=Kd,z.events.condition.altKeyOnly=J0,z.events.condition.altShiftKeysOnly=Q0,z.events.condition.always=mp,z.events.condition.click=function(s){return s.type==zi.CLICK},z.events.condition.doubleClick=function(s){return s.type==zi.DBLCLICK},z.events.condition.focus=t1,z.events.condition.focusWithTabindex=Bm,z.events.condition.mouseActionButton=zm,z.events.condition.mouseOnly=mh,z.events.condition.never=Vm,z.events.condition.noModifierKeys=Jd,z.events.condition.penOnly=function(s){var i=s.originalEvent;return Me(i!==void 0,56),i.pointerType==="pen"},z.events.condition.platformModifierKeyOnly=function(s){var i=s.originalEvent;return!i.altKey&&(Jr?i.metaKey:i.ctrlKey)&&!i.shiftKey},z.events.condition.pointerMove=function(s){return s.type=="pointermove"},z.events.condition.primaryAction=Hm,z.events.condition.shiftKeyOnly=Of,z.events.condition.singleClick=Um,z.events.condition.targetNotEditable=qm,z.events.condition.touchOnly=function(s){var i=s.originalEvent;return Me(i!==void 0,56),i.pointerType==="touch"},z.events.listen=Ee,z.events.listenOnce=Sr,z.events.unlistenByKey=Or,z.extent={},z.extent.applyTransform=M,z.extent.approximatelyEquals=ba,z.extent.boundingExtent=mr,z.extent.buffer=Fr,z.extent.clone=Ur,z.extent.closestSquaredDistanceXY=ui,z.extent.containsCoordinate=nn,z.extent.containsExtent=pn,z.extent.containsXY=Co,z.extent.coordinateRelationship=Us,z.extent.createEmpty=Wn,z.extent.createOrUpdate=En,z.extent.createOrUpdateEmpty=ao,z.extent.createOrUpdateFromCoordinate=as,z.extent.createOrUpdateFromCoordinates=function(s,i){return Qa(ao(i),s)},z.extent.createOrUpdateFromFlatCoordinates=vs,z.extent.createOrUpdateFromRings=function(s,i){return bl(ao(i),s)},z.extent.equals=ko,z.extent.extend=_s,z.extent.extendCoordinate=Wo,z.extent.extendCoordinates=Qa,z.extent.extendFlatCoordinates=tl,z.extent.extendRings=bl,z.extent.extendXY=el,z.extent.forEachCorner=xs,z.extent.getArea=_o,z.extent.getBottomLeft=To,z.extent.getBottomRight=Yo,z.extent.getCenter=Gi,z.extent.getCorner=Sl,z.extent.getEnlargedArea=function(s,i){var t=Math.min(s[0],i[0]),e=Math.min(s[1],i[1]);return(Math.max(s[2],i[2])-t)*(Math.max(s[3],i[3])-e)},z.extent.getForViewAndSize=Po,z.extent.getHeight=Ki,z.extent.getIntersection=fn,z.extent.getIntersectionArea=function(s,i){return _o(fn(s,i))},z.extent.getMargin=function(s){return Gr(s)+Ki(s)},z.extent.getRotatedViewport=Yn,z.extent.getSize=function(s){return[s[2]-s[0],s[3]-s[1]]},z.extent.getTopLeft=Zr,z.extent.getTopRight=Qn,z.extent.getWidth=Gr,z.extent.intersects=on,z.extent.intersectsSegment=S,z.extent.isEmpty=ws,z.extent.returnOrUpdate=Hi,z.extent.scaleFromCenter=v,z.extent.wrapAndSliceX=V,z.extent.wrapX=R,z.featureloader={},z.featureloader.loadFeaturesXhr=Km,z.featureloader.setWithCredentials=function(s){E1=s},z.featureloader.xhr=Jm,z.format={},z.format.EsriJSON=JI,z.format.Feature=Gp,z.format.Feature.transformExtentWithOptions=kg,z.format.Feature.transformGeometryWithOptions=qn,z.format.GML=sM,z.format.GML2=jh,z.format.GML3=Ri,z.format.GML32=sm,z.format.GMLBase=Ni,z.format.GMLBase.GMLNS=Ru,z.format.GPX=NM,z.format.GeoJSON=Rx,z.format.IGC=VM,z.format.IIIFInfo=FT,z.format.JSONFeature=Dg,z.format.KML=HL,z.format.KML.getDefaultFillStyle=function(){return Cd},z.format.KML.getDefaultImageStyle=function(){return fm},z.format.KML.getDefaultStrokeStyle=function(){return dm},z.format.KML.getDefaultStyle=function(){return f0},z.format.KML.getDefaultStyleArray=function(){return mm},z.format.KML.getDefaultTextStyle=function(){return Fu},z.format.KML.readFlatCoordinates=d0,z.format.MVT=hv,z.format.OSMXML=KL,z.format.OWS=Cb,z.format.Polyline=gA,z.format.Polyline.decodeDeltas=Pb,z.format.Polyline.decodeFloats=Mb,z.format.Polyline.decodeSignedIntegers=Ab,z.format.Polyline.decodeUnsignedIntegers=Nb,z.format.Polyline.encodeDeltas=Tb,z.format.Polyline.encodeFloats=Ib,z.format.Polyline.encodeSignedIntegers=Lb,z.format.Polyline.encodeUnsignedInteger=Rb,z.format.Polyline.encodeUnsignedIntegers=Ob,z.format.TextFeature=pm,z.format.TopoJSON=wA,z.format.WFS=QA,z.format.WFS.writeFilter=function(s,i){var t=i||"1.1.0",e=ai(Td(t),"Filter"),o={node:e};return Vt(o,{version:t,filter:s}),vS(e,s,[o]),e},z.format.WKB=rO,z.format.WKT=pO,z.format.WMSCapabilities=AO,z.format.WMSGetFeatureInfo=NO,z.format.WMTSCapabilities=WO,z.format.XML=bm,z.format.XMLFeature=Dh,z.format.filter={},z.format.filter.And=Fb,z.format.filter.Bbox=Db,z.format.filter.Comparison=Zp,z.format.filter.ComparisonBinary=Vh,z.format.filter.Contains=Gb,z.format.filter.DWithin=jb,z.format.filter.Disjoint=Bb,z.format.filter.During=zb,z.format.filter.EqualTo=Vb,z.format.filter.Filter=zh,z.format.filter.GreaterThan=Ub,z.format.filter.GreaterThanOrEqualTo=qb,z.format.filter.Intersects=Hb,z.format.filter.IsBetween=Xb,z.format.filter.IsLike=Wb,z.format.filter.IsNull=Yb,z.format.filter.LessThan=Zb,z.format.filter.LessThanOrEqualTo=$b,z.format.filter.LogicalNary=w0,z.format.filter.Not=Kb,z.format.filter.NotEqualTo=Jb,z.format.filter.Or=Qb,z.format.filter.ResourceId=tS,z.format.filter.Spatial=Yp,z.format.filter.Within=eS,z.format.filter.and=rS,z.format.filter.bbox=iS,z.format.filter.between=function(s,i,t){return new Xb(s,i,t)},z.format.filter.contains=function(s,i,t){return new Gb(s,i,t)},z.format.filter.disjoint=function(s,i,t){return new Bb(s,i,t)},z.format.filter.during=function(s,i,t){return new zb(s,i,t)},z.format.filter.dwithin=function(s,i,t,e,o){return new jb(s,i,t,e,o)},z.format.filter.equalTo=function(s,i,t){return new Vb(s,i,t)},z.format.filter.greaterThan=function(s,i){return new Ub(s,i)},z.format.filter.greaterThanOrEqualTo=function(s,i){return new qb(s,i)},z.format.filter.intersects=function(s,i,t){return new Hb(s,i,t)},z.format.filter.isNull=function(s){return new Yb(s)},z.format.filter.lessThan=function(s,i){return new Zb(s,i)},z.format.filter.lessThanOrEqualTo=function(s,i){return new $b(s,i)},z.format.filter.like=function(s,i,t,e,o,l){return new Wb(s,i,t,e,o,l)},z.format.filter.not=function(s){return new Kb(s)},z.format.filter.notEqualTo=function(s,i,t){return new Jb(s,i,t)},z.format.filter.or=function(s){var i=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Qb,i))},z.format.filter.resourceId=function(s){return new tS(s)},z.format.filter.within=function(s,i,t){return new eS(s,i,t)},z.format.xlink={},z.format.xlink.readHref=Bh,z.format.xsd={},z.format.xsd.readBoolean=Mc,z.format.xsd.readBooleanString=ku,z.format.xsd.readDateTime=om,z.format.xsd.readDecimal=yn,z.format.xsd.readDecimalString=tc,z.format.xsd.readNonNegativeIntegerString=ec,z.format.xsd.readPositiveInteger=yo,z.format.xsd.readString=Je,z.format.xsd.writeBooleanTextNode=Gh,z.format.xsd.writeCDATASection=Ww,z.format.xsd.writeDateTimeTextNode=Yw,z.format.xsd.writeDecimalTextNode=js,z.format.xsd.writeNonNegativeIntegerTextNode=Sd,z.format.xsd.writeStringTextNode=ni,z.functions={},z.functions.FALSE=nt,z.functions.TRUE=rt,z.functions.VOID=vt,z.functions.memoizeOne=Mt,z.functions.toPromise=Bt,z.geom={},z.geom.Circle=t0,z.geom.Geometry=zc,z.geom.GeometryCollection=ns,z.geom.LineString=uo,z.geom.LinearRing=Xc,z.geom.MultiLineString=Ks,z.geom.MultiPoint=Va,z.geom.MultiPolygon=Ua,z.geom.Point=rn,z.geom.Polygon=Lo,z.geom.Polygon.circular=mf,z.geom.Polygon.fromCircle=us,z.geom.Polygon.fromExtent=Ao,z.geom.Polygon.makeRegular=uc,z.geom.SimpleGeometry=Cs,z.geom.SimpleGeometry.getStrideForLayout=Vc,z.geom.SimpleGeometry.transformGeom2D=El,z.geom.flat={},z.geom.flat.area={},z.geom.flat.area.linearRing=Ko,z.geom.flat.area.linearRings=hf,z.geom.flat.area.linearRingss=lc,z.geom.flat.center={},z.geom.flat.center.linearRingss=lv,z.geom.flat.closest={},z.geom.flat.closest.arrayMaxSquaredDelta=Go,z.geom.flat.closest.assignClosestArrayPoint=sa,z.geom.flat.closest.assignClosestMultiArrayPoint=ls,z.geom.flat.closest.assignClosestPoint=Ir,z.geom.flat.closest.maxSquaredDelta=Uc,z.geom.flat.closest.multiArrayMaxSquaredDelta=rl,z.geom.flat.contains={},z.geom.flat.contains.linearRingContainsExtent=Hu,z.geom.flat.contains.linearRingContainsXY=Aa,z.geom.flat.contains.linearRingsContainsXY=Qh,z.geom.flat.contains.linearRingssContainsXY=Xu,z.geom.flat.deflate={},z.geom.flat.deflate.deflateCoordinate=ac,z.geom.flat.deflate.deflateCoordinates=Ca,z.geom.flat.deflate.deflateCoordinatesArray=$h,z.geom.flat.deflate.deflateMultiCoordinatesArray=Ta,z.geom.flat.flip={},z.geom.flat.flip.flipXY=r0,z.geom.flat.geodesic={},z.geom.flat.geodesic.greatCircleArc=function(s,i,t,e,o,l){var f=ie("EPSG:4326"),y=Math.cos(qt(i)),w=Math.sin(qt(i)),b=Math.cos(qt(e)),I=Math.sin(qt(e)),N=Math.cos(qt(t-s)),D=Math.sin(qt(t-s)),j=w*I+y*b*N;return cv(function(H){if(1<=j)return[t,e];var Z=H*Math.acos(j),it=Math.cos(Z),at=Math.sin(Z),wt=D*b,gt=y*I-w*b*N,yt=Math.atan2(wt,gt),It=Math.asin(w*it+y*at*Math.cos(yt));return[Et(qt(s)+Math.atan2(Math.sin(yt)*at*y,it-w*Math.sin(It))),Et(It)]},zn(f,o),l)},z.geom.flat.geodesic.meridian=Lx,z.geom.flat.geodesic.parallel=Ax,z.geom.flat.inflate={},z.geom.flat.inflate.inflateCoordinates=cs,z.geom.flat.inflate.inflateCoordinatesArray=Ma,z.geom.flat.inflate.inflateMultiCoordinatesArray=La,z.geom.flat.interiorpoint={},z.geom.flat.interiorpoint.getInteriorPointOfArray=tp,z.geom.flat.interiorpoint.getInteriorPointsOfMultiArray=pf,z.geom.flat.interpolate={},z.geom.flat.interpolate.interpolatePoint=sd,z.geom.flat.interpolate.lineStringCoordinateAtM=Ag,z.geom.flat.interpolate.lineStringsCoordinateAtM=Px,z.geom.flat.intersectsextent={},z.geom.flat.intersectsextent.intersectsLineString=Cl,z.geom.flat.intersectsextent.intersectsLineStringArray=Tl,z.geom.flat.intersectsextent.intersectsLinearRing=Wc,z.geom.flat.intersectsextent.intersectsLinearRingArray=ff,z.geom.flat.intersectsextent.intersectsLinearRingMultiArray=il,z.geom.flat.length={},z.geom.flat.length.lineStringLength=Lg,z.geom.flat.length.linearRingLength=function(s,i,t,e){var o=Lg(s,i,t,e),l=s[t-e]-s[i],f=s[t-e+1]-s[i+1];return o+=Math.sqrt(l*l+f*f)},z.geom.flat.orient={},z.geom.flat.orient.inflateEnds=gf,z.geom.flat.orient.linearRingIsClockwise=Pl,z.geom.flat.orient.linearRingsAreOriented=df,z.geom.flat.orient.linearRingssAreOriented=Zc,z.geom.flat.orient.orientLinearRings=Il,z.geom.flat.orient.orientLinearRingsArray=Ml,z.geom.flat.reverse={},z.geom.flat.reverse.coordinates=Yc,z.geom.flat.segments={},z.geom.flat.segments.forEach=Wu,z.geom.flat.simplify={},z.geom.flat.simplify.douglasPeucker=Pa,z.geom.flat.simplify.douglasPeuckerArray=aa,z.geom.flat.simplify.douglasPeuckerMultiArray=function(s,i,t,e,o,l,f,y){for(var w=0,b=t.length;w<b;++w){var I=t[w],N=[];f=aa(s,i,I,e,o,l,f,N),y.push(N),i=I[I.length-1]}return f},z.geom.flat.simplify.quantize=Ia,z.geom.flat.simplify.quantizeArray=Kh,z.geom.flat.simplify.quantizeMultiArray=Hc,z.geom.flat.simplify.radialDistance=qc,z.geom.flat.simplify.simplifyLineString=function(s,i,t,e,o,l,f){var y=f!==void 0?f:[];return l||(t=qc(s,i,t,e,o,y,0),s=y,i=0,e=2),y.length=Pa(s,i,t,e,o,y,0),y},z.geom.flat.simplify.snap=jo,z.geom.flat.straightchunk={},z.geom.flat.straightchunk.matchingChunk=yx,z.geom.flat.textpath={},z.geom.flat.textpath.drawTextOnPath=_x,z.geom.flat.topology={},z.geom.flat.topology.lineStringIsClosed=function(s,i,t,e){var o=t-e;return s[i]===s[o]&&s[i+1]===s[o+1]&&(t-i)/e>3&&!!Ko(s,i,t,e)},z.geom.flat.transform={},z.geom.flat.transform.rotate=Uu,z.geom.flat.transform.scale=cf,z.geom.flat.transform.transform2D=Sa,z.geom.flat.transform.translate=Ea,z.has={},z.has.DEVICE_PIXEL_RATIO=tn,z.has.FIREFOX=Qo,z.has.IMAGE_DECODE=St,z.has.MAC=Jr,z.has.PASSIVE_EVENT_LISTENERS=_i,z.has.SAFARI=ci,z.has.SAFARI_BUG_237906=wn,z.has.WEBKIT=vi,z.has.WORKER_OFFSCREEN_CANVAS=gr,z.interaction={},z.interaction.DoubleClickZoom=K0,z.interaction.DragAndDrop=TI,z.interaction.DragAndDrop.DragAndDropEvent=Iw,z.interaction.DragBox=o1,z.interaction.DragBox.DragBoxEvent=Qd,z.interaction.DragPan=e1,z.interaction.DragRotate=r1,z.interaction.DragRotateAndZoom=II,z.interaction.DragZoom=s1,z.interaction.Draw=OI,z.interaction.Draw.DrawEvent=_d,z.interaction.Draw.createBox=function(){return function(s,i,t){var e=mr([s[0],s[s.length-1]].map(function(y){return $i(y,t)})),o=[[To(e),Yo(e),Qn(e),Zr(e),To(e)]],l=i;l?l.setCoordinates(o):l=new Lo(o);var f=wo();return f&&l.transform(t,f),l}},z.interaction.Draw.createRegularPolygon=function(s,i){return function(t,e,o){var l=$i(t[0],o),f=$i(t[t.length-1],o),y=Math.sqrt(mi(l,f)),w=e||us(new t0(l),s),b=i;if(!i&&i!==0){var I=f[0]-l[0],N=f[1]-l[1];b=Math.atan2(N,I)}uc(w,l,y,b);var D=wo();return D&&w.transform(o,D),w}},z.interaction.Extent=kI,z.interaction.Extent.ExtentEvent=Nw,z.interaction.Interaction=xc,z.interaction.Interaction.pan=$0,z.interaction.Interaction.zoomByDelta=Zd,z.interaction.KeyboardPan=u1,z.interaction.KeyboardZoom=h1,z.interaction.Link=DI,z.interaction.Modify=BI,z.interaction.Modify.ModifyEvent=rm,z.interaction.MouseWheelZoom=f1,z.interaction.PinchRotate=d1,z.interaction.PinchZoom=g1,z.interaction.Pointer=ja,z.interaction.Pointer.centroid=$d,z.interaction.Select=VI,z.interaction.Select.SelectEvent=Vw,z.interaction.Snap=qI,z.interaction.Translate=YI,z.interaction.Translate.TranslateEvent=nm,z.interaction.defaults=m1,z.layer={},z.layer.Base=Hs,z.layer.BaseImage=ix,z.layer.BaseTile=$y,z.layer.BaseVector=kp,z.layer.Graticule=c2,z.layer.Group=Gl,z.layer.Group.GroupEvent=Ws,z.layer.Heatmap=p2,z.layer.Image=nx,z.layer.Layer=pa,z.layer.Layer.inView=cl,z.layer.MapboxVector=vI,z.layer.Tile=ox,z.layer.Vector=wu,z.layer.VectorImage=xI,z.layer.VectorTile=ld,z.layer.WebGLPoints=bI,z.layer.WebGLTile=EI,z.loadingstrategy={},z.loadingstrategy.all=C1,z.loadingstrategy.bbox=function(s,i){return[s]},z.loadingstrategy.tile=function(s){return function(i,t,e){var o=s.getZForResolution(Zh(t,e)),l=s.getTileRangeForExtentAndZ(Mo(i,e),o),f=[],y=[o,0,0];for(y[1]=l.minX;y[1]<=l.maxX;++y[1])for(y[2]=l.minY;y[2]<=l.maxY;++y[2])f.push(na(s.getTileCoordExtent(y),e));return f}},z.math={},z.math.ceil=dn,z.math.clamp=Y,z.math.cosh=ht,z.math.floor=gi,z.math.lerp=We,z.math.log2=st,z.math.modulo=be,z.math.round=si,z.math.solveLinearSystem=jt,z.math.squaredDistance=Tt,z.math.squaredSegmentDistance=xt,z.math.toDegrees=Et,z.math.toFixed=Ze,z.math.toRadians=qt,z.net={},z.net.ClientError=M1,z.net.ResponseError=I1,z.net.getJSON=Qm,z.net.jsonp=Nf,z.net.overrideXHR=function(s){typeof XMLHttpRequest<"u"&&(P1=XMLHttpRequest),global.XMLHttpRequest=s},z.net.resolveUrl=ty,z.net.restoreXHR=function(){global.XMLHttpRequest=P1},z.obj={},z.obj.assign=Vt,z.obj.clear=Lt,z.obj.getValues=Ne,z.obj.isEmpty=ge,z.proj={},z.proj.Projection=q,z.proj.Units={},z.proj.Units.METERS_PER_UNIT=Di,z.proj.Units.fromCode=Ln,z.proj.addCommon=lf,z.proj.addCoordinateTransforms=Zi,z.proj.addEquivalentProjections=Ti,z.proj.addEquivalentTransforms=Si,z.proj.addProjection=er,z.proj.addProjections=wr,z.proj.clearAllProjections=function(){Wi(),qr()},z.proj.clearUserProjection=function(){$n=null},z.proj.cloneTransform=_r,z.proj.createProjection=Yi,z.proj.createSafeCoordinateTransform=po,z.proj.createTransformFromCoordinateTransform=sn,z.proj.disableCoordinateWarning=me,z.proj.epsg3857={},z.proj.epsg3857.EXTENT=rr,z.proj.epsg3857.HALF_SIZE=Xi,z.proj.epsg3857.MAX_SAFE_Y=Gn,z.proj.epsg3857.PROJECTIONS=ri,z.proj.epsg3857.RADIUS=pr,z.proj.epsg3857.WORLD_EXTENT=Rr,z.proj.epsg3857.fromEPSG4326=Fo,z.proj.epsg3857.toEPSG4326=Zn,z.proj.epsg4326={},z.proj.epsg4326.EXTENT=gn,z.proj.epsg4326.METERS_PER_UNIT=bi,z.proj.epsg4326.PROJECTIONS=Bi,z.proj.epsg4326.RADIUS=hi,z.proj.equivalent=an,z.proj.fromLonLat=jr,z.proj.fromUserCoordinate=$i,z.proj.fromUserExtent=Mo,z.proj.fromUserResolution=Zh,z.proj.get=ie,z.proj.getPointResolution=ti,z.proj.getTransform=zn,z.proj.getTransformFromProjections=ji,z.proj.getUserProjection=wo,z.proj.identityTransform=Ke,z.proj.proj4={},z.proj.proj4.register=function(s){var i,t,e=Object.keys(s.defs),o=e.length;for(i=0;i<o;++i){var l=e[i];if(!ie(l)){var f=s.defs(l),y=f.units;y||f.projName!=="longlat"||(y=Mi.DEGREES),er(new q({code:l,axisOrientation:f.axis,metersPerUnit:f.to_meter,units:y}))}}for(i=0;i<o;++i){var w=e[i],b=ie(w);for(t=0;t<o;++t){var I=e[t],N=ie(I);if(!Ie(w,I))if(s.defs[w]===s.defs[I])Ti([b,N]);else{var D=s(w,I);Zi(b,N,po(b,N,D.forward),po(N,b,D.inverse))}}}},z.proj.projections={},z.proj.projections.add=ii,z.proj.projections.clear=Wi,z.proj.projections.get=ze,z.proj.setUserProjection=rs,z.proj.toLonLat=function(s,i){var t=xo(s,i!==void 0?i:"EPSG:3857","EPSG:4326"),e=t[0];return(e<-180||e>180)&&(t[0]=be(e+180,360)-180),t},z.proj.toUserCoordinate=Io,z.proj.toUserExtent=na,z.proj.toUserResolution=Yh,z.proj.transform=xo,z.proj.transformExtent=Vi,z.proj.transformWithProjections=function(s,i,t){return ji(i,t)(s)},z.proj.transforms={},z.proj.transforms.add=vn,z.proj.transforms.clear=qr,z.proj.transforms.get=Ie,z.proj.transforms.remove=function(s,i){var t=s.getCode(),e=i.getCode(),o=zr[t][e];return delete zr[t][e],ge(zr[t])&&delete zr[t],o},z.proj.useGeographic=function(){rs("EPSG:4326")},z.render={},z.render.Box=i1,z.render.Event=hl,z.render.Feature=Og,z.render.Feature.toFeature=function(s,i){var t=s.getId(),e=Mx(s),o=s.getProperties(),l=new Mr;return i!==void 0&&l.setGeometryName(i),l.setGeometry(e),t!==void 0&&l.setId(t),l.setProperties(o,!0),l},z.render.Feature.toGeometry=Mx,z.render.VectorContext=ey,z.render.canvas={},z.render.canvas.Builder=Fp,z.render.canvas.BuilderGroup=id,z.render.canvas.Executor=bx,z.render.canvas.ExecutorGroup=nd,z.render.canvas.ExecutorGroup.getPixelIndexArray=Sx,z.render.canvas.ImageBuilder=gx,z.render.canvas.Immediate=og,z.render.canvas.Instruction={},z.render.canvas.Instruction.beginPathInstruction=vu,z.render.canvas.Instruction.closePathInstruction=ev,z.render.canvas.Instruction.fillInstruction=ed,z.render.canvas.Instruction.strokeInstruction=Ec,z.render.canvas.LineStringBuilder=mx,z.render.canvas.PolygonBuilder=rv,z.render.canvas.TextBuilder=vx,z.render.canvas.checkedFonts=da,z.render.canvas.defaultFillStyle=Xs,z.render.canvas.defaultFont=ou,z.render.canvas.defaultLineCap=ka,z.render.canvas.defaultLineDash=pl,z.render.canvas.defaultLineDashOffset=0,z.render.canvas.defaultLineJoin=Fa,z.render.canvas.defaultLineWidth=1,z.render.canvas.defaultMiterLimit=Da,z.render.canvas.defaultPadding=Fl,z.render.canvas.defaultStrokeStyle=Ps,z.render.canvas.defaultTextAlign=Ga,z.render.canvas.defaultTextBaseline=kl,z.render.canvas.drawImageOrLabel=lh,z.render.canvas.getTextDimensions=ah,z.render.canvas.hitdetect={},z.render.canvas.hitdetect.HIT_DETECT_RESOLUTION=$s,z.render.canvas.hitdetect.createHitDetectionImageData=ov,z.render.canvas.hitdetect.hitDetect=sv,z.render.canvas.labelCache=sh,z.render.canvas.measureAndCacheTextWidth=_c,z.render.canvas.measureTextHeight=Ji,z.render.canvas.measureTextWidth=Rn,z.render.canvas.registerFont=fo,z.render.canvas.rotateAtOffset=function(s,i,t,e){i!==0&&(s.translate(t,e),s.rotate(i),s.translate(-t,-e))},z.render.canvas.textHeights=au,z.render.getRenderPixel=function(s,i){return Ei(s.inversePixelTransform,i.slice(0))},z.render.getVectorContext=N1,z.render.toContext=function(s,i){var t=s.canvas,e=i||{},o=e.pixelRatio||tn,l=e.size;l&&(t.width=l[0]*o,t.height=l[1]*o,t.style.width=l[0]+"px",t.style.height=l[1]+"px");var f=[0,0,t.width,t.height],y=Mn([1,0,0,1,0,0],o,o);return new og(s,o,f,y,0)},z.renderer={},z.renderer.Composite=ap,z.renderer.Layer=gy,z.renderer.Map=iu,z.renderer.canvas={},z.renderer.canvas.ImageLayer=Zy,z.renderer.canvas.Layer=Pg,z.renderer.canvas.Layer.canvasPool=Wy,z.renderer.canvas.TileLayer=Ky,z.renderer.canvas.VectorImageLayer=Ex,z.renderer.canvas.VectorLayer=av,z.renderer.canvas.VectorTileLayer=Tx,z.renderer.canvas.common={},z.renderer.canvas.common.IMAGE_SMOOTHING_DISABLED=_p,z.renderer.canvas.common.IMAGE_SMOOTHING_ENABLED=iy,z.renderer.vector={},z.renderer.vector.defaultOrder=A1,z.renderer.vector.getSquaredTolerance=sg,z.renderer.vector.getTolerance=ag,z.renderer.vector.renderFeature=Rf,z.renderer.webgl={},z.renderer.webgl.Layer=vy,z.renderer.webgl.Layer.colorDecodeId=n_,z.renderer.webgl.Layer.colorEncodeId=i_,z.renderer.webgl.Layer.getBlankImageData=function(){var s=document.createElement("canvas").getContext("2d").createImageData(1,1);return s.data[0]=255,s.data[1]=255,s.data[2]=255,s.data[3]=255,s},z.renderer.webgl.Layer.writePointFeatureToBuffers=function(s,i,t,e,o,l){var f=3+o,y=s[i+0],w=s[i+1],b=rC;b.length=o;for(var I=0;I<b.length;I++)b[I]=s[i+2+I];var N=l?l.vertexPosition:0,D=l?l.indexPosition:0,j=N/f;return vg(t,N,y,w,0),b.length&&t.set(b,N+3),vg(t,N+=f,y,w,1),b.length&&t.set(b,N+3),vg(t,N+=f,y,w,2),b.length&&t.set(b,N+3),vg(t,N+=f,y,w,3),b.length&&t.set(b,N+3),N+=f,e[D++]=j,e[D++]=j+1,e[D++]=j+3,e[D++]=j+1,e[D++]=j+2,e[D++]=j+3,yy.vertexPosition=N,yy.indexPosition=D,yy},z.renderer.webgl.PointsLayer=tv,z.renderer.webgl.TileLayer=s_,z.renderer.webgl.TileLayer.Attributes=Gf,z.renderer.webgl.TileLayer.Uniforms=Ci,z.reproj={},z.reproj.Image=$_,z.reproj.Tile=yg,z.reproj.Triangulation=dy,z.reproj.calculateSourceExtentResolution=k1,z.reproj.calculateSourceResolution=xp,z.reproj.canvasPool=ny,z.reproj.common={},z.reproj.common.ENABLE_RASTER_REPROJECTION=$E,z.reproj.common.ERROR_THRESHOLD=.5,z.reproj.render=sy,z.resolutionconstraint={},z.resolutionconstraint.createMinMaxResolution=C,z.resolutionconstraint.createSnapToPower=_,z.resolutionconstraint.createSnapToResolutions=p,z.rotationconstraint={},z.rotationconstraint.createSnapToN=J,z.rotationconstraint.createSnapToZero=Ct,z.rotationconstraint.disable=k,z.rotationconstraint.none=X,z.size={},z.size.buffer=ma,z.size.hasArea=fp,z.size.scale=gh,z.size.toSize=Pn,z.source={},z.source.BingMaps=EC,z.source.BingMaps.quadKey=A_,z.source.CartoDB=PC,z.source.Cluster=OC,z.source.DataTile=k_,z.source.GeoTIFF=AT,z.source.IIIF=GT,z.source.Image=yu,z.source.Image.ImageSourceEvent=J_,z.source.Image.defaultImageLoadFunction=Qf,z.source.ImageArcGISRest=qT,z.source.ImageCanvas=XT,z.source.ImageMapGuide=YT,z.source.ImageStatic=$T,z.source.ImageWMS=JT,z.source.OGCMapTile=rP,z.source.OGCVectorTile=oP,z.source.OSM=aP,z.source.OSM.ATTRIBUTION=Xy,z.source.Raster=bP,z.source.Raster.Processor=cx,z.source.Raster.RasterSourceEvent=Qy,z.source.Raster.newImageData=ax,z.source.Source=Mp,z.source.Stamen=PP,z.source.Tile=Wf,z.source.Tile.TileSourceEvent=My,z.source.TileArcGISRest=MP,z.source.TileDebug=AP,z.source.TileImage=Yl,z.source.TileJSON=hx,z.source.TileWMS=RP,z.source.UTFGrid=kP,z.source.UTFGrid.CustomTile=fx,z.source.UrlTile=Ly,z.source.Vector=du,z.source.Vector.VectorSourceEvent=bc,z.source.VectorTile=Tg,z.source.VectorTile.defaultLoadFunction=Hy,z.source.WMTS=DP,z.source.WMTS.optionsFromCapabilities=function(s,i){var t=ft(s.Contents.Layer,function(de,Nr,Pr){return de.Identifier==i.layer});if(t===null)return null;var e,o=s.Contents.TileMatrixSet;(e=t.TileMatrixSetLink.length>1?_t(t.TileMatrixSetLink,"projection"in i?function(de,Nr,Pr){var he=ft(o,function(fi){return fi.Identifier==de.TileMatrixSet}).SupportedCRS,$e=ie(he),or=ie(i.projection);return $e&&or?an($e,or):he==i.projection}:function(de,Nr,Pr){return de.TileMatrixSet==i.matrixSet}):0)<0&&(e=0);var l=t.TileMatrixSetLink[e].TileMatrixSet,f=t.TileMatrixSetLink[e].TileMatrixSetLimits,y=t.Format[0];"format"in i&&(y=i.format),(e=_t(t.Style,function(de,Nr,Pr){return"style"in i?de.Title==i.style:de.isDefault}))<0&&(e=0);var w=t.Style[e].Identifier,b={};"Dimension"in t&&t.Dimension.forEach(function(de,Nr,Pr){var he=de.Identifier,$e=de.Default;$e===void 0&&($e=de.Value[0]),b[he]=$e});var I,N=ft(s.Contents.TileMatrixSet,function(de,Nr,Pr){return de.Identifier==l}),D=N.SupportedCRS;if(D&&(I=ie(D)),"projection"in i){var j=ie(i.projection);j&&(I&&!an(j,I)||(I=j))}var H=!1,Z=I.getAxisOrientation().substr(0,2)=="ne",it=N.TileMatrix[0],at={MinTileCol:0,MinTileRow:0,MaxTileCol:it.MatrixWidth-1,MaxTileRow:it.MatrixHeight-1};if(f){at=f[f.length-1];var wt=ft(N.TileMatrix,function(de){return de.Identifier===at.TileMatrix||N.Identifier+":"+de.Identifier===at.TileMatrix});wt&&(it=wt)}var gt=28e-5*it.ScaleDenominator/I.getMetersPerUnit(),yt=Z?[it.TopLeftCorner[1],it.TopLeftCorner[0]]:it.TopLeftCorner,It=it.TileWidth*gt,Rt=it.TileHeight*gt,kt=N.BoundingBox;kt&&Z&&(kt=[kt[1],kt[0],kt[3],kt[2]]);var Dt=[yt[0]+It*at.MinTileCol,yt[1]-Rt*(1+at.MaxTileRow),yt[0]+It*(1+at.MaxTileCol),yt[1]-Rt*at.MinTileRow];if(kt!==void 0&&!pn(kt,Dt)){var Xt=t.WGS84BoundingBox,ee=ie("EPSG:4326").getExtent();if(Dt=kt,Xt)H=Xt[0]===ee[0]&&Xt[2]===ee[2];else{var pe=Vi(kt,N.SupportedCRS,"EPSG:4326");H=pe[0]-1e-10<=ee[0]&&pe[2]+1e-10>=ee[2]}}var xe=__(N,Dt,f),fe=[],Re=i.requestEncoding;if(Re=Re!==void 0?Re:"","OperationsMetadata"in s&&"GetTile"in s.OperationsMetadata)for(var qe=s.OperationsMetadata.GetTile.DCP.HTTP.Get,Ge=0,Qe=qe.length;Ge<Qe;++Ge)if(qe[Ge].Constraint){var ir=ft(qe[Ge].Constraint,function(de){return de.name=="GetEncoding"}).AllowedValues.Value;if(Re===""&&(Re=ir[0]),Re!=="KVP")break;pt(ir,"KVP")&&fe.push(qe[Ge].href)}else qe[Ge].href&&(Re="KVP",fe.push(qe[Ge].href));return fe.length===0&&(Re="REST",t.ResourceURL.forEach(function(de){de.resourceType==="tile"&&(y=de.format,fe.push(de.template))})),{urls:fe,layer:i.layer,matrixSet:l,format:y,projection:I,requestEncoding:Re,tileGrid:xe,style:w,dimensions:b,wrapX:H,crossOrigin:i.crossOrigin}},z.source.XYZ=Yf,z.source.Zoomify=NT,z.source.Zoomify.CustomTile=Uy,z.source.common={},z.source.common.DEFAULT_WMS_VERSION="1.3.0",z.source.ogcTileUtil={},z.source.ogcTileUtil.getMapTileUrlTemplate=tx,z.source.ogcTileUtil.getTileSetInfo=qy,z.source.ogcTileUtil.getVectorTileUrlTemplate=ex,z.source.sourcesFromTileGrid=function(s,i){var t=new eg(32),e=s.getExtent();return function(o,l){t.expireCache(),e&&(o=fn(e,o));var f=s.getZForResolution(l),y=[];return s.forEachTileCoord(o,f,function(w){var b=w.toString();if(!t.containsKey(b)){var I=i(w);t.set(b,I)}y.push(t.get(b))}),y}},z.source.wms={},z.source.wms.DEFAULT_VERSION=Sc,z.sphere={},z.sphere.DEFAULT_RADIUS=Pt,z.sphere.getArea=function s(i,t){var e=t||{},o=e.radius||Pt,l=e.projection||"EPSG:3857",f=i.getType();f!=="GeometryCollection"&&(i=i.clone().transform(l,"EPSG:4326"));var y,w,b,I,N,D,j=0;switch(f){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(y=i.getCoordinates(),j=Math.abs(_e(y[0],o)),b=1,I=y.length;b<I;++b)j-=Math.abs(_e(y[b],o));break;case"MultiPolygon":for(b=0,I=(y=i.getCoordinates()).length;b<I;++b)for(w=y[b],j+=Math.abs(_e(w[0],o)),N=1,D=w.length;N<D;++N)j-=Math.abs(_e(w[N],o));break;case"GeometryCollection":var H=i.getGeometries();for(b=0,I=H.length;b<I;++b)j+=s(H[b],t);break;default:throw new Error("Unsupported geometry type: "+f)}return j},z.sphere.getDistance=Nt,z.sphere.getLength=function s(i,t){var e=t||{},o=e.radius||Pt,l=e.projection||"EPSG:3857",f=i.getType();f!=="GeometryCollection"&&(i=i.clone().transform(l,"EPSG:4326"));var y,w,b,I,N,D,j=0;switch(f){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":j=Ht(y=i.getCoordinates(),o);break;case"MultiLineString":case"Polygon":for(b=0,I=(y=i.getCoordinates()).length;b<I;++b)j+=Ht(y[b],o);break;case"MultiPolygon":for(b=0,I=(y=i.getCoordinates()).length;b<I;++b)for(N=0,D=(w=y[b]).length;N<D;++N)j+=Ht(w[N],o);break;case"GeometryCollection":var H=i.getGeometries();for(b=0,I=H.length;b<I;++b)j+=s(H[b],t);break;default:throw new Error("Unsupported geometry type: "+f)}return j},z.sphere.offset=we,z.string={},z.string.compareVersions=Bn,z.string.padNumber=lo,z.structs={},z.structs.LRUCache=eg,z.structs.LinkedList=yC,z.structs.PriorityQueue=dh,z.structs.PriorityQueue.DROP=Vl,z.structs.RBush=Xf,z.style={},z.style.Circle=wg,z.style.Fill=Zs,z.style.Icon=Hf,z.style.IconImage=fC,z.style.IconImage.get=b_,z.style.IconImageCache=Gm,z.style.IconImageCache.shared=Al,z.style.Image=Cy,z.style.RegularShape=x_,z.style.Stroke=Fs,z.style.Style=ds,z.style.Style.createDefaultStyle=E_,z.style.Style.createEditingStyle=Pp,z.style.Style.toFunction=S_,z.style.Text=Ip,z.style.expressions={},z.style.expressions.Operators=Li,z.style.expressions.PALETTE_TEXTURE_ARRAY=Ey,z.style.expressions.arrayToGlsl=wy,z.style.expressions.colorToGlsl=l_,z.style.expressions.expressionToGlsl=Tr,z.style.expressions.getStringNumberEquivalent=zf,z.style.expressions.getValueType=vl,z.style.expressions.isTypeUnique=a_,z.style.expressions.numberToGlsl=Bf,z.style.expressions.stringToGlsl=c_,z.style.expressions.uniformNameForVariable=xg,z.tilecoord={},z.tilecoord.createOrUpdate=yp,z.tilecoord.fromKey=$m,z.tilecoord.getCacheKeyForTileKey=v1,z.tilecoord.getKey=vp,z.tilecoord.getKeyZXY=Ul,z.tilecoord.hash=rg,z.tilecoord.withinExtentAndZ=_1,z.tilegrid={},z.tilegrid.TileGrid=ql,z.tilegrid.WMTS=cC,z.tilegrid.WMTS.createFromCapabilitiesMatrixSet=__,z.tilegrid.common={},z.tilegrid.common.DEFAULT_MAX_ZOOM=42,z.tilegrid.common.DEFAULT_TILE_SIZE=Ys,z.tilegrid.createForExtent=D1,z.tilegrid.createForProjection=j1,z.tilegrid.createXYZ=vh,z.tilegrid.extentFromProjection=wc,z.tilegrid.getForProjection=ay,z.tilegrid.wrapX=F1,z.tileurlfunction={},z.tileurlfunction.createFromTemplate=B1,z.tileurlfunction.createFromTemplates=lg,z.tileurlfunction.createFromTileUrlFunctions=wp,z.tileurlfunction.expandUrl=cg,z.tileurlfunction.nullTileUrlFunction=z1,z.transform={},z.transform.apply=Ei,z.transform.compose=At,z.transform.composeCssTransform=function(s,i,t,e,o,l,f){return re(At([1,0,0,1,0,0],s,i,t,e,o,l,f))},z.transform.create=Vs,z.transform.determinant=le,z.transform.invert=function(s){return Qt(s,s)},z.transform.makeInverse=Qt,z.transform.makeScale=bt,z.transform.multiply=qi,z.transform.reset=In,z.transform.rotate=hn,z.transform.scale=Mn,z.transform.set=vo,z.transform.setFromArray=xi,z.transform.toString=re,z.transform.translate=Gt,z.uri={},z.uri.appendParams=Hl,z.util={},z.util.VERSION=U,z.util.abstract=E,z.util.getUid=L,z.vec={},z.vec.mat4={},z.vec.mat4.create=VE,z.vec.mat4.fromTransform=Df,z.webgl={},z.webgl.ARRAY_BUFFER=bp,z.webgl.Buffer=Sp,z.webgl.Buffer.getArrayClassForType=gg,z.webgl.DYNAMIC_DRAW=hg,z.webgl.ELEMENT_ARRAY_BUFFER=kf,z.webgl.FLOAT=cy,z.webgl.Helper=K1,z.webgl.Helper.computeAttributesStride=Z1,z.webgl.PaletteTexture=J1,z.webgl.PostProcessingPass=fy,z.webgl.RenderTarget=Q1,z.webgl.STATIC_DRAW=ug,z.webgl.STREAM_DRAW=35040,z.webgl.ShaderBuilder={},z.webgl.ShaderBuilder.ShaderBuilder=m_,z.webgl.ShaderBuilder.parseLiteralStyle=y_,z.webgl.TileTexture=r_,z.webgl.UNSIGNED_BYTE=5121,z.webgl.UNSIGNED_INT=5125,z.webgl.UNSIGNED_SHORT=5123,z.webgl.getContext=pg,z.webgl.getSupportedExtensions=function(){if(!ly){var s=pg(document.createElement("canvas"));s&&(ly=s.getSupportedExtensions())}return ly},z.xml={},z.xml.OBJECT_PROPERTY_NODE_FACTORY=Bo,z.xml.XML_SCHEMA_INSTANCE_URI=cu,z.xml.createElementNS=ai,z.xml.getAllTextContent=fs,z.xml.Vw=uy,z.xml.getAttributeNS=U1,z.xml.getDocument=_h,z.xml.getXMLSerializer=q1,z.xml.isDocument=ml,z.xml.makeArrayExtender=Ff,z.xml.makeArrayPusher=kr,z.xml.makeArraySerializer=hy,z.xml.makeChildAppender=Jt,z.xml.makeObjectPropertyPusher=Un,z.xml.makeObjectPropertySetter=Zt,z.xml.makeReplacer=$r,z.xml.makeSequence=Rs,z.xml.makeSimpleNodeFactory=oo,z.xml.makeStructureNS=Le,z.xml.parse=yl,z.xml.parseNode=ks,z.xml.pushParseAndPop=He,z.xml.pushSerializeAndPop=li,z.xml.registerDocument=function(s){dg=s},z.xml.registerXMLSerializer=function(s){fg=s},z.xml.serialize=py;var pN=z},150:function(m,g,x){"use strict";x.d(g,{Ie:function(){return A},It:function(){return L},L:function(){return E},L5:function(){return B},P1:function(){return K},Qb:function(){return O},pd:function(){return G},sf:function(){return U}});const E={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},P={};for(const et in E)E.hasOwnProperty(et)&&(P[E[et]]=parseInt(et,10));const L=[P.BitsPerSample,P.ExtraSamples,P.SampleFormat,P.StripByteCounts,P.StripOffsets,P.StripRowCounts,P.TileByteCounts,P.TileOffsets,P.SubIFDs],F={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},U={};for(const et in F)F.hasOwnProperty(et)&&(U[F[et]]=parseInt(et,10));const A={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},G={Unspecified:0,Assocalpha:1,Unassalpha:2},B={Version:0,AddCompression:1},O={None:0,Deflate:1},K={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},Q={};for(const et in K)K.hasOwnProperty(et)&&(Q[K[et]]=parseInt(et,10))}},h={};function u(m){var g=h[m];if(g!==void 0)return g.exports;var x=h[m]={exports:{}};return c[m].call(x.exports,x,x.exports,u),x.exports}u.m=c,u.d=function(m,g){for(var x in g)u.o(g,x)&&!u.o(m,x)&&Object.defineProperty(m,x,{enumerable:!0,get:g[x]})},u.f={},u.e=function(m){return Promise.all(Object.keys(u.f).reduce(function(g,x){return u.f[x](m,g),g},[]))},u.u=function(m){return m+".ol.js"},u.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),u.o=function(m,g){return Object.prototype.hasOwnProperty.call(m,g)},n={},u.l=function(m,g,x,E){if(n[m])n[m].push(g);else{var P,L;if(x!==void 0)for(var F=document.getElementsByTagName("script"),U=0;U<F.length;U++){var A=F[U];if(A.getAttribute("src")==m||A.getAttribute("data-webpack")=="ol:"+x){P=A;break}}P||(L=!0,(P=document.createElement("script")).charset="utf-8",P.timeout=120,u.nc&&P.setAttribute("nonce",u.nc),P.setAttribute("data-webpack","ol:"+x),P.src=m),n[m]=[g];var G=function(O,K){P.onerror=P.onload=null,clearTimeout(B);var Q=n[m];if(delete n[m],P.parentNode&&P.parentNode.removeChild(P),Q&&Q.forEach(function(et){return et(K)}),O)return O(K)},B=setTimeout(G.bind(null,void 0,{type:"timeout",target:P}),12e4);P.onerror=G.bind(null,P.onerror),P.onload=G.bind(null,P.onload),L&&document.head.appendChild(P)}},u.r=function(m){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},function(){var m;u.g.importScripts&&(m=u.g.location+"");var g=u.g.document;if(!m&&g&&(g.currentScript&&(m=g.currentScript.src),!m)){var x=g.getElementsByTagName("script");x.length&&(m=x[x.length-1].src)}if(!m)throw new Error("Automatic publicPath is not supported in this browser");m=m.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=m}(),function(){var m={179:0};u.f.j=function(E,P){var L=u.o(m,E)?m[E]:void 0;if(L!==0)if(L)P.push(L[2]);else{var F=new Promise(function(G,B){L=m[E]=[G,B]});P.push(L[2]=F);var U=u.p+u.u(E),A=new Error;u.l(U,function(G){if(u.o(m,E)&&((L=m[E])!==0&&(m[E]=void 0),L)){var B=G&&(G.type==="load"?"missing":G.type),O=G&&G.target&&G.target.src;A.message="Loading chunk "+E+` failed.
(`+B+": "+O+")",A.name="ChunkLoadError",A.type=B,A.request=O,L[1](A)}},"chunk-"+E,E)}};var g=function(E,P){var L,F,U=P[0],A=P[1],G=P[2],B=0;if(U.some(function(O){return m[O]!==0})){for(L in A)u.o(A,L)&&(u.m[L]=A[L]);G&&G(u)}for(E&&E(P);B<U.length;B++)F=U[B],u.o(m,F)&&m[F]&&m[F][0](),m[F]=0},x=self.webpackChunkol=self.webpackChunkol||[];x.forEach(g.bind(null,0)),x.push=g.bind(null,x.push.bind(x))}(),u(760);var d=u(429);return d=d.default}()});/**
 * ol-ext - A set of cool extensions for OpenLayers (ol) in node modules structure
 * @description ol3,openlayers,popup,menu,symbol,renderer,filter,canvas,interaction,split,statistic,charts,pie,LayerSwitcher,toolbar,animation
 * @version v3.2.28
 * @author Jean-Marc Viglino
 * @see https://github.com/Viglino/ol-ext#,
 * @license BSD-3-Clause
 */window.ol&&!ol.ext&&(ol.ext={}),ol.ext.inherits=function(n,c){n.prototype=Object.create(c.prototype),n.prototype.constructor=n},window.ol&&(ol.inherits||(ol.inherits=ol.ext.inherits)),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.Element&&!Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),ol.ext.Ajax=function(n){n=n||{},ol.Object.call(this),this._auth=n.auth,this.set("dataType",n.dataType||"JSON")},ol.ext.inherits(ol.ext.Ajax,ol.Object),ol.ext.Ajax.get=function(n){var c=new ol.ext.Ajax(n);n.success&&c.on("success",function(h){n.success(h.response,h)}),n.error&&c.on("error",function(h){n.error(h)}),c.send(n.url,n.data,n.options)},ol.ext.Ajax.getCORS=function(n,c){var h=new XMLHttpRequest;h.open("GET",n,!0),h.send(),h.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&c(h.getResponseHeader("Access-Control-Allow-Origin"))}},ol.ext.Ajax.prototype.send=function(n,c,h){h=h||{};var u=this,d=h.encode!==!1;d&&(n=encodeURI(n));var m="";for(var g in c)c.hasOwnProperty(g)&&c[g]!==void 0&&(m+=(m?"&":"?")+g+"="+(d?encodeURIComponent(c[g]):c[g]));this._request&&h.abort!==!1&&this._request.abort();var x=this._request=new XMLHttpRequest;x.open("GET",n+m,!0),h.timeout&&(x.timeout=h.timeout),this._auth&&x.setRequestHeader("Authorization","Basic "+this._auth),this.dispatchEvent({type:"loadstart"}),x.onload=function(){if(u._request=null,u.dispatchEvent({type:"loadend"}),this.status>=200&&this.status<400){var E;try{switch(u.get("dataType")){case"JSON":{E=JSON.parse(this.response);break}default:E=this.response}}catch(P){u.dispatchEvent({type:"error",status:0,statusText:"parsererror",error:P,options:h,jqXHR:this});return}u.dispatchEvent({type:"success",response:E,status:this.status,statusText:this.statusText,options:h,jqXHR:this})}else u.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:h,jqXHR:this})},x.ontimeout=function(){u._request=null,u.dispatchEvent({type:"loadend"}),u.dispatchEvent({type:"error",status:this.status,statusText:"Timeout",options:h,jqXHR:this})},x.onerror=function(){u._request=null,u.dispatchEvent({type:"loadend"}),u.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:h,jqXHR:this})},x.send()},ol.ext.SVGFilter=function(n){n=n||{},ol.Object.call(this),ol.ext.SVGFilter.prototype.svg||(ol.ext.SVGFilter.prototype.svg=document.createElementNS(this.NS,"svg"),ol.ext.SVGFilter.prototype.svg.setAttribute("version","1.1"),ol.ext.SVGFilter.prototype.svg.setAttribute("width",0),ol.ext.SVGFilter.prototype.svg.setAttribute("height",0),ol.ext.SVGFilter.prototype.svg.style.position="absolute",document.body.appendChild(ol.ext.SVGFilter.prototype.svg)),this.element=document.createElementNS(this.NS,"filter"),this._id=n.id||"_ol_SVGFilter_"+ol.ext.SVGFilter.prototype._id++,this.element.setAttribute("id",this._id),n.color&&this.element.setAttribute("color-interpolation-filters",n.color),n.operation&&this.addOperation(n.operation),ol.ext.SVGFilter.prototype.svg.appendChild(this.element)},ol.ext.inherits(ol.ext.SVGFilter,ol.Object),ol.ext.SVGFilter.prototype.NS="http://www.w3.org/2000/svg",ol.ext.SVGFilter.prototype.svg=null,ol.ext.SVGFilter.prototype._id=0,ol.ext.SVGFilter.prototype.getId=function(){return this._id},ol.ext.SVGFilter.prototype.remove=function(){this.element.remove()},ol.ext.SVGFilter.prototype.addOperation=function(n){n instanceof Array?n.forEach(function(c){this.addOperation(c)}.bind(this)):(n instanceof ol.ext.SVGOperation||(n=new ol.ext.SVGOperation(n)),this.element.appendChild(n.geElement()))},ol.ext.SVGFilter.prototype.grayscale=function(n){this.addOperation({feoperation:"feColorMatrix",type:"saturate",values:n||0})},ol.ext.SVGFilter.prototype.luminanceToAlpha=function(n){n=n||{},this.addOperation({feoperation:"feColorMatrix",type:"luminanceToAlpha"}),n.gamma&&this.addOperation({feoperation:"feComponentTransfer",operations:[{feoperation:"feFuncA",type:"gamma",amplitude:n.gamma,exponent:1,offset:0}]})},ol.ext.SVGFilter.prototype.applyTo=function(n){var c=document.createElement("CANVAS");return c.width=n.naturalWidth||n.width,c.height=n.naturalHeight||n.height,c.getContext("2d").filter="url(#"+this.getId()+")",c.getContext("2d").drawImage(n,0,0),c},ol.ext.SVGOperation=function(n){if(typeof n=="string"&&(n={feoperation:n}),!n||!n.feoperation){console.error("[SVGOperation]: no operation defined.");return}ol.Object.call(this),this._name=n.feoperation,this.element=document.createElementNS(this.NS,this._name),this.setProperties(n),n.operations instanceof Array&&this.appendChild(n.operations)},ol.ext.inherits(ol.ext.SVGOperation,ol.Object),ol.ext.SVGOperation.prototype.NS="http://www.w3.org/2000/svg",ol.ext.SVGOperation.prototype.getName=function(){return this._name},ol.ext.SVGOperation.prototype.set=function(n,c){/^feoperation$|^operations$/.test(n)||(ol.Object.prototype.set.call(this,n,c),this.element.setAttribute(n,c))},ol.ext.SVGOperation.prototype.setProperties=function(n){n=n||{};for(var c in n)this.set(c,n[c])},ol.ext.SVGOperation.prototype.geElement=function(){return this.element},ol.ext.SVGOperation.prototype.appendChild=function(n){n instanceof Array?n.forEach(function(c){this.appendChild(c)}.bind(this)):(n instanceof ol.ext.SVGOperation||(n=new ol.ext.SVGOperation(n)),this.element.appendChild(n.geElement()))},ol.View.prototype.flyTo&&console.warn("[OL-EXT] ol/View~View.flyTo redefinition"),ol.View.prototype.flyTo=function(n,c){n=n||{},this.cancelAnimations();var h=typeof c=="function"?c:function(){},u=n.duration||2e3,d=n.zoomAt||Math.min(n.zoom||100,this.getZoom())-2,m=n.zoom||this.getZoom(),g=n.center||this.getCenter();this.animate({center:g,duration:u,easing:n.easing,anchor:n.anchor,rotation:n.rotation}),this.animate({zoom:d,duration:u/2,easing:n.easing,anchor:n.anchor},{zoom:m,duration:u/2,easing:n.easing,anchor:n.anchor},h)},ol.View.prototype.takeTour=function(n,c){c=c||{};var h=-1,u=function(d){if(d){var m=n[++h];if(typeof c.step=="function"&&c.step(h,n),m){m instanceof Array&&(m={center:[m[0],m[1]],zoom:m[2],type:m[3]});var g=h===0?0:c.delay||750;m.easing||(m.easing=c.easing),m.type||(m.type=c.type),setTimeout(function(){switch(m.type){case"moveTo":{this.animate(m,u);break}case"flightTo":default:{this.flyTo(m,u);break}}}.bind(this),g)}else typeof c.done=="function"&&c.done(!0)}else typeof c.done=="function"&&c.done(!1)}.bind(this);u(!0)},ol.color.toHSL=function(n,c){c===void 0&&(c=100),Array.isArray(n)||(n=ol.color.asArray(n));var h=n[0]/255,u=n[1]/255,d=n[2]/255,m=Math.max(h,u,d),g=Math.min(h,u,d),x,E,P=(m+g)/2;if(m===g)x=E=0;else{var L=m-g;switch(E=P>.5?L/(2-m-g):L/(m+g),m){case h:x=(u-d)/L+(u<d?6:0);break;case u:x=(d-h)/L+2;break;case d:x=(h-u)/L+4;break}}var F=[Math.round(x*60*c)/c,Math.round(E*100*c)/c,Math.round(P*100*c)/c];return n.length>3&&(F[3]=n[3]),F},ol.color.fromHSL=function(n,c){c===void 0&&(c=1e3);var h=n[0]/360,u=n[1]/100,d=n[2]/100,m,g,x;if(u==0)m=g=x=d;else{var E=function(U,A,G){return G<0&&(G+=1),G>1&&(G-=1),G<.16666666666666666?U+(A-U)*6*G:G<.5?A:G<.6666666666666666?U+(A-U)*(.6666666666666666-G)*6:U},P=d<.5?d*(1+u):d+u-d*u,L=2*d-P;m=E(L,P,h+1/3),g=E(L,P,h),x=E(L,P,h-1/3)}var F=[Math.round(m*255*c)/c,Math.round(g*255*c)/c,Math.round(x*255*c)/c];return n.length>3&&(F[3]=n[3]),F},ol.color.toHSV=function(n,c){c===void 0&&(c=100),Array.isArray(n)||(n=ol.color.asArray(n));var h=n[0]/255,u=n[1]/255,d=n[2]/255,m=Math.max(h,u,d),g=Math.min(h,u,d),x,E,P=m,L=m-g;if(E=m==0?0:L/m,m==g)x=0;else switch(m){case h:x=(u-d)/L+(u<d?6:0);break;case u:x=(d-h)/L+2;break;case d:x=(h-u)/L+4;break}var F=[Math.round(x*60*c)/c,Math.round(E*100*c)/c,Math.round(P*100*c)/c];return n.length>3&&(F[3]=n[3]),F},ol.color.fromHSV=function(n,c){c===void 0&&(c=1e3);var h=n[0]/360,u=n[1]/100,d=n[2]/100,m,g,x,E=Math.floor(h*6),P=h*6-E,L=d*(1-u),F=d*(1-P*u),U=d*(1-(1-P)*u);switch(E%6){case 0:m=d,g=U,x=L;break;case 1:m=F,g=d,x=L;break;case 2:m=L,g=d,x=U;break;case 3:m=L,g=F,x=d;break;case 4:m=U,g=L,x=d;break;case 5:m=d,g=L,x=F;break}var A=[Math.round(m*255*c)/c,Math.round(g*255*c)/c,Math.round(x*255*c)/c];return n.length>3&&(A[3]=n[3]),A},ol.color.toHexa=function(n){return"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).slice(1)},ol.ext.element={},ol.ext.element.create=function(n,c){c=c||{};var h;if(n==="TEXT")h=document.createTextNode(c.html||""),c.parent&&c.parent.appendChild(h);else{h=document.createElement(n),/button/i.test(n)&&h.setAttribute("type","button");for(var u in c)switch(u){case"className":{c.className&&c.className.trim&&h.setAttribute("class",c.className.trim());break}case"text":{h.innerText=c.text;break}case"html":{c.html instanceof Element?h.appendChild(c.html):c.html!==void 0&&(h.innerHTML=c.html);break}case"parent":{c.parent&&c.parent.appendChild(h);break}case"options":{if(/select/i.test(n))for(var d in c.options)ol.ext.element.create("OPTION",{html:d,value:c.options[d],parent:h});break}case"style":{ol.ext.element.setStyle(h,c.style);break}case"change":case"click":{ol.ext.element.addListener(h,u,c[u]);break}case"on":{for(var m in c.on)ol.ext.element.addListener(h,m,c.on[m]);break}case"checked":{h.checked=!!c.checked;break}default:{h.setAttribute(u,c[u]);break}}}return h},ol.ext.element.createSwitch=function(n){var c=ol.ext.element.create("INPUT",{type:"checkbox",on:n.on,click:n.click,change:n.change,parent:n.parent}),h=Object.assign({input:c},n||{});return new ol.ext.input.Switch(h),c},ol.ext.element.createCheck=function(n){var c=ol.ext.element.create("INPUT",{name:n.name,type:n.type==="radio"?"radio":"checkbox",on:n.on,parent:n.parent}),h=Object.assign({input:c},n||{});return n.type==="radio"?new ol.ext.input.Radio(h):new ol.ext.input.Checkbox(h),c},ol.ext.element.setHTML=function(n,c){c instanceof Element?n.appendChild(c):c!==void 0&&(n.innerHTML=c)},ol.ext.element.appendText=function(n,c){n.appendChild(document.createTextNode(c||""))},ol.ext.element.addListener=function(n,c,h,u){typeof c=="string"&&(c=c.split(" ")),c.forEach(function(d){n.addEventListener(d,h,u)})},ol.ext.element.removeListener=function(n,c,h){typeof c=="string"&&(c=c.split(" ")),c.forEach(function(u){n.removeEventListener(u,h)})},ol.ext.element.show=function(n){n.style.display=""},ol.ext.element.hide=function(n){n.style.display="none"},ol.ext.element.hidden=function(n){return ol.ext.element.getStyle(n,"display")==="none"},ol.ext.element.toggle=function(n){n.style.display=n.style.display==="none"?"":"none"},ol.ext.element.setStyle=function(n,c){for(var h in c)switch(h){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":{typeof c[h]=="number"?n.style[h]=c[h]+"px":n.style[h]=c[h];break}default:n.style[h]=c[h]}},ol.ext.element.getStyle=function(n,c){var h,u=(n.ownerDocument||document).defaultView;if(u&&u.getComputedStyle)c=c.replace(/([A-Z])/g,"-$1").toLowerCase(),h=u.getComputedStyle(n,null).getPropertyValue(c);else if(n.currentStyle&&(c=c.replace(/-(\w)/g,function(d,m){return m.toUpperCase()}),h=n.currentStyle[c],/^\d+(em|pt|%|ex)?$/i.test(h)))return function(d){var m=n.style.left,g=n.runtimeStyle.left;return n.runtimeStyle.left=n.currentStyle.left,n.style.left=d||0,d=n.style.pixelLeft+"px",n.style.left=m,n.runtimeStyle.left=g,d}(h);return/px$/.test(h)?parseInt(h):h},ol.ext.element.outerHeight=function(n){return n.offsetHeight+ol.ext.element.getStyle(n,"marginBottom")},ol.ext.element.outerWidth=function(n){return n.offsetWidth+ol.ext.element.getStyle(n,"marginLeft")},ol.ext.element.offsetRect=function(n){var c=n.getBoundingClientRect();return{top:c.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:c.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:c.height||c.bottom-c.top,width:c.width||c.right-c.left}},ol.ext.element.getFixedOffset=function(n){var c={left:0,top:0},h=function(u){if(!u)return c;if(ol.ext.element.getStyle(u,"position")==="absolute"&&ol.ext.element.getStyle(u,"transform")!=="none"){var d=u.getBoundingClientRect();return c.left+=d.left,c.top+=d.top,c}return h(u.offsetParent)};return h(n.offsetParent)},ol.ext.element.positionRect=function(n,c){var h=0,u=0,d=function(m){if(m)return h+=m.offsetLeft,u+=m.offsetTop,d(m.offsetParent);var g={top:n.offsetTop+u,left:n.offsetLeft+h};return c&&(g.top-=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,g.left-=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),g.bottom=g.top+n.offsetHeight,g.right=g.top+n.offsetWidth,g};return d(n.offsetParent)},ol.ext.element.scrollDiv=function(n,c){c=c||{};var h=!1,u=0,d,m=0,g=typeof c.onmove=="function"?c.onmove:function(){},x=c.vertical?"screenY":"screenX",E=c.vertical?"scrollTop":"scrollLeft",P=!1,L,F,U=0,A=function(){et&&(U++,setTimeout(G))},G=function(){if(et){if(U--,U)return;var ct=n.clientHeight,ut=n.scrollHeight;L=ct/ut,et.style.height=L*100+"%",et.style.top=n.scrollTop/ut*100+"%",Q.style.height=ct+"px",ct>ut-.5?Q.classList.add("ol-100pc"):Q.classList.remove("ol-100pc")}},B=function(ct){ct.target.classList.contains("ol-noscroll")||(P=!1,h=ct[x],m=new Date,n.classList.add("ol-move"),ct.preventDefault(),window.addEventListener("pointermove",O),ol.ext.element.addListener(window,["pointerup","pointercancel"],pt))},O=function(ct){if(P=!0,h!==!1){var ut=(F?-1/L:1)*(h-ct[x]);n[E]+=ut,d=new Date,d-m&&(u=(u+ut/(d-m))/2),h=ct[x],m=d,ut&&g(!0)}},K=function(ct){var ut=ct>0?Math.min(100,ct/2):Math.max(-100,ct/2);ct-=ut,n[E]+=ut,-1<ct&&ct<1?(P?setTimeout(function(){n.classList.remove("ol-move")}):n.classList.remove("ol-move"),P=!1,g(!1)):setTimeout(function(){K(ct)},40)},Q,et;if(c.vertical&&c.minibar){var lt=function(ct){n.removeEventListener("pointermove",lt),n.parentNode.classList.add("ol-miniscroll"),et=ol.ext.element.create("DIV"),Q=ol.ext.element.create("DIV",{className:"ol-scroll",html:et}),n.parentNode.insertBefore(Q,n),et.addEventListener("pointerdown",function(ut){F=!0,B(ut)}),c.mousewheel&&(ol.ext.element.addListener(Q,["mousewheel","DOMMouseScroll","onmousewheel"],function(ut){T(ut)}),ol.ext.element.addListener(et,["mousewheel","DOMMouseScroll","onmousewheel"],function(ut){T(ut)})),n.parentNode.addEventListener("pointerenter",A),window.addEventListener("resize",A),ct!==!1&&A()};n.parentNode?lt(!1):n.addEventListener("pointermove",lt),n.addEventListener("scroll",function(){A()})}n.style["touch-action"]="none",n.style.overflow="hidden",n.classList.add("ol-scrolldiv"),ol.ext.element.addListener(n,["pointerdown"],function(ct){F=!1,B(ct)}),n.addEventListener("click",function(ct){n.classList.contains("ol-move")&&(ct.preventDefault(),ct.stopPropagation())},!0);var pt=function(ct){m=new Date-m,m>100||F?u=0:m>0&&(u=((u||0)+(h-ct[x])/m)/2),K(c.animate===!1?0:u*200),h=!1,u=0,m=0,n.classList.contains("ol-move")?n.classList.remove("ol-hasClick"):(n.classList.add("ol-hasClick"),setTimeout(function(){n.classList.remove("ol-hasClick")},500)),F=!1,window.removeEventListener("pointermove",O),ol.ext.element.removeListener(window,["pointerup","pointercancel"],pt)},T=function(ct){var ut=Math.max(-1,Math.min(1,ct.wheelDelta||-ct.detail));return n.classList.add("ol-move"),n[E]-=ut*30,n.classList.remove("ol-move"),!1};return c.mousewheel&&ol.ext.element.addListener(n,["mousewheel","DOMMouseScroll","onmousewheel"],T),{refresh:A}},ol.ext.element.dispatchEvent=function(n,c){var h;try{h=new CustomEvent(n)}catch{h=document.createEvent("CustomEvent"),h.initCustomEvent(n,!0,!0,{})}c.dispatchEvent(h)},ol.ext.getMapCanvas=function(n){if(!n)return null;var c=n.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return c||(n.getViewport().querySelector(".ol-layers")?(c=document.createElement("canvas"),c.className="ol-fixedoverlay",n.getViewport().querySelector(".ol-layers").after(c),n.on("precompose",function(h){c.width=n.getSize()[0]*h.frameState.pixelRatio,c.height=n.getSize()[1]*h.frameState.pixelRatio})):c=n.getViewport().querySelector("canvas")),c},window.ol&&(ol.util?ol.util.VERSION||(ol.util.VERSION=ol.VERSION||"6.1.0"):ol.util={VERSION:ol.VERSION||"5.3.0"}),ol.ext.olVersion=ol.util.VERSION.split("."),ol.ext.olVersion=parseInt(ol.ext.olVersion[0])*100+parseInt(ol.ext.olVersion[1]),ol.ext.getVectorContextStyle=function(n,c){var h=n.frameState.pixelRatio;if(ol.ext.olVersion>605&&h!==1&&c.getImage()instanceof ol.style.Icon){c=c.clone();var u=c.getImage();u.setScale(u.getScale()*h);var d=u.getAnchor();if(u.setDisplacement){var m=u.getDisplacement();m&&(m[0]-=d[0]/h,m[1]+=d[1]/h,u.setAnchor([0,0]))}else d&&(d[0]/=h,d[1]/=h)}return c},window.ol&&(window.ol.ext.imageLoader={}),ol.ext.imageLoader.loadBILImage=function(n,c,h){var u=[parseInt(n.replace(/.*WIDTH=(\d*).*/i,"$1")),parseInt(n.replace(/.*HEIGHT=(\d*).*/i,"$1"))],d=new XMLHttpRequest;d.responseType="blob",d.addEventListener("loadend",function(){var m=this.response;if(m!==void 0){var g=new FileReader;g.addEventListener("loadend",x=>{var E=new Float32Array(x.target.result);c(E,u)}),g.readAsArrayBuffer(m)}else h()}),d.addEventListener("error",function(){h()}),d.open("GET",n),d.send()},ol.ext.imageLoader.loadImage=function(n,c,h){var u=new XMLHttpRequest;u.responseType="blob",u.addEventListener("loadend",function(){var d=this.response;if(d!==void 0){var m=new Image;m.onload=function(){c(m,[m.naturalWidth,m.naturalHeight])},m.src=URL.createObjectURL(d)}else h()}),u.addEventListener("error",function(){h()}),u.open("GET",n),u.send()},ol.ext.imageLoader.pixelTransform=function(n){return function(c,h){ol.ext.imageLoader.loadImage(h,function(u,d){var m=document.createElement("canvas");m.width=d[0],m.height=d[1];var g=m.getContext("2d");g.drawImage(u,0,0);for(var x=g.getImageData(0,0,d[0],d[1]),E=x.data,P=0;P<E.length;P+=4)n(E,P,d);g.putImageData(x,0,0),c.setImage(m)},function(){c.setState(3)})}},ol.ext.imageLoader.grayscale=function(){return ol.ext.imageLoader.pixelTransform(function(n,c){n[c]=n[c+1]=n[c+2]=parseInt(3*n[c]+4*n[c+1]+n[c+2]>>>3)})},ol.ext.imageLoader.transparent=function(n){var c,h;n instanceof Array&&(c=n[0],h=n[1]);var u=c=ol.color.asArray(c);return h?(h=ol.color.asArray(h),u=[Math.min(c[0],h[0]),Math.min(c[1],h[1]),Math.min(c[2],h[2])],h=[Math.max(c[0],h[0]),Math.max(c[1],h[1]),Math.max(c[2],h[2])],ol.ext.imageLoader.pixelTransform(function(d,m){d[m]>=c[0]&&d[m]<=h[0]&&d[m+1]>=u[1]&&d[m+1]<=h[1]&&d[m+2]>=u[2]&&d[m+2]<=h[2]&&(d[m+3]=0)})):ol.ext.imageLoader.pixelTransform(function(d,m){d[m]===u[0]&&d[m+1]===u[1]&&d[m+2]===u[2]&&(d[m+3]=0)})},ol.ext.imageLoader.seaLevelMap=function(n,c){c=c||{};var h=Math.max(n+.01,.01),u=c.color?ol.color.asArray(c.color):[135,203,249],d=typeof c.minValue=="number"?c.minValue:-1/0,m=c.opacity!==!1;return ol.ext.imageLoader.elevationMap(function(g){return g<h&&g>d?[u[0],u[1],u[2],m?255*(h-g)/h:255]:[0,0,0,0]})},ol.ext.imageLoader.shadedRelief=function(){var n=Math.PI/4,c=2*Math.PI-Math.PI/4;return function(h,u){ol.ext.imageLoader.loadBILImage(u,function(d,m){var g=document.createElement("canvas"),x=g.getContext("2d"),E=g.width=m[0],P=g.height=m[1],L=x.getImageData(0,0,E,P),F=L.data;function U(nt,vt){return nt+vt*E}for(var A=0;A<E;A++)for(var G=0;G<P;G++){var B=U(A,Math.max(0,G-1)),O=U(Math.max(0,A-1),G),K=U(Math.min(E-1,A+1),G),Q=U(A,Math.min(P,G+1)),et=d[B],lt=d[O],pt=d[K],T=d[Q],ct=(pt-lt)/3,ut=(T-et)/3,ft=Math.sqrt(ct*ct+ut*ut),$=Math.acos(ct/ft);ft==0&&($=0);var _t=0;ct>0?ut>0?_t=$+1.5*Math.PI:ut<0?_t=1.5*Math.PI-$:$=1.5*Math.PI:ct<0?ut<0?_t=$+.5*Math.PI:ut>0?_t=.5*Math.PI-$:_t=.5*Math.PI:ut<0?_t=Math.PI:ut>0&&(_t=0);var W=Math.cos(_t-c)*Math.cos(Math.PI*.5-Math.atan(ft))*Math.cos(n)+Math.sin(Math.PI*.5-Math.atan(ft))*Math.sin(n);W<0&&(W=0),W=Math.sqrt(W*.8+.5);var rt=U(A,G)*4;F[rt]=F[rt+1]=F[rt+2]=0,F[rt+3]=255-W*255}x.putImageData(L,0,0),h.setImage(g)},function(){h.setState(3)})}},ol.ext.imageLoader.elevationMap=function(n){return typeof n!="function"&&(n=ol.ext.getPixelFromElevation),function(c,h){ol.ext.imageLoader.loadBILImage(h,function(u,d){var m=document.createElement("canvas"),g=m.getContext("2d");m.width=d[0],m.height=d[1];for(var x=g.getImageData(0,0,d[0],d[1]),E=x.data,P=0;P<u.length;P++){var L=n(u[P]);E[4*P]=L[0],E[4*P+1]=L[1],E[4*P+2]=L[2],E[4*P+3]=L[3]}g.putImageData(x,0,0),c.setImage(m)},function(){c.setState(3)})}},ol.ext.getPixelFromElevation=function(n){var c=Math.round(n*100+12e5),h=[c>>16,c%65536>>8,c%256,255];return h},ol.ext.getElevationFromPixel=function(n){return-12e3+((n[0]<<16)+(n[1]<<8)+n[2])*.01},ol.matrix3D={},ol.matrix3D.getTransform=function(n){var c=window.getComputedStyle(n,null),h=c.getPropertyValue("-webkit-transform")||c.getPropertyValue("-moz-transform")||c.getPropertyValue("-ms-transform")||c.getPropertyValue("-o-transform")||c.getPropertyValue("transform"),u=h.split("(")[1].split(")")[0].split(","),d=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],m,g;if(u.length===16)for(m=0;m<4;++m)for(g=0;g<4;++g)d[g][m]=+u[m*4+g];else for(m=0;m<3;++m)for(g=0;g<2;++g)d[g][m]=+u[m*2+g];return d},ol.matrix3D.getTransformOrigin=function(n){for(var c=window.getComputedStyle(n,null),h=c.getPropertyValue("-webkit-transform-origin")||c.getPropertyValue("-moz-transform-origin")||c.getPropertyValue("-ms-transform-origin")||c.getPropertyValue("-o-transform-origin")||c.getPropertyValue("transform-origin"),u=h.split(" "),d=[0,0,0,1],m=0;m<u.length;++m)d[m]=parseInt(u[m]);return d},ol.matrix3D.translateMatrix=function(n,c,h){return[[1,0,0,n],[0,1,0,c],[0,0,1,h],[0,0,0,1]]},ol.matrix3D.identity=function(){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]},ol.matrix3D.roundTo=function(n,c){c||(c=1e-10);for(var h=[[],[],[],[]],u=0;u<4;u++)for(var d=0;d<4;d++)h[u][d]=Math.round(n[u][d]/c)*c;return h},ol.matrix3D.multiply=function(n,c){for(var h=[[],[],[],[]],u=0;u<4;++u)for(var d=0;d<4;++d){for(var m=0,g=0;g<4;++g)m+=n[g][u]*c[d][g];h[d][u]=m}return h},ol.matrix3D.computeTransformMatrix=function(n,c){var h=ol.matrix3D.translateMatrix(-c[0],-c[1],-c[2]),u=ol.matrix3D.translateMatrix(c[0],c[1],c[2]),d=ol.matrix3D.multiply(h,n);return ol.matrix3D.multiply(d,u)},ol.matrix3D.transformVertex=function(n,c){for(var h=[c[0],c[1],0,1],u=[],d=0;d<4;++d){u[d]=0;for(var m=0;m<4;++m)u[d]+=+n[d][m]*h[m]}return u},ol.matrix3D.projectVertex=function(n){for(var c=[],h=0;h<4;++h)c[h]=n[h]/n[3];return c},ol.matrix3D.inverse=function(n){var c=n[0][0]*n[1][1]-n[1][0]*n[0][1],h=n[0][0]*n[1][2]-n[1][0]*n[0][2],u=n[0][0]*n[1][3]-n[1][0]*n[0][3],d=n[0][1]*n[1][2]-n[1][1]*n[0][2],m=n[0][1]*n[1][3]-n[1][1]*n[0][3],g=n[0][2]*n[1][3]-n[1][2]*n[0][3],x=n[2][2]*n[3][3]-n[3][2]*n[2][3],E=n[2][1]*n[3][3]-n[3][1]*n[2][3],P=n[2][1]*n[3][2]-n[3][1]*n[2][2],L=n[2][0]*n[3][3]-n[3][0]*n[2][3],F=n[2][0]*n[3][2]-n[3][0]*n[2][2],U=n[2][0]*n[3][1]-n[3][0]*n[2][1],A=1/(c*x-h*E+u*P+d*L-m*F+g*U);if(isNaN(A)||A===1/0)throw new Error("Inverse determinant attempted to divide by zero.");return[[(n[1][1]*x-n[1][2]*E+n[1][3]*P)*A,(-n[0][1]*x+n[0][2]*E-n[0][3]*P)*A,(n[3][1]*g-n[3][2]*m+n[3][3]*d)*A,(-n[2][1]*g+n[2][2]*m-n[2][3]*d)*A],[(-n[1][0]*x+n[1][2]*L-n[1][3]*F)*A,(n[0][0]*x-n[0][2]*L+n[0][3]*F)*A,(-n[3][0]*g+n[3][2]*u-n[3][3]*h)*A,(n[2][0]*g-n[2][2]*u+n[2][3]*h)*A],[(n[1][0]*E-n[1][1]*L+n[1][3]*U)*A,(-n[0][0]*E+n[0][1]*L-n[0][3]*U)*A,(n[3][0]*m-n[3][1]*u+n[3][3]*c)*A,(-n[2][0]*m+n[2][1]*u-n[2][3]*c)*A],[(-n[1][0]*P+n[1][1]*F-n[1][2]*U)*A,(n[0][0]*P-n[0][1]*F+n[0][2]*U)*A,(-n[3][0]*d+n[3][1]*h-n[3][2]*c)*A,(n[2][0]*d-n[2][1]*h+n[2][2]*c)*A]]},window.ol&&!ol.sphere&&(ol.sphere={},ol.sphere.getDistance=function(n,c,h){var u=new ol.Sphere(h||63710088e-1);return u.haversineDistance(n,c)},ol.sphere.getArea=ol.Sphere.getArea,ol.sphere.getLength=ol.Sphere.getLength),ol.ext.SVGFilter.Laplacian=function(n){n=n||{},ol.ext.SVGFilter.call(this,{id:n.id});var c={feoperation:"feConvolveMatrix",in:"SourceGraphic",preserveAlpha:!0,result:"C1"};n.neighbours===4?c.kernelMatrix=[0,-1,0,-1,4,-1,0,-1,0]:c.kernelMatrix=[-1,-1,-1,-1,8,-1,-1,-1,-1],this.addOperation(c),n.grayscale?this.grayscale():n.alpha&&this.luminanceToAlpha({gamma:n.gamma})},ol.ext.inherits(ol.ext.SVGFilter.Laplacian,ol.ext.SVGFilter),ol.ext.SVGFilter.Paper=function(n){n=n||{},ol.ext.SVGFilter.call(this,{id:n.id}),this.addOperation({feoperation:"feTurbulence",numOctaves:4,seed:0,type:"fractalNoise",baseFrequency:.2/(n.scale||1)}),this.addOperation({feoperation:"feDiffuseLighting","lighting-color":"rgb(255,255,255)",surfaceScale:1.5,kernelUnitLength:.01,diffuseConstant:1.1,result:"paper",operations:[{feoperation:"feDistantLight",elevation:n.light||50,azimuth:75}]}),this.addOperation({feoperation:"feBlend",in:"SourceGraphic",in2:"paper",mode:"multiply"})},ol.ext.inherits(ol.ext.SVGFilter.Paper,ol.ext.SVGFilter),ol.ext.SVGFilter.Paper.prototype.setLight=function(n){this.element.querySelector("feDistantLight").setAttribute("elevation",n)},ol.ext.SVGFilter.Prewitt=function(n){n=n||{},ol.ext.SVGFilter.call(this,{id:n.id,color:"sRGB"});var c={feoperation:"feConvolveMatrix",in:"SourceGraphic",preserveAlpha:!0,order:3};c.kernelMatrix=[-1,-1,-1,0,0,0,1,1,1],c.result="V1",this.addOperation(c),c.kernelMatrix=[1,1,1,0,0,0,-1,-1,-1],c.result="V2",this.addOperation(c),c.kernelMatrix=[-1,0,1,-1,0,1,-1,0,1],c.result="H1",this.addOperation(c),c.kernelMatrix=[1,-0,-1,1,0,-1,1,0,-1],c.result="H2",this.addOperation(c),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"V1",in2:"V2",k2:1,k3:1,result:"V"}),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"H1",in2:"H2",k2:1,k3:1,result:"H"}),this.addOperation({feoperation:"feBlend",mode:"lighten",in:"H",in2:"V"}),n.grayscale?this.grayscale():n.alpha&&this.luminanceToAlpha()},ol.ext.inherits(ol.ext.SVGFilter.Prewitt,ol.ext.SVGFilter),ol.ext.SVGFilter.Roberts=function(n){n=n||{},ol.ext.SVGFilter.call(this,{id:n.id,color:"sRGB"});var c={feoperation:"feConvolveMatrix",in:"SourceGraphic",preserveAlpha:!0,order:3};c.kernelMatrix=[-1,0,0,0,0,0,0,0,1],c.result="V1",this.addOperation(c),c.kernelMatrix=[1,0,0,0,0,0,0,0,-1],c.result="V2",this.addOperation(c),c.kernelMatrix=[0,0,1,0,0,0,-1,0,0],c.result="H1",this.addOperation(c),c.kernelMatrix=[0,-0,-1,0,0,0,1,0,0],c.result="H2",this.addOperation(c),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"V1",in2:"V2",k2:1,k3:1,result:"V"}),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"H1",in2:"H2",k2:1,k3:1,result:"H"}),this.addOperation({feoperation:"feBlend",mode:"lighten",in:"H",in2:"V"}),n.grayscale?this.grayscale():n.alpha&&this.luminanceToAlpha()},ol.ext.inherits(ol.ext.SVGFilter.Roberts,ol.ext.SVGFilter),ol.ext.SVGFilter.Sobel=function(n){n=n||{},ol.ext.SVGFilter.call(this,{id:n.id,color:"sRGB"});var c={feoperation:"feConvolveMatrix",in:"SourceGraphic",preserveAlpha:!0,order:3};c.kernelMatrix=[-1,-2,-1,0,0,0,1,2,1],c.result="V1",this.addOperation(c),c.kernelMatrix=[1,2,1,0,0,0,-1,-2,-1],c.result="V2",this.addOperation(c),c.kernelMatrix=[-1,0,1,-2,0,2,-1,0,1],c.result="H1",this.addOperation(c),c.kernelMatrix=[1,-0,-1,2,0,-2,1,0,-1],c.result="H2",this.addOperation(c),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"V1",in2:"V2",k2:1,k3:1,result:"V"}),this.addOperation({feoperation:"feComposite",operator:"arithmetic",in:"H1",in2:"H2",k2:1,k3:1,result:"H"}),this.addOperation({feoperation:"feBlend",mode:"lighten",in:"H",in2:"V"}),n.grayscale?this.grayscale():n.alpha&&this.luminanceToAlpha({gamma:n.gamma})},ol.ext.inherits(ol.ext.SVGFilter.Sobel,ol.ext.SVGFilter),window.ol&&(ol.ext.input={}),ol.ext.input.Base=function(n){n=n||{},ol.Object.call(this);var c=this.input=n.input;c||(c=this.input=document.createElement("INPUT"),n.type&&c.setAttribute("type",n.type),n.min!==void 0&&c.setAttribute("min",n.min),n.max!==void 0&&c.setAttribute("max",n.max),n.step!==void 0&&c.setAttribute("step",n.step),n.parent&&n.parent.appendChild(c)),n.disabled&&(c.disabled=!0),n.checked!==void 0&&(c.checked=!!n.checked),n.val!==void 0&&(c.value=n.val),n.hidden&&(c.style.display="none"),c.addEventListener("focus",function(){this.element&&this.element.classList.add("ol-focus")}.bind(this));var h;c.addEventListener("focusout",function(){this.element&&(h&&clearTimeout(h),h=setTimeout(function(){this.element.classList.remove("ol-focus")}.bind(this),0))}.bind(this))},ol.ext.inherits(ol.ext.input.Base,ol.Object),ol.ext.input.Base.prototype._listenDrag=function(n,c){var h=function(u){this.moving=!0,this.element.classList.add("ol-moving");var d=function(m){m.type==="pointerup"&&(document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",d),document.removeEventListener("pointercancel",d),setTimeout(function(){this.moving=!1,this.element.classList.remove("ol-moving")}.bind(this))),m.target===n&&c(m),m.stopPropagation(),m.preventDefault()}.bind(this);document.addEventListener("pointermove",d,!1),document.addEventListener("pointerup",d,!1),document.addEventListener("pointercancel",d,!1),u.stopPropagation(),u.preventDefault()}.bind(this);n.addEventListener("mousedown",h,!1),n.addEventListener("touchstart",h,!1)},ol.ext.input.Base.prototype.setValue=function(n){n!==void 0&&(this.input.value=n),this.input.dispatchEvent(new Event("change"))},ol.ext.input.Base.prototype.getValue=function(){return this.input.value},ol.ext.input.Base.prototype.getInputElement=function(){return this.input},ol.ext.input.Slider=function(n){n=n||{},ol.ext.input.Base.call(this,n),this.set("overflow",!!n.overflow),this.element=ol.ext.element.create("DIV",{className:"ol-input-slider"+(n.hover!==!1?" ol-hover":"")+(n.type?" ol-"+n.type:"")+(n.className?" "+n.className:"")}),n.fixed&&this.element.classList.add("ol-fixed");var c=this.input;c.parentNode&&c.parentNode.insertBefore(this.element,c),this.element.appendChild(c),n.align==="right"&&this.element.classList.add("ol-right");var h=ol.ext.element.create("DIV",{className:"ol-popup",parent:this.element});n.before&&ol.ext.element.create("DIV",{className:"ol-before",html:n.before,parent:h});var u=this.slider=ol.ext.element.create("DIV",{className:"ol-slider",parent:h});ol.ext.element.create("DIV",{className:"ol-back",parent:this.slider});var d=ol.ext.element.create("DIV",{className:"ol-cursor",parent:u});n.after&&ol.ext.element.create("DIV",{className:"ol-after",html:n.after,parent:h});var m=n.min!==void 0?n.min:parseFloat(c.min)||0,g=n.max!==void 0?n.max:parseFloat(c.max)||1,x=n.step!==void 0?n.step:parseFloat(c.step)||1,E=1/x;this._listenDrag(u,function(L){var F=Math.max(0,Math.min(L.offsetX/u.clientWidth,1));d.style.left=Math.max(0,Math.min(100,Math.round(F*100)))+"%";var U=c.value=Math.round((F*(g-m)+m)*E)/E;this.dispatchEvent({type:"change:value",value:U})}.bind(this));var P=function(){var L=parseFloat(c.value)||0;this.get("overflow")||(L=Math.max(m,Math.min(g,L))),L!=c.value&&(c.value=L);var F=(L-m)/(g-m);d.style.left=Math.max(0,Math.min(100,Math.round(F*100)))+"%",this.dispatchEvent({type:"change:value",value:L})}.bind(this);c.addEventListener("change",P),P()},ol.ext.inherits(ol.ext.input.Slider,ol.ext.input.Base),ol.ext.input.PopupBase=function(n){switch(n=n||{},n.hidden=n.hidden!==!1,ol.ext.input.Base.call(this,n),this.set("autoClose",n.autoClose!==!1),this.element=ol.ext.element.create("DIV",{className:("ol-ext-popup-input "+(n.className||"")).trim()}),n.position){case"inline":break;case"static":case"fixed":{this.element.classList.add("ol-popup"),this.element.classList.add("ol-popup-fixed"),this._fixed=n.position==="fixed";break}default:{this.element.classList.add("ol-popup");break}}var c=this.input;c.parentNode&&c.parentNode.insertBefore(this.element,c),this.element.addEventListener("click",function(){this.isCollapsed()&&setTimeout(function(){this.collapse(!1)}.bind(this))}.bind(this)),this._elt={},this._elt.popup=ol.ext.element.create("DIV",{className:"ol-popup",parent:this.element}),this._elt.popup.addEventListener("click",function(u){u.stopPropagation()});var h=!1;this._elt.popup.addEventListener("pointerdown",function(){h=!0}),this._elt.popup.addEventListener("click",function(){h=!1}),document.addEventListener("click",function(){!this.moving&&!h&&this.collapse(!0),h=!1}.bind(this)),window.addEventListener("resize",function(){this.collapse(!0)}.bind(this))},ol.ext.inherits(ol.ext.input.PopupBase,ol.ext.input.Base),ol.ext.input.PopupBase.prototype.collapse=function(n){if(n!=this.isCollapsed()&&this.dispatchEvent({type:"change:visible",visible:!this.isCollapsed()}),this.dispatchEvent({type:"collapse",visible:!n}),n)this._elt.popup.classList.remove("ol-visible");else if(this._elt.popup.classList.add("ol-visible"),this._fixed){var c=this.element.getBoundingClientRect(),h=ol.ext.element.getFixedOffset(this.element);c={bottom:c.bottom-h.top,left:c.left-h.left};var u=c.bottom+this._elt.popup.offsetHeight+h.top;u>document.documentElement.clientHeight?this._elt.popup.style.top=Math.max(document.documentElement.clientHeight-this._elt.popup.offsetHeight-h.top,0)+"px":this._elt.popup.style.top=c.bottom+"px";var d=c.left+this._elt.popup.offsetWidth+h.left;d>document.documentElement.clientWidth?this._elt.popup.style.left=Math.max(document.documentElement.clientWidth-this._elt.popup.offsetWidth-h.left,0)+"px":this._elt.popup.style.left=c.left+"px"}},ol.ext.input.PopupBase.prototype.isCollapsed=function(){return!this._elt.popup.classList.contains("ol-visible")},ol.ext.input.PopupBase.prototype.toggle=function(){this.collapse(!this.isCollapsed())},ol.ext.input.Checkbox=function(n){n=n||{},ol.ext.input.Base.call(this,n);var c=this.element=document.createElement("LABEL");n.html instanceof Element?c.appendChild(n.html):n.html!==void 0&&(c.innerHTML=n.html),c.className=("ol-ext-check ol-ext-checkbox "+(n.className||"")).trim(),this.input.parentNode&&this.input.parentNode.insertBefore(c,this.input),c.appendChild(this.input),c.appendChild(document.createElement("SPAN")),n.after&&c.appendChild(document.createTextNode(n.after)),this.input.addEventListener("change",function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}.bind(this))},ol.ext.inherits(ol.ext.input.Checkbox,ol.ext.input.Base),ol.ext.input.Checkbox.prototype.isChecked=function(){return this.input.checked},ol.ext.input.Collection=function(n){ol.Object.call(this),this.element=ol.ext.element.create("UL",{className:("ol-collection-list "+(n.className||"")).trim(),parent:n.target}),this.collection=n.collection,this._title=typeof n.getTitle=="function"?n.getTitle:function(c){return c.title},this.refresh(),this.collection.on("change:length",function(){if(!this._reorder){this.refresh();var c=this.getSelectPosition();c<0?this.dispatchEvent({type:"item:select",position:-1,item:null}):this.dispatchEvent({type:"item:order",position:c,item:this._currentItem})}}.bind(this))},ol.ext.inherits(ol.ext.input.Collection,ol.Object),ol.ext.input.Collection.prototype.select=function(n){if(n!==this._currentItem){var c=-1;this._listElt.forEach(function(h,u){h.item!==n?h.li.classList.remove("ol-select"):(h.li.classList.add("ol-select"),c=u)}),this._currentItem=c>=0?n:null,this.dispatchEvent({type:"item:select",position:c,item:this._currentItem})}},ol.ext.input.Collection.prototype.selectAt=function(n){this.select(this.collection.item(n))},ol.ext.input.Collection.prototype.getSelect=function(){return this._currentItem},ol.ext.input.Collection.prototype.getSelectPosition=function(){return this.collection.getArray().indexOf(this._currentItem)},ol.ext.input.Collection.prototype.refresh=function(){this.element.innerHTML="",this._listElt=[],this.collection.forEach((n,c)=>{var h=ol.ext.element.create("LI",{html:this._title(n),className:this._currentItem===n?"ol-select":"","data-position":c,on:{click:function(){this.select(n)}.bind(this),dblclick:function(){this.dispatchEvent({type:"item:dblclick",position:c,item:n})}.bind(this)},parent:this.element});this._listElt.push({li:h,item:n});var u=ol.ext.element.create("DIV",{className:"ol-noscroll ol-order",parent:h}),d=c,m=function(x){for(var E=x.pointerType==="touch"?document.elementFromPoint(x.clientX,x.clientY):x.target;E&&E.parentNode!==this.element;)E=E.parentNode;if(E&&E!==h){var P=parseInt(E.getAttribute("data-position"));E.getAttribute("data-position")<d?(E.insertAdjacentElement("beforebegin",h),d=P):(E.insertAdjacentElement("afterend",h),d=P+1)}}.bind(this),g=function(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g),document.removeEventListener("pointercancel",g),d!==c&&(this._reorder=!0,this.collection.removeAt(c),this.collection.insertAt(d>c?d-1:d,n),this._reorder=!1,this.dispatchEvent({type:"item:order",position:d>c?d-1:d,oldPosition:c,item:n}),this.refresh())}.bind(this);u.addEventListener("pointerdown",function(){this.select(n),document.addEventListener("pointermove",m),document.addEventListener("pointerup",g),document.addEventListener("pointercancel",g)}.bind(this))})},ol.ext.input.Color=function(n){n=n||{},n.hidden=n.hidden!==!1,n.className=("ol-ext-colorpicker "+(n.hastab?"ol-tab ":"")+(n.className||"")).trim(),ol.ext.input.PopupBase.call(this,n),n.opacity===!1&&this.element.classList.add("ol-nopacity"),this._cursor={};var c=this._hsv={};this._elt.vignet=ol.ext.element.create("DIV",{className:"ol-vignet",parent:this.element});var h=ol.ext.element.create("DIV",{className:"ol-tabbar",parent:this._elt.popup});ol.ext.element.create("DIV",{className:"ol-tab",html:n.paletteLabel||"palette",click:function(){this.element.classList.remove("ol-picker-tab")}.bind(this),parent:h}),ol.ext.element.create("DIV",{className:"ol-tab",html:n.pickerLabel||"picker",click:function(){this.element.classList.add("ol-picker-tab")}.bind(this),parent:h});var u=ol.ext.element.create("DIV",{className:"ol-container",parent:this._elt.popup}),d=this._elt.picker=ol.ext.element.create("DIV",{className:"ol-picker",parent:u}),m=this._cursor.picker=ol.ext.element.create("DIV",{className:"ol-cursor",parent:d});this._listenDrag(d,function(O){var K=Math.max(0,Math.min(O.offsetX/d.clientWidth,1)),Q=Math.max(0,Math.min(O.offsetY/d.clientHeight,1));m.style.left=Math.round(K*100)+"%",m.style.top=Math.round(Q*100)+"%",c.s=K*100,c.v=100-Q*100,this.setColor()}.bind(this));var g=ol.ext.element.create("DIV",{className:"ol-slider",parent:u});this._elt.slider=ol.ext.element.create("DIV",{parent:g});var x=this._cursor.slide=ol.ext.element.create("DIV",{className:"ol-cursor",parent:g});this._listenDrag(g,function(O){var K=Math.max(0,Math.min(O.offsetX/g.clientWidth,1));c.a=K*100,x.style.left=Math.round(K*100)+"%",this.setColor()}.bind(this));var E=ol.ext.element.create("DIV",{className:"ol-tint",parent:u}),P=this._cursor.tint=ol.ext.element.create("DIV",{className:"ol-cursor",parent:E});this._listenDrag(E,function(O){var K=Math.max(0,Math.min(O.offsetY/E.clientHeight,1));c.h=K*360,P.style.top=Math.round(K*100)+"%",this.setColor()}.bind(this)),ol.ext.element.create("DIV",{className:"ol-clear",click:function(){this.setColor([0,0,0,0])}.bind(this),parent:u});var L=ol.ext.element.create("DIV",{className:"ol-rgb",parent:u}),F=function(){var O=Math.max(0,Math.min(255,parseInt(this._elt.r.value))),K=Math.max(0,Math.min(255,parseInt(this._elt.g.value))),Q=Math.max(0,Math.min(255,parseInt(this._elt.b.value))),et=Math.max(0,Math.min(1,parseFloat(this._elt.a.value)));this.setColor([O,K,Q,et])}.bind(this);this._elt.r=ol.ext.element.create("INPUT",{type:"number",lang:"en-GB",change:F,min:0,max:255,parent:L}),this._elt.g=ol.ext.element.create("INPUT",{type:"number",lang:"en-GB",change:F,min:0,max:255,parent:L}),this._elt.b=ol.ext.element.create("INPUT",{type:"number",lang:"en-GB",change:F,min:0,max:255,parent:L}),this._elt.a=ol.ext.element.create("INPUT",{type:"number",lang:"en-GB",change:F,min:0,max:1,step:.1,parent:L}),this._elt.txtColor=ol.ext.element.create("INPUT",{type:"text",className:"ol-txt-color",change:function(){var O;this._elt.txtColor.classList.remove("ol-error");try{O=ol.color.asArray(this._elt.txtColor.value)}catch{this._elt.txtColor.classList.add("ol-error")}O&&this.setColor(O)}.bind(this),parent:u}),ol.ext.element.create("BUTTON",{html:"OK",click:function(){this._addCustomColor(this.getColor()),this.collapse(!0)}.bind(this),parent:u});var U;for(this._paletteColor={},this._elt.palette=ol.ext.element.create("DIV",{className:"ol-palette",parent:this._elt.popup}),U=0;U<8;U++){var A=Math.round(255-255*U/7);this.addPaletteColor([A,A,A],A)}var G=["#f00","#f90","#ff0","#0f0","#0ff","#48e","#00f","#f0f"];for(G.forEach(function(O){this.addPaletteColor(O,ol.color.toHexa(ol.color.asArray(O)))}.bind(this)),U=0;U<5;U++)G.forEach(function(O){O=ol.color.toHSV(ol.color.asArray(O)),O=[O[0],U/4*80+20,100-U/4*60],O=ol.color.fromHSV(O,1),this.addPaletteColor(O,ol.color.toHexa(O))}.bind(this));if(ol.ext.element.create("HR",{parent:this._elt.palette}),!ol.ext.input.Color.customColorList){ol.ext.input.Color.customColorList=new ol.Collection;var B=JSON.parse(localStorage.getItem("ol-ext@colorpicker")||"[]");B.forEach(function(O){ol.ext.input.Color.customColorList.push(O)}),ol.ext.input.Color.customColorList.on(["add","remove"],function(){localStorage.setItem("ol-ext@colorpicker",JSON.stringify(ol.ext.input.Color.customColorList.getArray()))})}ol.ext.input.Color.customColorList.on("add",function(O){this.addPaletteColor(this.getColorFromID(O.element))}.bind(this)),ol.ext.input.Color.customColorList.on("remove",function(O){this._paletteColor[O.element]&&this._paletteColor[O.element].element.remove(),delete this._paletteColor[O.element]}.bind(this)),ol.ext.input.Color.customColorList.forEach(function(O){this._addCustomColor(this.getColorFromID(O))}.bind(this)),this.setColor(n.color||[0,0,0,0]),this._currentColor=this.getColorID(this.getColor()),this.on("color",function(){this._addCustomColor(this.getColor()),this._currentColor=this.getColorID(this.getColor()),this.setColor()}.bind(this)),this.on("collapse",function(O){if(O.visible)this._currentColor=this.getColorID(this.getColor());else{var K=this.getColor();this._currentColor!==this.getColorID(K)&&this.dispatchEvent({type:"color",color:K})}}.bind(this))},ol.ext.inherits(ol.ext.input.Color,ol.ext.input.PopupBase),ol.ext.input.Color.customColorList=null,ol.ext.input.Color.prototype.addPaletteColor=function(n,c,h){try{n=ol.color.asArray(n)}catch{return}var u=this.getColorID(n);!this._paletteColor[u]&&n[3]&&(this._paletteColor[u]={color:n,element:ol.ext.element.create("DIV",{title:c||"",className:n[3]<1?"ol-alpha":"",style:{color:"rgb("+n.join(",")+")"},click:function(){this.setColor(n),this.get("autoClose")&&this.collapse(!0)}.bind(this),parent:this._elt.palette})}),h&&this._selectPalette(n)},ol.ext.input.Color.prototype.showTab=function(n){n==="palette"?this.element.classList.remove("ol-picker-tab"):this.element.classList.add("ol-picker-tab")},ol.ext.input.Color.prototype.getTab=function(){return this.element.classList.contains("ol-picker-tab")?"picker":"palette"},ol.ext.input.Color.prototype._selectPalette=function(n){var c=this.getColorID(n);Object.keys(this._paletteColor).forEach(function(h){this._paletteColor[h].element.classList.remove("ol-select")}.bind(this)),this._paletteColor[c]&&this._paletteColor[c].element.classList.add("ol-select")},ol.ext.input.Color.prototype.setColor=function(n){var c=this._hsv;if(n){n=ol.color.asArray(n);var h=ol.color.toHSV(n);c.h=h[0],c.s=h[1],c.v=h[2],h.length>3?c.a=h[3]*100:c.a=100,this._cursor.picker.style.left=c.s+"%",this._cursor.picker.style.top=100-c.v+"%",this._cursor.tint.style.top=c.h/360*100+"%",this._cursor.slide.style.left=c.a+"%",this.isCollapsed()&&this.dispatchEvent({type:"color",color:n})}else c.a=Math.round(c.a),n=this.getColor();var u="rgba("+n.join(", ")+")";this._elt.picker.style.color="hsl("+c.h+", 100%, 50%)",this._elt.slider.style.backgroundImage="linear-gradient(45deg, transparent, rgba("+this.getColor(!1).join(",")+"))",this._elt.vignet.style.color=u,this._elt.r.value=n[0],this._elt.g.value=n[1],this._elt.b.value=n[2],this._elt.a.value=n[3],this._elt.txtColor.classList.remove("ol-error"),n[3]===1?this._elt.txtColor.value=ol.color.toHexa(n):this._elt.txtColor.value=u,this._selectPalette(n),this.input.value!==u&&(this.input.value=u,this.input.dispatchEvent(new Event("change")))},ol.ext.input.Color.prototype.getColor=function(n){return ol.color.fromHSV([this._hsv.h,this._hsv.s,this._hsv.v,n!==!1?this._hsv.a/100:1],1)},ol.ext.input.Color.prototype._addCustomColor=function(n){var c=this.getColorID(n);this._paletteColor[c]||n[3]&&(ol.ext.input.Color.customColorList.getArray().indexOf(c)<0&&(ol.ext.input.Color.customColorList.push(c),ol.ext.input.Color.customColorList.getLength()>24&&ol.ext.input.Color.customColorList.removeAt(0)),this.addPaletteColor(n))},ol.ext.input.Color.prototype.clearCustomColor=function(){ol.ext.input.Color.customColorList.clear()},ol.ext.input.Color.prototype.getColorID=function(n){return n=ol.color.asArray(n),n[3]===void 0&&(n[3]=1),n.join("-")},ol.ext.input.Color.prototype.getColorFromID=function(n){var c=n.split("-");return[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3])]},ol.ext.input.List=function(n){switch(n=n||{},ol.ext.input.Base.call(this,n),this._content=ol.ext.element.create("DIV"),(n.hidden||n.disabled)&&(n.hover=!0),this.element=ol.ext.element.create("DIV",{html:this._content,className:"ol-input-popup"+(n.hover?" ol-hover":"")}),this.set("hideOnClick",n.hideOnClick!==!1),n.className&&this.element.classList.add(n.className),n.fixed&&(this.element.classList.add("ol-fixed"),this.set("hideOnClick",!1)),n.align){case"middle":this.set("hideOnClick",!1);case"rigth":this.element.classList.add("ol-"+n.align);break;default:break}var c=this.input;c.parentNode&&c.parentNode.insertBefore(this.element,c),this.element.appendChild(c);var h=this.popup=ol.ext.element.create("UL",{className:"ol-popup",parent:this.element}),u=[];n.options.forEach(m=>{u.push({value:m.value,element:ol.ext.element.create("LI",{html:m.html,title:m.title||m.value,className:"ol-option",on:{pointerdown:function(){this.setValue(m.value),this.get("hideOnClick")&&(h.style.display="none",setTimeout(function(){h.style.display=""},200))}.bind(this)},parent:this.popup})})}),this.input.addEventListener("change",function(){var m=this.input.value,g;u.forEach(function(x){x.value==m?(x.element.classList.add("ol-selected"),g=x.element):x.element.classList.remove("ol-selected")}),this.dispatchEvent({type:"change:value",value:this.getValue()}),this._content.innerHTML=g?g.innerHTML:""}.bind(this));var d=new Event("change");setTimeout(function(){this.input.dispatchEvent(d)}.bind(this))},ol.ext.inherits(ol.ext.input.List,ol.ext.input.Base),ol.ext.input.Radio=function(n){n=n||{},ol.ext.input.Checkbox.call(this,n),this.element.className=("ol-ext-check ol-ext-radio "+(n.className||"")).trim()},ol.ext.inherits(ol.ext.input.Radio,ol.ext.input.Checkbox),ol.ext.input.Range=function(n){n=n||{},ol.ext.input.Base.call(this,n),this.set("overflow",!!n.overflow),this.element=ol.ext.element.create("DIV",{className:"ol-input-slider ol-input-range"+(n.className?" "+n.className:"")});var c=this.input;c.parentNode&&c.parentNode.insertBefore(this.element,c),this.element.appendChild(c);var h=this.slider=ol.ext.element.create("DIV",{className:"ol-slider",parent:this.element}),u=ol.ext.element.create("DIV",{className:"ol-back",parent:this.slider}),d=this.input2=n.input2;d&&this.element.appendChild(d);var m=ol.ext.element.create("DIV",{className:"ol-cursor",parent:h}),g=ol.ext.element.create("DIV",{className:"ol-cursor",parent:d?h:void 0}),x=m;function E(O){x=O.target}m.addEventListener("mousedown",E,!1),m.addEventListener("touchstart",E,!1),g.addEventListener("mousedown",E,!1),g.addEventListener("touchstart",E,!1);var P=n.min!==void 0?n.min:parseFloat(c.min)||0,L=n.max!==void 0?n.max:parseFloat(c.max)||1,F=n.step!==void 0?n.step:parseFloat(c.step)||1,U=1/F;function A(){if(d){var O=parseFloat(m.style.left)||0,K=parseFloat(g.style.left)||0;u.style.left=Math.min(O,K)+"%",u.style.right=100-Math.max(O,K)+"%"}else u.style.left=0,u.style.right=(100-parseFloat(m.style.left)||0)+"%"}function G(){if(d&&parseFloat(c.value)>parseFloat(d.value)){var O=c.value;c.value=d.value,d.value=O,B({target:c}),d&&B({target:d})}}this._listenDrag(h,function(O){var K=x===m?c:d,Q=Math.max(0,Math.min(O.offsetX/h.clientWidth,1));x.style.left=Math.max(0,Math.min(100,Math.round(Q*100)))+"%";var et=K.value=Math.round((Q*(L-P)+P)*U)/U;A(),this.dispatchEvent({type:"change:value",value:et}),O.type==="pointerup"&&G()}.bind(this));var B=function(O){var K=O.target,Q=K===c?m:g,et=parseFloat(K.value)||0;this.get("overflow")||(et=Math.max(P,Math.min(L,et))),et!=K.value&&(K.value=et);var lt=(et-P)/(L-P);Q.style.left=Math.max(0,Math.min(100,Math.round(lt*100)))+"%",A(),this.dispatchEvent({type:"change:value",value:et}),G()}.bind(this);c.addEventListener("change",B),d&&d.addEventListener("change",B),B({target:c}),d&&B({target:d})},ol.ext.inherits(ol.ext.input.Range,ol.ext.input.Base),ol.ext.input.Range.prototype.setValue2=function(n){this.input2&&(n!==void 0&&(this.input2.value=n),this.input2.dispatchEvent(new Event("change")))},ol.ext.input.Range.prototype.getValue2=function(){return this.input2?this.input2.value:null},ol.ext.input.Range.prototype.getMin=function(){return parseFloat(this.getValue())},ol.ext.input.Range.prototype.getMax=function(){return parseFloat(this.getValue2())},ol.ext.input.Size=function(n){n=n||{},n.options=[],(n.size||[0,2,3,5,8,13,21,34,55]).forEach(function(c){n.options.push({value:c,html:ol.ext.element.create("DIV",{className:"ol-option-"+c,style:{fontSize:c?c+"px":void 0}})})}),ol.ext.input.List.call(this,n),this._content.remove(),this.element.classList.add("ol-size")},ol.ext.inherits(ol.ext.input.Size,ol.ext.input.List),ol.ext.input.Size.prototype.getValue=function(){return parseFloat(ol.ext.input.List.prototype.getValue.call(this))},ol.ext.input.Switch=function(n){n=n||{},ol.ext.input.Checkbox.call(this,n),this.element.className=("ol-ext-toggle-switch "+(n.className||"")).trim()},ol.ext.inherits(ol.ext.input.Switch,ol.ext.input.Checkbox),ol.ext.input.Width=function(n){n=n||{},n.options=[],(n.size||[0,1,2,3,5,10,15,20]).forEach(function(c){n.options.push({value:c,html:ol.ext.element.create("DIV",{className:"ol-option-"+c,style:{height:c||void 0}})})}),ol.ext.input.List.call(this,n),this._content.remove(),this.element.classList.add("ol-width")},ol.ext.inherits(ol.ext.input.Width,ol.ext.input.List),ol.ext.input.Width.prototype.getValue=function(){return parseFloat(ol.ext.input.List.prototype.getValue.call(this))},window.ol&&!ol.legend&&(ol.legend={}),ol.legend.Legend=function(n){n=n||{},ol.Object.call(this),this._items=new ol.Collection;var c=[],h;this._items.on("add",function(u){c.push({item:u.element,on:u.element.on("change",function(){this.refresh()}.bind(this))}),h&&(clearTimeout(h),h=null),h=setTimeout(function(){this.refresh()}.bind(this),0)}.bind(this)),this._items.on("remove",function(u){for(var d=0;d<c;d++)if(u.element===c[d].item){ol.Observable.unByKey(c[d].on),c.splice(d,1);break}h&&(clearTimeout(h),h=null),h=setTimeout(function(){this.refresh()}.bind(this),0)}.bind(this)),this._listElement=ol.ext.element.create("UL",{className:"ol-legend"}),this._canvas=document.createElement("canvas"),this.set("size",n.size||[40,25],!0),this.set("margin",n.margin===0?0:n.margin||10,!0),this._textStyle=n.textStyle||new ol.style.Text({font:"16px sans-serif",fill:new ol.style.Fill({color:"#333"}),backgroundFill:new ol.style.Fill({color:"rgba(255,255,255,.8)"})}),this._title=new ol.legend.Item({title:n.title||"",className:"ol-title"}),n.titleStyle?this._titleStyle=n.titleStyle:(this._titleStyle=this._textStyle.clone(),this._titleStyle.setFont("bold "+this._titleStyle.getFont())),this.setStyle(n.style),n.items instanceof Array&&n.items.forEach(function(u){this.addItem(u)}.bind(this)),this.refresh()},ol.ext.inherits(ol.legend.Legend,ol.Object),ol.legend.Legend.prototype.setTitle=function(n){this._title.setTitle(n),this.refresh()},ol.legend.Legend.prototype.getTitle=function(){return this._title.get("title")},ol.legend.Legend.prototype.getTextStyle=function(){return this._textStyle},ol.legend.Legend.prototype.set=function(n,c,h){ol.Object.prototype.set.call(this,n,c,h),h||this.refresh()},ol.legend.Legend.prototype.getListElement=function(){return this._listElement},ol.legend.Legend.prototype.getCanvas=function(){return this._canvas},ol.legend.Legend.prototype.setStyle=function(n){this._style=n,this.refresh()},ol.legend.Legend.prototype.addItem=function(n){n instanceof ol.legend.Item?this._items.push(n):this._items.push(new ol.legend.Item(n))},ol.legend.Legend.prototype.getItems=function(){return this._items},ol.legend.Legend.prototype._drawText=function(n,c,h,u){n.save(),n.scale(ol.has.DEVICE_PIXEL_RATIO,ol.has.DEVICE_PIXEL_RATIO),c=c||"";var d=c.split(`
`);d.length===1?n.fillText(c,h,u):(n.textBaseline="bottom",n.fillText(d[0],h,u),n.textBaseline="top",n.fillText(d[1],h,u)),n.restore()},ol.legend.Legend.prototype._measureText=function(n,c){var h=(c||"").split(`
`);if(h.length===1)return n.measureText(c);var u=n.measureText(h[0]),d=n.measureText(h[1]);return{width:Math.max(u.width,d.width),height:u.height+d.height}},ol.legend.Legend.prototype.refresh=function(){var n=this._listElement;n.innerHTML="";var c=this.get("margin"),h=this.get("size")[0]+2*c,u=this.get("lineHeight")||this.get("size")[1]+2*c,d=this.getCanvas(),m=d.getContext("2d");m.textAlign="left",m.textBaseline="middle";var g=ol.has.DEVICE_PIXEL_RATIO;m.font=this._titleStyle.getFont();var x=this._measureText(m,this.getTitle("title")).width;this._items.forEach(function(E){E.get("feature")||E.get("typeGeom")?(m.font=E.get("textStyle")?E.get("textStyle").getFont():this._textStyle.getFont(),x=Math.max(x,this._measureText(m,E.get("title")).width+h)):(m.font=E.get("textStyle")?E.get("textStyle").getFont():this._titleStyle.getFont(),x=Math.max(x,this._measureText(m,E.get("title")).width))}.bind(this)),d.width=(x+2*c)*g,d.height=(this._items.getLength()+1)*u*g,d.style.height=(this._items.getLength()+1)*u+"px",m.textBaseline="middle",m.fillStyle=ol.color.asString(this._textStyle.getFill().getColor()),this.getTitle()&&(n.appendChild(this._title.getElement([h,u],function(E){this.dispatchEvent({type:"select",index:-1,symbol:E,item:this._title})}.bind(this))),m.font=this._titleStyle.getFont(),m.textAlign="center",this._drawText(m,this.getTitle(),d.width/g/2,u/2)),this._items.forEach(function(E,P){var L=P+(this.getTitle()?1:0);n.appendChild(E.getElement([h,u],function(U){this.dispatchEvent({type:"select",index:P,symbol:U,item:E})}.bind(this)));var F=E.getProperties();m.textAlign="left",F.feature||F.typeGeom?(d=this.getLegendImage(F,d,L),m.font=E.get("textStyle")?E.get("textStyle").getFont():this._textStyle.getFont(),this._drawText(m,E.get("title"),h+c,(P+1.5)*u)):(m.font=E.get("textStyle")?E.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(F.className)?(m.textAlign="center",this._drawText(m,E.get("title"),d.width/g/2,(P+1.5)*u)):this._drawText(m,E.get("title"),c,(P+1.5)*u))}.bind(this)),this.dispatchEvent({type:"refresh",width:h,height:(this._items.length+1)*u})},ol.legend.Legend.prototype.getLegendImage=function(n,c,h){return n=n||{},ol.legend.Legend.getLegendImage({className:n.className,feature:n.feature,typeGeom:n.typeGeom,style:n.style||this._style,properties:n.properties,margin:n.margin||this.get("margin"),size:n.size||this.get("size"),lineHeight:n.lineHeight||this.get("lineHeight"),onload:function(){this.refresh()}.bind(this)},c,h)},ol.legend.Legend.getLegendImage=function(n,c,h){n=n||{},typeof n.margin>"u"&&(n.margin=10);var u=n.size||[40,25];n.onload=n.onload||function(){setTimeout(function(){ol.legend.Legend.getLegendImage(n,c,h)},100)};var d=u[0]+2*n.margin,m=n.lineHeight||u[1]+2*n.margin,g=n.pixelratio||ol.has.DEVICE_PIXEL_RATIO;c||(h=0,c=document.createElement("canvas"),c.width=d*g,c.height=m*g);var x=c.getContext("2d");x.save();var E=ol.render.toContext(x,{pixelRatio:g}),P=n.typeGeom,L,F=n.feature;!F&&P&&(/Point/.test(P)?F=new ol.Feature(new ol.geom.Point([0,0])):/LineString/.test(P)?F=new ol.Feature(new ol.geom.LineString([0,0])):F=new ol.Feature(new ol.geom.Polygon([[0,0]])),n.properties&&F.setProperties(n.properties)),F?(L=F.getStyle(),typeof L=="function"&&(L=L(F)),L||(L=typeof n.style=="function"?n.style(F):n.style||[]),P=F.getGeometry().getType()):L=[],L instanceof Array||(L=[L]);var U=d/2,A=m/2,G=u[0]/2,B=u[1]/2,O,K;if(P==="Point"){var Q=null;for(O=0;K=L[O];O++){var et=K.getImage();if(et){var lt=et.getImage();if(lt&&lt.complete&&!lt.naturalWidth&&(typeof n.onload=="function"&&lt.addEventListener("load",function(){setTimeout(function(){n.onload()},100)}),et.load()),et.getAnchor){var pt=et.getAnchor();if(pt){var T=et.getSize(),ct=pt[0]-T[0],ut=pt[1]-T[1];Q?ol.extent.extend(Q,[ct,ut,ct+T[0],ut+T[1]]):Q=[ct,ut,ct+T[0],ut+T[1]]}}}}Q&&(U=U+(Q[2]+Q[0])/2,A=A+(Q[3]+Q[1])/2)}for(A+=h*m||0,O=0;K=L[O];O++){E.setStyle(K),x.save();var ft;switch(P){case ol.geom.Point:case"Point":case"MultiPoint":{ft=new ol.geom.Point([U,A]);break}case ol.geom.LineString:case"LineString":case"MultiLineString":{x.rect(n.margin*g,0,u[0]*g,c.height),x.clip(),ft=new ol.geom.LineString([[U-G,A],[U+G,A]]);break}case ol.geom.Polygon:case"Polygon":case"MultiPolygon":{ft=new ol.geom.Polygon([[[U-G,A-B],[U+G,A-B],[U+G,A+B],[U-G,A+B],[U-G,A-B]]]);break}}K.getGeometryFunction()?(ft=K.getGeometryFunction()(new ol.Feature(ft)),x.restore(),E.drawGeometry(ft)):(E.drawGeometry(ft),x.restore())}return x.restore(),c},ol.legend.Item=function(n){n=n||{},ol.Object.call(this,n),n.feature&&this.set("feature",n.feature.clone())},ol.ext.inherits(ol.legend.Item,ol.Object),ol.legend.Item.prototype.setTitle=function(n){this.set("title",n||""),this.changed()},ol.legend.Item.prototype.getElement=function(n,c){var h=ol.ext.element.create("LI",{className:this.get("className"),click:function(u){c(!1),u.stopPropagation()},style:{height:n[1]+"px"},"aria-label":this.get("title")});return ol.ext.element.create("DIV",{click:function(u){c(!0),u.stopPropagation()},style:{width:n[0]+"px",height:n[1]+"px"},parent:h}),h},ol.control.CanvasBase=function(n){n||(n={}),this.setStyle(n.style),ol.control.Control.call(this,n)},ol.ext.inherits(ol.control.CanvasBase,ol.control.Control),ol.control.CanvasBase.prototype.setMap=function(n){this.getCanvas(n);var c=this.getMap();if(this._listener&&(ol.Observable.unByKey(this._listener),this._listener=null),ol.control.Control.prototype.setMap.call(this,n),c)try{c.renderSync()}catch{}n&&(this._listener=n.on("postcompose",this._draw.bind(this)))},ol.control.CanvasBase.prototype.getCanvas=function(n){return ol.ext.getMapCanvas(n)},ol.control.CanvasBase.prototype.getContext=function(n){var c=n.context;if(!c&&this.getMap()){var h=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0];c=h?h.getContext("2d"):null}return c},ol.control.CanvasBase.prototype.setStyle=function(n){this._style=n||new ol.style.Style({})},ol.control.CanvasBase.prototype.getStyle=function(){return this._style},ol.control.CanvasBase.prototype.getStroke=function(){var n=this._style.getStroke();return n||this._style.setStroke(new ol.style.Stroke({color:"#000",width:1.25})),this._style.getStroke()},ol.control.CanvasBase.prototype.getFill=function(){var n=this._style.getFill();return n||this._style.setFill(new ol.style.Fill({color:"#fff"})),this._style.getFill()},ol.control.CanvasBase.prototype.getTextStroke=function(){var n=this._style.getText();return n||(n=new ol.style.Text({})),n.getStroke()||n.setStroke(new ol.style.Stroke({color:"#fff",width:3})),n.getStroke()},ol.control.CanvasBase.prototype.getTextFill=function(){var n=this._style.getText();return n||(n=new ol.style.Text({})),n.getFill()||n.setFill(new ol.style.Fill({color:"#fff"})),n.getFill()},ol.control.CanvasBase.prototype.getTextFont=function(){var n=this._style.getText();return n||(n=new ol.style.Text({})),n.getFont()||n.setFont("12px sans-serif"),n.getFont()},ol.control.CanvasBase.prototype._draw=function(){console.warn("[CanvasBase] draw function not implemented.")},ol.control.SelectBase=function(n){n||(n={}),this._features=this.setFeatures(n.features);var c;n.target?c=document.createElement("div"):(c=document.createElement("div"),c.className="ol-select ol-unselectable ol-control ol-collapsed",ol.ext.element.create("BUTTON",{type:"button",on:{"click touchstart":function(u){c.classList.toggle("ol-collapsed"),u.preventDefault()}},parent:c})),n.className&&c.classList.add(n.className);var h=n.content||ol.ext.element.create("DIV");c.appendChild(h),ol.ext.element.create("BUTTON",{html:n.btInfo||"OK",className:"ol-ok",on:{click:this.doSelect.bind(this)},parent:h}),ol.control.Control.call(this,{element:c,target:n.target}),this.setSources(n.source)},ol.ext.inherits(ol.control.SelectBase,ol.control.Control),ol.control.SelectBase.prototype.setSources=function(n){n?this.set("source",n instanceof Array?n:[n]):this.unset("source")},ol.control.SelectBase.prototype.setFeatures=function(n){n instanceof ol.Collection?this._features=n:this._features=null},ol.control.SelectBase.prototype.getFeatures=function(){return this._features},ol.control.SelectBase.prototype.operationsList={"=":"=","!=":"\u2260","<":"<","<=":"\u2264",">=":"\u2265",">":">",contain:"\u2282","!contain":"\u2284",regexp:"\u2243","!regexp":"\u2244"},ol.control.SelectBase.prototype._escape=function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},ol.control.SelectBase.prototype._checkCondition=function(n,c,h){if(!c.attr)return!0;var u=n.get(c.attr),d=Number(u)==u&&Number(c.val)==c.val;d&&(u=Number(u));var m;switch(c.op){case"=":return d?u==c.val:(m=new RegExp("^"+this._escape(c.val)+"$",h?"":"i"),m.test(u));case"!=":return d?u!=c.val:(m=new RegExp("^"+this._escape(c.val)+"$",h?"":"i"),!m.test(u));case"<":return u<c.val;case"<=":return u<=c.val;case">":return u>c.val;case">=":return u>=c.val;case"contain":return m=new RegExp(this._escape(c.val),h?"":"i"),m.test(u);case"!contain":return m=new RegExp(this._escape(c.val),h?"":"i"),!m.test(u);case"regexp":return m=new RegExp(c.val,h?"":"i"),m.test(u);case"!regexp":return m=new RegExp(c.val,h?"":"i"),!m.test(u);default:return!1}},ol.control.SelectBase.prototype._selectFeatures=function(n,c,h,u,d){h=h||[];for(var m,g=c.length-1;m=c[g];g--){for(var x=u,E=0,P;P=h[E];E++)P.attr&&(u?x=x&&this._checkCondition(m,P,d):x=x||this._checkCondition(m,P,d));x?n.push(m):this._features&&this._features.removeAt(g)}return n},ol.control.SelectBase.prototype.getSources=function(){if(this.get("source"))return this.get("source");var n=[];function c(h){h.forEach(function(u){u.getLayers?c(u.getLayers()):u.getSource&&u.getSource()instanceof ol.source.Vector&&n.push(u.getSource())})}return this.getMap()&&c(this.getMap().getLayers()),n},ol.control.SelectBase.prototype.doSelect=function(n){n=n||{};var c=[];if(n.features)this._selectFeatures(c,n.features,n.conditions,n.matchAll,n.useCase);else if(this._features)this._selectFeatures(c,this._features.getArray(),n.conditions,n.matchAll,n.useCase);else{var h=n.sources||this.getSources();h.forEach(function(u){this._selectFeatures(c,u.getFeatures(),n.conditions,n.matchAll,n.useCase)}.bind(this))}return this.dispatchEvent({type:"select",features:c}),c},ol.control.Button=function(n){n=n||{};var c=document.createElement("div");c.className=(n.className||"")+" ol-button ol-unselectable ol-control";var h=this,u=this.button_=document.createElement(/ol-text-button/.test(n.className)?"div":"button");u.type="button",n.title&&(u.title=n.title),n.name&&(u.name=n.name),n.html instanceof Element?u.appendChild(n.html):u.innerHTML=n.html||"";var d=function(m){m&&m.preventDefault&&(m.preventDefault(),m.stopPropagation()),n.handleClick&&n.handleClick.call(h,m)};u.addEventListener("click",d),c.appendChild(u),!n.title&&u.firstElementChild&&(u.title=u.firstElementChild.title),ol.control.Control.call(this,{element:c,target:n.target}),n.title&&this.set("title",n.title),n.title&&this.set("title",n.title),n.name&&this.set("name",n.name)},ol.ext.inherits(ol.control.Button,ol.control.Control),ol.control.Button.prototype.setVisible=function(n){n?ol.ext.element.show(this.element):ol.ext.element.hide(this.element)},ol.control.Button.prototype.setTitle=function(n){this.button_.setAttribute("title",n)},ol.control.Button.prototype.setHtml=function(n){ol.ext.element.setHTML(this.button_,n)},ol.control.Button.prototype.getButtonElement=function(){return this.button_},ol.control.Toggle=function(n){n=n||{};var c=this;this.interaction_=n.interaction,this.interaction_&&(this.interaction_.setActive(n.active),this.interaction_.on("change:active",function(){c.setActive(c.interaction_.getActive())})),n.toggleFn&&(n.onToggle=n.toggleFn),n.handleClick=function(){c.toggle(),n.onToggle&&n.onToggle.call(c,c.getActive())},n.className=(n.className||"")+" ol-toggle",ol.control.Button.call(this,n),this.set("title",n.title),this.set("autoActivate",n.autoActivate),n.bar&&this.setSubBar(n.bar),this.setActive(n.active),this.setDisable(n.disable)},ol.ext.inherits(ol.control.Toggle,ol.control.Button),ol.control.Toggle.prototype.setMap=function(n){!n&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),ol.control.Button.prototype.setMap.call(this,n),n&&(this.interaction_&&n.addInteraction(this.interaction_),this.subbar_&&n.addControl(this.subbar_))},ol.control.Toggle.prototype.getSubBar=function(){return this.subbar_},ol.control.Toggle.prototype.setSubBar=function(n){var c=this.getMap();c&&this.subbar_&&c.removeControl(this.subbar_),this.subbar_=n,n&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),c&&c.addControl(this.subbar_))},ol.control.Toggle.prototype.getDisable=function(){var n=this.element.querySelector("button");return n&&n.disabled},ol.control.Toggle.prototype.setDisable=function(n){this.getDisable()!=n&&(this.element.querySelector("button").disabled=n,n&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!n,disable:n}))},ol.control.Toggle.prototype.getActive=function(){return this.element.classList.contains("ol-active")},ol.control.Toggle.prototype.toggle=function(){this.getActive()?this.setActive(!1):this.setActive(!0)},ol.control.Toggle.prototype.setActive=function(n){this.interaction_&&this.interaction_.setActive(n),this.subbar_&&this.subbar_.setActive(n),this.getActive()!==n&&(n?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!n,active:n}))},ol.control.Toggle.prototype.setInteraction=function(n){this.interaction_=n},ol.control.Toggle.prototype.getInteraction=function(){return this.interaction_},ol.control.Search=function(n){var c=this;n||(n={}),n.typing==null&&(n.typing=300),this._classname=n.className||"search";var h=(n.className||"")+" ol-search"+(n.target?"":" ol-unselectable ol-control"),u=ol.ext.element.create("DIV",{className:h});if(n.collapsed!==!1&&u.classList.add("ol-collapsed"),n.target||(this.button=document.createElement("BUTTON"),this.button.setAttribute("type","button"),this.button.setAttribute("title",n.title||n.label||"Search"),this.button.addEventListener("click",function(){if(u.classList.toggle("ol-collapsed"),!u.classList.contains("ol-collapsed")){u.querySelector("input.search").focus();for(var F=u.querySelectorAll("li"),U=0;U<F.length;U++)F[U].classList.remove("select");x.value||c.drawList_()}}),u.appendChild(this.button)),n.inputLabel){var d=document.createElement("LABEL");d.innerText=n.inputLabel,u.appendChild(d)}var m,g="",x=this._input=document.createElement("INPUT");x.setAttribute("type","search"),x.setAttribute("class","search"),x.setAttribute("autocomplete","off"),x.setAttribute("placeholder",n.placeholder||"Search..."),x.addEventListener("change",function(F){c.dispatchEvent({type:"change:input",input:F,value:x.value})});var E=function(F){var U=u.querySelector("ul.autocomplete li.select"),A=x.value;if(F.key=="ArrowDown"||F.key=="ArrowUp"||F.key=="Down"||F.key=="Up")U?(U.classList.remove("select"),U=/Down/.test(F.key)?U.nextElementSibling:U.previousElementSibling,U&&U.classList.add("select")):u.querySelector("ul.autocomplete li").classList.add("select");else if(F.type=="input"&&!A)setTimeout(function(){c.drawList_()},200);else if(U&&(F.type=="search"||F.key=="Enter"))u.classList.contains("ol-control")&&x.blur(),U.classList.remove("select"),g=A,c._handleSelect(c._list[U.getAttribute("data-search")]);else if(F.type=="search"||F.key=="Enter"||g!=A&&n.typing>=0)if(g=A,g){m&&clearTimeout(m);var G=c.get("minLength");m=setTimeout(function(){if(g.length>=G){var B=c.autocomplete(g,function(O){c.drawList_(O)});B&&c.drawList_(B)}else c.drawList_()},n.typing)}else c.drawList_();else U=u.querySelector("ul.autocomplete li"),U&&U.classList.remove("select")};if(x.addEventListener("keyup",E),x.addEventListener("search",E),x.addEventListener("cut",E),x.addEventListener("paste",E),x.addEventListener("input",E),n.noCollapse||(x.addEventListener("blur",function(){setTimeout(function(){x!==document.activeElement&&(u.classList.add("ol-collapsed"),this.set("reverse",!1),u.classList.remove("ol-revers"))}.bind(this),200)}.bind(this)),x.addEventListener("focus",function(){this.get("reverse")||(u.classList.remove("ol-collapsed"),u.classList.remove("ol-revers"))}.bind(this))),u.appendChild(x),n.reverse){var P=ol.ext.element.create("BUTTON",{type:"button",class:"ol-revers",title:n.reverseTitle||"click on the map",click:function(){this.get("reverse")?this.set("reverse",!1):(this.set("reverse",!this.get("reverse")),x.focus(),u.classList.add("ol-revers"))}.bind(this)});u.appendChild(P)}var L=document.createElement("UL");L.classList.add("autocomplete"),u.appendChild(L),ol.control.Control.call(this,{element:u,target:n.target}),typeof n.getTitle=="function"&&(this.getTitle=n.getTitle),typeof n.autocomplete=="function"&&(this.autocomplete=n.autocomplete),this.set("copy",n.copy),this.set("minLength",n.minLength||1),this.set("maxItems",n.maxItems||10),this.set("maxHistory",n.maxHistory||n.maxItems||10),n.onselect&&this.on("select",n.onselect),n.centerOnSelect&&this.on("select",function(F){var U=this.getMap();U&&U.getView().setCenter(F.coordinate)}.bind(this)),n.zoomOnSelect&&this.on("select",function(F){var U=this.getMap();U&&(U.getView().setCenter(F.coordinate),U.getView().getZoom()<n.zoomOnSelect&&U.getView().setZoom(n.zoomOnSelect))}.bind(this)),this.restoreHistory(),this.drawList_()},ol.ext.inherits(ol.control.Search,ol.control.Control),ol.control.Search.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener=n.on("click",this._handleClick.bind(this)))},ol.control.Search.prototype.collapse=function(n){n===!1?this.element.classList.remove("ol-collapsed"):this.element.classList.add("ol-collapsed")},ol.control.Search.prototype.getInputField=function(){return this._input},ol.control.Search.prototype.getTitle=function(n){return n.name||"No title"},ol.control.Search.prototype._getTitleTxt=function(n){return ol.ext.element.create("DIV",{html:this.getTitle(n)}).innerText},ol.control.Search.prototype.search=function(){var n=this.element.querySelector("input.search");this._triggerCustomEvent("search",n)},ol.control.Search.prototype._handleClick=function(n){this.get("reverse")&&(document.activeElement.blur(),this.reverseGeocode(n.coordinate))},ol.control.Search.prototype.reverseGeocode=function(){},ol.control.Search.prototype._triggerCustomEvent=function(n,c){ol.ext.element.dispatchEvent(n,c)},ol.control.Search.prototype.setInput=function(n,c){var h=this.element.querySelector("input.search");h.value=n,c&&this._triggerCustomEvent("keyup",h)},ol.control.Search.prototype.select=function(n,c,h,u){var d={type:"select",search:n,reverse:!!c,coordinate:h};if(u)for(var m in u)d[m]=u[m];this.dispatchEvent(d)},ol.control.Search.prototype._handleSelect=function(n,c,h){if(n){var u=this.get("history"),d;try{var m=JSON.stringify(n);for(d=u.length-1;d>=0;d--)(!u[d]||JSON.stringify(u[d])===m)&&u.splice(d,1)}catch{for(d=u.length-1;d>=0;d--)u[d]===n&&u.splice(d,1)}u.unshift(n);for(var g=Math.max(0,this.get("maxHistory")||10)||0;u.length>g;)u.pop();this.saveHistory(),this.select(n,c,null,h),c&&(this.setInput(this._getTitleTxt(n)),this.drawList_(),setTimeout(function(){this.collapse(!1)}.bind(this),300))}},ol.control.Search.prototype._history={},ol.control.Search.prototype.saveHistory=function(){try{this.get("maxHistory")>=0?localStorage["ol@search-"+this._classname]=JSON.stringify(this.get("history")):localStorage.removeItem("ol@search-"+this._classname)}catch{console.warn("Failed to access localStorage...")}},ol.control.Search.prototype.restoreHistory=function(){if(this._history[this._classname])this.set("history",this._history[this._classname]);else try{this._history[this._classname]=JSON.parse(localStorage["ol@search-"+this._classname]),this.set("history",this._history[this._classname])}catch{this.set("history",[])}},ol.control.Search.prototype.clearHistory=function(){this.set("history",[]),this.saveHistory(),this.drawList_()},ol.control.Search.prototype.getHistory=function(){return this.get("history")},ol.control.Search.prototype.autocomplete=function(n,c){return c([]),!1},ol.control.Search.prototype.drawList_=function(n){var c=this,h=this.element.querySelector("ul.autocomplete");if(h.innerHTML="",this._list=[],n)h.setAttribute("class","autocomplete");else{var u=this.element.querySelector("input.search"),d=u.value;if(!d)n=this.get("history");else return;h.setAttribute("class","autocomplete history")}for(var m,g=Math.min(c.get("maxItems"),n.length),x=0;x<g;x++)if(n[x]&&(!x||!c.equalFeatures(n[x],n[x-1]))){m=document.createElement("LI"),m.setAttribute("data-search",this._list.length),this._list.push(n[x]),m.addEventListener("click",function(P){c._handleSelect(c._list[P.currentTarget.getAttribute("data-search")])});var E=c.getTitle(n[x]);E instanceof Element?m.appendChild(E):m.innerHTML=E,h.appendChild(m)}g&&this.get("copy")&&(m=document.createElement("LI"),m.classList.add("copy"),m.innerHTML=this.get("copy"),h.appendChild(m))},ol.control.Search.prototype.equalFeatures=function(){return!1},ol.control.SearchJSON=function(n){n=n||{},n.className=n.className||"JSON",delete n.autocomplete,n.minLength=n.minLength||3,n.typing=n.typing||800,ol.control.Search.call(this,n);var c=n.url||"";if(window.location.protocol==="https:"){var h=document.createElement("a");h.href=c,h.protocol=window.location.protocol,c=h.href}this.set("url",c),this._ajax=new ol.ext.Ajax({dataType:"JSON",auth:n.authentication}),this._ajax.on("success",function(u){u.status>=200&&u.status<400?typeof this._callback=="function"&&this._callback(u.response):typeof this._callback=="function"&&this._callback(!1,"error")}.bind(this)),this._ajax.on("error",function(){typeof this._callback=="function"&&this._callback(!1,"error")}.bind(this)),this._ajax.on("loadstart",function(){this.element.classList.add("searching")}.bind(this)),this._ajax.on("loadend",function(){this.element.classList.remove("searching")}.bind(this)),typeof n.handleResponse=="function"&&(this.handleResponse=n.handleResponse)},ol.ext.inherits(ol.control.SearchJSON,ol.control.Search),ol.control.SearchJSON.prototype.ajax=function(n,c,h,u){u=u||{},this._callback=h,this._ajax.set("dataType",u.dataType||"JSON"),this._ajax.send(n,c,u)},ol.control.SearchJSON.prototype.autocomplete=function(n,c){var h=this.requestData(n),u=encodeURI(this.get("url"));this.ajax(u,h,function(d){typeof c=="function"&&c(this.handleResponse(d))})},ol.control.SearchJSON.prototype.requestData=function(n){return{q:n}},ol.control.SearchJSON.prototype.handleResponse=function(n){return n},ol.control.SearchPhoton=function(n){n=n||{},n.className=n.className||"photon",n.url=n.url||"https://photon.komoot.io/api/",n.copy=n.copy||'<a href="http://www.openstreetmap.org/copyright" target="new">&copy; OpenStreetMap contributors</a>',ol.control.SearchJSON.call(this,n),this.set("lang",n.lang),this.set("position",n.position)},ol.ext.inherits(ol.control.SearchPhoton,ol.control.SearchJSON),ol.control.SearchPhoton.prototype.getTitle=function(n){var c=n.properties;return(c.housenumber||"")+" "+(c.street||c.name||"")+"<i> "+(c.postcode||"")+" "+(c.city||"")+" ("+c.country+")</i>"},ol.control.SearchPhoton.prototype.requestData=function(n){var c={q:n,lang:this.get("lang"),limit:this.get("maxItems")};if(this.get("position")){var h=this.getMap().getView(),u=new ol.geom.Point(h.getCenter());u=u.transform(h.getProjection(),"EPSG:4326").getCoordinates(),c.lon=u[0],c.lat=u[1]}return c},ol.control.SearchPhoton.prototype.handleResponse=function(n){return n.features},ol.control.SearchPhoton.prototype.equalFeatures=function(n,c){return this.getTitle(n)===this.getTitle(c)&&n.geometry.coordinates[0]===c.geometry.coordinates[0]&&n.geometry.coordinates[1]===c.geometry.coordinates[1]},ol.control.SearchPhoton.prototype.select=function(n){var c=n.geometry.coordinates;try{c=ol.proj.transform(n.geometry.coordinates,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.dispatchEvent({type:"select",search:n,coordinate:c})},ol.control.SearchPhoton.prototype.reverseData=function(n){var c=ol.proj.transform(n,this.getMap().getView().getProjection(),"EPSG:4326");return{lon:c[0],lat:c[1]}},ol.control.SearchPhoton.prototype.reverseGeocode=function(n,c){this.ajax(this.get("url").replace("/api/","/reverse/").replace("/search/","/reverse/"),this.reverseData(n),function(h){h.features&&(h=h.features),h instanceof Array||(h=[h]),c?c.call(this,h):this._handleSelect(h[0],!0)}.bind(this))},ol.control.SearchGeoportail=function(n){n=n||{},n.className=n.className||"IGNF",n.typing=n.typing||500,n.url="https://wxs.ign.fr/"+(n.apiKey||"essentiels")+"/ols/apis/completion",n.copy='<a href="https://www.geoportail.gouv.fr/" target="new">&copy; IGN-G\xE9oportail</a>',ol.control.SearchJSON.call(this,n),this.set("type",n.type||"StreetAddress,PositionOfInterest"),this.set("timeout",n.timeout||2e3)},ol.ext.inherits(ol.control.SearchGeoportail,ol.control.SearchJSON),ol.control.SearchGeoportail.prototype.reverseGeocode=function(n,c){var h=ol.proj.transform(n,this.getMap().getView().getProjection(),"EPSG:4326");this._handleSelect({x:h[0],y:h[1],fulltext:h[0].toFixed(6)+","+h[1].toFixed(6)},!0,c);var u=this.get("type")==="Commune"?"PositionOfInterest":this.get("type")||"StreetAddress";/,/.test(u)&&(u="StreetAddress");var d='<?xml version="1.0" encoding="UTF-8"?><XLS xmlns:xls="http://www.opengis.net/xls" xmlns:gml="http://www.opengis.net/gml" xmlns="http://www.opengis.net/xls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.2" xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"> <Request requestID="1" version="1.2" methodName="ReverseGeocodeRequest" maximumResponses="1" >  <ReverseGeocodeRequest>   <ReverseGeocodePreference>'+u+"</ReverseGeocodePreference>   <Position>    <gml:Point><gml:pos>"+h[1]+" "+h[0]+"</gml:pos></gml:Point>   </Position>  </ReverseGeocodeRequest> </Request></XLS>";this.ajax(this.get("url").replace("ols/apis/completion","geoportail/ols"),{xls:d},function(m){var g={};if(!m)g={x:h[0],y:h[1],fulltext:h[0].toFixed(6)+","+h[1].toFixed(6)};else{m=m.replace(/\n|\r/g,"");var x=m.replace(/.*<gml:pos>(.*)<\/gml:pos>.*/,"$1").split(" ");if(!Number(x[1])&&!Number(x[0]))g={x:h[0],y:h[1],fulltext:h[0].toFixed(6)+","+h[1].toFixed(6)};else if(g.x=h[0],g.y=h[1],g.city=m.replace(/.*<Place type="Municipality">([^<]*)<\/Place>.*/,"$1"),g.insee=m.replace(/.*<Place type="INSEE">([^<]*)<\/Place>.*/,"$1"),g.zipcode=m.replace(/.*<PostalCode>([^<]*)<\/PostalCode>.*/,"$1"),/<Street>/.test(m)){g.kind="",g.country="StreetAddress",g.street=m.replace(/.*<Street>([^<]*)<\/Street>.*/,"$1");var E=m.replace(/.*<Building number="([^"]*).*/,"$1");g.fulltext=E+" "+g.street+", "+g.zipcode+" "+g.city}else g.kind=m.replace(/.*<Place type="Nature">([^<]*)<\/Place>.*/,"$1"),g.country="PositionOfInterest",g.street="",g.fulltext=g.zipcode+" "+g.city}typeof c=="function"?c.call(this,[g]):(this.getHistory().shift(),this._handleSelect(g,!0,c))}.bind(this),{timeout:this.get("timeout"),dataType:"XML"})},ol.control.SearchGeoportail.prototype.getTitle=function(n){return n.fulltext},ol.control.SearchGeoportail.prototype.requestData=function(n){return{text:n,type:this.get("type")==="Commune"?"PositionOfInterest":this.get("type")||"StreetAddress,PositionOfInterest",maximumResponses:this.get("maxItems")}},ol.control.SearchGeoportail.prototype.handleResponse=function(n){var c=n.results;if(this.get("type")==="Commune")for(var h=c.length-1;h>=0;h--)c[h].kind&&(c[h].classification>5||c[h].kind=="D\xE9partement")&&c.splice(h,1);return c},ol.control.SearchGeoportail.prototype.select=function(n,c,h,u){if(n.x||n.y){var d=[Number(n.x),Number(n.y)];try{d=ol.proj.transform(d,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.get("type")==="Commune"?this.searchCommune(n,function(){ol.control.Search.prototype.select.call(this,n,c,d,u)}):ol.control.Search.prototype.select.call(this,n,c,d,u)}else this.searchCommune(n)},ol.control.SearchGeoportail.prototype.searchCommune=function(n,c){var h='<?xml version="1.0" encoding="UTF-8"?><XLS xmlns:xls="http://www.opengis.net/xls" xmlns:gml="http://www.opengis.net/gml" xmlns="http://www.opengis.net/xls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.2" xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"><RequestHeader/><Request requestID="1" version="1.2" methodName="LocationUtilityService"><GeocodeRequest returnFreeForm="false"><Address countryCode="PositionOfInterest"><freeFormAddress>'+n.zipcode+" "+n.city+"+</freeFormAddress></Address></GeocodeRequest></Request></XLS>";this.ajax(this.get("url").replace("ols/apis/completion","geoportail/ols"),{xls:h},function(u){if(u){var d=new DOMParser,m=d.parseFromString(u,"text/xml"),g=m.getElementsByTagName("GeocodedAddress")[0],x=g.getElementsByTagName("gml:Point")[0].textContent.trim().split(" ");n.x=Number(x[1]),n.y=Number(x[0]);for(var E=g.getElementsByTagName("Place"),P=0;P<E.length;P++)switch(E[P].attributes.type.value){case"Nature":n.kind=E[P].textContent;break;case"INSEE":n.insee=E[P].textContent;break}(n.x||n.y)&&(c?c.call(this,[n]):this._handleSelect(n))}}.bind(this),{dataType:"XML"})},ol.control.LayerSwitcher=function(n){n=n||{};var c=this;this.dcount=0,this.show_progress=n.show_progress,this.oninfo=typeof n.oninfo=="function"?n.oninfo:null,this.onextent=typeof n.onextent=="function"?n.onextent:null,this.hasextent=n.extent||n.onextent,this.hastrash=n.trash,this.reordering=n.reordering!==!1,this._layers=[],this._layerGroup=n.layerGroup&&n.layerGroup.getLayers?n.layerGroup:null,this.onchangeCheck=typeof n.onchangeCheck=="function"?n.onchangeCheck:null,typeof n.displayInLayerSwitcher=="function"&&(this.displayInLayerSwitcher=n.displayInLayerSwitcher);var h;n.target?h=ol.ext.element.create("DIV",{className:n.switcherClass||"ol-layerswitcher"}):(h=ol.ext.element.create("DIV",{className:(n.switcherClass||"ol-layerswitcher")+" ol-unselectable ol-control"}),n.collapsed!==!1?h.classList.add("ol-collapsed"):h.classList.add("ol-forceopen"),this.button=ol.ext.element.create("BUTTON",{type:"button",parent:h}),this.button.addEventListener("touchstart",function(u){h.classList.toggle("ol-forceopen"),h.classList.add("ol-collapsed"),c.dispatchEvent({type:"toggle",collapsed:h.classList.contains("ol-collapsed")}),u.preventDefault(),c.overflow()}),this.button.addEventListener("click",function(){h.classList.toggle("ol-forceopen"),h.classList.add("ol-collapsed"),c.dispatchEvent({type:"toggle",collapsed:!h.classList.contains("ol-forceopen")}),c.overflow()}),n.mouseover&&(h.addEventListener("mouseleave",function(){h.classList.add("ol-collapsed"),c.dispatchEvent({type:"toggle",collapsed:!0})}),h.addEventListener("mouseover",function(){h.classList.remove("ol-collapsed"),c.dispatchEvent({type:"toggle",collapsed:!1})})),n.minibar&&(n.noScroll=!0),n.noScroll||(this.topv=ol.ext.element.create("DIV",{className:"ol-switchertopdiv",parent:h,click:function(){c.overflow("+50%")}}),this.botv=ol.ext.element.create("DIV",{className:"ol-switcherbottomdiv",parent:h,click:function(){c.overflow("-50%")}})),this._noScroll=n.noScroll),this.panel_=ol.ext.element.create("UL",{className:"panel"}),this.panelContainer_=ol.ext.element.create("DIV",{className:"panel-container",html:this.panel_,parent:h}),!n.target&&!n.noScroll&&ol.ext.element.addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",function(u){c.overflow(Math.max(-1,Math.min(1,u.wheelDelta||-u.detail)))&&(u.stopPropagation(),u.preventDefault())}),this.header_=ol.ext.element.create("LI",{className:"ol-header",parent:this.panel_}),ol.control.Control.call(this,{element:h,target:n.target}),this.set("drawDelay",n.drawDelay||0),this.set("selection",n.selection),n.minibar&&setTimeout(function(){var u=ol.ext.element.scrollDiv(this.panelContainer_,{mousewheel:!0,vertical:!0,minibar:!0});this.on(["drawlist","toggle"],function(){u.refresh()})}.bind(this))},ol.ext.inherits(ol.control.LayerSwitcher,ol.control.Control),ol.control.LayerSwitcher.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"},ol.control.LayerSwitcher.prototype.displayInLayerSwitcher=function(n){return n.get("displayInLayerSwitcher")!==!1},ol.control.LayerSwitcher.prototype.setMap=function(n){if(ol.control.Control.prototype.setMap.call(this,n),this.drawPanel(),this._listener)for(var c in this._listener)ol.Observable.unByKey(this._listener[c]);this._listener=null,n&&(this._listener={moveend:n.on("moveend",this.viewChange.bind(this)),size:n.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=n.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))},ol.control.LayerSwitcher.prototype.show=function(){this.element.classList.add("ol-forceopen"),this.overflow(),self.dispatchEvent({type:"toggle",collapsed:!1})},ol.control.LayerSwitcher.prototype.hide=function(){this.element.classList.remove("ol-forceopen"),this.overflow(),self.dispatchEvent({type:"toggle",collapsed:!0})},ol.control.LayerSwitcher.prototype.toggle=function(){this.element.classList.toggle("ol-forceopen"),this.overflow()},ol.control.LayerSwitcher.prototype.isOpen=function(){return this.element.classList.contains("ol-forceopen")},ol.control.LayerSwitcher.prototype.setHeader=function(n){ol.ext.element.setHTML(this.header_,n)},ol.control.LayerSwitcher.prototype.overflow=function(n){if(this.button&&!this._noScroll){if(ol.ext.element.hidden(this.panel_)){ol.ext.element.setStyle(this.element,{height:"auto"});return}var c=ol.ext.element.outerHeight(this.element),h=ol.ext.element.outerHeight(this.panel_),u=this.button.offsetTop+ol.ext.element.outerHeight(this.button),d=this.panel_.offsetTop-u;if(h>c-u){ol.ext.element.setStyle(this.element,{height:"100%"});var m=this.panel_.querySelectorAll("li.visible .li-content")[0],g=m?2*ol.ext.element.getStyle(m,"height"):0;switch(n){case 1:d+=g;break;case-1:d-=g;break;case"+50%":d+=Math.round(c/2);break;case"-50%":d-=Math.round(c/2);break;default:break}return d+h<=c-3*u/2?(d=c-3*u/2-h,ol.ext.element.hide(this.botv)):ol.ext.element.show(this.botv),d>=0?(d=0,ol.ext.element.hide(this.topv)):ol.ext.element.show(this.topv),ol.ext.element.setStyle(this.panel_,{top:d+"px"}),!0}else return ol.ext.element.setStyle(this.element,{height:"auto"}),ol.ext.element.setStyle(this.panel_,{top:0}),ol.ext.element.hide(this.botv),ol.ext.element.hide(this.topv),!1}else return!1},ol.control.LayerSwitcher.prototype._setLayerForLI=function(n,c){var h=[];c.getLayers&&h.push(c.getLayers().on("change:length",this.drawPanel.bind(this))),n&&(h.push(c.on("change:opacity",function(){this.setLayerOpacity(c,n)}.bind(this))),h.push(c.on("change:visible",function(){this.setLayerVisibility(c,n)}.bind(this)))),h.push(c.on("propertychange",function(u){(u.key==="displayInLayerSwitcher"||u.key==="openInLayerSwitcher"||u.key==="title"||u.key==="name")&&this.drawPanel(u)}.bind(this))),this._layers.push({li:n,layer:c,listeners:h})},ol.control.LayerSwitcher.prototype.setLayerOpacity=function(n,c){var h=c.querySelector(".layerswitcher-opacity-cursor");h&&(h.style.left=n.getOpacity()*100+"%"),this.dispatchEvent({type:"layer:opacity",layer:n})},ol.control.LayerSwitcher.prototype.setLayerVisibility=function(n,c){var h=c.querySelector(".ol-visibility");h&&(h.checked=n.getVisible()),n.getVisible()?c.classList.add("ol-visible"):c.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:n})},ol.control.LayerSwitcher.prototype._clearLayerForLI=function(){this._layers.forEach(function(n){n.listeners.forEach(function(c){ol.Observable.unByKey(c)})}),this._layers=[]},ol.control.LayerSwitcher.prototype._getLayerForLI=function(n){for(var c=0,h;h=this._layers[c];c++)if(h.li===n)return h.layer;return null},ol.control.LayerSwitcher.prototype.viewChange=function(){this.panel_.querySelectorAll("li").forEach(function(n){var c=this._getLayerForLI(n);c&&(this.testLayerVisibility(c)?n.classList.remove("ol-layer-hidden"):n.classList.add("ol-layer-hidden"))}.bind(this))},ol.control.LayerSwitcher.prototype.getPanel=function(){return this.panelContainer_},ol.control.LayerSwitcher.prototype.drawPanel=function(){if(this.getMap()){var n=this;this.dcount++,setTimeout(function(){n.drawPanel_()},this.get("drawDelay")||0)}},ol.control.LayerSwitcher.prototype.drawPanel_=function(){if(!(--this.dcount||this.dragging_)){var n=this.panelContainer_.scrollTop;this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach(function(c){c.classList.contains("ol-header")||c.remove()}.bind(this)),this._layerGroup?this.drawList(this.panel_,this._layerGroup.getLayers()):this.getMap()&&this.drawList(this.panel_,this.getMap().getLayers()),this.panelContainer_.scrollTop=n}},ol.control.LayerSwitcher.prototype.switchLayerVisibility=function(n,c){n.get("baseLayer")?(n.getVisible()||n.setVisible(!0),c.forEach(function(h){n!==h&&h.get("baseLayer")&&h.getVisible()&&h.setVisible(!1)})):n.setVisible(!n.getVisible())},ol.control.LayerSwitcher.prototype.testLayerVisibility=function(n){if(!this.getMap())return!0;var c=this.getMap().getView().getResolution(),h=this.getMap().getView().getZoom();if(n.getMaxResolution()<=c||n.getMinResolution()>=c)return!1;if(n.getMinZoom&&(n.getMinZoom()>=h||n.getMaxZoom()<h))return!1;var u=n.getExtent();if(u){var d=this.getMap().getView().calculateExtent(this.getMap().getSize());return ol.extent.intersects(d,u)}return!0},ol.control.LayerSwitcher.prototype.dragOrdering_=function(n){n.stopPropagation(),n.preventDefault();var c=this,h=n.currentTarget.parentNode.parentNode,u=!0,d=this.panel_,m,g=n.pageY||n.touches&&n.touches.length&&n.touches[0].pageY||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageY,x,E,P,L;h.parentNode.classList.add("drag");function F(){if(x){var A=P,G=c.getSelection()===A;if(A&&x){var B;L?B=L.getLayers():B=c._layerGroup?c._layerGroup.getLayers():c.getMap().getLayers();for(var O=B.getArray(),K=0;K<O.length;K++)if(O[K]==A){B.removeAt(K);break}for(var Q=0;Q<O.length;Q++)if(O[Q]===x){K>Q?B.insertAt(Q,A):B.insertAt(Q+1,A);break}}G&&c.selectLayer(A),c.dispatchEvent({type:"reorder-end",layer:A,group:L})}h.parentNode.querySelectorAll("li").forEach(function(et){et.classList.remove("dropover"),et.classList.remove("dropover-after"),et.classList.remove("dropover-before")}),h.classList.remove("drag"),h.parentNode.classList.remove("drag"),c.element.classList.remove("drag"),E&&E.remove(),ol.ext.element.removeListener(document,"mousemove touchmove",U),ol.ext.element.removeListener(document,"mouseup touchend touchcancel",F)}function U(A){if(m=A.pageY||A.touches&&A.touches.length&&A.touches[0].pageY||A.changedTouches&&A.changedTouches.length&&A.changedTouches[0].pageY,u&&Math.abs(g-m)>2&&(u=!1,h.classList.add("drag"),P=c._getLayerForLI(h),x=!1,L=c._getLayerForLI(h.parentNode.parentNode),E=ol.ext.element.create("LI",{className:"ol-dragover",html:h.innerHTML,style:{position:"absolute","z-index":1e4,left:h.offsetLeft,opacity:.5,width:ol.ext.element.outerWidth(h),height:ol.ext.element.getStyle(h,"height")},parent:d}),c.element.classList.add("drag"),c.dispatchEvent({type:"reorder-start",layer:P,group:L})),!u){A.preventDefault(),A.stopPropagation(),ol.ext.element.setStyle(E,{top:m-ol.ext.element.offsetRect(d).top+d.scrollTop+5});var G;for(A.touches?G=document.elementFromPoint(A.touches[0].clientX,A.touches[0].clientY):G=A.target,G.classList.contains("ol-switcherbottomdiv")?c.overflow(-1):G.classList.contains("ol-switchertopdiv")&&c.overflow(1);G&&G.tagName!=="LI";)G=G.parentNode;(!G||!G.classList.contains("dropover"))&&h.parentNode.querySelectorAll("li").forEach(function(B){B.classList.remove("dropover"),B.classList.remove("dropover-after"),B.classList.remove("dropover-before")}),G&&G.parentNode.classList.contains("drag")&&G!==h?(x=c._getLayerForLI(G),x&&!x.get("allwaysOnTop")==!P.get("allwaysOnTop")?(G.classList.add("dropover"),G.classList.add(h.offsetTop<G.offsetTop?"dropover-after":"dropover-before")):x=!1,ol.ext.element.show(E)):(x=!1,G===h?ol.ext.element.hide(E):ol.ext.element.show(E)),x?E.classList.remove("forbidden"):E.classList.add("forbidden")}}ol.ext.element.addListener(document,"mousemove touchmove",U),ol.ext.element.addListener(document,"mouseup touchend touchcancel",F)},ol.control.LayerSwitcher.prototype.dragOpacity_=function(n){n.stopPropagation(),n.preventDefault();var c=this,h=n.target,u=this._getLayerForLI(h.parentNode.parentNode.parentNode);if(!u)return;var d=n.pageX||n.touches&&n.touches.length&&n.touches[0].pageX||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageX,m=ol.ext.element.getStyle(h,"left")-d;c.dragging_=!0;function g(){ol.ext.element.removeListener(document,"mouseup touchend touchcancel",g),ol.ext.element.removeListener(document,"mousemove touchmove",x),c.dragging_=!1}function x(E){var P=E.pageX||E.touches&&E.touches.length&&E.touches[0].pageX||E.changedTouches&&E.changedTouches.length&&E.changedTouches[0].pageX,L=(m+P)/ol.ext.element.getStyle(h.parentNode,"width"),F=Math.max(0,Math.min(1,L));ol.ext.element.setStyle(h,{left:F*100+"%"}),h.parentNode.nextElementSibling.innerHTML=Math.round(F*100),u.setOpacity(F)}ol.ext.element.addListener(document,"mouseup touchend touchcancel",g),ol.ext.element.addListener(document,"mousemove touchmove",x)},ol.control.LayerSwitcher.prototype.drawList=function(n,c){var h=this,u=c.getArray(),d=function(L){L.stopPropagation(),L.preventDefault();var F=h._getLayerForLI(this.parentNode.parentNode);h.switchLayerVisibility(F,c),h.get("selection")&&F.getVisible()&&h.selectLayer(F),h.onchangeCheck&&h.onchangeCheck(F)};function m(L){L.stopPropagation(),L.preventDefault();var F=h._getLayerForLI(this.parentNode.parentNode);h.oninfo(F),h.dispatchEvent({type:"info",layer:F})}function g(L){L.stopPropagation(),L.preventDefault();var F=h._getLayerForLI(this.parentNode.parentNode);h.onextent?h.onextent(F):h.getMap().getView().fit(F.getExtent(),h.getMap().getSize()),h.dispatchEvent({type:"extent",layer:F})}function x(L){L.stopPropagation(),L.preventDefault();var F=this.parentNode.parentNode.parentNode.parentNode,U,A=h._getLayerForLI(F);A?(U=h._getLayerForLI(this.parentNode.parentNode),A.getLayers().remove(U),A.getLayers().getLength()==0&&!A.get("noSwitcherDelete")&&x.call(F.querySelectorAll(".layerTrash")[0],L)):(F=this.parentNode.parentNode,h.getMap().removeLayer(h._getLayerForLI(F)))}function E(L){if(!this.displayInLayerSwitcher(L)){this._setLayerForLI(null,L);return}var F=ol.ext.element.create("LI",{className:(L.getVisible()?"visible ":" ")+(L.get("baseLayer")?"baselayer":""),parent:n});this._setLayerForLI(F,L),this._selectedLayer===L&&F.classList.add("ol-layer-select");var U=ol.ext.element.create("DIV",{className:"ol-layerswitcher-buttons",parent:F}),A=ol.ext.element.create("DIV",{className:"li-content",parent:F});ol.ext.element.create("INPUT",{type:L.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:L.getVisible(),click:d,parent:A});var G=ol.ext.element.create("LABEL",{title:L.get("title")||L.get("name"),click:d,unselectable:"on",style:{userSelect:"none"},parent:A});if(G.addEventListener("selectstart",function(){return!1}),ol.ext.element.create("SPAN",{html:L.get("title")||L.get("name"),click:function(lt){this.get("selection")&&(lt.stopPropagation(),this.selectLayer(L))}.bind(this),parent:G}),this.reordering&&(P<u.length-1&&(L.get("allwaysOnTop")||!u[P+1].get("allwaysOnTop"))||P>0&&(!L.get("allwaysOnTop")||u[P-1].get("allwaysOnTop")))&&ol.ext.element.create("DIV",{className:"layerup ol-noscroll",title:this.tip.up,on:{"mousedown touchstart":function(lt){h.dragOrdering_(lt)}},parent:U}),L.getLayers){var B=0;L.getLayers().forEach(function(lt){h.displayInLayerSwitcher(lt)&&B++}),B&&ol.ext.element.create("DIV",{className:L.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var lt=h._getLayerForLI(this.parentNode.parentNode);lt.set("openInLayerSwitcher",!lt.get("openInLayerSwitcher"))},parent:U})}if(this.oninfo&&ol.ext.element.create("DIV",{className:"layerInfo",title:this.tip.info,click:m,parent:U}),this.hastrash&&!L.get("noSwitcherDelete")&&ol.ext.element.create("DIV",{className:"layerTrash",title:this.tip.trash,click:x,parent:U}),this.hasextent&&u[P].getExtent()){var O=u[P].getExtent();O.length==4&&O[0]<O[2]&&O[1]<O[3]&&ol.ext.element.create("DIV",{className:"layerExtent",title:this.tip.extent,click:g,parent:U})}if(this.show_progress&&L instanceof ol.layer.Tile){var K=ol.ext.element.create("DIV",{className:"layerswitcher-progress",parent:A});this.setprogress_(L),L.layerswitcher_progress=ol.ext.element.create("DIV",{parent:K})}var Q=ol.ext.element.create("DIV",{className:"layerswitcher-opacity",click:function(lt){if(lt.target===this){lt.stopPropagation(),lt.preventDefault();var pt=Math.max(0,Math.min(1,lt.offsetX/ol.ext.element.getStyle(this,"width")));h._getLayerForLI(this.parentNode.parentNode).setOpacity(pt)}},parent:A});if(ol.ext.element.create("DIV",{className:"layerswitcher-opacity-cursor ol-noscroll",style:{left:L.getOpacity()*100+"%"},on:{"mousedown touchstart":function(lt){h.dragOpacity_(lt)}},parent:Q}),ol.ext.element.create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(L.getOpacity()*100),parent:A}),L.getLayers&&(F.classList.add("ol-layer-group"),L.get("openInLayerSwitcher")===!0)){var et=ol.ext.element.create("UL",{parent:F});this.drawList(et,L.getLayers())}F.classList.add(this.getLayerClass(L)),this.dispatchEvent({type:"drawlist",layer:L,li:F})}for(var P=u.length-1;P>=0;P--)E.call(this,u[P]);this.viewChange(),n===this.panel_&&this.overflow()},ol.control.LayerSwitcher.prototype.getLayerClass=function(n){return n?n.getLayers?"ol-layer-group":n instanceof ol.layer.Vector?"ol-layer-vector":n instanceof ol.layer.VectorTile?"ol-layer-vectortile":n instanceof ol.layer.Tile?"ol-layer-tile":n instanceof ol.layer.Image?"ol-layer-image":n instanceof ol.layer.Heatmap?"ol-layer-heatmap":n.getFeatures?"ol-layer-vectorimage":"unknown":"none"},ol.control.LayerSwitcher.prototype.selectLayer=function(n,c){if(!n){if(!this.getMap())return;n=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=n,this.drawPanel(),c||this.dispatchEvent({type:"select",layer:n})},ol.control.LayerSwitcher.prototype.getSelection=function(){return this._selectedLayer},ol.control.LayerSwitcher.prototype.setprogress_=function(n){if(!n.layerswitcher_progress){var c=0,h=0,u=function(){h===c?(h=c=0,ol.ext.element.setStyle(n.layerswitcher_progress,{width:0})):ol.ext.element.setStyle(n.layerswitcher_progress,{width:(c/h*100).toFixed(1)+"%"})};n.getSource().on("tileloadstart",function(){h++,u()}),n.getSource().on("tileloadend",function(){c++,u()}),n.getSource().on("tileloaderror",function(){c++,u()})}},ol.control.Bar=function(n){n||(n={});var c=document.createElement("div");if(c.classList.add("ol-unselectable","ol-control","ol-bar"),n.className){var h=n.className.split(" ").filter(function(d){return d.length>0});c.classList.add.apply(c.classList,h)}if(n.group&&c.classList.add("ol-group"),ol.control.Control.call(this,{element:c,target:n.target}),this.set("toggleOne",n.toggleOne),this.set("autoDeactivate",n.autoDeactivate),this.controls_=[],n.controls instanceof Array)for(var u=0;u<n.controls.length;u++)this.addControl(n.controls[u])},ol.ext.inherits(ol.control.Bar,ol.control.Control),ol.control.Bar.prototype.setVisible=function(n){n?this.element.style.display="":this.element.style.display="none"},ol.control.Bar.prototype.getVisible=function(){return this.element.style.display!="none"},ol.control.Bar.prototype.setMap=function(n){ol.control.Control.prototype.setMap.call(this,n);for(var c=0;c<this.controls_.length;c++){var h=this.controls_[c];h.setMap(n)}},ol.control.Bar.prototype.getControls=function(){return this.controls_},ol.control.Bar.prototype.setPosition=function(n){this.element.classList.remove("ol-left","ol-top","ol-bottom","ol-right"),n=n.split("-");for(var c=0;c<n.length;c++)switch(n[c]){case"top":case"left":case"bottom":case"right":this.element.classList.add("ol-"+n[c]);break;default:break}},ol.control.Bar.prototype.addControl=function(n){this.controls_.push(n),n.setTarget(this.element),this.getMap()&&this.getMap().addControl(n),n.on("change:active",function(c){this.onActivateControl_(c,n)}.bind(this)),n.getActive&&this.onActivateControl_({target:n,active:n.getActive()},n)},ol.control.Bar.prototype.deactivateControls=function(n){for(var c=0;c<this.controls_.length;c++)this.controls_[c]!==n&&this.controls_[c].setActive&&this.controls_[c].setActive(!1)},ol.control.Bar.prototype.getActiveControls=function(){for(var n=[],c=0,h;h=this.controls_[c];c++)h.getActive&&h.getActive()&&n.push(h);return n},ol.control.Bar.prototype.setActive=function(n){if(!n&&this.get("autoDeactivate")&&this.deactivateControls(),n)for(var c=this.getControls(),h=0,u;u=c[h];h++)u.get("autoActivate")&&u.setActive(!0)},ol.control.Bar.prototype.onActivateControl_=function(n,c){if(this.get("toggleOne")){if(n.active){var h;for(h=0;h<this.controls_.length&&this.controls_[h]!==c;h++);if(h==this.controls_.length)return;this.deactivateControls(this.controls_[h])}else if(!this.getActiveControls().length){for(var u=0,d;d=this.controls_[u];u++)if(d.get("autoActivate")){d.setActive(!0);break}}}},ol.control.Bar.prototype.getControlsByName=function(n){var c=this.getControls();return c.filter(function(h){return h.get("name")===n})},ol.control.CanvasAttribution=function(n){n||(n={}),ol.control.Attribution.call(this,n),this.element.classList.add("ol-canvas-control"),this.setCanvas(!!n.canvas),n||(n={}),n.style||(n.style=new ol.style.Style),this.setStyle(n.style)},ol.ext.inherits(ol.control.CanvasAttribution,ol.control.Attribution),ol.control.CanvasAttribution.prototype.setCanvas=function(n){if(this.isCanvas_=n,n&&this.setCollapsed(!1),this.element.style.visibility=n?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.CanvasAttribution.prototype.getContext=ol.control.CanvasBase.prototype.getContext,ol.control.CanvasAttribution.prototype.setStyle=function(n){var c=n.getText();this.font_=c?c.getFont():"10px sans-serif";var h=c?c.getStroke():null,u=c?c.getFill():null;this.fontStrokeStyle_=h?ol.color.asString(h.getColor()):"#fff",this.fontFillStyle_=u?ol.color.asString(u.getColor()):"#000",this.fontStrokeWidth_=h?h.getWidth():3,this.getMap()&&this.getMap().render()},ol.control.CanvasAttribution.prototype.setMap=function(n){ol.control.CanvasBase.prototype.getCanvas.call(this,n);var c=this.getMap();if(this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.Attribution.prototype.setMap.call(this,n),c)try{c.renderSync()}catch{}n&&(this._listener=n.on("postcompose",this.drawAttribution_.bind(this))),this.setCanvas(this.isCanvas_)},ol.control.CanvasAttribution.prototype.drawAttribution_=function(n){if(this.isCanvas_){var c=this.getContext(n);if(c){var h="";Array.prototype.slice.call(this.element.querySelectorAll("li")).filter(function(F){return F.style.display!=="none"}).map(function(F){h+=(h?" - ":"")+F.textContent});var u=n.frameState.pixelRatio;c.save(),c.scale(u,u);var d=this.element.getBoundingClientRect(),m=this.getMap().getViewport().getBoundingClientRect(),g=this.getMap().getSize()[0]/m.width;c.translate((d.left-m.left)*g,(d.top-m.top)*g);var x=this.element.clientHeight,E=this.element.clientWidth,P=ol.ext.element.getStyle(this.element,"textAlign")||"center",L;switch(P){case"left":{L=0;break}case"right":{L=E;break}default:{L=E/2;break}}c.beginPath(),c.strokeStyle=this.fontStrokeStyle_,c.fillStyle=this.fontFillStyle_,c.lineWidth=this.fontStrokeWidth_,c.textAlign=P,c.textBaseline="middle",c.font=this.font_,c.strokeText(h,L,x/2),c.fillText(h,L,x/2),c.closePath(),c.restore()}}},ol.control.CanvasScaleLine=function(n){ol.control.ScaleLine.call(this,n),this.element.classList.add("ol-canvas-control"),this.scaleHeight_=6,n||(n={}),n.style||(n.style=new ol.style.Style),this.setStyle(n.style)},ol.ext.inherits(ol.control.CanvasScaleLine,ol.control.ScaleLine),ol.control.CanvasScaleLine.prototype.getContext=ol.control.CanvasBase.prototype.getContext,ol.control.CanvasScaleLine.prototype.setMap=function(n){ol.control.CanvasBase.prototype.getCanvas.call(this,n);var c=this.getMap();if(this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.ScaleLine.prototype.setMap.call(this,n),c)try{c.renderSync()}catch{}n&&(this._listener=n.on("postcompose",this.drawScale_.bind(this))),this.element.style.visibility="hidden",this.olscale=this.element.querySelector(".ol-scale-line-inner")},ol.control.CanvasScaleLine.prototype.setStyle=function(n){var c=n.getStroke();this.strokeStyle_=c?ol.color.asString(c.getColor()):"#000",this.strokeWidth_=c?c.getWidth():2;var h=n.getFill();this.fillStyle_=h?ol.color.asString(h.getColor()):"#fff";var u=n.getText();this.font_=u?u.getFont():"10px Arial",c=u?u.getStroke():null,h=u?u.getFill():null,this.fontStrokeStyle_=c?ol.color.asString(c.getColor()):this.fillStyle_,this.fontStrokeWidth_=c?c.getWidth():3,this.fontFillStyle_=h?ol.color.asString(h.getColor()):this.strokeStyle_,this.getMap()&&this.getMap().render()},ol.control.CanvasScaleLine.prototype.drawScale_=function(n){if(!(this.element.style.visibility!=="hidden"||ol.ext.element.getStyle(this.element,"display")==="none")){var c=this.getContext(n);if(c){var h=parseInt(this.olscale.style.width);if(h){var u=this.olscale.textContent,d={left:this.element.offsetLeft,top:this.element.offsetTop},m=n.frameState.pixelRatio;c.save(),c.scale(m,m),d.top+=this.element.clientHeight-this.scaleHeight_,c.beginPath(),c.strokeStyle=this.fontStrokeStyle_,c.fillStyle=this.fontFillStyle_,c.lineWidth=this.fontStrokeWidth_,c.textAlign="center",c.textBaseline="bottom",c.font=this.font_,c.strokeText(u,d.left+h/2,d.top),c.fillText(u,d.left+h/2,d.top),c.closePath(),d.top+=2,c.lineWidth=this.strokeWidth_,c.strokeStyle=this.strokeStyle_;for(var g=4,x=parseInt(u);x%10===0;)x/=10;x%5===0&&(g=5);for(var E=0;E<g;E++)c.beginPath(),c.fillStyle=E%2?this.fillStyle_:this.strokeStyle_,c.rect(d.left+E*h/g,d.top,h/g,this.scaleHeight_),c.stroke(),c.fill(),c.closePath();c.restore()}}}},ol.control.CanvasTitle=function(n){n||(n={});var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-control-title ol-unselectable",style:{display:"block",visibility:"hidden"}});ol.control.CanvasBase.call(this,{element:c,style:n.style}),this.setTitle(n.title||""),this.setVisible(n.visible),this.element.style.font=this.getTextFont()},ol.ext.inherits(ol.control.CanvasTitle,ol.control.CanvasBase),ol.control.CanvasTitle.prototype.setStyle=function(n){ol.control.CanvasBase.prototype.setStyle.call(this,n),this.element&&(this.element.style.font=this.getTextFont()),this.getMap()&&this.getMap().render()},ol.control.CanvasTitle.prototype.setTitle=function(n){if(this.element.textContent=n,this.set("title",n),this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.CanvasTitle.prototype.getTitle=function(){return this.get("title")},ol.control.CanvasTitle.prototype.setVisible=function(n){if(this.element.style.display=n?"block":"none",this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.CanvasTitle.prototype.getVisible=function(){return this.element.style.display!=="none"},ol.control.CanvasTitle.prototype._draw=function(n){if(this.getVisible()){var c=this.getContext(n);if(c){var h=n.frameState.pixelRatio;c.save(),c.scale(h,h);var u=this.element.getBoundingClientRect(),d=this.getMap().getViewport().getBoundingClientRect(),m=this.getMap().getSize()[0]/d.width;c.translate(Math.round((u.left-d.left)*m),Math.round((u.top-d.top)*m));var g=this.element.clientHeight,x=this.element.clientWidth,E=x/2;c.beginPath(),c.fillStyle=ol.color.asString(this.getFill().getColor()),c.rect(0,0,x,g),c.fill(),c.closePath(),c.beginPath(),c.fillStyle=ol.color.asString(this.getTextFill().getColor()),c.strokeStyle=ol.color.asString(this.getTextStroke().getColor()),c.lineWidth=this.getTextStroke().getWidth(),c.textAlign="center",c.textBaseline="middle",c.font=this.getTextFont(),c.lineWidth&&c.strokeText(this.getTitle(),E,g/2),c.fillText(this.getTitle(),E,g/2),c.closePath(),c.restore()}}},ol.control.CenterPosition=function(n){n||(n={});var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-center-position ol-unselectable",style:{display:"block",visibility:"hidden"}});ol.control.CanvasBase.call(this,{element:c,style:n.style}),this.element.style.font=this.getTextFont(),this.set("projection",n.projection),this.setCanvas(n.canvas),this._format=typeof n.coordinateFormat=="function"?n.coordinateFormat:ol.coordinate.toStringXY},ol.ext.inherits(ol.control.CenterPosition,ol.control.CanvasBase),ol.control.CenterPosition.prototype.setStyle=function(n){ol.control.CanvasBase.prototype.setStyle.call(this,n),this.element&&(this.element.style.font=this.getTextFont()),this.getMap()&&this.getMap().render()},ol.control.CenterPosition.prototype.setCanvas=function(n){if(this.set("canvas",n),this.element.style.visibility=n?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.CenterPosition.prototype.setVisible=function(n){if(this.element.style.display=n?"":"none",this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.CenterPosition.prototype.getVisible=function(){return this.element.style.display!=="none"},ol.control.CenterPosition.prototype._draw=function(n){if(!(!this.getVisible()||!this.getMap())){var c=this.getMap().getView().getCenter();if(this.get("projection")&&(c=ol.proj.transform(c,this.getMap().getView().getProjection(),this.get("projection"))),c=this._format(c),this.element.textContent=c,!!this.get("canvas")){var h=this.getContext(n);if(h){var u=n.frameState.pixelRatio;h.save(),h.scale(u,u);var d=this.element.getBoundingClientRect(),m=this.getMap().getViewport().getBoundingClientRect(),g=this.getMap().getSize()[0]/m.width;h.translate((d.left-m.left)*g,(d.top-m.top)*g);var x=this.element.clientHeight,E=this.element.clientWidth;h.beginPath(),h.fillStyle=ol.color.asString(this.getTextFill().getColor()),h.strokeStyle=ol.color.asString(this.getTextStroke().getColor()),h.lineWidth=this.getTextStroke().getWidth(),h.textAlign="center",h.textBaseline="middle",h.font=this.getTextFont(),h.lineWidth&&h.strokeText(c,E/2,x/2),h.fillText(c,E/2,x/2),h.closePath(),h.restore()}}}},ol.control.Compass=function(n){n||(n={});var c=document.createElement("div");c.className="ol-control ol-compassctrl ol-unselectable ol-hidden"+(n.className?" "+n.className:""),c.style.position="absolute",c.style.visibility="hidden";var h=n.style instanceof ol.style.Stroke?new ol.style.Style({stroke:n.style}):n.style;n.style||(h=new ol.style.Style({stroke:new ol.style.Stroke({width:0})})),ol.control.CanvasBase.call(this,{element:c,style:h}),this.set("rotateVithView",n.rotateWithView!==!1),this.setVisible(n.visible!==!1),this.setImage(n.image||n.src)},ol.ext.inherits(ol.control.Compass,ol.control.CanvasBase),ol.control.Compass.prototype.setImage=function(n){if(n instanceof Image)this.img_=n,this.img_.onload=function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}.bind(this);else if(typeof n=="string")switch(n){case"compact":{this.img_=this.compactCompass_(this.element.clientWidth,this.getStroke().getColor());break}case"default":{this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor());break}default:{this.img_=new Image,this.img_.onload=function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}.bind(this),this.img_.src=n;break}}else this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor())},ol.control.Compass.prototype.compactCompass_=function(n,c){var h=document.createElement("canvas"),u=h.getContext("2d");n=h.width=h.height=n||150;var d=n/2;return u.translate(d,d),u.fillStyle=c||"#963",u.lineWidth=5,u.lineJoin=u.lineCap="round",u.font="bold "+d*.4+"px sans-serif",u.textBaseline="bottom",u.textAlign="center",u.strokeStyle="#fff",u.globalAlpha=.75,u.strokeText("N",0,-d/2),u.globalAlpha=1,u.fillText("N",0,-d/2),u.beginPath(),u.moveTo(0,d/4),u.lineTo(d/3,d/2),u.lineTo(0,-d/2),u.lineTo(-d/3,d/2),u.lineTo(0,d/4),u.lineWidth=12,u.fillStyle="#fff",u.globalAlpha=.75,u.fill(),u.stroke(),u.globalAlpha=1,u.fillStyle=u.strokeStyle=c||"#963",u.lineWidth=5,u.beginPath(),u.moveTo(0,d/4),u.lineTo(0,-d/2),u.lineTo(d/3,d/2),u.lineTo(0,d/4),u.fill(),u.stroke(),u.beginPath(),u.moveTo(0,d/4),u.lineTo(0,-d/2),u.lineTo(-d/3,d/2),u.lineTo(0,d/4),u.stroke(),h},ol.control.Compass.prototype.defaultCompass_=function(n,c){var h=document.createElement("canvas"),u=h.getContext("2d");n=h.width=h.height=n||150;var d=n/2,m=.22*d;function g(E,P){u.fillStyle=c||"#963",u.beginPath(),u.moveTo(0,0),u.lineTo(E,0),u.lineTo(P,P),u.moveTo(0,0),u.lineTo(-E,0),u.lineTo(-P,-P),u.moveTo(0,0),u.lineTo(0,E),u.lineTo(-P,P),u.moveTo(0,0),u.lineTo(0,-E),u.lineTo(P,-P),u.moveTo(0,0),u.fill(),u.stroke()}function x(E,P){u.globalCompositeOperation="destination-out",u.fillStyle="#fff",u.beginPath(),u.moveTo(0,0),u.lineTo(E,0),u.lineTo(P,-P),u.moveTo(0,0),u.lineTo(-E,0),u.lineTo(-P,P),u.moveTo(0,0),u.lineTo(0,E),u.lineTo(P,P),u.moveTo(0,0),u.lineTo(0,-E),u.lineTo(-P,-P),u.moveTo(0,0),u.fill(),u.globalCompositeOperation="source-over",u.beginPath(),u.moveTo(0,0),u.lineTo(E,0),u.lineTo(P,-P),u.moveTo(0,0),u.lineTo(-E,0),u.lineTo(-P,P),u.moveTo(0,0),u.lineTo(0,E),u.lineTo(P,P),u.moveTo(0,0),u.lineTo(0,-E),u.lineTo(-P,-P),u.moveTo(0,0),u.stroke()}return u.translate(d,d),u.strokeStyle=c||"#963",u.lineWidth=1.5,u.beginPath(),u.arc(0,0,n*.41,0,2*Math.PI),u.arc(0,0,n*.44,0,2*Math.PI),u.stroke(),u.rotate(Math.PI/4),g(d*.9,m*.8),x(d*.9,m*.8),u.rotate(-Math.PI/4),g(d,m),x(d,m),h},ol.control.Compass.prototype.getVisible=function(){return ol.ext.element.getStyle(this.element,"display")==="block"},ol.control.Compass.prototype.setVisible=function(n){n?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible"),this.getMap()&&this.getMap().render()},ol.control.Compass.prototype._draw=function(n){var c=this.getContext(n);if(!(!c||!this.getVisible())){var h=c.canvas,u,d=[];for(u=0;u<8;u++)d[u]=[Math.cos(Math.PI*u/8),Math.sin(Math.PI*u/8)];var m=n.frameState.pixelRatio;c.save(),c.scale(m,m);var g=this.element.clientWidth,x=this.element.clientHeight,E={left:this.element.offsetLeft,top:this.element.offsetTop},P=this.img_,L=n.frameState.viewState.rotation;if(c.beginPath(),c.translate(E.left+g/2,E.top+x/2),this.get("rotateVithView")&&c.rotate(L),this.getStroke().getWidth()){c.beginPath(),c.strokeStyle=this.getStroke().getColor(),c.lineWidth=this.getStroke().getWidth();var F=Math.max(h.width,h.height);for(u=0;u<8;u++)c.moveTo(-d[u][0]*F,-d[u][1]*F),c.lineTo(d[u][0]*F,d[u][1]*F);c.stroke()}P.width&&c.drawImage(P,-g/2,-x/2,g,x),c.closePath(),c.restore()}},ol.control.Dialog=function(n){n=n||{},n.fullscreen&&(n.target=document.body);var c=ol.ext.element.create("DIV",{className:((n.className||"")+(n.zoom?" ol-zoom":"")+" ol-ext-dialog").trim(),click:function(d){this.get("hideOnBack")&&d.target===c&&this.close(),this.get("hideOnClick")&&this.close()}.bind(this)}),h=ol.ext.element.create("FORM",{on:{submit:this._onButton("submit")},parent:c});ol.ext.element.create("H2",{parent:h}),ol.ext.element.create("DIV",{className:"ol-closebox",click:this._onButton("cancel"),parent:h}),ol.ext.element.create("DIV",{className:"ol-content",parent:h}),this._progress=ol.ext.element.create("DIV",{style:{display:"none"},parent:h});var u=ol.ext.element.create("DIV",{className:"ol-progress-bar",parent:this._progress});this._progressbar=ol.ext.element.create("DIV",{parent:u}),this._progressMessage=ol.ext.element.create("DIV",{className:"ol-progress-message",parent:this._progress}),ol.ext.element.create("DIV",{className:"ol-buttons",parent:h}),ol.control.Control.call(this,{element:c,target:n.target}),this.set("closeBox",n.closeBox!==!1),this.set("zoom",!!n.zoom),this.set("hideOnClick",!!n.hideOnClick),this.set("hideOnBack",!!n.hideOnBack),this.set("className",c.className),this.set("closeOnSubmit",n.closeOnSubmit),this.set("buttons",n.buttons),this.setContent(n)},ol.ext.inherits(ol.control.Dialog,ol.control.Control),ol.control.Dialog.prototype.show=function(n){n&&((n instanceof Element||typeof n=="string")&&(n={content:n}),this.setContent(n)),this.element.classList.add("ol-visible");var c=this.element.querySelector('input[type="text"],input[type="search"],input[type="number"]');if(c&&c.focus(),this.dispatchEvent({type:"show"}),n){if(n.autoclose){var h=setTimeout(function(){this.hide()}.bind(this),n.autoclose);this.once("hide",function(){clearTimeout(h)})}if(n.hideOnBack){var u=this.get("hideOnBack");this.set("hideOnBack",!0),this.once("hide",function(){this.set("hideOnBack",u)}.bind(this))}}},ol.control.Dialog.prototype.open=function(){this.show()},ol.control.Dialog.prototype.setContentMessage=function(n){if(n!==void 0){var c=this.getContentElement();n instanceof Element&&ol.ext.element.setHTML(c,""),ol.ext.element.setHTML(c,n||"")}},ol.control.Dialog.prototype.setTitle=function(n){var c=this.element.querySelector("form");c.querySelector("h2").innerText=n||"",n?c.classList.add("ol-title"):c.classList.remove("ol-title")},ol.control.Dialog.prototype.setContent=function(n){if(n){this.element.className=this.get("className"),typeof n=="string"&&(n={content:n}),n=n||{},this.setProgress(!1),n.max&&this.setProgress(0,n.max),n.progress!==void 0&&this.setProgress(n.progress),this.get("zoom")?this.element.classList.add("ol-zoom"):this.element.classList.remove("ol-zoom"),n.className&&n.className.split(" ").forEach(function(m){this.element.classList.add(m)}.bind(this));var c=this.element.querySelector("form");n.content!==void 0&&(n.content instanceof Element&&ol.ext.element.setHTML(c.querySelector(".ol-content"),""),ol.ext.element.setHTML(c.querySelector(".ol-content"),n.content||"")),this.setTitle(n.title),n.closeBox||this.get("closeBox")&&n.closeBox!==!1?c.classList.add("ol-closebox"):c.classList.remove("ol-closebox");var h=this.element.querySelector(".ol-buttons");h.innerHTML="";var u=n.buttons||this.get("buttons");if(u){c.classList.add("ol-button");for(var d in u)ol.ext.element.create("INPUT",{type:d==="submit"?"submit":"button",value:u[d],click:this._onButton(d,n.onButton),parent:h})}else c.classList.remove("ol-button")}},ol.control.Dialog.prototype.getContentElement=function(){return this.element.querySelector("form .ol-content")},ol.control.Dialog.prototype.setProgress=function(n,c,h){if(n===!1){ol.ext.element.setStyle(this._progress,{display:"none"});return}if(c>0?this.set("max",Number(c)):c=this.get("max"),!c)ol.ext.element.setStyle(this._progress,{display:"none"});else{var u=Math.round(n/c*100);ol.ext.element.setStyle(this._progress,{display:""}),this._progressbar.className=u?"":"notransition",ol.ext.element.setStyle(this._progressbar,{width:u+"%"})}this._progressMessage.innerHTML="",ol.ext.element.setHTML(this._progressMessage,h||"")},ol.control.Dialog.prototype._onButton=function(n,c){var h=function(u){u.preventDefault(),(n!=="submit"||this.get("closeOnSubmit")!==!1)&&this.hide();var d=this.getInputs();this.dispatchEvent({type:"button",button:n,inputs:d}),typeof c=="function"&&c(n,d)}.bind(this);return h},ol.control.Dialog.prototype.getInputs=function(){var n={};return["input","textarea","select"].forEach(function(c){this.element.querySelectorAll("form "+c).forEach(function(h){h.className&&h.className.split(" ").forEach(function(u){n[u]=h})})}.bind(this)),n},ol.control.Dialog.prototype.hide=function(){this.element.classList.remove("ol-visible"),this.dispatchEvent({type:"hide"})},ol.control.Dialog.prototype.close=ol.control.Dialog.prototype.hide,ol.control.Dialog.prototype.isOpen=function(){return this.element.classList.contains("ol-visible")},ol.control.Disable=function(n){n=n||{};var c=document.createElement("div");c.className=(n.className||" ol-disable ol-unselectable ol-control").trim();var h={top:"0px",left:"0px",right:"0px",bottom:"0px",zIndex:1e4,background:"none",display:"none"};Object.keys(h).forEach(function(u){c.style[u]=h[u]}),ol.control.Control.call(this,{element:c})},ol.ext.inherits(ol.control.Disable,ol.control.Control),ol.control.Disable.prototype.isOn=function(){return this.element.classList.contains("ol-disable")},ol.control.Disable.prototype.disableMap=function(n){n?this.element.classList.add("ol-enable").show():this.element.classList.remove("ol-enable").hide()},ol.control.EditBar=function(n){n=n||{},n.interactions=n.interactions||{},ol.control.Bar.call(this,{className:(n.className?n.className+" ":"")+"ol-editbar",toggleOne:!0,target:n.target}),this._source=n.source,this._interactions={},this._setSelectInteraction(n),n.edition!==!1&&this._setEditInteraction(n),this._setModifyInteraction(n)},ol.ext.inherits(ol.control.EditBar,ol.control.Bar),ol.control.EditBar.prototype.setMap=function(n){this.getMap()&&(this._interactions.Delete&&this.getMap().removeInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().removeInteraction(this._interactions.ModifySelect)),ol.control.Bar.prototype.setMap.call(this,n),this.getMap()&&(this._interactions.Delete&&this.getMap().addInteraction(this._interactions.Delete),this._interactions.ModifySelect&&this.getMap().addInteraction(this._interactions.ModifySelect))},ol.control.EditBar.prototype.getInteraction=function(n){return this._interactions[n]},ol.control.EditBar.prototype._getTitle=function(n){if(n)return n.get?n.get("title"):typeof n=="string"?n:n.title},ol.control.EditBar.prototype._setSelectInteraction=function(n){var c=this,h=new ol.control.Bar,u;if(n.interactions.Delete!==!1){n.interactions.Delete instanceof ol.interaction.Delete?this._interactions.Delete=n.interactions.Delete:this._interactions.Delete=new ol.interaction.Delete;var d=this._interactions.Delete;d.setActive(!1),this.getMap()&&this.getMap().addInteraction(d),h.addControl(new ol.control.Button({className:"ol-delete",title:this._getTitle(n.interactions.Delete)||"Delete",name:"Delete",handleClick:function(g){d.delete(u.getInteraction().getFeatures());var x={type:"select",selected:[],deselected:u.getInteraction().getFeatures().getArray().slice(),mapBrowserEvent:g.mapBrowserEvent};u.getInteraction().getFeatures().clear(),u.getInteraction().dispatchEvent(x)}}))}if(n.interactions.Info!==!1&&h.addControl(new ol.control.Button({className:"ol-info",name:"Info",title:this._getTitle(n.interactions.Info)||"Show informations",handleClick:function(){c.dispatchEvent({type:"info",features:u.getInteraction().getFeatures()})}})),n.interactions.Select!==!1){n.interactions.Select instanceof ol.interaction.Select?this._interactions.Select=n.interactions.Select:this._interactions.Select=new ol.interaction.Select({condition:ol.events.condition.click});var m=this._interactions.Select;u=new ol.control.Toggle({className:"ol-selection",name:"Select",title:this._getTitle(n.interactions.Select)||"Select",interaction:m,bar:h.getControls().length?h:void 0,autoActivate:!0,active:!0}),this.addControl(u),m.on("change:active",function(){m.getFeatures().clear()})}},ol.control.EditBar.prototype._setEditInteraction=function(n){if(n.interactions.DrawPoint!==!1){n.interactions.DrawPoint instanceof ol.interaction.Draw?this._interactions.DrawPoint=n.interactions.DrawPoint:this._interactions.DrawPoint=new ol.interaction.Draw({type:"Point",source:this._source});var c=new ol.control.Toggle({className:"ol-drawpoint",name:"DrawPoint",title:this._getTitle(n.interactions.DrawPoint)||"Point",interaction:this._interactions.DrawPoint});this.addControl(c)}if(n.interactions.DrawLine!==!1){n.interactions.DrawLine instanceof ol.interaction.Draw?this._interactions.DrawLine=n.interactions.DrawLine:this._interactions.DrawLine=new ol.interaction.Draw({type:"LineString",source:this._source,geometryFunction:function(L,F){return F?F.setCoordinates(L):F=new ol.geom.LineString(L),this.nbpts=F.getCoordinates().length,F}});var h=new ol.control.Toggle({className:"ol-drawline",title:this._getTitle(n.interactions.DrawLine)||"LineString",name:"DrawLine",interaction:this._interactions.DrawLine,bar:new ol.control.Bar({controls:[new ol.control.TextButton({html:this._getTitle(n.interactions.UndoDraw)||"undo",title:this._getTitle(n.interactions.UndoDraw)||"delete last point",handleClick:function(){h.getInteraction().nbpts>1&&h.getInteraction().removeLastPoint()}}),new ol.control.TextButton({html:this._getTitle(n.interactions.FinishDraw)||"finish",title:this._getTitle(n.interactions.FinishDraw)||"finish",handleClick:function(){h.getInteraction().nbpts>2&&h.getInteraction().finishDrawing()}})]})});this.addControl(h)}if(n.interactions.DrawPolygon!==!1&&(n.interactions.DrawPolygon instanceof ol.interaction.Draw?this._interactions.DrawPolygon=n.interactions.DrawPolygon:this._interactions.DrawPolygon=new ol.interaction.Draw({type:"Polygon",source:this._source,geometryFunction:function(L,F){return this.nbpts=L[0].length,F?F.setCoordinates([L[0].concat([L[0][0]])]):F=new ol.geom.Polygon(L),F}}),this._setDrawPolygon("ol-drawpolygon",this._interactions.DrawPolygon,this._getTitle(n.interactions.DrawPolygon)||"Polygon","DrawPolygon",n)),n.interactions.DrawHole!==!1&&(n.interactions.DrawHole instanceof ol.interaction.DrawHole?this._interactions.DrawHole=n.interactions.DrawHole:this._interactions.DrawHole=new ol.interaction.DrawHole,this._setDrawPolygon("ol-drawhole",this._interactions.DrawHole,this._getTitle(n.interactions.DrawHole)||"Hole","DrawHole",n)),n.interactions.DrawRegular!==!1){var u={pts:"pts",circle:"circle"};n.interactions.DrawRegular instanceof ol.interaction.DrawRegular?(this._interactions.DrawRegular=n.interactions.DrawRegular,u.pts=this._interactions.DrawRegular.get("ptsLabel")||u.pts,u.circle=this._interactions.DrawRegular.get("circleLabel")||u.circle):(this._interactions.DrawRegular=new ol.interaction.DrawRegular({source:this._source,sides:4}),n.interactions.DrawRegular&&(u.pts=n.interactions.DrawRegular.ptsLabel||u.pts,u.circle=n.interactions.DrawRegular.circleLabel||u.circle));var d=this._interactions.DrawRegular,m=document.createElement("DIV"),g=ol.ext.element.create("DIV",{parent:m});ol.ext.element.addListener(g,["click","touchstart"],function(){var L=d.getSides()-1;L<2&&(L=2),d.setSides(L),x.textContent=L>2?L+" "+u.pts:u.circle}.bind(this));var x=ol.ext.element.create("TEXT",{html:"4 "+u.pts,parent:m}),E=ol.ext.element.create("DIV",{parent:m});ol.ext.element.addListener(E,["click","touchstart"],function(){var L=d.getSides()+1;L<3&&(L=3),d.setSides(L),x.textContent=L+" "+u.pts}.bind(this));var P=new ol.control.Toggle({className:"ol-drawregular",title:this._getTitle(n.interactions.DrawRegular)||"Regular",name:"DrawRegular",interaction:this._interactions.DrawRegular,bar:new ol.control.Bar({controls:[new ol.control.TextButton({html:m})]})});this.addControl(P)}},ol.control.EditBar.prototype._setDrawPolygon=function(n,c,h,u,d){var m=new ol.control.Toggle({className:n,name:u,title:h,interaction:c,bar:new ol.control.Bar({controls:[new ol.control.TextButton({html:this._getTitle(d.interactions.UndoDraw)||"undo",title:this._getTitle(d.interactions.UndoDraw)||"undo last point",handleClick:function(){m.getInteraction().nbpts>1&&m.getInteraction().removeLastPoint()}}),new ol.control.TextButton({html:this._getTitle(d.interactions.FinishDraw)||"finish",title:this._getTitle(d.interactions.FinishDraw)||"finish",handleClick:function(){m.getInteraction().nbpts>3&&m.getInteraction().finishDrawing()}})]})});return this.addControl(m),m},ol.control.EditBar.prototype._setModifyInteraction=function(n){if(n.interactions.ModifySelect!==!1&&n.interactions.Select!==!1&&(n.interactions.ModifySelect instanceof ol.interaction.ModifyFeature?this._interactions.ModifySelect=n.interactions.ModifySelect:this._interactions.ModifySelect=new ol.interaction.ModifyFeature({features:this.getInteraction("Select").getFeatures()}),this.getMap()&&this.getMap().addInteraction(this._interactions.ModifySelect),this._interactions.ModifySelect.setActive(this._interactions.Select.getActive()),this._interactions.Select.on("change:active",function(){this._interactions.ModifySelect.setActive(this._interactions.Select.getActive())}.bind(this))),n.interactions.Transform!==!1){n.interactions.Transform instanceof ol.interaction.Transform?this._interactions.Transform=n.interactions.Transform:this._interactions.Transform=new ol.interaction.Transform({addCondition:ol.events.condition.shiftKeyOnly});var c=new ol.control.Toggle({html:"<i></i>",className:"ol-transform",title:this._getTitle(n.interactions.Transform)||"Transform",name:"Transform",interaction:this._interactions.Transform});this.addControl(c)}if(n.interactions.Split!==!1){n.interactions.Split instanceof ol.interaction.Split?this._interactions.Split=n.interactions.Split:this._interactions.Split=new ol.interaction.Split({sources:this._source});var h=new ol.control.Toggle({className:"ol-split",title:this._getTitle(n.interactions.Split)||"Split",name:"Split",interaction:this._interactions.Split});this.addControl(h)}if(n.interactions.Offset!==!1){n.interactions.Offset instanceof ol.interaction.Offset?this._interactions.Offset=n.interactions.Offset:this._interactions.Offset=new ol.interaction.Offset({source:this._source});var u=new ol.control.Toggle({html:"<i></i>",className:"ol-offset",title:this._getTitle(n.interactions.Offset)||"Offset",name:"Offset",interaction:this._interactions.Offset});this.addControl(u)}},ol.control.Gauge=function(n){n=n||{};var c=ol.ext.element.create("DIV",{className:((n.className||"")+" ol-gauge ol-unselectable ol-control").trim()});this.title_=ol.ext.element.create("SPAN",{parent:c});var h=ol.ext.element.create("DIV",{parent:c});this.gauge_=ol.ext.element.create("BUTTON",{type:"button",style:{width:"0px"},parent:h}),ol.control.Control.call(this,{element:c,target:n.target}),this.setTitle(n.title),this.set("max",n.max||100),this.val(n.val)},ol.ext.inherits(ol.control.Gauge,ol.control.Control),ol.control.Gauge.prototype.setTitle=function(n){this.title_.innerHTML=n||"",n?this.title_.display="":this.title_.display="none"},ol.control.Gauge.prototype.val=function(n){return n!==void 0&&(this.val_=n,this.gauge_.style.width=n/this.get("max")*100+"%"),this.val_},ol.control.GeoBookmark=function(n){n=n||{};var c=this,h=document.createElement("div");n.target?h.className=n.className||"ol-bookmark":(h.className=(n.className||"ol-bookmark")+" ol-unselectable ol-control ol-collapsed",h.addEventListener("mouseleave",function(){m!==document.activeElement&&(u.style.display="none")}),this.button=ol.ext.element.create("BUTTON",{type:"button",title:n.title||"Geobookmarks",click:function(){var E=u.style.display===""||u.style.display==="none";u.style.display=E?"block":"none",E&&this.setBookmarks()}.bind(this)}),h.appendChild(this.button));var u=document.createElement("div");h.appendChild(u);var d=document.createElement("ul");u.appendChild(d);var m=document.createElement("input");m.setAttribute("placeholder",n.placeholder||"Add a new geomark..."),m.addEventListener("keydown",function(E){if(E.stopPropagation(),E.keyCode===13){E.preventDefault();var P=this.value;P&&(c.addBookmark(P),this.value="",c.dispatchEvent({type:"add",name:P})),u.style.display="none"}}),m.addEventListener("blur",function(){u.style.display="none"}),u.appendChild(m),ol.control.Control.call(this,{element:h,target:n.target}),this.on("propertychange",function(E){E.key==="editable"&&(h.className=h.className.replace(" ol-editable",""),this.get("editable")&&(h.className+=" ol-editable"))}.bind(this)),this.set("namespace",n.namespace||"ol"),this.set("editable",n.editable!==!1),this.set("deleteTitle",n.deleteTitle||"Suppr.");var g={};try{localStorage[this.get("namespace")+"@bookmark"]&&(g=JSON.parse(localStorage[this.get("namespace")+"@bookmark"]))}catch{console.warn("Failed to access localStorage...")}if(n.marks)for(var x in n.marks)g[x]=n.marks[x];this.setBookmarks(g)},ol.ext.inherits(ol.control.GeoBookmark,ol.control.Control),ol.control.GeoBookmark.prototype.setBookmarks=function(n){if(!n){n={};try{n=JSON.parse(localStorage[this.get("namespace")+"@bookmark"]||"{}")}catch{console.warn("Failed to access localStorage...")}}var c=this.get("editable"),h=this.element.querySelector("ul"),u=this.element.querySelector("div"),d=this;h.innerHTML="";for(var m in n){var g=document.createElement("li");if(g.textContent=m,g.setAttribute("data-bookmark",JSON.stringify(n[m])),g.setAttribute("data-name",m),g.addEventListener("click",function(){var E=JSON.parse(this.getAttribute("data-bookmark"));d.getMap().getView().setCenter(E.pos),d.getMap().getView().setZoom(E.zoom),d.getMap().getView().setRotation(E.rot||0),u.style.display="none",d.dispatchEvent({type:"select",name:this.getAttribute("data-name"),bookmark:E})}),h.appendChild(g),c&&!n[m].permanent){var x=document.createElement("button");x.setAttribute("data-name",m),x.setAttribute("type","button"),x.setAttribute("title",this.get("deleteTitle")||"Suppr."),x.addEventListener("click",function(E){d.removeBookmark(this.getAttribute("data-name")),d.dispatchEvent({type:"remove",name:this.getAttribute("data-name")}),E.stopPropagation()}),g.appendChild(x)}}try{localStorage[this.get("namespace")+"@bookmark"]=JSON.stringify(n)}catch{console.warn("Failed to access localStorage...")}},ol.control.GeoBookmark.prototype.getBookmarks=function(){var n={};try{n=JSON.parse(localStorage[this.get("namespace")+"@bookmark"]||"{}")}catch{console.warn("Failed to access localStorage...")}return n},ol.control.GeoBookmark.prototype.removeBookmark=function(n){if(n){var c=this.getBookmarks();delete c[n],this.setBookmarks(c)}},ol.control.GeoBookmark.prototype.addBookmark=function(n,c,h,u){if(n){var d=c,m;d&&d.position?(h=d.zoom,u=d.permanent,m=d.rotation,c=d.position):m=this.getMap().getView().getRotation();var g=this.getBookmarks();g[n]&&g[n].permanent||(g[n]={pos:c||this.getMap().getView().getCenter(),zoom:h||this.getMap().getView().getZoom(),permanent:!!u},m&&(g[n].rot=m),this.setBookmarks(g))}},ol.control.GeolocationBar=function(n){n||(n={}),n.className=n.className||"ol-geobar",ol.control.Bar.call(this,n),this.setPosition(n.position||"bottom-right");var c=this.element,h=new ol.interaction.GeolocationDraw({source:n.source,zoom:n.zoom,minZoom:n.minZoom,tolerance:n.tolerance,followTrack:n.followTrack,minAccuracy:n.minAccuracy||1e4});this._geolocBt=new ol.control.Toggle({className:"geolocBt",interaction:h,onToggle:function(){h.pause(!0),h.setFollowTrack(n.followTrack),c.classList.remove("pauseTrack")}}),this.addControl(this._geolocBt),this._geolocBt.setActive(!1);var u=new ol.control.Bar;this.addControl(u);var d=new ol.control.TextButton({className:"centerBt",html:n.centerLabel||"center",handleClick:function(){h.setFollowTrack("auto")}});u.addControl(d);var m=new ol.control.Button({className:"startBt",handleClick:function(){h.pause(!1),h.setFollowTrack("auto"),c.classList.add("pauseTrack")}});u.addControl(m);var g=new ol.control.Button({className:"pauseBt",handleClick:function(){h.pause(!0),h.setFollowTrack("auto"),c.classList.remove("pauseTrack")}});u.addControl(g),h.on("follow",function(x){x.following?c.classList.remove("centerTrack"):c.classList.add("centerTrack")}),this._geolocBt.on("change:active",function(x){x.active?c.classList.add("ol-active"):c.classList.remove("ol-active")})},ol.ext.inherits(ol.control.GeolocationBar,ol.control.Bar),ol.control.GeolocationBar.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.Bar.prototype.setMap.call(this,n),n&&(this._listener=n.on("moveend",function(){var c=this.getInteraction();c.getActive()&&c.get("followTrack")==="auto"&&c.path_.length&&c.path_[c.path_.length-1][0]!==n.getView().getCenter()[0]&&this.element.classList.add("centerTrack")}.bind(this)))},ol.control.GeolocationBar.prototype.getInteraction=function(){return this._geolocBt.getInteraction()},ol.control.GeolocationButton=function(n){n||(n={}),n.followTrack=n.followTrack||"auto",n.zoom=n.zoom||16;var c=new ol.interaction.GeolocationDraw(n);ol.control.Toggle.call(this,{className:n.className=((n.className||"")+" ol-geobt").trim(),interaction:c,title:n.title||"Geolocation",onToggle:function(){c.pause(!0),c.setFollowTrack(n.followTrack||"auto")}}),this.setActive(!1),c.on("tracking",function(u){this.dispatchEvent({type:"position",coordinate:u.geolocation.getPosition()})}.bind(this));var h;c.on("change:active",function(){this.dispatchEvent({type:"position"}),h&&(clearTimeout(h),h=null),c.getActive()&&(h=setTimeout(function(){c.setActive(!1),h=null}.bind(this),n.delay||3e3))}.bind(this))},ol.ext.inherits(ol.control.GeolocationButton,ol.control.Toggle),ol.control.Globe=function(n){var c=n||{},h=this,u;c.target?(u=document.createElement("div"),this.panel_=c.target):(u=document.createElement("div"),u.classList.add("ol-globe","ol-unselectable","ol-control"),/top/.test(c.align)&&u.classList.add("ol-control-top"),/right/.test(c.align)&&u.classList.add("ol-control-right"),this.panel_=document.createElement("div"),this.panel_.classList.add("panel"),u.appendChild(this.panel_),this.pointer_=document.createElement("div"),this.pointer_.classList.add("ol-pointer"),u.appendChild(this.pointer_)),ol.control.Control.call(this,{element:u,target:c.target}),this.ovmap_=new ol.Map({controls:new ol.Collection,interactions:new ol.Collection,target:this.panel_,view:new ol.View({zoom:0,center:[0,0]}),layers:c.layers}),setTimeout(function(){h.ovmap_.updateSize()},0),this.set("follow",c.follow||!1),this.extentLayer=new ol.layer.Vector({name:"Cache extent",source:new ol.source.Vector,style:c.style||[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,0,0, 1)"}),stroke:new ol.style.Stroke({width:7,color:"rgba(255,0,0, 0.8)"}),radius:5})})]}),this.ovmap_.addLayer(this.extentLayer)},ol.ext.inherits(ol.control.Globe,ol.control.Control),ol.control.Globe.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener=n.getView().on("propertychange",this.setView.bind(this)),this.setView())},ol.control.Globe.prototype.setView=function(){this.getMap()&&this.get("follow")&&this.setCenter(this.getMap().getView().getCenter())},ol.control.Globe.prototype.getGlobe=function(){return this.ovmap_},ol.control.Globe.prototype.show=function(n){n!==!1?this.element.classList.remove("ol-collapsed"):this.element.classList.add("ol-collapsed"),this.ovmap_.updateSize()},ol.control.Globe.prototype.setPosition=function(n){/top/.test(n)?this.element.classList.add("ol-control-top"):this.element.classList.remove("ol-control-top"),/right/.test(n)?this.element.classList.add("ol-control-right"):this.element.classList.remove("ol-control-right")},ol.control.Globe.prototype.setCenter=function(n,c){var h=this;if(this.pointer_.classList.add("hidden"),n){var u=this.ovmap_,d=u.getPixelFromCoordinate(n);if(d){if(c!==!1){var m=this.element.clientHeight;setTimeout(function(){h.pointer_.style.top=String(Math.min(Math.max(d[1],0),m))+"px",h.pointer_.style.left="50%",h.pointer_.classList.remove("hidden")},800)}u.getView().animate({center:[n[0],0]})}}},ol.control.Graticule=function(n){n||(n={});var c=document.createElement("div");c.className="ol-graticule ol-unselectable ol-hidden",ol.control.CanvasBase.call(this,{element:c}),this.set("projection",n.projection||"EPSG:4326");var h=new ol.proj.Projection({code:this.get("projection")}),u=h.getMetersPerUnit();for(this.fac=1;u/this.fac>10;)this.fac*=10;this.fac=1e4/this.fac,this.set("maxResolution",n.maxResolution||1/0),this.set("step",n.step||.1),this.set("stepCoord",n.stepCoord||1),this.set("spacing",n.spacing||40),this.set("intervals",n.intervals),this.set("precision",n.precision),this.set("margin",n.margin||0),this.set("borderWidth",n.borderWidth||5),this.set("stroke",n.stroke!==!1),this.formatCoord=n.formatCoord||function(d){return d},n.style instanceof ol.style.Style?this.setStyle(n.style):this.setStyle(new ol.style.Style({stroke:new ol.style.Stroke({color:"#000",width:1}),fill:new ol.style.Fill({color:"#fff"}),text:new ol.style.Text({stroke:new ol.style.Stroke({color:"#fff",width:2}),fill:new ol.style.Fill({color:"#000"})})}))},ol.ext.inherits(ol.control.Graticule,ol.control.CanvasBase),ol.control.Graticule.prototype.setStyle=function(n){this._style=n},ol.control.Graticule.prototype._draw=function(n){if(!(this.get("maxResolution")<n.frameState.viewState.resolution)){for(var c=this.getContext(n),h=c.canvas,u=n.frameState.pixelRatio,d=h.width/u,m=h.height/u,g=this.get("projection"),x=this.getMap(),E=[x.getCoordinateFromPixel([0,0]),x.getCoordinateFromPixel([d,0]),x.getCoordinateFromPixel([d,m]),x.getCoordinateFromPixel([0,m])],P=-1/0,L=1/0,F=-1/0,U=1/0,A=0,G;G=E[A];A++)E[A]=ol.proj.transform(G,x.getView().getProjection(),g),P=Math.max(P,E[A][0]),L=Math.min(L,E[A][0]),F=Math.max(F,E[A][1]),U=Math.min(U,E[A][1]);var B=this.get("spacing"),O=this.get("step"),K=this.get("stepCoord"),Q=this.get("borderWidth"),et=this.get("margin"),lt=(P-L)/O*B;if(lt>d){var pt=Math.round((P-L)/d*B/O);O*=pt,O>this.fac&&(O=Math.round(O/this.fac)*this.fac)}var T=this.get("intervals");if(Array.isArray(T)){for(var ct=T[0],A=0,ut=T.length;A<ut&&!(O>=T[A]);++A)ct=T[A];O=ct}var ft=this.get("precision"),$=O;ft>0&&O>ft&&($=O/Math.ceil(O/ft)),L=Math.floor(L/O)*O-O,U=Math.floor(U/O)*O-O,P=Math.floor(P/O)*O+2*O,F=Math.floor(F/O)*O+2*O;var _t=ol.proj.get(g).getExtent();_t&&(L<_t[0]&&(L=_t[0]),U<_t[1]&&(U=_t[1]),P>_t[2]&&(P=_t[2]+O),F>_t[3]&&(F=_t[3]+O));var W=this.getStyle().getStroke()&&this.get("stroke"),rt=this.getStyle().getText(),nt=this.getStyle().getFill();c.save(),c.scale(u,u),c.beginPath(),c.rect(et,et,d-2*et,m-2*et),c.clip(),c.beginPath();var vt={top:[],left:[],bottom:[],right:[]},Mt,Bt,Vt,Lt,Ne;for(Mt=L;Mt<P;Mt+=O)for(Lt=ol.proj.transform([Mt,U],g,x.getView().getProjection()),Lt=x.getPixelFromCoordinate(Lt),W&&c.moveTo(Lt[0],Lt[1]),Vt=Lt,Bt=U+$;Bt<=F;Bt+=$)Ne=ol.proj.transform([Mt,Bt],g,x.getView().getProjection()),Ne=x.getPixelFromCoordinate(Ne),W&&c.lineTo(Ne[0],Ne[1]),Vt[1]>0&&Ne[1]<0&&vt.top.push([Mt,Vt]),Vt[1]>m&&Ne[1]<m&&vt.bottom.push([Mt,Vt]),Vt=Ne;for(Bt=U;Bt<F;Bt+=O)for(Lt=ol.proj.transform([L,Bt],g,x.getView().getProjection()),Lt=x.getPixelFromCoordinate(Lt),W&&c.moveTo(Lt[0],Lt[1]),Vt=Lt,Mt=L+$;Mt<=P;Mt+=$)Ne=ol.proj.transform([Mt,Bt],g,x.getView().getProjection()),Ne=x.getPixelFromCoordinate(Ne),W&&c.lineTo(Ne[0],Ne[1]),Vt[0]<0&&Ne[0]>0&&vt.left.push([Bt,Vt]),Vt[0]<d&&Ne[0]>d&&vt.right.push([Bt,Vt]),Vt=Ne;if(W&&(c.strokeStyle=this.getStyle().getStroke().getColor(),c.lineWidth=this.getStyle().getStroke().getWidth(),c.stroke()),rt){c.fillStyle=this.getStyle().getText().getFill().getColor(),c.strokeStyle=this.getStyle().getText().getStroke().getColor(),c.lineWidth=this.getStyle().getText().getStroke().getWidth(),c.font=this.getStyle().getText().getFont(),c.textAlign="center",c.textBaseline="hanging";var ge,Yt,ue=(nt?Q:0)+et+2;for(A=0;ge=vt.top[A];A++)Math.round(ge[0]/this.get("step"))%K||(Yt=this.formatCoord(ge[0],"top"),c.strokeText(Yt,ge[1][0],ue),c.fillText(Yt,ge[1][0],ue));for(c.textBaseline="alphabetic",A=0;ge=vt.bottom[A];A++)Math.round(ge[0]/this.get("step"))%K||(Yt=this.formatCoord(ge[0],"bottom"),c.strokeText(Yt,ge[1][0],m-ue),c.fillText(Yt,ge[1][0],m-ue));for(c.textBaseline="middle",c.textAlign="left",A=0;ge=vt.left[A];A++)Math.round(ge[0]/this.get("step"))%K||(Yt=this.formatCoord(ge[0],"left"),c.strokeText(Yt,ue,ge[1][1]),c.fillText(Yt,ue,ge[1][1]));for(c.textAlign="right",A=0;ge=vt.right[A];A++)Math.round(ge[0]/this.get("step"))%K||(Yt=this.formatCoord(ge[0],"right"),c.strokeText(Yt,d-ue,ge[1][1]),c.fillText(Yt,d-ue,ge[1][1]))}if(nt){var ne=this.getStyle().getFill().getColor(),dr,je;for((je=this.getStyle().getStroke())?dr=this.getStyle().getStroke().getColor():(dr=ne,ne="#fff"),c.strokeStyle=dr,c.lineWidth=je?je.getWidth():1,A=1;A<vt.top.length;A++)c.beginPath(),c.rect(vt.top[A-1][1][0],et,vt.top[A][1][0]-vt.top[A-1][1][0],Q),c.fillStyle=Math.round(vt.top[A][0]/O)%2?dr:ne,c.fill(),c.stroke();for(A=1;A<vt.bottom.length;A++)c.beginPath(),c.rect(vt.bottom[A-1][1][0],m-Q-et,vt.bottom[A][1][0]-vt.bottom[A-1][1][0],Q),c.fillStyle=Math.round(vt.bottom[A][0]/O)%2?dr:ne,c.fill(),c.stroke();for(A=1;A<vt.left.length;A++)c.beginPath(),c.rect(et,vt.left[A-1][1][1],Q,vt.left[A][1][1]-vt.left[A-1][1][1]),c.fillStyle=Math.round(vt.left[A][0]/O)%2?dr:ne,c.fill(),c.stroke();for(A=1;A<vt.right.length;A++)c.beginPath(),c.rect(d-Q-et,vt.right[A-1][1][1],Q,vt.right[A][1][1]-vt.right[A-1][1][1]),c.fillStyle=Math.round(vt.right[A][0]/O)%2?dr:ne,c.fill(),c.stroke();c.beginPath(),c.fillStyle=dr,c.rect(et,et,Q,Q),c.rect(et,m-Q-et,Q,Q),c.rect(d-Q-et,et,Q,Q),c.rect(d-Q-et,m-Q-et,Q,Q),c.fill()}c.restore()}},ol.control.GridReference=function(n){n||(n={});var c=document.createElement("div");c.className=(n.target?"":"ol-control ")+"ol-gridreference ol-unselectable "+(n.className||""),n.style=n.style||new ol.style.Style({stroke:new ol.style.Stroke({color:"#000",width:1}),text:new ol.style.Text({font:"bold 14px Arial",stroke:new ol.style.Stroke({color:"#fff",width:2}),fill:new ol.style.Fill({color:"#000"})})}),ol.control.CanvasBase.call(this,{element:c,target:n.target,style:n.style}),typeof n.property=="function"&&(this.getFeatureName=n.property),typeof n.sortFeatures=="function"&&(this.sortFeatures=n.sortFeatures),typeof n.indexTitle=="function"&&(this.indexTitle=n.indexTitle),this.source_=n.source,n.source&&(this.setIndex(n.source.getFeatures(),n),n.source.once("change",function(){n.source.getState()==="ready"&&this.setIndex(n.source.getFeatures(),n)}.bind(this))),this.set("maxResolution",n.maxResolution||1/0),this.set("extent",n.extent),this.set("size",n.size),this.set("margin",n.margin||0),this.set("property",n.property||"name"),this.set("filterLabel",n.filterLabel||"filter")},ol.ext.inherits(ol.control.GridReference,ol.control.CanvasBase),ol.control.GridReference.prototype.setMap=function(n){ol.control.CanvasBase.prototype.setMap.call(this,n),this.setIndex(this.source_.getFeatures())},ol.control.GridReference.prototype.getFeatureName=function(n){return n.get(this.get("property")||"name")},ol.control.GridReference.prototype.sortFeatures=function(n,c){return this.getFeatureName(n)==this.getFeatureName(c)?0:this.getFeatureName(n)<this.getFeatureName(c)?-1:1},ol.control.GridReference.prototype.indexTitle=function(n){return this.getFeatureName(n).charAt(0)},ol.control.GridReference.prototype.setIndex=function(n){if(this.getMap()){var c=this;n.getArray&&(n=n.getArray()),n.sort(function(E,P){return c.sortFeatures(E,P)}),this.element.innerHTML="";var h=this.element,u=document.createElement("input");u.setAttribute("type","search"),u.setAttribute("placeholder",this.get("filterLabel")||"filter");var d=function(){var E=this.value.replace(/^\*/,""),P=new RegExp(E,"i"),L=m.querySelectorAll("li");Array.prototype.forEach.call(L,function(F){F.classList.contains("ol-title")||P.test(F.querySelector(".ol-name").textContent)?F.style.display="":F.style.display="none"}),Array.prototype.forEach.call(m.querySelectorAll("li.ol-title"),function(F){for(var U,A=!1,G=0;G<L.length;G++){if(A){if(L[G].classList.contains("ol-title"))break;if(!L[G].style.display){U=L[G];break}}L[G]===F&&(A=!0)}U?F.style.display="":F.style.display="none"})};u.addEventListener("search",d),u.addEventListener("keyup",d),h.appendChild(u);var m=document.createElement("ul");h.appendChild(m);var g,x;n.forEach(function(E){if(g=this.getReference(E.getGeometry().getFirstCoordinate()),g){var P=this.getFeatureName(E),L=this.indexTitle(E);if(L!=x){var F=document.createElement("li");F.classList.add("ol-title"),F.textContent=L,m.appendChild(F)}x=L;var U=document.createElement("li"),A=document.createElement("span");A.classList.add("ol-name"),A.textContent=P,U.appendChild(A);var G=document.createElement("span");G.classList.add("ol-ref"),G.textContent=g,U.appendChild(G);var B=E;U.addEventListener("click",function(){this.dispatchEvent({type:"select",feature:B})}.bind(this)),m.appendChild(U)}}.bind(this))}},ol.control.GridReference.prototype.getReference=function(n){if(this.getMap()){var c=this.get("extent"),h=this.get("size"),u=Math.floor((n[0]-c[0])/(c[2]-c[0])*h[0]);if(u<0||u>=h[0])return"";var d=Math.floor((c[3]-n[1])/(c[3]-c[1])*h[1]);return d<0||d>=h[1]?"":this.getHIndex(u)+this.getVIndex(d)}},ol.control.GridReference.prototype.getVIndex=function(n){return n},ol.control.GridReference.prototype.getHIndex=function(n){return String.fromCharCode(65+n)},ol.control.GridReference.prototype._draw=function(n){if(!(this.get("maxResolution")<n.frameState.viewState.resolution)){var c=this.getContext(n),h=c.canvas,u=n.frameState.pixelRatio,d=h.width/u,m=h.height/u,g=this.get("extent"),x=this.get("size"),E=this.getMap(),P=ol.extent.boundingExtent([E.getPixelFromCoordinate([g[0],g[1]]),E.getPixelFromCoordinate([g[2],g[3]])]),L=[P[0],P[1]],F=[P[2],P[3]],U=(F[0]-L[0])/x[0],A=(F[1]-L[1])/x[1];c.save();var G=this.get("margin");c.scale(u,u),c.strokeStyle=this.getStroke().getColor(),c.lineWidth=this.getStroke().getWidth(),c.beginPath();var B;for(B=0;B<=x[0];B++)c.moveTo(L[0]+B*U,L[1]),c.lineTo(L[0]+B*U,F[1]);for(B=0;B<=x[1];B++)c.moveTo(L[0],L[1]+B*A),c.lineTo(F[0],L[1]+B*A);c.stroke(),c.font=this.getTextFont(),c.fillStyle=this.getTextFill().getColor(),c.strokeStyle=this.getTextStroke().getColor();var O=c.lineWidth=this.getTextStroke().getWidth(),K=G+O;c.textAlign="center";var Q,et,lt;for(B=0;B<x[0];B++)Q=this.getHIndex(B),et=L[0]+B*U+U/2,lt=L[1]-K,lt<0?(lt=K,c.textBaseline="hanging"):c.textBaseline="alphabetic",c.strokeText(Q,et,lt),c.fillText(Q,et,lt),lt=F[1]+K,lt>m?(lt=m-K,c.textBaseline="alphabetic"):c.textBaseline="hanging",c.strokeText(Q,et,lt),c.fillText(Q,et,lt);for(c.textBaseline="middle",B=0;B<x[1];B++)Q=this.getVIndex(B),lt=L[1]+B*A+A/2,c.textAlign="right",et=L[0]-K,et<0?(et=K,c.textAlign="left"):c.textAlign="right",c.strokeText(Q,et,lt),c.fillText(Q,et,lt),et=F[0]+K,et>d?(et=d-K,c.textAlign="right"):c.textAlign="left",c.strokeText(Q,et,lt),c.fillText(Q,et,lt);c.restore()}},ol.control.Imageline=function(n){var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-imageline"+(n.target?"":" ol-unselectable ol-control")+(n.collapsed&&n.collapsible?"ol-collapsed":"")});!n.target&&n.collapsible&&ol.ext.element.create("BUTTON",{type:"button",click:function(){this.toggle()}.bind(this),parent:c}),n.source&&(this._sources=n.source.forEach?n.source:[n.source]),n.layers&&this.setLayers(n.layers),ol.control.Control.call(this,{element:c,target:n.target}),this._setScrolling(),this._scrolldiv.addEventListener("scroll",function(){this.getMap()&&this.getMap().render()}.bind(this)),typeof n.getImage=="function"&&(this._getImage=n.getImage),typeof n.getTitle=="function"&&(this._getTitle=n.getTitle),this.set("maxFeatures",n.maxFeatures||100),this.set("linkColor",n.linkColor||!1),this.set("hover",n.hover||!1),this.set("useExtent",n.useExtent||!1),this.refresh()},ol.ext.inherits(ol.control.Imageline,ol.control.Control),ol.control.Imageline.prototype.setMap=function(n){this._listener&&this._listener.forEach(function(c){ol.Observable.unByKey(c)}.bind(this)),this._listener=null,ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener=[n.on("postcompose",this._drawLink.bind(this)),n.on("moveend",function(){this.get("useExtent")&&this.refresh()}.bind(this))],this.refresh())},ol.control.Imageline.prototype.setLayers=function(n){this._sources=this._getSources(n)},ol.control.Imageline.prototype._getSources=function(n){var c=[];return n.forEach(function(h){h.getVisible()&&(h.getSource()&&h.getSource().getFeatures?c.push(h.getSource()):h.getLayers&&this._getSources(h.getLayers()))}.bind(this)),c},ol.control.Imageline.prototype.useExtent=function(n){this.set("useExtent",n),this.refresh()},ol.control.Imageline.prototype.isCollapsed=function(){return this.element.classList.contains("ol-collapsed")},ol.control.Imageline.prototype.collapse=function(n){n?this.element.classList.add("ol-collapsed"):this.element.classList.remove("ol-collapsed"),this.getMap()&&setTimeout(function(){this.getMap().render()}.bind(this),this.isCollapsed()?0:250),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})},ol.control.Imageline.prototype.toggle=function(){this.element.classList.toggle("ol-collapsed"),this.getMap()&&setTimeout(function(){this.getMap().render()}.bind(this),this.isCollapsed()?0:250),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})},ol.control.Imageline.prototype._getImage=function(n){return n.get("img")},ol.control.Imageline.prototype._getTitle=function(){return""},ol.control.Imageline.prototype.getFeatures=function(){var n=this.getMap();if(!n)return[];var c=[],h=this._sources||this._getSources(n.getLayers());return h.forEach(function(u){if(c.length<this.get("maxFeatures"))if(!this.get("useExtent")||!n)c.push(u.getFeatures());else{var d=n.getView().calculateExtent(n.getSize());c.push(u.getFeaturesInExtent(d))}}.bind(this)),c},ol.control.Imageline.prototype._setScrolling=function(){var n=this._scrolldiv=ol.ext.element.create("DIV",{parent:this.element});ol.ext.element.scrollDiv(n,{onmove:function(c){this._moving=c}.bind(this)}),n.addEventListener("scroll",this._updateScrollBounds.bind(this)),this._updateScrollBounds()},ol.control.Imageline.prototype._updateScrollBounds=function(){var n=this._scrolldiv;n.scrollLeft<5?this.element.classList.add("ol-scroll0"):this.element.classList.remove("ol-scroll0"),n.scrollWidth-n.scrollLeft-n.offsetWidth<5?this.element.classList.add("ol-scroll1"):this.element.classList.remove("ol-scroll1")},ol.control.Imageline.prototype.refresh=function(){this._scrolldiv.innerHTML="";var n=this.getFeatures(),c=this._select?this._select.feature:null;this._select&&(this._select.elt=null),this._iline=[],this.getMap()&&this.getMap().render();var h=function(d){if(this._getImage(d)){var m=ol.ext.element.create("DIV",{className:"ol-image",parent:this._scrolldiv});ol.ext.element.create("IMG",{src:this._getImage(d),parent:m}).addEventListener("load",function(){this.classList.add("ol-loaded")}),ol.ext.element.create("SPAN",{html:this._getTitle(d),parent:m});var g={elt:m,feature:d};m.addEventListener("click",function(){this._moving||(this.dispatchEvent({type:"select",feature:d}),this._scrolldiv.scrollLeft=m.offsetLeft+ol.ext.element.getStyle(m,"width")/2-ol.ext.element.getStyle(this.element,"width")/2,this._select&&this._select.elt.classList.remove("select"),this._select=g,this._select.elt.classList.add("select"))}.bind(this)),m.addEventListener("mouseover",function(x){this.get("hover")&&(this._select&&this._select.elt.classList.remove("select"),this._select=g,this._select.elt.classList.add("select"),this.getMap().render(),x.stopPropagation())}.bind(this)),m.addEventListener("mouseout",function(x){this.get("hover")&&(this._select&&this._select.elt.classList.remove("select"),this._select=!1,this.getMap().render(),x.stopPropagation())}.bind(this)),m.ondragstart=function(){return!1},this._iline.push(g),c===d&&(this._select=g,g.elt.classList.add("select"))}}.bind(this),u=this.get("maxFeatures");n.forEach(function(d){for(var m=0,g;(g=d[m])&&!(u--<0);m++)h(g)}.bind(this)),this._select&&this._select.feature&&!this._select.elt&&h(this._select.feature),this._updateScrollBounds()},ol.control.Imageline.prototype.select=function(n,c){this._select=!1,this._iline.forEach(function(h){h.feature===n?(h.elt.classList.add("select"),this._select=h,c!==!1&&(this._scrolldiv.scrollLeft=h.elt.offsetLeft+ol.ext.element.getStyle(h.elt,"width")/2-ol.ext.element.getStyle(this.element,"width")/2)):h.elt.classList.remove("select")}.bind(this))},ol.control.Imageline.prototype._drawLink=function(n){if(!(!this.get("linkColor")|this.isCollapsed())){var c=this.getMap();if(c&&this._select&&this._select.elt){var h=n.context||ol.ext.getMapCanvas(this.getMap()).getContext("2d"),u=n.frameState.pixelRatio,d=[this._select.elt.offsetLeft-this._scrolldiv.scrollLeft+ol.ext.element.getStyle(this._select.elt,"width")/2,parseFloat(ol.ext.element.getStyle(this.element,"top"))||this.getMap().getSize()[1]],m=this._select.feature.getGeometry().getFirstCoordinate();m=this.getMap().getPixelFromCoordinate(m),h.save(),h.fillStyle=this.get("linkColor"),h.beginPath(),m[0]>d[0]?(h.moveTo((d[0]-5)*u,d[1]*u),h.lineTo((d[0]+5)*u,(d[1]+5)*u)):(h.moveTo((d[0]-5)*u,(d[1]+5)*u),h.lineTo((d[0]+5)*u,d[1]*u)),h.lineTo(m[0]*u,m[1]*u),h.fill(),h.restore()}}},ol.control.IsochroneGeoportail=function(n){var c=this;n||(n={}),n.typing==null&&(n.typing=300);var h=(n.className?n.className:"")+" ol-isochrone ol-routing";n.target||(h+=" ol-unselectable ol-control");var u=ol.ext.element.create("DIV",{className:h});if(!n.target){var d=ol.ext.element.create("BUTTON",{parent:u});d.addEventListener("click",function(){u.classList.toggle("ol-collapsed")})}ol.control.Control.call(this,{element:u,target:n.target}),this.set("iter",1);var m=ol.ext.element.create("DIV",{className:"content",parent:u});this._addSearchCtrl(m,n),ol.ext.element.create("BUTTON",{className:"ol-button ol-method-time selected",title:"isochrone",parent:m}).addEventListener("click",function(){this.setMethod("time")}.bind(this)),ol.ext.element.create("I",{className:"ol-button ol-method-distance",title:"isodistance",parent:m}).addEventListener("click",function(){this.setMethod("distance")}.bind(this)),ol.ext.element.create("I",{className:"ol-button ol-car selected",title:"by car",parent:m}).addEventListener("click",function(){this.setMode("car")}.bind(this)),ol.ext.element.create("I",{className:"ol-button ol-pedestrian",title:"by foot",parent:m}).addEventListener("click",function(){this.setMode("pedestrian")}.bind(this)),ol.ext.element.create("I",{className:"ol-button ol-direction-direct selected",title:"direct",parent:m}).addEventListener("click",function(){this.setDirection("direct")}.bind(this)),ol.ext.element.create("I",{className:"ol-button ol-direction-reverse",title:"reverse",parent:m}).addEventListener("click",function(){this.setDirection("reverse")}.bind(this));var g=ol.ext.element.create("DIV",{className:"ol-time",parent:m});ol.ext.element.create("DIV",{html:"isochrone:",parent:g}),ol.ext.element.create("INPUT",{type:"number",parent:g,min:0}).addEventListener("change",function(){c.set("hour",Number(this.value))}),ol.ext.element.create("TEXT",{parent:g,html:"h"}),ol.ext.element.create("INPUT",{type:"number",parent:g,min:0}).addEventListener("change",function(){c.set("minute",Number(this.value))}),ol.ext.element.create("TEXT",{parent:g,html:"mn"}),g=ol.ext.element.create("DIV",{className:"ol-distance",parent:m}),ol.ext.element.create("DIV",{html:"isodistance:",parent:g}),ol.ext.element.create("INPUT",{type:"number",step:"any",parent:g,min:0}).addEventListener("change",function(){c.set("distance",Number(this.value))}),ol.ext.element.create("TEXT",{parent:g,html:"km"}),g=ol.ext.element.create("DIV",{className:"ol-iter",parent:m}),ol.ext.element.create("DIV",{html:"Iteration:",parent:g}),ol.ext.element.create("INPUT",{type:"number",parent:g,value:1,min:1}).addEventListener("change",function(){c.set("iter",Number(this.value))}),ol.ext.element.create("I",{className:"ol-ok",html:"ok",parent:m}).addEventListener("click",function(){var x=0;switch(this.get("method")){case"distance":{x=this.get("distance")*1e3;break}default:{x=(this.get("hour")||0)*3600+(this.get("minute")||0)*60;break}}x&&this.get("coordinate")&&this.search(this.get("coordinate"),x)}.bind(this)),this.set("url","https://wxs.ign.fr/"+(n.apiKey||"essentiels")+"/isochrone/isochrone.json"),this._ajax=new ol.ext.Ajax({dataType:"JSON",auth:n.auth}),this._ajax.on("success",this._success.bind(this)),this._ajax.on("error",this._error.bind(this)),this._ajax.on("loadstart",function(){this.element.classList.add("ol-searching")}.bind(this)),this._ajax.on("loadend",function(){this.element.classList.remove("ol-searching")}.bind(this)),this.setMethod(n.method)},ol.ext.inherits(ol.control.IsochroneGeoportail,ol.control.Control),ol.control.IsochroneGeoportail.prototype.setMap=function(n){ol.control.Control.prototype.setMap.call(this,n),this._search.setMap(n)},ol.control.IsochroneGeoportail.prototype._addSearchCtrl=function(n,c){var h=ol.ext.element.create("DIV",{parent:n}),u=this._search=new ol.control.SearchGeoportail({className:"IGNF ol-collapsed",apiKey:c.apiKey,target:h});u.on("select",function(d){u.setInput(d.search.fulltext),this.set("coordinate",d.coordinate)}.bind(this)),u.on("change:input",function(){this.set("coordinate",!1)}.bind(this))},ol.control.IsochroneGeoportail.prototype.setMethod=function(n){n=/distance/.test(n)?"distance":"time",this.element.querySelector(".ol-method-time").classList.remove("selected"),this.element.querySelector(".ol-method-distance").classList.remove("selected"),this.element.querySelector(".ol-method-"+n).classList.add("selected"),this.element.querySelector("div.ol-time").classList.remove("selected"),this.element.querySelector("div.ol-distance").classList.remove("selected"),this.element.querySelector("div.ol-"+n).classList.add("selected"),this.set("method",n)},ol.control.IsochroneGeoportail.prototype.setMode=function(n){this.set("mode",n),this.element.querySelector(".ol-car").classList.remove("selected"),this.element.querySelector(".ol-pedestrian").classList.remove("selected"),this.element.querySelector(".ol-"+n).classList.add("selected")},ol.control.IsochroneGeoportail.prototype.setDirection=function(n){this.set("direction",n),this.element.querySelector(".ol-direction-direct").classList.remove("selected"),this.element.querySelector(".ol-direction-reverse").classList.remove("selected"),this.element.querySelector(".ol-direction-"+n).classList.add("selected")},ol.control.IsochroneGeoportail.prototype.search=function(n,c,h){var u=this.getMap()?this.getMap().getView().getProjection():"EPSG:3857",d=/distance/.test(this.get("method"))?"distance":"time";if(typeof c=="string"){var m=c.replace(/([0-9|.]*)([a-z]*)$/,"$2");switch(d="time",c=parseFloat(c),m){case"mn":{c=c*60;break}case"h":{c=c*3600;break}case"m":{d="distance";break}case"km":{d="distance",c=c*1e3;break}}}var g=Math.round(c*(this.get("iter")-(h||0))/this.get("iter"));if(typeof c=="number"){var x={"gp-access-lib":"2.1.0",location:ol.proj.toLonLat(n,u),graphName:this.get("mode")==="pedestrian"?"Pieton":"Voiture",exclusions:this.get("exclusions")||void 0,method:d,time:d==="time"?g:void 0,distance:d==="distance"?g:void 0,reverse:this.get("direction")==="reverse",smoothing:this.get("smoothing")||!0,holes:this.get("holes")||!1};this._ajax.send(this.get("url"),x,{coord:n,option:c,data:x,iteration:(h||0)+1})}},ol.control.IsochroneGeoportail.prototype._success=function(n){var c=this.getMap()?this.getMap().getView().getProjection():"EPSG:3857",h=new ol.format.WKT,u=n.response;u.feature=h.readFeature(u.wktGeometry,{dataProjection:"EPSG:4326",featureProjection:c}),u.feature.set("iteration",n.options.iteration),u.feature.set("method",n.options.data.method),u.feature.set(n.options.data.method,n.options.data[n.options.data.method]),delete u.wktGeometry,u.type="isochrone",u.iteration=n.options.iteration-1,this.dispatchEvent(u),n.options.iteration<this.get("iter")&&this.search(n.options.coord,n.options.option,n.options.iteration)},ol.control.IsochroneGeoportail.prototype._error=function(){this.dispatchEvent({type:"error"})},ol.control.LayerPopup=function(n){n=n||{},n.switcherClass="ol-layerswitcher-popup"+(n.switcherClass?" "+n.switcherClass:""),n.mouseover!==!1&&(n.mouseover=!0),ol.control.LayerSwitcher.call(this,n)},ol.ext.inherits(ol.control.LayerPopup,ol.control.LayerSwitcher),ol.control.LayerPopup.prototype.overflow=function(){},ol.control.LayerPopup.prototype.drawList=function(n,c){var h=this,u=function(d){d.preventDefault();var m=h._getLayerForLI(this);h.switchLayerVisibility(m,c),d.type==="touchstart"&&h.element.classList.add("ol-collapsed")};c.forEach(function(d){if(h.displayInLayerSwitcher(d)){var m=ol.ext.element.create("LI",{html:d.get("title")||d.get("name"),on:{"click touchstart":u},parent:n});h._setLayerForLI(m,d),h.testLayerVisibility(d)&&m.classList.add("ol-layer-hidden"),d.getVisible()&&m.classList.add("ol-visible")}})},ol.control.LayerShop=function(n){n=n||{},n.selection=!0,n.noScroll=!0,ol.control.LayerSwitcher.call(this,n),this.element.classList.add("ol-layer-shop");var c=this.element.insertBefore(ol.ext.element.create("DIV",{className:"ol-title-bar"}),this.getPanel());this.on("select",function(h){c.innerText=h.layer?h.layer.get("title"):"",this.element.setAttribute("data-layerClass",this.getLayerClass(h.layer))}.bind(this)),this._topbar=this.element.insertBefore(ol.ext.element.create("DIV",{className:"ol-bar ol-top-bar"}),this.getPanel()),this._bottombar=ol.ext.element.create("DIV",{className:"ol-bar ol-bottom-bar",parent:this.element}),this._controls=[]},ol.ext.inherits(ol.control.LayerShop,ol.control.LayerSwitcher),ol.control.LayerShop.prototype.setMap=function(n){this.getMap()&&this._controls.forEach(function(c){this.getMap().removeControl(c)}.bind(this)),ol.control.LayerSwitcher.prototype.setMap.call(this,n),n&&(this.selectLayer(),this._listener.removeLayer=n.getLayers().on("remove",function(c){c.element===this.getSelection()&&this.selectLayer()}.bind(this)),this._controls.forEach(function(c){this.getMap().addControl(c)}.bind(this)))},ol.control.LayerShop.prototype.getBarElement=function(n){return n==="bottom"?this._bottombar:this._topbar},ol.control.LayerShop.prototype.addControl=function(n,c){this._controls.push(n),n.setTarget(c==="bottom"?this._bottombar:this._topbar),this.getMap()&&this.getMap().addControl(n)},ol.control.LayerSwitcherImage=function(n){n=n||{},n.switcherClass="ol-layerswitcher-image",n.mouseover!==!1&&(n.mouseover=!0),ol.control.LayerSwitcher.call(this,n)},ol.ext.inherits(ol.control.LayerSwitcherImage,ol.control.LayerSwitcher),ol.control.LayerSwitcherImage.prototype.drawList=function(n,c){var h=this,u=function(d){d.preventDefault();var m=h._getLayerForLI(this);h.switchLayerVisibility(m,c),d.type=="touchstart"&&h.element.classList.add("ol-collapsed")};ol.ext.element.setStyle(n,{height:"auto"}),c.forEach(function(d){if(h.displayInLayerSwitcher(d)){var m=d.getPreview?d.getPreview():["none"],g=ol.ext.element.create("LI",{className:"ol-imgcontainer"+(d.getVisible()?" ol-visible":""),on:{"touchstart click":u},parent:n});h._setLayerForLI(g,d),m.forEach(function(x){ol.ext.element.create("IMG",{src:x,parent:g})}),ol.ext.element.create("p",{html:d.get("title")||d.get("name"),parent:g}),h.testLayerVisibility(d)&&g.classList.add("ol-layer-hidden")}})},ol.control.LayerSwitcherImage.prototype.overflow=function(){},ol.control.Legend=function(n){n=n||{};var c=document.createElement("div");if(n.target)c.className=n.className||"ol-legend";else{c.className=(n.className||"ol-legend")+" ol-unselectable ol-control"+(n.collapsible===!1?" ol-uncollapsible":" ol-collapsed");var h=document.createElement("button");h.setAttribute("type","button"),h.addEventListener("click",function(){this.toggle()}.bind(this)),c.appendChild(h),h=document.createElement("button"),h.setAttribute("type","button"),h.className="ol-closebox",h.addEventListener("click",function(){this.toggle()}.bind(this)),c.appendChild(h)}ol.control.CanvasBase.call(this,{element:c,target:n.target}),this._legend=n.legend,this._legend.getCanvas().className="ol-legendImg",c.appendChild(this._legend.getCanvas()),c.appendChild(this._legend.getListElement()),n.collapsible!==!1&&n.collapsed===!1&&this.show(),this._legend.on("select",function(u){this.dispatchEvent(u)}.bind(this)),this._legend.on("refresh",function(){if(this._onCanvas&&this.getMap())try{this.getMap().renderSync()}catch{}}.bind(this))},ol.ext.inherits(ol.control.Legend,ol.control.CanvasBase),ol.control.Legend.prototype.getLegend=function(){return this._legend},ol.control.Legend.prototype.setCanvas=function(n){if(this._onCanvas=n,this.element.style.visibility=n?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.Legend.prototype.onCanvas=function(){return!!this._onCanvas},ol.control.Legend.prototype._draw=function(n){if(this._onCanvas&&!this.element.classList.contains("ol-collapsed")){var c=this._legend.getCanvas(),h=this.getContext(n),u=h.canvas.height-c.height;h.save(),h.rect(0,u,c.width,c.height);var d="#fff";this._legend.getTextStyle().getBackgroundFill()&&(d=ol.color.asString(this._legend.getTextStyle().getBackgroundFill().getColor())),h.fillStyle=h.strokeStyle=d,h.lineWidth=10,h.lineJoin="round",h.stroke(),h.clearRect(0,u,c.width,c.height),h.fill(),h.drawImage(c,0,u),h.restore()}},ol.control.Legend.prototype.show=function(){if(this.element.classList.contains("ol-collapsed")&&(this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!1}),this.getMap()))try{this.getMap().renderSync()}catch{}},ol.control.Legend.prototype.hide=function(){if(!this.element.classList.contains("ol-collapsed")&&(this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!0}),this.getMap()))try{this.getMap().renderSync()}catch{}},ol.control.Legend.prototype.collapse=function(n){n===!1?this.show():this.hide()},ol.control.Legend.prototype.isCollapsed=function(){return this.element.classList.contains("ol-collapsed")},ol.control.Legend.prototype.toggle=function(){if(this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:this.element.classList.contains("ol-collapsed")}),this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.MapZone=function(n){n||(n={});var c=document.createElement("div");if(n.target)c=ol.ext.element.create("DIV",{className:n.className||"ol-mapzone"});else{c=ol.ext.element.create("DIV",{className:(n.className||"ol-mapzone")+" ol-unselectable ol-control ol-collapsed"});var h=ol.ext.element.create("BUTTON",{type:"button",on:{click:function(){c.classList.toggle("ol-collapsed"),u.forEach(function(d){d.updateSize()})}.bind(this)},parent:c});ol.ext.element.create("I",{parent:h})}ol.control.Control.call(this,{element:c,target:n.target}),this.set("centerOnClick",n.centerOnClick);var u=this._maps=[];this._projection=n.projection,this._layer=n.layer,n.zones.forEach(this.addZone.bind(this)),setTimeout(function(){u.forEach(function(d){d.updateSize()})})},ol.ext.inherits(ol.control.MapZone,ol.control.Control),ol.control.MapZone.prototype.setCollapsed=function(n){n?(this.element.classList.remove("ol-collapsed"),this.getMaps().forEach(function(c){c.updateSize()})):this.element.classList.add("ol-collapsed")},ol.control.MapZone.prototype.getCollapsed=function(){return this.element.classList.contains("ol-collapsed")},ol.control.MapZone.prototype.setVisible=ol.control.MapZone.prototype.setCollapsed,ol.control.MapZone.prototype.getMaps=function(){return this._maps},ol.control.MapZone.prototype.getLength=function(){return this._maps.length},ol.control.MapZone.prototype.addZone=function(n){var c=new ol.View({zoom:6,center:[0,0],projection:this._projection}),h;n.map?h=ol.proj.transformExtent(n.map.getView().calculateExtent(),n.map.getView().getProjection(),c.getProjection()):h=ol.proj.transformExtent(n.extent,"EPSG:4326",c.getProjection());var u=ol.ext.element.create("DIV",{className:"ol-mapzonezone",parent:this.element,click:function(){var g=-1;this._maps.forEach(function(x,E){x.get("zone")===n&&(g=E)}),this.dispatchEvent({type:"select",zone:n,index:g,coordinate:ol.extent.getCenter(h),extent:h}),this.get("centerOnClick")!==!1&&this.getMap().getView().fit(h),this.setVisible(!1)}.bind(this)}),d;n.layer?d=n.layer:typeof this._layer=="function"?d=this._layer(n):d=new this._layer.constructor({source:this._layer.getSource()});var m=new ol.Map({target:u,view:c,controls:[],interactions:[],layers:[d]});m.set("zone",n),this._maps.push(m),c.fit(h),ol.ext.element.create("P",{html:n.title,parent:u})},ol.control.MapZone.prototype.removeZone=function(n){var c=this.element.querySelectorAll(".ol-mapzonezone")[n];c&&(c.remove(),this._maps.splice(n,1))},ol.control.MapZone.zones={},ol.control.MapZone.zones.DOM=[{title:"Guadeloupe",extent:[-61.898594315312444,15.75623038647845,-60.957887532935324,16.575317670979473]},{title:"Guyane",extent:[-54.72525931072715,2.1603763430019,-51.528236062921344,5.7984307809552575]},{title:"Martinique",extent:[-61.257556528564756,14.387506317407514,-60.76934912110432,14.895067461729951]},{title:"Mayotte",extent:[44.959844536967815,-13.01674138212816,45.35328866510648,-12.65521942207829]},{title:"La r\xE9union",extent:[55.17059012967656,-21.407680069231688,55.88195702001797,-20.85560221637526]}],ol.control.MapZone.zones.TOM=[{title:"Polyn\xE9sie Fran\xE7aise",extent:[206.23664226630862,-22.189040615809787,221.85920743981987,-10.835039595040698]},{title:"Nouvelle Cal\xE9donie",extent:[163.76420580160925,-22.581641092751838,167.66984709498706,-19.816411635668445]},{title:"St-Pierre et Miquelon",extent:[-56.453698765748676,46.74449858188555,-56.0980198121544,47.14669874229787]},{title:"Wallis et Futuna",extent:[181.7588623143665,-14.7341169873267,183.95612353301715,-13.134720799175085]},{title:"St-Martin St-Barth\xE9lemy",extent:[-63.1726389501678,17.806097291313506,-62.7606535945649,18.13267688837938]}],ol.control.MapZone.zones.DOMTOM=[{title:"M\xE9tropole",extent:[-5.318421740712579,41.16082274292913,9.73284186155716,51.21957336557702]}].concat(ol.control.MapZone.zones.DOM,ol.control.MapZone.zones.TOM),ol.control.Notification=function(n){n=n||{};var c=document.createElement("DIV");this.contentElement=ol.ext.element.create("DIV",{click:function(){this.get("hideOnClick")&&this.hide()}.bind(this),parent:c});var h=(n.className||"")+" ol-notification";n.target||(h+=" ol-unselectable ol-control ol-collapsed"),c.setAttribute("class",h),ol.control.Control.call(this,{element:c,target:n.target}),this.set("closeBox",n.closeBox),this.set("hideOnClick",n.hideOnClick)},ol.ext.inherits(ol.control.Notification,ol.control.Control),ol.control.Notification.prototype.show=function(n,c){var h=this,u=this.element;n&&(n instanceof Node?(this.contentElement.innerHTML="",this.contentElement.appendChild(n)):this.contentElement.innerHTML=n,this.get("closeBox")?(this.contentElement.classList.add("ol-close"),ol.ext.element.create("SPAN",{className:"closeBox",click:function(){this.hide()}.bind(this),parent:this.contentElement})):this.contentElement.classList.remove("ol-close")),this._listener&&(clearTimeout(this._listener),this._listener=null),u.classList.add("ol-collapsed"),this._listener=setTimeout(function(){u.classList.remove("ol-collapsed"),!c||c>=0?h._listener=setTimeout(function(){u.classList.add("ol-collapsed"),h._listener=null},c||3e3):h._listener=null},100)},ol.control.Notification.prototype.hide=function(){this._listener&&(clearTimeout(this._listener),this._listener=null),this.element.classList.add("ol-collapsed")},ol.control.Notification.prototype.toggle=function(n){this.element.classList.contains("ol-collapsed")?this.show(null,n):this.hide()},ol.control.Overlay=function(n){n||(n={});var c=ol.ext.element.create("DIV",{className:"ol-unselectable ol-overlay "+(n.className||""),html:n.content});ol.control.Control.call(this,{element:c,target:n.target});var h=this;n.hideOnClick&&c.addEventListener("click",function(){h.hide()}),this.set("closeBox",n.closeBox),this._timeout=!1,this.setContent(n.content)},ol.ext.inherits(ol.control.Overlay,ol.control.Control),ol.control.Overlay.prototype.setContent=function(n){var c=this;if(n){var h=this.element;if(n instanceof Element?(h.innerHTML="",h.appendChild(n)):n!==void 0&&(h.innerHTML=n),this.get("closeBox")){var u=document.createElement("div");u.classList.add("ol-closebox"),u.addEventListener("click",function(){c.hide()}),h.insertBefore(u,h.firstChild)}}},ol.control.Overlay.prototype.show=function(n,c){var h=this,u=this.element;u.style.display="block",c?(this.center_=this.getMap().getPixelFromCoordinate(c),u.style.top=this.center_[1]+"px",u.style.left=this.center_[0]+"px"):(this.center_=!1,u.style.top="",u.style.left=""),n&&this.setContent(n),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){u.classList.add("ol-visible"),u.style.top="",u.style.left="",h.dispatchEvent({type:"change:visible",visible:!0,element:h.element})},10)},ol.control.Overlay.prototype.showImage=function(n,c){c=c||{};var h=ol.ext.element.create("DIV",{className:"ol-fullscreen-image"});ol.ext.element.create("IMG",{src:n,parent:h}),c.title&&(h.classList.add("ol-has-title"),ol.ext.element.create("P",{html:c.title,parent:h})),this.show(h,c.coordinate)},ol.control.Overlay.prototype.hide=function(){var n=this.element;this.element.classList.remove("ol-visible"),this.center_&&(n.style.top=this.center_[1]+"px",n.style.left=this.center_[0]+"px",this.center_=!1),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){n.style.display="none"},500),this.dispatchEvent({type:"change:visible",visible:!1,element:this.element})},ol.control.Overlay.prototype.toggle=function(){this.getVisible()?this.hide():this.show()},ol.control.Overlay.prototype.getVisible=function(){return ol.ext.element.getStyle(this.element,"display")!=="none"},ol.control.Overlay.prototype.setClass=function(n){var c=this.element.classList.contains("ol-visible");this.element.className=("ol-unselectable ol-overlay "+(c?"ol-visible ":"")+n).trim()},ol.control.Overview=function(n){n=n||{};var c=this;this.minZoom=n.minZoom||0,this.maxZoom=n.maxZoom||18,this.rotation=n.rotation;var h;if(n.target)h=document.createElement("div"),this.panel_=n.target;else{h=document.createElement("div"),h.classList.add("ol-overview","ol-unselectable","ol-control","ol-collapsed"),/top/.test(n.align)&&h.classList.add("ol-control-top"),/right/.test(n.align)&&h.classList.add("ol-control-right");var u=document.createElement("button");u.setAttribute("type","button"),u.addEventListener("touchstart",function(m){c.toggleMap(),m.preventDefault()}),u.addEventListener("click",function(){c.toggleMap()}),h.appendChild(u),this.panel_=document.createElement("div"),this.panel_.classList.add("panel"),h.appendChild(this.panel_)}ol.control.Control.call(this,{element:h,target:n.target}),this.ovmap_=new ol.Map({controls:new ol.Collection,interactions:new ol.Collection,target:this.panel_,view:new ol.View({zoom:2,center:[0,0],projection:n.projection}),layers:n.layers}),this.oview_=this.ovmap_.getView(),this.extentLayer=new ol.layer.Vector({name:"Cache extent",source:new ol.source.Vector,style:n.style||[new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(255,0,0, 1)"}),stroke:new ol.style.Stroke({width:7,color:"rgba(255,0,0, 0.8)"}),radius:5}),stroke:new ol.style.Stroke({width:5,color:"rgba(255,0,0,0.8)"})})]}),this.ovmap_.addLayer(this.extentLayer);var d=function(m,g){var x=3*m*Math.PI/2,E=g>0?-1/g:-100,P=Math.cos(x)*Math.pow(2,E);return function(L){return L=1-Math.cos(L*Math.PI/2),1-Math.cos(x*L)*Math.pow(2,E*L)+P*L}};this.ovmap_.addInteraction(new ol.interaction.Pointer({handleDownEvent:function(m){return n.panAnimation!==!1?n.panAnimation=="elastic"||n.elasticPan?c.getMap().getView().animate({center:m.coordinate,easing:d(2,.3),duration:1e3}):c.getMap().getView().animate({center:m.coordinate,duration:300}):c.getMap().getView().setCenter(m.coordinate),!1}}))},ol.ext.inherits(ol.control.Overview,ol.control.Control),ol.control.Overview.prototype.getOverviewMap=function(){return this.ovmap_},ol.control.Overview.prototype.toggleMap=function(){this.element.classList.toggle("ol-collapsed"),this.ovmap_.updateSize(),this.setView()},ol.control.Overview.prototype.setPosition=function(n){/top/.test(n)?this.element.classList.add("ol-control-top"):this.element.classList.remove("ol-control-top"),/right/.test(n)?this.element.classList.add("ol-control-right"):this.element.classList.remove("ol-control-right")},ol.control.Overview.prototype.setMap=function(n){if(this._listener)for(var c in this._listener)ol.Observable.unByKey(this._listener[c]);this._listener={},ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener.map=n.on("change:view",function(){this._listener.view&&ol.Observable.unByKey(this._listener.view),n.getView()&&(this._listener.view=n.getView().on("propertychange",this.setView.bind(this)),this.setView())}.bind(this)),this._listener.view=n.getView().on("propertychange",this.setView.bind(this)),this.setView())},ol.control.Overview.prototype.calcExtent_=function(n){var c=this.getMap();if(c){var h=this.extentLayer.getSource();h.clear();var u=new ol.Feature,d=c.getSize(),m=c.getView().getResolution(),g=c.getView().getRotation(),x=c.getView().getCenter();if(m){var E=m*d[0]/2,P=m*d[1]/2,L=this.oview_.getResolution();if(E/L>5||P/L>5){var F=Math.cos(g),U=Math.sin(g),A,G,B;for(n=[[-E,-P],[-E,P],[E,P],[E,-P]],A=0;A<4;++A)G=n[A][0],B=n[A][1],n[A][0]=x[0]+G*F-B*U,n[A][1]=x[1]+G*U+B*F;u.setGeometry(new ol.geom.Polygon([n]))}else u.setGeometry(new ol.geom.Point(x));h.addFeature(u)}}},ol.control.Overview.prototype.setView=function(n){if(!n){this.setView({key:"rotation"}),this.setView({key:"resolution"}),this.setView({key:"center"});return}switch(n.key){case"rotation":{this.rotation?this.oview_.setRotation(this.getMap().getView().getRotation()):this.oview_.getRotation()&&this.oview_.setRotation(0);break}case"center":{var c=this.getMap().getView().calculateExtent(this.getMap().getSize()),h=this.oview_.calculateExtent(this.ovmap_.getSize());(c[0]<h[0]||c[1]<h[1]||c[2]>h[2]||c[3]>h[3])&&this.oview_.setCenter(this.getMap().getView().getCenter());break}case"resolution":{var u=Math.round(this.oview_.getZoomForResolution(this.getMap().getView().getResolution())/2)*2-4;u=Math.min(this.maxZoom,Math.max(this.minZoom,u)),this.oview_.setZoom(u);break}default:break}this.calcExtent_()},ol.control.Permalink=function(n){var c=n||{},h=this,u=document.createElement("button");if(this.replaceState_=c.urlReplace!==!1,this.fixed_=c.fixed||6,this.hash_=c.anchor?"#":"?",this._localStorage=c.localStorage,!this._localStorage)try{localStorage.removeItem("ol@permalink")}catch{console.warn("Failed to access localStorage...")}function d(){typeof c.onclick=="function"?c.onclick(h.getLink()):h.setUrlReplace(!h.replaceState_)}u.addEventListener("click",d,!1),u.addEventListener("touchstart",d,!1);var m=document.createElement("div");m.className=(c.className||"ol-permalink")+" ol-unselectable ol-control",m.appendChild(u),(c.hidden||c.visible===!1)&&ol.ext.element.hide(m),ol.control.Control.call(this,{element:m,target:c.target}),this.set("geohash",c.geohash),this.set("initial",!1),this.on("change",this.viewChange_.bind(this)),this.search_={};var g={},x=document.location.hash||document.location.search||"";if(this.replaceState_&&!x&&this._localStorage)try{x=localStorage["ol@permalink"]}catch{console.warn("Failed to access localStorage...")}if(x){x=x.replace(/(^#|^\?)/,"").split("&");for(var E=0;E<x.length;E++){var P=x[E].split("=");switch(P[0]){case"lon":case"lat":case"z":case"r":{g[P[0]]=P[1];break}case"gh":{var L=P[1].split("-"),F=ol.geohash.toLonLat(L[0]);g.lon=F[0],g.lat=F[1],g.z=L[1];break}case"l":break;default:this.search_[P[0]]=P[1]}}}g.hasOwnProperty("lon")&&this.set("initial",g),this.replaceState_&&this.setPosition()},ol.ext.inherits(ol.control.Permalink,ol.control.Control),ol.control.Permalink.prototype.getInitialPosition=function(){return this.get("initial")},ol.control.Permalink.prototype.setMap=function(n){this._listener&&(ol.Observable.unByKey(this._listener.change),ol.Observable.unByKey(this._listener.moveend)),this._listener=null,ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener={change:n.getLayerGroup().on("change",this.layerChange_.bind(this)),moveend:n.on("moveend",this.viewChange_.bind(this))},this.setPosition())},ol.control.Permalink.prototype.getLayerByLink=function(n,c){!c&&this.getMap()&&(c=this.getMap().getLayers().getArray());for(var h=0;h<c.length;h++){if(c[h].get("permalink")==n)return c[h];if(c[h].getLayers){var u=this.getLayerByLink(n,c[h].getLayers().getArray());if(u)return u}}return!1},ol.control.Permalink.prototype.setGeohash=function(n){this.set("geohash",n),this.setUrlParam()},ol.control.Permalink.prototype.setPosition=function(n){var c=this.getMap();if(!c)return;var h=this.replaceState_||n?document.location.hash||document.location.search:"";if(!h&&this._localStorage)try{h=localStorage["ol@permalink"]}catch{console.warn("Failed to access localStorage...")}if(!h)return;var u,d,m={};for(h=h.replace(/(^#|^\?)/,"").split("&"),u=0;u<h.length;u++)d=h[u].split("="),m[d[0]]=d[1];if(m.gh){var g=m.gh.split("-"),x=ol.geohash.toLonLat(g[0]);m.lon=x[0],m.lat=x[1],m.z=g[1]}var E=ol.proj.transform([Number(m.lon),Number(m.lat)],"EPSG:4326",c.getView().getProjection());E[0]&&E[1]&&c.getView().setCenter(E),m.z&&c.getView().setZoom(Number(m.z)),m.r&&c.getView().setRotation(Number(m.r));function P(A){A||(A=c.getLayers().getArray());for(var G=0;G<A.length;G++)A[G].get("permalink")&&A[G].setVisible(!1),A[G].getLayers&&P(A[G].getLayers().getArray())}if(m.l){P();var L=m.l.split("|");for(u=0;u<L.length;u++){d=L[u].split(":");var F=this.getLayerByLink(d[0]),U=Number(d[1]);F&&(F.setOpacity(U),F.setVisible(!0))}}},ol.control.Permalink.prototype.getUrlParams=function(){return this.search_},ol.control.Permalink.prototype.setUrlParam=function(n,c){n&&(c===void 0||c===""?delete this.search_[encodeURIComponent(n)]:this.search_[encodeURIComponent(n)]=encodeURIComponent(c)),this.viewChange_()},ol.control.Permalink.prototype.getUrlParam=function(n){return decodeURIComponent(this.search_[encodeURIComponent(n)]||"")},ol.control.Permalink.prototype.hasUrlParam=function(n){return this.search_.hasOwnProperty(encodeURIComponent(n))},ol.control.Permalink.prototype.getLink=function(n){var c=this.getMap(),h=ol.proj.transform(c.getView().getCenter(),c.getView().getProjection(),"EPSG:4326"),u=Math.round(c.getView().getZoom()*10)/10,d=c.getView().getRotation(),m=this.layerStr_,g=(d?"&r="+Math.round(d*1e4)/1e4:"")+(m?"&l="+m:"");if(this.get("geohash")){var x=ol.geohash.fromLonLat(h,8);g="gh="+x+"-"+u+g}else g="lon="+h[0].toFixed(this.fixed_)+"&lat="+h[1].toFixed(this.fixed_)+"&z="+u+g;if(n==="position")return g;for(var E in this.search_)g+="&"+E+(typeof this.search_[E]<"u"?"="+this.search_[E]:"");return n?g:document.location.protocol+"//"+document.location.host+document.location.pathname+this.hash_+g},ol.control.Permalink.prototype.getUrlReplace=function(){return this.replaceState_},ol.control.Permalink.prototype.setUrlReplace=function(n){try{if(this.replaceState_=n,n)window.history.replaceState(null,null,this.getLink());else{var c="";for(var h in this.search_)c+=(c==""?"?":"&")+h+(typeof this.search_[h]<"u"?"="+this.search_[h]:"");window.history.replaceState(null,null,document.location.origin+document.location.pathname+c)}}catch{}},ol.control.Permalink.prototype.viewChange_=function(){try{this.replaceState_&&window.history.replaceState(null,null,this.getLink())}catch{}if(this._localStorage)try{localStorage["ol@permalink"]=this.getLink(this._localStorage)}catch{console.warn("Failed to access localStorage...")}},ol.control.Permalink.prototype.layerChange_=function(){this._tout&&(clearTimeout(this._tout),this._tout=null),this._tout=setTimeout(function(){this._tout=null;var n="";function c(h){for(var u=0;u<h.length;u++)h[u].getVisible()&&h[u].get("permalink")&&(n&&(n+="|"),n+=h[u].get("permalink")+":"+h[u].get("opacity")),h[u].getLayers&&c(h[u].getLayers().getArray())}c(this.getMap().getLayers().getArray()),this.layerStr_=n,this.viewChange_()}.bind(this),200)},ol.control.Print=function(n){n||(n={});var c=ol.ext.element.create("DIV",{className:n.className||"ol-print"});n.target||(c.classList.add("ol-unselectable","ol-control"),ol.ext.element.create("BUTTON",{type:"button",title:n.title||"Print",click:function(){this.print()}.bind(this),parent:c})),ol.control.Control.call(this,{element:c,target:n.target}),this.set("immediate",n.immediate),this.set("imageType",n.imageType||"image/jpeg"),this.set("quality",n.quality||.8),this.set("orientation",n.orientation)},ol.ext.inherits(ol.control.Print,ol.control.Control),ol.control.Print.prototype.toClipboard=function(n,c){try{n.canvas.toBlob(function(h){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},h.type,{value:h,enumerable:!0}))]),typeof c=="function"&&c(!0)}catch{typeof c=="function"&&c(!1)}})}catch{typeof c=="function"&&c(!1)}},ol.control.Print.prototype.copyMap=function(n,c){this.once("print",function(h){this.toClipboard(h,c)}.bind(this)),this.print(n)},ol.control.Print.prototype._getCanvas=function(n,c,h){var u;if(n.context)h=n.context.canvas;else{if(h)u=h.getContext("2d");else{h=document.createElement("canvas");var d=this.getMap().getSize();h.width=d[0],h.height=d[1],u=h.getContext("2d"),/jp.*g$/.test(c)&&(u.fillStyle=this.get("bgColor")||"white",u.fillRect(0,0,h.width,h.height))}this.getMap().getViewport().querySelectorAll(".ol-layers canvas, canvas.ol-fixedoverlay").forEach(function(m){if(m.width){if(u.save(),m.parentNode.style.opacity==="0")return;u.globalAlpha=parseFloat(m.parentNode.style.opacity)||1,ol.ext.element.getStyle(m.parentNode,"mix-blend-mode")==="multiply"&&(u.globalCompositeOperation="multiply");var g=ol.ext.element.getStyle(m,"transform")||ol.ext.element.getStyle(m,"-webkit-transform");/^matrix/.test(g)?(g=g.replace(/^matrix\(|\)$/g,"").split(","),g.forEach(function(x,E){g[E]=parseFloat(x)}),u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),u.drawImage(m,0,0)):u.drawImage(m,0,0,ol.ext.element.getStyle(m,"width"),ol.ext.element.getStyle(m,"height")),u.restore()}}.bind(this))}return h},ol.control.Print.prototype.fastPrint=function(n,c){n=n||{},this._ol6?requestAnimationFrame(function(){c(this._getCanvas({},n.imageType,n.canvas))}.bind(this)):(this.getMap().once("postcompose",function(h){h.context||(this._ol6=!0),c(this._getCanvas(h,n.imageType,n.canvas))}.bind(this)),this.getMap().render())},ol.control.Print.prototype.print=function(n){n=n||{};var c=n.imageType||this.get("imageType"),h=n.quality||this.get("quality");if(this.getMap()){if(n.immediate!=="silent"&&this.dispatchEvent(Object.assign({type:"printing"},n)),!n.immediate){setTimeout(function(){n=Object.assign({},n),n.immediate="silent",this.print(n)}.bind(this),200);return}this.getMap().once(this.get("immediate")?"postcompose":"rendercomplete",function(u){var d=this._getCanvas(u,c),m=n.size||[210,297],g=n.format||"a4",x,E,P,L=n.orient||this.get("orientation"),F=typeof n.margin=="number"?n.margin:10;if(d){L!=="landscape"&&L!=="portrait"&&(L=d.width>d.height?"landscape":"portrait"),L==="landscape"&&(m=[m[1],m[0]]);var U=Math.min((m[0]-2*F)/d.width,(m[1]-2*F)/d.height);x=U*d.width,E=U*d.height,P=[(m[0]-x)/2,(m[1]-E)/2]}var A;try{A=d?d.toDataURL(c,h):null}catch{this.dispatchEvent({type:"error",canvas:d});return}var G=Object.assign({type:"print",print:{format:g,orientation:L,unit:"mm",size:m,position:P,imageWidth:x,imageHeight:E},image:A,imageType:c,quality:h,canvas:d},n);this.dispatchEvent(G)}.bind(this)),this.getMap().render()}},ol.control.PrintDialog=function(n){n||(n={}),this._lang=n.lang||"en";var c=ol.ext.element.create("DIV",{className:(n.className||"ol-print")+" ol-unselectable ol-control"});ol.ext.element.create("BUTTON",{type:"button",title:n.title||"Print",click:function(){this.print()}.bind(this),parent:c}),ol.control.Control.call(this,{element:c}),n.openWindow&&this.on("print",function(W){W.canvas&&window.open().document.write('<img src="'+W.canvas.toDataURL()+'"/>')}),n.target=ol.ext.element.create("DIV");var h=this._printCtrl=new ol.control.Print(n);h.on(["print","error","printing"],function(W){d.setAttribute("data-status",W.type),W.clipboard||this.dispatchEvent(W)}.bind(this)),this._compass=new ol.control.Compass({src:n.northImage||"compact",visible:!1,className:"olext-print-compass",style:new ol.style.Stroke({color:"#333",width:0})});var u=this._printDialog=new ol.control.Dialog({target:document.body,closeBox:!0,className:"ol-ext-print-dialog"}),d=u.getContentElement();this._input={};var m=ol.ext.element.create("DIV",{className:"ol-print-param",parent:d});this._pages=[ol.ext.element.create("DIV",{className:"ol-page"})];var g=ol.ext.element.create("DIV",{className:"ol-map",parent:this._pages[0]});ol.ext.element.create("DIV",{html:this._pages[0],className:"ol-print-map",parent:d}),ol.ext.element.create("H2",{html:this.i18n("title"),parent:m});var x=ol.ext.element.create("UL",{parent:m}),E=ol.ext.element.create("LI",{className:"ol-orientation",parent:x});this._input.orientation={list:E};var P=ol.ext.element.create("LABEL",{className:"portrait",parent:E});this._input.orientation.portrait=ol.ext.element.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"portrait",checked:!0,on:{change:function(W){this.setOrientation(W.target.value)}.bind(this)},parent:P}),ol.ext.element.create("SPAN",{html:this.i18n("portrait"),parent:P}),P=ol.ext.element.create("LABEL",{className:"landscape",parent:E}),this._input.orientation.landscape=ol.ext.element.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"landscape",on:{change:function(W){this.setOrientation(W.target.value)}.bind(this)},parent:P}),ol.ext.element.create("SPAN",{html:this.i18n("landscape"),parent:P});var L;E=ol.ext.element.create("LI",{html:ol.ext.element.create("LABEL",{html:this.i18n("size")}),className:"ol-size",parent:x});var F=this._input.size=ol.ext.element.create("SELECT",{on:{change:function(){this.setSize(F.value||ft)}.bind(this)},parent:E});for(L in this.paperSize)ol.ext.element.create("OPTION",{html:L+(this.paperSize[L]?" - "+this.paperSize[L][0]+"x"+this.paperSize[L][1]+" mm":this.i18n("custom")),value:L,parent:F});E=ol.ext.element.create("LI",{html:ol.ext.element.create("LABEL",{html:this.i18n("margin")}),className:"ol-margin",parent:x});var U=this._input.margin=ol.ext.element.create("SELECT",{on:{change:function(){this.setMargin(U.value)}.bind(this)},parent:E});for(L in this.marginSize)ol.ext.element.create("OPTION",{html:this.i18n(L)+" - "+this.marginSize[L]+" mm",value:this.marginSize[L],parent:U});E=ol.ext.element.create("LI",{html:ol.ext.element.create("LABEL",{html:this.i18n("scale")}),className:"ol-scale",parent:x});var A=this._input.scale=ol.ext.element.create("SELECT",{on:{change:function(){this.setScale(parseInt(A.value))}.bind(this)},parent:E});Object.keys(this.scales).forEach(function(W){ol.ext.element.create("OPTION",{html:this.scales[W],value:W,parent:A})}.bind(this)),E=ol.ext.element.create("LI",{className:"ol-legend",parent:x});var G=ol.ext.element.createSwitch({html:this.i18n("legend"),checked:!1,on:{change:function(){_t.legend.control.setCanvas(G.checked)}.bind(this)},parent:E});E=ol.ext.element.create("LI",{className:"ol-print-north",parent:x});var B=this._input.north=ol.ext.element.createSwitch({html:this.i18n("north"),checked:"checked",on:{change:function(){B.checked?this._compass.element.classList.add("ol-print-compass"):this._compass.element.classList.remove("ol-print-compass"),this.getMap().render()}.bind(this)},parent:E});E=ol.ext.element.create("LI",{className:"ol-print-title",parent:x});var O=ol.ext.element.createSwitch({html:this.i18n("mapTitle"),checked:!1,on:{change:function(W){_t.title.control.setVisible(W.target.checked)}.bind(this)},parent:E}),K=ol.ext.element.create("INPUT",{type:"text",placeholder:this.i18n("mapTitle"),on:{keydown:function(W){W.keyCode===13&&W.preventDefault()},keyup:function(){_t.title.control.setTitle(K.value)},change:function(){_t.title.control.setTitle(K.value)}.bind(this)},parent:E}),Q=ol.ext.element.create("DIV",{className:"ol-user-param",parent:m});E=ol.ext.element.create("LI",{className:"ol-saveas",parent:x});var et=ol.ext.element.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:E}),lt=ol.ext.element.create("SELECT",{on:{change:function(){if(this.formats[lt.value].clipboard)h.copyMap(this.formats[lt.value],function(nt){nt&&(et.classList.add("visible"),setTimeout(function(){et.classList.remove("visible")},1e3))});else{var W=typeof this.getSize()=="string"?this.getSize():null,rt=Object.assign({format:W,size:W?this.paperSize[W]:null,orient:this.getOrientation(),margin:this.getMargin()},this.formats[lt.value]);h.print(rt)}lt.value=""}.bind(this)},parent:E});ol.ext.element.create("OPTION",{html:this.i18n("saveas"),style:{display:"none"},value:"",parent:lt}),this.formats.forEach(function(W,rt){if(W.pdf){if(n.pdf===!1)return}else if(W.clipboard){if(n.copy===!1)return}else if(n.save===!1)return;ol.ext.element.create("OPTION",{html:this.i18n(W.title),value:rt,parent:lt})}.bind(this)),E=ol.ext.element.create("LI",{className:"ol-savelegend",parent:x});var pt=ol.ext.element.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:E}),T=ol.ext.element.create("SELECT",{on:{change:function(){var W=_t.legend.control.getLegend().getCanvas(),rt=document.createElement("CANVAS");rt.width=W.width,rt.height=W.height;var nt=rt.getContext("2d");if(nt.fillStyle="#fff",nt.fillRect(0,0,rt.width,rt.height),nt.drawImage(W,0,0),this.formats[T.value].clipboard)rt.toBlob(function(ge){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},ge.type,{value:ge,enumerable:!0}))]),pt.classList.add("visible"),setTimeout(function(){pt.classList.remove("visible")},1e3)}catch{}},"image/png");else{var vt;try{vt=rt.toDataURL(this.formats[T.value].imageType,this.formats[T.value].quality);var Mt=typeof this.getSize()=="string"?this.getSize():"A4",Bt=rt.width/96*25.4,Vt=rt.height/96*25.4,Lt=this.paperSize[Mt];this.getOrientation()==="landscape"&&(Lt=[Lt[1],Lt[0]]);var Ne=[(Lt[0]-Bt)/2,(Lt[1]-Vt)/2];this.dispatchEvent({type:"print",print:{legend:!0,format:Mt,orientation:this.getOrientation(),unit:"mm",size:this.paperSize[Mt],position:Ne,imageWidth:Bt,imageHeight:Vt},image:vt,imageType:this.formats[T.value].imageType,pdf:this.formats[T.value].pdf,quality:this.formats[T.value].quality,canvas:rt})}catch{}}T.value=""}.bind(this)},parent:E});ol.ext.element.create("OPTION",{html:this.i18n("saveLegend"),style:{display:"none"},value:"",parent:T}),this.formats.forEach(function(W,rt){ol.ext.element.create("OPTION",{html:this.i18n(W.title),value:rt,parent:T})}.bind(this));var ct=ol.ext.element.create("DIV",{className:"ol-ext-buttons",parent:m});ol.ext.element.create("BUTTON",{html:this.i18n("printBt"),type:"submit",click:function(W){W.preventDefault(),window.print()},parent:ct}),ol.ext.element.create("BUTTON",{html:this.i18n("cancel"),type:"button",click:function(){u.hide()},parent:ct}),ol.ext.element.create("DIV",{html:this.i18n("errorMsg"),className:"ol-error",parent:m});var ut,ft,$,_t={};u.on("show",function(){this.dispatchEvent({type:"show",userElement:Q,dialog:this._printDialog,page:this.getPage()});var W=this.getMap();W&&(document.body.classList.add("ol-print-document"),ut=W.getTargetElement(),ft=W.getSize(),typeof this.getSize()=="string"?this.setSize(this.getSize()):this.setSize(ft),W.setTarget(g),$&&ol.Observable.unByKey($),$=W.on("moveend",function(){this.setScale(ol.sphere.getMapScale(W))}.bind(this)),this.setScale(ol.sphere.getMapScale(W)),_t={},this.getMap().getControls().forEach(function(rt){rt instanceof ol.control.Legend&&(_t.legend={control:rt}),rt instanceof ol.control.CanvasTitle&&(_t.title={control:rt}),rt instanceof ol.control.Compass&&(_t.compass?rt.element.classList.remove("ol-print-compass"):(this._input.north.checked?rt.element.classList.add("ol-print-compass"):rt.element.classList.remove("ol-print-compass"),this._compass=rt,_t.compass={control:rt}))}.bind(this)),_t.title?(O.checked=_t.title.isVisible=_t.title.control.getVisible(),K.value=_t.title.control.getTitle(),O.parentNode.parentNode.classList.remove("hidden")):O.parentNode.parentNode.classList.add("hidden"),_t.legend?(_t.legend.ison=_t.legend.control.onCanvas(),_t.legend.collapsed=_t.legend.control.isCollapsed(),_t.legend.control.collapse(!1),T.parentNode.classList.remove("hidden"),G.parentNode.parentNode.classList.remove("hidden"),G.checked=!_t.legend.collapsed,_t.legend.control.setCanvas(!_t.legend.collapsed)):(T.parentNode.classList.add("hidden"),G.parentNode.parentNode.classList.add("hidden")))}.bind(this)),u.on("hide",function(){document.body.classList.remove("ol-print-document"),ut&&(this.getMap().setTarget(ut),ut=null,$&&ol.Observable.unByKey($),_t.title&&_t.title.control.setVisible(_t.title.isVisible),_t.legend&&(_t.legend.control.setCanvas(_t.legend.ison),_t.legend.control.collapse(_t.legend.collapsed)),this.dispatchEvent({type:"hide"}))}.bind(this)),window.addEventListener("resize",function(){this.setSize()}.bind(this)),n.saveAs&&this.on("print",function(W){W.pdf||W.canvas.toBlob(function(rt){var nt=(W.print.legend?"legend.":"map.")+W.imageType.replace("image/","");n.saveAs(rt,nt)},W.imageType,W.quality)}),n.jsPDF&&this.on("print",function(W){if(W.pdf){var rt=new n.jsPDF({orientation:W.print.orientation,unit:W.print.unit,format:W.print.size});rt.addImage(W.image,"JPEG",W.print.position[0],W.print.position[0],W.print.imageWidth,W.print.imageHeight),rt.save(W.print.legend?"legend.pdf":"map.pdf")}})},ol.ext.inherits(ol.control.PrintDialog,ol.control.Control),ol.control.PrintDialog.prototype.isOpen=function(){return this._printDialog.isOpen()},ol.control.PrintDialog.addLang=function(n,c){ol.control.PrintDialog.prototype._labels[n]=c},ol.control.PrintDialog.prototype.i18n=function(n){var c=this._labels.en[n]||"bad param";return this._labels[this._lang]&&this._labels[this._lang][n]&&(c=this._labels[this._lang][n]),c},ol.control.PrintDialog.prototype._labels={en:{title:"Print",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",size:"Page size",custom:"screen size",margin:"Margin",scale:"Scale",legend:"Legend",north:"North arrow",mapTitle:"Map title",saveas:"Save as...",saveLegend:"Save legend...",copied:"\u2714 Copied to clipboard",errorMsg:"Can't save map canvas...",printBt:"Print...",clipboardFormat:"copy to clipboard...",jpegFormat:"save as jpeg",pngFormat:"save as png",pdfFormat:"save as pdf",none:"none",small:"small",large:"large",cancel:"cancel"},fr:{title:"Imprimer",orientation:"Orientation",portrait:"Portrait",landscape:"Paysage",size:"Taille du papier",custom:"taille \xE9cran",margin:"Marges",scale:"Echelle",legend:"L\xE9gende",north:"Fl\xE8che du nord",mapTitle:"Titre de la carte",saveas:"Enregistrer sous...",saveLegend:"Enregistrer la l\xE9gende...",copied:"\u2714 Carte copi\xE9e",errorMsg:"Impossible d'enregistrer la carte",printBt:"Imprimer",clipboardFormat:"copier dans le presse-papier...",jpegFormat:"enregistrer un jpeg",pngFormat:"enregistrer un png",pdfFormat:"enregistrer un pdf",none:"aucune",small:"petites",large:"larges",cancel:"annuler"},de:{title:"Drucken",orientation:"Ausrichtung",portrait:"Hochformat",landscape:"Querformat",size:"Papierformat",custom:"Bildschirmgr\xF6\xDFe",margin:"Rand",scale:"Ma\xDFstab",legend:"Legende",north:"Nordpfeil",mapTitle:"Kartentitel",saveas:"Speichern als...",saveLegend:"Legende speichern...",copied:"\u2714 In die Zwischenablage kopiert",errorMsg:"Kann Karte nicht speichern...",printBt:"Drucken...",clipboardFormat:"in die Zwischenablage kopieren...",jpegFormat:"speichern als jpeg",pngFormat:"speichern als png",pdfFormat:"speichern als pdf",none:"kein",small:"klein",large:"gro\xDF",cancel:"abbrechen"},zh:{title:"\u6253\u5370",orientation:"\u65B9\u5411",portrait:"\u7EB5\u5411",landscape:"\u6A2A\u5411",size:"\u9875\u9762\u5927\u5C0F",custom:"\u5C4F\u5E55\u5927\u5C0F",margin:"\u5916\u8FB9\u8DDD",scale:"\u5C3A\u5EA6",legend:"\u56FE\u4F8B",north:"\u6307\u5317\u9488",mapTitle:"\u5730\u56FE\u540D\u5B57",saveas:"\u4FDD\u5B58\u4E3A...",saveLegend:"\u4FDD\u5B58\u56FE\u4F8B\u4E3A...",copied:"\u2714 \u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F",errorMsg:"\u65E0\u6CD5\u4FDD\u5B58\u5730\u56FE...",printBt:"\u6253\u5370...",cancel:"\u53D6\u6D88"}},ol.control.PrintDialog.prototype.paperSize={"":null,A0:[841,1189],A1:[594,841],A2:[420,594],A3:[297,420],A4:[210,297],"US Letter":[215.9,279.4],A5:[148,210],B4:[257,364],B5:[182,257]},ol.control.PrintDialog.prototype.marginSize={none:0,small:5,large:10},ol.control.PrintDialog.prototype.formats=[{title:"clipboardFormat",imageType:"image/png",clipboard:!0},{title:"jpegFormat",imageType:"image/jpeg",quality:.8},{title:"pngFormat",imageType:"image/png",quality:.8},{title:"pdfFormat",imageType:"image/jpeg",pdf:!0}],ol.control.PrintDialog.prototype.scales={" 5000":"1/5.000"," 10000":"1/10.000"," 25000":"1/25.000"," 50000":"1/50.000"," 100000":"1/100.000"," 250000":"1/250.000"," 1000000":"1/1.000.000"},ol.control.PrintDialog.prototype.getOrientation=function(){return this._orientation||"portrait"},ol.control.PrintDialog.prototype.setOrientation=function(n){this._orientation=n==="landscape"?"landscape":"portrait",this._input.orientation[this._orientation].checked=!0,this.setSize()},ol.control.PrintDialog.prototype.getMargin=function(){return this._margin||0},ol.control.PrintDialog.prototype.setMargin=function(n){this._margin=n,this._input.margin.value=n,this.setSize()},ol.control.PrintDialog.prototype.getSize=function(){return this._size},ol.control.PrintDialog.prototype.setSize=function(n){if(this._printDialog.getContentElement().setAttribute("data-status",""),n?this._size=n:n=this._size,!!n){if(typeof n=="string"){for(var c in this.paperSize)c&&new RegExp(c,"i").test(n)&&(n=c);this.paperSize[n]||(n=this._size="A4"),this._input.size.value=n,n=[Math.trunc(this.paperSize[n][0]*96/25.4),Math.trunc(this.paperSize[n][1]*96/25.4)],this.getOrientation()==="landscape"&&(n=[n[1],n[0]]),this.getPage().classList.remove("margin")}else this._input.size.value="",this.getPage().classList.add("margin");var h=this.getPage(),u=h.parentNode.getBoundingClientRect(),d=(u.width-40)/n[0],m=(u.height-40)/n[1],g=Math.min(d,m,1);h.style.width=n[0]+"px",h.style.height=n[1]+"px",h.style["-webkit-transform"]=h.style.transform="translate(-50%,-50%) scale("+g+")";var x=Math.round(5/g);h.style["-webkit-box-shadow"]=h.style["box-shadow"]=x+"px "+x+"px "+x+"px rgba(0,0,0,.6)",h.style.padding=this.getMargin()*96/25.4+"px",this.getMap()&&this.getMap().updateSize(),this.dispatchEvent({type:"dialog:refresh"})}},ol.control.PrintDialog.prototype.getContentElement=function(){return this._printDialog.getContentElement()},ol.control.PrintDialog.prototype.getUserElement=function(){return this._printDialog.getContentElement().querySelector(".ol-user-param")},ol.control.PrintDialog.prototype.getPage=function(){return this._pages[0]},ol.control.PrintDialog.prototype.setMap=function(n){this.getMap()&&(this.getMap().removeControl(this._compass),this.getMap().removeControl(this._printCtrl),this.getMap().removeControl(this._printDialog)),ol.control.Control.prototype.setMap.call(this,n),this.getMap()&&(this.getMap().addControl(this._compass),this.getMap().addControl(this._printCtrl),this.getMap().addControl(this._printDialog))},ol.control.PrintDialog.prototype.setScale=function(n){ol.sphere.setMapScale(this.getMap(),n),this._input.scale.value=" "+Math.round(n/100)*100},ol.control.PrintDialog.prototype.getScale=function(){return ol.sphere.getMapScale(this.getMap())},ol.control.PrintDialog.prototype.print=function(n){n=n||{},n.size&&this.setSize(n.size),n.scale&&this.setScale(n.scale),n.orientation&&this.setOrientation(n.orientation),n.margin&&this.setMargin(n.margin),this._printDialog.show()},ol.control.PrintDialog.prototype.getrintControl=function(){return this._printCtrl},ol.control.Profil=function(n){n=n||{},this.info=n.info||ol.control.Profil.prototype.info;var c=this,h;if(n.target)h=document.createElement("div"),h.classList.add(n.className||"ol-profil");else{h=document.createElement("div"),h.className=((n.className||"ol-profil")+" ol-unselectable ol-control ol-collapsed").trim(),this.button=document.createElement("button"),this.button.title=n.title||"Profile",this.button.setAttribute("type","button");var u=function(pt){c.toggle(),pt.preventDefault()};this.button.addEventListener("click",u),this.button.addEventListener("touchstart",u),h.appendChild(this.button)}n.style instanceof ol.style.Style?this._style=n.style:this._style=new ol.style.Style({text:new ol.style.Text,stroke:new ol.style.Stroke({width:1.5,color:"#369"})}),this._style.getText()||this._style.setText(new ol.style.Text),n.selectStyle instanceof ol.style.Style?this._selectStyle=n.selectStyle:this._selectStyle=new ol.style.Style({fill:new ol.style.Fill({color:"#369"})});var d=document.createElement("div");d.classList.add("ol-inner"),h.appendChild(d);var m=document.createElement("div");m.style.position="relative",d.appendChild(m);var g=this.ratio=2;this.canvas_=document.createElement("canvas"),this.canvas_.width=(n.width||300)*g,this.canvas_.height=(n.height||150)*g;var x={msTransform:"scale(0.5,0.5)",msTransformOrigin:"0 0",webkitTransform:"scale(0.5,0.5)",webkitTransformOrigin:"0 0",mozTransform:"scale(0.5,0.5)",mozTransformOrigin:"0 0",transform:"scale(0.5,0.5)",transformOrigin:"0 0"};Object.keys(x).forEach(function(pt){pt in c.canvas_.style&&(c.canvas_.style[pt]=x[pt])});var E=document.createElement("div");m.appendChild(E),E.style.width=this.canvas_.width/g+"px",E.style.height=this.canvas_.height/g+"px",E.appendChild(this.canvas_),E.addEventListener("pointerdown",this.onMove.bind(this)),document.addEventListener("pointerup",this.onMove.bind(this)),E.addEventListener("mousemove",this.onMove.bind(this)),E.addEventListener("touchmove",this.onMove.bind(this)),ol.control.Control.call(this,{element:h,target:n.target}),this.set("selectable",n.selectable),this.margin_={top:10*g,left:45*g,bottom:30*g,right:10*g},this.info.ytitle||(this.margin_.left-=20*g),this.info.xtitle||(this.margin_.bottom-=20*g),this.bar_=document.createElement("div"),this.bar_.classList.add("ol-profilbar"),this.bar_.style.top=this.margin_.top/g+"px",this.bar_.style.height=(this.canvas_.height-this.margin_.top-this.margin_.bottom)/g+"px",m.appendChild(this.bar_),this.cursor_=document.createElement("div"),this.cursor_.classList.add("ol-profilcursor"),m.appendChild(this.cursor_),this.popup_=document.createElement("div"),this.popup_.classList.add("ol-profilpopup"),this.cursor_.appendChild(this.popup_);var P=document.createElement("table");P.cellPadding="0",P.cellSpacing="0",P.style.clientWidth=this.canvas_.width/g+"px",m.appendChild(P);var L=document.createElement("tr");L.classList.add("track-info"),P.appendChild(L);var F=document.createElement("td");F.innerHTML=(this.info.zmin||"Zmin")+': <span class="zmin">',L.appendChild(F);var U=document.createElement("td");U.innerHTML=(this.info.zmax||"Zmax")+': <span class="zmax">',L.appendChild(U);var A=document.createElement("td");A.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',L.appendChild(A);var G=document.createElement("td");G.innerHTML=(this.info.time||"Time")+': <span class="time">',L.appendChild(G);var B=document.createElement("tr");B.classList.add("point-info"),P.appendChild(B);var O=document.createElement("td");O.innerHTML=(this.info.altitude||"Altitude")+': <span class="z">',B.appendChild(O);var K=document.createElement("td");K.innerHTML=(this.info.distance||"Distance")+': <span class="dist">',B.appendChild(K);var Q=document.createElement("td");if(Q.innerHTML=(this.info.time||"Time")+': <span class="time">',B.appendChild(Q),this.tab_=[],n.feature&&this.setGeometry(n.feature),n.zoomable){this.set("selectable",!0);var et,lt;this.on("change:geometry",function(){lt=null}),this.on("dragstart",function(pt){et=pt.index}),this.on("dragend",function(pt){if(Math.abs(et-pt.index)>10){if(!lt)var T=ol.ext.element.create("BUTTON",{parent:h,className:"ol-zoom-out",click:function(ft){ft.stopPropagation(),ft.preventDefault(),lt&&(this.dispatchEvent({type:"zoom"}),this.setGeometry(lt,this._geometry[1])),h.removeChild(T)}.bind(this)});var ct=lt||this._geometry[0],ut=new ol.geom.LineString(this.getSelection(et,pt.index));this.setGeometry(ut,this._geometry[1]),lt=ct,this.dispatchEvent({type:"zoom",geometry:ut,start:et,end:pt.index})}}.bind(this))}},ol.ext.inherits(ol.control.Profil,ol.control.Control),ol.control.Profil.prototype.info={zmin:"Zmin",zmax:"Zmax",ytitle:"Altitude (m)",xtitle:"Distance (km)",time:"Time",altitude:"Altitude",distance:"Distance",altitudeUnits:"m",distanceUnitsM:"m",distanceUnitsKM:"km"},ol.control.Profil.prototype.popup=function(n){this.popup_.innerHTML=n},ol.control.Profil.prototype._drawAt=function(n,c){n?(this.cursor_.style.left=c+"px",this.cursor_.style.top=(this.canvas_.height-this.margin_.bottom+n[1]*this.scale_[1]+this.dy_)/this.ratio+"px",this.cursor_.style.display="block",this.bar_.parentElement.classList.add("over"),this.bar_.style.left=c+"px",this.bar_.style.display="block",this.element.querySelector(".point-info .z").textContent=n[1]+this.info.altitudeUnits,this.element.querySelector(".point-info .dist").textContent=(n[0]/1e3).toFixed(1)+this.info.distanceUnitsKM,this.element.querySelector(".point-info .time").textContent=n[2],c>this.canvas_.width/this.ratio/2?this.popup_.classList.add("ol-left"):this.popup_.classList.remove("ol-left")):(this.cursor_.style.display="none",this.bar_.style.display="none",this.cursor_.style.display="none",this.bar_.parentElement.classList.remove("over"))},ol.control.Profil.prototype.showAt=function(n){var c,h,u,d=1/0;if(typeof n>"u")this.bar_.parentElement.classList.contains("over")&&this._drawAt();else if(n.length)for(c=1;h=this.tab_[c];c++){var m=ol.coordinate.dist2d(h[3],n);m<d&&(u=h,d=m)}else for(c=0;(h=this.tab_[c])&&(u=h,!(h[0]>=n));c++);if(u){var g=(u[0]*this.scale_[0]+this.margin_.left)/this.ratio;return this._drawAt(u,g),u[3]}return null},ol.control.Profil.prototype.showAtTime=function(n,c){var h,u,d;if(n instanceof Date?n=n.getTime()/1e3:c&&(n+=this.tab_[0][3][3]),typeof n>"u")this.bar_.parentElement.classList.contains("over")&&this._drawAt();else for(h=0;(u=this.tab_[h])&&(d=u,!(u[3][3]>=n));h++);if(d){var m=(d[0]*this.scale_[0]+this.margin_.left)/this.ratio;return this._drawAt(d,m),d[3]}return null},ol.control.Profil.prototype.pointAtTime=function(n){var c,h;for(c=1;h=this.tab_[c];c++){var u=h[3][3];if(u>=n){var d=this.tab_[c-1][3];return(d[3]+u)/2<n?d:h}}return this.tab_[this.tab_.length-1][3]},ol.control.Profil.prototype.onMove=function(n){if(this.tab_.length){var c=this.canvas_.getBoundingClientRect(),h={top:c.top+window.pageYOffset-document.documentElement.clientTop,left:c.left+window.pageXOffset-document.documentElement.clientLeft},u=n.pageX||n.touches&&n.touches.length&&n.touches[0].pageX||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageX,d=n.pageY||n.touches&&n.touches.length&&n.touches[0].pageY||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageY,m=u-h.left,g=d-h.top,x=this.ratio;if(m>this.margin_.left/x-20&&m<(this.canvas_.width-this.margin_.right)/x+8&&g>this.margin_.top/x&&g<(this.canvas_.height-this.margin_.bottom)/x){var E=(m*x-this.margin_.left)/this.scale_[0],P=this.tab_[0],L,F;for(L=1;F=this.tab_[L];L++)if(F[0]>=E){E<(F[0]+P[0])/2&&(L=0,F=P);break}switch(F||(F=this.tab_[this.tab_.length-1]),m=Math.max(this.margin_.left/x,Math.min(m,(this.canvas_.width-this.margin_.right)/x)),this._drawAt(F,m),this.dispatchEvent({type:"over",click:n.type==="click",index:L,coord:F[3],time:F[2],distance:F[0]}),n.type){case"pointerdown":{this._dragging={event:{type:"dragstart",index:L,coord:F[3],time:F[2],distance:F[0]},pageX:u,pageY:d};break}case"pointerup":{this._dragging&&this._dragging.pageX?Math.abs(this._dragging.pageX-u)<3&&Math.abs(this._dragging.pageY-d)<3&&(this.dispatchEvent({type:"click",index:L,coord:F[3],time:F[2],distance:F[0]}),this.refresh()):this.dispatchEvent({type:"dragend",index:L,coord:F[3],time:F[2],distance:F[0]}),this._dragging=!1;break}default:{if(this._dragging)if(this._dragging.pageX)(Math.abs(this._dragging.pageX-u)>3||Math.abs(this._dragging.pageY-d)>3)&&(this._dragging.pageX=this._dragging.pageY=!1,this.dispatchEvent(this._dragging.event));else{this.dispatchEvent({type:"dragging",index:L,coord:F[3],time:F[2],distance:F[0]});var U=Math.min(this._dragging.event.index,L),A=Math.max(this._dragging.event.index,L);this.refresh(),this.get("selectable")&&this._drawGraph(this.tab_.slice(U,A),this._selectStyle)}break}}}else this.bar_.parentElement.classList.contains("over")&&(this._drawAt(),this.dispatchEvent({type:"out"})),n.type==="pointerup"&&this._dragging&&(this.dispatchEvent({type:"dragcancel"}),this._dragging=!1)}},ol.control.Profil.prototype.show=function(){this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"show",show:!0})},ol.control.Profil.prototype.hide=function(){this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"show",show:!1})},ol.control.Profil.prototype.toggle=function(){this.element.classList.toggle("ol-collapsed");var n=this.element.classList.contains("ol-collapsed");this.dispatchEvent({type:"show",show:!n})},ol.control.Profil.prototype.isShown=function(){return!this.element.classList.contains("ol-collapsed")},ol.control.Profil.prototype.getSelection=function(n,c){for(var h=[],u=Math.max(Math.min(n,c),0),d=Math.min(Math.max(n,c),this.tab_.length-1),m=u;m<=d;m++)h.push(this.tab_[m][3]);return h},ol.control.Profil.prototype._drawGraph=function(n,c){if(n.length){var h=this.canvas_.getContext("2d"),u=this.scale_[0],d=this.scale_[1],m=this.dy_,g=this.ratio,x,E;for(h.beginPath(),x=0;E=n[x];x++)x==0?h.moveTo(E[0]*u,E[1]*d+m):h.lineTo(E[0]*u,E[1]*d+m);c.getStroke()&&(h.strokeStyle=c.getStroke().getColor()||"#000",h.lineWidth=c.getStroke().getWidth()*g,h.setLineDash([]),h.stroke()),c.getFill()&&(h.fillStyle=c.getFill().getColor()||"#000",h.Style=c.getFill().getColor()||"#000",h.lineTo(n[n.length-1][0]*u,0),h.lineTo(n[0][0]*u,0),h.fill())}},ol.control.Profil.prototype.setGeometry=function(n,c){if(c||(c={}),n instanceof ol.Feature&&(n=n.getGeometry()),this._geometry=[n,c],!/Z/.test(n.getLayout()))return;/M/.test(n.getLayout())?this.element.querySelector(".time").parentElement.style.display="block":this.element.querySelector(".time").parentElement.style.display="none";var h=n.getCoordinates();switch(n.getType()){case"LineString":break;case"MultiLineString":h=h[0];break;default:return}var u=c.projection||this.getMap().getView().getProjection();function d(G,B){return ol.sphere.getDistance(ol.proj.transform(G,u,"EPSG:4326"),ol.proj.transform(B,u,"EPSG:4326"))}function m(G,B){if(!G||!B)return"-";var O=(B-G)/60,K=Math.trunc(O/60),Q=Math.trunc(O-K*60);return K+"h"+(Q<10?"0":"")+Q+"mn"}var g=1/0,x=-1/0,E,P,L,F,U,A=this.tab_=[];for(E=0,P;P=h[E];E++)F=P[2],F<g&&(g=F),F>x&&(x=F),E==0?L=0:L+=d(h[E-1],P),U=m(h[0][3],P[3]),A.push([L,F,U,P]);this._z=[g,x],this.set("graduation",c.graduation||100),this.set("zmin",c.zmin),this.set("zmax",c.zmax),this.set("amplitude",c.amplitude),this.set("unit",c.unit),this.set("zunit",c.zunit),this.set("zDigits",c.zDigits),this.set("zMaxChars",c.zMaxChars),this.dispatchEvent({type:"change:geometry",geometry:n}),this.refresh()},ol.control.Profil.prototype.refresh=function(){var n=this.canvas_,c=n.getContext("2d"),h=n.width,u=n.height;c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,h,u);var d=this._z[0],m=this._z[1],g=this.tab_,x=g[g.length-1][0],E=g[g.length-1][2],P;if(!x){console.error("[ol/control/Profil] no data...",g);return}c.setTransform(1,0,0,1,this.margin_.left,u-this.margin_.bottom);var L=this.ratio;h-=this.margin_.right+this.margin_.left,u-=this.margin_.top+this.margin_.bottom,c.strokeStyle=this._style.getText().getFill().getColor()||"#000",c.lineWidth=.5*L,c.beginPath(),c.moveTo(0,0),c.lineTo(0,-u),c.moveTo(0,0),c.lineTo(h,0),c.stroke(),this.element.querySelector(".track-info .zmin").textContent=d.toFixed(2)+this.info.altitudeUnits,this.element.querySelector(".track-info .zmax").textContent=m.toFixed(2)+this.info.altitudeUnits,x>1e3?this.element.querySelector(".track-info .dist").textContent=(x/1e3).toFixed(1)+this.info.distanceUnitsKM:this.element.querySelector(".track-info .dist").textContent=x.toFixed(1)+this.info.distanceUnitsM,this.element.querySelector(".track-info .time").textContent=E;for(var F=this.get("graduation");;){m=Math.ceil(m/F)*F,d=Math.floor(d/F)*F;var U=(m-d)/F;if(u/U<15*L)F*=2;else break}typeof this.get("zmin")=="number"&&d>this.get("zmin")&&(d=this.get("zmin")),typeof this.get("zmax")=="number"&&m<this.get("zmax")&&(m=this.get("zmax"));var A=this.get("amplitude");A&&(m=Math.max(d+A,m));var G=h/x,B=-u/(m-d),O=this.dy_=-d*B;this.scale_=[G,B],this._drawGraph(g,this._style),c.textAlign="right",c.textBaseline="top",c.fillStyle=this._style.getText().getFill().getColor()||"#000",c.beginPath();var K=this.get("zDigits")||0,Q=null;if(typeof this.get("zMaxChars")=="number"){var et;if(this.get("zunit")!="km"?et=Math.max(d.toFixed(K).length,m.toFixed(K).length):et=Math.max((d/1e3).toFixed(1).length,(m/1e3).toFixed(1).length),this.get("zMaxChars")<et){Q=Math.floor(Math.log10(Math.max(Math.abs(d),Math.abs(m),Number.MIN_VALUE))),c.font="bold "+9*L+"px arial",c.fillText(Q.toString(),-8*L,8*L);var lt=c.measureText(Q.toString()),pt=lt.width,T=lt.actualBoundingBoxAscent+lt.actualBoundingBoxDescent;c.font="bold "+12*L+"px arial",c.fillText("10",-8*L-pt,8*L+.5*T)}}for(c.font=10*L+"px arial",c.textBaseline="middle",P=d;P<=m;P+=F){if(Q!==null){var ct=P/Math.pow(10,Q);this.get("zunit")=="km"&&(ct/=1e3);var ut=this.get("zMaxChars")-Math.floor(Math.log10(Math.max(Math.abs(ct),1))+1)-1;ct<0&&(ut-=1),this.get("zunit")!="km",c.fillText(ct.toFixed(Math.max(ut,0)),-4*L,P*B+O)}else this.get("zunit")!="km"?c.fillText(P.toFixed(K),-4*L,P*B+O):c.fillText((P/1e3).toFixed(1),-4*L,P*B+O);c.moveTo(-2*L,P*B+O),P!=0?c.lineTo(x*G,P*B+O):c.lineTo(0,P*B+O)}c.textAlign="center",c.textBaseline="top",c.setLineDash([L,3*L]);var ft=this.get("unit")||"km",$;for(x>1e3?($=Math.round(x/1e3)*100,$>1e3&&($=Math.ceil($/1e3)*1e3)):(ft="m",x>100?$=Math.round(x/100)*10:x>10?$=Math.round(x/10):x>1?$=Math.round(x)/10:$=x),P=0;P<=x;P+=$){var _t=ft=="m"?P:P/1e3;c.fillText(Math.round(_t*10)/10,P*G,4*L),c.moveTo(P*G,2*L),c.lineTo(P*G,0)}c.font=12*L+"px arial",c.fillText(this.info.xtitle.replace("(km)","("+ft+")"),h/2,18*L),c.save(),c.rotate(-Math.PI/2),c.fillText(this.info.ytitle,u/2,-this.margin_.left),c.restore(),c.stroke()},ol.control.Profil.prototype.getImage=function(n,c){return n==="canvas"?this.canvas_:this.canvas_.toDataURL(n,c)},ol.control.ProgressBar=function(n){n=n||{};var c=ol.ext.element.create("DIV",{className:((n.className||"")+" ol-progress-bar ol-unselectable ol-control").trim()});this._waiting=ol.ext.element.create("DIV",{html:n.label||"",className:"ol-waiting",parent:c}),this._bar=ol.ext.element.create("DIV",{className:"ol-bar",parent:c}),ol.control.Control.call(this,{element:c,target:n.target}),this._layerlistener=[],this.setLayers(n.layers)},ol.ext.inherits(ol.control.ProgressBar,ol.control.Control),ol.control.ProgressBar.prototype.setPercent=function(n){this._bar.style.width=(Number(n)||0)*100+"%",n===void 0?ol.ext.element.hide(this.element):ol.ext.element.show(this.element)},ol.control.ProgressBar.prototype.setLabel=function(n){this._waiting.innerHTML=n},ol.control.ProgressBar.prototype.setLayers=function(n){this._layerlistener.forEach(function(d){ol.Observable.unByKey(d)}),this._layerlistener=[],this.setPercent();var c=0,h=0;if(n instanceof ol.layer.Layer&&(n=[n]),!(!n||!n.forEach)){var u;n.forEach(function(d){d instanceof ol.layer.Layer&&(this._layerlistener.push(d.getSource().on("tileloadstart",function(){c++,this.setPercent(h/c),clearTimeout(u)}.bind(this))),this._layerlistener.push(d.getSource().on(["tileloadend","tileloaderror"],function(){h++,h===c?(c=h=0,this.setPercent(1),u=setTimeout(this.setPercent.bind(this),300)):this.setPercent(h/c)}.bind(this))))}.bind(this))}},ol.control.RoutingGeoportail=function(n){var c=this;n||(n={}),n.typing==null&&(n.typing=300),n.apiKey=n.apiKey||"itineraire",n.search||(n.search={}),n.search.apiKey=n.search.apiKey||"essentiels",this._classname=n.className||"search",this._source=new ol.source.Vector,this._auth=n.authentication;var h=document.createElement("DIV"),u=(n.className||"")+" ol-routing";if(n.target||(u+=" ol-unselectable ol-control"),h.setAttribute("class",u),!n.target){var d=ol.ext.element.create("BUTTON",{parent:h});d.addEventListener("click",function(){h.classList.toggle("ol-collapsed")})}ol.control.Control.call(this,{element:h,target:n.target}),this.set("url","https://wxs.ign.fr/calcul/geoportail/"+n.apiKey+"/rest/1.0.0/route");var m=ol.ext.element.create("DIV",{className:"content",parent:h}),g=ol.ext.element.create("DIV",{className:"search-input",parent:m});this._search=[],this.addSearch(g,n),this.addSearch(g,n),ol.ext.element.create("I",{className:"ol-car",title:n.carlabel||"by car",parent:m}).addEventListener("click",function(){c.setMode("car")}),ol.ext.element.create("I",{className:"ol-pedestrian",title:n.pedlabel||"pedestrian",parent:m}).addEventListener("click",function(){c.setMode("pedestrian")}),ol.ext.element.create("I",{className:"ol-ok",title:n.runlabel||"search",html:"OK",parent:m}).addEventListener("click",function(){c.calculate()}),ol.ext.element.create("I",{className:"ol-cancel",html:"cancel",parent:m}).addEventListener("click",function(){this.resultElement.innerHTML=""}.bind(this)),this.resultElement=document.createElement("DIV"),this.resultElement.setAttribute("class","ol-result"),h.appendChild(this.resultElement),this.setMode(n.mode||"car"),this.set("timeout",n.timeout||2e4)},ol.ext.inherits(ol.control.RoutingGeoportail,ol.control.Control),ol.control.RoutingGeoportail.prototype.setMode=function(n,c){this.set("mode",n),this.element.querySelector(".ol-car").classList.remove("selected"),this.element.querySelector(".ol-pedestrian").classList.remove("selected"),this.element.querySelector(".ol-"+n).classList.add("selected"),c||this.calculate()},ol.control.RoutingGeoportail.prototype.setMethod=function(n,c){this.set("method",n),c||this.calculate()},ol.control.RoutingGeoportail.prototype.addButton=function(n,c,h){var u=document.createElement("I");return u.setAttribute("class",n),u.setAttribute("type","button"),u.setAttribute("title",c),u.innerHTML=h||"",this.element.appendChild(u),u},ol.control.RoutingGeoportail.prototype.getSource=function(){return this._source},ol.control.RoutingGeoportail.prototype._resetArray=function(n){this._search=[];var c=n.parentNode.querySelectorAll(".search-input > div");c.forEach(function(h){h.olsearch&&(h.olsearch.get("feature")&&(h.olsearch.get("feature").set("step",this._search.length),this._search.length===0?h.olsearch.get("feature").set("pos","start"):this._search.length===c.length-1?h.olsearch.get("feature").set("pos","end"):h.olsearch.get("feature").set("pos","")),this._search.push(h.olsearch))}.bind(this))},ol.control.RoutingGeoportail.prototype.removeSearch=function(n,c,h){n.removeChild(h),h.olsearch.get("feature")&&this._source.removeFeature(h.olsearch.get("feature")),this.getMap()&&this.getMap().removeControl(h.olsearch),this._resetArray(n)},ol.control.RoutingGeoportail.prototype.addSearch=function(n,c,h){var u=this,d=ol.ext.element.create("DIV");h?n.insertBefore(d,h.nextSibling):n.appendChild(d),ol.ext.element.create("BUTTON",{title:c.startlabel||"add/remove",parent:d}).addEventListener("click",function(g){g.ctrlKey?this._search.length>2&&this.removeSearch(n,c,d):g.shiftKey&&this.addSearch(n,c,d)}.bind(this));var m=d.olsearch=new ol.control.SearchGeoportail({className:"IGNF ol-collapsed",apiKey:c.search.apiKey,authentication:c.search.authentication,target:d,reverse:!0});m._changeCounter=0,this._resetArray(n),m.on("select",function(g){m.setInput(g.search.fulltext);var x=m.get("feature");x?(m.checkgeom=!1,g.silent||x.getGeometry().setCoordinates(g.coordinate),m.checkgeom=!0):(x=new ol.Feature(new ol.geom.Point(g.coordinate)),m.set("feature",x),this._source.addFeature(x),m.checkgeom=!0,x.getGeometry().on("change",function(){m.checkgeom&&this.onGeometryChange(m,x)}.bind(this))),x.set("name",m.getTitle(g.search)),x.set("step",this._search.indexOf(m)),x.get("step")===0?x.set("pos","start"):x.get("step")===this._search.length-1&&x.set("pos","end"),m.set("selection",g.search)}.bind(this)),m.element.querySelector("input").addEventListener("change",function(){m.set("selection",null),u.resultElement.innerHTML=""}),this.getMap()&&this.getMap().addControl(m)},ol.control.RoutingGeoportail.prototype.onGeometryChange=function(n,c,h){var u=ol.proj.transform(c.getGeometry().getCoordinates(),this.getMap().getView().getProjection(),"EPSG:4326");if(n._handleSelect({x:u[0],y:u[1],fulltext:u[0].toFixed(6)+","+u[1].toFixed(6)},!0,{silent:!0}),h){if(n._changeCounter--,!n._changeCounter){n.reverseGeocode(c.getGeometry().getCoordinates(),{silent:!0});return}}else n._changeCounter++,setTimeout(function(){this.onGeometryChange(n,c,!0)}.bind(this),1e3)},ol.control.RoutingGeoportail.prototype.setMap=function(n){ol.control.Control.prototype.setMap.call(this,n);for(var c=0;c<this._search.length;c++){var h=this._search[c];h.setMap(n)}},ol.control.RoutingGeoportail.prototype.requestData=function(n){for(var c=n[0],h=n[n.length-1],u="",d=1;d<n.length-1;d++)u+=(u?";":"")+n[d].x+","+n[d].y;return{resource:"bdtopo-osrm",profile:this.get("mode")==="pedestrian"?"pedestrian":"car",optimization:this.get("method")||"fastest",start:c.x+","+c.y,end:h.x+","+h.y,intermediates:u,geometryFormat:"geojson"}},ol.control.RoutingGeoportail.prototype.getTimeString=function(n){return n/=60,n<1?"":n<60?n.toFixed(0)+" min":(n/60).toFixed(0)+" h "+(n%60).toFixed(0)+" min"},ol.control.RoutingGeoportail.prototype.getDistanceString=function(n){return n<1e3?n.toFixed(0)+" m":(n/1e3).toFixed(2)+" km"},ol.control.RoutingGeoportail.prototype.listRouting=function(n){this.resultElement.innerHTML="";var c=this.getTimeString(n.duration);c+=" ("+this.getDistanceString(n.distance)+")";var h=document.createElement("i");h.textContent=c,this.resultElement.appendChild(h);var u=document.createElement("ul");this.resultElement.appendChild(u);var d={none:"Prendre sur ",R:"Tourner \xE0 droite sur ",FR:"Tourner l\xE9g\xE8rement \xE0 droite sur ",L:"Tourner \xE0 gauche sur ",FL:"Tourner l\xE9g\xE8rement \xE0 gauche sur ",F:"Continuer tout droit sur "};n.features.forEach(function(m,g){var x=this.getDistanceString(m.get("distance"));c=this.getTimeString(m.get("durationT")),ol.ext.element.create("LI",{className:m.get("instruction"),html:(d[m.get("instruction")||"none"]||"#")+" "+m.get("name")+"<i>"+x+(c?" - "+c:"")+"</i>",on:{pointerenter:function(){this.dispatchEvent({type:"step:hover",hover:!1,index:g,feature:m})}.bind(this),pointerleave:function(){this.dispatchEvent({type:"step:hover",hover:!1,index:g,feature:m})}.bind(this)},click:function(){this.dispatchEvent({type:"step:select",index:g,feature:m})}.bind(this),parent:u})}.bind(this))},ol.control.RoutingGeoportail.prototype.handleResponse=function(n,c,h){if(n.status==="ERROR"){this.dispatchEvent({type:"errror",status:"200",statusText:n.message});return}var u={type:"routing"};u.features=[];for(var d=0,m=0,g,x=new ol.format.GeoJSON,E,P=0,L;L=n.portions[P];P++)for(var F=0,U;U=L.steps[F];F++){U.type="Feature",U.properties=U.attributes.name||U.attributes,U.properties.distance=U.distance,U.properties.duration=Math.round(U.duration*60),U.instruction&&(U.properties.instruction_type=U.instruction.type,U.properties.instruction_modifier=U.instruction.modifier),d+=U.distance,m+=U.duration,U.properties.distanceT=Math.round(d*100)/100,U.properties.durationT=Math.round(m*60),U.properties.name=U.properties.cpx_toponyme_route_nommee||U.properties.cpx_toponyme||U.properties.cpx_numero||U.properties.nom_1_droite||U.properties.nom_1_gauche||"";var A=U.geometry.coordinates[U.geometry.coordinates.length-1];E&&!ol.coordinate.equal(A,U.geometry.coordinates[U.geometry.coordinates.length-1])&&U.geometry.coordinates.unshift(E),E=U.geometry.coordinates[U.geometry.coordinates.length-1],g=x.readFeature(U,{featureProjection:this.getMap().getView().getProjection()}),u.features.push(g)}u.distance=parseFloat(n.distance),u.duration=parseFloat(n.duration)/60;var G=x.readGeometry(n.geometry,{featureProjection:this.getMap().getView().getProjection()});return u.feature=new ol.Feature({geometry:G,start:this._search[0].getTitle(c),end:this._search[0].getTitle(h),distance:u.distance,duration:u.duration}),this.dispatchEvent(u),this.path=u,u},ol.control.RoutingGeoportail.prototype.abort=function(){this._request&&(this._request.abort(),this._request=null,this.dispatchEvent({type:"abort"}))},ol.control.RoutingGeoportail.prototype.calculate=function(n){if(this.resultElement.innerHTML="",n){var c=[];n.forEach(function(L){c.push({x:L[0],y:L[1]})}),n=c}else{n=[];for(var h=0;h<this._search.length;h++)this._search[h].get("selection")&&n.push(this._search[h].get("selection"))}if(n.length<2)return!1;var u=n[0],d=n[n.length-1],m=this.requestData(n),g=encodeURI(this.get("url")),x="";for(var E in m)x+=x?"&":"?",m.hasOwnProperty(E)&&(x+=E+"="+m[E]);var P=this;return this.dispatchEvent({type:"routing:start"}),this.ajax(g+x,function(L){L.status>=200&&L.status<400?P.listRouting(P.handleResponse(JSON.parse(L.response),u,d)):this.dispatchEvent({type:"error",status:L.status,statusText:L.statusText})}.bind(this),function(L){this.dispatchEvent({type:"error",status:L.status,statusText:L.statusText})}.bind(this)),!0},ol.control.RoutingGeoportail.prototype.ajax=function(n,c,h){var u=this;this._request&&this._request.abort();var d=this._request=new XMLHttpRequest;d.open("GET",n,!0),d.timeout=this.get("timeout")||2e4,this._auth&&d.setRequestHeader("Authorization","Basic "+this._auth),this.element.classList.add("ol-searching"),d.onload=function(){u._request=null,u.element.classList.remove("ol-searching"),c.call(u,this)},d.ontimeout=function(){u._request=null,u.element.classList.remove("ol-searching"),h&&h.call(u,this)},d.onerror=function(){u._request=null,u.element.classList.remove("ol-searching"),h&&h.call(u,this)},d.send()},ol.control.Scale=function(n){n||(n={}),n.typing==null&&(n.typing=300);var c=document.createElement("DIV"),h=(n.className||"")+" ol-scale";n.target||(h+=" ol-unselectable ol-control"),this._input=document.createElement("INPUT"),this._input.value="-",c.setAttribute("class",h),n.editable===!1&&(this._input.readOnly=!0),c.appendChild(this._input),ol.control.Control.call(this,{element:c,target:n.target}),this._input.addEventListener("change",this.setScale.bind(this)),this.set("ppi",n.ppi||96)},ol.ext.inherits(ol.control.Scale,ol.control.Control),ol.control.Scale.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener=n.on("moveend",this.getScale.bind(this)))},ol.control.Scale.prototype.getScale=function(){var n=this.getMap();if(n){var c=ol.sphere.getMapScale(n,this.get("ppi"));return this._input.value=this.formatScale(c),c}},ol.control.Scale.prototype.formatScale=function(n){return n>100?n=Math.round(n/100)*100:n=Math.round(n),"1 / "+n.toLocaleString()},ol.control.Scale.prototype.setScale=function(n){var c=this.getMap();c&&n&&(n.target&&(n=n.target.value),ol.sphere.setMapScale(c,n,this.get("ppi"))),this.getScale()},ol.control.SearchBAN=function(n){n=n||{},n.typing=n.typing||500,n.url=n.url||"https://api-adresse.data.gouv.fr/search/",n.className=n.className||"BAN",n.copy='<a href="https://adresse.data.gouv.fr/" target="new">&copy; BAN-data.gouv.fr</a>',ol.control.SearchPhoton.call(this,n),this.set("postcode",n.postcode),this.set("citycode",n.citycode),this.set("type",n.type)},ol.ext.inherits(ol.control.SearchBAN,ol.control.SearchPhoton),ol.control.SearchBAN.prototype.getTitle=function(n){var c=n.properties;return c.label},ol.control.SearchBAN.prototype.select=function(n){var c=n.geometry.coordinates;try{c=ol.proj.transform(n.geometry.coordinates,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.dispatchEvent({type:"select",search:n,coordinate:c})},ol.control.SearchBAN.prototype.requestData=function(n){var c=ol.control.SearchPhoton.prototype.requestData.call(this,n);return c.postcode=this.get("postcode"),c.citycode=this.get("citycode"),c.type=this.get("type"),c},ol.control.SearchDFCI=function(n){n||(n={}),n.className=n.className||"dfci",n.placeholder=n.placeholder||"Code DFCI",ol.control.Search.call(this,n)},ol.ext.inherits(ol.control.SearchDFCI,ol.control.Search),ol.control.SearchDFCI.prototype.autocomplete=function(n){if(n=n.toUpperCase(),n=n.replace(/[^0-9,^A-H,^K-N]/g,""),n.length<2)return this.setInput(n),[];var c,h=this.getMap().getView().getProjection(),u=[],d=ol.coordinate.fromDFCI(n,h),m=Math.floor(n.length/2)-1,g=ol.coordinate.toDFCI(d,m,h);if(g=g.replace(/[^0-9,^A-H,^K-N]/g,""),!/NaN/.test(g)&&g){if(console.log("ok",g),this.setInput(g+n.substring(g.length,n.length)),u.push({coordinate:ol.coordinate.fromDFCI(g,h),name:g}),n.length===5)for(d=ol.coordinate.fromDFCI(n+0,h),g=ol.coordinate.toDFCI(d,m+1,h).substring(0,5),c=0;c<10;c++)u.push({coordinate:ol.coordinate.fromDFCI(g+c,h),name:g+c});if(m===2)for(c=0;c<6;c++)u.push({coordinate:ol.coordinate.fromDFCI(g+"."+c,h),name:g+"."+c})}return u},ol.control.SearchFeature=function(n){n||(n={}),n.className=n.className||"feature",ol.control.Search.call(this,n),typeof n.getSearchString=="function"&&(this.getSearchString=n.getSearchString),this.set("property",n.property||"name"),this.source_=n.source},ol.ext.inherits(ol.control.SearchFeature,ol.control.Search),ol.control.SearchFeature.prototype.restoreHistory=function(){this.set("history",[])},ol.control.SearchFeature.prototype.saveHistory=function(){try{localStorage.removeItem("ol@search-"+this._classname)}catch{console.warn("Failed to access localStorage...")}},ol.control.SearchFeature.prototype.getTitle=function(n){return n.get(this.get("property")||"name")},ol.control.SearchFeature.prototype.getSearchString=function(n){return this.getTitle(n)},ol.control.SearchFeature.prototype.getSource=function(){return this.source_},ol.control.SearchFeature.prototype.setSource=function(n){this.source_=n},ol.control.SearchFeature.prototype.autocomplete=function(n){var c=[];if(this.source_){n=n.replace(/^\*/,"");for(var h=new RegExp(n,"i"),u=this.source_.getFeatures(),d=this.get("maxItems"),m=0,g;g=u[m];m++){var x=this.getSearchString(g);if(x!==void 0&&h.test(x)&&(c.push(g),--d<=0))break}}return c},ol.control.SearchGPS=function(n){n||(n={}),n.className=(n.className||"")+" ol-searchgps",n.placeholder=n.placeholder||"lon,lat",ol.control.Search.call(this,n),this.geolocation=new ol.Geolocation({projection:"EPSG:4326",trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),ol.ext.element.create("BUTTON",{className:"ol-geoloc",title:"Locate with GPS",parent:this.element,click:function(){this.geolocation.setTracking(!0)}.bind(this)}),ol.ext.element.createSwitch({html:"decimal",after:"DMS",change:function(h){h.target.checked?this.element.classList.add("ol-dms"):this.element.classList.remove("ol-dms")}.bind(this),parent:this.element}),this._createForm();var c=this.element.querySelector("ul.autocomplete");this.element.appendChild(c)},ol.ext.inherits(ol.control.SearchGPS,ol.control.Search),ol.control.SearchGPS.prototype._createForm=function(){var n=function(F){if(F.target.classList.contains("ol-dms")&&(u.value=(d.value<0?-1:1)*Number(d.value)+Number(m.value)/60+Number(g.value)/3600,u.value=(d.value<0?-1:1)*Math.round(u.value*1e7)/1e7,x.value=(E.value<0?-1:1)*Number(E.value)+Number(P.value)/60+Number(L.value)/3600,x.value=(E.value<0?-1:1)*Math.round(x.value*1e7)/1e7),u.value||x.value?this._input.value=u.value+","+x.value:this._input.value="",!F.target.classList.contains("ol-dms")){var U=ol.coordinate.toStringHDMS([Number(u.value),Number(x.value)]),A=U.replace(/(N|S|E|W)/g,"").split("\u2033");A[1]=A[1].trim().split(" "),d.value=(/W/.test(U)?-1:1)*parseInt(A[1][0]),m.value=parseInt(A[1][1]),g.value=parseInt(A[1][2]),A[0]=A[0].trim().split(" "),E.value=(/W/.test(U)?-1:1)*parseInt(A[0][0]),P.value=parseInt(A[0][1]),L.value=parseInt(A[0][2])}this.search()}.bind(this);function c(F,U){var A=ol.ext.element.create("INPUT",{className:F,type:"number",step:"any",lang:"en",parent:h,on:{"change keyup":n}});return U&&ol.ext.element.create("SPAN",{className:"ol-dms",html:U,parent:h}),A}var h=ol.ext.element.create("DIV",{className:"ol-longitude",parent:this.element});ol.ext.element.create("LABEL",{html:"Longitude",parent:h});var u=c("ol-decimal"),d=c("ol-dms","\xB0"),m=c("ol-dms","'"),g=c("ol-dms",'"');h=ol.ext.element.create("DIV",{className:"ol-latitude",parent:this.element}),ol.ext.element.create("LABEL",{html:"Latitude",parent:h});var x=c("ol-decimal"),E=c("ol-dms","\xB0"),P=c("ol-dms","'"),L=c("ol-dms",'"');this.button&&this.button.addEventListener("click",function(){u.focus()}),this.on("select",function(F){u.value=F.search.gps[0],x.value=F.search.gps[1]}.bind(this)),this.geolocation.on("change",function(){this.geolocation.setTracking(!1);var F=this.geolocation.getPosition();u.value=F[0],x.value=F[1],this._triggerCustomEvent("keyup",u)}.bind(this))},ol.control.SearchGPS.prototype.autocomplete=function(n){var c=[],h=n.split(",");h[0]=Number(h[0]),h[1]=Number(h[1]),n=ol.coordinate.toStringHDMS(h),n&&(n=n.replace(/(||) /g,"$1"));var u=ol.proj.transform([h[0],h[1]],"EPSG:4326",this.getMap().getView().getProjection());return c.push({gps:h,coordinate:u,name:n}),c},ol.control.SearchGeoportailParcelle=function(n){var c=this;n.type="Commune",n.className=(n.className?n.className:"")+" IGNF-parcelle ol-collapsed-list ol-collapsed-num",n.inputLabel="Commune",n.noCollapse=!0,n.placeholder=n.placeholder||"Choisissez une commune...",ol.control.SearchGeoportail.call(this,n),this.set("copy",null);var h=this.element,u=document.createElement("DIV");h.appendChild(u);var d=document.createElement("LABEL");d.innerText="Pr\xE9fixe",u.appendChild(d),d=document.createElement("LABEL"),d.innerText="Section",u.appendChild(d),d=document.createElement("LABEL"),d.innerText="Num\xE9ro",u.appendChild(d),u.appendChild(document.createElement("BR")),this._inputParcelle={prefix:document.createElement("INPUT"),section:document.createElement("INPUT"),numero:document.createElement("INPUT")},this._inputParcelle.prefix.setAttribute("maxlength",3),this._inputParcelle.section.setAttribute("maxlength",2),this._inputParcelle.numero.setAttribute("maxlength",4);var m,g=function(){m&&clearTimeout(m),m=setTimeout(function(){c.autocompleteParcelle()},n.typing||0)};for(var x in this._inputParcelle)u.appendChild(this._inputParcelle[x]),this._inputParcelle[x].addEventListener("keyup",g),this._inputParcelle[x].addEventListener("blur",function(){m=setTimeout(function(){h.classList.add("ol-collapsed-num")},200)}),this._inputParcelle[x].addEventListener("focus",function(){clearTimeout(m),h.classList.remove("ol-collapsed-num")});this.activateParcelle(!1);var E=document.createElement("DIV");E.className="autocomplete-parcelle",h.appendChild(E);var P=document.createElement("UL");P.classList.add("autocomplete-parcelle"),E.appendChild(P),P=document.createElement("UL"),P.classList.add("autocomplete-page"),E.appendChild(P),this._input.addEventListener("blur",function(){setTimeout(function(){h.classList.add("ol-collapsed-list")},200)}),this._input.addEventListener("focus",function(){h.classList.remove("ol-collapsed-list"),c._listParcelle([]),c._commune&&(c._commune=null,c._input.value="",c.drawList_()),c.activateParcelle(!1)}),this.on("select",this.selectCommune.bind(this)),this.set("pageSize",n.pageSize||5)},ol.ext.inherits(ol.control.SearchGeoportailParcelle,ol.control.SearchGeoportail),ol.control.SearchGeoportailParcelle.prototype.selectCommune=function(n){this._commune=n.search.insee,this._input.value=n.search.insee+" - "+n.search.fulltext,this.activateParcelle(!0),this._inputParcelle.numero.focus(),this.autocompleteParcelle()},ol.control.SearchGeoportailParcelle.prototype.setParcelle=function(n,c){this._inputParcelle.prefix.value=(n.Commune||"")+(n.CommuneAbsorbee||""),this._inputParcelle.section.value=n.Section||"",this._inputParcelle.numero.value=n.Numero||"",c&&this._triggerCustomEvent("keyup",this._inputParcelle.prefix)},ol.control.SearchGeoportailParcelle.prototype.activateParcelle=function(n){for(var c in this._inputParcelle)this._inputParcelle[c].readOnly=!n;n?this._inputParcelle.section.parentElement.classList.add("ol-active"):this._inputParcelle.section.parentElement.classList.remove("ol-active")},ol.control.SearchGeoportailParcelle.prototype.autocompleteParcelle=function(){function n(g,x,E){if(!g)return g;for(E=E||"0";g.length<x;)g=E+g;return g.replace(/\*/g,"_")}var c=this._commune,h=n(this._inputParcelle.prefix.value,3);h==="000"&&(h="___");var u=n(this._inputParcelle.section.value,2),d=n(this._inputParcelle.numero.value,4,"0"),m=c+(h||"___")+(u||"__")+(d||(u?"____":"0001"));this.searchParcelle(m,function(g){this._listParcelle(g)}.bind(this),function(){console.log("oops")})},ol.control.SearchGeoportailParcelle.prototype.searchParcelle=function(n,c){var h='<?xml version="1.0" encoding="UTF-8"?><XLS xmlns:xls="http://www.opengis.net/xls" xmlns:gml="http://www.opengis.net/gml" xmlns="http://www.opengis.net/xls" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.2" xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"><RequestHeader/><Request requestID="1" version="1.2" methodName="LocationUtilityService"><GeocodeRequest returnFreeForm="false"><Address countryCode="CadastralParcel"><freeFormAddress>'+n+"+</freeFormAddress></Address></GeocodeRequest></Request></XLS>";this.ajax(this.get("url").replace("ols/apis/completion","geoportail/ols"),{xls:h},function(u){for(var d=new DOMParser,m=d.parseFromString(u,"text/xml"),g=m.getElementsByTagName("GeocodedAddress"),x=[],E=0,P;P=g[E];E++){for(var L=P.getElementsByTagName("gml:pos")[0]||P.getElementsByTagName("pos")[0],F=L.childNodes[0].nodeValue.split(" "),U=P.getElementsByTagName("Place"),A={lon:Number(F[1]),lat:Number(F[0])},G=0,B;B=U[G];G++)A[B.attributes.type.value]=B.childNodes[0].nodeValue;x.push(A)}c(x)},{dataType:"XML"})},ol.control.SearchGeoportailParcelle.prototype._listParcelle=function(n){var c=this,h=this.element.querySelector("ul.autocomplete-parcelle");h.innerHTML="";var u=this.element.querySelector("ul.autocomplete-page");u.innerHTML="",this._listParc=[];function d(P){var L=h.children,F="ol-list-"+P,U;for(U=0;U<L.length;U++)L[U].style.display=L[U].className===F?"":"none";for(L=u.children,U=0;U<L.length;U++)L[U].className=L[U].innerText==P?"selected":"";u.style.display=L.length>1?"":"none"}n.sort(function(P,L){var F=P.INSEE+P.CommuneAbsorbee+P.Section+P.Numero,U=L.INSEE+L.CommuneAbsorbee+L.Section+L.Numero;return F===U?0:F<U?-1:1});for(var m=this.get("pageSize"),g=0,x;x=n[g];g++){var E=document.createElement("LI");E.setAttribute("data-search",g),m>0&&E.classList.add("ol-list-"+Math.floor(g/m)),this._listParc.push(x),E.addEventListener("click",function(P){c._handleParcelle(c._listParc[P.currentTarget.getAttribute("data-search")])}),E.innerHTML=x.INSEE+x.CommuneAbsorbee+x.Section+x.Numero,h.appendChild(E),m>0&&!(g%m)&&(E=document.createElement("LI"),E.innerText=Math.floor(g/m),E.addEventListener("click",function(P){d(P.currentTarget.innerText)}),u.appendChild(E))}m>0&&d(0)},ol.control.SearchGeoportailParcelle.prototype._handleParcelle=function(n){this.dispatchEvent({type:"parcelle",search:n,coordinate:ol.proj.fromLonLat([n.lon,n.lat],this.getMap().getView().getProjection())})},ol.control.SearchNominatim=function(n){n=n||{},n.className=n.className||"nominatim",n.typing=n.typing||500,n.url=n.url||"https://nominatim.openstreetmap.org/search",n.copy='<a href="http://www.openstreetmap.org/copyright" target="new">&copy; OpenStreetMap contributors</a>',ol.control.SearchJSON.call(this,n),this.set("polygon",n.polygon),this.set("viewbox",n.viewbox),this.set("bounded",n.bounded)},ol.ext.inherits(ol.control.SearchNominatim,ol.control.SearchJSON),ol.control.SearchNominatim.prototype.getTitle=function(n){var c=[];n.class&&c.push(n.class),n.type&&c.push(n.type);var h=n.display_name+(c.length?"<i>"+c.join(" - ")+"</i>":"");return n.icon&&(h="<img src='"+n.icon+"' />"+h),h},ol.control.SearchNominatim.prototype.requestData=function(n){var c={format:"json",addressdetails:1,q:n,polygon_geojson:this.get("polygon")?1:0,bounded:this.get("bounded")?1:0,limit:this.get("maxItems")};return this.get("viewbox")&&(c.viewbox=this.get("viewbox")),c},ol.control.SearchNominatim.prototype.select=function(n){var c=[Number(n.lon),Number(n.lat)];try{c=ol.proj.transform(c,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.dispatchEvent({type:"select",search:n,coordinate:c})},ol.control.SearchJSON.prototype.handleResponse=function(n){return n.results||n},ol.control.SearchNominatim.prototype.reverseGeocode=function(n,c){var h=ol.proj.transform(n,this.getMap().getView().getProjection(),"EPSG:4326");this.ajax(this.get("url").replace("search","reverse"),{lon:h[0],lat:h[1],format:"json"},function(u){c?c.call(this,[u]):u&&!u.error&&this._handleSelect(u,!0)}.bind(this))},ol.control.SearchWikipedia=function(n){n=n||{},n.lang=n.lang||"en",n.className=n.className||"ol-search-wikipedia",n.url="https://"+n.lang+".wikipedia.org/w/api.php",n.placeholder=n.placeholder||"search string, File:filename",n.copy='<a href="https://'+n.lang+'.wikipedia.org/" target="new">Wikipedia&reg; - CC-By-SA</a>',ol.control.SearchJSON.call(this,n),this.set("lang",n.lang)},ol.ext.inherits(ol.control.SearchWikipedia,ol.control.SearchJSON),ol.control.SearchWikipedia.prototype.getTitle=function(n){return ol.ext.element.create("DIV",{html:n.title,title:n.desc})},ol.control.SearchWikipedia.prototype.setLang=function(n){this.set("lang",n),this.set("url","https://"+n+".wikipedia.org/w/api.php")},ol.control.SearchWikipedia.prototype.requestData=function(n){var c={action:"opensearch",search:n,lang:this.get("lang"),format:"json",origin:"*",limit:this.get("maxItems")};return c},ol.control.SearchWikipedia.prototype.handleResponse=function(n){for(var c=[],h=0;h<n[1].length;h++)c.push({title:n[1][h],desc:n[2][h],uri:n[3][h]});return c},ol.control.SearchWikipedia.prototype.select=function(n){var c=decodeURIComponent(n.uri.split("/").pop()).replace(/'/,"%27");ol.ext.Ajax.get({url:n.uri.split("wiki/")[0]+"w/api.php",data:{action:"query",prop:"pageimages|coordinates|extracts",exintro:1,explaintext:1,piprop:"original",origin:"*",format:"json",redirects:1,titles:c},options:{encode:!1},success:function(h){var u=h.query.pages[Object.keys(h.query.pages).pop()];console.log(u);var d={title:n.title,desc:u.extract||n.desc,url:n.uri,img:u.original?u.original.source:void 0,pageid:u.pageid},m;u.coordinates&&(d.lon=u.coordinates[0].lon,d.lat=u.coordinates[0].lat,m=[d.lon,d.lat],m=ol.proj.transform(m,"EPSG:4326",this.getMap().getView().getProjection())),this.dispatchEvent({type:"select",search:d,coordinate:m})}.bind(this)})},ol.control.Select=function(n){var c=this;n||(n={});var h=n.content=document.createElement("div");this._ul=ol.ext.element.create("UL",{parent:h}),this._all=ol.ext.element.create("INPUT",{type:"checkbox",checked:!0});var u=ol.ext.element.create("LABEL",{html:this._all,parent:h});ol.ext.element.appendText(u,n.allLabel||"match all"),this._useCase=ol.ext.element.create("INPUT",{type:"checkbox"});var d=ol.ext.element.create("LABEL",{html:this._useCase,parent:h});ol.ext.element.appendText(d,n.caseLabel||"case sensitive"),ol.control.SelectBase.call(this,n),ol.ext.element.create("BUTTON",{className:"ol-append",html:n.addLabel||"add rule",click:function(){c.addCondition()},parent:h}),this._conditions=[],this.set("attrPlaceHolder",n.attrPlaceHolder||"attribute"),this.set("valuePlaceHolder",n.valuePlaceHolder||"value"),this.addCondition()},ol.ext.inherits(ol.control.Select,ol.control.SelectBase),ol.control.Select.prototype.addCondition=function(n){n=n||{},this._conditions.push({attr:n.attr||"",op:n.op||"=",val:n.val||""}),this._drawlist()},ol.control.Select.prototype.getConditions=function(){return{usecase:this._useCase.checked,all:this._all.checked,conditions:this._conditions}},ol.control.Select.prototype.setConditions=function(n){this._useCase.checked=n.usecase,this._all.checked=n.all,this._conditions=n.conditions,this._drawlist()},ol.control.Select.prototype.getConditionsString=function(n){for(var c="",h=0,u;u=n.conditions[h];h++)u.attr&&(c+=(c?n.all?" AND ":" OR ":"")+u.attr+this.operationsList[u.op]+u.val);return c},ol.control.Select.prototype._drawlist=function(){this._ul.innerHTML="";for(var n=0;n<this._conditions.length;n++)this._ul.appendChild(this._getLiCondition(n))},ol.control.Select.prototype._autocomplete=function(n,c){c.classList.remove("ol-hidden"),c.innerHTML="";for(var h={},u=this.get("source"),d=0,m;m=u[d];d++)for(var g=m.getFeatures(),x=0,E;(E=g[x])&&(Object.assign(h,E.getProperties()),!(x>100));x++);var P=new RegExp(n,"i");for(var L in h)if(L!=="geometry"&&P.test(L)){var F=document.createElement("li");F.textContent=L,F.addEventListener("click",function(){c.previousElementSibling.value=this.textContent;var U=document.createEvent("HTMLEvents");U.initEvent("change",!0,!1),c.previousElementSibling.dispatchEvent(U),c.classList.add("ol-hidden")}),c.appendChild(F)}},ol.control.Select.prototype._getLiCondition=function(n){var c=this,h=document.createElement("li"),u=document.createElement("div");u.classList.add("ol-autocomplete"),u.addEventListener("mouseleave",function(){this.querySelector("ul").classList.add("ol-hidden")}),h.appendChild(u);var d=document.createElement("input");d.classList.add("ol-attr"),d.setAttribute("type","search"),d.setAttribute("placeholder",this.get("attrPlaceHolder")),d.addEventListener("keyup",function(){c._autocomplete(this.value,this.nextElementSibling)}),d.addEventListener("focusout",function(){setTimeout(function(){u.querySelector("ul").classList.add("ol-hidden")},300)}),d.addEventListener("click",function(){setTimeout(function(){c._autocomplete(this.value,this.nextElementSibling),this.nextElementSibling.classList.remove("ol-hidden")}.bind(this))}),d.addEventListener("change",function(){c._conditions[n].attr=this.value}),d.value=c._conditions[n].attr,u.appendChild(d);var m=document.createElement("ul");m.classList.add("ol-hidden"),u.appendChild(m);var g=document.createElement("select");h.appendChild(g);for(var x in this.operationsList){var E=document.createElement("option");E.value=x,E.textContent=this.operationsList[x],g.appendChild(E)}g.value=c._conditions[n].op,g.addEventListener("change",function(){c._conditions[n].op=this.value});var P=document.createElement("input");if(P.setAttribute("type","text"),P.setAttribute("placeholder",this.get("valuePlaceHolder")),P.addEventListener("change",function(){c._conditions[n].val=this.value}),P.value=c._conditions[n].val,h.appendChild(P),this._conditions.length>1){var L=document.createElement("div");L.classList.add("ol-delete"),L.addEventListener("click",function(){c.removeCondition(n)}),h.appendChild(L)}return h},ol.control.Select.prototype.removeCondition=function(n){this._conditions.splice(n,1),this._drawlist()},ol.control.Select.prototype.doSelect=function(n){return n=n||{},n.useCase=n.useCase||this._useCase.checked,n.matchAll=n.matchAll||this._all.checked,n.conditions=n.conditions||this._conditions,ol.control.SelectBase.prototype.doSelect.call(this,n)},ol.control.SelectCheck=function(n){n||(n={});var c=n.content=ol.ext.element.create("DIV");n.label&&ol.ext.element.create("LABEL",{html:n.label,parent:c}),this._input=ol.ext.element.create("DIV",{parent:c}),n.className=n.className||"ol-select-check",ol.control.SelectBase.call(this,n),this.set("property",n.property||"name"),this.set("max",n.max||1e4),this.set("defaultLabel",n.defaultLabel),this.set("type",n.type),this._selectAll=n.selectAll,this._onchoice=n.onchoice,n.values?this.setValues({values:n.values,sort:!0}):this.setValues()},ol.ext.inherits(ol.control.SelectCheck,ol.control.SelectBase),ol.control.SelectCheck.prototype.setMap=function(n){ol.control.SelectBase.prototype.setMap.call(this,n),this.setValues()},ol.control.SelectCheck.prototype.doSelect=function(n){console.log("select"),n=n||{};var c=[];return this._checks.forEach(function(h){h.checked&&h.value&&c.push({attr:this.get("property"),op:"=",val:h.value})}.bind(this)),c.length?ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,conditions:c}):ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,matchAll:this._selectAll})},ol.control.SelectCheck.prototype.setValues=function(n){n=n||{};var c,h;if(n.values)n.values instanceof Array?(h={},n.values.forEach(function(x){h[x]=x})):h=n.values;else{h={};var u=this.get("property");this.getSources().forEach(function(x){for(var E=x.getFeatures(),P=Math.min(E.length,this.get("max")),L=0;L<P;L++){var F=E[L].get(u);F&&(h[F]=F)}}.bind(this))}if(Object.keys(h).length){n.sort?(c={},Object.keys(h).sort().forEach(function(x){c[x]=h[x]})):c=h,ol.ext.element.setHTML(this._input,""),this._checks=[];var d="radio_"+new Date().getTime(),m=function(x,E){this._checks.push(ol.ext.element.createCheck({after:E,name:d,val:x,type:this.get("type"),change:function(){this._onchoice?this._onchoice():this.doSelect()}.bind(this),parent:this._input}))}.bind(this);this.get("defaultLabel")&&this.get("type")==="radio"&&m("",this.get("defaultLabel"));for(var g in c)m(g,c[g])}},ol.control.SelectCondition=function(n){n||(n={});var c=n.content=ol.ext.element.create("DIV");this._check=ol.ext.element.createSwitch({after:n.label||"condition",change:function(){this._onchoice?this._onchoice():this.doSelect()}.bind(this),parent:c}),this._input=ol.ext.element.create("DIV",{parent:c}),n.className=n.className||"ol-select-condition",ol.control.SelectBase.call(this,n),this.setCondition(n.condition),this._selectAll=n.selectAll,this._onchoice=n.onchoice},ol.ext.inherits(ol.control.SelectCondition,ol.control.SelectBase),ol.control.SelectCondition.prototype.setCondition=function(n){n?this._conditions=n instanceof Array?n:[n]:this._conditions=[]},ol.control.SelectCondition.prototype.addCondition=function(n){this._conditions.push(n)},ol.control.SelectCondition.prototype.doSelect=function(n){n=n||{};var c=this._conditions;return this._check.checked?ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,conditions:c}):ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,matchAll:this._selectAll})},ol.control.SelectFulltext=function(n){n||(n={});var c=n.content=ol.ext.element.create("DIV");n.label&&ol.ext.element.create("LABEL",{html:n.label,parent:c}),this._input=ol.ext.element.create("INPUT",{placeHolder:n.placeHolder||"search...",change:function(){this._onchoice&&this._onchoice()}.bind(this),parent:c}),ol.control.SelectBase.call(this,n),this._onchoice=n.onchoice,this.set("property",n.property||"name")},ol.ext.inherits(ol.control.SelectFulltext,ol.control.SelectBase),ol.control.SelectFulltext.prototype.doSelect=function(n){return n=n||{},ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,useCase:!1,conditions:[{attr:this.get("property"),op:"contain",val:this._input.value}]})},ol.control.SelectMulti=function(n){n||(n={}),n.content=ol.ext.element.create("DIV"),this._container=ol.ext.element.create("UL",{parent:n.content}),n.className=n.className||"ol-select-multi",ol.control.SelectBase.call(this,n),this._controls=[],n.controls.forEach(this.addControl.bind(this))},ol.ext.inherits(ol.control.SelectMulti,ol.control.SelectBase),ol.control.SelectMulti.prototype.setMap=function(n){this.getMap()&&this._controls.forEach(function(c){this.getMap().remveControl(c)}.bind(this)),ol.control.SelectBase.prototype.setMap.call(this,n),this.getMap()&&this._controls.forEach(function(c){this.getMap().addControl(c)}.bind(this))},ol.control.SelectMulti.prototype.addControl=function(n){n instanceof ol.control.SelectBase&&(this._controls.push(n),n.setTarget(ol.ext.element.create("LI",{parent:this._container})),n._selectAll=!0,n._onchoice=this.doSelect.bind(this),this.getMap()&&this.getMap().addControl(n))},ol.control.SelectMulti.prototype.getControls=function(){return this._controls},ol.control.SelectMulti.prototype.doSelect=function(){var n=[];return this.getSources().forEach(function(c){n=n.concat(c.getFeatures())}),this._controls.forEach(function(c){n=c.doSelect({features:n})}),this.dispatchEvent({type:"select",features:n}),n},ol.control.SelectPopup=function(n){n||(n={});var c=n.content=ol.ext.element.create("DIV");n.label&&ol.ext.element.create("LABEL",{html:n.label,parent:c}),this._input=ol.ext.element.create("SELECT",{on:{change:function(){this._onchoice?this._onchoice():this.doSelect()}.bind(this)},parent:c}),n.className=n.className||"ol-select-popup",ol.control.SelectBase.call(this,n),this.set("property",n.property||"name"),this.set("max",n.max||1e4),this.set("defaultLabel",n.defaultLabel),this._selectAll=n.selectAll,this._onchoice=n.onchoice,this.setValues()},ol.ext.inherits(ol.control.SelectPopup,ol.control.SelectBase),ol.control.SelectPopup.prototype.setMap=function(n){ol.control.SelectBase.prototype.setMap.call(this,n),this.setValues()},ol.control.SelectPopup.prototype.doSelect=function(n){return n=n||{},this._input.value?ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,conditions:[{attr:this.get("property"),op:"=",val:this._input.value}]}):ol.control.SelectBase.prototype.doSelect.call(this,{features:n.features,matchAll:this._selectAll})},ol.control.SelectPopup.prototype.setValues=function(n){n=n||{};var c,h;if(n.values)n.values instanceof Array?(h={},n.values.forEach(function(m){h[m]=m})):h=n.values;else{h={};var u=this.get("property");this.getSources().forEach(function(m){for(var g=m.getFeatures(),x=Math.min(g.length,this.get("max")),E=0;E<x;E++){var P=g[E].get(u);P&&(h[P]=P)}}.bind(this))}n.sort?(c={},Object.keys(h).sort().forEach(function(m){c[m]=h[m]})):c=h,ol.ext.element.setHTML(this._input,""),ol.ext.element.create("OPTION",{className:"ol-default",html:this.get("defaultLabel")||"",value:"",parent:this._input});for(var d in c)ol.ext.element.create("OPTION",{html:c[d],value:d,parent:this._input})},ol.control.Status=function(n){n=n||{};var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-status"+(n.target?"":" ol-unselectable ol-control")});ol.control.Control.call(this,{element:c,target:n.target}),this.setVisible(n.visible!==!1),n.position&&this.setPosition(n.position),this.status(n.status||"")},ol.ext.inherits(ol.control.Status,ol.control.Control),ol.control.Status.prototype.setVisible=function(n){n?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible")},ol.control.Status.prototype.status=function(n){var c=n||"";if(c){if(ol.ext.element.show(this.element),c instanceof Element||typeof c=="string")ol.ext.element.setHTML(this.element,c);else{c="";for(var h in n)c+="<label>"+h+":</label> "+n[h]+"<br/>"}ol.ext.element.setHTML(this.element,c)}else ol.ext.element.hide(this.element)},ol.control.Status.prototype.setPosition=function(n){this.element.classList.remove("ol-left"),this.element.classList.remove("ol-right"),this.element.classList.remove("ol-bottom"),this.element.classList.remove("ol-center"),/^left$|^right$|^bottom$|^center$/.test(n)&&this.element.classList.add("ol-"+n)},ol.control.Status.prototype.show=function(n){n===!1?ol.ext.element.hide(this.element):ol.ext.element.show(this.element)},ol.control.Status.prototype.hide=function(){ol.ext.element.hide(this.element)},ol.control.Status.prototype.toggle=function(){ol.ext.element.toggle(this.element)},ol.control.Status.prototype.isShown=function(){return this.element.style.display==="none"},ol.control.Storymap=function(n){n.target&&(n.html?n.html instanceof Element&&(n.html=n.html.innerHTML):n.html=n.target.innerHTML,n.target.innerHTML="");var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-storymap"+(n.target?"":" ol-unselectable ol-control")});this.content=ol.ext.element.create("DIV",{parent:c}),ol.control.Control.call(this,{element:c,target:n.target}),ol.ext.element.scrollDiv(this.content,{vertical:!0,mousewheel:!0,minibar:n.minibar}),this.setStory(n.html)},ol.ext.inherits(ol.control.Storymap,ol.control.Control),ol.control.Storymap.prototype.setChapter=function(n){for(var c=this.content.querySelectorAll(".chapter"),h=0,u;u=c[h];h++)u.getAttribute("name")===n&&(this.content.scrollTop=u.offsetTop-30)},ol.control.Storymap.prototype.setStory=function(n){n instanceof Element?(this.content.innerHTML="",this.content.appendChild(n)):this.content.innerHTML=n,this.content.querySelectorAll(".chapter").forEach(function(d){d.addEventListener("click",function(m){d.classList.contains("ol-select")?m.target.tagName==="IMG"&&m.target.dataset.title&&this.dispatchEvent({coordinate:this.getMap()?this.getMap().getCoordinateFromPixel([m.layerX,m.layerY]):null,type:"clickimage",img:m.target,title:m.target.dataset.title,element:d,name:d.getAttribute("name"),originalEvent:m}):(this.content.scrollTop=d.offsetTop-30,m.preventDefault())}.bind(this))}.bind(this));var c=this.content.querySelectorAll(".ol-scroll-next");c.forEach(function(d){d.addEventListener("click",function(m){if(d.parentElement.classList.contains("ol-select")){for(var g=this.content.querySelectorAll(".chapter"),x=d.offsetTop,E=0,P;P=g[E];E++)if(P.offsetTop>x){x=P.offsetTop;break}this.content.scrollTop=x-30,m.stopPropagation(),m.preventDefault()}}.bind(this))}.bind(this)),c=this.content.querySelectorAll(".ol-scroll-top"),c.forEach(function(d){d.addEventListener("click",function(m){this.content.scrollTop=0,m.stopPropagation(),m.preventDefault()}.bind(this))}.bind(this));var h=function(d){var m=[parseFloat(d.getAttribute("data-lon")),parseFloat(d.getAttribute("data-lat"))],g=ol.proj.fromLonLat(m,this.getMap().getView().getProjection()),x=parseFloat(d.getAttribute("data-zoom"));return{type:"scrollto",element:d,name:d.getAttribute("name"),coordinate:g,lon:m,zoom:x}}.bind(this),u=this.content.querySelectorAll(".chapter")[0];setTimeout(function(){u.classList.add("ol-select"),this.dispatchEvent(h(u))}.bind(this)),this.content.addEventListener("scroll",function(){var d,m=this.content.querySelectorAll(".chapter"),g=ol.ext.element.getStyle(this.content,"height");if(!this.content.scrollTop)d=m[0];else for(var x=0,E;E=m[x];x++){var P=E.offsetTop-this.content.scrollTop;if(P>g/3)break;d=E}if(d&&d!==u){u&&u.classList.remove("ol-select"),u=d,u.classList.add("ol-select");var L=h(u),F=this.getMap().getView();switch(F.cancelAnimations(),u.getAttribute("data-animation")){case"flyto":{F.flyTo({center:L.coordinate,zoomAt:Math.min(F.getZoom(),L.zoom)-1,zoom:L.zoom});break}default:break}this.dispatchEvent(L)}}.bind(this))},ol.control.Swipe=function(n){n=n||{};var c=document.createElement("button"),h=document.createElement("div");h.className=(n.className||"ol-swipe")+" ol-unselectable ol-control",h.appendChild(c),h.addEventListener("mousedown",this.move.bind(this)),h.addEventListener("touchstart",this.move.bind(this)),ol.control.Control.call(this,{element:h}),this.precomposeRight_=this.precomposeRight.bind(this),this.precomposeLeft_=this.precomposeLeft.bind(this),this.postcompose_=this.postcompose.bind(this),this.layers=[],n.layers&&this.addLayer(n.layers,!1),n.rightLayers&&this.addLayer(n.rightLayers,!0),this.on("propertychange",function(u){if(this.getMap())try{this.getMap().renderSync()}catch{}this.get("orientation")==="horizontal"?(this.element.style.top=this.get("position")*100+"%",this.element.style.left=""):(this.get("orientation")!=="vertical"&&this.set("orientation","vertical"),this.element.style.left=this.get("position")*100+"%",this.element.style.top=""),u.key==="orientation"&&(this.element.classList.remove("horizontal","vertical"),this.element.classList.add(this.get("orientation"))),this.isMoving||this.layers.forEach(function(d){d.layer.getImageRatio&&d.layer.changed()})}.bind(this)),this.set("position",n.position||.5),this.set("orientation",n.orientation||"vertical")},ol.ext.inherits(ol.control.Swipe,ol.control.Control),ol.control.Swipe.prototype.setMap=function(n){var c,h;if(this.getMap()){for(c=0;c<this.layers.length;c++)h=this.layers[c],h.right?h.layer.un(["precompose","prerender"],this.precomposeRight_):h.layer.un(["precompose","prerender"],this.precomposeLeft_),h.layer.un(["postcompose","postrender"],this.postcompose_);try{this.getMap().renderSync()}catch{}}if(ol.control.Control.prototype.setMap.call(this,n),n){for(this._listener=[],c=0;c<this.layers.length;c++)h=this.layers[c],h.right?h.layer.on(["precompose","prerender"],this.precomposeRight_):h.layer.on(["precompose","prerender"],this.precomposeLeft_),h.layer.on(["postcompose","postrender"],this.postcompose_);try{n.renderSync()}catch{}}},ol.control.Swipe.prototype.isLayer_=function(n){for(var c=0;c<this.layers.length;c++)if(this.layers[c].layer===n)return c;return-1},ol.control.Swipe.prototype.addLayer=function(n,c){n instanceof Array||(n=[n]);for(var h=0;h<n.length;h++){var u=n[h];if(this.isLayer_(u)<0&&(this.layers.push({layer:u,right:c}),this.getMap())){c?u.on(["precompose","prerender"],this.precomposeRight_):u.on(["precompose","prerender"],this.precomposeLeft_),u.on(["postcompose","postrender"],this.postcompose_);try{this.getMap().renderSync()}catch{}}}},ol.control.Swipe.prototype.removeLayers=function(){var n=[];this.layers.forEach(function(c){n.push(c.layer)}),this.removeLayer(n)},ol.control.Swipe.prototype.removeLayer=function(n){n instanceof Array||(n=[n]);for(var c=0;c<n.length;c++){var h=this.isLayer_(n[c]);h>=0&&this.getMap()&&(this.layers[h].right?n[c].un(["precompose","prerender"],this.precomposeRight_):n[c].un(["precompose","prerender"],this.precomposeLeft_),n[c].un(["postcompose","postrender"],this.postcompose_),this.layers.splice(h,1))}if(this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.Swipe.prototype.getRectangle=function(){var n;return this.get("orientation")==="vertical"?(n=this.getMap().getSize(),[0,0,n[0]*this.get("position"),n[1]]):(n=this.getMap().getSize(),[0,0,n[0],n[1]*this.get("position")])},ol.control.Swipe.prototype.move=function(n){var c=this,h;switch(this._movefn||(this._movefn=this.move.bind(this)),n.type){case"touchcancel":case"touchend":case"mouseup":{c.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(x){document.removeEventListener(x,c._movefn)}),this.layers.forEach(function(x){x.layer.getImageRatio&&x.layer.changed()});break}case"mousedown":case"touchstart":c.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(x){document.addEventListener(x,c._movefn)});case"mousemove":case"touchmove":{if(c.isMoving)if(c.get("orientation")==="vertical"){var u=n.pageX||n.touches&&n.touches.length&&n.touches[0].pageX||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageX;if(!u)break;u-=c.getMap().getTargetElement().getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft,h=c.getMap().getSize()[0];var d=h-Math.min(Math.max(0,h-u),h);h=d/h,c.set("position",h),c.dispatchEvent({type:"moving",size:[d,c.getMap().getSize()[1]],position:[h,0]})}else{var m=n.pageY||n.touches&&n.touches.length&&n.touches[0].pageY||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageY;if(!m)break;m-=c.getMap().getTargetElement().getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop,h=c.getMap().getSize()[1];var g=h-Math.min(Math.max(0,h-m),h);h=g/h,c.set("position",h),c.dispatchEvent({type:"moving",size:[c.getMap().getSize()[0],g],position:[0,h]})}break}default:break}},ol.control.Swipe.prototype._transformPt=function(n,c){var h=n.inversePixelTransform,u=c[0],d=c[1];return c[0]=h[0]*u+h[2]*d+h[4],c[1]=h[1]*u+h[3]*d+h[5],c},ol.control.Swipe.prototype._drawRect=function(n,c){var h=n.inversePixelTransform;if(h){var u=[[c[0][0],c[0][1]],[c[0][0],c[1][1]],[c[1][0],c[1][1]],[c[1][0],c[0][1]],[c[0][0],c[0][1]]];if(n.context.save(),n.target.getImageRatio){var d=-Math.atan2(n.frameState.pixelToCoordinateTransform[1],n.frameState.pixelToCoordinateTransform[0]);n.context.translate(n.frameState.size[0]/2,n.frameState.size[1]/2),n.context.rotate(d),n.context.translate(-n.frameState.size[0]/2,-n.frameState.size[1]/2)}u.forEach(function(g,x){g=[g[0]*h[0]-g[1]*h[1]+h[4],-g[0]*h[2]+g[1]*h[3]+h[5]],x?n.context.lineTo(g[0],g[1]):n.context.moveTo(g[0],g[1])}),n.context.restore()}else{var m=n.frameState.pixelRatio;n.context.rect(c[0][0]*m,c[0][1]*m,c[1][0]*m,c[1][1]*m)}},ol.control.Swipe.prototype.precomposeLeft=function(n){var c=n.context;if(c instanceof WebGLRenderingContext){if(n.type==="prerender"){c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT),c.enable(c.SCISSOR_TEST);var h=this.getMap().getSize(),u=this._transformPt(n,[0,h[1]]),d=this._transformPt(n,[h[0],0]),m=d[0]-u[0],g=d[1]-u[1];if(this.get("orientation")==="vertical")var x=Math.round(m*this.get("position")),E=g;else{var x=m,E=Math.round(g*this.get("position"));u[1]+=g-E}c.scissor(u[0],u[1],x,E)}}else{var P=n.frameState.size;c.save(),c.beginPath();var L=[[0,0],[P[0],P[1]]];this.get("orientation")==="vertical"?L[1]=[P[0]*.5+this.getMap().getSize()[0]*(this.get("position")-.5),P[1]]:L[1]=[P[0],P[1]*.5+this.getMap().getSize()[1]*(this.get("position")-.5)],this._drawRect(n,L),c.clip()}},ol.control.Swipe.prototype.precomposeRight=function(n){var c=n.context;if(c instanceof WebGLRenderingContext){if(n.type==="prerender"){c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT),c.enable(c.SCISSOR_TEST);var h=this.getMap().getSize(),u=this._transformPt(n,[0,h[1]]),d=this._transformPt(n,[h[0],0]),m=d[0]-u[0],g=d[1]-u[1];if(this.get("orientation")==="vertical"){var x=g,E=Math.round(m*(1-this.get("position")));u[0]+=m-E}else var E=m,x=Math.round(g*(1-this.get("position")));c.scissor(u[0],u[1],E,x)}}else{var P=n.frameState.size;c.save(),c.beginPath();var L=[[0,0],[P[0],P[1]]];this.get("orientation")==="vertical"?L[0]=[P[0]*.5+this.getMap().getSize()[0]*(this.get("position")-.5),0]:L[0]=[0,P[1]*.5+this.getMap().getSize()[1]*(this.get("position")-.5)],this._drawRect(n,L),c.clip()}},ol.control.Swipe.prototype.postcompose=function(n){if(n.context instanceof WebGLRenderingContext){if(n.type==="postrender"){var c=n.context;c.disable(c.SCISSOR_TEST)}}else n.target.getClassName&&n.target.getClassName()!=="ol-layer"&&n.target.get("declutter")?setTimeout(function(){n.context.restore()},0):n.context.restore()},ol.control.SwipeMap=function(n){n=n||{};var c=document.createElement("button"),h=document.createElement("div");h.className=(n.className||"ol-swipe")+" ol-unselectable ol-control",h.appendChild(c),h.addEventListener("mousedown",this.move.bind(this)),h.addEventListener("touchstart",this.move.bind(this)),ol.control.Control.call(this,{element:h}),this.on("propertychange",function(u){this.get("orientation")==="horizontal"?(this.element.style.top=this.get("position")*100+"%",this.element.style.left=""):(this.get("orientation")!=="vertical"&&this.set("orientation","vertical"),this.element.style.left=this.get("position")*100+"%",this.element.style.top=""),u.key==="orientation"&&(this.element.classList.remove("horizontal","vertical"),this.element.classList.add(this.get("orientation"))),this._clip()}.bind(this)),this.on("change:active",this._clip.bind(this)),this.set("position",n.position||.5),this.set("orientation",n.orientation||"vertical"),this.set("right",n.right)},ol.ext.inherits(ol.control.SwipeMap,ol.control.Control),ol.control.SwipeMap.prototype.setMap=function(n){if(this.getMap()){this._listener&&ol.Observable.unByKey(this._listener);var c=this.getMap().getViewport().querySelector(".ol-layers");c.style.clip=""}ol.control.Control.prototype.setMap.call(this,n),n&&(this._listener=n.on("change:size",this._clip.bind(this)))},ol.control.SwipeMap.prototype._clip=function(){if(this.getMap()){var n=this.getMap().getViewport().querySelector(".ol-layers"),c=this.getRectangle();n.style.clip="rect("+c[1]+"px,"+c[2]+"px,"+c[3]+"px,"+c[0]+"px)"}},ol.control.SwipeMap.prototype.getRectangle=function(){var n=this.getMap().getSize();return this.get("orientation")==="vertical"?this.get("right")?[n[0]*this.get("position"),0,n[0],n[1]]:[0,0,n[0]*this.get("position"),n[1]]:this.get("right")?[0,n[1]*this.get("position"),n[0],n[1]]:[0,0,n[0],n[1]*this.get("position")]},ol.control.SwipeMap.prototype.move=function(n){var c=this,h;switch(this._movefn||(this._movefn=this.move.bind(this)),n.type){case"touchcancel":case"touchend":case"mouseup":{c.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(x){document.removeEventListener(x,c._movefn)});break}case"mousedown":case"touchstart":c.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(x){document.addEventListener(x,c._movefn)});case"mousemove":case"touchmove":{if(c.isMoving)if(c.get("orientation")==="vertical"){var u=n.pageX||n.touches&&n.touches.length&&n.touches[0].pageX||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageX;if(!u)break;u-=c.getMap().getTargetElement().getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft,h=c.getMap().getSize()[0];var d=h-Math.min(Math.max(0,h-u),h);h=d/h,c.set("position",h),c.dispatchEvent({type:"moving",size:[d,c.getMap().getSize()[1]],position:[h,0]})}else{var m=n.pageY||n.touches&&n.touches.length&&n.touches[0].pageY||n.changedTouches&&n.changedTouches.length&&n.changedTouches[0].pageY;if(!m)break;m-=c.getMap().getTargetElement().getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop,h=c.getMap().getSize()[1];var g=h-Math.min(Math.max(0,h-m),h);h=g/h,c.set("position",h),c.dispatchEvent({type:"moving",size:[c.getMap().getSize()[0],g],position:[0,h]})}break}default:break}},ol.control.Target=function(n){n=n||{},this.style=n.style||[new ol.style.Style({image:new ol.style.RegularShape({points:4,radius:11,radius1:0,radius2:0,snapToPixel:!0,stroke:new ol.style.Stroke({color:"#fff",width:3})})}),new ol.style.Style({image:new ol.style.RegularShape({points:4,radius:11,radius1:0,radius2:0,snapToPixel:!0,stroke:new ol.style.Stroke({color:"#000",width:1})})})],this.style instanceof Array||(this.style=[this.style]),this.composite=n.composite||"";var c=document.createElement("div");c.className="ol-target ol-unselectable ol-control",ol.control.CanvasBase.call(this,{element:c,target:n.target}),this.setVisible(n.visible!==!1)},ol.ext.inherits(ol.control.Target,ol.control.CanvasBase),ol.control.Target.prototype.setVisible=function(n){if(this.set("visible",n),this.getMap())try{this.getMap().renderSync()}catch{}},ol.control.Target.prototype.getVisible=function(){return this.get("visible")},ol.control.Target.prototype._draw=function(n){var c=this.getContext(n);if(!(!c||!this.getMap()||!this.getVisible())){var h=n.frameState.pixelRatio;c.save(),c.scale(h,h);var u=c.canvas.width/(2*h),d=c.canvas.height/(2*h),m=new ol.geom.Point(this.getMap().getCoordinateFromPixel([u,d]));this.composite&&(c.globalCompositeOperation=this.composite);for(var g=0;g<this.style.length;g++){var x=this.style[g];if(x instanceof ol.style.Style){var E=n.vectorContext;if(!E){var P={inversePixelTransform:[h,0,0,h,0,0],context:c,frameState:{pixelRatio:h,extent:n.frameState.extent,coordinateToPixelTransform:n.frameState.coordinateToPixelTransform,viewState:n.frameState.viewState}};E=ol.render.getVectorContext(P)}E.setStyle(x),E.drawGeometry(m)}}c.restore()}},ol.control.TextButton=function(n){n=n||{},n.className=(n.className||"")+" ol-text-button",ol.control.Button.call(this,n)},ol.ext.inherits(ol.control.TextButton,ol.control.Button),ol.control.Timeline=function(n){var c=ol.ext.element.create("DIV",{className:(n.className||"")+" ol-timeline"+(n.target?"":" ol-unselectable ol-control")+(n.zoomButton?" ol-hasbutton":"")});ol.control.Control.call(this,{element:c,target:n.target}),this._scrollDiv=ol.ext.element.create("DIV",{className:"ol-scroll",parent:this.element}),this._buttons=ol.ext.element.create("DIV",{className:"ol-buttons",parent:this.element}),n.zoomButton&&(this.addButton({className:"ol-zoom-in",handleClick:function(){var u=this.get("zoom");u>=1?u++:u=Math.min(1,u+.1),u=Math.round(u*100)/100,this.refresh(u)}.bind(this)}),this.addButton({className:"ol-zoom-out",handleClick:function(){var u=this.get("zoom");u>1?u--:u-=.1,u=Math.round(u*100)/100,this.refresh(u)}.bind(this)})),this._intervalDiv=ol.ext.element.create("DIV",{className:"ol-center-date",parent:this.element}),this.element.addEventListener("mouseover",function(){this._select&&this._select.elt.classList.remove("ol-select")}.bind(this));var h=null;this._scrollDiv.addEventListener("scroll",function(){this._setScrollLeft(),h&&(clearTimeout(h),h=null),h=setTimeout(function(){this.dispatchEvent({type:"scroll",date:this.getDate(),dateStart:this.getDate("start"),dateEnd:this.getDate("end")})}.bind(this),n.scrollTimeout||15)}.bind(this)),ol.ext.element.scrollDiv(this._scrollDiv,{onmove:function(u){this._moving=u}.bind(this)}),this._tline=[],this._scrollLeft=0,this.set("maxWidth",n.maxWidth||2e3),this.set("minDate",n.minDate||1/0),this.set("maxDate",n.maxDate||-1/0),this.set("graduation",n.graduation),this.set("minZoom",n.minZoom||.2),this.set("maxZoom",n.maxZoom||4),this.setInterval(n.interval),n.getHTML&&(this._getHTML=n.getHTML),n.getFeatureDate&&(this._getFeatureDate=n.getFeatureDate),n.endFeatureDate&&(this._endFeatureDate=n.endFeatureDate),this.setFeatures(n.features||n.source,n.zoom)},ol.ext.inherits(ol.control.Timeline,ol.control.Control),ol.control.Timeline.prototype.setMap=function(n){ol.control.Control.prototype.setMap.call(this,n),this.refresh(this.get("zoom")||1,!0)},ol.control.Timeline.prototype.addButton=function(n){this.element.classList.add("ol-hasbutton"),ol.ext.element.create("BUTTON",{className:n.className||void 0,title:n.title,html:n.html,click:n.handleClick,parent:this._buttons})},ol.control.Timeline.prototype.setInterval=function(n){typeof n=="string"&&(/s$/.test(n)?n=parseFloat(n)*1e3:/mn$/.test(n)?n=parseFloat(n)*1e3*60:/h$/.test(n)?n=parseFloat(n)*1e3*3600:/d$/.test(n)?n=parseFloat(n)*1e3*3600*24:/y$/.test(n)?n=parseFloat(n)*1e3*3600*24*365:n=0),this.set("interval",n||0),n?this.element.classList.add("ol-interval"):this.element.classList.remove("ol-interval"),this.refresh(this.get("zoom"))},ol.control.Timeline.prototype._getHTML=function(n){return n.get("name")||""},ol.control.Timeline.prototype._getFeatureDate=function(n){return n&&n.get?n.get("date"):null},ol.control.Timeline.prototype._endFeatureDate=function(){},ol.control.Timeline.prototype.isCollapsed=function(){return this.element.classList.contains("ol-collapsed")},ol.control.Timeline.prototype.collapse=function(n){n?this.element.classList.add("ol-collapsed"):this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})},ol.control.Timeline.prototype.toggle=function(){this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})},ol.control.Timeline.prototype.setFeatures=function(n,c){this._features=this._source=null,n instanceof ol.source.Vector?this._source=n:n instanceof Array?this._features=n:this._features=[],this.refresh(c)},ol.control.Timeline.prototype.getFeatures=function(){return this._features||this._source.getFeatures()},ol.control.Timeline.prototype.refresh=function(n,c){if(this.getMap()){n||(n=this.get("zoom")),n=Math.min(this.get("maxZoom"),Math.max(this.get("minZoom"),n||1)),this.set("zoom",n),this._scrollDiv.innerHTML="";var h=this.getFeatures(),u,d,m=this._tline=[];h.forEach(function(B){(u=this._getFeatureDate(B))&&(u instanceof Date||(u=new Date(u)),this._endFeatureDate&&(d=this._endFeatureDate(B),d instanceof Date||(d=new Date(d))),isNaN(u)||m.push({date:u,end:isNaN(d)?null:d,feature:B}))}.bind(this)),m.sort(function(B,O){return B.date<O.date?-1:B.date===O.date?0:1});var g=ol.ext.element.create("DIV",{parent:this._scrollDiv}),x=this._minDate=Math.min(this.get("minDate"),m.length?m[0].date:1/0),E=this._maxDate=Math.max(this.get("maxDate"),m.length?m[m.length-1].date:-1/0);isFinite(x)||(this._minDate=x=new Date),isFinite(E)||(this._maxDate=E=new Date);var P=E-x,L=this.get("maxWidth"),F=this._scale=(P>L?L/P:1)*n;x=this._minDate=this._minDate-10/F,P=(E-x)*F,ol.ext.element.setStyle(g,{width:P,maxWidth:"unset"}),this._drawTime(g,x,E,F),this.get("interval")?ol.ext.element.setStyle(this._intervalDiv,{width:this.get("interval")*F}):ol.ext.element.setStyle(this._intervalDiv,{width:""});var U=[],A=ol.ext.element.getStyle(this._scrollDiv,"lineHeight"),G=ol.ext.element.create("DIV",{className:"ol-features",parent:g});m.forEach(function(B){for(var O=B.date,K=B.elt=ol.ext.element.create("DIV",{className:"ol-feature",style:{left:Math.round((O-x)*F)},html:this._getHTML(B.feature),parent:G}),Q=K.querySelectorAll("img"),et=0;et<Q.length;et++)Q[et].ondragstart=function(){return!1};B.end&&ol.ext.element.setStyle(K,{minWidth:(B.end-O)*F,width:(B.end-O)*F,maxWidth:"unset"});var lt=ol.ext.element.getStyle(K,"left");K.addEventListener("click",function(){this._moving||this.dispatchEvent({type:"select",feature:B.feature})}.bind(this));var pt,T;for(pt=0;(T=U[pt])&&!(lt>T);pt++);U[pt]=lt+ol.ext.element.getStyle(K,"width"),ol.ext.element.setStyle(K,{top:pt*A})}.bind(this)),this._nbline=U.length,c&&this.setDate(this._minDate,{anim:!1,position:"start"}),this.dispatchEvent({type:"scroll",date:this.getDate(),dateStart:this.getDate("start"),dateEnd:this.getDate("end")})}},ol.control.Timeline.prototype._getOffsetFromDate=function(n){return(n-this._minDate)*this._scale},ol.control.Timeline.prototype._getDateFromOffset=function(n){return n/this._scale+this._minDate},ol.control.Timeline.prototype._setScrollLeft=function(n){this._scrollLeft=n,n!==void 0&&(this._scrollDiv.scrollLeft=n)},ol.control.Timeline.prototype._getScrollLeft=function(){return this._scrollLeft===void 0?this._scrollDiv.scrollLeft:this._scrollLeft},ol.control.Timeline.prototype._drawTime=function(n,c,h,u){var d=ol.ext.element.create("DIV",{className:"ol-times",parent:n}),m,g,x,E,P=ol.ext.element.getStyle(d,"left"),L=ol.ext.element.getStyle(d,"height"),F=new Date(this._minDate).getFullYear();g=(new Date(0).setFullYear(String(F))-new Date(0).setFullYear(String(F-1)))*u;for(var U=Math.round(2*L/g)+1;m=new Date(0).setFullYear(F),!(m>this._maxDate);)ol.ext.element.create("DIV",{className:"ol-time ol-year",style:{left:this._getOffsetFromDate(m)-P},html:F,parent:d}),F+=U;if(/day|month/.test(this.get("graduation"))&&(g=(new Date(0,0,1).setFullYear(String(F))-new Date(0,0,1).setFullYear(String(F-1)))*u,E=Math.max(1,Math.round(12/Math.round(g/L/2))),E<12))for(F=new Date(this._minDate).getFullYear(),x=E+1;m=new Date(0,0,1),m.setFullYear(F),m.setMonth(x-1),!(m>this._maxDate);)ol.ext.element.create("DIV",{className:"ol-time ol-month",style:{left:this._getOffsetFromDate(m)-P},html:m.toLocaleDateString(void 0,{month:"short"}),parent:d}),x+=E,x>12&&(F++,x=E+1);if(this.get("graduation")==="day"){g=(new Date(0,1,1)-new Date(0,0,1))*u;var A=Math.max(1,Math.round(31/Math.round(g/L/2)));if(A<31){F=new Date(this._minDate).getFullYear(),x=0;for(var G=A;;)if(m=new Date(0,0,1),m.setFullYear(F),m.setMonth(x),m.setDate(G),isNaN(m))x++,x>12&&(x=1,F++),G=A;else{if(m>this._maxDate)break;if(G>1){var B=this._getOffsetFromDate(m);this._getOffsetFromDate(new Date(F,x+1,1))-B>L&&ol.ext.element.create("DIV",{className:"ol-time ol-day",style:{left:B-P},html:G,parent:d})}F=m.getFullYear(),x=m.getMonth(),G=m.getDate()+A,G>new Date(F,x+1,0).getDate()&&(x++,G=A)}}}},ol.control.Timeline.prototype.setDate=function(n,c){var h;if(c=c||{},n instanceof Date?h=n:(this.getFeatures().indexOf(n)>=0&&(h=this._getFeatureDate(n)),h&&!(h instanceof Date)&&(h=new Date(h)),(!h||isNaN(h))&&(h=new Date(String(n)))),!isNaN(h)){c.anim===!1&&this._scrollDiv.classList.add("ol-move");var u=this._getOffsetFromDate(h);if(c.position==="start"?u+=ol.ext.element.outerWidth(this._scrollDiv)/2-ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2:c.position==="end"&&(u-=ol.ext.element.outerWidth(this._scrollDiv)/2-ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2),this._setScrollLeft(u),c.anim===!1&&this._scrollDiv.classList.remove("ol-move"),n)for(var d=0,m;m=this._tline[d];d++)m.feature===n?(m.elt.classList.add("ol-select"),this._select=m):m.elt.classList.remove("ol-select")}},ol.control.Timeline.prototype.roundDate=function(n,c){switch(c){case"mn":return new Date(this._roundTo(n,60*1e3));case"hour":return new Date(this._roundTo(n,60*60*1e3));case"day":return new Date(this._roundTo(n,24*60*60*1e3));case"month":return n=new Date(this._roundTo(n,24*60*60*1e3)),n.getDate()>15&&(n=new Date(n.setMonth(n.getMonth()+1))),n=n.setDate(1),new Date(n);default:return new Date(n)}},ol.control.Timeline.prototype.getDate=function(n,c){var h;switch(c||(c=n),n){case"start":{this.get("interval")?h=-ol.ext.element.getStyle(this._intervalDiv,"width")/2+ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2:h=-ol.ext.element.outerWidth(this._scrollDiv)/2+ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2;break}case"end":{this.get("interval")?h=ol.ext.element.getStyle(this._intervalDiv,"width")/2-ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2:h=ol.ext.element.outerWidth(this._scrollDiv)/2-ol.ext.element.getStyle(this._scrollDiv,"marginLeft")/2;break}default:{h=0;break}}var u=this._getDateFromOffset(this._getScrollLeft()+h);return u=this.roundDate(u,c),new Date(u)},ol.control.Timeline.prototype._roundTo=function(n,c){return Math.round(n/c)*c},ol.control.Timeline.prototype.getStartDate=function(){return new Date(this.get("minDate"))},ol.control.Timeline.prototype.getEndDate=function(){return new Date(this.get("maxDate"))},ol.control.VideoRecorder=function(n){n||(n={});var c=ol.ext.element.create("DIV",{className:(n.className||"ol-videorec")+" ol-unselectable ol-control"});ol.ext.element.create("BUTTON",{type:"button",className:"ol-start",title:"start",click:function(){this.start()}.bind(this),parent:c}),ol.ext.element.create("BUTTON",{type:"button",className:"ol-stop",title:"stop",click:function(){this.stop()}.bind(this),parent:c}),ol.ext.element.create("BUTTON",{type:"button",className:"ol-pause",title:"pause",click:function(){this.pause()}.bind(this),parent:c}),ol.ext.element.create("BUTTON",{type:"button",className:"ol-resume",title:"resume",click:function(){this.resume()}.bind(this),parent:c}),ol.control.Control.call(this,{element:c,target:n.target}),this.set("framerate",30),this.set("videoBitsPerSecond",5e6),n.videoTarget==="DIALOG"?(this._dialog=new ol.control.Dialog({className:"ol-fullscreen-dialog",target:document.body,closeBox:!0}),this._videoTarget=this._dialog.getContentElement()):this._videoTarget=n.videoTarget,this._printCtrl=new ol.control.Print({target:ol.ext.element.create("DIV")})},ol.ext.inherits(ol.control.VideoRecorder,ol.control.Control),ol.control.VideoRecorder.prototype.setMap=function(n){this.getMap()&&(this.getMap().removeControl(this._printCtrl),this._dialog&&this.getMap().removeControl(this._dialog)),ol.control.Control.prototype.setMap.call(this,n),this.getMap()&&(this.getMap().addControl(this._printCtrl),this._dialog&&this.getMap().addControl(this._dialog))},ol.control.VideoRecorder.prototype.start=function(){var n=this._printCtrl,c=!1;function h(u){c||n.fastPrint({canvas:u},h)}n.fastPrint({},function(u){var d;try{d=u.captureStream(this.get("framerate")||30)}catch(g){this.dispatchEvent({type:"error",error:g});return}this._mediaRecorder=new MediaRecorder(d,{videoBitsPerSecond:this.get("videoBitsPerSecond")||5e6});var m=[];this._mediaRecorder.ondataavailable=function(g){m.push(g.data)},this._mediaRecorder.onstop=function(){c=!0;var g=new Blob(m,{type:"video/mp4"});if(m=[],this._videoTarget instanceof Element){var x;this._videoTarget.tagName==="VIDEO"?x=this._videoTarget:(x=this._videoTarget.querySelector("video"),x||(x=ol.ext.element.create("VIDEO",{controls:"",parent:this._videoTarget}))),this._dialog&&this._dialog.show(),x.src=URL.createObjectURL(g),this.dispatchEvent({type:"stop",videoURL:x.src})}else this.dispatchEvent({type:"stop",videoURL:URL.createObjectURL(g)})}.bind(this),this._mediaRecorder.onpause=function(){c=!0,this.dispatchEvent({type:"pause"})}.bind(this),this._mediaRecorder.onresume=function(){c=!1,h(u),this.dispatchEvent({type:"resume"})}.bind(this),this._mediaRecorder.onerror=function(g){this.dispatchEvent({type:"error",error:g})}.bind(this),c=!1,h(u),this._mediaRecorder.start(),this.dispatchEvent({type:"start",canvas:u}),this.element.setAttribute("data-state","rec")}.bind(this))},ol.control.VideoRecorder.prototype.stop=function(){this._mediaRecorder&&(this._mediaRecorder.stop(),this._mediaRecorder=null,this.element.setAttribute("data-state","inactive"))},ol.control.VideoRecorder.prototype.pause=function(){this._mediaRecorder&&(this._mediaRecorder.pause(),this.element.setAttribute("data-state","pause"))},ol.control.VideoRecorder.prototype.resume=function(){this._mediaRecorder&&(this._mediaRecorder.resume(),this.element.setAttribute("data-state","rec"))},ol.control.WMSCapabilities=function(n){n=n||{};var c=Object.assign({},n||{});this._proxy=n.proxy,c.target===document.body&&delete c.target,c.target?(c.className=((c.className||"")+" ol-wmscapabilities ol-hidden").trim(),delete c.target):(c.className=((c.className||"")+" ol-wmscapabilities").trim(),c.handleClick=function(){this.showDialog()}.bind(this)),ol.control.Button.call(this,c),this.set("srs",n.srs||[]),this.set("cors",n.cors),this.set("trace",n.trace),this.set("title",n.title),this.set("loadLabel",n.loadLabel),this.set("optional",n.optional),this.createDialog(n),this._elements.formVersion.value="1.0.0";var h=this._getParser();this._ajax=new ol.ext.Ajax({dataType:"text",auth:n.authentication}),this._ajax.on("success",function(u){var d;try{d=h.read(u.response)}catch(m){this.showError({type:"load",error:m})}d&&(d.Capability.Layer.Layer?this.showCapabilities(d):this.showError({type:"noLayer"})),this.dispatchEvent({type:"capabilities",capabilities:d}),typeof u.options.callback=="function"&&u.options.callback(d)}.bind(this)),this._ajax.on("error",function(u){this.showError({type:"load",error:u}),this.dispatchEvent({type:"capabilities"}),u.options.callback}.bind(this)),this._ajax.on("loadstart",function(){this._elements.element.classList.add("ol-searching")}.bind(this)),this._ajax.on("loadend",function(){this._elements.element.classList.remove("ol-searching")}.bind(this)),n.onselect&&this.on("load",function(u){n.onselect(u.layer,u.options)})},ol.ext.inherits(ol.control.WMSCapabilities,ol.control.Button),ol.control.WMSCapabilities.prototype._getParser=function(){return new ol.format.WMSCapabilities},ol.control.WMSCapabilities.prototype.error={load:"Can't retrieve service capabilities, try to add it manually...",badUrl:"The input value is not a valid url...",TileMatrix:"No TileMatrixSet supported...",noLayer:"No layer available for this service...",srs:"The service projection looks different from that of your map, it may not display correctly..."},ol.control.WMSCapabilities.prototype.labels={formTitle:"Title:",formLayer:"Layers:",formMap:"Map:",formStyle:"Style:",formFormat:"Format:",formMinZoom:"Min zoom level:",formMaxZoom:"Max zoom level:",formExtent:"Extent:",mapExtent:"use map extent...",formProjection:"Projection:",formCrossOrigin:"CrossOrigin:",formVersion:"Version:",formAttribution:"Attribution:"},ol.control.WMSCapabilities.prototype.createDialog=function(n){var c=n.target;(!c||c===document.body)&&(this._dialog=new ol.control.Dialog({className:"ol-wmscapabilities",closeBox:!0,closeOnSubmit:!1,target:n.target}),this._dialog.on("button",function(A){A.button==="submit"&&this.getCapabilities(A.inputs.url.value)}.bind(this)),c=null);var h=ol.ext.element.create("DIV",{className:("ol-wmscapabilities "+(n.className||"")).trim(),parent:c});this._elements={element:c||h};var u=ol.ext.element.create("DIV",{className:"ol-url",parent:h}),d=this._elements.input=ol.ext.element.create("INPUT",{className:"url",type:"text",tabIndex:1,placeholder:n.placeholder||"service url...",autocorrect:"off",autocapitalize:"off",parent:u});if(d.addEventListener("keyup",function(A){A.keyCode===13&&this.getCapabilities(d.value,n)}.bind(this)),n.services){var m=ol.ext.element.create("SELECT",{className:"url",on:{change:function(A){var G=A.target.options[A.target.selectedIndex].value;this.getCapabilities(G,n),A.target.selectedIndex=0}.bind(this)},parent:u});ol.ext.element.create("OPTION",{html:" ",parent:m});for(var g in n.services)ol.ext.element.create("OPTION",{html:g,value:n.services[g],parent:m})}ol.ext.element.create("BUTTON",{click:function(){this.getCapabilities(d.value,n)}.bind(this),html:n.searchLabel||"search",parent:u}),this._elements.error=ol.ext.element.create("DIV",{className:"ol-error",parent:u});var x=this._elements.result=ol.ext.element.create("DIV",{className:"ol-result",parent:h}),E=ol.ext.element.create("DIV",{className:"ol-preview",html:n.previewLabel||"preview",parent:x});this._elements.preview=ol.ext.element.create("IMG",{parent:E}),this._img=new Image,this._img.crossOrigin="Anonymous",this._img.addEventListener("error",function(){E.className="ol-preview tainted",this._elements.formCrossOrigin.checked=!1}.bind(this)),this._img.addEventListener("load",function(){E.className="ol-preview ok",this._elements.formCrossOrigin.checked=!0}.bind(this)),this._elements.select=ol.ext.element.create("DIV",{className:"ol-select-list",tabIndex:2,parent:x}),this._elements.data=ol.ext.element.create("DIV",{className:"ol-data",parent:x}),this._elements.buttons=ol.ext.element.create("DIV",{className:"ol-buttons",parent:x}),this._elements.legend=ol.ext.element.create("IMG",{className:"ol-legend",parent:x});var P=this._elements.form=ol.ext.element.create("UL",{className:"ol-wmsform",parent:h}),L=function(A,G,B){var O=ol.ext.element.create("LI",{parent:P});if(ol.ext.element.create("LABEL",{html:this.labels[A],parent:O}),typeof G=="boolean")this._elements[A]=ol.ext.element.create("INPUT",{type:"checkbox",checked:G,parent:O});else if(G instanceof Array){var K=this._elements[A]=ol.ext.element.create("SELECT",{parent:O});G.forEach(function(Q){ol.ext.element.create("OPTION",{html:Q,value:Q,parent:K})}.bind(this))}else this._elements[A]=ol.ext.element.create("INPUT",{value:G===void 0?"":G,placeholder:B||"",type:typeof G=="number"?"number":"text",parent:O});return O}.bind(this);L("formTitle"),L("formLayer","","layer1,layer2,...");var F=L("formMap");F.setAttribute("data-param","map"),F=L("formStyle"),F.setAttribute("data-param","style"),L("formFormat",["image/png","image/jpeg"]),L("formMinZoom",0),L("formMaxZoom",20),F=L("formExtent","","xmin,ymin,xmax,ymax"),F.setAttribute("data-param","extent");var U=F.querySelector("input");return ol.ext.element.create("BUTTON",{title:this.labels.mapExtent,click:function(){U.value=this.getMap().getView().calculateExtent(this.getMap().getSize()).join(",")}.bind(this),parent:F}),F=L("formProjection",""),F.setAttribute("data-param","proj"),L("formCrossOrigin",!1),F=L("formVersion","1.3.0"),F.setAttribute("data-param","version"),L("formAttribution",""),ol.ext.element.create("BUTTON",{html:this.get("loadLabel")||"Load",click:function(){var A=this._getFormOptions(),G=this.getLayerFromOptions(A);this.dispatchEvent({type:"load",layer:G,options:A}),this._dialog.hide()}.bind(this),parent:P}),h},ol.control.WMSCapabilities.prototype.getLayerFromOptions=function(n){n.layer.source=new ol.source.TileWMS(n.source);var c=new ol.layer.Tile(n.layer);return delete n.layer.source,c},ol.control.WMSCapabilities.prototype.setMap=function(n){ol.control.Button.prototype.setMap.call(this,n),this._dialog&&this._dialog.setMap(n)},ol.control.WMSCapabilities.prototype.getDialog=function(){return this._dialog},ol.control.WMSCapabilities.prototype.showDialog=function(n,c){this.showError(),this._elements.formProjection.value||(this._elements.formProjection.value=this.getMap().getView().getProjection().getCode()),this._dialog&&this._dialog.show({title:this.get("title")===void 0?"WMS":this.get("title"),content:this._elements.element}),this.getCapabilities(n,c);var h=this._elements.select.querySelector(".selected");h&&(this._elements.select.scrollTop=h.offsetTop-20)},ol.control.WMSCapabilities.prototype.testUrl=function(n){var c=new RegExp("^(https?:\\/\\/)((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=\\/-]*)?(\\#[-a-z\\d_]*)?$","i");return!!c.test(n)},ol.control.WMSCapabilities.prototype.getRequestParam=function(n){return{SERVICE:"WMS",REQUEST:"GetCapabilities",VERSION:n.version||"1.3.0"}},ol.control.WMSCapabilities.prototype.getCapabilities=function(n,c){if(n){if(!this.testUrl(n)){this.showError({type:"badUrl"});return}c=c||{},n=n.split("?");var h=n[1];n=n[0],this._elements.formMap.value="",this._elements.formLayer.value="",this._elements.formStyle.value="",this._elements.formTitle.value="",this._elements.formProjection.value=this.getMap().getView().getProjection().getCode(),this._elements.formFormat.selectedIndex=0;var u=c.map||"",d={};h&&(h=h.replace(/^\?/,"").split("&"),h.forEach(function(L){if(L=L.split("="),L[1]=decodeURIComponent(L[1]||""),/^map$/i.test(L[0])&&(u=L[1],this._elements.formMap.value=u),/^layers$/i.test(L[0])&&(this._elements.formLayer.value=L[1],this._elements.formTitle.value=L[1].split(",")[0]),/^style$/i.test(L[0])&&(this._elements.formStyle.value=L[1]),/^crs$/i.test(L[0])&&(this._elements.formProjection.value=L[1]),/^format$/i.test(L[0])){for(var F,U=0;F=this._elements.formFormat.options[U];U++)if(F.value===L[1]){this._elements.formFormat.selectedIndex=U;break}}this.get("optional")&&this.get("optional").split(",").forEach(function(A){A===L[0]&&(d[A]=L[1])}.bind(this))}.bind(this)));var m=this.getRequestParam(c),g=[];u&&(m.MAP=u,g.push("map="+u));for(var x in d)m[x]=d[x],g.push(x+"="+d[x]);if(this._elements.input.value=(n||"")+(g?"?"+g.join("&"):""),this.clearForm(),this._proxy){var E="";for(var P in m)E+=(E?"&":"")+P+"="+m[P];this._ajax.send(this._proxy,{url:E},{timeout:c.timeout||1e4,callback:c.onload,abort:!1})}else this._ajax.send(n,m,{timeout:c.timeout||1e4,callback:c.onload,abort:!1})}},ol.control.WMSCapabilities.prototype.showError=function(n){n?this._elements.error.innerHTML=this.error[n.type]||"ERROR ("+n.type+")":this._elements.error.innerHTML="",n&&n.type==="load"?this._elements.form.classList.add("visible"):this._elements.form.classList.remove("visible")},ol.control.WMSCapabilities.prototype.clearForm=function(){this._elements.result.classList.remove("ol-visible"),this.showError(),this._elements.select.innerHTML="",this._elements.data.innerHTML="",this._elements.preview.src="",this._elements.legend.src="",this._elements.legend.classList.remove("visible")},ol.control.WMSCapabilities.prototype.showCapabilities=function(n){this._elements.result.classList.add("ol-visible");var c=[],h=function(u,d){d=d||0,u.Layer.forEach(function(m){m.Attribution||(m.Attribution=u.Attribution),m.EX_GeographicBoundingBox||(m.EX_GeographicBoundingBox=u.EX_GeographicBoundingBox);var g=ol.ext.element.create("DIV",{className:(m.Layer?"ol-title ":"")+"level-"+d,html:m.Name||m.Title,click:function(){this._elements.buttons.innerHTML="",this._elements.data.innerHTML="",this._elements.legend.src=this._elements.preview.src="",this._elements.element.classList.remove("ol-form"),this.showError();var x=this.getOptionsFromCap(m,n),E=this.getLayerFromOptions(x);if(this._currentOptions=x,c.forEach(function(F){F.classList.remove("selected")}),g.classList.add("selected"),E){ol.ext.element.create("BUTTON",{html:this.get("loadLabel")||"Load",className:"ol-load",click:function(){this.dispatchEvent({type:"load",layer:E,options:x}),this._dialog&&this._dialog.hide()}.bind(this),parent:this._elements.buttons}),ol.ext.element.create("BUTTON",{className:"ol-wmsform",click:function(){this._elements.element.classList.toggle("ol-form")}.bind(this),parent:this._elements.buttons});var P=this.getMap().getView().getResolution(),L=this.getMap().getView().getCenter();this._elements.preview.src=E.getPreview(L,P,this.getMap().getView().getProjection()),this._img.src=this._elements.preview.src,ol.ext.element.create("p",{className:"ol-title",html:x.data.title,parent:this._elements.data}),ol.ext.element.create("p",{html:x.data.abstract,parent:this._elements.data}),x.data.legend&&x.data.legend.length?(this._elements.legend.src=x.data.legend[0],this._elements.legend.classList.add("visible")):(this._elements.legend.src="",this._elements.legend.classList.remove("visible"))}}.bind(this),parent:this._elements.select});c.push(g),m.Layer&&h(m,d+1)}.bind(this))}.bind(this);this._elements.select.innerHTML="",h(n.Capability.Layer)},ol.control.WMSCapabilities.prototype.getLayerResolution=function(n,c,h){var u=n==="min"?"MinScaleDenominator":"MaxScaleDenominator";if(c[u]!==void 0)return c[u]/(72/2.54*100);if(!c.Layer)return n==="min"?0:156543.03392804097;h=n==="min"?156543.03392804097:0;for(var d=0;d<c.Layer.length;d++){var m=this.getLayerResolution(n,c.Layer[d],h);m!==void 0&&(h=Math[n](h,m))}return h},ol.control.WMSCapabilities.prototype.getOptionsFromCap=function(n,c){var h=c.Capability.Request.GetMap.Format,u,d,m=[/png/,/jpeg/,/gif/];for(d=0;d<3;d++){for(var g=0;g<h.length;g++)if(m[d].test(h[g])){u=h[g];break}if(u)break}u||(u=h[0]);var x=this.getMap().getView().getProjection().getCode();this.showError();var E=!1;n.CRS?n.CRS.indexOf(x)>=0?E=!0:n.CRS.indexOf("EPSG:4326")>=0?(x="EPSG:4326",E=!0):this.get("srs").forEach(function(et){n.CRS.indexOf(et)>=0&&(x=et,E=!0)}):E=!1,E||(this.showError({type:"srs"}),this.get("trace")&&console.log("BAD srs: ",n.CRS));var P=n.EX_GeographicBoundingBox;P&&(P=ol.proj.transformExtent(P,"EPSG:4326",this.getMap().getView().getProjection()));var L=[];n.Attribution&&L.push('<a href="'+encodeURI(n.Attribution.OnlineResource)+'">&copy; '+n.Attribution.Title.replace(/</g,"&lt;")+"</a>");var F={title:n.Title,extent:P,queryable:n.queryable,abstract:n.Abstract,minResolution:this.getLayerResolution("min",n),maxResolution:this.getLayerResolution("max",n)||156543.03392804097},U={url:c.Capability.Request.GetMap.DCPType[0].HTTP.Get.OnlineResource,projection:x,attributions:L,crossOrigin:this.get("cors")?"anonymous":null,params:{LAYERS:n.Name,FORMAT:u,VERSION:c.version||"1.3.0"}},A=new ol.View({projection:this.getMap().getView().getProjection()});A.setResolution(F.minResolution);var G=Math.round(A.getZoom());A.setResolution(F.maxResolution);var B=Math.round(A.getZoom());if(this._fillForm({title:F.title,layers:U.params.LAYERS,format:U.params.FORMAT,minZoom:B,maxZoom:G,extent:P?P.join(","):"",projection:U.projection,attribution:U.attributions[0]||"",version:U.params.VERSION}),this.get("trace")){var O=JSON.stringify([U],null,"	").replace(/\\"/g,'"');F.source="SOURCE";var K="new ol.layer.Tile ("+JSON.stringify(F,null,"	")+")";K=K.replace(/\\"/g,'"').replace('"SOURCE"',"new ol.source.TileWMS("+O+")").replace(/\\t/g,"	").replace(/\\n/g,`
`).replace(`([
	`,"(").replace(`}
])`,"})"),console.log(K),delete F.source}var Q=[];return n.Style&&n.Style.forEach(function(et){et.LegendURL&&Q.push(et.LegendURL[0].OnlineResource)}),{layer:F,source:U,data:{title:n.Title,abstract:n.Abstract,logo:n.Attribution&&n.Attribution.LogoURL?n.Attribution.LogoURL.OnlineResource:void 0,keyword:n.KeywordList,legend:Q,opaque:n.opaque,queryable:n.queryable}}},ol.control.WMSCapabilities.prototype._getFormOptions=function(){var n=parseInt(this._elements.formMinZoom.value),c=parseInt(this._elements.formMaxZoom.value),h=new ol.View({projection:this.getMap().getView().getProjection()});h.setZoom(n);var u=h.getResolution();h.setZoom(c);var d=h.getResolution(),m=[];this._elements.formExtent.value&&this._elements.formExtent.value.split(",").forEach(function(E){m.push(parseFloat(E))}),m.length!==4&&(m=void 0);var g=[];this._elements.formAttribution.value&&g.push(this._elements.formAttribution.value);var x={layer:{title:this._elements.formTitle.value,extent:m,maxResolution:u,minResolution:d},source:{url:this._elements.input.value,crossOrigin:this._elements.formCrossOrigin.checked?"anonymous":null,projection:this._elements.formProjection.value,attributions:g,params:{FORMAT:this._elements.formFormat.options[this._elements.formFormat.selectedIndex].value,LAYERS:this._elements.formLayer.value,VERSION:this._elements.formVersion.value}},data:{title:this._elements.formTitle.value}};return this._elements.formMap.value&&(x.source.params.MAP=this._elements.formMap.value),x},ol.control.WMSCapabilities.prototype._fillForm=function(n){this._elements.formTitle.value=n.title,this._elements.formLayer.value=n.layers,this._elements.formStyle.value=n.style;var c,h;for(h=0;c=this._elements.formFormat.options[h];h++)if(c.value===n.format){this._elements.formFormat.selectedIndex=h;break}this._elements.formExtent.value=n.extent||"",this._elements.formMaxZoom.value=n.maxZoom,this._elements.formMinZoom.value=n.minZoom,this._elements.formProjection.value=n.projection,this._elements.formAttribution.value=n.attribution,this._elements.formVersion.value=n.version},ol.control.WMSCapabilities.prototype.loadLayer=function(n,c,h){this.getCapabilities(n,{onload:function(u){u?u.Capability.Layer.Layer.forEach(function(d){if(d.Name===c||d.Identifier===c){var m=this.getOptionsFromCap(d,u),g=this.getLayerFromOptions(m);this.dispatchEvent({type:"load",layer:g,options:m}),typeof h=="function"&&h({layer:g,options:m})}}.bind(this)):this.dispatchEvent({type:"load",error:!0})}.bind(this)})},ol.control.WMTSCapabilities=function(n){n=n||{},n.title=n.title||"WMTS",ol.control.WMSCapabilities.call(this,n),this.getDialog().element.classList.add("ol-wmtscapabilities")},ol.ext.inherits(ol.control.WMTSCapabilities,ol.control.WMSCapabilities),ol.control.WMTSCapabilities.prototype._getParser=function(){var n=new ol.format.WMTSCapabilities;return{read:function(c){var h=n.read(c);h.Capability={Layer:h.Contents},h.Capability.Layer.Attribution={Title:h.ServiceProvider.ProviderName};var u=[];return h.Contents.Layer.forEach(function(d){d.Format&&/jpeg|png/.test(d.Format[0])&&u.push(d)}),h.Contents.Layer=u,h}.bind(this)}},ol.control.WMTSCapabilities.prototype.getRequestParam=function(n){return{SERVICE:"WMTS",REQUEST:"GetCapabilities",VERSION:n.version||"1.0.0"}},ol.control.WMTSCapabilities.prototype._getTG=function(n,c,h,u){for(var d=new Array,m=new Array,g=ol.extent.getWidth(ol.proj.get("EPSG:3857").getExtent())/256,x=0;x<=(h||20);x++){var E=u?n+":"+x:x;d[x]=E,m[x]=g/Math.pow(2,x)}return{origin:[-20037508,20037508],resolutions:m,matrixIds:d,minZoom:c||0}},ol.control.WMTSCapabilities.prototype.getTileGrid=function(n,c,h,u){return new ol.tilegrid.WMTS(this._getTG(n,c,h,u))},ol.control.WMTSCapabilities.prototype.getOptionsFromCap=function(n,c){var h=n.WGS84BoundingBox;h&&(h=ol.proj.transformExtent(h,"EPSG:4326",this.getMap().getView().getProjection()));var u=1/0,d=-1/0,m;if(n.TileMatrixSetLink.forEach(function(A){(A.TileMatrixSet==="PM"||A.TileMatrixSet==="EPSG:3857"||A.TileMatrixSet==="webmercator")&&(m=A,n.TileMatrixSet=A.TileMatrixSet)}),!m){this.showError({type:"TileMatrix"});return}if(m.TileMatrixSetLimits){var g=m.TileMatrixSetLimits[0].TileMatrix.split(":").length>1;m.TileMatrixSetLimits.forEach(function(A){var G=A.TileMatrix.split(":").pop();u=Math.min(u,parseInt(G)),d=Math.max(d,parseInt(G))})}else u=0,d=20;var x=new ol.View;x.setZoom(u);var E={title:n.Title,extent:h,abstract:n.Abstract,maxResolution:x.getResolution()},P={url:c.OperationsMetadata.GetTile.DCP.HTTP.Get[0].href,layer:n.Identifier,matrixSet:n.TileMatrixSet,format:n.Format[0]||"image/jpeg",projection:"EPSG:3857",tilePrefix:g,minZoom:u,maxZoom:d,style:n.Style?n.Style[0].Identifier:"normal",attributions:n.Attribution.Title,crossOrigin:this.get("cors")?"anonymous":null,wrapX:this.get("wrapX")!==!1};if(this._fillForm({title:E.title,layers:P.layer,style:P.style,format:P.format,minZoom:u,maxZoom:d,extent:h?h.join(","):"",projection:P.projection,attribution:P.attributions||"",version:"1.0.0"}),this.get("trace")){P.tileGrid="TILEGRID";var L=JSON.stringify([P],null,"	").replace(/\\"/g,'"');L=L.replace('"TILEGRID"',"new ol.tilegrid.WMTS("+JSON.stringify(this._getTG(P.matrixSet,P.minZoom,P.maxZoom,P.tilePrefix),null,"	").replace(/\n/g,`
		`)+")"),delete P.tileGrid,E.source="SOURCE";var F="new ol.layer.Tile ("+JSON.stringify(E,null,"	")+")";F=F.replace(/\\"/g,'"').replace('"SOURCE"',"new ol.source.WMTS("+L+")").replace(/\\t/g,"	").replace(/\\n/g,`
`).replace(/"tileGrid": {/g,'"tileGrid": new ol.tilegrid.WMTS({').replace(/},\n(\t*)"style"/g,`}),
$1"style"`).replace(`([
	`,"(").replace(`}
])`,"})"),console.log(F),delete E.source}var U=void 0;return n.Style&&n.Style[0]&&n.Style[0].LegendURL&&n.Style[0].LegendURL[0]&&(U=n.Style[0].LegendURL[0].href),{layer:E,source:P,data:{title:n.Title,abstract:n.Abstract,legend:U}}},ol.control.WMTSCapabilities.prototype._getFormOptions=function(){var n=this._currentOptions||{};n.layer||(n.layer={}),n.source||(n.source={}),n.data||(n.data={});var c=parseInt(this._elements.formMinZoom.value)||0,h=parseInt(this._elements.formMaxZoom.value)||20,u=[];this._elements.formExtent.value&&this._elements.formExtent.value.split(",").forEach(function(E){u.push(parseFloat(E))}),u.length!==4&&(u=void 0);var d=[];this._elements.formAttribution.value&&d.push(this._elements.formAttribution.value);var m=new ol.View({projection:this.getMap().getView().getProjection()});m.setZoom(c);var g={title:this._elements.formTitle.value,extent:u,abstract:n.layer.abstract||"",maxResolution:m.getResolution()},x={url:this._elements.input.value,layer:this._elements.formLayer.value,matrixSet:n.source.matrixSet||"PM",format:this._elements.formFormat.options[this._elements.formFormat.selectedIndex].value,projection:"EPSG:3857",minZoom:c,maxZoom:h,style:this._elements.formStyle.value||"normal",attributions:d,crossOrigin:this._elements.formCrossOrigin.checked?"anonymous":null,wrapX:this.get("wrapX")!==!1};return{layer:g,source:x,data:{title:this._elements.formTitle.value,abstract:n.data.abstract,legend:n.data.legend}}},ol.control.WMTSCapabilities.prototype.getLayerFromOptions=function(n){if(n){n.source.tileGrid=this.getTileGrid(n.source.matrixSet,n.source.minZoom,n.source.maxZoom,n.source.tilePrefix),n.layer.source=new ol.source.WMTS(n.source);var c=new ol.layer.Tile(n.layer);return delete n.layer.source,delete n.source.tileGrid,c}},ol.featureAnimation=function(n){n=n||{},this.duration_=typeof n.duration=="number"?n.duration>=0?n.duration:0:1e3,this.fade_=typeof n.fade=="function"?n.fade:null,this.repeat_=Number(n.repeat);var c=typeof n.easing=="function"?n.easing:ol.easing.linear;n.revers?this.easing_=function(h){return 1-c(h)}:this.easing_=c,this.hiddenStyle=n.hiddenStyle,ol.Object.call(this)},ol.ext.inherits(ol.featureAnimation,ol.Object),ol.featureAnimation.hiddenStyle=new ol.style.Style({image:new ol.style.Circle({}),stroke:new ol.style.Stroke({color:"transparent"})}),ol.featureAnimation.prototype.drawGeom_=function(n,c,h){this.fade_&&(n.context.globalAlpha=this.fade_(1-n.elapsed));for(var u=n.style,d=0;d<u.length;d++)try{var m=n.vectorContext||ol.render.getVectorContext(n),g=ol.ext.getVectorContextStyle(n,u[d]);m.setStyle(g),g.getZIndex()<0?m.drawGeometry(h||c):m.drawGeometry(c)}catch{}},ol.featureAnimation.prototype.animate=function(){return!1},ol.Map.prototype.animateFeature=function(n,c){var h=this._featureAnimationLayer;h||(h=this._featureAnimationLayer=new ol.layer.Vector({source:new ol.source.Vector}),h.setMap(this)),h.getSource().addFeature(n);var u=c.on("animationend",function(d){d.feature===n&&(h.getSource().removeFeature(n),ol.Observable.unByKey(u))});h.animateFeature(n,c)},ol.layer.Base.prototype.animateFeature=function(n,c,h){var u=this,d,m=n.getStyle(),g=m||(this.getStyleFunction?this.getStyleFunction()(n):null);g||(g=[]),g instanceof Array||(g=[g]);var x={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:n,geom:n.getGeometry(),typeGeom:n.getGeometry().getType(),bbox:n.getGeometry().getExtent(),coord:ol.extent.getCenter(n.getGeometry().getExtent()),style:g};c instanceof Array||(c=[c]);for(var E=c.length-1;E>=0;E--)c[E].duration_===0&&c.splice(E,1);var P=0,L=0,F=h&&this.getFilters?this.getFilters():[];function U(B){x.type=B.type;try{x.vectorContext=B.vectorContext||ol.render.getVectorContext(B)}catch{}if(x.frameState=B.frameState,x.inversePixelTransform=B.inversePixelTransform,x.extent||(x.extent=B.frameState.extent,x.start=B.frameState.time,x.context=B.context),x.time=B.frameState.time-x.start,x.elapsed=x.time/c[L].duration_,x.elapsed>1&&(x.elapsed=1),B.context.save(),F.forEach(function(K){K.get("active")&&K.precompose(B)}),this.getOpacity&&(B.context.globalAlpha=this.getOpacity()),!c[L].animate(x))P++,P<c[L].repeat_?x.extent=!1:L<c.length-1?(c[L].dispatchEvent({type:"animationend",feature:n}),L++,P=0,x.extent=!1):A();else{var O={type:"animating",step:L,start:x.start,time:x.time,elapsed:x.elapsed,rotation:x.rotation||0,geom:x.geom,coordinate:x.coord,feature:n};c[L].dispatchEvent(O),u.dispatchEvent(O)}F.forEach(function(K){K.get("active")&&K.postcompose(B)}),B.context.restore(),B.frameState.animate=!0}function A(B){ol.Observable.unByKey(d),d=null,n.setStyle(m);var O={type:"animationend",feature:n};if(B)for(var K in B)B.hasOwnProperty(K)&&(O[K]=B[K]);c[L].dispatchEvent(O),u.dispatchEvent(O)}function G(B){if(c.length&&!d){if(d=u.on(["postcompose","postrender"],U.bind(u)),u.renderSync)try{u.renderSync()}catch{}else u.changed();n.setStyle(c[L].hiddenStyle||ol.featureAnimation.hiddenStyle);var O={type:"animationstart",feature:n};if(B)for(var K in B)B.hasOwnProperty(K)&&(O[K]=B[K]);c[L].dispatchEvent(O),u.dispatchEvent(O)}}return G(),{start:G,stop:A,isPlaying:function(){return!!d}}},ol.featureAnimation.Blink=function(n){ol.featureAnimation.call(this,n),this.set("nb",n.nb||10)},ol.ext.inherits(ol.featureAnimation.Blink,ol.featureAnimation),ol.featureAnimation.Blink.prototype.animate=function(n){return Math.round(this.easing_(n.elapsed)*this.get("nb"))%2||this.drawGeom_(n,n.geom),n.time<=this.duration_},ol.featureAnimation.Bounce=function(n){n=n||{},ol.featureAnimation.call(this,n),this.amplitude_=n.amplitude||40,this.bounce_=-Math.PI*(n.bounce||3)},ol.ext.inherits(ol.featureAnimation.Bounce,ol.featureAnimation),ol.featureAnimation.Bounce.prototype.animate=function(n){var c=n.geom.clone(),h=Math.abs(Math.sin(this.bounce_*n.elapsed))*this.amplitude_*(1-this.easing_(n.elapsed))*n.frameState.viewState.resolution;return c.translate(0,h),this.drawGeom_(n,c,n.geom),n.time<=this.duration_},ol.featureAnimation.Drop=function(n){n=n||{},this.speed_=n.speed||0,ol.featureAnimation.call(this,n),this.side_=n.side||"top"},ol.ext.inherits(ol.featureAnimation.Drop,ol.featureAnimation),ol.featureAnimation.Drop.prototype.animate=function(n){if(!n.time){var c=n.frameState.viewState.rotation,h=n.frameState.size[1]*n.frameState.viewState.resolution;this.side_!="top"&&(h*=-1),this.dx=-Math.sin(c)*h,this.dy=Math.cos(c)*h,this.speed_&&(this.duration_=h/this.speed_/n.frameState.viewState.resolution)}var u=n.geom.clone();return u.translate(this.dx*(1-this.easing_(n.elapsed)),this.dy*(1-this.easing_(n.elapsed))),this.drawGeom_(n,u,n.geom),n.time<=this.duration_},ol.featureAnimation.Fade=function(n){n=n||{},this.speed_=n.speed||0,ol.featureAnimation.call(this,n)},ol.ext.inherits(ol.featureAnimation.Fade,ol.featureAnimation),ol.featureAnimation.Fade.prototype.animate=function(n){return n.context.globalAlpha=this.easing_(n.elapsed),this.drawGeom_(n,n.geom),n.time<=this.duration_},ol.featureAnimation.None=function(n){ol.featureAnimation.call(this,n)},ol.ext.inherits(ol.featureAnimation.None,ol.featureAnimation),ol.featureAnimation.None.prototype.animate=function(n){return n.time<=this.duration_},ol.featureAnimation.Null=function(){ol.featureAnimation.call(this,{duration:0})},ol.ext.inherits(ol.featureAnimation.Null,ol.featureAnimation),ol.featureAnimation.Path=function(n){switch(n=n||{},ol.featureAnimation.call(this,n),this.speed_=n.speed||0,this.path_=n.path,n.rotate){case!0:case 0:this.rotate_=0;break;default:this.rotate_=n.rotate||!1;break}this.path_&&this.path_.getGeometry&&(this.path_=this.path_.getGeometry()),this.path_&&this.path_.getLineString&&(this.path_=this.path_.getLineString()),this.path_.getLength?(this.dist_=this.path_.getLength(),this.path_&&this.path_.getCoordinates&&(this.path_=this.path_.getCoordinates())):this.dist_=0,this.speed_>0&&(this.duration_=this.dist_/this.speed_)},ol.ext.inherits(ol.featureAnimation.Path,ol.featureAnimation),ol.featureAnimation.Path.prototype.animate=function(n){if(!n.time&&!this.dist_)return!1;var c=this.dist_*this.easing_(n.elapsed),h,u,d,m,g,x,E=0;u=this.path_[0];for(var P=1;P<this.path_.length;P++){if(h=u,u=this.path_[P],m=u[0]-h[0],g=u[1]-h[1],x=Math.sqrt(m*m+g*g),x&&E+x>=c){d=(c-E)/x,u=[h[0]+(u[0]-h[0])*d,h[1]+(u[1]-h[1])*d];break}E+=x}var L=n.style;if(n.rotation=Math.PI/2+Math.atan2(h[1]-u[1],h[0]-u[0]),this.rotate_!==!1){var F=[],U=this.rotate_-n.rotation+n.frameState.viewState.rotation;n.rotation=Math.PI/2+Math.atan2(h[1]-u[1],h[0]-u[0]);for(var A=0;d=n.style[A];A++)d.getImage()&&d.getImage().setRotation(U),F.push(d);n.style=F}return n.geom.setCoordinates(u),this.drawGeom_(n,n.geom),n.style=L,n.time<=this.duration_},ol.featureAnimation.Shake=function(n){n=n||{},ol.featureAnimation.call(this,n),this.amplitude_=n.amplitude||40,this.bounce_=-Math.PI*(n.bounce||6),this.horizontal_=n.horizontal},ol.ext.inherits(ol.featureAnimation.Shake,ol.featureAnimation),ol.featureAnimation.Shake.prototype.animate=function(n){var c=n.geom.clone(),h=n.geom.clone(),u=this.easing_(n.elapsed);return u=Math.sin(this.bounce_*u)*this.amplitude_*(1-u)*n.frameState.viewState.resolution,this.horizontal_?(c.translate(u,0),h.translate(u,0)):c.translate(0,u),this.drawGeom_(n,c,h),n.time<=this.duration_},ol.featureAnimation.Show=function(n){ol.featureAnimation.call(this,n)},ol.ext.inherits(ol.featureAnimation.Show,ol.featureAnimation),ol.featureAnimation.Show.prototype.animate=function(n){return this.drawGeom_(n,n.geom),n.time<=this.duration_},ol.featureAnimation.Slide=function(n){n=n||{},this.speed_=n.speed||0,ol.featureAnimation.call(this,n),this.side_=n.side||"left"},ol.ext.inherits(ol.featureAnimation.Slide,ol.featureAnimation),ol.featureAnimation.Slide.prototype.animate=function(n){n.time||(this.side_=="left"?this.dx=n.extent[0]-n.bbox[2]:this.dx=n.extent[2]-n.bbox[0],this.speed_&&(this.duration_=Math.abs(this.dx)/this.speed_/n.frameState.viewState.resolution));var c=n.geom.clone();return c.translate(this.dx*(1-this.easing_(n.elapsed)),0),this.drawGeom_(n,c),n.time<=this.duration_},ol.featureAnimation.Teleport=function(n){ol.featureAnimation.call(this,n)},ol.ext.inherits(ol.featureAnimation.Teleport,ol.featureAnimation),ol.featureAnimation.Teleport.prototype.animate=function(n){var c=this.easing_(n.elapsed);if(c){n.context.save();var h=n.frameState.pixelRatio;n.context.globalAlpha=c,n.context.scale(c,1/c);var u=n.frameState.coordinateToPixelTransform,d=(1/c-1)*h*(u[0]*n.coord[0]+u[1]*n.coord[1]+u[4]),m=(c-1)*h*(u[2]*n.coord[0]+u[3]*n.coord[1]+u[5]);n.context.translate(d,m),this.drawGeom_(n,n.geom),n.context.restore()}return n.time<=this.duration_},ol.featureAnimation.Throw=function(n){n=n||{},ol.featureAnimation.call(this,n),this.speed_=n.speed||0,this.side_=n.side||"left"},ol.ext.inherits(ol.featureAnimation.Throw,ol.featureAnimation),ol.featureAnimation.Throw.prototype.animate=function(n){if(!n.time&&this.speed_){var c,h;this.side_=="left"?(c=this.dx=n.extent[0]-n.bbox[2],h=this.dy=n.extent[3]-n.bbox[1]):(c=this.dx=n.extent[2]-n.bbox[0],h=this.dy=n.extent[3]-n.bbox[1]),this.duration_=Math.sqrt(c*c+h*h)/this.speed_/n.frameState.viewState.resolution}var u=n.geom.clone(),d=n.geom.clone();return u.translate(this.dx*(1-this.easing_(n.elapsed)),this.dy*Math.cos(Math.PI/2*this.easing_(n.elapsed))),d.translate(this.dx*(1-this.easing_(n.elapsed)),0),this.drawGeom_(n,u,d),n.time<=this.duration_},ol.featureAnimation.Zoom=function(n){n=n||{},ol.featureAnimation.call(this,n),this.set("zoomout",n.zoomOut)},ol.ext.inherits(ol.featureAnimation.Zoom,ol.featureAnimation),ol.featureAnimation.ZoomOut=function(n){n=n||{},n.zoomOut=!0,ol.featureAnimation.Zoom.call(this,n)},ol.ext.inherits(ol.featureAnimation.ZoomOut,ol.featureAnimation.Zoom),ol.featureAnimation.Zoom.prototype.animate=function(n){var c=this.easing_(n.elapsed);if(c){this.get("zoomout")&&(c=1/c);var h=n.style,u,d,m=[];for(u=0;u<h.length;u++)d=h[u].getImage(),d&&(m[u]=d.getScale(),n.type==="postrender"?d.setScale(m[u]*c/n.frameState.pixelRatio):d.setScale(m[u]*c));for(this.drawGeom_(n,n.geom),u=0;u<h.length;u++)d=h[u].getImage(),d&&d.setScale(m[u])}return n.time<=this.duration_},ol.filter={},ol.filter.Base=function(n){ol.Object.call(this,n),this._listener=[],n&&n.active===!1?this.set("active",!1):this.set("active",!0)},ol.ext.inherits(ol.filter.Base,ol.Object),ol.filter.Base.prototype.setActive=function(n){this.set("active",n===!0)},ol.filter.Base.prototype.getActive=function(){return this.get("active")},function(){function n(m){this.get("active")&&m.context&&this.precompose(m)}function c(m){this.get("active")&&m.context&&this.postcompose(m)}function h(){if(this.renderSync)try{this.renderSync()}catch{}else this.changed()}function u(m){this.filters_||(this.filters_=[]),this.filters_.push(m),m.addToLayer&&m.addToLayer(this),m.precompose&&m._listener.push({listener:this.on(["precompose","prerender"],n.bind(m)),target:this}),m.postcompose&&m._listener.push({listener:this.on(["postcompose","postrender"],c.bind(m)),target:this}),m._listener.push({listener:m.on("propertychange",h.bind(this)),target:this}),h.call(this)}function d(m){var g;if(this.filters_||(this.filters_=[]),!m){this.filters_.forEach(function(x){this.removeFilter(x)}.bind(this));return}for(g=this.filters_.length-1;g>=0;g--)this.filters_[g]===m&&this.filters_.splice(g,1);for(g=m._listener.length-1;g>=0;g--)m._listener[g].target===this&&(m.removeFromLayer&&m.removeFromLayer(this),ol.Observable.unByKey(m._listener[g].listener),m._listener.splice(g,1));h.call(this)}ol.Map.prototype.addFilter=function(m){console.warn("[OL-EXT] addFilter deprecated on map."),u.call(this,m)},ol.Map.prototype.removeFilter=function(m){d.call(this,m)},ol.Map.prototype.getFilters=function(){return this.filters_||[]},ol.layer.Base.prototype.addFilter=function(m){u.call(this,m)},ol.layer.Base.prototype.removeFilter=function(m){d.call(this,m)},ol.layer.Base.prototype.getFilters=function(){return this.filters_||[]}}(),ol.filter.Mask=function(n){if(n=n||{},ol.filter.Base.call(this,n),n.feature)switch(n.feature.getGeometry().getType()){case"Polygon":case"MultiPolygon":this.feature_=n.feature;break;default:break}this.set("inner",n.inner),this.fillColor_=n.fill&&ol.color.asString(n.fill.getColor())||"rgba(0,0,0,0.2)"},ol.ext.inherits(ol.filter.Mask,ol.filter.Base),ol.filter.Mask.prototype.drawFeaturePath_=function(n,c){var h=n.context,u=h.canvas,d=n.frameState.pixelRatio,m;if(n.frameState.coordinateToPixelTransform){var g=n.frameState.coordinateToPixelTransform;if(n.inversePixelTransform){var x=n.inversePixelTransform;m=function(Q){return Q=[Q[0]*g[0]+Q[1]*g[1]+g[4],Q[0]*g[2]+Q[1]*g[3]+g[5]],[Q[0]*x[0]-Q[1]*x[1]+x[4],-Q[0]*x[2]+Q[1]*x[3]+x[5]]}}else m=function(Q){return[(Q[0]*g[0]+Q[1]*g[1]+g[4])*d,(Q[0]*g[2]+Q[1]*g[3]+g[5])*d]}}else g=n.frameState.coordinateToPixelMatrix,m=function(Q){return[(Q[0]*g[0]+Q[1]*g[1]+g[12])*d,(Q[0]*g[4]+Q[1]*g[5]+g[13])*d]};var E=this.feature_.getGeometry().getCoordinates();this.feature_.getGeometry().getType()==="Polygon"&&(E=[E]);function P(Q){for(var et=0;et<E.length;et++)for(var lt=E[et],pt=0;pt<lt.length;pt++){var T=m([lt[pt][0][0]+Q,lt[pt][0][1]]);h.moveTo(T[0],T[1]);for(var ct=1;ct<lt[pt].length;ct++)T=m([lt[pt][ct][0]+Q,lt[pt][ct][1]]),h.lineTo(T[0],T[1])}}if(h.beginPath(),c&&(h.moveTo(0,0),h.lineTo(u.width,0),h.lineTo(u.width,u.height),h.lineTo(0,u.height),h.lineTo(0,0)),this.get("wrapX")){var L=n.frameState.viewState.projection.getExtent(),F=L[2]-L[0],U=n.frameState.extent,A=this.feature_.getGeometry().getExtent(),G=A[2]-A[1],B=Math.floor((U[0]+G-L[0])/F),O=Math.floor((U[2]-G-L[2])/F)+1;B>O&&([B,O]=[O,B]);for(var K=B;K<=O;K++)P(K*F)}else P(0)},ol.filter.Mask.prototype.postcompose=function(n){if(this.feature_){var c=n.context;c.save(),this.drawFeaturePath_(n,!this.get("inner")),c.fillStyle=this.fillColor_,c.fill("evenodd"),c.restore()}},ol.filter.CSS=function(n){ol.filter.Base.call(this,n),this._layers=[]},ol.ext.inherits(ol.filter.CSS,ol.filter.Base),ol.filter.CSS.prototype.setBlend=function(n){this.set("blend",n),this._layers.forEach(function(c){c.once("postrender",function(h){h.context.canvas.parentNode.style["mix-blend-mode"]=n||""}.bind(this)),c.changed()})},ol.filter.CSS.prototype.setFilter=function(n){this.set("filter",n),this._layers.forEach(function(c){c.once("postrender",function(h){h.context.canvas.parentNode.style.filter=n||""}.bind(this)),c.changed()})},ol.filter.CSS.prototype.setDisplay=function(n){this.set("display",n),this._layers.forEach(function(c){c.once("postrender",function(h){h.context.canvas.parentNode.style.display=n?"":"none"}.bind(this)),c.changed()})},ol.filter.CSS.prototype.addToLayer=function(n){n.once("postrender",function(c){c.context.canvas.parentNode.style["mix-blend-mode"]=this.get("blend")||"",c.context.canvas.parentNode.style.filter=this.get("filter")||"",c.context.canvas.parentNode.style.display=this.get("display")!==!1?"":"none"}.bind(this)),n.changed(),this._layers.push(n)},ol.filter.CSS.prototype.removeFromLayer=function(n){var c=this._layers.indexOf(n);c>=0&&(n.once("postrender",function(h){h.context.canvas.parentNode.style["mix-blend-mode"]="",h.context.canvas.parentNode.style.filter="",h.context.canvas.parentNode.style.display=""}.bind(this)),n.changed(),this._layers.splice(c,1))},ol.filter.CanvasFilter=function(n){ol.filter.Base.call(this,n),this._svg={}},ol.ext.inherits(ol.filter.CanvasFilter,ol.filter.Base),ol.filter.CanvasFilter.prototype.addSVGFilter=function(n){n.getId&&(n="#"+n.getId()),this._svg[n]=1,this.dispatchEvent({type:"propertychange",key:"svg",oldValue:this._svg})},ol.filter.CanvasFilter.prototype.removeSVGFilter=function(n){n.getId&&(n="#"+n.getId()),delete this._svg[n],this.dispatchEvent({type:"propertychange",key:"svg",oldValue:this._svg})},ol.filter.CanvasFilter.prototype.precompose=function(){},ol.filter.CanvasFilter.prototype.postcompose=function(n){var c=[];this.get("url")!==void 0&&c.push("url("+this.get("url")+")");for(var h in this._svg)c.push("url("+h+")");this.get("blur")!==void 0&&c.push("blur("+this.get("blur")+"px)"),this.get("brightness")!==void 0&&c.push("brightness("+this.get("brightness")+"%)"),this.get("contrast")!==void 0&&c.push("contrast("+this.get("contrast")+"%)"),this.get("shadow")!==void 0&&c.push("drop-shadow("+this.get("shadow")[0]+"px "+this.get("shadow")[1]+"px "+(this.get("shadowBlur")||0)+"px "+this.get("shadowColor")+")"),this.get("grayscale")!==void 0&&c.push("grayscale("+this.get("grayscale")+"%)"),this.get("sepia")!==void 0&&c.push("sepia("+this.get("sepia")+"%)"),this.get("hueRotate")!==void 0&&c.push("hue-rotate("+this.get("hueRotate")+"deg)"),this.get("invert")!==void 0&&c.push("invert("+this.get("invert")+"%)"),this.get("saturate")!==void 0&&c.push("saturate("+this.get("saturate")+"%)"),c=c.join(" "),c&&(n.context.save(),n.context.filter=c,n.context.drawImage(n.context.canvas,0,0),n.context.restore())},ol.filter.Clip=function(n){if(n=n||{},ol.filter.Base.call(this,n),this.set("coords",n.coords),this.set("units",n.units),this.set("keepAspectRatio",n.keepAspectRatio),this.set("extent",n.extent||[0,0,1,1]),this.set("color",n.color),!n.extent&&n.units!="%"&&n.coords){for(var c=1/0,h=1/0,u=-1/0,d=-1/0,m=0,g;g=n.coords[m];m++)c>g[0]&&(c=g[0]),u<g[0]&&(u=g[0]),h>g[1]&&(h=g[1]),d<g[1]&&(d=g[1]);n.extent=[c,h,u,d]}},ol.ext.inherits(ol.filter.Clip,ol.filter.Base),ol.filter.Clip.prototype.clipPath_=function(n){var c=n.context,h=n.frameState.size,u=this.get("coords");if(u){var d=this.get("extent"),m=1,g=1;this.get("units")=="%"&&(m=h[0]/(d[2]-d[0]),g=h[1]/(d[3]-d[1])),this.get("keepAspectRatio")&&(m=g=Math.min(m,g));var x=this.get("position"),E=0,P=0;/left/.test(x)?E=-d[0]*m:/center/.test(x)?E=h[0]/2-(d[2]-d[0])*m/2:/right/.test(x)&&(E=h[0]-(d[2]-d[0])*m);var L=function(O){return O*m+E};/top/.test(x)?P=-d[1]*g:/middle/.test(x)?P=h[1]/2-(d[3]-d[1])*g/2:/bottom/.test(x)&&(P=h[1]-(d[3]-d[1])*g);var F=function(O){return O*g+P},U=[L(u[0][0]),F(u[0][1])],A=n.inversePixelTransform;A&&(U=[U[0]*A[0]-U[1]*A[1]+A[4],-U[0]*A[2]+U[1]*A[3]+A[5]]),c.moveTo(U[0],U[1]);for(var G=1,B;B=u[G];G++)U=[L(B[0]),F(B[1])],A&&(U=[U[0]*A[0]-U[1]*A[1]+A[4],-U[0]*A[2]+U[1]*A[3]+A[5]]),c.lineTo(U[0],U[1]);U=[L(u[0][0]),F(u[0][1])],A&&(U=[U[0]*A[0]-U[1]*A[1]+A[4],-U[0]*A[2]+U[1]*A[3]+A[5]]),c.moveTo(U[0],U[1])}},ol.filter.Clip.prototype.precompose=function(n){this.get("color")||(n.context.save(),n.context.beginPath(),this.clipPath_(n),n.context.clip())},ol.filter.Clip.prototype.postcompose=function(n){if(this.get("color")){var c=n.context,h=n.context.canvas;c.save(),c.beginPath(),c.moveTo(0,0),c.lineTo(0,h.height),c.lineTo(h.width,h.height),c.lineTo(h.width,h.height),c.lineTo(h.width,0),c.lineTo(0,0),this.clipPath_(n),c.fillStyle=this.get("color"),c.fill("evenodd")}n.context.restore()},ol.filter.Colorize=function(n){ol.filter.Base.call(this,n),this.setFilter(n)},ol.ext.inherits(ol.filter.Colorize,ol.filter.Base),ol.filter.Colorize.prototype.setFilter=function(n){switch(n=n||{},n){case"grayscale":n={operation:"hue",color:[0,0,0],value:1};break;case"invert":n={operation:"difference",color:[255,255,255],value:1};break;case"sepia":n={operation:"color",color:[153,102,51],value:.6};break;default:break}var c=n.color?ol.color.asArray(n.color):[n.red,n.green,n.blue,n.value];this.set("color",ol.color.asString(c)),this.set("value",n.value||1),this.set("preserveAlpha",n.preserveAlpha);var h;switch(n.operation){case"hue":case"difference":case"color-dodge":case"enhance":{this.set("operation",n.operation);break}case"saturation":{h=255*(n.value||0),this.set("color",ol.color.asString([0,0,h,h||1])),this.set("operation",n.operation);break}case"luminosity":{h=255*(n.value||0),this.set("color",ol.color.asString([h,h,h,255])),this.set("operation","hard-light");break}case"contrast":{h=255*(n.value||0),this.set("color",ol.color.asString([h,h,h,255])),this.set("operation","soft-light");break}default:{this.set("operation","color"),this.setValue(n.value||1);break}}},ol.filter.Colorize.prototype.setValue=function(n){this.set("value",n);var c=ol.color.asArray(this.get("color"));c[3]=n,this.set("color",ol.color.asString(c))},ol.filter.Colorize.prototype.setColor=function(n){n=ol.color.asArray(n),n&&(n[3]=this.get("value"),this.set("color",ol.color.asString(n)))},ol.filter.Colorize.prototype.precompose=function(){},ol.filter.Colorize.prototype.postcompose=function(n){var c,h,u=n.context,d=u.canvas;if(u.save(),this.get("operation")=="enhance"){var m=this.get("value");if(m){var g=d.width,x=d.height;this.get("preserveAlpha")?(c=document.createElement("CANVAS"),c.width=d.width,c.height=d.height,h=c.getContext("2d"),h.drawImage(d,0,0,g,x),h.globalCompositeOperation="color-burn",console.log(m),h.globalAlpha=m,h.drawImage(c,0,0,g,x),h.drawImage(c,0,0,g,x),h.drawImage(c,0,0,g,x),u.globalCompositeOperation="source-in",u.drawImage(c,0,0)):(u.globalCompositeOperation="color-burn",u.globalAlpha=m,u.drawImage(d,0,0,g,x),u.drawImage(d,0,0,g,x),u.drawImage(d,0,0,g,x))}}else this.get("preserveAlpha")?(c=document.createElement("CANVAS"),c.width=d.width,c.height=d.height,h=c.getContext("2d"),h.drawImage(d,0,0),h.globalCompositeOperation=this.get("operation"),h.fillStyle=this.get("color"),h.fillRect(0,0,d.width,d.height),u.globalCompositeOperation="source-in",u.drawImage(c,0,0)):(u.globalCompositeOperation=this.get("operation"),u.fillStyle=this.get("color"),u.fillRect(0,0,d.width,d.height));u.restore()},ol.filter.Composite=function(n){ol.filter.Base.call(this,n),this.set("operation",n.operation||"source-over")},ol.ext.inherits(ol.filter.Composite,ol.filter.Base),ol.filter.Composite.prototype.setOperation=function(n){this.set("operation",n||"source-over")},ol.filter.Composite.prototype.precompose=function(n){var c=n.context;c.save(),c.globalCompositeOperation=this.get("operation")},ol.filter.Composite.prototype.postcompose=function(n){n.context.restore()},ol.filter.Crop=function(n){n=n||{},ol.filter.Mask.call(this,n)},ol.ext.inherits(ol.filter.Crop,ol.filter.Mask),ol.filter.Crop.prototype.precompose=function(n){if(this.feature_){var c=n.context;c.save(),this.drawFeaturePath_(n,this.get("inner")),c.clip("evenodd")}},ol.filter.Crop.prototype.postcompose=function(n){this.feature_&&n.context.restore()},ol.filter.Fold=function(n){n=n||{},ol.filter.Base.call(this,n),this.set("fold",n.fold||[8,4]),this.set("margin",n.margin||8),this.set("padding",n.padding||8),typeof n.fsize=="number"&&(n.fsize=[n.fsize,n.fsize]),this.set("fsize",n.fsize||[8,10]),this.set("fill",n.fill),this.set("shadow",n.shadow!==!1),this.set("opacity",n.hasOwnProperty("opacity")?n.opacity:.2)},ol.ext.inherits(ol.filter.Fold,ol.filter.Base),ol.filter.Fold.prototype.drawLine_=function(n,c,h){var u=n.canvas,d=this.get("fold"),m=u.width,g=u.height,x,E,P;for(n.beginPath(),n.moveTo(h,h),P=1;P<=d[0];P++)x=P*m/d[0]-(P==d[0]?h:0),E=c[1]*(P%2)+h,n.lineTo(x,E);for(P=1;P<=d[1];P++)x=m-c[0]*(P%2)-h,E=P*g/d[1]-(P==d[1]?c[0]*(d[0]%2)+h:0),n.lineTo(x,E);for(P=d[0];P>0;P--)x=P*m/d[0]-(P==d[0]?c[0]*(d[1]%2)+h:0),E=g-c[1]*(P%2)-h,n.lineTo(x,E);for(P=d[1];P>0;P--)x=c[0]*(P%2)+h,E=P*g/d[1]-(P==d[1]?h:0),n.lineTo(x,E);n.closePath()},ol.filter.Fold.prototype.precompose=function(n){var c=n.context;c.save(),c.shadowColor="rgba(0,0,0,0.3)",c.shadowBlur=8,c.shadowOffsetX=2,c.shadowOffsetY=3,this.drawLine_(c,this.get("fsize"),this.get("margin")),c.fillStyle="#fff",this.get("fill")&&c.fill(),c.strokeStyle="rgba(0,0,0,0.1)",c.stroke(),c.restore(),c.save(),this.drawLine_(c,this.get("fsize"),this.get("margin")+this.get("padding")),c.clip()},ol.filter.Fold.prototype.postcompose=function(n){var c=n.context,h=c.canvas;if(c.restore(),c.save(),this.drawLine_(c,this.get("fsize"),this.get("margin")),c.clip(),this.get("shadow")){var u=this.get("fold"),d=h.width/u[0],m=h.height/u[1],g=c.createRadialGradient(5*d/8,5*d/8,d/4,d/2,d/2,d);g.addColorStop(0,"transparent"),g.addColorStop(1,"rgba(0,0,0,"+this.get("opacity")+")"),c.fillStyle=g,c.scale(1,m/d);for(var x=0;x<u[0];x++)for(var E=0;E<u[1];E++)c.save(),c.translate(x*d,E*d),c.fillRect(0,0,d,d),c.restore()}c.restore()},ol.filter.Halftone=function(n){n||(n={}),ol.filter.Base.call(this,n),this.internal_=document.createElement("canvas"),this.setSize(n.size),this.set("channel",n.channel)},ol.ext.inherits(ol.filter.Halftone,ol.filter.Base),ol.filter.Halftone.prototype.setSize=function(n){n=Number(n)||30,this.set("size",n)},ol.filter.Halftone.prototype.postcompose=function(n){var c=n.context,h=c.canvas,u=n.frameState.pixelRatio;n.type==="postrender"&&(u=1),c.save();var d=this.get("size")*u,m=n.frameState.extent,g=n.frameState.viewState.resolution/u,x=[-Math.round(m[0]/g%d),Math.round(m[1]/g%d)],E=this.internal_.getContext("2d"),P=this.internal_.width=h.width,L=this.internal_.height=h.height;E.webkitImageSmoothingEnabled=E.mozImageSmoothingEnabled=E.msImageSmoothingEnabled=E.imageSmoothingEnabled=!1;var F=Math.floor((P-x[0])/d),U=Math.floor((L-x[1])/d);E.drawImage(h,x[0],x[1],F*d,U*d,0,0,F,U);var A=E.getImageData(0,0,F,U).data;c.clearRect(0,0,P,L),c.fillStyle=ol.color.asString(this.get("color")||"#000");for(var G=0;G<F;G++)for(var B=0;B<U;B++){var O;switch(this.get("channel")){case"r":O=A[G*4+B*F*4]/2.55;break;case"g":O=A[G*4+1+B*F*4]/2.55;break;case"b":O=A[G*4+2+B*F*4]/2.55;break;default:O=ol.color.toHSL([A[G*4+B*F*4],A[G*4+1+B*F*4],A[G*4+2+B*F*4]]),O=O[2];break}var K=(100-O)/140;K&&(c.beginPath(),c.arc(x[0]+d/2+G*d,x[1]+d/2+B*d,d*K,0,2*Math.PI),c.closePath(),c.fill())}c.restore()},ol.filter.Lego=function(n){n||(n={}),ol.filter.Base.call(this,n);var c=new Image;c.src=this.img[n.img]||this.img.ol3,c.crossOrigin=n.crossOrigin||null,this.pattern={canvas:document.createElement("canvas")},this.setBrick(n.brickSize,c),this.internal_=document.createElement("canvas")},ol.ext.inherits(ol.filter.Lego,ol.filter.Base),ol.filter.Lego.prototype.img={brick:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAD10AAA9dAah0GUAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAGAElEQVRo3sWZy4tkVx3HP+fcc29Vd1dP17TdTcbJPDKPMGR0kVEZkuBCF0EE9Z8QXLhxMUsRF4oLwYWQTSCgSxUXroQhoiEuskgEUUQh+BhHOpkZO11dr3vvefxc3FPlNHNvPbrD1Dl016XoqvM539/znFbcZo3VjbFmxcMA3Mg2fSoAiQJDov7/B1o9+aEgkycv4PBSPU9eHeDEixNwOAFXPYvFia0+rcnQEeBr218cfLIwCqW1UWillEYphUKpCmCCIQAiCEhAJIggTiSISBAfggTvJZTifQghWO+89cOQexuOXN8Pwz/9ff9X/xF0uEA7AmTsjLp/2xZQCgXHlj0OEBEAeRwGkep3qN6pfibDB3DBixMnvdCXt8J3FZowNYFSjgv71RtPaehjD0alalVOqCtHU3qlAGrVAGbidCtUYLUAiV6dCUx8XV4BhUKjY0AJgUB4LE8sA7CkCRSalFYnE72WiBrLSCKCp6TALZNRDEDCwgAKQ/vyRidN9c32K1sbqlCP/C+P9kXJI597PA7HkGJRCLNUGCY767udF9e+9dz1S5ueoRzIEZa1OxcK9td+/fAHvYH0LY6MkgHFIuYwS0ifXe1+qXvn1vk99QfzCwokToUylPrre1/de/vMnf9+5MsSg2HMELegAsl86duvnP3e8y/f1r83v8Li1RO7k/9c2t/avHnt27xpyhRDguEIuxDA3OXXX93+8a0rz6ZvcKgadqUEL73wx+9sb5//WWKTGCOHsxEWM0H71e2ffmF3lPyEkZppVyVYefCw/9a5f3epSvsWh7MMsUgeaL20/dpLu4fJXZUvFCgi46/8i5RNFCCc4bA5JuZ7f/Kp7g9fuLSdvLnY8lEHxz8ItOPcaN7gPAB1tvPl7udupT9nvGSmLLlHSosWLdbJTgpgLna+eVv9hiO1ZIpFOGBEFmejBnrO/tc/0znXTf+sHMuPwD0MrSnETID6/SXPrH/junp3Xiw3atCjxJCRktKu10DHzrZ+pOvpc5cP/6T8CWtt4BATZ4tkBoCvTz8tbTb8TnHiYi/0pgCmPufMUkB1ss9vtU7Trgt9EgyGhIS0zgjRB6RukaSdfHpLPly2xTg2chQJmgRN2qiAa3DBtu5kYXgqAIFYEzTJDAVCnQIqaA+O0wyFjj8q1oY6AB/qd5nLw9JvcpqOOcFMT5dqlg/UAoy5exS2TgGg6DxhkHofqHVCGYf3ho/S904DcHZ6jpZ6lWMY1iogCDxsn8oDduP3BEI9QvSBWgU8YRDeGezsyEk1SNlD8HF51wjQoEAgHNkffXBw+XfJiZbXXCTBT2fZaAJfn4iEEt+z73bTk92jZTxPwOFxVCeGRif0tt4HCtxB+f0P7l//rTlBAN6gjcNicThcfU2NCnjf0NU43L59vf2XZf1A8wzX8JRTgLw+Ckx17SahIZGOyMri7dHalXf6DJdYfovPAgVlRLAzAXwI0gCQU5La8m6SXeH9pi+pWf5lUooIUFKSN6V0A1AE39RyeAYYEpvYNjf4OwP8XNuf50UycnKKKURjSTMALkjzzgpyEhI0LW7ygHvYRh00G7zARQL5dBYU9JtLWvQB52e0VX0MOl5anmOP+3yIjZldpteZijZXuIbBxZ1PAEbkc05GVspZtnX04hlHEDKucpUePYbklCgyNjjDLp9AERhjKSNAQc6IwSzPMQClt37OIeOQ7vQWxJPSZSf2OZMyK1h8jHsbNSgY0Z/tNRWA2HmuVXLIZsxnliw2mROAyR2Rjwmn8vyC0XynrUwQ3PzGs6QX06rDRgD9GIDEjF9pUFLSXyRsowLFIp2/44icDpZ02umq6S3ZxDwupp3hYs1cVMAu1noLBZaMNbJoAD3tl6prOodnTF5feBoBRmGweO8fyClISMlIowkkApRYyqbeZ5YJQrHc4UNieeGYArL8NeUkFcvgJKc/AU56ajxejod+/DT/W/IkQC4P3GoBwoGsFKAf9v2qAGIxej9MU8rTGdNjWtVsJv315aL3YwDYqG5MTDxAPMvTNkJS3ReY6AmtlTrhKsf/AHgAA6ezGE+FAAAAAElFTkSuQmCC",ol3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAD10AAA9dAah0GUAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAHtUlEQVRo3sWZTWxcVxXHf/d9zIztcTz+pE6cOHXiyLJJadKgKE2oCBLlQwIWSCxYI0WiGxZZIYRAArFAYoEEi0hIsGBBURd0g4iK2lJAaWlaojZVKkU0H26cxB8Zz/f7uPeweHdebDLPnqlQ5l2N5/mN7tz/+Z//OffcM4rPUKCPl0eBAqqfAEAt5Ia1LwCuAg93CyCnAzgj7TstEKMluW+/x0AsWmKBmFggTu4lIpYome2Qw0kA8I2xL9T2Bp5COY6ncJRSDkopFEolANowBEAEATGIGBEkFjEiYkQbI0ZrMaFobYwxkY51pOumpSNTiau6bm7oZX1NP4Ai+ylYADkmGqUPxwSUQsG2ZbcDsBAA2QoGkeSvSZ4kr/alDcRGSyyxbJqqvG5+pHAwbRegVMz+leTBY7qcbTee8vsmQycRmnL6CkD1G4DXFl0fGegvANfpnws8+947AwqFg2MDSjAYzJY80QuAHl2gcPDJF3PiDLiimtIQC0ETEhD3klE8AJeuASg8CgeHir7vLBVOjwypQK3plyoromRNtzSamJg6QbcgvJ7C0J0YnCweG/jek/Ozw5q6bEiFiIHz+wNWBv68+rPNmlQjYnKE1Ai6cYfXA/W5Q6Uvl84f3zel3vH+SIDYoVAeofOdqa9PvbHn/PoDHYZ4eDSpE3fJgLs79YXToz858uxJ5+/en4jQ6hHr5OPZlZHhpcM/4BUv9PFw8agQdQVg1+UHnx/75fG5Gf83lFWGVUrQsmmu/HBsbN8f3Mi1MVLeGUJ3Lig8P/a7s5MN97c01I5+VUIk91err0/fLqFwgBHKOzmimzyQPzX2q1OTZfeianUVKCLNr93EZxiFIOyhnB0Tu6vf/XTp54uzY+4r3S1veYj5CEPBjqFsA3cDoEaLXy199rj/Is0eM2XILXzy5MkzSO6TAvAOFF84qf5KRfWYYhE2aJCzI5MDbxf7B58pTpf89x8qX1yWGKXKFaUBZIF1tWo/KzJPiYi3VAgYbrFEnpiYiBzBTgx0ts99YvDcvHr7YSBJka/Q4k1u3jz5eQ/EYebkXvL241NUeZN/31gkDwibhHjk8PGzTh+OrWw7X/6g/+TB8nuJrQCc4Z/KU08rb+1f/1gCSqy9NUNoP72txtXRb40dfJ+nkgMEZTw78riZLhDRndNP3vGG9GBKnRzhrppmilfhmcWoRYkxyuxv86euUaT24h4W2WN53WQmheB1ygc7MaCKuc+N5LeW6wfOXeUorwFQZIV5RlnbNqcGjBMyaAFUcfHwcHHxOznBakA6JQq34B4dkXtt+8QjvnCQa/Z/jxpFCmdbpPSJI7NyhMVzK/j2UQuFi4OLkz57FECcIcGCU8yZeirQvdxjjuvpTKGAem2EcjpjkjnUC5cvfIm/bRG3Y4e7AwOmEwPKOJotfhvlPj61dGaBEChtAdD88Yeq9et1LqWOUTj2lYzOItSmcxi2ZDXUw+k0n0bqDoXDJBsMM8rHKeIKFbxgIV9nL3cSFlPpZQBoa6AjgCYXK2YkndbckkxmWWfu2D00ozzYNinOlagwbRct/k92zNJARxFK01yur/mX2wDWGE0jfuHyNfa+Y6hQYNsmJQ45hqwwFaPpOVo6s2zDsCMDgsBq2sBR9xj8ZvX70+LJc9w+scA1Sjz49rjMy7zMywE5IY64PMcNDlkHKCbt9xhMZwhOooGODGhMzVyqTUxIm4Pll9797ixnWFZ3WORdSqz//hI+Pv7LT5dXOcNZltUa49y3qplC0Hb5uBMAbwcGDKYS/eLu6YMfrSZCUhWY+QCfGZ7iZYRbarSdYMfd0bvXazh8ii/yF2vcAVwitB1hZirWnROREFLYjN4uLQ5QTZ/WmeA2VwDUHbBks351HRxK3OaqtTTHEQwxmpjkxJApQh111kBAvBH+9O7y/KveFsfcYyNj82qywqZdxmWBAjEREbHdkrNEqNE6o6qJiVeiC4UPHuqg20PvExxGE6YAWp2jwEvabmIyqpoGuTB4ozEwd6lKvYflRzgBBIQWQrQjAG2MZABoEeJH4UU3N8f1rC/psPyz+AQWQEhIK6s09wACk+EC0NTwcCM3KrDAf6ihd6ui2ccxcrRoEaQg6lnQPYDYSLZlAS1cXBzyLHGfW0SZPDgMscgBDK10BARUs48mVgNxtl2GKh6ObVpOM8Uy94hsZpe0nakoMMdhPGJreRtAg9YuJ6NIwp18G7OJsilVyHGIQ2yySZ0WIYocQ+xhknEUhiYRoQUQ0KJBbSfleAChjvQuh4wypbQLovEpMWHrnPY2K0RoG/eR5SCgQXVn1SQAJNpNWiFlhm0+i8jZIrMNoN0j0jbhJMoPaOwu2sQFJt69oRKyadNqTGQBOFsAiM34CQchIdVuwtYyEOgu4jumQosiEX5a6aq0S9Z2T2zTThfdkS0MRN21lISAiBwD5KwDnLReStp0MZomrc4bTyaAhql131gztAhw8cnhWxeIBRASEWbVPju5wAS9/VYgdnthGwPSe5uynYqlpun9EuCTzHt0O67r5uP8teRRAC25H/cXgNmQvgKomhXdLwB2M7pu0pTyeK70mJYUm251sLfo/T8AGEoKes8eIGZ43E5wk36BBwhO2mbqgwZa9C0CAP4LFLGzNDDzmrAAAAAASUVORK5CYII=",lego:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAA/CAQAAAD9VthUAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAADzoAAA86AZc528IAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAHvElEQVRYw8WZWWxcVxnHf+fec2fGu+M4qbPH2EmTLk4FApqQNrgiVYyKeClIwBsvPCAQkZAQPND2gRekCoGQEItYHhBLurCksoTKA6QNJW0CBZLWCc3qEBvHy3hsz93O+XiYMxM7nhmPGxGf++Dre2fO7/v+5/u+s4zigzSxVq3osaZNAwzkuq1nPeUrAE9p99JTAKWn5WYEwErpv9TdGbECRlKMgBEjRlIgsqlAKBBaSKUokAjgkcFz+Ce6BvM9sVbKU55WKKWUh1IeoJQCFhsgIIIgIohYEWwq1ooVK9ZasdbG1hhrjUmMsYlZsJEJzYIpmLwZs/8xZ9JpaGYHOYfPyvrChrdbpAxbjFRltCqhnQ2yxBTKf0WQUgNrwYqIFStGUkkllqIU5E/2aQBbEV8pz/ZM3Or8/95UmeUB+J63RiHoAWi1ZHTvNl6pNfXe99Taeq/W1HvuYOzvKG5c4q1afIWHj4eHBwgWwWCQ1aWvBvC8VXngE5DbmO3UxrOeqEhmTFEcPiIiadwEfVttWxmd623tyu7Mfnrjru5cM0Th+Nyp2Z/MztvJNDLkSImZJ27MhNWIr8j1tn+g9at7+/ubivaSHYkmjPF1f+sj7Uc3Xc29VPjm1JSJEzJkCZkjaVT8hvzubDvQ8cz9AwPeG/rHFD3BZkoeTqLwCuqzrQf7nw9+UJhOidEEFAhX0sCJr1fyXm/uPLr5849n/u1/j3mMWtqtYEFm5v/2pXUHdhzNjgaxzunQQzNX3wDdWIT0dT3bP3Qo8wIXSVWNDpWQys2xmW/3fbn1WpAWXUrWNaARvN+/7lu7jzysf8q4siuEh5A8fX5/+8XepLyEs8zfCd7raP/K9scf1T9iQjUUzU+JynOR3TQBgpAS1a16dVtusONTH8kc42ZjcFFKEApcJyBHjizt+O8Wr3e2P7Uv+3curyT7InhJ8nFCMmTJkqWlVlnzVsj0psc69vbrV1SyKnjJgCsEZMiQoanWINcfe39v6xfv808Suu6f5EVlQA7QAcC/1DXp42GmuazOiaJbjjDFSTUNCLOEZMiQEJAjrZYB9b0PmoPe7fpNZQAkYFb1A9CphtWwGlbNkmX/R59TpzhPAAwdf37XKWac1JZJAnc1VSfp0ufSqtK3NT/Y3DJVKZ5tYbHiwfvJAjc5dO7Pw4cZOb4vc51ccvZjh7ZfubaTC8y4evgeAjQaTYCpgZfq06TXpD++Rd6hHHTdZ8JKDs8yAsAD92/gjxSfGNvYzp7Wt3nj6sS2D5NxtXAeHNwnIFpOqSe+bg+2d6ejFXzXS8WlJUSyhBiKoAqj1yFuYQLQZCvFOMLDx8evPFuOF7HV0sqzXmsuP1mJ5tbfVirYc++VITnItvyN8rhJjqIrL7qS50KCX1mWeLXFr5Z02nqiJ2+lXOasIQHJkD75C6DjtQ8dH6Eg99FHyD+LBRclaomnqgL3lo++w4utWsBVbNYtr1htYZFBZgm2299Z5rmXl4+ZtwaPjDlt9CJ0gIeqXNXFN7WKDtMLnW1y+9e6Txc5z2le25Te0BTVic89ovf3yIXE1QeP4FbJbmCla21V723evjklncued/0mZA6AcEABfH/6rXzb2IM5fJD1zLvIB02zm3ak+iK0hK8mvmBnzA/Hoy3LJoyW4XIITn5daAbaX0w3XBnIIsCBL7zDpFNvPWoRvBY+larBZ5Gb6eX20xXxf/2QDMkgmc+sl8MyJH2cf/Seka3yGFv+kR7Ok/1riwxhvruJUYffhGCxWKS0IqqReFXFN5g583qaNokC0aSf/JUaVn95ufNrJ9SwGlapMkkUXuPMAy/E24CJbQVeVWeIXDAFbEYwWCymes3XAMZW9d5gC8k3Rn++79hJjErvvcBB0P53/sBBAOa5knmdnWwlywlQZ7mHfQivOsd6yVDEkGIwxDVrfo2yY4nJ5tMTLe9rkYKSkUtcEqXk9/DKok9d5nLlfpzxyn0Tu7Gk7jLVNx8eQFw98oUi6Vz07NiZ3c/4y+bz+i1gHxliEhJnQFKn6MbVu01ISRaSX2b8vk/4q4D77GErCTGxM2EBW1P8pLr4YJkjiKORhZ91hR1qpsG9m89O9pASOXxMXF6wrCb0ACIidBJe8ZNdjHID24DsA/RhCImInAnztQqr897UeI1lDp3ToU8TO2jiat39q0cLD7GJlNBdERFhLd8dPjamtldx98K8dhNGD91cZ6zKPl6hyNJPP5rYIcsGFGprVva+Nl4GF455lVzI0UcvU0ySX7R5aKabHnrwMRSJlhiQr7fT1QCprYPnmKHgzjQtliwZNrIZHyHBkHHLSMG4KI+JK6Lna+9wFuETUzecLAUHN6QkBARofHwCFImr6Mbld+Lw0Upwhy/acKWUMswS07YI77tllHJTqsW4t4lLtcLKBwyl0JN05YQSiqS0knW+a7eGu4W3rrgmJMwRNpCkLvRsaBoqKAkzZGgi66S/HV+Sf4GQxvor4xPbYDkVIuLS2RZ6CV4wRMQkNNpXGb9go1V8BSElJXRrWIXCupM9We2hvMPPG1bbaqxf3sWhamTzhjVpHsCc/a9dQ3xo82uJL9jRNRLfTTnnBO+u/pTkLT5c8fPNd9nt5tLmRbsVynbsXR704Bbeq775v0uht3btfyZT7OA5knjdAAAAAElFTkSuQmCC"},ol.filter.Lego.prototype.set=function(n,c){ol.filter.Base.prototype.set.call(this,n,c),n=="brickSize"&&this.pattern&&this.pattern.canvas.width!=c&&this.setBrick(c)},ol.filter.Lego.prototype.setBrick=function(n,c,h){if(n=Number(n)||30,typeof c=="string"){var u=new Image;u.src=this.img[c]||this.img.ol3,u.crossOrigin=h||null,c=u}if(c&&(this.pattern.img=c),!this.pattern.img.width){var d=this;this.pattern.img.onload=function(){d.setBrick(n,c)};return}this.pattern.canvas.width=this.pattern.canvas.height=n,this.pattern.ctx=this.pattern.canvas.getContext("2d"),this.pattern.ctx.fillStyle=this.pattern.ctx.createPattern(this.pattern.img,"repeat"),this.set("brickSize",n),c&&this.set("img",c.src)},ol.filter.Lego.prototype.getPattern=function(n,c){if(!this.pattern.ctx)return"transparent";var h=this.pattern.canvas,u=this.pattern.ctx,d=h.width/this.pattern.img.width;return u.save(),u.clearRect(0,0,h.width,h.height),u.scale(d,d),n/=d,c/=d,u.translate(n,c),u.beginPath(),u.clearRect(-2*h.width,-2*h.height,4*h.width,4*h.height),u.rect(-n,-c,2*h.width/d,2*h.height/d),u.fill(),u.restore(),u.createPattern(h,"repeat")},ol.filter.Lego.prototype.postcompose=function(n){var c=n.context,h=c.canvas,u=n.frameState.pixelRatio;n.type==="postrender"&&(u=1),c.save();var d=this.pattern.canvas.width*u,m=n.frameState.extent,g=n.frameState.viewState.resolution/u,x=[-Math.round(m[0]/g%d),Math.round(m[1]/g%d)],E=this.internal_.getContext("2d"),P=this.internal_.width=h.width,L=this.internal_.height=h.height;E.webkitImageSmoothingEnabled=E.mozImageSmoothingEnabled=E.msImageSmoothingEnabled=E.imageSmoothingEnabled=!1;var F=Math.floor((P-x[0])/d),U=Math.floor((L-x[1])/d);E.drawImage(h,x[0],x[1],F*d,U*d,0,0,F,U),c.webkitImageSmoothingEnabled=c.mozImageSmoothingEnabled=c.msImageSmoothingEnabled=c.imageSmoothingEnabled=!1,c.clearRect(0,0,P,L),c.drawImage(this.internal_,0,0,F,U,x[0],x[1],F*d,U*d),c.scale(u,u),c.fillStyle=this.getPattern(x[0]/u,x[1]/u),c.rect(0,0,P,L),c.fill(),c.restore()},ol.filter.Paper=function(n){n=n||{},ol.filter.Base.call(this,n),this._svgfilter=new ol.ext.SVGFilter.Paper(n)},ol.ext.inherits(ol.filter.Paper,ol.filter.Base),ol.filter.Paper.prototype.precompose=function(){},ol.filter.Paper.prototype.postcompose=function(n){var c=n.context,h=c.canvas;c.save(),c.filter="url(#"+this._svgfilter.getId()+")",c.globalAlpha=1,c.globalCompositeOperation="multiply",c.fillRect(0,0,h.width,h.height),c.restore()},ol.filter.Paper.prototype.setLight=function(n){this._svgfilter.setLight(n)},ol.filter.PencilSketch=function(n){n=n||{},ol.filter.Base.call(this,n),this.set("blur",n.blur||8),this.set("intensity",n.intensity||.8)},ol.ext.inherits(ol.filter.PencilSketch,ol.filter.Base),ol.filter.PencilSketch.prototype.precompose=function(){},ol.filter.PencilSketch.prototype.postcompose=function(n){var c=n.context,h=c.canvas,u=h.width,d=h.height,m=document.createElement("canvas");m.width=u,m.height=d;var g=m.getContext("2d");g.filter="grayscale(1) invert(1) blur("+this.get("blur")+"px)",g.drawImage(h,0,0),c.save(),this.get("color")?(c.globalCompositeOperation="darken",c.globalAlpha=.3,c.drawImage(h,0,0)):(c.filter="grayscale(1)",c.drawImage(h,0,0)),c.globalCompositeOperation="color-dodge",c.globalAlpha=this.get("intensity"),c.drawImage(m,0,0),c.restore()},ol.filter.Pointillism=function(n){n=n||{},ol.filter.Base.call(this,n),this.set("saturate",Number(n.saturate)||2),this.pixels=[]},ol.ext.inherits(ol.filter.Pointillism,ol.filter.Base),ol.filter.Pointillism.prototype._getPixels=function(n){if(n>this.pixels.length)for(;this.pixels.length<n;)this.pixels.push([Math.random(),Math.random(),Math.random()*4+2]);return n},ol.filter.Pointillism.prototype.precompose=function(){},ol.filter.Pointillism.prototype.postcompose=function(n){var c=n.context,h=c.canvas,u=h.width,d=h.height,m=document.createElement("canvas");m.width=u,m.height=d;var g=m.getContext("2d");g.filter="saturate("+Math.round(2*this.get("saturate")*100)+"%)",g.drawImage(h,0,0),c.save(),c.filter="blur(3px) saturate("+this.get("saturate")*100+"%)",c.drawImage(h,0,0),c.filter="none",c.opacity=.5;for(var x=this._getPixels(u*d/50),E=0;E<x;E++){var P=Math.floor(this.pixels[E][0]*u),L=Math.floor(this.pixels[E][1]*d);c.fillStyle=ol.color.asString(g.getImageData(P,L,1,1).data),c.beginPath(),c.arc(P,L,this.pixels[E][2],0,2*Math.PI),c.fill()}c.restore()},ol.filter.SVGFilter=function(n){ol.filter.Base.call(this),this._svg={},n&&(n instanceof Array||(n=[n]),n.forEach(function(c){this.addSVGFilter(c)}.bind(this)))},ol.ext.inherits(ol.filter.SVGFilter,ol.filter.Base),ol.filter.SVGFilter.prototype.addSVGFilter=function(n){var c="#"+n.getId();this._svg[c]=1,this.dispatchEvent({type:"propertychange",key:"svg",oldValue:this._svg})},ol.filter.SVGFilter.prototype.removeSVGFilter=function(n){var c="#"+n.getId();delete this._svg[c],this.dispatchEvent({type:"propertychange",key:"svg",oldValue:this._svg})},ol.filter.SVGFilter.prototype.precompose=function(){},ol.filter.SVGFilter.prototype.postcompose=function(n){var c=[];for(var h in this._svg)c.push("url("+h+")");c=c.join(" ");var u=document.createElement("canvas");u.width=n.context.canvas.width,u.height=n.context.canvas.height,u.getContext("2d").drawImage(n.context.canvas,0,0),c&&(n.context.save(),n.context.clearRect(0,0,u.width,u.height),n.context.filter=c,n.context.drawImage(u,0,0),n.context.restore())},ol.filter.Texture=function(n){ol.filter.Base.call(this,n),this.setFilter(n)},ol.ext.inherits(ol.filter.Texture,ol.filter.Base),ol.filter.Texture.prototype.setFilter=function(n){var c;n=n||{},n.img?c=n.img:(c=new Image,n.src&&(ol.filter.Texture.Image&&ol.filter.Texture.Image[n.src]?c.src=ol.filter.Texture.Image[n.src]:c.src||(c.src=n.src)),c.crossOrigin=n.crossOrigin||null),this.set("rotateWithView",n.rotateWithView!==!1),this.set("opacity",typeof n.opacity=="number"?n.opacity:1),this.set("ready",!1);var h=this;function u(d){h.pattern={},h.pattern.scale=n.scale||1,h.pattern.canvas=document.createElement("canvas"),h.pattern.canvas.width=d.width*h.pattern.scale,h.pattern.canvas.height=d.height*h.pattern.scale,h.pattern.canvas.width=d.width,h.pattern.canvas.height=d.height,h.pattern.ctx=h.pattern.canvas.getContext("2d"),h.pattern.ctx.fillStyle=h.pattern.ctx.createPattern(d,"repeat"),h.set("ready",!0)}c.width?u(c):c.onload=function(){u(c)}},ol.filter.Texture.prototype.getPattern=function(n,c){var h=this.pattern.canvas,u=this.pattern.ctx;return u.save(),u.translate(-n,c),u.beginPath(),u.rect(n,-c,h.width,h.height),u.fill(),u.restore(),u.createPattern(h,"repeat")},ol.filter.Texture.prototype.postcompose=function(n){if(this.pattern){var c=n.context,h=c.canvas,u=1.5*Math.max(h.width,h.height),d=n.frameState.pixelToCoordinateTransform;d||(d=n.frameState.pixelToCoordinateMatrix,d[2]=d[4],d[3]=d[5],d[4]=d[12],d[5]=d[13]);var m=n.frameState.pixelRatio,g=n.frameState.viewState.resolution,x=h.width/2,E=h.height/2;if(c.save(),c.globalCompositeOperation="multiply",c.globalAlpha=this.get("opacity"),c.scale(m*this.pattern.scale,m*this.pattern.scale),this.get("rotateWithView"))g*=this.pattern.scale,c.fillStyle=this.getPattern((x*d[0]+E*d[1]+d[4])/g,(x*d[2]+E*d[3]+d[5])/g),c.translate(x/this.pattern.scale,E/this.pattern.scale),c.rotate(n.frameState.viewState.rotation),c.beginPath(),c.rect(-x-u,-E-u,2*u,2*u),c.fill();else{var P=-(x*d[0]+E*d[1]+d[4])/g,L=(x*d[2]+E*d[3]+d[5])/g,F=Math.cos(n.frameState.viewState.rotation),U=Math.sin(n.frameState.viewState.rotation),A=(P*F-L*U)/this.pattern.scale,G=(P*U+L*F)/this.pattern.scale;c.translate(A,G),c.beginPath(),c.fillStyle=this.pattern.ctx.fillStyle,c.rect(-A-u,-G-u,2*u,2*u),c.fill()}c.restore()}},ol.format.GeoJSONX=function(n){n=n||{},ol.format.GeoJSON.call(this,n),this._hash={},this._count=0,this._extended=n.extended,typeof n.whiteList=="function"?this._whiteList=n.whiteList:n.whiteList&&n.whiteList.indexOf?this._whiteList=function(h){return n.whiteList.indexOf(h)>-1}:this._whiteList=function(){return!0},typeof n.blackList=="function"?this._blackList=n.blackList:n.blackList&&n.blackList.indexOf?this._blackList=function(h){return n.blackList.indexOf(h)>-1}:this._blackList=function(){return!1},this._deleteNull=n.deleteNullProperties===!1?!1:[null,void 0,""];var c=2;(!n.dataProjection||n.dataProjection==="EPSG:4326")&&(c=7),isNaN(parseInt(n.decimals))||(c=parseInt(n.decimals)),this._decimals=c,this.setLayout(n.layout||"XY")},ol.ext.inherits(ol.format.GeoJSONX,ol.format.GeoJSON),ol.format.GeoJSONX.prototype._radix="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ !#$%&'()*-.:<=>?@[]^_`{|}~",ol.format.GeoJSONX.prototype._size=ol.format.GeoJSONX.prototype._radix.length,ol.format.GeoJSONX.prototype._type={Point:0,LineString:1,Polygon:2,MultiPoint:3,MultiLineString:4,MultiPolygon:5,GeometryCollection:null},ol.format.GeoJSONX.prototype._toType=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"],ol.format.GeoJSONX.prototype.setLayout=function(n){switch(n){case"XYZ":case"XYZM":{this._layout=n;break}default:{this._layout="XY";break}}},ol.format.GeoJSONX.prototype.getLayout=function(){return this._layout},ol.format.GeoJSONX.prototype.encodeNumber=function(n,c){(isNaN(Number(n))||n===null||!isFinite(n))&&(n=0),!c&&c!==0&&(c=this._decimals),n=Math.round(n*Math.pow(10,c)),n<0?n=-2*n-1:n=2*n;for(var h="",u,d=n;u=d%this._size,h=this._radix.charAt(u)+h,d=Math.floor(d/this._size),d!=0;);return h},ol.format.GeoJSONX.prototype.decodeNumber=function(n,c){!c&&c!==0&&(c=this._decimals);var h=0;n.split("").forEach(function(d){h=h*this._size+this._radix.indexOf(d)}.bind(this));var u=Math.floor(h/2);return u!==h/2&&(u=-1-u),u/Math.pow(10,c)},ol.format.GeoJSONX.prototype.encodeCoordinates=function(n,c){var h,u,d;if(typeof n[0]=="number")return u=this.encodeNumber(n[0],c)+","+this.encodeNumber(n[1],c),this._layout[2]=="Z"&&n.length>2&&(u+=","+this.encodeNumber(n[h][2],2)),this._layout[3]=="M"&&n.length>3&&(u+=","+this.encodeNumber(n[h][3],0)),u;if(n.length&&n[0])if(typeof n[0][0]=="number"){var m=[0,0,0,0],g=[],x=this._layout[2]=="Z"&&n[0].length>2,E=this._layout[3]=="M"&&n[0].length>3;for(h=0;h<n.length;h++){d=[Math.round(n[h][0]*Math.pow(10,c)),Math.round(n[h][1]*Math.pow(10,c))],x&&(d[2]=n[h][2]),E&&(d[3]=n[h][3]),n[h]=d;var P=n[h][0]-m[0],L=n[h][1]-m[1];(h==0||P!==0||L!==0)&&(u=this.encodeNumber(P,0)+","+this.encodeNumber(L,0)+(x?","+this.encodeNumber(n[h][2]-m[2],2):"")+(E?","+this.encodeNumber(n[h][3]-m[3],0):""),g.push(u),m=n[h])}return g.join(";")}else{for(h=0;h<n.length;h++)n[h]=this.encodeCoordinates(n[h],c);return n}else return this.encodeCoordinates([0,0],c)},ol.format.GeoJSONX.prototype.decodeCoordinates=function(n,c){var h,u;if(typeof n=="string")if(n=n.split(";"),n.length>1){var d=Math.pow(10,c),m=[0,0,0,0];return n.forEach(function(x,E){n[E]=x.split(","),n[E][0]=Math.round((this.decodeNumber(n[E][0],c)+m[0])*d)/d,n[E][1]=Math.round((this.decodeNumber(n[E][1],c)+m[1])*d)/d,n[E].length>2&&(n[E][2]=Math.round((this.decodeNumber(n[E][2],2)+m[2])*d)/d),n[E].length>3&&(n[E][3]=Math.round((this.decodeNumber(n[E][3],0)+m[3])*d)/d),m=n[E]}.bind(this)),n}else return n=n[0].split(","),u=[this.decodeNumber(n[0],c),this.decodeNumber(n[1],c)],n.length>2&&(u[2]=this.decodeNumber(n[2],2)),n.length>3&&(u[3]=this.decodeNumber(n[3],0)),u;else if(n.length){var g=[];for(h=0;h<n.length;h++)g[h]=this.decodeCoordinates(n[h],c);return g}else return[0,0]},ol.format.GeoJSONX.prototype.writeFeaturesObject=function(n,c){c=c||{},this._count=0,this._hash={};var h=ol.format.GeoJSON.prototype.writeFeaturesObject.call(this,n,c);h.decimals=this._decimals,h.hashProperties=[],Object.keys(this._hash).forEach(function(d){h.hashProperties.push(d)}.bind(this)),this._count=0,this._hash={};var u=h.features;return delete h.features,h.features=u,h},ol.format.GeoJSONX.prototype.writeFeatureObject=function(n,c){var h=ol.format.GeoJSON.prototype.writeFeatureObject.call(this,n,c);if(h.type!=="Feature")throw"GeoJSONX doesn't support "+h.type+".";var u=[];if(h.geometry.type==="Point")u.push(this.encodeCoordinates(h.geometry.coordinates,this._decimals));else if(h.geometry.type==="MultiPoint"){var d=[];h.geometry.coordinates.forEach(function(E){d.push(this.encodeCoordinates(E,this._decimals))}.bind(this)),u.push([this._type[h.geometry.type],d.join(";")])}else{if(!this._type[h.geometry.type])throw"GeoJSONX doesn't support "+h.geometry.type+".";u.push([this._type[h.geometry.type],this.encodeCoordinates(h.geometry.coordinates,this._decimals)])}var m,g=[];for(m in h.properties)!this._whiteList(m)||this._blackList(m)||(this._hash.hasOwnProperty(m)||(this._hash[m]=this._count,this._count++),(!this._deleteNull||this._deleteNull.indexOf(h.properties[m])<0)&&g.push(this._hash[m],h.properties[m]));if((g.length||this._extended)&&u.push(g),this._extended){var x=!1;g={};for(m in h)/^type$|^geometry$|^properties$/.test(m)||(g[m]=h[m],x=!0);x&&u.push(g)}return u},ol.format.GeoJSONX.prototype.writeGeometryObject=function(n,c){var h=ol.format.GeoJSON.prototype.writeGeometryObject.call(this,n,c);return h.type==="Point"?this.encodeCoordinates(h.coordinates,this._decimals):[this._type[h.type],this.encodeCoordinates(h.coordinates,this._decimals)]},ol.format.GeoJSONX.prototype.readFeaturesFromObject=function(n,c){if(this._hashProperties=n.hashProperties||[],c=c||{},c.decimals=parseInt(n.decimals),!c.decimals&&c.decimals!==0)throw"Bad file format...";var h=ol.format.GeoJSON.prototype.readFeaturesFromObject.call(this,n,c);return h},ol.format.GeoJSONX.prototype.readFeatureFromObject=function(n,c){var h={type:"Feature"};if(typeof n[0]=="string")h.geometry={type:"Point",coordinates:this.decodeCoordinates(n[0],typeof c.decimals=="number"?c.decimals:this.decimals)};else if(h.geometry={type:this._toType[n[0][0]]},h.geometry.type==="MultiPoint"){var u=h.geometry.coordinates=[],d=n[0][1].split(";");d.forEach(function(P){P=P.split(","),u.push([this.decodeNumber(P[0],c.decimals),this.decodeNumber(P[1],c.decimals)])}.bind(this))}else h.geometry.coordinates=this.decodeCoordinates(n[0][1],typeof c.decimals=="number"?c.decimals:this.decimals);if(this._hashProperties&&n[1]){h.properties={};for(var m=n[1],g=0;g<m.length;g+=2)h.properties[this._hashProperties[m[g]]]=m[g+1]}else h.properties=n[1];if(n[2])for(var x in n[2])h[x]=n[2][x];var E=ol.format.GeoJSON.prototype.readFeatureFromObject.call(this,h,c);return E},ol.format.GeoJSONP=function(n){n=n||{},ol.format.GeoJSONX.call(this,n),this._lineFormat=new ol.format.Polyline({factor:Math.pow(10,n.decimals||6)})},ol.ext.inherits(ol.format.GeoJSONP,ol.format.GeoJSONX),ol.format.GeoJSONP.prototype.encodeCoordinates=function(n){var c;if(typeof n[0]=="number")return c=new ol.geom.Point(n),this._lineFormat.writeGeometry(c);if(n.length&&n[0]){var h=typeof n[0][0]=="number";if(h)return c=new ol.geom.LineString(n),this._lineFormat.writeGeometry(c);for(var u=[],d=0;d<n.length;d++)u[d]=this.encodeCoordinates(n[d]);return u}else return this.encodeCoordinates([0,0])},ol.format.GeoJSONP.prototype.decodeCoordinates=function(n){var c,h;if(typeof n=="string")return h=this._lineFormat.readGeometry(n),h.getCoordinates()[0];if(n.length){var u=typeof n[0]=="string",d=[];if(u)for(c=0;c<n.length;c++)h=this._lineFormat.readGeometry(n[c]),d[c]=h.getCoordinates();else for(c=0;c<n.length;c++)d[c]=this.decodeCoordinates(n[c]);return d}else return null},ol.format.GeoRSS=function(n){n=n||{},ol.Object.call(this,n)},ol.ext.inherits(ol.format.GeoRSS,ol.Object),ol.format.GeoRSS.prototype.readFeature=function(n,c){c=c||{};for(var h,u=n.children,d=new ol.Feature,m=0;h=u[m];m++)d.set(h.tagName,h.innerHTML);var g,x,E=[];if(d.get("geo:long"))x=new ol.geom.Point([parseFloat(d.get("geo:long")),parseFloat(d.get("geo:lat"))]),d.unset("geo:long"),d.unset("geo:lat");else if(d.get("georss:point"))E=d.get("georss:point").trim().split(" "),x=new ol.geom.Point([parseFloat(E[1]),parseFloat(E[0])]),d.unset("georss:point");else if(d.get("georss:polygon")){g=d.get("georss:polygon").trim().split(" ");for(var P=0;P<g.length;P+=2)E.push([parseFloat(g[P+1]),parseFloat(g[P])]);x=new ol.geom.Polygon([E]),d.unset("georss:polygon")}else return d.get("georss:where")?(console.warn("[GeoRSS] GML format not implemented"),d.unset("georss:where"),null):(console.warn("[GeoRSS] unknown geometry"),null);return(c.featureProjection||this.get("featureProjection"))&&x.transform(c.dataProjection||this.get("dataProjection")||"EPSG:4326",c.featureProjection||this.get("featureProjection")),d.setGeometry(x),d},ol.format.GeoRSS.prototype.readFeatures=function(n,c){var h;if(typeof n=="string"){var u=new DOMParser,d=u.parseFromString(n,"text/xml");h=d.getElementsByTagName(this.getDocumentItemsTagName(d))}else if(n instanceof Document)h=n.getElementsByTagName(this.getDocumentItemsTagName(n));else if(n instanceof Node)h=n;else return[];for(var m=[],g=0,x;x=h[g];g++){var E=this.readFeature(x,c);E&&m.push(E)}return m},ol.format.GeoRSS.prototype.getDocumentItemsTagName=function(n){switch(n.documentElement.tagName){case"feed":return"entry";default:return"item"}},ol.interaction.Clip=function(n){this.layers_=[],ol.interaction.Pointer.call(this,{handleDownEvent:this._setPosition,handleMoveEvent:this._setPosition}),this.precomposeBind_=this.precompose_.bind(this),this.postcomposeBind_=this.postcompose_.bind(this),n=n||{},this.pos=!1,this.radius=n.radius||100,n.layers&&this.addLayer(n.layers)},ol.ext.inherits(ol.interaction.Clip,ol.interaction.Pointer),ol.interaction.Clip.prototype.setMap=function(n){var c;if(this.getMap()){for(c=0;c<this.layers_.length;c++)this.layers_[c].un(["precompose","prerender"],this.precomposeBind_),this.layers_[c].un(["postcompose","postrender"],this.postcomposeBind_);try{this.getMap().renderSync()}catch{}}if(ol.interaction.Pointer.prototype.setMap.call(this,n),n){for(c=0;c<this.layers_.length;c++)this.layers_[c].on(["precompose","prerender"],this.precomposeBind_),this.layers_[c].on(["postcompose","postrender"],this.postcomposeBind_);try{n.renderSync()}catch{}}},ol.interaction.Clip.prototype.setRadius=function(n){if(this.radius=n,this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Clip.prototype.getRadius=function(){return this.radius},ol.interaction.Clip.prototype.addLayer=function(n){n instanceof Array||(n=[n]);for(var c=0;c<n.length;c++){if(this.getMap()){n[c].on(["precompose","prerender"],this.precomposeBind_),n[c].on(["postcompose","postrender"],this.postcomposeBind_);try{this.getMap().renderSync()}catch{}}this.layers_.push(n[c])}},ol.interaction.Clip.prototype.removeLayers=function(){this.removeLayer(this.layers_)},ol.interaction.Clip.prototype.removeLayer=function(n){n instanceof Array||(n=[n]);for(var c=0;c<n.length;c++){var h;for(h=0;h<this.layers_.length&&this.layers_[h]!==n[c];h++);h!=this.layers_.length&&this.getMap()&&(this.layers_[h].un(["precompose","prerender"],this.precomposeBind_),this.layers_[h].un(["postcompose","postrender"],this.postcomposeBind_),this.layers_.splice(h,1))}if(this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Clip.prototype.setPosition=function(n){if(this.getMap()){this.pos=this.getMap().getPixelFromCoordinate(n);try{this.getMap().renderSync()}catch{}}},ol.interaction.Clip.prototype.getPosition=function(){return this.pos?this.getMap().getCoordinateFromPixel(this.pos):null},ol.interaction.Clip.prototype.setPixelPosition=function(n){if(this.pos=n,this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Clip.prototype.getPixelPosition=function(){return this.pos},ol.interaction.Clip.prototype._setPosition=function(n){if(!(n.type==="pointermove"&&this.get("action")==="onclick")&&(n.pixel&&(this.pos=n.pixel),this.getMap()))try{this.getMap().renderSync()}catch{}},ol.interaction.Clip.prototype.precompose_=function(n){if(this.getActive()){var c=n.context,h=n.frameState.pixelRatio;c.save(),c.beginPath();var u=[this.pos[0],this.pos[1]],d=this.radius,m=n.inversePixelTransform;m?(u=[u[0]*m[0]-u[1]*m[1]+m[4],-u[0]*m[2]+u[1]*m[3]+m[5]],d=u[0]-((this.pos[0]-d)*m[0]-this.pos[1]*m[1]+m[4])):(u[0]*=h,u[1]*=h,d*=h),c.arc(u[0],u[1],d,0,2*Math.PI),c.clip()}},ol.interaction.Clip.prototype.postcompose_=function(n){this.getActive()&&n.context.restore()},ol.interaction.Clip.prototype.setActive=function(n){if(n!==this.getActive()){ol.interaction.Pointer.prototype.setActive.call(this,n);var c;if(n)for(c=0;c<this.layers_.length;c++)this.layers_[c].on(["precompose","prerender"],this.precomposeBind_),this.layers_[c].on(["postcompose","postrender"],this.postcomposeBind_);else for(c=0;c<this.layers_.length;c++)this.layers_[c].un(["precompose","prerender"],this.precomposeBind_),this.layers_[c].un(["postcompose","postrender"],this.postcomposeBind_);if(this.getMap())try{this.getMap().renderSync()}catch{}}},ol.interaction.CurrentMap=function(n){n=n||{};var c=n.condition||function(){return!0};ol.interaction.Interaction.call(this,{handleEvent:function(h){return c(h)&&(this.isCurrentMap()||(this.setCurrentMap(this.getMap()),this.dispatchEvent({type:"focus",map:this.getMap()}),this.getMap().dispatchEvent({type:"focus",map:this.getMap()}))),!0}.bind(this)}),n.onKeyDown&&document.addEventListener("keydown",function(h){this.isCurrentMap()&&!/INPUT|TEXTAREA|SELECT/.test(document.activeElement.tagName)&&n.onKeyDown({type:h.type,map:this.getMap(),originalEvent:h})}.bind(this)),n.onKeyPress&&document.addEventListener("keydown",function(h){this.isCurrentMap()&&!/INPUT|TEXTAREA|SELECT/.test(document.activeElement.tagName)&&n.onKeyPress({type:h.type,map:this.getMap(),originalEvent:h})}.bind(this)),n.onKeyUp&&document.addEventListener("keydown",function(h){this.isCurrentMap()&&!/INPUT|TEXTAREA|SELECT/.test(document.activeElement.tagName)&&n.onKeyUp({type:h.type,map:this.getMap(),originalEvent:h})}.bind(this))},ol.ext.inherits(ol.interaction.CurrentMap,ol.interaction.Interaction),ol.interaction.CurrentMap.prototype._currentMap=void 0,ol.interaction.CurrentMap.prototype.isCurrentMap=function(){return this.getMap()===ol.interaction.CurrentMap.prototype._currentMap},ol.interaction.CurrentMap.prototype.getCurrentMap=function(){return ol.interaction.CurrentMap.prototype._currentMap},ol.interaction.CurrentMap.prototype.setCurrentMap=function(n){ol.interaction.CurrentMap.prototype._currentMap=n},ol.interaction.Blob=function(n){ol.interaction.Clip.call(this,n)},ol.ext.inherits(ol.interaction.Blob,ol.interaction.Clip),ol.interaction.Blob.prototype.precompose_=function(n){if(this.getActive()){var c=n.context,h=n.frameState.pixelRatio;if(c.save(),!this.pos){c.beginPath(),c.moveTo(0,0),c.clip();return}var u=[this.pos[0],this.pos[1]],d=n.inversePixelTransform;d?u=[u[0]*d[0]-u[1]*d[1]+d[4],-u[0]*d[2]+u[1]*d[3]+d[5]]:(u[0]*=h,u[1]*=h),this.frame||(this.frame=n.frameState.time);var m=n.frameState.time-this.frame;this.frame=n.frameState.time,u=this._getCenter(u,m);var g=this._calculate(m),x=g[0];c.beginPath(),c.moveTo(u[0]+x[0],u[1]+x[1]);for(var E=1;x=g[E];E++)c.lineTo(u[0]+x[0],u[1]+x[1]);c.clip(),n.frameState.animate=!0}},ol.interaction.Blob.prototype._getCenter=function(n,c){if(!this._center)this._center=n,this._velocity=[0,0];else{var h=this.get("stiffness")||20,u=-1*(this.get("damping")||7),d=Math.max(this.get("mass")||1,.1),m=Math.min(c/1e3,1/30),g=[h*(n[0]-this._center[0]),h*(n[1]-this._center[1])],x=[u*this._velocity[0],u*this._velocity[1]],E=[(g[0]+x[0])/d,(g[1]+x[1])/d];this._velocity[0]+=E[0]*m,this._velocity[1]+=E[1]*m,this._center[0]+=this._velocity[0]*m,this._center[1]+=this._velocity[1]*m}return this._center},ol.interaction.Blob.prototype._calculate=function(n){var c,h=this.get("points")||10;if(!this._waves||this._waves.length!==h)for(this._waves=[],c=0;c<h;c++)this._waves.push({angle:Math.random()*Math.PI,noise:Math.random()});var u=[],d=(this._velocity[0]*this._velocity[0]+this._velocity[1]*this._velocity[1])/500;for(this._rotation=(this._rotation||0)+(this._velocity[0]>0?1:-1)*Math.min(.015,d/7e4*n),c=0;c<h;c++){var m=c*2*Math.PI/h+this._rotation,g=this.radius+Math.min(this.radius,d),x=Math.cos(this._waves[c].angle)*g/4*this._waves[c].noise*(this.get("amplitude")||1);u.push([(this.radius+x)*Math.cos(m),(this.radius+x)*Math.sin(m)]),this._waves[c].angle+=(Math.PI+Math.random()+d/200)/350*n*(this.get("fuss")||1),this._waves[c].noise=Math.min(1,Math.max(0,this._waves[c].noise+(Math.random()-.5)*.1*(this.get("fuss")||1)))}return u.push(u[0]),ol.coordinate.cspline(u,{tension:this.get("tension")})},ol.interaction.CenterTouch=function(n){n=n||{},this._listener={};var c=/^pointermove$|^pointerup$/;this.ctouch=new ol.interaction.Interaction({handleEvent:function(h){return c.test(h.type)&&this.getMap()&&(h.coordinate=this.getMap().getView().getCenter(),h.pixel=this.getMap().getSize(),h.pixel=[h.pixel[0]/2,h.pixel[1]/2]),!0}}),this._target=new ol.control.Target({style:n.targetStyle,composite:n.composite}),ol.interaction.Interaction.call(this,{handleEvent:function(h){return c.test(h.type)&&(this.pos_=h.coordinate),n.handleEvent?n.handleEvent.call(this,h):!0}})},ol.ext.inherits(ol.interaction.CenterTouch,ol.interaction.Interaction),ol.interaction.CenterTouch.prototype.setMap=function(n){this.getMap()&&(this.getMap().removeInteraction(this.ctouch),this.getMap().removeInteraction(this._target)),ol.interaction.Interaction.prototype.setMap.call(this,n),this.getMap()&&this.getActive()&&(this.getMap().addInteraction(this.ctouch),this.getMap().addControl(this._target))},ol.interaction.CenterTouch.prototype.setActive=function(n){ol.interaction.Interaction.prototype.setActive.call(this,n),this.pos_=null,this.getMap()&&(this.getActive()?(this.getMap().addInteraction(this.ctouch),this.getMap().addControl(this._target)):(this.getMap().removeInteraction(this.ctouch),this.getMap().removeControl(this._target)))},ol.interaction.CenterTouch.prototype.getPosition=function(){if(!this.pos_){var n=this.getMap().getSize();n=[n[0]/2,n[1]/2],this.pos_=this.getMap().getCoordinateFromPixel(n)}return this.pos_},ol.interaction.ClipMap=function(n){this.layers_=[],ol.interaction.Pointer.call(this,{handleDownEvent:this._clip,handleMoveEvent:this._clip}),n=n||{},this.pos=!1,this.radius=n.radius||100,this.pos=[-1e3,-1e3]},ol.ext.inherits(ol.interaction.ClipMap,ol.interaction.Pointer),ol.interaction.ClipMap.prototype.setMap=function(n){if(this.getMap()){this._listener&&ol.Observable.unByKey(this._listener);var c=this.getMap().getViewport().querySelector(".ol-layers");c.style.clipPath=""}ol.interaction.Pointer.prototype.setMap.call(this,n),n&&(this._listener=n.on("change:size",this._clip.bind(this)))},ol.interaction.ClipMap.prototype.setRadius=function(n){this.radius=n,this._clip()},ol.interaction.ClipMap.prototype.getRadius=function(){return this.radius},ol.interaction.ClipMap.prototype.setPosition=function(n){this.getMap()&&(this.pos=this.getMap().getPixelFromCoordinate(n),this._clip())},ol.interaction.ClipMap.prototype.getPosition=function(){return this.pos?this.getMap().getCoordinateFromPixel(this.pos):null},ol.interaction.ClipMap.prototype.setPixelPosition=function(n){this.pos=n,this._clip()},ol.interaction.ClipMap.prototype.getPixelPosition=function(){return this.pos},ol.interaction.ClipMap.prototype._setPosition=function(n){if(!(n.type==="pointermove"&&this.get("action")==="onclick")&&(n.pixel&&(this.pos=n.pixel),this.getMap()))try{this.getMap().renderSync()}catch{}},ol.interaction.ClipMap.prototype._clip=function(n){if(n&&n.pixel&&(this.pos=n.pixel),this.pos&&this.getMap()){var c=this.getMap().getViewport().querySelector(".ol-layers");c.style.clipPath="circle("+this.getRadius()+"px at "+this.pos[0]+"px "+this.pos[1]+"px)"}},ol.interaction.CopyPaste=function(n){n=n||{},this.features=[],this._cloneFeature=!0;var c=n.condition;typeof c!="function"&&(c=function(h){if(h.originalEvent.ctrlKey){if(/^c$/i.test(h.originalEvent.key))return"copy";if(/^x$/i.test(h.originalEvent.key))return"cut";if(/^v$/i.test(h.originalEvent.key))return"paste"}return!1}),this._featuresSource=n.features||new ol.Collection,this.setSources(n.sources),this.setDestination(n.destination),ol.interaction.CurrentMap.call(this,{condition:n.mapCondition,onKeyDown:function(h){switch(c(h)){case"copy":{this.copy({silent:!1});break}case"cut":{this.copy({cut:!0,silent:!1});break}case"paste":{this.paste({silent:!1});break}default:break}}.bind(this)})},ol.ext.inherits(ol.interaction.CopyPaste,ol.interaction.CurrentMap),ol.interaction.CopyPaste.prototype.setSources=function(n){n?(this._source=[],this._source=n instanceof Array?n:[n]):this._source=null},ol.interaction.CopyPaste.prototype.getSources=function(){return this._source},ol.interaction.CopyPaste.prototype.setDestination=function(n){this._destination=n},ol.interaction.CopyPaste.prototype.getDestination=function(){return this._destination},ol.interaction.CopyPaste.prototype.getFeatures=function(){return this.features},ol.interaction.CopyPaste.prototype.copy=function(n){n=n||{};var c=n.features||this._featuresSource.getArray();if(n.cut){var h=this._source||[this._destination];c.forEach(function(u){h.forEach(function(d){try{d.removeFeature(u)}catch{}})})}this._cloneFeature?(this.features=[],c.forEach(function(u){this.features.push(u.clone())}.bind(this))):this.features=c,n.silent===!1&&this.dispatchEvent({type:n.cut?"cut":"copy",time:new Date().getTime()})},ol.interaction.CopyPaste.prototype.paste=function(n){n=n||{};var c=n.features||this.features;if(c){var h=n.destination||this._destination;h&&(h.addFeatures(this.features),this._cloneFeature&&this.copy({features:this.features}))}n.silent===!1&&this.dispatchEvent({type:"paste",features:c,time:new Date().getTime()})},ol.interaction.Delete=function(n){ol.interaction.Select.call(this,n),this.on("select",function(c){this.getFeatures().clear(),this.delete(c.selected)}.bind(this))},ol.ext.inherits(ol.interaction.Delete,ol.interaction.Select),ol.interaction.Delete.prototype._getSources=function(n){if(!this.getMap())return[];n||(n=this.getMap().getLayers());var c=[];return n.forEach(function(h){h.getLayers?c=c.concat(this._getSources(h.getLayers())):h.getSource&&h.getSource()instanceof ol.source.Vector&&c.push(h.getSource())}.bind(this)),c},ol.interaction.Delete.prototype.delete=function(n){if(n&&(n.length||n.getLength())){this.dispatchEvent({type:"deletestart",features:n});var c=[];this._getSources().forEach(function(h){try{n.forEach(function(u){h.removeFeature(u),c.push(u)})}catch{}}),this.dispatchEvent({type:"deleteend",features:c})}},ol.interaction.DragOverlay=function(n){n||(n={});var c=n.offset||[0,0];ol.interaction.Pointer.call(this,{handleDownEvent:function(h){var u=h.frameState.viewState.resolution,d=[h.coordinate[0]+c[0]*u,h.coordinate[1]-c[1]*u];return/^(BUTTON|A)$/.test(h.originalEvent.target.tagName)?(this._dragging=!1,!0):this._dragging?(n.centerOnClick!==!1?this._dragging.setPosition(d,!0):d=this._dragging.getPosition(),this.dispatchEvent({type:"dragstart",overlay:this._dragging,originalEvent:h.originalEvent,frameState:h.frameState,coordinate:d}),!0):!1},handleDragEvent:function(h){var u=h.frameState.viewState.resolution,d=[h.coordinate[0]+c[0]*u,h.coordinate[1]-c[1]*u];this._dragging&&(this._dragging.setPosition(d,!0),this.dispatchEvent({type:"dragging",overlay:this._dragging,originalEvent:h.originalEvent,frameState:h.frameState,coordinate:d}))},handleUpEvent:function(h){var u=h.frameState.viewState.resolution,d=[h.coordinate[0]+c[0]*u,h.coordinate[1]-c[1]*u];return this._dragging?(this.dispatchEvent({type:"dragend",overlay:this._dragging,originalEvent:h.originalEvent,frameState:h.frameState,coordinate:d}),this._dragging=!1,!0):!1}}),this._overlays=[],n.overlays instanceof Array||(n.overlays=[n.overlays]),n.overlays.forEach(this.addOverlay.bind(this))},ol.ext.inherits(ol.interaction.DragOverlay,ol.interaction.Pointer),ol.interaction.DragOverlay.prototype.addOverlay=function(n){for(var c=0,h;h=this._overlays[c];c++)if(h===n)return;if(n.element.parentElement&&n.element.parentElement.classList.contains("ol-overlaycontainer-stopevent")){console.warn("[DragOverlay.addOverlay] overlay must be created with stopEvent set to false!");return}var u=function(){this.getMap()===n.getMap()&&(this._dragging=n)}.bind(this);this._overlays.push({overlay:n,listener:u}),n.element.addEventListener("pointerdown",u)},ol.interaction.DragOverlay.prototype.removeOverlay=function(n){for(var c=0,h;h=this._overlays[c];c++)if(h.overlay===n){var u=this._overlays.splice(c,1)[0];n.element.removeEventListener("pointerdown",u.listener);break}},ol.interaction.DrawHole=function(n){n||(n={});var c=this;this._select=new ol.interaction.Select({style:n.style}),this._select.setActive(!1);var h,u=n.geometryFunction;if(u?h=function(m,g){return g=c._geometryFn(m,g),u(m,g)}:h=function(m,g){return c._geometryFn(m,g)},n.type="Polygon",n.geometryFunction=h,ol.interaction.Draw.call(this,n),n.layers&&(typeof n.layers=="function"?this.layers_=n.layers:n.layers.indexOf&&(this.layers_=function(m){return n.layers.indexOf(m)>=0})),typeof n.featureFilter=="function")this._features=n.featureFilter;else if(n.featureFilter){var d=n.featureFilter;this._features=function(m){return d.indexOf?!!d[d.indexOf(m)]:!!d.item(d.getArray().indexOf(m))}}else this._features=function(){return!0};this.on("drawstart",this._startDrawing.bind(this)),this.on("drawend",this._finishDrawing.bind(this))},ol.ext.inherits(ol.interaction.DrawHole,ol.interaction.Draw),ol.interaction.DrawHole.prototype.setMap=function(n){this.getMap()&&this.getMap().removeInteraction(this._select),n&&n.addInteraction(this._select),ol.interaction.Draw.prototype.setMap.call(this,n)},ol.interaction.DrawHole.prototype.setActive=function(n){this._select.getFeatures().clear(),ol.interaction.Draw.prototype.setActive.call(this,n)},ol.interaction.DrawHole.prototype.removeLastPoint=function(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&ol.interaction.Draw.prototype.removeLastPoint.call(this)},ol.interaction.DrawHole.prototype.getPolygon=function(){return this._polygon},ol.interaction.DrawHole.prototype._startDrawing=function(n){var c=this.getMap();this._feature=n.feature;var h=n.feature.getGeometry().getCoordinates()[0][0];this._current=null,c.forEachFeatureAtPixel(c.getPixelFromCoordinate(h),function(u,d){if(!this._current&&this._features(u,d)){var m=u.getGeometry();if(m.getType()==="Polygon"&&m.intersectsCoordinate(h))this._polygonIndex=!1,this._polygon=m,this._current=u;else if(m.getType()==="MultiPolygon"&&m.intersectsCoordinate(h)){for(var g=0,x;x=m.getPolygon(g);g++)if(x.intersectsCoordinate(h)){this._polygonIndex=g,this._polygon=x,this._current=u;break}}}}.bind(this),{layerFilter:this.layers_}),this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))},ol.interaction.DrawHole.prototype._finishDrawing=function(n){n.hole=n.feature,n.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var c=n.hole.getGeometry().getCoordinates()[0];if(c.length>3)if(this._polygonIndex!==!1){for(var h=n.feature.getGeometry(),u=new ol.geom.MultiPolygon([]),d=0,m;m=h.getPolygon(d);d++)d===this._polygonIndex&&m.appendLinearRing(new ol.geom.LinearRing(c)),u.appendPolygon(m);n.feature.setGeometry(u)}else this.getPolygon().appendLinearRing(new ol.geom.LinearRing(c));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()},ol.interaction.DrawHole.prototype._geometryFn=function(n,c){var h=n[0].pop();return(!this.getPolygon()||this.getPolygon().intersectsCoordinate(h))&&(this.lastOKCoord=[h[0],h[1]]),n[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),c?c.setCoordinates([n[0].concat([n[0][0]])]):c=new ol.geom.Polygon(n),c},ol.interaction.DrawRegular=function(n){n||(n={}),this.squaredClickTolerance_=n.clickTolerance?n.clickTolerance*n.clickTolerance:36,this.maxCircleCoordinates_=n.maxCircleCoordinates||100,this.features_=n.features,this.source_=n.source,this.conditionFn_=n.condition,this.squareFn_=n.squareCondition,this.centeredFn_=n.centerCondition,this.canRotate_=n.canRotate!==!1,this.geometryName_=n.geometryName,this.setSides(n.sides);var c=ol.style.Style.defaultStyle(!0);this.sketch_=new ol.Collection,this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({features:this.sketch_,useSpatialIndex:!1}),name:"DrawRegular overlay",displayInLayerSwitcher:!1,style:n.style||c}),ol.interaction.Interaction.call(this,{handleEvent:this.handleEvent_})},ol.ext.inherits(ol.interaction.DrawRegular,ol.interaction.Interaction),ol.interaction.DrawRegular.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),ol.interaction.Interaction.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n)},ol.interaction.DrawRegular.prototype.setActive=function(n){this.reset(),ol.interaction.Interaction.prototype.setActive.call(this,n)},ol.interaction.DrawRegular.prototype.reset=function(){this.overlayLayer_.getSource().clear(),this.started_=!1},ol.interaction.DrawRegular.prototype.setSides=function(n){n=parseInt(n),this.sides_=n>2?n:0},ol.interaction.DrawRegular.prototype.canRotate=function(n){return(n===!0||n===!1)&&(this.canRotate_=n),this.canRotate_},ol.interaction.DrawRegular.prototype.getSides=function(){return this.sides_},ol.interaction.DrawRegular.prototype.startAngle={default:Math.PI/2,3:-Math.PI/2,4:Math.PI/4},ol.interaction.DrawRegular.prototype.getGeom_=function(){if(this.overlayLayer_.getSource().clear(),!this.center_)return!1;var n;if(this.coord_){var c=this.center_,h=this.coord_,u,d,m,g,x;if(!this.sides_&&this.square_&&!this.centered_)return c=[(h[0]+c[0])/2,(h[1]+c[1])/2],u=[h[0]-c[0],h[1]-c[1]],m=Math.sqrt(u[0]*u[0]+u[1]*u[1]),g=new ol.geom.Circle(c,m,"XY"),x=this.getMap().getPixelFromCoordinate(c),d=Math.max(100,Math.abs(x[0]-this.coordPx_[0]),Math.abs(x[1]-this.coordPx_[1])),d=Math.min(this.maxCircleCoordinates_,Math.round(d/3)),ol.geom.Polygon.fromCircle(g,d,0);var E=this.canRotate_&&this.centered_&&this.square_;if(u=[h[0]-c[0],h[1]-c[1]],this.square_&&!E){var P=Math.max(Math.abs(u[0]),Math.abs(u[1]));h=[c[0]+(u[0]>0?P:-P),c[1]+(u[1]>0?P:-P)]}if(m=Math.sqrt(u[0]*u[0]+u[1]*u[1]),m>0){g=new ol.geom.Circle(c,m,"XY");var L;if(E?L=Math.atan2(u[1],u[0]):L=this.startAngle[this.sides_]||this.startAngle.default,this.sides_?n=ol.geom.Polygon.fromCircle(g,this.sides_,L):(x=this.getMap().getPixelFromCoordinate(this.center_),d=Math.max(100,Math.abs(x[0]-this.coordPx_[0]),Math.abs(x[1]-this.coordPx_[1])),d=Math.min(this.maxCircleCoordinates_,Math.round(d/(this.centered_?3:5))),n=ol.geom.Polygon.fromCircle(g,d,0)),E)return n;var F=n.getExtent();this.centered_?c=[2*this.center_[0]-this.coord_[0],2*this.center_[1]-this.coord_[1]]:c=this.center_;var U=(c[0]-h[0])/(F[0]-F[2]),A=(c[1]-h[1])/(F[1]-F[3]);if(this.square_){var G=Math.min(Math.abs(U),Math.abs(A));U=Math.sign(U)*G,A=Math.sign(A)*G}var B=[c[0]-F[0]*U,c[1]-F[1]*A];return n.applyTransform(function(O,K,Q){for(var et=0;et<O.length;et+=Q)K[et]=O[et]*U+B[0],K[et+1]=O[et+1]*A+B[1];return K}),n}}return new ol.geom.Point(this.center_)},ol.interaction.DrawRegular.prototype.drawSketch_=function(n){if(this.overlayLayer_.getSource().clear(),n){this.square_=this.squareFn_?this.squareFn_(n):n.originalEvent.shiftKey,this.centered_=this.centeredFn_?this.centeredFn_(n):n.originalEvent.metaKey||n.originalEvent.ctrlKey;var c=this.getGeom_();if(c){var h=this.feature_;return c.getType()==="Polygon"&&h.getGeometry().setCoordinates(c.getCoordinates()),this.overlayLayer_.getSource().addFeature(h),this.coord_&&this.square_&&(this.canRotate_&&this.centered_&&this.coord_||!this.sides_&&!this.centered_)&&this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.LineString([this.center_,this.coord_]))),h}}},ol.interaction.DrawRegular.prototype.drawPoint_=function(n,c){c||this.overlayLayer_.getSource().clear(),this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.Point(n)))},ol.interaction.DrawRegular.prototype.handleEvent_=function(n){var c,h;switch(this._eventTime=new Date,n.type){case"pointerdown":{if(this.conditionFn_&&!this.conditionFn_(n))break;this.downPx_=n.pixel,this.start_(n);var u=500;this._longTouch=!1,setTimeout(function(){this._longTouch=new Date-this._eventTime>.9*u,this._longTouch&&this.handleMoveEvent_(n)}.bind(this),u);break}case"pointerup":{this.started_&&this.coord_&&(c=this.downPx_[0]-n.pixel[0],h=this.downPx_[1]-n.pixel[1],c*c+h*h<=this.squaredClickTolerance_&&(this.lastEvent=="pointermove"||this.lastEvent=="keydown"?this.end_(n):(c=this.upPx_[0]-n.pixel[0],h=this.upPx_[1]-n.pixel[1],c*c+h*h<=this.squaredClickTolerance_?this.end_(n):(this.handleMoveEvent_(n),this.drawPoint_(n.coordinate,!0))))),this.upPx_=n.pixel;break}case"pointerdrag":{if(this.started_){var d=this.getMap().getPixelFromCoordinate(this.center_);c=d[0]-n.pixel[0],h=d[1]-n.pixel[1],c*c+h*h<=this.squaredClickTolerance_&&this.reset()}return!this._longTouch}case"pointermove":{this.started_&&(c=this.downPx_[0]-n.pixel[0],h=this.downPx_[1]-n.pixel[1],c*c+h*h>this.squaredClickTolerance_&&(this.handleMoveEvent_(n),this.lastEvent=n.type));break}default:{if(this.lastEvent=n.type,this.started_&&n.type==="dblclick")return!1;break}}return!0},ol.interaction.DrawRegular.prototype.finishDrawing=function(){this.started_&&this.coord_&&this.end_({pixel:this.upPx_,coordinate:this.coord_})},ol.interaction.DrawRegular.prototype.handleMoveEvent_=function(n){if(this.started_){this.coord_=n.coordinate,this.coordPx_=n.pixel;var c=this.drawSketch_(n);this.dispatchEvent({type:"drawing",feature:c,pixel:n.pixel,startCoordinate:this.center_,coordinate:n.coordinate,square:this.square_,centered:this.centered_})}else this.drawPoint_(n.coordinate)},ol.interaction.DrawRegular.prototype.start_=function(n){if(this.started_)this.coord_=n.coordinate;else{this.started_=!0,this.center_=n.coordinate,this.coord_=null;var c=this.feature_=new ol.Feature({});c.setGeometryName(this.geometryName_),c.setGeometry(new ol.geom.Polygon([[n.coordinate,n.coordinate,n.coordinate]])),this.drawSketch_(n),this.dispatchEvent({type:"drawstart",feature:c,pixel:n.pixel,coordinate:n.coordinate})}},ol.interaction.DrawRegular.prototype.end_=function(n){if(this.coord_=n.coordinate,this.started_=!1,this.coord_&&(this.center_[0]!==this.coord_[0]||this.center_[1]!==this.coord_[1])){var c=this.feature_;c.setGeometry(this.getGeom_()),this.source_?this.source_.addFeature(c):this.features_&&this.features_.push(c),this.dispatchEvent({type:"drawend",feature:c,pixel:n.pixel,coordinate:n.coordinate,square:this.square_,centered:this.centered_})}else this.dispatchEvent({type:"drawcancel",feature:null,pixel:n.pixel,coordinate:n.coordinate,square:this.square_,centered:this.centered_});this.center_=this.coord_=null,this.drawSketch_()},ol.interaction.DrawTouch=function(n){n=n||{},n.handleEvent=function(h){if(this.get("tap"))switch(this.sketch.setPosition(this.getPosition()),h.type){case"singleclick":{this.addPoint();break}case"dblclick":return this.addPoint(),this.finishDrawing(),!1;default:break}return!0},n.sketchStyle||(n.sketchStyle=ol.style.Style.defaultStyle());var c=this.sketch=new ol.layer.SketchOverlay(n);c.on(["drawstart","drawabort"],function(h){this.dispatchEvent(h)}.bind(this)),c.on(["drawend"],function(h){h.feature&&h.valid&&n.source&&n.source.addFeature(h.feature),this.dispatchEvent(h)}.bind(this)),ol.interaction.CenterTouch.call(this,n),this._source=n.source,this.set("tap",n.tap!==!1)},ol.ext.inherits(ol.interaction.DrawTouch,ol.interaction.CenterTouch),ol.interaction.DrawTouch.prototype.setMap=function(n){if(this._listener)for(var c in this._listener)ol.Observable.unByKey(c);this._listener={},ol.interaction.CenterTouch.prototype.setMap.call(this,n),this.sketch.setMap(n),n&&(this._listener.center=n.on("postcompose",function(){ol.coordinate.equal(this.getPosition(),this.sketch.getPosition()||[])||this.sketch.setPosition(this.getPosition())}.bind(this)))},ol.interaction.DrawTouch.prototype.setGeometryType=function(n){return this.sketch.setGeometryType(n)},ol.interaction.DrawTouch.prototype.getGeometryType=function(){return this.sketch.getGeometryType()},ol.interaction.DrawTouch.prototype.finishDrawing=function(){this.sketch.finishDrawing(!0)},ol.interaction.DrawTouch.prototype.addPoint=function(){this.sketch.addPoint(this.getPosition())},ol.interaction.DrawTouch.prototype.removeLastPoint=function(){this.sketch.removeLastPoint()},ol.interaction.DrawTouch.prototype.setActive=function(n){ol.interaction.CenterTouch.prototype.setActive.call(this,n),this.sketch.abortDrawing(),this.sketch.setVisible(n)},ol.interaction.DropFile=function(n){n=n||{},ol.interaction.DragAndDrop.call(this,{});var c=n.zone||document;c.addEventListener("dragenter",this.onstop),c.addEventListener("dragover",this.onstop),c.addEventListener("dragleave",this.onstop),this.formatConstructors_=n.formatConstructors||[ol.format.GPX,ol.format.GeoJSONX,ol.format.GeoJSONP,ol.format.GeoJSON,ol.format.IGC,ol.format.KML,ol.format.TopoJSON],this.projection_=n.projection,this.accept_=n.accept||["gpx","json","geojsonx","geojsonp","geojson","igc","kml","topojson"];var h=this;c.addEventListener("drop",function(u){return h.ondrop(u)})},ol.ext.inherits(ol.interaction.DropFile,ol.interaction.DragAndDrop),ol.interaction.DropFile.prototype.setMap=function(n){ol.interaction.Interaction.prototype.setMap.call(this,n)},ol.interaction.DropFile.prototype.onstop=function(n){return n.preventDefault(),n.stopPropagation(),!1},ol.interaction.DropFile.prototype.ondrop=function(n){if(n.preventDefault(),n.dataTransfer&&n.dataTransfer.files.length)for(var c=this,h=this.projection_||(this.getMap()?this.getMap().getView().getProjection():null),u=n.dataTransfer.files,d,m=/\.([0-9a-z]+)(?=[?#])|(\.)(?:[\w]+)$/,g=0;d=u[g];g++){var x=d.name.match(m)[0],E=this.accept_.indexOf(x.toLocaleLowerCase())>=0;if(c.dispatchEvent({type:"loadstart",file:d,filesize:d.size,filetype:d.type,fileextension:x,projection:h,isok:E}),!!this.formatConstructors_.length){var P=new FileReader,L=this.formatConstructors_,F=d;P.onload=function(U){var A=U.target.result,G=[],B,O;for(B=0,O=L.length;B<O;++B){var K=L[B];try{var Q=new K;if(G=Q.readFeatures(A,{featureProjection:h}),G&&G.length>0){c.dispatchEvent({type:"addfeatures",features:G,file:F,projection:h}),c.dispatchEvent({type:"loadend",features:G,file:F,projection:h});return}}catch{}}c.dispatchEvent({type:"loadend",file:F,result:A})},P.readAsText(d)}}return!1},ol.interaction.FillAttribute=function(n,c){if(n=n||{},n.condition||(n.condition=ol.events.condition.click),ol.interaction.Select.call(this,n),this.setActive(n.active!==!1),this.set("name",n.name),this._attributes=c,this.on("select",function(d){this.getFeatures().clear(),this.fill(d.selected,this._attributes)}.bind(this)),n.cursor===void 0){var h=document.createElement("CANVAS");h.width=h.height=32;var u=h.getContext("2d");u.beginPath(),u.moveTo(9,3),u.lineTo(2,9),u.lineTo(10,17),u.lineTo(17,11),u.closePath(),u.fillStyle="#fff",u.fill(),u.stroke(),u.beginPath(),u.moveTo(6,4),u.lineTo(0,8),u.lineTo(0,13),u.lineTo(3,17),u.lineTo(3,8),u.closePath(),u.fillStyle="#000",u.fill(),u.stroke(),u.moveTo(8,8),u.lineTo(10,0),u.lineTo(11,0),u.lineTo(13,3),u.lineTo(13,7),u.stroke(),this._cursor="url("+h.toDataURL()+") 0 13, auto"}n.cursor&&(this._cursor=n.cursor)},ol.ext.inherits(ol.interaction.FillAttribute,ol.interaction.Select),ol.interaction.FillAttribute.prototype.setCursor=function(n){this._cursor=n},ol.interaction.FillAttribute.prototype.getCursor=function(){return this._cursor},ol.interaction.FillAttribute.prototype.setActive=function(n){n!==this.getActive()&&(ol.interaction.Select.prototype.setActive.call(this,n),this.getMap()&&this._cursor&&(n?(this._previousCursor=this.getMap().getTargetElement().style.cursor,this.getMap().getTargetElement().style.cursor=this._cursor):(this.getMap().getTargetElement().style.cursor=this._previousCursor,this._previousCursor=void 0)))},ol.interaction.FillAttribute.prototype.setAttributes=function(n){this._attributes=n},ol.interaction.FillAttribute.prototype.setAttribute=function(n,c){this._attributes[n]=c},ol.interaction.FillAttribute.prototype.getAttributes=function(){return this._attributes},ol.interaction.FillAttribute.prototype.getAttribute=function(n){return this._attributes[n]},ol.interaction.FillAttribute.prototype.fill=function(n,c){if(n.length&&c){for(var h=!1,u=0,d;d=n[u];u++){for(var m in c)d.get(m)!==c[m]&&(h=!0);if(h)break}h&&(this.dispatchEvent({type:"setattributestart",features:n,properties:c}),n.forEach(function(g){for(var x in c)g.set(x,c[x])}),this.dispatchEvent({type:"setattributeend",features:n,properties:c}))}},ol.interaction.Flashlight=function(n){ol.interaction.Pointer.call(this,{handleDownEvent:this.setPosition,handleMoveEvent:this.setPosition}),n=n||{},this.pos=!1,this.radius=n.radius||100,this.setColor(n)},ol.ext.inherits(ol.interaction.Flashlight,ol.interaction.Pointer),ol.interaction.Flashlight.prototype.setMap=function(n){this.getMap()&&this.getMap().render(),this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.interaction.Pointer.prototype.setMap.call(this,n),n&&(this._listener=n.on("postcompose",this.postcompose_.bind(this)))},ol.interaction.Flashlight.prototype.setRadius=function(n){if(this.radius=n,this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Flashlight.prototype.setColor=function(n){var c=n.fill?n.fill:[0,0,0,.8],h=ol.color.asArray(c);if(this.startColor=ol.color.asString(h),n.color?h=this.endColor=ol.color.asString(ol.color.asArray(n.color)||n.color):(h[3]=0,this.endColor=ol.color.asString(h)),h[3]=.1,this.midColor=ol.color.asString(h),this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Flashlight.prototype.setPosition=function(n){if(n.pixel?this.pos=n.pixel:this.pos=n,this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.Flashlight.prototype.postcompose_=function(n){var c=ol.ext.getMapCanvas(this.getMap()).getContext("2d"),h=n.frameState.pixelRatio,u=c.canvas.width,d=c.canvas.height;if(c.save(),c.scale(h,h),!this.pos)c.fillStyle=this.startColor,c.fillRect(0,0,u,d);else{var m=Math.max(u,d),g=c.createRadialGradient(this.pos[0],this.pos[1],u*this.radius/m,this.pos[0],this.pos[1],d*this.radius/m);g.addColorStop(0,this.startColor),g.addColorStop(.8,this.midColor),g.addColorStop(1,this.endColor),c.fillStyle=g,c.fillRect(this.pos[0]-m,this.pos[1]-m,2*m,2*m)}c.restore()},ol.interaction.FocusMap=function(){ol.interaction.Interaction.call(this,{}),this.focusBt=ol.ext.element.create("BUTTON",{on:{focus:function(){this.dispatchEvent({type:"focus"})}.bind(this)},style:{position:"absolute",zIndex:-1,top:0,opacity:0}})},ol.ext.inherits(ol.interaction.FocusMap,ol.interaction.Interaction),ol.interaction.FocusMap.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,this.getMap()&&this.getMap().getViewport().removeChild(this.focusBt),ol.interaction.Interaction.prototype.setMap.call(this,n),this.getMap()&&(this._listener=this.getMap().on("pointerdown",function(){this.getActive()&&this.focusBt.focus()}.bind(this)),this.getMap().getViewport().appendChild(this.focusBt))},ol.interaction.GeolocationDraw=function(n){n||(n={}),this.geolocation=new ol.Geolocation({projection:"EPSG:4326",trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),this.geolocation.on("change",this.draw_.bind(this)),this.path_=[],this.lastPosition_=!1;var c=[255,255,255,1],h=[0,153,255,1],u=3,d=new ol.style.Circle({radius:u*2,fill:new ol.style.Fill({color:h}),stroke:new ol.style.Stroke({color:c,width:u/2})}),m=[new ol.style.Style({stroke:new ol.style.Stroke({color:c,width:u+2})}),new ol.style.Style({stroke:new ol.style.Stroke({color:h,width:u}),fill:new ol.style.Fill({color:[255,255,255,.5]})})],g=new ol.style.RegularShape({radius:u*3.5,points:3,rotation:0,fill:new ol.style.Fill({color:h}),stroke:new ol.style.Stroke({color:c,width:u/2})}),x=g.getImage(),E=x.getContext("2d"),P=document.createElement("canvas");P.width=P.height=x.width,P.getContext("2d").drawImage(x,0,0),E.clearRect(0,0,x.width,x.height),E.drawImage(P,0,0,x.width,x.height,u,0,x.width-2*u,x.height);var L=function(F){return F.get("heading")===void 0?m[1].setImage(d):(m[1].setImage(g),g.setRotation(F.get("heading")||0)),m};this.locStyle={error:new ol.style.Style({fill:new ol.style.Fill({color:[255,0,0,.2]})}),warn:new ol.style.Style({fill:new ol.style.Fill({color:[255,192,0,.2]})}),ok:new ol.style.Style({fill:new ol.style.Fill({color:[0,255,0,.2]})})},this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector,name:"GeolocationDraw overlay",style:n.style||L}),this.sketch_=[new ol.Feature,new ol.Feature,new ol.Feature],this.overlayLayer_.getSource().addFeatures(this.sketch_),this.features_=n.features,this.source_=n.source,this.condition_=n.condition||function(F){return F.getAccuracy()<this.get("minAccuracy")},ol.interaction.Interaction.call(this,{handleEvent:function(){return!this.get("followTrack")||this.get("followTrack")=="auto"}}),this.set("type",n.type||"LineString"),this.set("attributes",n.attributes||{}),this.set("minAccuracy",n.minAccuracy||20),this.set("tolerance",n.tolerance||5),this.set("zoom",n.zoom),this.set("minZoom",n.minZoom),this.setFollowTrack(n.followTrack===void 0?!0:n.followTrack),this.setActive(!1)},ol.ext.inherits(ol.interaction.GeolocationDraw,ol.interaction.Interaction),ol.interaction.GeolocationDraw.prototype.simplify3D=function(n,c){var h=n.getCoordinates(),u=this.getMap().getView().getProjection();this.get("type")==="Polygon"&&(h=h[0]);for(var d=[h[0]],m,g=ol.proj.transform(h[0],u,"EPSG:4326"),x=1;x<h.length;x++){m=ol.proj.transform(h[x],u,"EPSG:4326");var E=ol.sphere.getDistance(g,m);E>c&&(d.push(h[x]),g=m)}return d[d.length-1]!==h[h.length-1]&&d.push(h[h.length-1]),this.get("type")==="Polygon"?n=new ol.geom.Polygon([d],"XYZM"):n=new ol.geom.LineString(d,"XYZM"),n},ol.interaction.GeolocationDraw.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),ol.interaction.Pointer.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n),n&&this.geolocation.setProjection(n.getView().getProjection())},ol.interaction.GeolocationDraw.prototype.setActive=function(n){if(n!==this.getActive()){if(ol.interaction.Interaction.prototype.setActive.call(this,n),this.overlayLayer_.setVisible(n),this.getMap()){this.geolocation.setTracking(n);try{this.getMap().renderSync()}catch{}}if(this.pause(!n),n)this.reset(),this.dispatchEvent({type:"drawstart",feature:this.sketch_[1]});else{var c=this.sketch_[1].clone();c.getGeometry()&&(this.features_&&this.features_.push(c),this.source_&&this.source_.addFeature(c)),this.dispatchEvent({type:"drawend",feature:c})}}},ol.interaction.GeolocationDraw.prototype.simulate=function(n,c){if(this._track&&clearTimeout(this._track.timeout),!n){this._track=!1;return}c=c||{};var h=c.delay||1e3;function u(){if(this._track.pos>=this._track.track.length){this._track=!1;return}var d=this._track.track[this._track.pos];d[2]=d[3]||0,d[3]=new Date().getTime(),this._track.pos++,c.repeat!==!1&&(this._track.pos=this._track.pos%this._track.track.length),this.getActive()&&this.draw_(!0,d,c.accuracy),this._track.timeout=setTimeout(u.bind(this),h)}this._track={track:n,pos:0,timeout:setTimeout(u.bind(this),0)}},ol.interaction.GeolocationDraw.prototype.simulating=function(){return!!this._track},ol.interaction.GeolocationDraw.prototype.reset=function(){this.sketch_[1].setGeometry(),this.path_=[],this.lastPosition_=!1},ol.interaction.GeolocationDraw.prototype.start=function(){this.setActive(!0)},ol.interaction.GeolocationDraw.prototype.stop=function(){this.setActive(!1)},ol.interaction.GeolocationDraw.prototype.pause=function(n){this.pause_=n!==!1},ol.interaction.GeolocationDraw.prototype.isPaused=function(){return this.pause_},ol.interaction.GeolocationDraw.prototype.setFollowTrack=function(n){this.set("followTrack",n);var c=this.getMap();if(this.getActive()&&c){var h;if(n!=="position"&&(this.get("minZoom")?h=Math.max(this.get("minZoom"),c.getView().getZoom()):h=this.get("zoom")),n!==!1&&!this.lastPosition_){var u=this.path_[this.path_.length-1];u&&c.getView().animate({center:u,zoom:h})}else n==="auto"&&this.lastPosition_&&c.getView().animate({center:this.lastPosition_,zoom:h})}this.lastPosition_=!1,this.dispatchEvent({type:"follow",following:n!==!1})},ol.interaction.GeolocationDraw.prototype.draw_=function(n,c,h){var u=this.getMap();if(u){var d,m,g,x,E;if(this._track){if(n!==!0)return;if(m=c,d=h||10,this.path_&&this.path_.length){var P=this.path_[this.path_.length-1];E=Math.atan2(c[0]-P[0],c[1]-P[1])}var L=new ol.geom.Circle(m,u.getView().getResolution()*d);g=ol.geom.Polygon.fromCircle(L)}else x=this.geolocation,d=x.getAccuracy(),m=this.getPosition(x),g=x.getAccuracyGeometry(),E=x.getHeading();switch(this.get("followTrack")){case!0:{this.get("followTrack")==!0&&(this.get("minZoom")?this.get("minZoom")>u.getView().getZoom()&&u.getView().setZoom(this.get("minZoom")):u.getView().setZoom(this.get("zoom")||16),ol.extent.containsExtent(u.getView().calculateExtent(u.getSize()),g.getExtent())||u.getView().fit(g.getExtent())),u.getView().setCenter(m);break}case"position":{u.getView().setCenter(m);break}case"auto":{if(this.lastPosition_){var F=u.getView().getCenter();F[0]!=this.lastPosition_[0]||F[1]!=this.lastPosition_[1]?this.setFollowTrack(!1):(u.getView().setCenter(m),this.lastPosition_=m)}else u.getView().setCenter(m),this.get("minZoom")?this.get("minZoom")>u.getView().getZoom()&&u.getView().setZoom(this.get("minZoom")):this.get("zoom")&&u.getView().setZoom(this.get("zoom")),this.lastPosition_=m;break}case"visible":{ol.extent.containsCoordinate(u.getView().calculateExtent(u.getSize()),m)||u.getView().setCenter(m);break}default:break}var U=this.sketch_[0];U.setGeometry(g),d<this.get("minAccuracy")/2?U.setStyle(this.locStyle.ok):d<this.get("minAccuracy")?U.setStyle(this.locStyle.warn):U.setStyle(this.locStyle.error);var A;if(this.pause_&&(this.lastPosition_=m),!this.pause_&&(!x||this.condition_.call(this,x))){switch(U=this.sketch_[1],this.path_.push(m),this.get("type")){case"Point":this.path_=[m],U.setGeometry(new ol.geom.Point(m,"XYZM"));var G=this.get("attributes");G.heading&&U.set("heading",x.getHeading()),G.accuracy&&U.set("accuracy",x.getAccuracy()),G.altitudeAccuracy&&U.set("altitudeAccuracy",x.getAltitudeAccuracy()),G.speed&&U.set("speed",x.getSpeed());break;case"LineString":this.path_.length>1?(A=new ol.geom.LineString(this.path_,"XYZM"),this.get("tolerance")&&(A=this.simplify3D(A,this.get("tolerance"))),U.setGeometry(A)):U.setGeometry();break;case"Polygon":this.path_.length>2?(A=new ol.geom.Polygon([this.path_],"XYZM"),this.get("tolerance")&&(A=this.simplify3D(A,this.get("tolerance"))),U.setGeometry(A)):U.setGeometry();break}this.dispatchEvent({type:"drawing",feature:this.sketch_[1],geolocation:x})}this.sketch_[2].setGeometry(new ol.geom.Point(m)),this.sketch_[2].set("heading",E),this.dispatchEvent({type:"tracking",feature:this.sketch_[1],geolocation:x})}},ol.interaction.GeolocationDraw.prototype.getPosition=function(n){var c=n.getPosition();return c.push(Math.round((n.getAltitude()||0)*100)/100),c.push(Math.round(new Date().getTime()/1e3)),c},ol.interaction.Hover=function(n){n||(n={});var c=this,h=!1;ol.interaction.Interaction.call(this,{handleEvent:function(u){if(!c.getActive())return!0;switch(u.type){case"pointerdrag":{h=!0;break}case"pointerup":{h=!1;break}case"pointermove":{h||c.handleMove_(u);break}}return n.handleEvent?n.handleEvent(u):!0}}),this.setLayerFilter(n.layerFilter),n.layers&&n.layers.length&&this.setLayerFilter(function(u){return n.layers.indexOf(u)>=0}),this.setFeatureFilter(n.featureFilter),this.set("hitTolerance",n.hitTolerance),this.setCursor(n.cursor)},ol.ext.inherits(ol.interaction.Hover,ol.interaction.Interaction),ol.interaction.Hover.prototype.setMap=function(n){this.previousCursor_!==void 0&&this.getMap()&&(this.getMap().getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=void 0),ol.interaction.Interaction.prototype.setMap.call(this,n)},ol.interaction.Hover.prototype.setActive=function(n){if(ol.interaction.Interaction.prototype.setActive.call(this,n),this.cursor_&&this.getMap()&&this.getMap().getTargetElement()){var c=this.getMap().getTargetElement().style;this.previousCursor_!==void 0&&(c.cursor=this.previousCursor_,this.previousCursor_=void 0)}},ol.interaction.Hover.prototype.setCursor=function(n){!n&&this.previousCursor_!==void 0&&this.getMap()&&(this.getMap().getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=void 0),this.cursor_=n},ol.interaction.Hover.prototype.setFeatureFilter=function(n){typeof n=="function"?this.featureFilter_=n:this.featureFilter_=function(){return!0}},ol.interaction.Hover.prototype.setLayerFilter=function(n){typeof n=="function"?this.layerFilter_=n:this.layerFilter_=function(){return!0}},ol.interaction.Hover.prototype.handleMove_=function(n){var c=this.getMap();if(c){var h,u,d=this,m=c.forEachFeatureAtPixel(n.pixel,function(x,E){return d.featureFilter_.call(null,x,E)?(h=x,u=E,!0):(h=u=null,!1)},{hitTolerance:this.get("hitTolerance"),layerFilter:d.layerFilter_});if(m&&this.dispatchEvent({type:"hover",feature:h,layer:u,coordinate:n.coordinate,pixel:n.pixel,map:n.map,originalEvent:n.originalEvent,dragging:n.dragging}),this.feature_===h&&this.layer_===u||(this.feature_=h,this.layer_=u,h?this.dispatchEvent({type:"enter",feature:h,layer:u,coordinate:n.coordinate,pixel:n.pixel,map:n.map,originalEvent:n.originalEvent,dragging:n.dragging}):this.dispatchEvent({type:"leave",coordinate:n.coordinate,pixel:n.pixel,map:n.map,originalEvent:n.originalEvent,dragging:n.dragging})),this.cursor_){var g=c.getTargetElement().style;m?g.cursor!=this.cursor_&&(this.previousCursor_=g.cursor,g.cursor=this.cursor_):this.previousCursor_!==void 0&&(g.cursor=this.previousCursor_,this.previousCursor_=void 0)}}},ol.interaction.LongTouch=function(n){n||(n={}),this.delay_=n.delay||1e3;var c=n.handleLongTouchEvent||function(){},h=null,u,d,m=n.pixelTolerance||0;ol.interaction.Interaction.call(this,{handleEvent:function(g){if(this.getActive())switch(g.type){case"pointerdown":{h&&clearTimeout(h),u=g.pixel,d={type:"longtouch",originalEvent:g.originalEvent,frameState:g.frameState,pixel:g.pixel,coordinate:g.coordinate,map:this.getMap()},h=setTimeout(function(){c(d),d.map.dispatchEvent(d)},this.delay_);break}case"pointerdrag":{h&&(Math.abs(g.pixel[0]-u[0])>m||Math.abs(g.pixel[1]-u[1])>m)&&(clearTimeout(h),h=null);break}case"pointerup":{h&&(clearTimeout(h),h=null);break}default:break}else h&&(clearTimeout(h),h=null);return!0}})},ol.ext.inherits(ol.interaction.LongTouch,ol.interaction.Interaction),ol.interaction.Modify.prototype.getModifiedFeatures=function(){var n={};this.dragSegments_.forEach(function(u){var d=u[0].feature;window.ol&&window.ol.util?n[ol.util.getUid(d)]=d:n[ol.getUid(d)]=d});var c=[];for(var h in n)c.push(n[h]);return c},ol.interaction.ModifyFeature=function(n){n||(n={});var c,h;ol.interaction.Pointer.call(this,{handleEvent:function(d){switch(d.type){case"pointerdown":return c=this.handleDownEvent(d),h=c||this._deleteCondition(d),!c;case"pointerup":return c=!1,this.handleUpEvent(d);case"pointerdrag":return c?this.handleDragEvent(d):!0;case"pointermove":return c?!0:this.handleMoveEvent(d);case"singleclick":case"click":return!h;default:return!0}}}),this.snapDistance_=n.pixelTolerance||10,this.tolerance_=1e-10,this.cursor_=n.cursor,this.sources_=n.sources?n.sources instanceof Array?n.sources:[n.sources]:[],n.source&&this.sources_.push(n.source),n.features&&this.sources_.push(new ol.source.Vector({features:n.features})),this.filterSplit_=n.filter||function(){return!0},this._condition=n.condition||ol.events.condition.primaryAction,this._deleteCondition=n.deleteCondition||ol.events.condition.altKeyOnly,this._insertVertexCondition=n.insertVertexCondition||ol.events.condition.always;var u=function(){return[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[0,153,255,1]}),stroke:new ol.style.Stroke({color:"#FFF",width:1.25})})})]};n.style&&(typeof n.style=="function"?u=n.style:u=function(){return n.style}),this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1}),name:"Modify overlay",displayInLayerSwitcher:!1,style:u,wrapX:n.wrapX})},ol.ext.inherits(ol.interaction.ModifyFeature,ol.interaction.Pointer),ol.interaction.ModifyFeature.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),ol.interaction.Interaction.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n)},ol.interaction.ModifyFeature.prototype.setActive=function(n){ol.interaction.Interaction.prototype.setActive.call(this,n),this.overlayLayer_&&this.overlayLayer_.getSource().clear()},ol.interaction.ModifyFeature.prototype.setFilter=function(n){typeof n=="function"?this.filterSplit_=n:n===void 0&&(this.filterSplit_=function(){return!0})},ol.interaction.ModifyFeature.prototype.getClosestFeature=function(n){for(var c,h,u=this.snapDistance_+1,d=0;d<this.sources_.length;d++){var m=this.sources_[d];if(c=m.getClosestFeatureToCoordinate(n.coordinate),c&&this.filterSplit_(c)){var g=c.getGeometry().getClosestPoint(n.coordinate),x=ol.coordinate.dist2d(n.coordinate,g)/n.frameState.viewState.resolution;x<u&&(u=x,h=g);break}}if(u>this.snapDistance_)return this.currentFeature&&this.dispatchEvent({type:"select",selected:[],deselected:[this.currentFeature]}),this.currentFeature=null,!1;var E=this.getNearestCoord(h,c.getGeometry());if(E){E=E.coord;var P=this.getMap().getPixelFromCoordinate(E);return ol.coordinate.dist2d(n.pixel,P)<this.snapDistance_&&(h=E),this.currentFeature!==c&&this.dispatchEvent({type:"select",selected:[c],deselected:[this.currentFeature]}),this.currentFeature=c,{source:m,feature:c,coord:h}}},ol.interaction.ModifyFeature.prototype.getNearestCoord=function(n,c){var h,u,d,m,g;switch(c.getType()){case"Point":return{coord:c.getCoordinates(),dist:ol.coordinate.dist2d(c.getCoordinates(),n)};case"MultiPoint":return this.getNearestCoord(n,new ol.geom.LineString(c.getCoordinates()));case"LineString":case"LinearRing":{var x;g=Number.MAX_VALUE;var E=c.getCoordinates();for(h=0;h<E.length;h++)x=ol.coordinate.dist2d(n,E[h]),x<g&&(g=x,m=E[h]);return{coord:m,dist:g}}case"MultiLineString":{var P=c.getLineStrings();for(m=!1,g=Number.MAX_VALUE,h=0;u=P[h];h++)d=this.getNearestCoord(n,u),d&&d.dist<g&&(m=d,g=d.dist,m.ring=h);return m}case"Polygon":{var L=c.getLinearRings();for(m=!1,g=Number.MAX_VALUE,h=0;u=L[h];h++)d=this.getNearestCoord(n,u),d&&d.dist<g&&(m=d,g=d.dist,m.ring=h);return m}case"MultiPolygon":{var F=c.getPolygons();for(m=!1,g=Number.MAX_VALUE,h=0;u=F[h];h++)d=this.getNearestCoord(n,u),d&&d.dist<g&&(m=d,g=d.dist,m.poly=h);return m}case"GeometryCollection":{var U=c.getGeometries();for(m=!1,g=Number.MAX_VALUE,h=0;u=U[h];h++)d=this.getNearestCoord(n,u),d&&d.dist<g&&(m=d,g=d.dist,m.geom=h);return m}default:return!1}},ol.interaction.ModifyFeature.prototype.getArcs=function(n,c){var h=!1,u,d,m,g,x;switch(n.getType()){case"Point":{ol.coordinate.equal(c,n.getCoordinates())&&(h={geom:n,type:n.getType(),coord1:[],coord2:[],node:!0});break}case"MultiPoint":{for(u=n.getCoordinates(),d=0;d<u.length;d++)if(ol.coordinate.equal(c,u[d])){h={geom:n,type:n.getType(),index:d,coord1:[],coord2:[],node:!0};break}break}case"LinearRing":case"LineString":{var E=n.getClosestPoint(c);if(ol.coordinate.dist2d(E,c)<1.5*this.tolerance_){var P;if(n.getType()==="LinearRing"?(x=new ol.geom.LineString(n.getCoordinates()),P=x.splitAt(c,this.tolerance_)):P=n.splitAt(c,this.tolerance_),P.length>2){for(u=P[1].getCoordinates(),d=2;m=P[d];d++){var L=m.getCoordinates();L.shift(),u=u.concat(L)}P=[P[0],new ol.geom.LineString(u)]}if(P.length===2){var F=P[0].getCoordinates(),U=P[1].getCoordinates(),A=F.length+U.length-1;F.pop(),U.shift(),h={geom:n,type:n.getType(),coord1:F,coord2:U,node:n.getCoordinates().length===A,closed:!1}}else if(P.length===1){m=P[0].getCoordinates();var G=ol.coordinate.equal(m[0],c),B=ol.coordinate.equal(m[m.length-1],c);G?(m.shift(),B&&m.pop(),h={geom:n,type:n.getType(),coord1:[],coord2:m,node:!0,closed:B}):B&&(m.pop(),h={geom:n,type:n.getType(),coord1:m,coord2:[],node:!0,closed:!1})}}break}case"MultiLineString":{var O=n.getLineStrings();for(d=0;g=O[d];d++)if(h=this.getArcs(g,c),h){h.geom=n,h.type=n.getType(),h.lstring=d;break}break}case"Polygon":{var K=n.getLinearRings();for(d=0;g=K[d];d++)if(h=this.getArcs(g,c),h){h.geom=n,h.type=n.getType(),h.index=d;break}break}case"MultiPolygon":{var Q=n.getPolygons();for(d=0;g=Q[d];d++)if(h=this.getArcs(g,c),h){h.geom=n,h.type=n.getType(),h.poly=d;break}break}case"GeometryCollection":{for(x=n.getGeometries(),d=0;g=x[d];d++)if(h=this.getArcs(g,c),h){h.geom=n,h.g=d,h.typeg=h.type,h.type=n.getType();break}break}default:{console.error("ol/interaction/ModifyFeature "+n.getType()+" not supported!");break}}return h},ol.interaction.ModifyFeature.prototype.handleDownEvent=function(n){if(!this.getActive())return!1;var c=this.getClosestFeature(n);if(c&&(this._condition(n)||this._deleteCondition(n))){var h=[];return this.arcs=[],this.sources_.forEach(function(u){var d=ol.extent.buffer(ol.extent.boundingExtent([c.coord]),this.tolerance_);h=h.concat(h,u.getFeaturesInExtent(d))}.bind(this)),this._modifiedFeatures=[],h.forEach(function(u){var d=this.getArcs(u.getGeometry(),c.coord);d&&(this._insertVertexCondition(n)||d.node)&&(d.feature=u,this._modifiedFeatures.push(u),this.arcs.push(d))}.bind(this)),this._modifiedFeatures.length?this._deleteCondition(n)?!this._removePoint(c,n):(this.dispatchEvent({type:"modifystart",coordinate:c.coord,originalEvent:n.originalEvent,features:this._modifiedFeatures}),this.handleDragEvent({coordinate:c.coord,originalEvent:n.originalEvent}),!0):!0}else return!1},ol.interaction.ModifyFeature.prototype.getModifiedFeatures=function(){return this._modifiedFeatures||[]},ol.interaction.ModifyFeature.prototype.removePoint=function(){this._removePoint({},{})},ol.interaction.ModifyFeature.prototype._getModification=function(n){var c=n.coord1.concat(n.coord2);switch(n.type){case"LineString":{if(n.closed&&c.push(c[0]),c.length>1&&n.geom.getCoordinates().length!=c.length)return n.coords=c,!0;break}case"MultiLineString":{if(n.closed&&c.push(c[0]),c.length>1){var h=n.geom.getCoordinates();if(h[n.lstring].length!=c.length)return h[n.lstring]=c,n.coords=h,!0}break}case"Polygon":{if(n.closed&&c.push(c[0]),c.length>3&&(h=n.geom.getCoordinates(),h[n.index].length!=c.length))return h[n.index]=c,n.coords=h,!0;break}case"MultiPolygon":{if(n.closed&&c.push(c[0]),c.length>3&&(h=n.geom.getCoordinates(),h[n.poly][n.index].length!=c.length))return h[n.poly][n.index]=c,n.coords=h,!0;break}case"GeometryCollection":{n.type=n.typeg;var u=n.geom,d=u.getGeometries();n.geom=d[n.g];var m=this._getModification(n);return u.setGeometries(d),n.geom=u,n.type="GeometryCollection",m}default:break}return!1},ol.interaction.ModifyFeature.prototype._removePoint=function(n,c){if(!this.arcs)return!1;this.overlayLayer_.getSource().clear();var h=!1;return this.arcs.forEach(function(u){h=h||this._getModification(u)}.bind(this)),h&&(this.dispatchEvent({type:"modifystart",coordinate:n.coord,originalEvent:c.originalEvent,features:this._modifiedFeatures}),this.arcs.forEach(function(u){if(u.geom.getType()==="GeometryCollection"){if(u.coords){var d=u.geom.getGeometries();d[u.g].setCoordinates(u.coords),u.geom.setGeometries(d)}}else u.coords&&u.geom.setCoordinates(u.coords)}.bind(this)),this.dispatchEvent({type:"modifyend",coordinate:n.coord,originalEvent:c.originalEvent,features:this._modifiedFeatures})),this.arcs=[],h},ol.interaction.ModifyFeature.prototype.handleUpEvent=function(n){return this.getActive()?(!this.arcs||!this.arcs.length||(this.overlayLayer_.getSource().clear(),this.dispatchEvent({type:"modifyend",coordinate:n.coordinate,originalEvent:n.originalEvent,features:this._modifiedFeatures}),this.arcs=[]),!0):!1},ol.interaction.ModifyFeature.prototype.setArcCoordinates=function(n,c){var h;switch(n.type){case"Point":{n.geom.setCoordinates(c[0]);break}case"MultiPoint":{h=n.geom.getCoordinates(),h[n.index]=c[0],n.geom.setCoordinates(h);break}case"LineString":{n.geom.setCoordinates(c);break}case"MultiLineString":{h=n.geom.getCoordinates(),h[n.lstring]=c,n.geom.setCoordinates(h);break}case"Polygon":{h=n.geom.getCoordinates(),h[n.index]=c,n.geom.setCoordinates(h);break}case"MultiPolygon":{h=n.geom.getCoordinates(),h[n.poly][n.index]=c,n.geom.setCoordinates(h);break}case"GeometryCollection":{n.type=n.typeg;var u=n.geom,d=u.getGeometries();n.geom=d[n.g],this.setArcCoordinates(n,c),u.setGeometries(d),n.geom=u,n.type="GeometryCollection";break}}},ol.interaction.ModifyFeature.prototype.handleDragEvent=function(n){if(!this.getActive())return!1;if(!this.arcs)return!0;this.overlayLayer_.getSource().clear();var c=new ol.Feature(new ol.geom.Point(n.coordinate));return this.overlayLayer_.getSource().addFeature(c),this.arcs.length&&(this.arcs.forEach(function(h){var u=h.coord1.concat([n.coordinate],h.coord2);h.closed&&u.push(n.coordinate),this.setArcCoordinates(h,u)}.bind(this)),this.dispatchEvent({type:"modifying",coordinate:n.coordinate,originalEvent:n.originalEvent,features:this._modifiedFeatures})),!0},ol.interaction.ModifyFeature.prototype.handleMoveEvent=function(n){if(!this.getActive())return!1;this.overlayLayer_.getSource().clear();var c=this.getClosestFeature(n);if(c){var h=new ol.Feature(new ol.geom.Point(c.coord));this.overlayLayer_.getSource().addFeature(h)}var u=n.map.getTargetElement();this.cursor_&&(c?u.style.cursor!=this.cursor_&&(this.previousCursor_=u.style.cursor,u.style.cursor=this.cursor_):this.previousCursor_!==void 0&&(u.style.cursor=this.previousCursor_,this.previousCursor_=void 0))},ol.interaction.ModifyFeature.prototype.getCurrentFeature=function(){return this.currentFeature},ol.interaction.ModifyTouch=function(n){var c=this;n||(n={}),this._popup=new ol.Overlay.Popup({popupClass:n.className||"modifytouch",positioning:n.positioning||"bottom-rigth",offsetBox:n.offsetBox||10}),this._source=n.source,this._features=n.features;var h=document.createElement("a");h.appendChild(document.createTextNode(n.title||"remove point")),h.onclick=function(){c.removePoint()},this.setPopupContent(h);var u=n.pixelTolerance||0,d=u+5;n.condition=function(m){var g=this.getMap().getFeaturesAtPixel(m.pixel,{hitTolerance:d}),x,E,P=!1;if(g){var L=this._features;if(!L){x=[m.pixel[0]-d,m.pixel[1]-d],E=[m.pixel[0]+d,m.pixel[1]+d],x=this.getMap().getCoordinateFromPixel(x),E=this.getMap().getCoordinateFromPixel(E);var F=ol.extent.boundingExtent([x,E]);L=this._source.getFeaturesInExtent(F)}L.getArray&&(L=L.getArray());for(var U=0,A;(A=g[U])&&!(L.indexOf(A)>=0);U++);if(A){x=m.pixel,E=A.getGeometry().getClosestPoint(m.coordinate),E=this.getMap().getPixelFromCoordinate(E);var G=x[0]-E[0],B=x[1]-E[1];P=Math.sqrt(G*G+B*B)<d}}return this.showDeleteBt(P?{type:"show",feature:A,coordinate:m.coordinate}:{type:"hide"}),!0},n.insertVertexCondition=function(){return this.showDeleteBt({type:"hide"}),!0},ol.interaction.Modify.call(this,n),this.on(["modifystart","modifyend"],function(){this.showDeleteBt({type:"hide",modifying:!0})}),this.set("usePopup",n.usePopup!==!1)},ol.ext.inherits(ol.interaction.ModifyTouch,ol.interaction.Modify),ol.interaction.ModifyTouch.prototype.setMap=function(n){this.getMap()&&this.getMap().removeOverlay(this._popup),ol.interaction.Modify.prototype.setMap.call(this,n),this.getMap()&&this.getMap().addOverlay(this._popup)},ol.interaction.ModifyTouch.prototype.setActive=function(n){ol.interaction.Modify.prototype.setActive.call(this,n),this.showDeleteBt({type:"hide"})},ol.interaction.ModifyTouch.prototype.removePoint=function(){new Date-this._timeout<200||(ol.interaction.Modify.prototype.removePoint.call(this),this.showDeleteBt({type:"hide"}))},ol.interaction.ModifyTouch.prototype.showDeleteBt=function(n){this.get("usePopup")&&n.type==="show"?this._popup.show(n.coordinate,this._menu):this._popup.hide(),n.type+="popup",this.dispatchEvent(n),this._timeout=new Date},ol.interaction.ModifyTouch.prototype.setPopupContent=function(n){this._menu=n},ol.interaction.ModifyTouch.prototype.getPopupContent=function(){return this._menu},ol.interaction.Offset=function(n){n||(n={}),ol.interaction.Pointer.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this._filter=n.filter,this.features_=n.features,this.layers_=n.layers?n.layers instanceof Array?n.layers:[n.layers]:null,this.set("duplicate",n.duplicate),this.source_=n.source,this._style=typeof n.style=="function"?n.style:function(){return n.style?n.style:ol.style.Style.defaultStyle(!0)},this.previousCursor_=!1},ol.ext.inherits(ol.interaction.Offset,ol.interaction.Pointer),ol.interaction.Offset.prototype.setMap=function(n){ol.interaction.Pointer.prototype.setMap.call(this,n)},ol.interaction.Offset.prototype.getFeatureAtPixel_=function(n){var c=this;return this.getMap().forEachFeatureAtPixel(n.pixel,function(h,u){var d;if(c._filter&&!c._filter(h,u))return!1;if(c.layers_){for(var m=0;m<c.layers_.length;m++)if(c.layers_[m]===u){d=h;break}}else c.features_?c.features_.forEach(function(F){F===h&&(d=h)}):d=h;var g=d.getGeometry().getType();if(d&&/Polygon|LineString/.test(g)){if(g==="Polygon"&&d.getGeometry().getCoordinates().length>1)return!1;var x=d.getGeometry().getClosestPoint(n.coordinate),E=x[0]-n.coordinate[0],P=x[1]-n.coordinate[1],L=Math.sqrt(E*E+P*P)/n.frameState.viewState.resolution;return L<5?{feature:d,hit:x,coordinates:d.getGeometry().getCoordinates(),geom:d.getGeometry().clone(),geomType:g}:!1}else return!1},{hitTolerance:5})},ol.interaction.Offset.prototype.handleDownEvent_=function(n){return this.current_=this.getFeatureAtPixel_(n),this.current_?(this.currentStyle_=this.current_.feature.getStyle(),this.source_&&(this.get("duplicate")||n.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.current_.feature.setStyle(this._style(this.current_.feature)),this.source_.addFeature(this.current_.feature)):(this.current_.feature.setStyle(this._style(this.current_.feature)),this._modifystart=!0),this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0):!1},ol.interaction.Offset.prototype.handleDragEvent_=function(n){this._modifystart&&(this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),this._modifystart=!1);var c=this.current_.geom.getClosestPoint(n.coordinate),h=ol.coordinate.dist2d(c,n.coordinate),u,d,m,g;switch(this.current_.geomType){case"Polygon":{if(u=ol.coordinate.findSegment(c,this.current_.coordinates[0]).segment,u){d=[u[1][0]-u[0][0],u[1][1]-u[0][1]],m=[n.coordinate[0]-c[0],n.coordinate[1]-c[1]],d[0]*m[1]-d[1]*m[0]>0&&(h=-h),g=[];for(var x=0;x<this.current_.coordinates.length;x++)g.push(ol.coordinate.offsetCoords(this.current_.coordinates[x],x==0?h:-h));this.current_.feature.setGeometry(new ol.geom.Polygon(g))}break}case"LineString":{u=ol.coordinate.findSegment(c,this.current_.coordinates).segment,u&&(d=[u[1][0]-u[0][0],u[1][1]-u[0][1]],m=[n.coordinate[0]-c[0],n.coordinate[1]-c[1]],d[0]*m[1]-d[1]*m[0]>0&&(h=-h),g=ol.coordinate.offsetCoords(this.current_.coordinates,h),this.current_.feature.setGeometry(new ol.geom.LineString(g)));break}default:break}this.dispatchEvent({type:"offsetting",feature:this.current_.feature,offset:h,segment:[c,n.coordinate],coordinate:n.coordinate})},ol.interaction.Offset.prototype.handleUpEvent_=function(n){this._modifystart||this.dispatchEvent({type:"offsetend",feature:this.current_.feature,coordinate:n.coordinate}),this.current_.feature.setStyle(this.currentStyle_),this.current_=!1},ol.interaction.Offset.prototype.handleMoveEvent_=function(n){var c=this.getFeatureAtPixel_(n);c?(this.previousCursor_===!1&&(this.previousCursor_=n.map.getTargetElement().style.cursor),n.map.getTargetElement().style.cursor="pointer"):(n.map.getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=!1)},ol.interaction.Ripple=function(n){ol.interaction.Pointer.call(this,{handleDownEvent:this.rainDrop,handleMoveEvent:this.rainDrop}),n=n||{},this.riprad=n.radius||3,this.ripplemap=[],this.last_map=[],this.rains(this.interval),n.layer.on(["postcompose","postrender"],this.postcompose_.bind(this))},ol.ext.inherits(ol.interaction.Ripple,ol.interaction.Pointer),ol.interaction.Ripple.prototype.rains=function(n){this.onrain&&clearTimeout(this.onrain);var c=this,h=(typeof n=="number"?n:1e3)/2,u=3*h/2,d=Math.random;function m(){c.width&&c.rainDrop([d()*c.width,d()*c.height]),c.onrain=setTimeout(m,d()*h+u)}u&&m()},ol.interaction.Ripple.prototype.rainDrop=function(n){if(this.width){var c,h;n.pixel?(c=n.pixel[0]*this.ratio,h=n.pixel[1]*this.ratio):(c=n[0]*this.ratio,h=n[1]*this.ratio),c<<=0,h<<=0;for(var u=h-this.riprad*this.ratio;u<h+this.riprad*this.ratio;u++)for(var d=c-this.riprad*this.ratio;d<c+this.riprad*this.ratio;d++)this.ripplemap[this.oldind+u*this.width+d]+=128}},ol.interaction.Ripple.prototype.postcompose_=function(n){var c=n.context,h=c.canvas;if(this.width!=h.width||this.height!=h.height){this.width=h.width,this.height=h.height,this.ratio=n.frameState.pixelRatio,this.half_width=this.width>>1,this.half_height=this.height>>1,this.size=this.width*(this.height+2)*2,this.oldind=this.width,this.newind=this.width*(this.height+3);for(var u=0;u<this.size;u++)this.last_map[u]=this.ripplemap[u]=0}this.texture=c.getImageData(0,0,this.width,this.height),this.ripple=c.getImageData(0,0,this.width,this.height);var d,m,g,x,E,P=this.oldind;this.oldind=this.newind,this.newind=P,u=0;for(var L=this.ripple.data,F=this.texture.data,U=0;U<this.height;U++)for(var A=0;A<this.width;A++){var G=this.newind+u,B=this.oldind+u;g=this.ripplemap[B-this.width]+this.ripplemap[B+this.width]+this.ripplemap[B-1]+this.ripplemap[B+1]>>1,g-=this.ripplemap[G],g-=g>>5,this.ripplemap[G]=g,g=1024-g,this.last_map[u]!=g&&(this.last_map[u]=g,d=((A-this.half_width)*g/1024<<0)+this.half_width,m=((U-this.half_height)*g/1024<<0)+this.half_height,d>=this.width&&(d=this.width-1),d<0&&(d=0),m>=this.height&&(m=this.height-1),m<0&&(m=0),E=(d+m*this.width)*4,x=u*4,L[x]=F[E],L[x+1]=F[E+1],L[x+2]=F[E+2]),++u}c.putImageData(this.ripple,0,0),this.getMap().render()},ol.interaction.SelectCluster=function(n){n=n||{},this.pointRadius=n.pointRadius||12,this.circleMaxObjects=n.circleMaxObjects||10,this.maxObjects=n.maxObjects||60,this.spiral=n.spiral!==!1,this.animate=n.animate,this.animationDuration=n.animationDuration||500,this.selectCluster_=n.selectCluster!==!1,this._autoClose=n.autoClose!==!1;var c=this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({features:new ol.Collection,wrapX:n.wrapX,useSpatialIndex:!0}),name:"Cluster overlay",updateWhileAnimating:!0,updateWhileInteracting:!0,displayInLayerSwitcher:!1,style:n.featureStyle});if(n.layers)if(typeof n.layers=="function"){var h=n.layers;n.layers=function(d){return d===c||h(d)}}else n.layers.push&&n.layers.push(this.overlayLayer_);if(n.filter){var u=n.filter;n.filter=function(d,m){return!m&&d.get("selectclusterlink")?!1:u(d,m)}}else n.filter=function(d,m){return!(!m&&d.get("selectclusterlink"))};this.filter_=n.filter,!this._autoClose&&!n.toggleCondition&&(n.toggleCondition=ol.events.condition.singleClick),ol.interaction.Select.call(this,n),this.on("select",this.selectCluster.bind(this))},ol.ext.inherits(ol.interaction.SelectCluster,ol.interaction.Select),ol.interaction.SelectCluster.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.interaction.Select.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n),n&&n.getView()&&(this._listener=n.getView().on("change:resolution",this.clear.bind(this)))},ol.interaction.SelectCluster.prototype.clear=function(){this.getFeatures().clear(),this.overlayLayer_.getSource().clear()},ol.interaction.SelectCluster.prototype.getLayer=function(){return this.overlayLayer_},ol.interaction.SelectCluster.prototype.selectCluster=function(n){if(n instanceof ol.Feature&&(n={selected:[n]}),!n.selected.length){if(this._autoClose)this.clear();else{var c=n.deselected;c.forEach(Q=>{var et=Q.get("selectcluserfeatures");et&&et.forEach(lt=>{this.overlayLayer_.getSource().removeFeature(lt)})})}return}var h=n.selected[0];if(!h.get("selectclusterfeature")){var u=this.overlayLayer_.getSource();this._autoClose&&u.clear();var d=h.get("features");if(!(!d||d.length==1)){this.selectCluster_||this.getFeatures().clear();var m=h.getGeometry().getCoordinates(),g=this.getMap().getView().getResolution(),x,E,P,L,F,U,A,G=[];if(!this.spiral||d.length<=this.circleMaxObjects)for(L=Math.min(d.length,this.circleMaxObjects),x=g*this.pointRadius*(.5+L/4),P=0;P<L;P++)E=2*Math.PI*P/L,(L==2||L==4)&&(E+=Math.PI/4),F=[m[0]+x*Math.sin(E),m[1]+x*Math.cos(E)],U=new ol.Feature({selectclusterfeature:!0,features:[d[P]],geometry:new ol.geom.Point(F)}),U.setStyle(d[P].getStyle()),G.push(U),A=new ol.Feature({selectclusterlink:!0,geometry:new ol.geom.LineString([m,F])}),G.push(A);else{E=0;var B=2*this.pointRadius;for(L=Math.min(this.maxObjects,d.length),P=0;P<L;P++){x=B/2+B*E/(2*Math.PI),E=E+(B+.1)/x;var O=g*x*Math.sin(E),K=g*x*Math.cos(E);F=[m[0]+O,m[1]+K],U=new ol.Feature({selectclusterfeature:!0,features:[d[P]],geometry:new ol.geom.Point(F)}),U.setStyle(d[P].getStyle()),G.push(U),A=new ol.Feature({selectclusterlink:!0,geometry:new ol.geom.LineString([m,F])}),G.push(A)}}h.set("selectcluserfeatures",G),this.animate?this.animateCluster_(m,G):u.addFeatures(G)}}},ol.interaction.SelectCluster.prototype.animateCluster_=function(n,c){if(this.listenerKey_&&ol.Observable.unByKey(this.listenerKey_),!c.length)return;var h=this.overlayLayer_.getStyle(),u=typeof h=="function"?h:h.length?function(){return h}:function(){return[h]},d=this.animationDuration||500,m=new Date().getTime();function g(E){for(var P=E.vectorContext||ol.render.getVectorContext(E),L=E.frameState.pixelRatio,F=this.getMap().getView().getResolution(),U=ol.easing.easeOut((E.frameState.time-m)/d),A=0,G;G=c[A];A++)if(G.get("features")){var B=G.getGeometry().getCoordinates();B[0]=n[0]+U*(B[0]-n[0]),B[1]=n[1]+U*(B[1]-n[1]);for(var O=new ol.geom.Point(B),K=u(G,F),Q=0;Q<K.length;Q++){var et,lt=ol.Map.prototype.getFeaturesAtPixel?!1:K[Q].getImage();lt&&(et=lt.getScale(),lt.setScale(L)),P.setStyle?(P.setStyle(K[Q]),P.drawGeometry(O)):(P.setImageStyle(lt),P.drawPointGeometry(O)),lt&&lt.setScale(et)}}if(U>1){ol.Observable.unByKey(this.listenerKey_),this.overlayLayer_.getSource().addFeatures(c),this.overlayLayer_.changed();return}E.frameState.animate=!0}this.listenerKey_=this.overlayLayer_.on(["postcompose","postrender"],g.bind(this));var x=new ol.Feature(new ol.geom.Point(this.getMap().getView().getCenter()));x.setStyle(new ol.style.Style({image:new ol.style.Circle({})})),this.overlayLayer_.getSource().addFeature(x)},ol.interaction.SelectCluster.prototype.getClusterExtent=function(n){if(!n.get("features"))return null;var c=ol.extent.createEmpty();return n.get("features").forEach(function(h){c=ol.extent.extend(c,h.getGeometry().getExtent())}),c[0]===c[2]&&c[1]===c[3]?null:c},ol.interaction.SnapGuides=function(n){n||(n={});function c(m,g){var x=m[1][0]-m[0][0],E=m[1][1]-m[0][1],P=g[1][0]-g[0][0],L=g[1][1]-g[0][1],F=x*L-E*P;if(F!=0){var U=(x*m[0][1]-x*g[0][1]-E*m[0][0]+E*g[0][0])/F;return[g[0][0]+U*P,g[0][1]+U*L]}else return!1}function h(m,g){var x=m[0]-g[0],E=m[1]-g[1];return Math.sqrt(x*x+E*E)}this.snapDistance_=n.pixelTolerance||10,this.enableInitialGuides_=n.enableInitialGuides||!1;var u=[new ol.style.Style({stroke:new ol.style.Stroke({color:"#ffcc33",lineDash:[8,5],width:1.25})})];n.style&&(u=n.style instanceof Array?n.style:[n.style]),this.overlaySource_=new ol.source.Vector({features:new ol.Collection,useSpatialIndex:!1});var d=n.vectorClass||ol.layer.Vector;this.overlayLayer_=new d({renderMode:"image",source:this.overlaySource_,style:function(){return u},name:"Snap overlay",displayInLayerSwitcher:!1}),ol.interaction.Interaction.call(this,{handleEvent:function(m){if(this.getActive()){for(var g=this.overlaySource_.getFeatures(),x=null,E=null,P=m.frameState.viewState.resolution,L=0,F;F=g[L];L++){var U=F.getGeometry().getClosestPoint(m.coordinate);if(h(U,m.coordinate)/P<this.snapDistance_){if(x){var A=c(x.getGeometry().getCoordinates(),F.getGeometry().getCoordinates());A&&h(A,m.coordinate)/P<this.snapDistance_&&(E=A)}else E=U;x=F}}E&&(m.coordinate=E)}return!0}})},ol.ext.inherits(ol.interaction.SnapGuides,ol.interaction.Interaction),ol.interaction.SnapGuides.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),ol.interaction.Interaction.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n),n&&(this.projExtent_=n.getView().getProjection().getExtent())},ol.interaction.SnapGuides.prototype.setActive=function(n){this.overlayLayer_.setVisible(n),ol.interaction.Interaction.prototype.setActive.call(this,n)},ol.interaction.SnapGuides.prototype.clearGuides=function(n){if(!n)this.overlaySource_.clear();else for(var c=0,h;h=n[c];c++)try{this.overlaySource_.removeFeature(h)}catch{}},ol.interaction.SnapGuides.prototype.getGuides=function(){return this.overlaySource_.getFeaturesCollection()},ol.interaction.SnapGuides.prototype.addGuide=function(n,c){if(n){var h=this.getMap(),u=h.getView().calculateExtent(h.getSize()),d=Math.max(this.projExtent_[2]-this.projExtent_[0],this.projExtent_[3]-this.projExtent_[1]);u=ol.extent.buffer(u,d*1.5),u[0]<this.projExtent_[0]&&(u[0]=this.projExtent_[0]),u[1]<this.projExtent_[1]&&(u[1]=this.projExtent_[1]),u[2]>this.projExtent_[2]&&(u[2]=this.projExtent_[2]),u[3]>this.projExtent_[3]&&(u[3]=this.projExtent_[3]);var m=n[0][0]-n[1][0],g=n[0][1]-n[1][1],x=1/Math.sqrt(m*m+g*g),E=function(F){for(var U,A=[],G=d*F*2,B=0;(F>0?B<G:B>G)&&(c?U=[n[0][0]+g*x*B,n[0][1]-m*x*B]:U=[n[0][0]+m*x*B,n[0][1]+g*x*B],ol.extent.containsCoordinate(u,U));B+=d*F/100)A.push(U);return new ol.Feature(new ol.geom.LineString([A[0],A[A.length-1]]))},P=E(1),L=E(-1);return this.overlaySource_.addFeature(P),this.overlaySource_.addFeature(L),[P,L]}},ol.interaction.SnapGuides.prototype.addOrthoGuide=function(n){return this.addGuide(n,!0)},ol.interaction.SnapGuides.prototype.setDrawInteraction=function(n){var c=this,h=0,u=[];function d(m){var g=m.target.getCoordinates(),x=2;switch(m.target.getType()){case"Point":return;case"Polygon":g=g[0].slice(0,-1);break;default:break}var E=g.length;if(E===x&&c.enableInitialGuides_){var P=g[0][0],L=g[0][1];g=[[P,L],[P,L-1]]}if(E!=h&&(c.enableInitialGuides_?E>=x:E>x)){c.clearGuides(u);try{var F=g[E-x],U=g[E-x-1];E>x&&!(F[0]===U[0]&&F[1]===U[1])&&(u=c.addOrthoGuide([g[E-x],g[E-x-1]])),u=u.concat(c.addGuide([g[0],g[1]])),u=u.concat(c.addOrthoGuide([g[0],g[1]])),h=E}catch{}}}n.on("drawstart",function(m){m.feature.getGeometry().on("change",d)}),n.on(["drawend","change:active"],function(m){c.clearGuides(u),m.feature&&m.feature.getGeometry().un("change",d),h=0,u=[]})},ol.interaction.SnapGuides.prototype.setModifyInteraction=function(n){function c(x,E){return(x%E+E)%E}var h=this,u=[];function d(x){var E=x.target.vertexFeature_;if(E){var P=x.target.getModifiedFeatures()[0],L=P.getGeometry(),F=L.getCoordinates();switch(L.getType()){case"Point":return;case"Polygon":F=F[0].slice(0,-1);break;default:break}var U=E.getGeometry().getCoordinates(),A=F.findIndex(function(B){return B[0]===U[0]&&B[1]===U[1]}),G=F.length;h.clearGuides(u),u=h.addOrthoGuide([F[c(A-1,G)],F[c(A-2,G)]]),u=u.concat(h.addGuide([F[c(A-1,G)],F[c(A-2,G)]])),u=u.concat(h.addGuide([F[c(A+1,G)],F[c(A+2,G)]])),u=u.concat(h.addOrthoGuide([F[c(A+1,G)],F[c(A+2,G)]]))}}function m(x){setTimeout(d,0,x)}function g(){h.clearGuides(u),u=[]}n.on("modifystart",m),n.on("modifyend",g)},ol.interaction.SnapLayerPixel=function(n){n=n||{},this._layer=n.layer,this._layer.on(["postcompose","postrender"],function(u){this._ctx=u.context}.bind(this));var c=n.radius||8,h=2*c;ol.interaction.Interaction.call(this,{handleEvent:function(u){if(this._layer.getVisible()&&this._layer.getOpacity()&&ol.events.condition.altKeyOnly(u)&&this.getMap()){var d=u.pixel[0]-c,m=u.pixel[1]-c,g=this._ctx.getImageData(d,m,h,h),x=g.data,E,P,L,F,U=-1,A=[];for(E=0;E<h;E++)for(A.push([]),P=0;P<h;P++){var G=x[3+4*(E+P*h)];A[E].push(G>10?G:0)}for(E=1;E<h-1;E++)for(P=1;P<h-1;P++){var B=A[E][P+1]+A[E][P]+A[E][P+1]+A[E-1][P-1]+A[E-1][P]+A[E-1][P+1]+A[E+1][P-1]+A[E+1][P]+A[E+1][P+1];B>U&&(U=B,L=E,F=P)}u.pixel=[d+L,m+F],u.coordinate=this.getMap().getCoordinateFromPixel(u.pixel)}return!0}})},ol.ext.inherits(ol.interaction.SnapLayerPixel,ol.interaction.Interaction),ol.interaction.Split=function(n){n||(n={}),ol.interaction.Interaction.call(this,{handleEvent:function(E){switch(E.type){case"singleclick":return this.handleDownEvent(E);case"pointermove":return this.handleMoveEvent(E);default:return!0}}}),this.snapDistance_=n.snapDistance||25,this.tolerance_=n.tolerance||1e-10,this.cursor_=n.cursor,this.setSources(n.sources),n.features&&this.sources_.push(new ol.source.Vector({features:n.features})),this.filterSplit_=n.filter||function(){return!0};var c=[255,255,255,1],h=[0,153,255,1],u=3,d=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),m=new ol.style.Stroke({color:"#3399CC",width:1.25}),g=[new ol.style.Style({image:new ol.style.Circle({fill:d,stroke:m,radius:5}),fill:d,stroke:m})],x=[new ol.style.Style({stroke:new ol.style.Stroke({color:c,width:u+2})}),new ol.style.Style({image:new ol.style.Circle({radius:2*u,fill:new ol.style.Fill({color:h}),stroke:new ol.style.Stroke({color:c,width:u/2})}),stroke:new ol.style.Stroke({color:h,width:u})})];n.sketchStyle&&(g=n.sketchStyle instanceof Array?n.sketchStyle:[n.sketchStyle]),n.featureStyle&&(x=n.featureStyle instanceof Array?n.featureStyle:[n.featureStyle]),this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({useSpatialIndex:!1}),name:"Split overlay",displayInLayerSwitcher:!1,style:function(E){return E._sketch_?g:x}})},ol.ext.inherits(ol.interaction.Split,ol.interaction.Interaction),ol.interaction.Split.prototype.setMap=function(n){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),ol.interaction.Interaction.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n)},ol.interaction.Split.prototype.getSources=function(){if(!this.sources_&&this.getMap()){let h=function(u){u.forEach(function(d){d.getVisible()&&(d.getSource&&d.getSource()instanceof ol.source.Vector?n.unshift(d.getSource()):d.getLayers&&h(d.getLayers()))})};var c=h,n=[];return h(this.getMap().getLayers()),n}return this.sources_||[]},ol.interaction.Split.prototype.setSources=function(n){this.sources_=n?n instanceof Array?n||!1:[n]:!1},ol.interaction.Split.prototype.getClosestFeature=function(n){var c,h,u,d,m=this.snapDistance_+1;if(this.getSources().forEach(function(E){var P=E.getClosestFeatureToCoordinate(n.coordinate);if(P&&P.getGeometry().splitAt){var L=P.getGeometry().getClosestPoint(n.coordinate),F=new ol.geom.LineString([n.coordinate,L]),U=F.getLength()/n.frameState.viewState.resolution;U<m&&(c=E,m=U,h=P,d=F,u=L)}}),m>this.snapDistance_)return!1;var g=this.getNearestCoord(u,h.getGeometry().getCoordinates()),x=this.getMap().getPixelFromCoordinate(g);return ol.coordinate.dist2d(n.pixel,x)<this.snapDistance_&&(u=g),{source:c,feature:h,coord:u,link:d}},ol.interaction.Split.prototype.getNearestCoord=function(n,c){for(var h,u=Number.MAX_VALUE,d,m=0;m<c.length;m++)h=ol.coordinate.dist2d(n,c[m]),h<u&&(u=h,d=c[m]);return d},ol.interaction.Split.prototype.handleDownEvent=function(n){var c=this.getClosestFeature(n);if(c){var h=this;h.overlayLayer_.getSource().clear();var u=c.feature.getGeometry().splitAt(c.coord,this.tolerance_),d;if(u.length>1){var m=[];for(d=0;d<u.length;d++){var g=c.feature.clone();g.setGeometry(u[d]),m.push(g)}for(h.dispatchEvent({type:"beforesplit",original:c.feature,features:m}),c.source.dispatchEvent({type:"beforesplit",original:c.feature,features:m}),c.source.removeFeature(c.feature),d=0;d<m.length;d++)c.source.addFeature(m[d]);h.dispatchEvent({type:"aftersplit",original:c.feature,features:m}),c.source.dispatchEvent({type:"aftersplit",original:c.feature,features:m})}}return!1},ol.interaction.Split.prototype.handleMoveEvent=function(n){var c=n.map;this.overlayLayer_.getSource().clear();var h=this.getClosestFeature(n);if(h&&this.filterSplit_(h.feature)){var u,d;this.overlayLayer_.getSource().addFeature(h.feature),u=new ol.Feature(new ol.geom.Point(h.coord)),u._sketch_=!0,this.overlayLayer_.getSource().addFeature(u),d=new ol.Feature(h.link),d._sketch_=!0,this.overlayLayer_.getSource().addFeature(d),this.dispatchEvent({type:"pointermove",coordinate:n.coordinate,frameState:n.frameState,originalEvent:n.originalEvent,map:n.map,pixel:n.pixel,feature:h.feature,linkGeometry:h.link})}else this.dispatchEvent(n);var m=c.getTargetElement();this.cursor_&&(h?m.style.cursor!=this.cursor_&&(this.previousCursor_=m.style.cursor,m.style.cursor=this.cursor_):this.previousCursor_!==void 0&&(m.style.cursor=this.previousCursor_,this.previousCursor_=void 0))},ol.interaction.Splitter=function(n){n||(n={}),ol.interaction.Interaction.call(this,{handleEvent:function(h){return h.type!="pointermove"&&h.type!="pointerdrag"?(this.lastEvent_&&(this.splitSource(this.lastEvent_.feature),this.lastEvent_=null),this.moving_=!1):this.moving_=!0,!0}}),this.added_=[],this.removed_=[],n.features?this.source_=new ol.source.Vector({features:n.features}):this.source_=n.source?n.source:new ol.source.Vector({features:new ol.Collection});var c=this.triggerSource;n.triggerFeatures&&(c=new ol.source.Vector({features:n.triggerFeatures})),c?(c.on("addfeature",this.onAddFeature.bind(this)),c.on("changefeature",this.onChangeFeature.bind(this)),c.on("removefeature",this.onRemoveFeature.bind(this))):(this.source_.on("addfeature",this.onAddFeature.bind(this)),this.source_.on("changefeature",this.onChangeFeature.bind(this)),this.source_.on("removefeature",this.onRemoveFeature.bind(this))),this.tolerance_=n.tolerance||1e-10,this.filterSplit_=n.filter||function(){return!0}},ol.ext.inherits(ol.interaction.Splitter,ol.interaction.Interaction),ol.interaction.Splitter.prototype.intersectSegs=function(n,c){var h=this.tolerance_,u=n[0][0]-n[1][0],d=c[0][0]-c[1][0],m=n[0][1]-n[1][1],g=c[0][1]-c[1][1],x=u*g-m*d;if(Math.abs(x)<h)return!1;var E=((n[0][0]-c[1][0])*g-(n[0][1]-c[1][1])*d)/x;if(Math.abs(E)<h)return n[0];if(Math.abs(1-E)<h)return n[1];if(E<0||E>1)return!1;var P=((n[0][1]-c[1][1])*u-(n[0][0]-c[1][0])*m)/x;if(Math.abs(P)<h)return c[1];if(Math.abs(1-P)<h)return c[0];if(P<0||P>1)return!1;var L=n[0][0]*n[1][1]-n[0][1]*n[1][0],F=c[0][0]*c[1][1]-c[0][1]*c[1][0],U=[(L*d-F*u)/x,(L*g-F*m)/x];return U},ol.interaction.Splitter.prototype.splitSource=function(n,c){this.getActive()&&(this.splitting||(this.source_.dispatchEvent({type:"beforesplit",feaure:n,source:this.source_}),this.dispatchEvent({type:"beforesplit",feaure:n,source:this.source_}),c?this._splitSource(n):setTimeout(function(){this._splitSource(n)}.bind(this))))},ol.interaction.Splitter.prototype._splitSource=function(n){var c,h,u;this.splitting=!0,this.added_=[],this.removed_=[];var d=n.getGeometry().getCoordinates(),m,g=[];function x(O){if(O!==n)for(var K=O.getGeometry().getCoordinates(),Q=0;Q<K.length-1;Q++){var et=this.intersectSegs(m,[K[Q],K[Q+1]]);if(et&&(g.push(et),P=O.getGeometry().splitAt(et,this.tolerance_),P&&P.length>1))return L=O,!0}return!1}for(c=0;c<d.length-1;c++){m=[d[c],d[c+1]];for(var E=ol.extent.buffer(ol.extent.boundingExtent(m),this.tolerance_),P;;){var L=!1;if(this.source_.forEachFeatureIntersectingExtent(E,x.bind(this)),L){var F=L;for(this.source_.removeFeature(F),h=0;h<P.length;h++)u=F.clone(),u.setGeometry(P[h]),this.source_.addFeature(u)}else break}}for(c=0;c<d.length-2;c++)for(var U=c+1;U<d.length-1;U++){var A=this.intersectSegs([d[c],d[c+1]],[d[U],d[U+1]]);A&&A!=d[c+1]&&g.push(A)}var G=!1;if(g.length){var B=n.getGeometry().splitAt(g,this.tolerance_);if(B.length>1){for(h=0;h<B.length;h++)u=n.clone(),u.setGeometry(B[h]),this.source_.addFeature(u);G=!0}}setTimeout(function(){G&&this.source_.removeFeature(n),this.source_.dispatchEvent({type:"aftersplit",featureAdded:this.added_,featureRemoved:this.removed_,source:this.source_}),this.dispatchEvent({type:"aftersplit",featureAdded:this.added_,featureRemoved:this.removed_,source:this.source_}),this.splitting=!1}.bind(this))},ol.interaction.Splitter.prototype.onAddFeature=function(n){this.splitSource(n.feature),this.splitting&&this.added_.push(n.feature)},ol.interaction.Splitter.prototype.onRemoveFeature=function(n){if(this.splitting){var c=this.added_.indexOf(n.feature);c==-1?this.removed_.push(n.feature):this.added_.splice(c,1)}},ol.interaction.Splitter.prototype.onChangeFeature=function(n){this.moving_?this.lastEvent_=n:this.splitSource(n.feature,!0)},ol.interaction.Synchronize=function(n){n||(n={});var c=this;ol.interaction.Interaction.call(this,{handleEvent:function(h){return h.type=="pointermove"&&c.handleMove_(h),!0}}),this.maps=n.maps||[],n.active===!1&&this.setActive(!1)},ol.ext.inherits(ol.interaction.Synchronize,ol.interaction.Interaction),ol.interaction.Synchronize.prototype.setMap=function(n){this._listener&&(ol.Observable.unByKey(this._listener.center),ol.Observable.unByKey(this._listener.rotation),ol.Observable.unByKey(this._listener.resolution),this.getMap().getTargetElement().removeEventListener("mouseout",this._listener.mouseout)),this._listener=null,ol.interaction.Interaction.prototype.setMap.call(this,n),n&&(this._listener={},this._listener.center=this.getMap().getView().on("change:center",this.syncMaps.bind(this)),this._listener.rotation=this.getMap().getView().on("change:rotation",this.syncMaps.bind(this)),this._listener.resolution=this.getMap().getView().on("change:resolution",this.syncMaps.bind(this)),this._listener.mouseout=this.handleMouseOut_.bind(this),this.getMap().getTargetElement()&&this.getMap().getTargetElement().addEventListener("mouseout",this._listener.mouseout),this.syncMaps())},ol.interaction.Synchronize.prototype.setActive=function(n){ol.interaction.Interaction.prototype.setActive.call(this,n),this.syncMaps()},ol.interaction.Synchronize.prototype.syncMaps=function(){if(this.getActive()){var n=this.getMap();if(n){if(n.get("lockView"))return;for(var c=0;c<this.maps.length;c++)this.maps[c].set("lockView",!0),this.maps[c].getView().getRotation()!=n.getView().getRotation()&&this.maps[c].getView().setRotation(n.getView().getRotation()),this.maps[c].getView().getCenter()!=n.getView().getCenter()&&this.maps[c].getView().setCenter(n.getView().getCenter()),this.maps[c].getView().getResolution()!=n.getView().getResolution()&&this.maps[c].getView().setResolution(n.getView().getResolution()),this.maps[c].set("lockView",!1)}}},ol.interaction.Synchronize.prototype.handleMove_=function(n){for(var c=0;c<this.maps.length;c++)this.maps[c].showTarget(n.coordinate);this.getMap().showTarget()},ol.interaction.Synchronize.prototype.handleMouseOut_=function(){for(var n=0;n<this.maps.length;n++)this.maps[n]._targetOverlay&&this.maps[n]._targetOverlay.setPosition(void 0)},ol.Map.prototype.showTarget=function(n){if(!this._targetOverlay){var c=document.createElement("div");c.classList.add("ol-target"),this._targetOverlay=new ol.Overlay({element:c}),this._targetOverlay.setPositioning("center-center"),this.addOverlay(this._targetOverlay),c.parentElement.classList.add("ol-target-overlay"),this._targetOverlay.setPosition([0,0])}this._targetOverlay.setPosition(n)},ol.Map.prototype.hideTarget=function(){this.removeOverlay(this._targetOverlay),this._targetOverlay=void 0},ol.interaction.TinkerBell=function(n){n=n||{},ol.interaction.Pointer.call(this,{handleDownEvent:this.onMove,handleMoveEvent:this.onMove}),this.set("color",n.color?ol.color.asString(n.color):"#fff"),this.sparkle=[0,0],this.sparkles=[],this.lastSparkle=this.time=new Date;var c=this;this.out_=function(){c.isout_=!0},this.isout_=!0},ol.ext.inherits(ol.interaction.TinkerBell,ol.interaction.Pointer),ol.interaction.TinkerBell.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,this.getMap()&&(n.getViewport().removeEventListener("mouseout",this.out_,!1),this.getMap().render()),ol.interaction.Pointer.prototype.setMap.call(this,n),n&&(this._listener=n.on("postcompose",this.postcompose_.bind(this)),n.getViewport().addEventListener("mouseout",this.out_,!1))},ol.interaction.TinkerBell.prototype.onMove=function(n){this.sparkle=n.pixel,this.isout_=!1,this.getMap().render()},ol.interaction.TinkerBell.prototype.postcompose_=function(n){var c=15,h=n.context||ol.ext.getMapCanvas(this.getMap()).getContext("2d"),u=n.frameState.time-this.time;this.time=n.frameState.time,n.frameState.time-this.lastSparkle>30&&!this.isout_&&(this.lastSparkle=n.frameState.time,this.sparkles.push({p:[this.sparkle[0]+Math.random()*c-c/2,this.sparkle[1]+Math.random()*c],o:1})),h.save(),h.scale(n.frameState.pixelRatio,n.frameState.pixelRatio),h.fillStyle=this.get("color");for(var d=this.sparkles.length-1,m;m=this.sparkles[d];d--){if(m.o<.2){this.sparkles.splice(0,d+1);break}h.globalAlpha=m.o,h.beginPath(),h.arc(m.p[0],m.p[1],2.2,0,2*Math.PI,!1),h.fill(),m.o*=.98,m.p[0]+=Math.random()-.5,m.p[1]+=u*(1+Math.random())/30}h.restore(),this.sparkles.length&&this.getMap().render()},ol.interaction.TouchCompass=function(n){n=n||{};var c={};if(c.handleDownEvent=function(E){var P=this.getCenter_(),L=E.pixel[0]-P[0],F=E.pixel[1]-P[1];return this.start=E,Math.sqrt(L*L+F*F)<this.size/2},c.handleDragEvent=function(E){if(!this.pos){this.pos=this.start;try{this.getMap().renderSync()}catch{}}this.pos=E},c.handleUpEvent=function(){return this.pos=!1,!0},ol.interaction.Pointer.call(this,c),this.ondrag_=n.onDrag,this.size=n.size||80,this.alpha=n.alpha||.5,!ol.interaction.TouchCompass.prototype.compass){var h=ol.interaction.TouchCompass.prototype.compass=document.createElement("canvas"),u=h.getContext("2d"),d=h.width=h.height=this.size,m=d/10,g=d/2,x=.22*g;u.translate(g,g),u.fillStyle="#999",u.strokeStyle="#ccc",u.lineWidth=m,u.beginPath(),u.arc(0,0,d*.42,0,2*Math.PI),u.fill(),u.stroke(),u.fillStyle="#99f",u.beginPath(),u.moveTo(0,0),u.lineTo(g,0),u.lineTo(x,x),u.moveTo(0,0),u.lineTo(-g,0),u.lineTo(-x,-x),u.moveTo(0,0),u.lineTo(0,g),u.lineTo(-x,x),u.moveTo(0,0),u.lineTo(0,-g),u.lineTo(x,-x),u.moveTo(0,0),u.fill(),u.fillStyle="#eee",u.beginPath(),u.moveTo(0,0),u.lineTo(g,0),u.lineTo(x,-x),u.moveTo(0,0),u.lineTo(-g,0),u.lineTo(-x,x),u.moveTo(0,0),u.lineTo(0,g),u.lineTo(x,x),u.moveTo(0,0),u.lineTo(0,-g),u.lineTo(-x,-x),u.moveTo(0,0),u.fill()}},ol.ext.inherits(ol.interaction.TouchCompass,ol.interaction.Pointer),ol.interaction.TouchCompass.prototype.compass=null,ol.interaction.TouchCompass.prototype.setMap=function(n){this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.interaction.Pointer.prototype.setMap.call(this,n),n&&(this._listener=n.on("postcompose",this.drawCompass_.bind(this)),ol.ext.getMapCanvas(n))},ol.interaction.TouchCompass.prototype.setActive=function(n){if(ol.interaction.Pointer.prototype.setActive.call(this,n),this.getMap())try{this.getMap().renderSync()}catch{}},ol.interaction.TouchCompass.prototype.getCenter_=function(){var n=10,c=this.size,h=this.getMap().getSize();return[h[0]/2,h[1]-n-c/2]},ol.interaction.TouchCompass.prototype.drawCompass_=function(n){if(this.getActive()){var c=n.context||ol.ext.getMapCanvas(this.getMap()).getContext("2d"),h=n.frameState.pixelRatio;c.save(),c.scale(h,h),c.globalAlpha=this.alpha,c.strokeStyle="#fff",c.lineWidth=5;var u=this.size,d=this.getCenter_();if(c.drawImage(this.compass,0,0,this.compass.width,this.compass.height,d[0]-u/2,d[1]-u/2,u,u),this.pos)for(var m=this.pos.pixel[0]-this.start.pixel[0],g=this.pos.pixel[1]-this.start.pixel[1],x=1;x<=4;x++)c.beginPath(),c.arc(d[0]+m/4*x,d[1]+g/4*x,u/2*(.6+.4*x/4),0,2*Math.PI),c.stroke();if(c.restore(),this.pos){if(this.ondrag_){var E=this.getMap().getView().getResolution(),P={dpixel:[this.pos.pixel[0]-this.start.pixel[0],this.pos.pixel[1]-this.start.pixel[1]]};P.traction=[P.dpixel[0]*E,-P.dpixel[1]*E],this.ondrag_(P,this.pos)}n.frameState.animate=!0}}},ol.interaction.TouchCursor=function(n){n=n||{},this._listeners={};var c=[-35,-35];if(this.ctouch=new ol.interaction.Interaction({handleEvent:function(g){if(!/drag/.test(g.type)&&this.getMap())g.coordinate=this.overlay.getPosition(),g.pixel=this.getMap().getPixelFromCoordinate(g.coordinate),this._lastEvent=g;else{var x=g.frameState.viewState.resolution,E=Math.cos(g.frameState.viewState.rotation),P=Math.sin(g.frameState.viewState.rotation);g.coordinate=[g.coordinate[0]+E*c[0]*x+P*c[1]*x,g.coordinate[1]+P*c[0]*x-E*c[1]*x],g.pixel=this.getMap().getPixelFromCoordinate(g.coordinate)}return!0}.bind(this)}),this.ctouch.set("onTop",!0),this.overlay=new ol.Overlay.Fixed({className:("ol-touch-cursor "+(n.className||"")).trim(),positioning:"top-left",element:ol.ext.element.create("DIV",{}),stopEvent:!1}),ol.interaction.DragOverlay.call(this,{centerOnClick:!1,overlays:this.overlay}),this.setPosition(n.coordinate,!0),this.set("maxButtons",n.maxButtons||5),n.buttons){n.buttons.length>this.get("maxButtons")&&this.set("maxButtons",n.buttons.length);var h=this.overlay.element,u=n.buttons.length>4?0:1;n.buttons.forEach(function(g,x){x<5&&ol.ext.element.create("DIV",{className:((g.className||"")+" ol-button ol-button-"+(x+u)).trim(),html:ol.ext.element.create("DIV",{html:g.html}),click:g.click,on:g.on,parent:h})})}var d=!1,m=!1;this.on("dragstart",function(g){return this._pixel=this.getMap().getPixelFromCoordinate(this.overlay.getPosition()),m=g,!g.overlay}),this.on("dragend",function(g){return this._pixel=this.getMap().getPixelFromCoordinate(this.overlay.getPosition()),g.overlay?(d?(this.dispatchEvent({type:"dragend",dragging:d,originalEvent:g.originalEvent,frameState:g.frameState,pixel:this._pixel,coordinate:this.overlay.getPosition()}),d=!1):g.originalEvent.target===this.overlay.element&&this.dispatchEvent({type:"click",dragging:d,originalEvent:g.originalEvent,frameState:g.frameState,pixel:this._pixel,coordinate:this.overlay.getPosition()}),!1):!0}.bind(this)),this.on("dragging",function(g){return this._pixel=this.getMap().getPixelFromCoordinate(this.overlay.getPosition()),g.overlay?(d=!0,m&&(this.dispatchEvent({type:"dragstart",dragging:d,originalEvent:m.originalEvent,frameState:g.frameState,pixel:this._pixel,coordinate:m.coordinate}),m=!1),this.dispatchEvent({type:"dragging",dragging:d,originalEvent:g.originalEvent,frameState:g.frameState,pixel:this._pixel,coordinate:this.overlay.getPosition()}),!1):!0}.bind(this))},ol.ext.inherits(ol.interaction.TouchCursor,ol.interaction.DragOverlay),ol.interaction.TouchCursor.prototype.setMap=function(n){this.getMap()&&(this.getMap().removeInteraction(this.ctouch),this.getActive()&&this.getMap().removeOverlay(this.overlay));for(var c in this._listeners)ol.Observable.unByKey(this._listeners[c]);this._listeners={},ol.interaction.DragOverlay.prototype.setMap.call(this,n),n&&(this.getActive()&&(n.addOverlay(this.overlay),setTimeout(function(){this.setPosition(this.getPosition()||n.getView().getCenter())}.bind(this))),n.addInteraction(this.ctouch),this._listeners.addInteraction=n.getInteractions().on("add",function(h){h.element.get("onTop")||(n.removeInteraction(this.ctouch),n.addInteraction(this.ctouch))}.bind(this)))},ol.interaction.TouchCursor.prototype.setActive=function(n,c){n!==this.getActive()?(this.ctouch.setActive(n),n?(this.getMap()&&this.getMap().addOverlay(this.overlay),c?this.setPosition(c):this.getMap()&&this.setPosition(this.getMap().getView().getCenter()),this._activate=setTimeout(function(){this.overlay.element.classList.add("active")}.bind(this),100)):(this.setPosition(),this.overlay.element.classList.remove("active"),this._activate&&clearTimeout(this._activate),this.getMap()&&this.getMap().removeOverlay(this.overlay)),ol.interaction.DragOverlay.prototype.setActive.call(this,n)):c?this.setPosition(c):this.getMap()&&this.setPosition(this.getMap().getView().getCenter())},ol.interaction.TouchCursor.prototype.setPosition=function(n){this.overlay.setPosition(n,!0),this.getMap()&&n&&(this._pixel=this.getMap().getPixelFromCoordinate(n))},ol.interaction.TouchCursor.prototype.offsetPosition=function(n){var c=this.overlay.getPosition();c&&this.overlay.setPosition([c[0]+n[0],c[1]+n[1]])},ol.interaction.TouchCursor.prototype.getPosition=function(){return this.overlay.getPosition()},ol.interaction.TouchCursor.prototype.getPixel=function(){if(this.getMap())return this.getMap().getPixelFromCoordinate(this.getPosition())},ol.interaction.TouchCursor.prototype.getOverlay=function(){return this.overlay},ol.interaction.TouchCursor.prototype.getOverlayElement=function(){return this.overlay.element},ol.interaction.TouchCursor.prototype.getButtonElement=function(n){return typeof n=="number"?this.getOverlayElement().getElementsByClassName("ol-button")[n]:this.getOverlayElement().getElementsByClassName(n)[0]},ol.interaction.TouchCursor.prototype.removeButton=function(n){if(n===void 0)for(var c=this.getOverlayElement().getElementsByClassName("ol-button"),h=c.length-1;h>=0;h--)this.getOverlayElement().removeChild(c[h]);else{var u=this.getButtonElement(n);u&&this.getOverlayElement().removeChild(u)}},ol.interaction.TouchCursor.prototype.addButton=function(n){var c=this.getOverlayElement().getElementsByClassName("ol-button"),h=this.get("maxButtons")||5;if(c.length>=h){console.error("[ol/interaction/TouchCursor~addButton] too many button on the cursor (max="+h+")...");return}var u=ol.ext.element.create("DIV",{className:((n.className||"")+" ol-button").trim(),html:ol.ext.element.create("DIV",{html:n.html}),click:n.click,on:n.on});!n.before||c.length===0?this.getOverlayElement().appendChild(u):this.getOverlayElement().insertBefore(u,c[0]);for(var d=c.length>=h?0:1,m=0;m<c.length;m++)c[m].className=c[m].className.replace(/ol-button-\d/g,"").trim()+" ol-button-"+(m+d)},ol.interaction.TouchCursorDraw=function(n){n=n||{};var c=this.sketch=new ol.layer.SketchOverlay({type:n.type});c.on("drawend",function(h){h.valid&&n.source&&n.source.addFeature(h.feature),this.getOverlayElement().classList.add("nodrawing"),this.dispatchEvent(h)}.bind(this)),c.on("drawstart",function(h){this.getOverlayElement().classList.remove("nodrawing"),this.dispatchEvent(h)}.bind(this)),c.on("drawabort",function(h){this.getOverlayElement().classList.add("nodrawing"),this.dispatchEvent(h)}.bind(this)),ol.interaction.TouchCursor.call(this,{className:n.className,coordinate:n.coordinate}),this.getOverlayElement().classList.add("nodrawing"),this.set("types",n.types),this.setType(n.type),this.on("click",function(){this.sketch.addPoint(this.getPosition())}.bind(this)),this.on("dragging",function(){this.sketch.setPosition(this.getPosition())}.bind(this))},ol.ext.inherits(ol.interaction.TouchCursorDraw,ol.interaction.TouchCursor),ol.interaction.TouchCursorDraw.prototype.setMap=function(n){ol.interaction.TouchCursor.prototype.setMap.call(this,n),this.sketch.setMap(n),n&&(this._listeners.movend=n.on("moveend",function(){this.sketch.setPosition(this.getPosition())}.bind(this)))},ol.interaction.TouchCursorDraw.prototype.setActive=function(n,c){ol.interaction.TouchCursor.prototype.setActive.call(this,n,c),this.sketch.abortDrawing(),this.sketch.setPosition(c),this.sketch.setVisible(n)},ol.interaction.TouchCursorDraw.prototype.setType=function(n){this.removeButton();var c=this.sketch;this.getOverlayElement().classList.remove(c.getGeometryType());var h=c.setGeometryType();n=c.setGeometryType(n),this.getOverlayElement().classList.add(n),this.dispatchEvent({type:"change:type",oldValue:h});var u=this.get("types");if(u&&u.length){var d=u[(u.indexOf(n)+1)%u.length];this.addButton({className:"ol-button-type "+d,click:function(){this.setType(d)}.bind(this)})}n!=="Point"&&(this.addButton({className:"ol-button-x",click:function(){c.abortDrawing()}}),n!=="Circle"&&(this.addButton({className:"ol-button-check",click:function(){c.finishDrawing(!0)}}),this.addButton({className:"ol-button-remove",click:function(){c.removeLastPoint()}})))},ol.interaction.TouchCursorDraw.prototype.getType=function(){return this.sketch.getGeometryType()},ol.interaction.TouchCursorModify=function(n){n=n||{};var c=!1,h=!1,u=!1,d=this._modify=new ol.interaction.ModifyFeature({source:n.source,sources:n.sources,features:n.features,pixelTolerance:n.pixelTolerance,filter:n.filter,style:n.style||[new ol.style.Style({image:new ol.style.RegularShape({points:4,radius:10,radius2:0,stroke:new ol.style.Stroke({color:[255,255,255,.5],width:3})})}),new ol.style.Style({image:new ol.style.RegularShape({points:4,radius:10,radius2:0,stroke:new ol.style.Stroke({color:[0,153,255,1],width:1.25})})})],wrapX:n.wrapX,condition:function(m){return m.dragging||h},deleteCondition:function(){return u}});ol.interaction.TouchCursor.call(this,{className:("disable "+n.className).trim(),coordinate:n.coordinate,buttons:[{className:"ol-button-move",on:{pointerdown:function(){c=!0},pointerup:function(){c=!1}}},{className:"ol-button-add",click:function(){h=!0,d.handleDownEvent(this._lastEvent),d.handleUpEvent(this._lastEvent),h=!1}.bind(this)},{className:"ol-button-remove",click:function(){u=!0,d.handleDownEvent(this._lastEvent),u=!1}.bind(this)}]}),d.on("select",function(m){m.selected.length?this.getOverlayElement().classList.remove("disable"):this.getOverlayElement().classList.add("disable")}.bind(this)),this.on("dragstart",function(){c&&d.handleDownEvent(this._lastEvent)}.bind(this)),this.on("dragging",function(m){c&&d.handleDragEvent(m)}),this.on("dragend",function(m){d.handleUpEvent(m),c=!1})},ol.ext.inherits(ol.interaction.TouchCursorModify,ol.interaction.TouchCursor),ol.interaction.TouchCursorModify.prototype.setMap=function(n){this.getMap()&&this.getMap().removeInteraction(this._modify),n&&n.addInteraction(this._modify),ol.interaction.TouchCursor.prototype.setMap.call(this,n)},ol.interaction.TouchCursorModify.prototype.setActive=function(n,c){ol.interaction.TouchCursor.prototype.setActive.call(this,n,c),this._modify.setActive(n)},ol.interaction.TouchCursorModify.prototype.getInteraction=function(){return this._modify},ol.interaction.TouchCursorSelect=function(n){n=n||{},ol.interaction.TouchCursor.call(this,{className:"ol-select "+(n.className||""),coordinate:n.coordinate}),this._selection=null,this._layerFilter=n.layerFilter,this._filter=n.filter,this._style=n.style||ol.style.Style.defaultStyle(!0),this.set("hitTolerance",n.hitTolerance||0),this.on(["change:active","dragging"],function(){this.select()})},ol.ext.inherits(ol.interaction.TouchCursorSelect,ol.interaction.TouchCursor),ol.interaction.TouchCursorSelect.prototype.setMap=function(n){ol.interaction.TouchCursor.prototype.setMap.call(this,n),n&&(this._listeners.movend=n.on("moveend",function(){this.select()}.bind(this)))},ol.interaction.TouchCursorSelect.prototype.getSelection=function(){return this._selection?this._selection.feature:null},ol.interaction.TouchCursorSelect.prototype.setPosition=function(n){ol.interaction.TouchCursor.prototype.setPosition.call(this,n),this.select()},ol.interaction.TouchCursorSelect.prototype.select=function(n){var c=this._selection;if(this.getActive()&&this.getPosition()){if(!n){var h=this.getMap().getFeaturesAtPixel(this.getPixel(),{layerFilter:this._layerFilter,filter:this._filter,hitTolerance:this.get("hitTolerance")});n=h?h[0]:null}n?c&&n===c.feature?c=null:(this._selection={feature:n,style:n.getStyle()},n.setStyle(this._style),this.dispatchEvent({type:"select",selected:[n],deselected:c?[c.feature]:[]})):(this._selection=null,this.dispatchEvent({type:"select",selected:[],deselected:c?[c.feature]:[]}))}else this._selection=null,this.dispatchEvent({type:"select",selected:[],deselected:c?[c.feature]:[]});c&&c.feature.setStyle(c.style),this._selection?this.getOverlayElement().classList.remove("disable"):this.getOverlayElement().classList.add("disable")},ol.interaction.Transform=function(n){n||(n={});var c=this;this.selection_=new ol.Collection,this.handles_=new ol.Collection,this.overlayLayer_=new ol.layer.Vector({source:new ol.source.Vector({features:this.handles_,useSpatialIndex:!1,wrapX:!1}),name:"Transform overlay",displayInLayerSwitcher:!1,style:function(h){return c.style[(h.get("handle")||"default")+(h.get("constraint")||"")+(h.get("option")||"")]}}),ol.interaction.Pointer.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=n.features,typeof n.filter=="function"&&(this._filter=n.filter),this.layers_=n.layers?n.layers instanceof Array?n.layers:[n.layers]:null,this._handleEvent=n.condition||function(){return!0},this.addFn_=n.addCondition||function(){return!1},this.setPointRadius(n.pointRadius),this.set("translateFeature",n.translateFeature!==!1),this.set("translate",n.translate!==!1),this.set("translateBBox",n.translateBBox===!0),this.set("stretch",n.stretch!==!1),this.set("scale",n.scale!==!1),this.set("rotate",n.rotate!==!1),this.set("keepAspectRatio",n.keepAspectRatio||function(h){return h.originalEvent.shiftKey}),this.set("modifyCenter",n.modifyCenter||function(h){return h.originalEvent.metaKey||h.originalEvent.ctrlKey}),this.set("noFlip",n.noFlip||!1),this.set("selection",n.selection!==!1),this.set("hitTolerance",n.hitTolerance||0),this.set("enableRotatedTransform",n.enableRotatedTransform||!1),this.set("keepRectangle",n.keepRectangle||!1),this.on("propertychange",function(){this.drawSketch_()}),this.setDefaultStyle()},ol.ext.inherits(ol.interaction.Transform,ol.interaction.Pointer),ol.interaction.Transform.prototype.Cursors={default:"auto",select:"pointer",translate:"move",rotate:"move",rotate0:"move",scale:"nesw-resize",scale1:"nwse-resize",scale2:"nesw-resize",scale3:"nwse-resize",scalev:"ew-resize",scaleh1:"ns-resize",scalev2:"ew-resize",scaleh3:"ns-resize"},ol.interaction.Transform.prototype.setMap=function(n){var c=this.getMap();if(c){var h=c.getTargetElement();c.removeLayer(this.overlayLayer_),this.previousCursor_&&h&&(h.style.cursor=this.previousCursor_),this.previousCursor_=void 0}ol.interaction.Pointer.prototype.setMap.call(this,n),this.overlayLayer_.setMap(n),n===null&&this.select(null),n!==null&&(this.isTouch=/touch/.test(n.getViewport().className),this.setDefaultStyle())},ol.interaction.Transform.prototype.setActive=function(n){this.select(null),this.overlayLayer_.setVisible(n),ol.interaction.Pointer.prototype.setActive.call(this,n)},ol.interaction.Transform.prototype.setDefaultStyle=function(n){n=n||{};var c=n.pointStroke||new ol.style.Stroke({color:[255,0,0,1],width:1}),h=n.stroke||new ol.style.Stroke({color:[255,0,0,1],width:1,lineDash:[4,4]}),u=n.fill||new ol.style.Fill({color:[255,0,0,.01]}),d=n.pointFill||new ol.style.Fill({color:[255,255,255,.8]}),m=new ol.style.RegularShape({fill:d,stroke:c,radius:this.isTouch?12:6,displacement:this.isTouch?[24,-24]:[12,-12],points:15});m.setDisplacement||(m.getAnchor()[0]=this.isTouch?-10:-5);var g=new ol.style.RegularShape({fill:d,stroke:c,radius:this.isTouch?16:8,points:4,angle:Math.PI/4}),x=new ol.style.RegularShape({fill:d,stroke:c,radius:this.isTouch?12:6,points:4,angle:Math.PI/4});function E(P,L,F){return[new ol.style.Style({image:P,stroke:L,fill:F})]}this.style={default:E(g,h,u),translate:E(g,c,d),rotate:E(m,c,d),rotate0:E(g,c,d),scale:E(g,c,d),scale1:E(g,c,d),scale2:E(g,c,d),scale3:E(g,c,d),scalev:E(x,c,d),scaleh1:E(x,c,d),scalev2:E(x,c,d),scaleh3:E(x,c,d)},this.drawSketch_()},ol.interaction.Transform.prototype.setStyle=function(n,c){if(c){c instanceof Array?this.style[n]=c:this.style[n]=[c];for(var h=0;h<this.style[n].length;h++){var u=this.style[n][h].getImage();u&&(n=="rotate"&&(u.getAnchor()[0]=-5),this.isTouch&&u.setScale(1.8));var d=this.style[n][h].getText();d&&(n=="rotate"&&d.setOffsetX(this.isTouch?14:7),this.isTouch&&d.setScale(1.8))}this.drawSketch_()}},ol.interaction.Transform.prototype.getFeatureAtPixel_=function(n){var c=this;return this.getMap().forEachFeatureAtPixel(n,function(h,u){var d=!1;if(!u){if(h===c.bbox_)return c.get("translateBBox")?{feature:h,handle:"translate",constraint:"",option:""}:!1;if(c.handles_.forEach(function(g){g===h&&(d=!0)}),d)return{feature:h,handle:h.get("handle"),constraint:h.get("constraint"),option:h.get("option")}}if(!c.get("selection"))return c.selection_.getArray().some(function(g){return h===g})?{feature:h}:null;if(c._filter)return c._filter(h,u)?{feature:h}:null;if(c.layers_){for(var m=0;m<c.layers_.length;m++)if(c.layers_[m]===u)return{feature:h};return null}else return c.features_?(c.features_.forEach(function(g){g===h&&(d=!0)}),d?{feature:h}:null):{feature:h}},{hitTolerance:this.get("hitTolerance")})||{}},ol.interaction.Transform.prototype.getGeometryRotateToZero_=function(n,c){var h=n.getGeometry(),u=this.getMap().getView().getRotation();if(u===0||!this.get("enableRotatedTransform"))return c?h.clone():h;var d=h.clone();return d.rotate(u*-1,this.getMap().getView().getCenter()),d},ol.interaction.Transform.prototype._isRectangle=function(n){if(this.get("keepRectangle")&&n.getType()==="Polygon"){var c=n.getCoordinates()[0];return c.length===5}return!1},ol.interaction.Transform.prototype.drawSketch_=function(n){var c,h,u,d=this.selection_.item(0)&&this._isRectangle(this.selection_.item(0).getGeometry());if(this.overlayLayer_.getSource().clear(),!!this.selection_.getLength()){var m=this.getMap().getView().getRotation(),g=this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent(),x;d&&(x=this.getGeometryRotateToZero_(this.selection_.item(0)).getCoordinates()[0].slice(0,4),x.unshift(x[3])),g=ol.extent.buffer(g,0),this.selection_.forEach(function(G){var B=this.getGeometryRotateToZero_(G).getExtent();ol.extent.extend(g,B)}.bind(this));var E=this.selection_.getLength()===1?this._pointRadius(this.selection_.item(0)):0;if(E&&!(E instanceof Array)&&(E=[E,E]),n===!0)this.ispt_||(this.overlayLayer_.getSource().addFeature(new ol.Feature({geometry:new ol.geom.Point(this.center_),handle:"rotate0"})),u=ol.geom.Polygon.fromExtent(g),this.get("enableRotatedTransform")&&m!==0&&u.rotate(m,this.getMap().getView().getCenter()),h=this.bbox_=new ol.Feature(u),this.overlayLayer_.getSource().addFeature(h));else{if(this.ispt_){var P=this.getMap().getPixelFromCoordinate([g[0],g[1]]);if(P){var L=E&&E[0]||10,F=E&&E[1]||10;g=ol.extent.boundingExtent([this.getMap().getCoordinateFromPixel([P[0]-L,P[1]-F]),this.getMap().getCoordinateFromPixel([P[0]+L,P[1]+F])])}}u=d?new ol.geom.Polygon([x]):ol.geom.Polygon.fromExtent(g),this.get("enableRotatedTransform")&&m!==0&&u.rotate(m,this.getMap().getView().getCenter()),h=this.bbox_=new ol.Feature(u);var U=[],A=u.getCoordinates()[0];if(!this.ispt_||E){if(U.push(h),!this.iscircle_&&!this.ispt_&&this.get("stretch")&&this.get("scale"))for(c=0;c<A.length-1;c++)h=new ol.Feature({geometry:new ol.geom.Point([(A[c][0]+A[c+1][0])/2,(A[c][1]+A[c+1][1])/2]),handle:"scale",constraint:c%2?"h":"v",option:c}),U.push(h);if(this.get("scale"))for(c=0;c<A.length-1;c++)h=new ol.Feature({geometry:new ol.geom.Point(A[c]),handle:"scale",option:c}),U.push(h);this.get("translate")&&!this.get("translateFeature")&&(h=new ol.Feature({geometry:new ol.geom.Point([(A[0][0]+A[2][0])/2,(A[0][1]+A[2][1])/2]),handle:"translate"}),U.push(h))}!this.iscircle_&&this.get("rotate")&&(h=new ol.Feature({geometry:new ol.geom.Point(A[3]),handle:"rotate"}),U.push(h)),this.overlayLayer_.getSource().addFeatures(U)}}},ol.interaction.Transform.prototype.select=function(n,c){if(!n){this.selection_.clear(),this.drawSketch_();return}if(!(!n.getGeometry||!n.getGeometry())){if(c)this.selection_.push(n);else{var h=this.selection_.getArray().indexOf(n);this.selection_.removeAt(h)}this.ispt_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Point":!1,this.iscircle_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Circle":!1,this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:n,features:this.selection_})}},ol.interaction.Transform.prototype.setSelection=function(n){this.selection_.clear(),n.forEach(function(c){this.selection_.push(c)}.bind(this)),this.ispt_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Point":!1,this.iscircle_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Circle":!1,this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",features:this.selection_})},ol.interaction.Transform.prototype.watchFeatures_=function(){this._featureListeners&&this._featureListeners.forEach(function(n){ol.Observable.unByKey(n)}),this._featureListeners=[],this.selection_.forEach(function(n){this._featureListeners.push(n.on("change",function(){this.isUpdating_||this.drawSketch_()}.bind(this)))}.bind(this))},ol.interaction.Transform.prototype.handleDownEvent_=function(n){if(this._handleEvent(n,this.selection_)){var c=this.getFeatureAtPixel_(n.pixel),h=c.feature;if(this.selection_.getLength()&&this.selection_.getArray().indexOf(h)>=0&&(this.ispt_&&this.get("translate")||this.get("translateFeature"))&&(c.handle="translate"),c.handle){this.mode_=c.handle,this.opt_=c.option,this.constraint_=c.constraint;var u=this.getMap().getView().getRotation();this.coordinate_=n.coordinate,this.pixel_=n.pixel,this.geoms_=[],this.rotatedGeoms_=[];for(var d=ol.extent.createEmpty(),m=ol.extent.createEmpty(),g=0,x;x=this.selection_.item(g);g++)if(this.geoms_.push(x.getGeometry().clone()),d=ol.extent.extend(d,x.getGeometry().getExtent()),this.get("enableRotatedTransform")&&u!==0){var E=this.getGeometryRotateToZero_(x,!0);this.rotatedGeoms_.push(E),m=ol.extent.extend(m,E.getExtent())}if(this.extent_=ol.geom.Polygon.fromExtent(d).getCoordinates()[0],this.get("enableRotatedTransform")&&u!==0&&(this.rotatedExtent_=ol.geom.Polygon.fromExtent(m).getCoordinates()[0]),this.mode_==="rotate"){this.center_=this.getCenter()||ol.extent.getCenter(d);var P=n.map.getTargetElement();P.style.cursor=this.Cursors.rotate0,this.previousCursor_=P.style.cursor}else this.center_=ol.extent.getCenter(d);return this.angle_=Math.atan2(this.center_[1]-n.coordinate[1],this.center_[0]-n.coordinate[0]),this.dispatchEvent({type:this.mode_+"start",feature:this.selection_.item(0),features:this.selection_,pixel:n.pixel,coordinate:n.coordinate}),!0}else if(this.get("selection")){if(h){this.addFn_(n)||this.selection_.clear();var L=this.selection_.getArray().indexOf(h);L<0?this.selection_.push(h):this.selection_.removeAt(L)}else this.selection_.clear();return this.ispt_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Point":!1,this.iscircle_=this.selection_.getLength()===1?this.selection_.item(0).getGeometry().getType()=="Circle":!1,this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:h,features:this.selection_,pixel:n.pixel,coordinate:n.coordinate}),!1}}},ol.interaction.Transform.prototype.getFeatures=function(){return this.selection_},ol.interaction.Transform.prototype.getCenter=function(){return this.get("center")},ol.interaction.Transform.prototype.setCenter=function(n){return this.set("center",n)};function projectVectorOnVector(n,c){var h=(n[0]*c[0]+n[1]*c[1])/(c[0]*c[0]+c[1]*c[1]);return[c[0]*h,c[1]*h]}function countVector(n,c){return[c[0]-n[0],c[1]-n[1]]}function movePoint(n,c){return[n[0]+c[0],n[1]+c[1]]}ol.interaction.Transform.prototype.handleDragEvent_=function(n){if(this._handleEvent(n,this.features_)){var c=this.getMap().getView().getRotation(),h,u,d,m,g=[this.coordinate_[0],this.coordinate_[1]],x=[n.coordinate[0],n.coordinate[1]];switch(this.isUpdating_=!0,this.mode_){case"rotate":{var E=Math.atan2(this.center_[1]-x[1],this.center_[0]-x[0]);if(!this.ispt)for(h=0,d;d=this.selection_.item(h);h++)m=this.geoms_[h].clone(),m.rotate(E-this.angle_,this.center_),m.getType()=="Circle"&&m.setCenterAndRadius(m.getCenter(),m.getRadius()),d.setGeometry(m);this.drawSketch_(!0),this.dispatchEvent({type:"rotating",feature:this.selection_.item(0),features:this.selection_,angle:E-this.angle_,pixel:n.pixel,coordinate:n.coordinate});break}case"translate":{var P=x[0]-g[0],L=x[1]-g[1];for(h=0,d;d=this.selection_.item(h);h++)d.getGeometry().translate(P,L);this.handles_.forEach(function(ut){ut.getGeometry().translate(P,L)}),this.coordinate_=n.coordinate,this.dispatchEvent({type:"translating",feature:this.selection_.item(0),features:this.selection_,delta:[P,L],pixel:n.pixel,coordinate:n.coordinate});break}case"scale":{var F=this.center_;if(this.get("modifyCenter")(n)){var U=this.extent_;this.get("enableRotatedTransform")&&c!==0&&(U=this.rotatedExtent_),F=U[(Number(this.opt_)+2)%4]}var A=this.geoms_.length==1&&this._isRectangle(this.geoms_[0]),G=this.constraint_,B=this.opt_,O=this.coordinate_,K=n.coordinate;if(this.get("enableRotatedTransform")&&c!==0){var Q=new ol.geom.Point(this.coordinate_);Q.rotate(c*-1,F),O=Q.getCoordinates();var et=new ol.geom.Point(n.coordinate);et.rotate(c*-1,F),K=et.getCoordinates()}var lt=(K[0]-F[0])/(O[0]-F[0]),pt=(K[1]-F[1])/(O[1]-F[1]),T=[K[0]-O[0],K[1]-O[1]];if(this.get("enableRotatedTransform")&&c!==0){var ct=new ol.geom.Point(F);ct.rotate(c*-1,this.getMap().getView().getCenter()),F=ct.getCoordinates()}for(this.get("noFlip")&&(lt<0&&(lt=-lt),pt<0&&(pt=-pt)),this.constraint_?this.constraint_=="h"?lt=1:pt=1:this.get("keepAspectRatio")(n)&&(lt=pt=Math.min(lt,pt)),h=0,d;d=this.selection_.item(h);h++)m=c===0||!this.get("enableRotatedTransform")?this.geoms_[h].clone():this.rotatedGeoms_[h].clone(),m.applyTransform(function(ut,ft,$){if($<2)return ft;if(A){var _t=[[6],[0,8],[2],[4]],W=[ut[0],ut[1]],rt=[ut[2],ut[3]],nt=[ut[4],ut[5]],vt=[ut[6],ut[7]],Mt=[ut[8],ut[9]];if(G){var Bt=B%2===0?countVector(W,rt):countVector(vt,W),Vt=projectVectorOnVector(T,Bt),Lt=B+1<_t.length?B+1:0,Ne=[..._t[B],..._t[Lt]];for(u=0;u<ut.length;u+=$)ft[u]=Ne.includes(u)?ut[u]+Vt[0]:ut[u],ft[u+1]=Ne.includes(u)?ut[u+1]+Vt[1]:ut[u+1]}else{var ge,Yt;switch(B){case 0:T=countVector(vt,K),ge=projectVectorOnVector(T,countVector(nt,vt)),Yt=projectVectorOnVector(T,countVector(W,vt)),[ft[0],ft[1]]=movePoint(W,ge),[ft[4],ft[5]]=movePoint(nt,Yt),[ft[6],ft[7]]=movePoint(vt,T),[ft[8],ft[9]]=movePoint(Mt,ge);break;case 1:T=countVector(W,K),ge=projectVectorOnVector(T,countVector(vt,W)),Yt=projectVectorOnVector(T,countVector(rt,W)),[ft[0],ft[1]]=movePoint(W,T),[ft[2],ft[3]]=movePoint(rt,ge),[ft[6],ft[7]]=movePoint(vt,Yt),[ft[8],ft[9]]=movePoint(Mt,T);break;case 2:T=countVector(rt,K),ge=projectVectorOnVector(T,countVector(W,rt)),Yt=projectVectorOnVector(T,countVector(nt,rt)),[ft[0],ft[1]]=movePoint(W,Yt),[ft[2],ft[3]]=movePoint(rt,T),[ft[4],ft[5]]=movePoint(nt,ge),[ft[8],ft[9]]=movePoint(Mt,Yt);break;case 3:T=countVector(nt,K),ge=projectVectorOnVector(T,countVector(rt,nt)),Yt=projectVectorOnVector(T,countVector(vt,nt)),[ft[2],ft[3]]=movePoint(rt,Yt),[ft[4],ft[5]]=movePoint(nt,T),[ft[6],ft[7]]=movePoint(vt,ge);break}}}else for(u=0;u<ut.length;u+=$)lt!=1&&(ft[u]=F[0]+(ut[u]-F[0])*lt),pt!=1&&(ft[u+1]=F[1]+(ut[u+1]-F[1])*pt);return m.getType()=="Circle"&&m.setCenterAndRadius(m.getCenter(),m.getRadius()),ft}),this.get("enableRotatedTransform")&&c!==0&&m.rotate(c,this.getMap().getView().getCenter()),d.setGeometry(m);this.drawSketch_(),this.dispatchEvent({type:"scaling",feature:this.selection_.item(0),features:this.selection_,scale:[lt,pt],pixel:n.pixel,coordinate:n.coordinate});break}default:break}this.isUpdating_=!1}},ol.interaction.Transform.prototype.handleMoveEvent_=function(n){if(this._handleEvent(n,this.features_)&&!this.mode_){var c=this.getFeatureAtPixel_(n.pixel),h=n.map.getTargetElement();if(c.feature){var u=c.handle?this.Cursors[(c.handle||"default")+(c.constraint||"")+(c.option||"")]:this.Cursors.select;this.previousCursor_===void 0&&(this.previousCursor_=h.style.cursor),h.style.cursor=u}else this.previousCursor_!==void 0&&(h.style.cursor=this.previousCursor_),this.previousCursor_=void 0}},ol.interaction.Transform.prototype.handleUpEvent_=function(n){if(this.mode_==="rotate"){var c=n.map.getTargetElement();c.style.cursor=this.Cursors.default,this.previousCursor_=void 0}return this.dispatchEvent({type:this.mode_+"end",feature:this.selection_.item(0),features:this.selection_,oldgeom:this.geoms_[0],oldgeoms:this.geoms_}),this.drawSketch_(),this.mode_=null,!1},ol.interaction.Transform.prototype.getFeatures=function(){return this.selection_},ol.interaction.Transform.prototype.setPointRadius=function(n){typeof n=="function"?this._pointRadius=n:this._pointRadius=function(){return n}},ol.interaction.UndoRedo=function(n){n||(n={}),ol.interaction.Interaction.call(this,{handleEvent:function(){return!0}}),this._layers=n.layers,this._undoStack=new ol.Collection,this._redoStack=new ol.Collection,this._undo=[],this._redo=[],this._undoStack.on("add",function(c){c.element.level===void 0?(c.element.level=this._level,c.element.level||(c.element.view={center:this.getMap().getView().getCenter(),zoom:this.getMap().getView().getZoom()},this._undo.push(c.element))):c.element.level||this._undo.push(this._redo.shift()),c.element.level||this.dispatchEvent({type:"stack:add",action:c.element}),this._reduce()}.bind(this)),this._undoStack.on("remove",function(c){c.element.level||(this._doShift?this._undo.shift():this._undo.length&&this._redo.push(this._undo.pop()),this._doClear||this.dispatchEvent({type:"stack:remove",action:c.element,shift:this._doShift}))}.bind(this)),this._block=0,this._level=0,this._doShift=!1,this._record=!0,this._defs={}},ol.ext.inherits(ol.interaction.UndoRedo,ol.interaction.Interaction),ol.interaction.UndoRedo.prototype.define=function(n,c,h){this._defs[n]={undo:c,redo:h}},ol.interaction.UndoRedo.prototype.length=function(n){return n==="redo"?this._redo.length:this._undo.length},ol.interaction.UndoRedo.prototype.setMaxLength=function(n){n=parseInt(n),n&&n<0&&(n=0),this.set("maxLength",n),this._reduce()},ol.interaction.UndoRedo.prototype.size=function(n){return n==="redo"?this._redoStack.getLength():this._undoStack.getLength()},ol.interaction.UndoRedo.prototype.setMaxSize=function(n){n=parseInt(n),n&&n<0&&(n=0),this.set("maxSize",n),this._reduce()},ol.interaction.UndoRedo.prototype._reduce=function(){if(this.get("maxLength"))for(;this.length()>this.get("maxLength");)this.shift();if(this.get("maxSize"))for(;this.length()>1&&this.size()>this.get("maxSize");)this.shift()},ol.interaction.UndoRedo.prototype.getStack=function(n){return n==="redo"?this._redo:this._undo},ol.interaction.UndoRedo.prototype.push=function(n,c,h){return this._defs[n]?(this._undoStack.push({type:n,name:h,custom:!0,prop:c}),!0):(console.warn('[UndoRedoInteraction]: "'+n+'" is not defined.'),!1)},ol.interaction.UndoRedo.prototype.shift=function(){this._doShift=!0;var n=this._undoStack.removeAt(0);if(this._doShift=!1,n.type==="blockstart")for(n=this._undoStack.item(0);this._undoStack.getLength()&&n.level>0;)this._undoStack.removeAt(0),n=this._undoStack.item(0)},ol.interaction.UndoRedo.prototype.setActive=function(n){ol.interaction.Interaction.prototype.setActive.call(this,n),this._record=n},ol.interaction.UndoRedo.prototype.setMap=function(n){this._mapListener&&this._mapListener.forEach(function(c){ol.Observable.unByKey(c)}),this._mapListener=[],ol.interaction.Interaction.prototype.setMap.call(this,n),n&&(this._mapListener.push(n.on("undoblockstart",this.blockStart.bind(this))),this._mapListener.push(n.on("undoblockend",this.blockEnd.bind(this)))),this._watchSources(),this._watchInteractions()},ol.interaction.UndoRedo.prototype._watchSources=function(){var n=this.getMap();this._sourceListener&&this._sourceListener.forEach(function(d){ol.Observable.unByKey(d)}),this._sourceListener=[];var c=this;function h(d,m){return m||(m=[]),d.forEach(function(g){g instanceof ol.layer.Vector?(!c._layers||c._layers.indexOf(g)>=0)&&m.push(g):g.getLayers&&h(g.getLayers(),m)}),m}if(n){var u=h(n.getLayers());u.forEach(function(d){var m=d.getSource();this._sourceListener.push(m.on(["addfeature","removefeature"],this._onAddRemove.bind(this))),this._sourceListener.push(m.on("clearstart",function(){this.blockStart("clear")}.bind(this))),this._sourceListener.push(m.on("clearend",this.blockEnd.bind(this)))}.bind(this)),this._sourceListener.push(n.getLayers().on(["add","remove"],this._watchSources.bind(this)))}},ol.interaction.UndoRedo.prototype._watchInteractions=function(){var n=this.getMap();this._interactionListener&&this._interactionListener.forEach(function(c){ol.Observable.unByKey(c)}),this._interactionListener=[],n&&(n.getInteractions().forEach(function(c){this._interactionListener.push(c.on(["setattributestart","modifystart","rotatestart","translatestart","scalestart","deletestart","deleteend","beforesplit","aftersplit"],this._onInteraction.bind(this)))}.bind(this)),this._interactionListener.push(n.getInteractions().on(["add","remove"],this._watchInteractions.bind(this))))},ol.interaction.UndoRedo.prototype._onAddRemove=function(n){this._record&&(this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:n.type,source:n.target,feature:n.feature}))},ol.interaction.UndoRedo.prototype._onInteraction=function(n){var c=this._onInteraction[n.type];c&&c.call(this,n)},ol.interaction.UndoRedo.prototype._onInteraction.setattributestart=function(n){this.blockStart(n.target.get("name")||"setattribute");var c=Object.assign({},n.properties);n.features.forEach(function(h){var u={};for(var d in c)u[d]=h.get(d);this._undoStack.push({type:"changeattribute",feature:h,newProperties:c,oldProperties:u})}.bind(this)),this.blockEnd()},ol.interaction.UndoRedo.prototype._onInteraction.rotatestart=ol.interaction.UndoRedo.prototype._onInteraction.translatestart=ol.interaction.UndoRedo.prototype._onInteraction.scalestart=ol.interaction.UndoRedo.prototype._onInteraction.modifystart=function(n){this.blockStart(n.type.replace(/start$/,"")),n.features.forEach(function(c){this._undoStack.push({type:"changegeometry",feature:c,oldGeom:c.getGeometry().clone()})}.bind(this)),this.blockEnd()},ol.interaction.UndoRedo.prototype.blockStart=function(n){this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:"blockstart",name:n}),this._level++},ol.interaction.UndoRedo.prototype._onInteraction.beforesplit=function(){var n=this._undoStack.getLength();n>2&&this._undoStack.item(n-1).type==="blockend"&&this._undoStack.item(n-2).type==="changegeometry"?this._undoStack.pop():this.blockStart("split")},ol.interaction.UndoRedo.prototype._onInteraction.deletestart=function(){this.blockStart("delete")},ol.interaction.UndoRedo.prototype.blockEnd=function(){this._undoStack.push({type:"blockend"}),this._level--},ol.interaction.UndoRedo.prototype._onInteraction.aftersplit=ol.interaction.UndoRedo.prototype._onInteraction.deleteend=ol.interaction.UndoRedo.prototype.blockEnd,ol.interaction.UndoRedo.prototype._handleDo=function(n,c){if(this.getActive()){if(this._record=!1,n.custom)this._defs[n.type]?c?this._defs[n.type].undo(n.prop):this._defs[n.type].redo(n.prop):console.warn('[UndoRedoInteraction]: "'+n.type+'" is not defined.');else switch(n.type){case"addfeature":{c?n.source.removeFeature(n.feature):n.source.addFeature(n.feature);break}case"removefeature":{c?n.source.addFeature(n.feature):n.source.removeFeature(n.feature);break}case"changegeometry":{var h=n.feature.getGeometry();n.feature.setGeometry(n.oldGeom),n.oldGeom=h;break}case"changeattribute":{var u=n.newProperties,d=n.oldProperties;for(var m in d)d===void 0?n.feature.unset(m):n.feature.set(m,d[m]);n.oldProperties=u,n.newProperties=d;break}case"blockstart":{this._block+=c?-1:1;break}case"blockend":{this._block+=c?1:-1;break}default:console.warn('[UndoRedoInteraction]: "'+n.type+'" is not defined.')}this._block<0&&(this._block=0),this._block&&(c?this.undo():this.redo()),this._record=!0,this.dispatchEvent({type:c?"undo":"redo",action:n})}},ol.interaction.UndoRedo.prototype.undo=function(){var n=this._undoStack.item(this._undoStack.getLength()-1);n&&(this._redoStack.push(n),this._undoStack.pop(),this._handleDo(n,!0))},ol.interaction.UndoRedo.prototype.redo=function(){var n=this._redoStack.item(this._redoStack.getLength()-1);n&&(this._undoStack.push(n),this._redoStack.pop(),this._handleDo(n,!1))},ol.interaction.UndoRedo.prototype.clear=function(){this._doClear=!0,this._undo.length=this._redo.length=0,this._undoStack.clear(),this._redoStack.clear(),this._doClear=!1,this.dispatchEvent({type:"stack:clear"})},ol.interaction.UndoRedo.prototype.hasUndo=function(){return this._undoStack.getLength()},ol.interaction.UndoRedo.prototype.hasRedo=function(){return this._redoStack.getLength()},ol.source.BinBase=function(n){n=n||{},this._bindModify=this._onModifyFeature.bind(this),this._watch=!0,ol.source.Vector.call(this,n),this._origin=n.source,this._listen=n.listenChange!==!1,this._geomFn=n.geometryFunction||ol.coordinate.getFeatureCenter||function(c){return c.getGeometry().getFirstCoordinate()},this.reset(),this._origin.on("addfeature",this._onAddFeature.bind(this)),this._origin.on("removefeature",this._onRemoveFeature.bind(this)),this._origin.on("clearstart",this._onClearFeature.bind(this)),this._origin.on("clearend",this._onClearFeature.bind(this)),typeof n.flatAttributes=="function"&&(this._flatAttributes=n.flatAttributes)},ol.ext.inherits(ol.source.BinBase,ol.source.Vector),ol.source.BinBase.prototype._onAddFeature=function(n,c,h){var u=n.feature||n.target;c=c||this.getBinAt(this._geomFn(u),!0),c&&c.get("features").push(u),this._listen&&h!==!1&&u.on("change",this._bindModify)},ol.source.BinBase.prototype._onRemoveFeature=function(n,c,h){if(this._watch){var u=n.feature||n.target;if(c=c||this.getBinAt(this._geomFn(u)),c){for(var d=c.get("features"),m=0,g;g=d[m];m++)if(g===u){d.splice(m,1);break}d.length||this.removeFeature(c)}this._listen&&h!==!1&&u.un("change",this._bindModify)}},ol.source.BinBase.prototype._onClearFeature=function(n){n.type==="clearstart"?(this._listen&&this._origin.getFeatures().forEach(function(c){c.un("change",this._bindModify)}.bind(this)),this.clear(),this._watch=!1):this._watch=!0},ol.source.BinBase.prototype.getBin=function(n){for(var c=this.getFeatures(),h=0,u;u=c[h];h++)for(var d=u.get("features"),m=0,g;g=d[m];m++)if(g===n)return u;return null},ol.source.BinBase.prototype.getGridGeomAt=function(n){return new ol.geom.Polygon([n])},ol.source.BinBase.prototype.getBinAt=function(n,c){var h={},u=this.getGridGeomAt(n,h);if(!u)return null;var d=u.getInteriorPoint?u.getInteriorPoint().getCoordinates():u.getInteriorPoints().getCoordinates()[0],m=this.getFeaturesAtCoordinate(d),g=m[0];return!g&&c&&(h.geometry=u,h.features=[],h.center=d,g=new ol.Feature(h),this.addFeature(g)),g||null},ol.source.BinBase.prototype._onModifyFeature=function(n){var c=this.getBin(n.target),h=this.getBinAt(this._geomFn(n.target),"create");c!==h&&(c&&this._onRemoveFeature(n,c,!1),h&&this._onAddFeature(n,h,!1)),this.changed()},ol.source.BinBase.prototype.reset=function(){this.clear();for(var n=this._origin.getFeatures(),c=0,h;h=n[c];c++)this._onAddFeature({feature:h});this.changed()},ol.source.BinBase.prototype.getGridFeatures=function(){var n=[];return this.getFeatures().forEach(function(c){var h=new ol.Feature(c.getGeometry().clone());for(var u in c.getProperties())u!=="features"&&u!=="geometry"&&h.set(u,c.get(u));h.set("nb",c.get("features").length),this._flatAttributes(h,c.get("features")),n.push(h)}.bind(this)),n},ol.source.BinBase.prototype._flatAttributes=function(){},ol.source.BinBase.prototype.setFlatAttributesFn=function(n){typeof n=="function"&&(this._flatAttributes=n)},ol.source.BinBase.prototype.getSource=function(){return this._origin},ol.source.DBPedia=function(n){var c=n||{};c.loader=this._loaderFn,this._url=c.url||"http://fr.dbpedia.org/sparql",this._maxResolution=c.maxResolution||100,this._lang=c.lang||"fr",this._limit=c.limit||1e3,c.attributions||(c.attributions=["&copy; <a href='http://dbpedia.org/'>DBpedia</a> CC-by-SA"]),c.strategy||(c.strategy=ol.loadingstrategy.bbox),ol.source.Vector.call(this,c)},ol.ext.inherits(ol.source.DBPedia,ol.source.Vector),ol.source.DBPedia.prototype.readFeature=function(n,c,h){for(var u in c)c[u].type==="uri"&&(c[u].value=encodeURI(c[u].value)),n.set(u,c[u].value);return h&&h.get("subject")==c.subject.value?(h.set("type",h.get("type")+`
`+c.type.value),!1):!0},ol.source.DBPedia.prototype.querySubject=function(){return"?subject rdfs:label ?label. OPTIONAL {?subject dbpedia-owl:thumbnail ?thumbnail}.OPTIONAL {?subject dbpedia-owl:abstract ?abstract} . OPTIONAL {?subject rdf:type ?type}"},ol.source.DBPedia.prototype.queryFilter=function(){return"lang(?label) = '"+this._lang+"' && lang(?abstract) = '"+this._lang+"'"},ol.source.DBPedia.prototype._loaderFn=function(n,c,h){if(!(c>this._maxResolution)){var u=this,d=ol.proj.transformExtent(n,h,"EPSG:4326"),m="PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> SELECT DISTINCT * WHERE { ?subject geo:lat ?lat . ?subject geo:long ?long . "+this.querySubject()+" . FILTER("+this.queryFilter()+") . FILTER(xsd:float(?lat) <= "+d[3]+" && "+d[1]+" <= xsd:float(?lat) && xsd:float(?long) <= "+d[2]+" && "+d[0]+" <= xsd:float(?long) ) . } LIMIT "+this._limit;ol.ext.Ajax.get({url:this._url,data:{query:m,format:"json"},success:function(g){var x=g.results.bindings,E=[],P,L,F,U=null;for(var A in x)P=x[A],L=[Number(x[A].long.value),Number(x[A].lat.value)],F=new ol.Feature(new ol.geom.Point(ol.proj.transform(L,"EPSG:4326",h))),u.readFeature(F,P,U)&&(E.push(F),U=F);u.addFeatures(E)}})}},ol.style.clearDBPediaStyleCache,ol.style.dbPediaStyleFunction,function(){var n={};ol.style.clearDBPediaStyleCache=function(){n={}},ol.style.dbPediaStyleFunction=function(c){c||(c={});var h;switch(typeof c.glyph){case"function":h=c.glyph;break;case"string":h=function(){return c.glyph};break;default:{h=function(x){var E=x.get("type");if(E){if(E.match("/Museum"))return"fa-camera";if(E.match("/Monument"))return"fa-building";if(E.match("/Sculpture"))return"fa-android";if(E.match("/Religious"))return"fa-institution";if(E.match("/Castle"))return"fa-key";if(E.match("Water"))return"fa-tint";if(E.match("Island"))return"fa-leaf";if(E.match("/Event"))return"fa-heart";if(E.match("/Artwork"))return"fa-asterisk";if(E.match("/Stadium"))return"fa-futbol-o";if(E.match("/Place"))return"fa-street-view"}return"fa-star"};break}}var u=c.radius||8,d=c.fill||new ol.style.Fill({color:"navy"}),m=c.stroke||new ol.style.Stroke({color:"#fff",width:2}),g=c.prefix?c.prefix+"_":"";return function(x){var E=h(x),P=g+E,L=n[P];return L||(n[P]=L=new ol.style.Style({image:new ol.style.FontSymbol({glyph:E,radius:u,fill:d,stroke:m})})),[L]}}}(),ol.source.DFCI=function(n){n=n||{},n.loader=this._calcGrid,n.strategy=function(c,h){return this.resolution&&this.resolution!=h&&(this.clear(),this.refresh()),[c]},this._bbox=[[0,16e5],[11*1e5,16e5+10*1e5]],ol.source.Vector.call(this,n),this.set("resolutions",n.resolutions||[1e3,100,20]),proj4.defs["EPSG:27572"]||proj4.defs("EPSG:27572","+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),ol.proj.proj4.register(proj4)},ol.ext.inherits(ol.source.DFCI,ol.source.Vector),ol.source.DFCI.prototype._calcGrid=function(n,c,h){var u,d,m=this.get("resolutions");c>(m[0]||1e3)?this.resolution!=c&&(this._features0||(d=[this._bbox[0][0],this._bbox[0][1],this._bbox[1][0],this._bbox[1][1]],this._features0=this._getFeatures(0,d,h)),this.addFeatures(this._features0)):c>(m[1]||100)?(this.clear(),d=ol.proj.transformExtent(n,h,"EPSG:27572"),u=this._getFeatures(1,d,h),this.addFeatures(u)):c>(m[2]||0)?(this.clear(),d=ol.proj.transformExtent(n,h,"EPSG:27572"),u=this._getFeatures(2,d,h),this.addFeatures(u)):(this.clear(),d=ol.proj.transformExtent(n,h,"EPSG:27572"),u=this._getFeatures(3,d,h),this.addFeatures(u)),this.resolution=c},ol.source.DFCI.prototype._midPt=function(n,c){return[(n[0]+c[0])/2,(n[1]+c[1])/2]},ol.source.DFCI.prototype._trFeature=function(n,c,h,u){var d=new ol.geom.Polygon([n]),m=new ol.Feature(d.transform("EPSG:27572",u));return m.set("id",c),m.set("level",h),m},ol.source.DFCI.prototype._getFeatures=function(n,c,h){var u=[],d,m=1e5;n>0&&(m/=5),n>1&&(m/=10);for(var g=[Math.max(this._bbox[0][0],Math.floor(c[0]/m)*m),Math.max(this._bbox[0][1],Math.floor(c[1]/m)*m)],x=[Math.min(this._bbox[1][0]+99999,Math.floor(c[2]/m)*m),Math.min(this._bbox[1][1]+99999,Math.floor(c[3]/m)*m)],E=g[0];E<=x[0];E+=m)for(var P=g[1];P<=x[1];P+=m){var L,F=[[E,P],[E+m,P],[E+m,P+m],[E,P+m],[E,P]];if(n>2){var U=this._midPt(F[0],F[2]),A=[];for(d=0;d<F.length;d++)A.push(this._midPt(F[d],U));for(u.push(this._trFeature(A,ol.coordinate.toDFCI([E,P],2)+".5",n,h)),d=0;d<4;d++)A=[],A.push(F[d]),A.push(this._midPt(F[d],F[(d+1)%4])),A.push(this._midPt(U,A[1])),A.push(this._midPt(U,F[d])),L=this._midPt(F[d],F[(d+3)%4]),A.push(this._midPt(U,L)),A.push(L),A.push(F[d]),u.push(this._trFeature(A,ol.coordinate.toDFCI([E,P],2)+"."+(4-d),n,h))}else u.push(this._trFeature(F,ol.coordinate.toDFCI([E,P],n),n,h))}return u},ol.source.DayNight=function(n){n=n||{},n.loader=this._loader,n.strategy=ol.loadingstrategy.all,ol.source.Vector.call(this,n),this.set("time",n.time||new Date),this.set("step",n.step||1)},ol.ext.inherits(ol.source.DayNight,ol.source.Vector),function(){ol.source.DayNight.prototype._loader=function(u,d,m){var g=this.getCoordinates(this.get("time")),x=new ol.geom.Polygon([g]);x.transform("EPSG:4326",m),this.addFeature(new ol.Feature(x))},ol.source.DayNight.prototype.setTime=function(u){this.set("time",u),this.refresh()};function n(u){var d=Math.PI/180,m=u-2451545,g=280.46+.9856474*m;g%=360;var x=357.528+.9856003*m;x%=360;var E=g+1.915*Math.sin(x*d)+.02*Math.sin(2*x*d),P=1.00014-.01671*Math.cos(x*d)-.0014*Math.cos(2*x*d);return{lambda:E,R:P}}function c(u){var d=u-2451545,m=d/36525,g=23.43929111-m*(46.836769/3600-m*(1831e-7/3600+m*(.0020034/3600-m*(576e-9/3600-m*434e-10/3600))));return g}function h(u,d){var m=180/Math.PI,g=Math.PI/180,x=Math.atan(Math.cos(d*g)*Math.tan(u*g))*m,E=Math.asin(Math.sin(d*g)*Math.sin(u*g))*m,P=Math.floor(u/90)*90,L=Math.floor(x/90)*90;return x=x+(P-L),{alpha:x,delta:E}}ol.source.DayNight.prototype.getSunPosition=function(u){var d=u?new Date(u):new Date,m=d/864e5+24405875e-1,g=(18.697374558+24.06570982441908*(m-2451545))%24,x=n(m),E=c(m),P=h(x.lambda,E);return[P.alpha-g*15,P.delta]},ol.source.DayNight.getNightLat=function(u,d){var m=180/Math.PI,g=Math.PI/180,x=d?new Date(d):new Date,E=x/864e5+24405875e-1,P=(18.697374558+24.06570982441908*(E-2451545))%24,L=n(E),F=c(E),U=h(L.lambda,F),A=P*15+u-U.alpha,G=Math.atan(-Math.cos(A*g)/Math.tan(U.delta*g))*m;return G},ol.source.DayNight.prototype.getCoordinates=function(u,d){for(var m=180/Math.PI,g=Math.PI/180,x=u?new Date(u):new Date,E=x/864e5+24405875e-1,P=(18.697374558+24.06570982441908*(E-2451545))%24,L=[],F=n(E),U=c(E),A=h(F.lambda,U),G=this.get("step")||1,B=-180;B<=180;B+=G){var O=B,K=P*15+O-A.alpha,Q=Math.atan(-Math.cos(K*g)/Math.tan(A.delta*g))*m;L.push([O,Q])}switch(d){case"line":break;case"day":A.delta*=-1;default:{Q=A.delta<0?90:-90;for(var et=180;et>=-180;et-=G)L.push([et,Q]);L.push(L[0]);break}}if(d==="daynight"){var lt=[];L.forEach(function(pt){lt.push(pt.slice())}),lt[0][1]=-lt[0][1],lt[lt.length-1][1]=-lt[0][1],lt[lt.length-1][1]=-lt[0][1],L=[L,lt]}return L}}(),ol.source.Delaunay=function(n){n=n||{},this._nodes=n.source,delete n.source,ol.source.Vector.call(this,n),this.hull=[],this._nodes.on("addfeature",this._onAddNode.bind(this)),this._nodes.on("removefeature",this._onRemoveNode.bind(this)),this.set("epsilon",n.epsilon||1e-4)},ol.ext.inherits(ol.source.Delaunay,ol.source.Vector),ol.source.Delaunay.prototype.clear=function(n){ol.source.Vector.prototype.clear.call(this,n),this.getNodeSource().clear(n)},ol.source.Delaunay.prototype._addTriangle=function(n){n.push(n[0]);var c=new ol.Feature(new ol.geom.Polygon([n]));return this.addFeature(c),this.flip.push(c),c},ol.source.Delaunay.prototype.getNodes=function(){return this._nodes.getFeatures()},ol.source.Delaunay.prototype.getNodeSource=function(){return this._nodes},ol.source.Delaunay.prototype._onRemoveNode=function(n){var c=n.feature.getGeometry().getCoordinates();if(!c||this.getNodesAt(c).length)return;var h=this.getTrianglesAt(c);this.flip=[];for(var u,d=[];h.length;){var m=h.pop();this.removeFeature(m),m=m.getGeometry().getCoordinates()[0];var g=[];for(u=0;u<3;u++)L=m[u],ol.coordinate.equal(L,c)||g.push(L);d.push(g)}g=d.pop(),u=0;function x(K,Q,et){return ol.coordinate.equal(K,g[et])?(et?g.push(Q):g.unshift(Q),!0):!1}for(;;){var E=d[u];if(x(E[0],E[1],0)||x(E[1],E[0],0)||x(E[0],E[1],g.length-1)||x(E[1],E[0],g.length-1)?(d.splice(u,1),u=0):u++,!d.length)break;if(u>=d.length)throw"[DELAUNAY:removePoint] No edge found"}var P=ol.coordinate.equal(g[0],g[g.length-1]);P&&g.pop();var L;for(u;L=this.hull[u];u++)if(ol.coordinate.equal(c,L)){this.hull.splice(u,1);break}this.hull=ol.coordinate.convexHull(this.hull.concat(g));var F=function(K){for(var Q,et=0,lt=0;lt<K.length;lt++)Q=(lt+1)%K.length,et+=(K[Q][0]-K[lt][0])*(K[Q][1]+K[lt][1]);return et>=0?1:-1},U,A=g.slice();for(P?U=F(g):(A.push(c),U=F(A)),u=0;u<=g.length+1&&!(g.length<3);u++){var G=[g[u%g.length],g[(u+1)%g.length],g[(u+2)%g.length]];if(F(G)===U){for(var B=!0,O=u+3;O<u+g.length;O++)if(this.inCircle(g[O%g.length],G)){B=!1;break}B&&(this._addTriangle(G),g.splice((u+1)%g.length,1),u=-1)}}this.flipTriangles()},ol.source.Delaunay.prototype._onAddNode=function(n){var c=n.feature,h,u;if(c.getGeometry().getType()!=="Point"){this._nodes.removeFeature(c);return}this.flip=[];var d=this.getNodes(),m=c.getGeometry().getCoordinates();if(this.getNodesAt(m).length>1){this._nodes.removeFeature(c);return}if(d.length<=3){if(d.length===3){var g=[];for(h=0;h<3;h++)g.push(d[h].getGeometry().getCoordinates());this._addTriangle(g),this.hull=ol.coordinate.convexHull(g)}return}var x=this.getFeaturesAtCoordinate(m)[0];if(x){this.removeFeature(x),x.set("del",!0);var E=x.getGeometry().getCoordinates()[0];for(h=0;h<3;h++)this._addTriangle([m,E[h],E[(h+1)%3]])}else{var P=this.hull.slice();for(P.push(m),P=ol.coordinate.convexHull(P),h=0;(u=P[h])&&!ol.coordinate.equal(u,m);h++);h=h!==0?h-1:P.length-1;var L=P[h],F=P[(h+2)%P.length];for(h=0;(u=this.hull[h])&&!ol.coordinate.equal(u,L);h++);for(;;){if(h>1e3){console.error("[DELAUNAY:addPoint] Too many iterations");break}if(h++,u=this.hull[h%this.hull.length],this._addTriangle([m,u,L]),L=u,u[0]===F[0]&&u[1]===F[1])break}this.hull=P}this.flipTriangles()},ol.source.Delaunay.prototype.flipTriangles=function(){for(var n=1e3,c;this.flip.length;){if(n--<0){console.error("[DELAUNAY:flipTriangles] Too many iterations");break}var h=this.flip.pop();if(!h.get("del"))for(var u=h.getGeometry().getCoordinates()[0],d=0;d<3;d++){var m=[(u[(d+1)%3][0]+u[d][0])/2,(u[(d+1)%3][1]+u[d][1])/2],g=this.getTrianglesAt(m),x=null;if(g.length>1){var E=g[0].getGeometry().getCoordinates()[0],P=g[1].getGeometry().getCoordinates()[0];for(c=0;c<P.length;c++)if(!this._ptInTriangle(P[c],E)){x=P[c];break}}if(x&&this.inCircle(x,E)){var L;for(c=0;c<E.length;c++)if(!this._ptInTriangle(E[c],P)){L=E.splice(c,1)[0];break}if(this.intersectSegs([x,L],E)){for(;g.length;){var F=g.pop();F.set("del",!0),this.removeFeature(F)}this._addTriangle([x,L,E[0]]),this._addTriangle([x,L,E[1]])}}}}},ol.source.Delaunay.prototype.intersectSegs=function(n,c){var h=n[1][0]-n[0][0],u=n[1][1]-n[0][1],d=c[1][0]-c[0][0],m=c[1][1]-c[0][1],g=h*m-u*d;if(g!=0){var x=(h*n[0][1]-h*c[0][1]-u*n[0][0]+u*c[0][0])/g;return 0<x&&x<1}else return!1},ol.source.Delaunay.prototype._ptInTriangle=function(n,c){for(var h=0,u;u=c[h];h++)if(ol.coordinate.equal(n,u))return!0;return!1},ol.source.Delaunay.prototype.listpt=function(n){for(var c="",h=0,u;u=n[h];h++){var d=this._nodes.getClosestFeatureToCoordinate(u);ol.coordinate.equal(d.getGeometry().getCoordinates(),u)||(d=null),c+=(c?", ":"")+(d?d.get("id"):"?")}return c},ol.source.Delaunay.prototype.inCircle=function(n,c){var h=this.getCircumCircle(c);return ol.coordinate.dist2d(n,h.center)<h.radius},ol.source.Delaunay.prototype.getCircumCircle=function(n){var c=n[0][0],h=n[0][1],u=n[1][0],d=n[1][1],m=n[2][0],g=n[2][1],x=(c-u)/(d-h),E=(c-m)/(g-h),P=(h+d)/2-x*(c+u)/2,L=(h+g)/2-E*(c+m)/2,F=(L-P)/(x-E),U=x*F+P,A=[F,U];return{center:A,radius:ol.coordinate.dist2d(A,n[0])}},ol.source.Delaunay.prototype.getTrianglesAt=function(n){var c=ol.extent.buffer(ol.extent.boundingExtent([n]),this.get("epsilon")),h=[];return this.forEachFeatureIntersectingExtent(c,function(u){h.push(u)}),h},ol.source.Delaunay.prototype.getNodesAt=function(n){var c=ol.extent.buffer(ol.extent.boundingExtent([n]),this.get("epsilon"));return this._nodes.getFeaturesInExtent(c)},ol.source.Delaunay.prototype.calculateVoronoi=function(n){var c=[];return this.getNodes().forEach(function(h){var u=h.getGeometry().getCoordinates(),d=!1;if(n!==!0){for(var m=0;m<this.hull.length;m++)if(ol.coordinate.equal(u,this.hull[m])){d=!0;break}}if(!d){var g=this.getTrianglesAt(u),x=[];g.forEach(function(L){var F=this.getCircumCircle(L.getGeometry().getCoordinates()[0]);x.push({pt:F.center,d:Math.atan2(F.center[1]-u[1],F.center[0]-u[0])})}.bind(this)),x.sort(function(L,F){return L.d-F.d});var E=[];x.forEach(function(L){E.push(L.pt)}),E.push(E[0]);var P=h.getProperties();P.geometry=new ol.geom.Polygon([E]),c.push(new ol.Feature(P))}}.bind(this)),c},ol.source.FeatureBin=function(n){if(n=n||{},n.binSource){this._sourceFeature=n.binSource;var c;this._sourceFeature.on(["addfeature","changefeature","removefeature"],function(){c&&clearTimeout(c),c=setTimeout(function(){this.reset()}.bind(this))}.bind(this))}else this._sourceFeature=new ol.source.Vector({features:n.features||[]});ol.source.BinBase.call(this,n)},ol.ext.inherits(ol.source.FeatureBin,ol.source.BinBase),ol.source.FeatureBin.prototype.setFeatures=function(n){this._sourceFeature.clear(),this._sourceFeature.addFeatures(n||[]),this.reset()},ol.source.FeatureBin.prototype.getGridGeomAt=function(n,c){var h=this._sourceFeature.getFeaturesAtCoordinate(n)[0];if(!h)return null;var u=h.getProperties();for(var d in u)d!=="geometry"&&(c[d]=u[d]);return h.getGeometry()},ol.source.GeoImage=function(n){var c={attributions:n.attributions,logo:n.logo,projection:n.projection};this._image=n.image?n.image:new Image,this._image.crossOrigin=n.crossOrigin;var h=this;this._image.onload=function(){h.setCrop(h.crop),h.changed()},n.image||(this._image.src=n.url),c.canvasFunction=this.calculateImage,ol.source.ImageCanvas.call(this,c),this.center=n.imageCenter,this.setScale(n.imageScale),this.rotate=n.imageRotate?n.imageRotate:0,this.crop=n.imageCrop,this.mask=n.imageMask,this.setCrop(this.crop),this.on("change",function(){this.set("extent",this.calculateExtent())}.bind(this))},ol.ext.inherits(ol.source.GeoImage,ol.source.ImageCanvas),ol.source.GeoImage.prototype.calculateImage=function(n,c,h,u){if(!this.center)return;var d=document.createElement("canvas");d.width=u[0],d.height=u[1];var m=d.getContext("2d");if(!this._imageSize)return d;function g(G){return[(G[0]-n[0])/(n[2]-n[0])*u[0],(G[1]-n[3])/(n[1]-n[3])*u[1]]}if(this.mask){m.beginPath();var x=g(this.mask[0]);m.moveTo(x[0],x[1]);for(var E=1;E<this.mask.length;E++)x=g(this.mask[E]),m.lineTo(x[0],x[1]);m.clip()}var P=g(this.center),L=(this._image.naturalWidth/2-this.crop[0])*this.scale[0]/c*h,F=(this._image.naturalHeight/2-this.crop[1])*this.scale[1]/c*h,U=this._imageSize[0]*this.scale[0]/c*h,A=this._imageSize[1]*this.scale[1]/c*h;return m.translate(P[0],P[1]),this.rotate&&m.rotate(this.rotate),m.drawImage(this._image,this.crop[0],this.crop[1],this._imageSize[0],this._imageSize[1],-L,-F,U,A),d},ol.source.GeoImage.prototype.getCenter=function(){return this.center},ol.source.GeoImage.prototype.setCenter=function(n){this.center=n,this.changed()},ol.source.GeoImage.prototype.getScale=function(){return this.scale},ol.source.GeoImage.prototype.setScale=function(n){switch(typeof n){case"number":n=[n,n];break;case"object":if(n.length!=2)return;break;default:return}this.scale=n,this.changed()},ol.source.GeoImage.prototype.getRotation=function(){return this.rotate},ol.source.GeoImage.prototype.setRotation=function(n){this.rotate=n,this.changed()},ol.source.GeoImage.prototype.getGeoImage=function(){return this._image},ol.source.GeoImage.prototype.getCrop=function(){return this.crop},ol.source.GeoImage.prototype.setMask=function(n){this.mask=n,this.changed()},ol.source.GeoImage.prototype.getMask=function(){return this.mask},ol.source.GeoImage.prototype.setCrop=function(n){if(!this._image.naturalWidth){this.crop=n;return}if(n){switch(typeof n){case"number":n=[n,n,this._image.naturalWidth-n,this._image.naturalHeight-n];break;case"object":if(n.length!=4)return;break;default:return}n=ol.extent.boundingExtent([[n[0],n[1]],[n[2],n[3]]]),this.crop=[Math.max(0,n[0]),Math.max(0,n[1]),Math.min(this._image.naturalWidth,n[2]),Math.min(this._image.naturalHeight,n[3])]}else this.crop=[0,0,this._image.naturalWidth,this._image.naturalHeight];this.crop[2]<=this.crop[0]&&(this.crop[2]=this.crop[0]+1),this.crop[3]<=this.crop[1]&&(this.crop[3]=this.crop[1]+1),this._imageSize=[this.crop[2]-this.crop[0],this.crop[3]-this.crop[1]],this.changed()},ol.source.GeoImage.prototype.getExtent=function(n){var c=this.get("extent");if(c||(c=this.calculateExtent()),n)for(var h=0;h<n.length;h++)n[h]=c[h];return c},ol.source.GeoImage.prototype.calculateExtent=function(n){var c;if(n!==!1&&this.getMask())c=new ol.geom.Polygon([this.getMask()]);else{var h=this.getCenter(),u=this.getScale(),d=this.getGeoImage().width*u[0],m=this.getGeoImage().height*u[1],g=ol.extent.boundingExtent([[h[0]-d/2,h[1]-m/2],[h[0]+d/2,h[1]+m/2]]);c=ol.geom.Polygon.fromExtent(g),c.rotate(-this.getRotation(),h)}var x=c.getExtent();return x},ol.source.GeoRSS=function(n){n=n||{},n.loader=this._loaderFn,ol.source.Vector.call(this,n)},ol.ext.inherits(ol.source.GeoRSS,ol.source.Vector),ol.source.GeoRSS.prototype._loaderFn=function(n,c,h){ol.ext.Ajax.get({url:this.getUrl(),dataType:"XML",error:function(){console.log("oops")},success:function(u){var d=new ol.format.GeoRSS().readFeatures(u,{featureProjection:h});this.addFeatures(d)}.bind(this)})},ol.source.Geoportail=function(n,c){c=c||{},n.layer&&(c=n,n=c.layer);for(var h=new Array,u=new Array,d=ol.extent.getWidth(ol.proj.get("EPSG:3857").getExtent())/256,m=0;m<=(c.maxZoom?c.maxZoom:20);m++)h[m]=m,u[m]=d/Math.pow(2,m);var g=new ol.tilegrid.WMTS({origin:[-20037508,20037508],resolutions:u,matrixIds:h});g.minZoom=c.minZoom?c.minZoom:0;var x=[ol.source.Geoportail.prototype.attribution];c.attributions&&(x=c.attributions),this._server=c.server||"https://wxs.ign.fr/geoportail/wmts",this._gppKey=c.gppKey||c.key||"choisirgeoportail";var E={url:this.serviceURL(),layer:n,matrixSet:"PM",format:c.format?c.format:"image/jpeg",projection:"EPSG:3857",tileGrid:g,style:c.style?c.style:"normal",attributions:x,crossOrigin:typeof c.crossOrigin>"u"?"anonymous":c.crossOrigin,wrapX:c.wrapX!==!1};ol.source.WMTS.call(this,E),c.authentication&&this.setTileLoadFunction(ol.source.Geoportail.tileLoadFunctionWithAuthentication(c.authentication,this.getFormat()))},ol.ext.inherits(ol.source.Geoportail,ol.source.WMTS),ol.source.Geoportail.prototype.attribution='<a href="http://www.geoportail.gouv.fr/">G\xE9oportail</a> &copy; <a href="http://www.ign.fr/">IGN-France</a>',ol.source.Geoportail.prototype.serviceURL=function(){return this._server?this._server.replace(/^(https?:\/\/[^/]*)(.*)$/,"$1/"+this._gppKey+"$2"):(window.geoportailConfig?window.geoportailConfig.url:"https://wxs.ign.fr/")+this._gppKey+"/geoportail/wmts"},ol.source.Geoportail.prototype.getGPPKey=function(){return this._gppKey},ol.source.Geoportail.prototype.setGPPKey=function(n,c){this._gppKey=n;var h=this.serviceURL();this.setTileUrlFunction(function(){var u=ol.source.Geoportail.prototype.getTileUrlFunction().apply(this,arguments);if(u){var d=u.split("?");return h+"?"+d[1]}else return u}),c&&this.setTileLoadFunction(ol.source.Geoportail.tileLoadFunctionWithAuthentication(c,this.getFormat()))},ol.source.Geoportail.prototype.getFeatureInfoUrl=function(n,c,h,u){u=u||{},h||(h=this.getProjection());var d=this.tileGrid.getTileCoordForCoordAndResolution(n,c),m=1,g=this.getTileUrlFunction()(d,m,h);if(!g)return g;var x=this.tileGrid.getResolution(d[0]),E=this.tileGrid.getTileCoordExtent(d),P=Math.floor((n[0]-E[0])/(x/m)),L=Math.floor((E[3]-n[1])/(x/m));return g.replace(/Request=GetTile/i,"Request=getFeatureInfo")+"&INFOFORMAT="+(u.INFO_FORMAT||"text/plain")+"&I="+P+"&J="+L},ol.source.Geoportail.prototype.getFeatureInfo=function(n,c,h){var u=this.getFeatureInfoUrl(n,c,null,h);ol.ext.Ajax.get({url:u,dataType:h.format||"text/plain",options:{encode:!1},success:function(d){h.callback&&h.callback(d)},error:h.error||function(){}})},ol.source.Geoportail.tileLoadFunctionWithAuthentication=function(n,c){if(n)return function(h,u){var d=new XMLHttpRequest;d.open("GET",u),d.setRequestHeader("Authorization","Basic "+n),d.responseType="arraybuffer",d.onload=function(){var m=new Uint8Array(this.response),g=new Blob([m],{type:c}),x=window.URL||window.webkitURL,E=x.createObjectURL(g);h.getImage().src=E},d.onerror=function(){h.getImage().src=""},d.send()}},ol.source.GridBin=function(n){n=n||{},ol.source.BinBase.call(this,n),this.set("gridProjection",n.gridProjection||"EPSG:4326"),this.set("size",n.size||1)},ol.ext.inherits(ol.source.GridBin,ol.source.BinBase),ol.source.GridBin.prototype.setGridProjection=function(n){this.set("gridProjection",n),this.reset()},ol.source.GridBin.prototype.setSize=function(n){this.set("size",n),this.reset()},ol.source.GridBin.prototype.getGridGeomAt=function(n){n=ol.proj.transform(n,this.getProjection()||"EPSG:3857",this.get("gridProjection"));var c=this.get("size"),h=c*Math.floor(n[0]/c),u=c*Math.floor(n[1]/c),d=new ol.geom.Polygon([[[h,u],[h+c,u],[h+c,u+c],[h,u+c],[h,u]]]);return d.transform(this.get("gridProjection"),this.getProjection()||"EPSG:3857")},ol.source.HexBin=function(n){n=n||{},this._hexgrid=new ol.HexGrid(n),ol.source.BinBase.call(this,n)},ol.ext.inherits(ol.source.HexBin,ol.source.BinBase),ol.source.HexBin.prototype.getGridGeomAt=function(n){var c=this._hexgrid.coord2hex(n);return new ol.geom.Polygon([this._hexgrid.getHexagon(c)])},ol.source.HexBin.prototype.setSize=function(n,c){this._hexgrid.setSize(n),c||this.reset()},ol.source.HexBin.prototype.getSize=function(){return this._hexgrid.getSize()},ol.source.HexBin.prototype.setLayout=function(n,c){this._hexgrid.setLayout(n),c||this.reset()},ol.source.HexBin.prototype.getLayout=function(){return this._hexgrid.getLayout()},ol.source.HexBin.prototype.setOrigin=function(n,c){this._hexgrid.setOrigin(n),c||this.reset()},ol.source.HexBin.prototype.getOrigin=function(){return this._hexgrid.getOrigin()},ol.source.HexBin.prototype.getHexFeatures=function(){return ol.source.BinBase.prototype.getGridFeatures.call(this)},ol.source.IDW=function(n){n=n||{},n.canvasFunction=this.calculateImage,this._source=n.source,this._canvas=document.createElement("CANVAS"),this._source.on(["addfeature","removefeature","clear","removefeature"],function(){this.changed()}.bind(this)),ol.source.ImageCanvas.call(this,n),this.set("scale",n.scale||4),this._weight=typeof n.weight=="function"?n.weight:function(c){return c.get(n.weight||"weight")}},ol.ext.inherits(ol.source.IDW,ol.source.ImageCanvas),ol.source.IDW.prototype.getSource=function(){return this._source},ol.source.IDW.prototype.hue2rgb=function(n){return n=(n+6)%6,n<1?Math.round(n*255):n<3?255:n<4?Math.round((4-n)*255):0},ol.source.IDW.prototype.getColor=function(n){var c=4-.04*n;return[this.hue2rgb(c+2),this.hue2rgb(c),this.hue2rgb(c-2),255]},ol.source.IDW.prototype.setData=function(n,c,h){var u=this.getColor(n);c[h]=u[0],c[h+1]=u[1],c[h+2]=u[2],c[h+3]=u[3]},ol.source.IDW.prototype.getValue=function(n){if(!this._canvas)return null;var c=this.transform(n),h=this._canvas.getContext("2d").getImageData(Math.round(c[0]),Math.round(c[1]),1,1).data;return h},ol.source.IDW.prototype.calculateImage=function(n,c,h,u){if(!this._source)return this._canvas;var d=document.createElement("CANVAS"),m=d.width=Math.round(u[0]/(this.get("scale")*h)),g=d.height=Math.round(u[1]/(this.get("scale")*h)),x=d.getContext("2d"),E=x.getImageData(0,0,m,g),P=[],L=m/(n[2]-n[0]),F=g/(n[1]-n[3]),U=this.transform=function(T,ct){return[(T[0]-n[0])*L,(T[1]-n[3])*F,ct]};this._source.getFeatures().forEach(function(T){P.push(U(T.getGeometry().getFirstCoordinate(),this._weight(T)))}.bind(this));var A,G;for(G=0;G<g;G++)for(A=0;A<m;A++){for(var B=0,O=0,K=0;K<P.length;++K){var Q=A-P[K][0],et=G-P[K][1],lt=Q*Q+et*et;if(lt===0){O=1,B=P[K][2];break}var pt=1/(lt*lt);B+=pt*P[K][2],O+=pt}this.setData(B/O,E.data,(G*m+A)*4)}return x.putImageData(E,0,0),this._canvas.width=Math.round(u[0]),this._canvas.height=Math.round(u[1]),this._canvas.getContext("2d").drawImage(d,0,0,u[0],u[1]),this._canvas},ol.source.InseeBin=function(n){n=n||{},this._grid=new ol.InseeGrid({size:n.size}),ol.source.BinBase.call(this,n)},ol.ext.inherits(ol.source.InseeBin,ol.source.BinBase),ol.source.InseeBin.prototype.setSize=function(n){this.getSize()!==n&&(this._grid.set("size",n),this.reset())},ol.source.InseeBin.prototype.getSize=function(){return this._grid.get("size")},ol.source.InseeBin.prototype.getGridGeomAt=function(n){return this._grid.getGridAtCoordinate(n,this.getProjection())},ol.source.InseeBin.prototype.getGridExtent=function(n){return this._grid.getExtent(n)},ol.source.Mapillary=function(n){var c=n||{};c.loader=this._loaderFn,this._maxResolution=c.maxResolution||100,this._limit=c.limit||100,c.attributions||(c.attributions=["&copy; <a href='https://www.mapillary.com/'>Mapillary</a>"]),c.strategy||(c.strategy=ol.loadingstrategy.bbox),ol.source.Vector.call(this,c)},ol.ext.inherits(ol.source.Mapillary,ol.source.Vector),ol.source.Mapillary.prototype.readFeature=function(){return!0},ol.source.Mapillary.prototype._loaderFn=function(n,c,h){if(!(c>this._maxResolution)){var u=ol.proj.transformExtent(n,h,"EPSG:4326"),d=Date.now()-6*30*24*60*60*1e3,m="https://a.mapillary.com/v2/search/im?client_id="+this.get("clientId")+"&max_lat="+u[3]+"&max_lon="+u[2]+"&min_lat="+u[1]+"&min_lon="+u[0]+"&limit="+(this._limit-1)+"&start_time="+d;ol.ext.Ajax.get({url:m,dataType:"jsonp",success:function(g){console.log(g)}})}},ol.source.OilPainting=function(n){n.operation=this._operation,n.operationType="image",ol.source.Raster.call(this,n),this.set("radius",n.radius||4),this.set("intensity",n.intensity||25),this.on("beforeoperations",function(c){var h=Math.round((c.extent[2]-c.extent[0])/c.resolution),u=Math.round((c.extent[3]-c.extent[1])/c.resolution);c.data.image=new ImageData(h,u),c.data.radius=Number(this.get("radius"))||1,c.data.intensity=Number(this.get("intensity"))}.bind(this))},ol.ext.inherits(ol.source.OilPainting,ol.source.Raster),ol.source.OilPainting.prototype.set=function(n,c){if(c)switch(n){case"intensity":case"radius":{c=Number(c),c<1&&(c=1),this.changed();break}}return ol.source.Raster.prototype.set.call(this,n,c)},ol.source.OilPainting.prototype._operation=function(n,c){for(var h=n[0].width,u=n[0].height,d=n[0],m=d.data,g=[],x=c.image,E=x.data,P=[],L=[],F=0;F<u;F++){P[F]=[],L[F]=[];for(var U=0;U<h;U++){var A=(F*h+U)*4,G=m[A],B=m[A+1],O=m[A+2],K=(G+B+O)/3;P[F][U]=Math.round(K*c.intensity/255),L[F][U]={r:G,g:B,b:O}}}var Q=c.radius;for(F=0;F<u;F++)for(U=0;U<h;U++){g=[];for(var et=-Q;et<=Q;et++)for(var lt=-Q;lt<=Q;lt++)if(F+et>0&&F+et<u&&U+lt>0&&U+lt<h){var pt=P[F+et][U+lt];g[pt]?(g[pt].val++,g[pt].r+=L[F+et][U+lt].r,g[pt].g+=L[F+et][U+lt].g,g[pt].b+=L[F+et][U+lt].b):g[pt]={val:1,r:L[F+et][U+lt].r,g:L[F+et][U+lt].g,b:L[F+et][U+lt].b}}g.sort(function(ut,ft){return ft.val-ut.val});var T=g[0].val,ct=(F*h+U)*4;E[ct]=~~(g[0].r/T),E[ct+1]=~~(g[0].g/T),E[ct+2]=~~(g[0].b/T),E[ct+3]=255}return x},ol.source.Overpass=function(n){n=n||{},n.loader=this._loaderFn,this._url=n.url||"https://overpass-api.de/api/interpreter",this._maxResolution=n.maxResolution||100,n.attributions||(n.attributions=ol.source.OSM.ATTRIBUTION),n.strategy||(n.strategy=ol.loadingstrategy.bbox),ol.source.Vector.call(this,n),this._types={node:n.node!==!1,way:n.way!==!1,rel:n.rel===!0},this._filter=n.filter},ol.ext.inherits(ol.source.Overpass,ol.source.Vector),ol.source.Overpass.prototype._loaderFn=function(n,c,h){if(!(c>this._maxResolution)){var u=this,d=ol.proj.transformExtent(n,h,"EPSG:4326");d=d[1]+","+d[0]+","+d[3]+","+d[2];var m="[bbox:"+d+"][out:xml][timeout:25];";m+="(";for(var g in this._types)if(this._types[g]){m+=g;for(var x=0,E;E=this._filter[x];x++)m+="["+E+"]";m+=";"}m+=");out;>;out skel qt;";var P=new XMLHttpRequest;P.open("POST",this._url,!0),P.onload=function(){for(var L=new ol.format.OSMXML().readFeatures(this.responseText,{featureProjection:h}),F=[],U=0,A;A=L[U];U++)u.hasFeature(A)||F.push(A);u.addFeatures(F)},P.onerror=function(){console.log(arguments)},P.send("data="+m)}},ol.source.Overpass.prototype.hasFeature=function(n){for(var c=n.getGeometry().getFirstCoordinate(),h=n.getId(),u=this.getFeaturesInExtent([c[0]-.1,c[1]-.1,c[0]+.1,c[1]+.1]),d=0,m;m=u[d];d++)if(h===m.getId())return!0;return!1},ol.source.TileWFS=function(n){n=n||{},n.featureLimit||(n.featureLimit=1/0);var c=n.tileZoom||14,h={strategy:ol.loadingstrategy.tile(ol.tilegrid.createXYZ({minZoom:c,maxZoom:c,tileSize:512}))},u=new ol.format.GeoJSON,d=n.url+"?service=WFS&request=GetFeature&version="+(n.version||"1.1.0")+"&typename="+(n.typeName||"")+"&outputFormat=application/json";n.maxFeatures&&(d+="&maxFeatures="+n.maxFeatures+"&count="+n.maxFeatures);var m={loading:0,loaded:0};h.loader=function(g,x,E){m.loading===m.loaded&&(m.loading=m.loaded=0,this.getFeatures().length>n.maxFeatures&&(this.clear(),this.refresh())),m.loading++,this.dispatchEvent({type:"tileloadstart",loading:m.loading,loaded:m.loaded}),this._loadTile(d,g,E,u,m)},ol.source.Vector.call(this,h),this.set("pagination",n.pagination)},ol.ext.inherits(ol.source.TileWFS,ol.source.Vector),ol.source.TileWFS.prototype._loadTile=function(n,c,h,u,d){var m=n+"&srsname="+h.getCode()+"&bbox="+c.join(",")+","+h.getCode();this.get("pagination")&&!/&startIndex/.test(n)&&(m+="&startIndex=0"),ol.ext.Ajax.get({url:m,success:function(g){if(d.loaded++,g.error)this.dispatchEvent({type:"tileloaderror",error:g,loading:d.loading,loaded:d.loaded});else{var x=u.readFeatures(g,{featureProjection:h});x.length>0&&this.addFeatures(x);var E=g.numberReturned||0;/&startIndex/.test(n)&&(E+=parseInt(n.replace(/.*&startIndex=(\d*).*/,"$1")),n=n.replace(/&startIndex=(\d*)/,"")),E<g.totalFeatures?this.get("pagination")?(n+="&startIndex="+E,d.loaded--,this._loadTile(n,c,h,u,d)):(this.dispatchEvent({type:"overload",total:g.totalFeatures,returned:g.numberReturned}),this.dispatchEvent({type:"tileloadend",loading:d.loading,loaded:d.loaded})):this.dispatchEvent({type:"tileloadend",loading:d.loading,loaded:d.loaded})}}.bind(this),error:function(g){d.loaded++,this.dispatchEvent({type:"tileloaderror",error:g,loading:d.loading,loaded:d.loaded})}.bind(this)})},function(){var n=ol.source.Vector.prototype.clear;ol.source.Vector.prototype.clear=function(c){this.dispatchEvent({type:"clearstart"}),n.call(this,c),this.dispatchEvent({type:"clearend"})}}(),ol.layer.Vector3D=function(n){n=n||{},this._source=n.source,this.height_=this.getHfn(n.height);var c=document.createElement("canvas");ol.layer.Image.call(this,{source:new ol.source.ImageCanvas({canvasFunction:function(h,u,d,m){return c.width=m[0],c.height=m[1],c}}),center:n.center||[.5,1],defaultHeight:n.defaultHeight||0,maxResolution:n.maxResolution||1/0}),this.setStyle(n.style),this.on(["postcompose","postrender"],this.onPostcompose_.bind(this))},ol.ext.inherits(ol.layer.Vector3D,ol.layer.Image),ol.layer.Vector3D.prototype.setHeight=function(n){this.height_=this.getHfn(n),this.changed()},ol.layer.Vector3D.prototype.setStyle=function(n){if(n instanceof ol.style.Style?this._style=n:this._style=new ol.style.Style,this._style.getStroke()||this._style.setStroke(new ol.style.Stroke({width:1,color:"red"})),this._style.getFill()||this._style.setFill(new ol.style.Fill({color:"rgba(0,0,255,0.5)"})),this._style.getText()||this._style.setText(new ol.style.Fill({color:"red"})),n&&n.getGeometry()){var c=n.getGeometry();typeof c=="function"?this.set("geometry",c):this.set("geometry",function(){return c})}else this.set("geometry",function(h){return h.getGeometry()})},ol.layer.Vector3D.prototype.getStyle=function(){return this._style},ol.layer.Vector3D.prototype.onPostcompose_=function(n){var c=n.frameState.viewState.resolution;if(!(c>this.get("maxResolution"))){if(this.res_=c*400,this.animate_){var h=n.frameState.time-this.animate_;h<this.animateDuration_?(this.elapsedRatio_=this.easing_(h/this.animateDuration_),n.frameState.animate=!0):(this.animate_=!1,this.height_=this.toHeight_)}var u=n.frameState.pixelRatio,d=n.context,m=this.matrix_=n.frameState.coordinateToPixelTransform;m||(m=n.frameState.coordinateToPixelMatrix,m[2]=m[4],m[3]=m[5],m[4]=m[12],m[5]=m[13]),this.center_=[d.canvas.width*this.get("center")[0]/u,d.canvas.height*this.get("center")[1]/u];var g=this._source.getFeaturesInExtent(n.frameState.extent);d.save(),d.scale(u,u);var x=this.getStyle();d.lineWidth=x.getStroke().getWidth(),d.lineCap=x.getStroke().getLineCap(),d.strokeStyle=ol.color.asString(x.getStroke().getColor()),d.fillStyle=ol.color.asString(x.getFill().getColor());for(var E=[],P=0;P<g.length;P++)E.push(this.getFeature3D_(g[P],this._getFeatureHeight(g[P])));this.drawFeature3D_(d,E),d.restore()}},ol.layer.Vector3D.prototype.getHfn=function(n){switch(typeof n){case"function":return n;case"string":{var c=this.get("defaultHeight");return function(h){return Number(h.get(n))||c}}case"number":return function(){return n};default:return function(){return 10}}},ol.layer.Vector3D.prototype.animate=function(n){n=n||{},this.toHeight_=this.getHfn(n.height),this.animate_=new Date().getTime(),this.animateDuration_=n.duration||1e3,this.easing_=n.easing||ol.easing.easeOut,this.changed()},ol.layer.Vector3D.prototype.animating=function(){return this.animate_&&new Date().getTime()-this.animate_>this.animateDuration_&&(this.animate_=!1),!!this.animate_},ol.layer.Vector3D.prototype._getFeatureHeight=function(n){if(this.animate_){var c=this.height_(n),h=this.toHeight_(n);return c*(1-this.elapsedRatio_)+this.elapsedRatio_*h}else return this.height_(n)},ol.layer.Vector3D.prototype.hvector_=function(n,c){var h=[n[0]*this.matrix_[0]+n[1]*this.matrix_[1]+this.matrix_[4],n[0]*this.matrix_[2]+n[1]*this.matrix_[3]+this.matrix_[5]];return{p0:h,p1:[h[0]+c/this.res_*(h[0]-this.center_[0]),h[1]+c/this.res_*(h[1]-this.center_[1])]}},ol.layer.Vector3D.prototype.getFeature3D_=function(n,c){var h=this.get("geometry")(n),u=h.getCoordinates();switch(h.getType()){case"Polygon":u=[u];case"MultiPolygon":for(var d=[],m=0;m<u.length;m++)for(var g=0;g<u[m].length;g++){for(var x=[],E=0;E<u[m][g].length;E++)x.push(this.hvector_(u[m][g][E],c));d.push(x)}return{type:"MultiPolygon",feature:n,geom:d};case"Point":return{type:"Point",feature:n,geom:this.hvector_(u,c)};default:return{}}},ol.layer.Vector3D.prototype.drawFeature3D_=function(n,c){var h,u,d,m;for(h=0;h<c.length;h++)switch(c[h].type){case"MultiPolygon":{for(u=0;u<c[h].geom.length;u++)for(d=c[h].geom[u],m=0;m<d.length;m++)n.beginPath(),n.moveTo(d[m].p0[0],d[m].p0[1]),n.lineTo(d[m].p1[0],d[m].p1[1]),n.stroke();break}case"Point":{var g=c[h].geom;n.beginPath(),n.moveTo(g.p0[0],g.p0[1]),n.lineTo(g.p1[0],g.p1[1]),n.stroke();break}default:break}for(h=0;h<c.length;h++)switch(c[h].type){case"MultiPolygon":{for(n.beginPath(),u=0;u<c[h].geom.length;u++){if(d=c[h].geom[u],u==0)for(n.moveTo(d[0].p1[0],d[0].p1[1]),m=1;m<d.length;m++)n.lineTo(d[m].p1[0],d[m].p1[1]);else for(n.moveTo(d[0].p1[0],d[0].p1[1]),m=d.length-2;m>=0;m--)n.lineTo(d[m].p1[0],d[m].p1[1]);n.closePath()}n.fill("evenodd"),n.stroke();break}case"Point":{d=c[h];var x=d.feature.get("label");if(x){var E=d.geom.p1,P=n.measureText(x),L=Number(n.font.match(/\d+(\.\d+)?/g).join([]));n.fillRect(E[0]-P.width/2-5,E[1]-L-5,P.width+10,L+10),n.strokeRect(E[0]-P.width/2-5,E[1]-L-5,P.width+10,L+10),n.save(),n.fillStyle=ol.color.asString(this._style.getText().getFill().getColor()),n.textAlign="center",n.textBaseline="bottom",n.fillText(x,E[0],E[1]),n.restore()}break}default:break}},ol.source.WikiCommons=function(n){var c=n||{};c.loader=this._loaderFn,this._maxResolution=c.maxResolution||100,this._lang=c.lang||"fr",this._limit=c.limit||100,c.attributions||(c.attributions=["&copy; <a href='https://commons.wikimedia.org/'>Wikimedia Commons</a>"]),c.strategy||(c.strategy=ol.loadingstrategy.bbox),ol.source.Vector.call(this,c)},ol.ext.inherits(ol.source.WikiCommons,ol.source.Vector),ol.source.WikiCommons.prototype.readFeature=function(n,c){return n.set("descriptionurl",c.descriptionurl),n.set("url",c.url),n.set("title",c.title.replace(/^file:|.jpg$/ig,"")),n.set("thumbnail",c.url.replace(/^(.+wikipedia\/commons)\/([a-zA-Z0-9]\/[a-zA-Z0-9]{2})\/(.+)$/,"$1/thumb/$2/$3/200px-$3")),n.set("user",c.user),c.extmetadata&&c.extmetadata.LicenseShortName&&n.set("copy",c.extmetadata.LicenseShortName.value),!0},ol.source.WikiCommons.prototype._loaderFn=function(n,c,h){if(!(c>this._maxResolution)){var u=this,d=ol.proj.transformExtent(n,h,"EPSG:4326"),m="https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=coordinates|imageinfo&generator=geosearch&iiprop=timestamp|user|url|extmetadata|metadata|size&iiextmetadatafilter=LicenseShortName&ggsbbox="+d[3]+"|"+d[0]+"|"+d[1]+"|"+d[2]+"&ggslimit="+this._limit+"&iilimit="+(this._limit-1)+"&ggsnamespace=6";ol.ext.Ajax.get({url:m,success:function(g){var x=[],E,P,L;if(!(!g.query||!g.query.pages)){for(var F in g.query.pages){if(E=g.query.pages[F],E.coordinates&&E.coordinates.length)P=[E.coordinates[0].lon,E.coordinates[0].lat];else{var U=E.imageinfo[0].metadata;if(!U)continue;P=[];for(var A=0,G=0;G<U.length;G++)U[G].name=="GPSLongitude"&&(P[0]=U[G].value,A++),U[G].name=="GPSLatitude"&&(P[1]=U[G].value,A++);if(A!=2)continue}L=new ol.Feature(new ol.geom.Point(ol.proj.transform(P,"EPSG:4326",h))),E.imageinfo[0].title=E.title,u.readFeature(L,E.imageinfo[0])&&x.push(L)}u.addFeatures(x)}}})}},ol.layer.AnimatedCluster=function(n){var c=n||{};ol.layer.Vector.call(this,c),this.oldcluster=new ol.source.Vector,this.clusters=[],this.animation={start:!1},this.set("animationDuration",typeof c.animationDuration=="number"?c.animationDuration:700),this.set("animationMethod",c.animationMethod||ol.easing.easeOut),this.getSource().on("change",this.saveCluster.bind(this)),this.on(["precompose","prerender"],this.animate.bind(this)),this.on(["postcompose","postrender"],this.postanimate.bind(this))},ol.ext.inherits(ol.layer.AnimatedCluster,ol.layer.Vector),ol.layer.AnimatedCluster.prototype.saveCluster=function(){if(this.oldcluster){if(this.oldcluster.clear(),!this.get("animationDuration"))return;var n=this.getSource().getFeatures();n.length&&n[0].get("features")&&(this.oldcluster.addFeatures(this.clusters),this.clusters=n.slice(0),this.sourceChanged=!0)}},ol.layer.AnimatedCluster.prototype.getClusterForFeature=function(n,c){for(var h=0,u;u=c[h];h++){var d=u.get("features");if(d&&d.length){for(var m=0,g;g=d[m];m++)if(n===g)return u}}return!1},ol.layer.AnimatedCluster.prototype.stopAnimation=function(){this.animation.start=!1,this.animation.cA=[],this.animation.cB=[]},ol.layer.AnimatedCluster.prototype.animate=function(n){var c=this.get("animationDuration");if(c){var h=n.frameState.viewState.resolution,u,d,m=this.animation,g=n.frameState.time;if(m.resolution!=h&&this.sourceChanged){var x=n.frameState.extent;for(m.resolution<h?(x=ol.extent.buffer(x,100*h),m.cA=this.oldcluster.getFeaturesInExtent(x),m.cB=this.getSource().getFeaturesInExtent(x),m.revers=!1):(x=ol.extent.buffer(x,100*h),m.cA=this.getSource().getFeaturesInExtent(x),m.cB=this.oldcluster.getFeaturesInExtent(x),m.revers=!0),m.clusters=[],u=0,d;d=m.cA[u];u++){var E=d.get("features");if(E&&E.length){var P=this.getClusterForFeature(E[0],m.cB);P&&m.clusters.push({f:d,pt:P.getGeometry().getCoordinates()})}}if(m.resolution=h,this.sourceChanged=!1,!m.clusters.length||m.clusters.length>1e3){this.stopAnimation();return}g=m.start=new Date().getTime()}if(m.start){var L=n.vectorContext||ol.render.getVectorContext(n),F=(g-m.start)/c;F>1&&(this.stopAnimation(),F=1),F=this.get("animationMethod")(F);var U=this.getStyle(),A=typeof U=="function"?U:U.length?function(){return U}:function(){return[U]};for(n.context.save(),n.context.globalAlpha=this.getOpacity(),u=0,P;P=m.clusters[u];u++){var G=P.f.getGeometry().getCoordinates(),B=G[0]-P.pt[0],O=G[1]-P.pt[1];m.revers?(G[0]=P.pt[0]+F*B,G[1]=P.pt[1]+F*O):(G[0]=G[0]-F*B,G[1]=G[1]-F*O);var K=A(P.f,h,!0);if(K.length||(K=[K]),P.f.get("features").length===1&&!B&&!O)E=P.f.get("features")[0];else{var Q=new ol.geom.Point(G);E=new ol.Feature(Q)}for(var et=0,lt;lt=K[et];et++)if(lt.getText()&&/\n/.test(lt.getText().getText())){var pt=lt.getText().getOffsetX(),T=lt.getText().getOffsetY(),ct=lt.getText().getRotation()||0,ut=Number((lt.getText().getFont()||"10px").match(/\d+/))*1.2,ft=lt.getText().getText().split(`
`),$,_t=ft.length-1,W=lt.clone();ft.forEach(function(rt,nt){switch(nt==1&&(W.setImage(),W.setFill(),W.setStroke()),lt.getText().getTextBaseline()){case"alphabetic":case"ideographic":case"bottom":{$=_t;break}case"hanging":case"top":{$=0;break}default:{$=_t/2;break}}W.getText().setOffsetX(pt-Math.sin(ct)*ut*(nt-$)),W.getText().setOffsetY(T+Math.cos(ct)*ut*(nt-$)),W.getText().setText(rt),L.drawFeature(E,ol.ext.getVectorContextStyle(n,W))})}else L.drawFeature(E,ol.ext.getVectorContextStyle(n,lt))}n.context.restore(),n.frameState.animate=!0,n.context.save(),n.context.beginPath(),n.context.rect(0,0,0,0),n.context.clip(),this.clip_=!0}}},ol.layer.AnimatedCluster.prototype.postanimate=function(n){this.clip_&&(n.context.restore(),this.clip_=!1)},ol.layer.GeoImage=function(n){ol.layer.Image.call(this,n)},ol.ext.inherits(ol.layer.GeoImage,ol.layer.Image),ol.layer.GeoImage.prototype.getExtent=function(){return this.getSource().getExtent()},ol.layer.Geoportail=function(n,c,h){c=c||{},h=h||{},typeof n!="string"&&(h=c||{},c=n,n=c.layer);var u=c.maxZoom;c.source&&(n=c.source.getLayer(),c.gppKey=c.source.getGPPKey());var d=window.geoportailConfig&&(window.geoportailConfig.capabilities[c.gppKey||c.key]||window.geoportailConfig.capabilities.default)||ol.layer.Geoportail.capabilities;d=d[n],d||(d=ol.layer.Geoportail.capabilities[n]),d||(d={title:n,originators:[]},console.error('ol.layer.Geoportail: no layer definition for "'+n+`"
Try to use ol/layer/Geoportail~loadCapabilities() to get it.`));for(var m in d)typeof h[m]>"u"&&(h[m]=d[m]);this._originators=d.originators,!h.gppKey&&!h.key&&(h.gppKey=c.gppKey||c.key),c.source||(c.source=new ol.source.Geoportail(n,h)),c.title||(c.title=d.title),c.name||(c.name=n),c.layer=n,c.queryable||(c.queryable=d.queryable),c.desc||(c.desc=d.desc),!c.extent&&d.bbox&&d.bbox[0]>-170&&d.bbox[2]<170&&(c.extent=ol.proj.transformExtent(d.bbox,"EPSG:4326",c.projection||"EPSG:3857")),c.maxZoom=u,!c.maxResolution&&h.minZoom&&(c.source.getTileGrid().minZoom-=h.minZoom>1?2:1,c.maxResolution=c.source.getTileGrid().getResolution(c.source.getTileGrid().minZoom),c.source.getTileGrid().minZoom=h.minZoom),ol.layer.Tile.call(this,c)},ol.ext.inherits(ol.layer.Geoportail,ol.layer.Tile),ol.layer.Geoportail.capabilities={"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2":{key:"cartes",server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",title:"Plan IGN v2",format:"image/png",style:"normal",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:19,bbox:[-175,-85,175,85],desc:"Cartographie multi-\xE9chelles sur le territoire national, issue des bases de donn\xE9es vecteur de l\u2019IGN, mis \xE0 jour r\xE9guli\xE8rement et r\xE9alis\xE9e selon un processus enti\xE8rement automatis\xE9. Version actuellement en beta test",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:19,constraint:[{minZoom:0,maxZoom:19,bbox:[-175,-85,175,85]}]}}},"CADASTRALPARCELS.PARCELLAIRE_EXPRESS":{key:"parcellaire",server:"https://wxs.ign.fr/geoportail/wmts",layer:"CADASTRALPARCELS.PARCELLAIRE_EXPRESS",title:"PCI vecteur",format:"image/png",style:"PCI vecteur",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:19,bbox:[-63.37252,-21.475586,55.925865,51.31212],desc:"Plan cadastral informatis\xE9 vecteur de la DGFIP.",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:19,constraint:[{minZoom:0,maxZoom:19,bbox:[-63.37252,-21.475586,55.925865,51.31212]}]}}},"ORTHOIMAGERY.ORTHOPHOTOS":{key:"ortho",server:"https://wxs.ign.fr/geoportail/wmts",layer:"ORTHOIMAGERY.ORTHOPHOTOS",title:"Photographies a\xE9riennes",format:"image/jpeg",style:"normal",queryable:!0,tilematrix:"PM",minZoom:0,bbox:[-178.18713,-22.767689,167.94624,51.11242],desc:"Photographies a\xE9riennes",originators:{CRCORSE:{href:"http://www.corse.fr//",attribution:"CRCORSE",logo:"https://wxs.ign.fr/static/logos/CRCORSE/CRCORSE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[8.428783,41.338627,9.688606,43.08541]}]},SIGLR:{href:"http://www.siglr.org//",attribution:"SIGLR",logo:"https://wxs.ign.fr/static/logos/SIGLR/SIGLR.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[1.6784439,42.316307,4.8729386,44.978218]}]},"BOURGOGNE-FRANCHE-COMTE":{href:"https://www.bourgognefranchecomte.fr/",attribution:"Auvergne",logo:"https://wxs.ign.fr/static/logos/BOURGOGNE-FRANCHE-COMTE/BOURGOGNE-FRANCHE-COMTE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[2.837849,46.131435,7.1713247,48.408287]}]},FEDER_AUVERGNE:{href:"http://www.europe-en-auvergne.eu/",attribution:"Auvergne",logo:"https://wxs.ign.fr/static/logos/FEDER_AUVERGNE/FEDER_AUVERGNE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[2.0398402,44.60505,3.38408,45.49146]}]},FEDER_PAYSDELALOIRE:{href:"https://www.europe.paysdelaloire.fr/",attribution:"Pays-de-la-Loire",logo:"https://wxs.ign.fr/static/logos/FEDER_PAYSDELALOIRE/FEDER_PAYSDELALOIRE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-2.457367,46.19304,.951426,48.57609]}]},IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:13,maxZoom:20,constraint:[{minZoom:19,maxZoom:19,bbox:[-63.160706,-21.401262,55.84643,51.11242]},{bbox:[.035491213,43.221077,6.0235267,49.696926]},{minZoom:20,maxZoom:20,bbox:[.035491213,43.221077,6.0235267,49.696926]},{minZoom:13,maxZoom:18,bbox:[-178.18713,-21.401329,55.85611,51.11242]}]},"E-MEGALIS":{href:"http://www.e-megalisbretagne.org//",attribution:"Syndicat mixte de coop\xE9ration territoriale (e-Megalis)",logo:"https://wxs.ign.fr/static/logos/E-MEGALIS/E-MEGALIS.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-3.7059498,47.971947,-1.8486879,48.99035]}]},FEDER2:{href:"http://www.europe-en-france.gouv.fr/",attribution:"Fonds europ\xE9en de d\xE9veloppement \xE9conomique et r\xE9gional",logo:"https://wxs.ign.fr/static/logos/FEDER2/FEDER2.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[1.3577043,48.824635,4.269964,50.37648]}]},PREFECTURE_GUADELOUPE:{href:"www.guadeloupe.pref.gouv.fr/",attribution:"guadeloupe",logo:"https://wxs.ign.fr/static/logos/PREFECTURE_GUADELOUPE/PREFECTURE_GUADELOUPE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-61.82342,14.371942,-60.787838,16.521578]}]},OCCITANIE:{href:"https://www.laregion.fr/",attribution:"La R\xE9gion Occitanie; Pyr\xE9n\xE9es - M\xE9diterran\xE9e",logo:"https://wxs.ign.fr/static/logos/OCCITANIE/OCCITANIE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[2.2086434,48.805965,2.4859917,48.915382]}]},RGD_SAVOIE:{href:"http://www.rgd.fr",attribution:"R\xE9gie de Gestion de Donn\xE9es des Pays de Savoie (RGD 73-74)",logo:"https://wxs.ign.fr/static/logos/RGD_SAVOIE/RGD_SAVOIE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:19,maxZoom:19,bbox:[5.7759595,45.65335,7.0887337,46.438328]},{minZoom:13,maxZoom:18,bbox:[5.5923314,45.017353,7.2323394,46.438328]}]},CG45:{href:"http://www.loiret.com",attribution:"Le conseil g\xE9n\xE9ral du Loiret",logo:"https://wxs.ign.fr/static/logos/CG45/CG45.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[1.4883244,47.471867,3.1349874,48.354233]}]},CRAIG:{href:"http://www.craig.fr",attribution:"Centre R\xE9gional Auvergnat de l'Information G\xE9ographique (CRAIG)",logo:"https://wxs.ign.fr/static/logos/CRAIG/CRAIG.gif",minZoom:13,maxZoom:20,constraint:[{minZoom:13,maxZoom:19,bbox:[2.0398402,44.60505,6.4295278,46.8038]},{minZoom:20,maxZoom:20,bbox:[2.2243388,44.76621,2.7314367,45.11295]}]},"e-Megalis":{href:"http://www.e-megalisbretagne.org//",attribution:"Syndicat mixte de coop\xE9ration territoriale (e-Megalis)",logo:"https://wxs.ign.fr/static/logos/e-Megalis/e-Megalis.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-5.1937118,47.23789,-.98568505,48.980812]}]},PPIGE:{href:"http://www.ppige-npdc.fr/",attribution:"PPIGE",logo:"https://wxs.ign.fr/static/logos/PPIGE/PPIGE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[1.5212119,49.957302,4.2673664,51.090965]}]},CG06:{href:"http://www.cg06.fr",attribution:"D\xE9partement Alpes Maritimes (06) en partenariat avec : Groupement Orthophoto 06 (NCA, Ville de Cannes, CARF, CASA,CG06, CA de Grasse) ",logo:"https://wxs.ign.fr/static/logos/CG06/CG06.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[6.6093955,43.44647,7.7436337,44.377018]}]},"MEGALIS-BRETAGNE":{href:"https://www.megalisbretagne.org/",attribution:"Syndicat mixte M\xE9galis Bretagne",logo:"https://wxs.ign.fr/static/logos/MEGALIS-BRETAGNE/MEGALIS-BRETAGNE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-5.2086344,47.591938,-3.3396015,48.808697]}]},FEDER:{href:"http://www.europe-en-france.gouv.fr/",attribution:"Fonds europ\xE9en de d\xE9veloppement \xE9conomique et r\xE9gional",logo:"https://wxs.ign.fr/static/logos/FEDER/FEDER.gif",minZoom:0,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[-1.9662633,42.316307,8.25674,50.18387]},{minZoom:0,maxZoom:12,bbox:[-2.400665,41.333557,9.560094,50.366302]}]},"LANGUEDOC-ROUSSILLON":{href:"https://www.laregion.fr/",attribution:"R\xE9gion Occitanie",logo:"https://wxs.ign.fr/static/logos/LANGUEDOC-ROUSSILLON/LANGUEDOC-ROUSSILLON.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[1.6784439,42.63972,4.208843,43.979004]}]},GRAND_EST:{href:"https://www.grandest.fr/",attribution:"Hauts-de-France",logo:"https://wxs.ign.fr/static/logos/GRAND_EST/GRAND_EST.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[5.362788,47.390827,7.6924667,49.58011]}]},CNES_AUVERGNE:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_AUVERGNE/CNES_AUVERGNE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[2.2656832,45.279934,4.0227704,46.8038]}]},HAUTS_DE_FRANCE:{href:"https://www.hautsdefrance.fr/",attribution:"Hauts-de-France",logo:"https://wxs.ign.fr/static/logos/HAUTS_DE_FRANCE/HAUTS_DE_FRANCE.gif",minZoom:13,maxZoom:19,constraint:[{minZoom:13,maxZoom:19,bbox:[2.0740242,48.81521,4.3390365,51.11242]}]},MPM:{href:"http://www.marseille-provence.com/",attribution:"Marseille Provence M\xE9tropole",logo:"https://wxs.ign.fr/static/logos/MPM/MPM.gif",minZoom:20,maxZoom:20,constraint:[{minZoom:20,maxZoom:20,bbox:[5.076959,43.153347,5.7168245,43.454994]}]},DITTT:{href:"http://www.dittt.gouv.nc/portal/page/portal/dittt/",attribution:"Direction des Infrastructures, de la Topographie et des Transports Terrestres",logo:"https://wxs.ign.fr/static/logos/DITTT/DITTT.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[163.47784,-22.767689,167.94624,-19.434975]}]},CNES_978:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_978/CNES_978.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[-63.160706,18.04345,-62.962185,18.133898]}]},CNES_ALSACE:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_ALSACE/CNES_ALSACE.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[6.8086324,47.39981,7.668318,48.32695]}]},CNES_974:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_974/CNES_974.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[55.205757,-21.401262,55.84643,-20.862825]}]},CNES_975:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_975/CNES_975.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[-56.410988,46.734093,-56.10308,47.149963]}]},CNES_976:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_976/CNES_976.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[44.916977,-13.089187,45.30442,-12.564543]}]},CNES_977:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_977/CNES_977.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[-62.952805,17.862621,-62.78276,17.98024]}]},CNES:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES/CNES.gif",minZoom:13,maxZoom:16,constraint:[{minZoom:13,maxZoom:16,bbox:[-55.01953,1.845384,-50.88867,6.053161]}]},ASTRIUM:{href:"http://www.geo-airbusds.com/",attribution:"Airbus Defence and Space",logo:"https://wxs.ign.fr/static/logos/ASTRIUM/ASTRIUM.gif",minZoom:13,maxZoom:16,constraint:[{minZoom:13,maxZoom:16,bbox:[-55.01953,1.845384,-50.88867,6.053161]}]},CNES_971:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_971/CNES_971.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[-61.82342,15.819616,-60.99497,16.521578]}]},CNES_972:{href:"http://www.cnes.fr/",attribution:"Centre national d'\xE9tudes spatiales (CNES)",logo:"https://wxs.ign.fr/static/logos/CNES_972/CNES_972.gif",minZoom:13,maxZoom:18,constraint:[{minZoom:13,maxZoom:18,bbox:[-61.247208,14.371855,-60.778458,14.899901]}]}}},"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD":{server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD",title:"Carte IGN",format:"image/jpeg",style:"normal",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:18,bbox:[-179.62723,-84.5047,179.74588,85.47958],desc:"Cartographie topographique multi-\xE9chelles du territoire fran\xE7ais issue des bases de donn\xE9es vecteur de l\u2019IGN - emprise nationale, visible du 1/200 au 1/130000000",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:18,constraint:[{minZoom:5,maxZoom:5,bbox:[-179.57285,-83.84196,178.4975,85.36646]},{minZoom:0,maxZoom:2,bbox:[-175.99709,-84.42859,175.99709,84.2865]},{minZoom:3,maxZoom:3,bbox:[-176.23093,-84.5047,179.08267,84.89126]},{minZoom:4,maxZoom:4,bbox:[-179.62723,-84.0159,-179.21112,85.47958]},{minZoom:6,maxZoom:8,bbox:[-179.49689,-84.02368,179.74588,85.30035]},{minZoom:15,maxZoom:18,bbox:[-5.6663494,41.209736,10.819784,51.175068]},{minZoom:14,maxZoom:14,bbox:[-5.713191,40.852314,11.429714,51.44377]},{minZoom:13,maxZoom:13,bbox:[-63.37252,13.428586,11.429714,51.44377]},{minZoom:11,maxZoom:12,bbox:[-63.37252,13.428586,11.496459,51.444122]},{minZoom:9,maxZoom:9,bbox:[-64.81273,13.428586,11.496459,51.444016]},{minZoom:10,maxZoom:10,bbox:[-63.37252,13.428586,11.496459,51.444016]}]}}},"GEOGRAPHICALGRIDSYSTEMS.MAPS":{server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS",title:"Cartes IGN",format:"image/jpeg",style:"normal",queryable:!0,tilematrix:"PM",minZoom:0,maxZoom:18,bbox:[-180,-75,180,80],desc:"Cartes IGN",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:18,constraint:[{minZoom:7,maxZoom:7,bbox:[-178.20573,-68.138855,144.84375,51.909786]},{minZoom:8,maxZoom:8,bbox:[-178.20573,-68.138855,168.24327,51.909786]},{minZoom:13,maxZoom:13,bbox:[-178.20573,-67.101425,168.24327,51.44377]},{minZoom:14,maxZoom:14,bbox:[-178.20573,-67.101425,168.23909,51.44377]},{minZoom:11,maxZoom:12,bbox:[-178.20573,-67.101425,168.24327,51.444122]},{minZoom:9,maxZoom:10,bbox:[-178.20573,-68.138855,168.24327,51.444016]},{minZoom:15,maxZoom:15,bbox:[-178.20573,-46.502903,168.23909,51.175068]},{minZoom:16,maxZoom:16,bbox:[-178.20573,-46.502903,168.29811,51.175068]},{minZoom:0,maxZoom:6,bbox:[-180,-60,180,80]},{minZoom:18,maxZoom:18,bbox:[-5.6663494,41.209736,10.819784,51.175068]},{minZoom:17,maxZoom:17,bbox:[-179.5,-75,179.5,75]}]},DITTT:{href:"http://www.dittt.gouv.nc/portal/page/portal/dittt/",attribution:"Direction des Infrastructures, de la Topographie et des Transports Terrestres",logo:"https://wxs.ign.fr/static/logos/DITTT/DITTT.gif",minZoom:8,maxZoom:16,constraint:[{minZoom:8,maxZoom:10,bbox:[163.47784,-22.972307,168.24327,-19.402702]},{minZoom:11,maxZoom:13,bbox:[163.47784,-22.972307,168.24327,-19.494438]},{minZoom:14,maxZoom:15,bbox:[163.47784,-22.764496,168.23909,-19.493542]},{minZoom:16,maxZoom:16,bbox:[163.47784,-22.809465,168.29811,-19.403923]}]}}},"ADMINEXPRESS-COG-CARTO.LATEST":{key:"administratif",server:"https://wxs.ign.fr/geoportail/wmts",layer:"ADMINEXPRESS-COG-CARTO.LATEST",title:"ADMINEXPRESS COG CARTO",format:"image/png",style:"normal",queryable:!0,tilematrix:"PM",minZoom:6,maxZoom:16,bbox:[-63.37252,-21.475586,55.925865,51.31212],desc:"Limites administratives Express COG code officiel g\xE9ographique 2021",originators:{IGN:{href:"https://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:6,maxZoom:16,constraint:[{minZoom:6,maxZoom:16,bbox:[-63.37252,-21.475586,55.925865,51.31212]}]}}},"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN":{key:"altimetrie",server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.SLOPES.MOUNTAIN",title:"Carte des pentes",format:"image/png",style:"normal",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:17,bbox:[-63.161392,-21.544624,56.001812,51.099052],desc:"Carte des zones ayant une valeur de pente sup\xE9rieure \xE0 30\xB0-35\xB0-40\xB0-45\xB0 d'apr\xE8s la BD ALTI au pas de 5m",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:17,constraint:[{minZoom:0,maxZoom:17,bbox:[-5.1504726,41.32521,9.570543,51.099052]}]}}},"ELEVATION.SLOPES":{key:"altimetrie",server:"https://wxs.ign.fr/geoportail/wmts",layer:"ELEVATION.SLOPES",title:"Altitude",format:"image/jpeg",style:"normal",queryable:!0,tilematrix:"PM",minZoom:6,maxZoom:14,bbox:[-178.20589,-22.595179,167.43176,50.93085],desc:"La couche altitude se compose d'un MNT (Mod\xE8le Num\xE9rique de Terrain) affich\xE9 en teintes hypsom\xE9triques et issu de la BD ALTI\xAE.",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:6,maxZoom:14,constraint:[{minZoom:6,maxZoom:14,bbox:[55.205746,-21.392344,55.846554,-20.86271]}]}}},"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1":{key:"cartes",server:"https://wxs.ign.fr/geoportail/wmts",layer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.BDUNI.J1",title:"Plan IGN j+1",format:"image/png",style:"normal",queryable:!1,tilematrix:"PM",minZoom:0,maxZoom:18,bbox:[-179.5,-75,179.5,75],desc:"Plan IGN j+1",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:0,maxZoom:18,constraint:[{minZoom:0,maxZoom:18,bbox:[-179,-80,179,80]}]}}},"TRANSPORTNETWORKS.ROADS":{key:"topographie",server:"https://wxs.ign.fr/geoportail/wmts",layer:"TRANSPORTNETWORKS.ROADS",title:"Routes",format:"image/png",style:"normal",queryable:!1,tilematrix:"PM",minZoom:6,maxZoom:18,bbox:[-63.969162,-21.49687,55.964417,71.584076],desc:"Affichage du r\xE9seau routier fran\xE7ais et europ\xE9en.",originators:{IGN:{href:"http://www.ign.fr",attribution:"Institut national de l'information g\xE9ographique et foresti\xE8re",logo:"https://wxs.ign.fr/static/logos/IGN/IGN.gif",minZoom:6,maxZoom:18,constraint:[{minZoom:15,maxZoom:18,bbox:[-63.37252,-21.475586,55.925865,51.31212]},{minZoom:6,maxZoom:14,bbox:[-63.969162,-21.49687,55.964417,71.584076]}]}}}},ol.layer.Geoportail.register=function(n,c){ol.layer.Geoportail.capabilities[n]=c},ol.layer.Geoportail.isRegistered=function(n){return ol.layer.Geoportail.capabilities[n]&&ol.layer.Geoportail.capabilities[n].key},ol.layer.Geoportail.loadCapabilities=function(n,c){var h=function(){},u=function(){},d=function(){};this.getCapabilities(n,c).then(function(g){ol.layer.Geoportail.capabilities=g,h(g)}).catch(function(g){u(g)}).finally(function(g){d(g)});var m={then:function(g){return typeof g=="function"&&(h=g),m},catch:function(g){return typeof g=="function"&&(u=g),m},finally:function(g){return typeof g=="function"&&(d=g),m}};return m},ol.layer.Geoportail.getCapabilities=function(n){var c={},h=function(){},u=function(){},d=function(){},m=[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677,.14929107084870338];function g(P){P=Number(P)*281e-6;for(var L=0;L<m.length;L++)if(P>m[L])return L}function x(P){for(var L=P.constraint.length-1;L>0;L--)for(var F=0;F<L;F++){for(var U=!0,A=0;A<4;A++)if(P.constraint[L].bbox[A]!=P.constraint[F].bbox[A]){U=!1;break}if(U&&(P.constraint[L].maxZoom==P.constraint[F].minZoom||P.constraint[F].maxZoom==P.constraint[L].minZoom||P.constraint[L].maxZoom+1==P.constraint[F].minZoom||P.constraint[F].maxZoom+1==P.constraint[L].minZoom||P.constraint[L].minZoom-1==P.constraint[F].maxZoom||P.constraint[F].minZoom-1==P.constraint[L].maxZoom)){P.constraint[F].maxZoom=Math.max(P.constraint[L].maxZoom,P.constraint[F].maxZoom),P.constraint[F].minZoom=Math.min(P.constraint[L].minZoom,P.constraint[F].minZoom),P.constraint.splice(L,1);break}}}ol.ext.Ajax.get({url:"https://wxs.ign.fr/"+n+"/autoconf/",dataType:"TEXT",error:function(P){u(P),d({})},success:function(P){for(var L=new DOMParser,F=L.parseFromString(P,"text/xml"),U=F.getElementsByTagName("Layer"),A=0,G;G=U[A];A++)if(/WMTS/.test(G.getElementsByTagName("Server")[0].attributes.service.value)){var B={key:n,server:G.getElementsByTagName("gpp:Key")[0].innerHTML.replace(n+"/",""),layer:G.getElementsByTagName("Name")[0].innerHTML,title:G.getElementsByTagName("Title")[0].innerHTML,format:G.getElementsByTagName("Format")[0]?G.getElementsByTagName("Format")[0].innerHTML:"image.jpeg",style:G.getElementsByTagName("Style")[0].getElementsByTagName("Name")[0].innerHTML,queryable:G.attributes.queryable.value==="1",tilematrix:"PM",minZoom:g(G.getElementsByTagName("sld:MaxScaleDenominator")[0].innerHTML),maxZoom:g(G.getElementsByTagName("sld:MinScaleDenominator")[0].innerHTML),bbox:JSON.parse("["+G.getElementsByTagName("gpp:BoundingBox")[0].innerHTML+"]"),desc:G.getElementsByTagName("Abstract")[0].innerHTML.replace(/^<!\[CDATA\[(.*)\]\]>$/,"$1")};B.originators={};for(var O=G.getElementsByTagName("gpp:Originator"),K=0,Q;Q=O[K];K++){for(var et=B.originators[Q.attributes.name.value]={href:Q.getElementsByTagName("gpp:URL")[0].innerHTML,attribution:Q.getElementsByTagName("gpp:Attribution")[0].innerHTML,logo:Q.getElementsByTagName("gpp:Logo")[0].innerHTML,minZoom:20,maxZoom:0,constraint:[]},lt=Q.getElementsByTagName("gpp:Constraint"),pt=0,T;T=lt[pt];pt++){var ct=g(T.getElementsByTagName("sld:MinScaleDenominator")[0].innerHTML),ut=g(T.getElementsByTagName("sld:MaxScaleDenominator")[0].innerHTML);ut>et.maxZoom&&(et.maxZoom=ut),ut<et.minZoom&&(et.minZoom=ut),ct>et.maxZoom&&(et.maxZoom=ct),ct<et.minZoom&&(et.minZoom=ct),et.constraint.push({minZoom:ut,maxZoom:ct,bbox:JSON.parse("["+T.getElementsByTagName("gpp:BoundingBox")[0].innerHTML+"]")})}x(et)}c[B.layer]=B}h(c),d(c)}});var E={then:function(P){return typeof P=="function"&&(h=P),E},catch:function(P){return typeof P=="function"&&(u=P),E},finally:function(P){return typeof P=="function"&&(d=P),E}};return E},ol.source.Source.prototype.getPreview=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAk6QAAJOkBUCTn+AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVHic7ZpPiE1RHMc/780MBhkik79JSUlIUbOxI+wkI2yRhYSUlJLNpJF/xcpiJBmZGBZsNM1CkmhKITGkGbH0/BuPmXnP4rxbb/TOn3fvOffeec6nfqvb/b7f93fveeec37ng8Xg8Ho/nf6Uu4d+fDswFssCvhHOJhaXAMeApMAQUyyIPPAdOAiuTStAVy4EHjDWsix5gdRLJ2mY34ulWYz6IEeA4kIk9awtkgTOEM/5vdAKT4k0/Ou3YMR/ELcbRm9AKFLBbgCJwNE4TYZkJfMG++SIwDCyLz0o4bI17WdyJz0r1TAZ+oDcxCBwAFgIzEIuhvcBbg3sLwOK4DFXLFvQGniCGSSUagS4DjUPOHESkA3XiOWCORqMR6Nfo9DjI3QqPUSd+ylBnv0Zn0GrWFvmIOvGNhjqrNDp/EAutyFgRKUM2tgO+Gur81FxvAKYZaimxXYBvmuuLDHWWaK4X0RfJCNsF6NdcbzXU2a65PohYFKWOc+jn8PUajbWIXaBKp9NB7lZYh34OzwFbFfd/NtDYYSth27urLGIm0M31AL3APWAAmIooymaDnPIl/Vz4NN1yHrd7gcvxWQnHAuA3bsyPop8hUsE13BSgK04TUViBeFo2zedJ8S6wElexW4D2eNOPTjNi6WvD/DtEr8E6tk6GGoAmxFY2iFHE9NZiQf8gogiB9gTEH23izAZuE77vHyU+ANucO1QwD3hD/MbLowAcdm20EmkwXx4n3NodS9rMB2HabYpEWs0HcRqHp0fNwAvJD+eBTZr7p6BvmQVxUaEzEbiruNfJekH15L8jtrEm7JJolEcOmKXRqQOuKDQuY7HZY8s8iNfzkSLxIuI43FTrkkLnOlBfRW4VsWk+oAX5weknxFAxJQNckGgVgZuIRVoomoGXEmGTMa+iQ6K7M4SW7k24QYgiuDQPYinbhugiF4H3RGtzZYCzyIvQXfpNI1ybLyeLpf5+iTbkRbiP2EcocTHm4+YI8iI8RFHwWjAfsA95Q+YZFU6wasl8wB7kReijtNbIILa0vcg/PRlGfPQwHmlCviDqAzaA+OREtzqr1ejOIDorxlNEjTGUBV4nnUWCvAJxGDlA8q9j3DEArAn2zvXAfOwfl6eVAmJrPpJ0Ih6Px+PxeJLjLwPul3vj5d0eAAAAAElFTkSuQmCC"},ol.source.Tile.prototype.getPreview=function(n,c){n||(n=[21020,6355964]),c||(c=150);var h=this.getTileGrid().getTileCoordForCoordAndResolution(n,c),u=this.getTileUrlFunction();return u.call(this,h,this.getProjection())},ol.source.TileWMS.prototype.getPreview=function(n,c){n||(n=[21020,6355964]),c||(c=150);var h=this.getTileUrlFunction();if(h){var u=this.getTileGrid()||this.getTileGridForProjection(this.getProjection()),d=u.getTileCoordForCoordAndResolution(n,c);return h.call(this,d,1,this.getProjection())}var m=this.getGetFeatureInfoUrl?this.getGetFeatureInfoUrl(n,c,this.getProjection()||"EPSG:3857",{}):this.getFeatureInfoUrl(n,c,this.getProjection()||"EPSG:3857",{});return m=m.replace(/getfeatureinfo/i,"GetMap"),m},ol.layer.Base.prototype.getPreview=function(n,c,h){if(this.get("preview"))return[this.get("preview")];if(c||(c=150),c<this.getMinResolution()||c>this.getMaxResolution()){var u=this.getMinResolution(),d=this.getMaxResolution();for(d>1e5&&(d=156543),u<.15&&(u=.15),c=d;d>u;)u*=2,d/=2,c=u}var m=this.getExtent();return n||(n=[21020,6355964]),m&&!ol.extent.containsCoordinate(m,n)&&(n=[(m[0]+m[2])/2,(m[1]+m[3])/2]),h&&(n=ol.proj.transform(n,h,this.getSource().getProjection())),this.getSource&&this.getSource()?[this.getSource().getPreview(n,c)]:[]},ol.layer.Group.prototype.getPreview=function(n,c){if(this.get("preview"))return[this.get("preview")];var h=[];if(this.getLayers)for(var u=this.getLayers().getArray(),d=0;d<u.length;d++)h=h.concat(u[d].getPreview(n,c));return h},ol.layer.Maplibre=function(n){ol.layer.Layer||console.error("[ol/layer/MapLibre] bad ol version (need ol@6+)"),n=n||{},n.render=function(c){this._container||this._create(n.style);var h=1,u=1;this._container.style.width=h*c.size[0]+"px",this._container.style.height=h*c.size[1]+"px";var d=this.glMap;if(!d)return null;var m=d.getCanvas();m.style.transform="scale("+1/h+")",(c.size[0]!==m.width||c.size[1]!==m.height)&&d.resize(),m.style.opacity=this.getOpacity();var g=c.viewState;return d.jumpTo({center:ol.proj.toLonLat(g.center),zoom:g.zoom-u,bearing:-g.rotation*180/Math.PI,animate:!1}),d._frame&&(d._frame.cancel(),d._frame=null),d._render(),this._container},ol.layer.Layer.call(this,n)},ol.layer.Layer||(ol.layer.Layer=function(){}),ol.ext.inherits(ol.layer.Maplibre,ol.layer.Layer),ol.layer.Maplibre.prototype.getMapGL=function(){return this.glMap},ol.layer.Maplibre.prototype.setStyle=function(n){this.set("style",n),this.getMapGL()&&this.getMapGL().setStyle(n),this.changed()},ol.layer.Maplibre.prototype.getStyle=function(){return this.getMapGL().get("style")},ol.layer.Maplibre.prototype._create=function(n){this._container=ol.ext.element.create("DIV",{className:"ol-maplibre-gl",style:{position:"absolute",top:0,left:0},parent:document.body}),this.glMap=new mapboxgl.Map({container:this._container,style:n,center:[3,47],zoom:5,pitch:0,antialias:!0,attributionControl:!1,boxZoom:!1,doubleClickZoom:!1,dragPan:!1,dragRotate:!1,interactive:!1,keyboard:!1,pitchWithRotate:!1,scrollZoom:!1,touchZoomRotate:!1})},ol.layer.Vector.prototype.setRender3D=function(n){n.setLayer(this)},ol.render3D=function(n){n=n||{},n.maxResolution=n.maxResolution||100,n.defaultHeight=n.defaultHeight||0,ol.Object.call(this,n),this.setStyle(n.style),this.set("ghost",n.ghost),this.setActive(n.active||n.active!==!1),this.height_=n.height=this.getHfn(n.height),n.layer&&this.setLayer(n.layer)},ol.ext.inherits(ol.render3D,ol.Object),ol.render3D.prototype.setStyle=function(n){if(n instanceof ol.style.Style?this._style=n:this._style=new ol.style.Style,this._style.getStroke()||this._style.setStroke(new ol.style.Stroke({width:1,color:"red"})),this._style.getFill()||this._style.setFill(new ol.style.Fill({color:"rgba(0,0,255,0.5)"})),n&&n.getGeometry()){var c=n.getGeometry();typeof c=="function"?this.set("geometry",c):this.set("geometry",function(){return c})}else this.set("geometry",function(h){return h.getGeometry()})},ol.render3D.prototype.getStyle=function(){return this._style},ol.render3D.prototype.setActive=function(n){typeof n=="function"?this._active=n:this._active=function(){return n},this.layer_&&this.layer_.changed()},ol.render3D.prototype.getActive=function(){return this._active()},ol.render3D.prototype.onPostcompose_=function(n){if(this.getActive()){var c=n.frameState.viewState.resolution;if(!(c>this.get("maxResolution"))){if(this.res_=c*400,this.animate_){var h=n.frameState.time-this.animate_;h<this.animateDuration_?(this.elapsedRatio_=this.easing_(h/this.animateDuration_),n.frameState.animate=!0):(this.animate_=!1,this.height_=this.toHeight_)}var u=n.frameState.pixelRatio,d=n.context,m=this.matrix_=n.frameState.coordinateToPixelTransform;m||(m=n.frameState.coordinateToPixelMatrix,m[2]=m[4],m[3]=m[5],m[4]=m[12],m[5]=m[13]),this.center_=[d.canvas.width/2/u,d.canvas.height/u];var g=this.layer_.getSource().getFeaturesInExtent(n.frameState.extent);d.save(),d.scale(u,u);var x=this.getStyle();d.lineWidth=x.getStroke().getWidth(),d.strokeStyle=ol.color.asString(x.getStroke().getColor()),d.fillStyle=ol.color.asString(x.getFill().getColor());for(var E=[],P=0;P<g.length;P++){var L=this.getFeatureHeight(g[P]);L&&E.push(this.getFeature3D_(g[P],L))}this.get("ghost")?this.drawGhost3D_(d,E):this.drawFeature3D_(d,E),d.restore()}}},ol.render3D.prototype.setLayer=function(n){this._listener&&this._listener.forEach(function(c){ol.Observable.unByKey(c)}),this.layer_=n,this._listener=n.on(["postcompose","postrender"],this.onPostcompose_.bind(this))},ol.render3D.prototype.getHfn=function(n){switch(typeof n){case"function":return n;case"string":{var c=this.get("defaultHeight");return function(h){return Number(h.get(n))||c}}case"number":return function(){return n};default:return function(){return 10}}},ol.render3D.prototype.animate=function(n){n=n||{},this.toHeight_=this.getHfn(n.height),this.animate_=new Date().getTime(),this.animateDuration_=n.duration||1e3,this.easing_=n.easing||ol.easing.easeOut,this.layer_.changed()},ol.render3D.prototype.animating=function(){return this.animate_&&new Date().getTime()-this.animate_>this.animateDuration_&&(this.animate_=!1),!!this.animate_},ol.render3D.prototype.getFeatureHeight=function(n){if(this.animate_){var c=this.height_(n),h=this.toHeight_(n);return c*(1-this.elapsedRatio_)+this.elapsedRatio_*h}else return this.height_(n)},ol.render3D.prototype.hvector_=function(n,c){var h=[n[0]*this.matrix_[0]+n[1]*this.matrix_[1]+this.matrix_[4],n[0]*this.matrix_[2]+n[1]*this.matrix_[3]+this.matrix_[5]];return{p0:h,p1:[h[0]+c/this.res_*(h[0]-this.center_[0]),h[1]+c/this.res_*(h[1]-this.center_[1])]}},ol.render3D.prototype.getFeature3D_=function(n,c){var h=this.get("geometry")(n),u=h.getCoordinates();switch(h.getType()){case"Polygon":u=[u];case"MultiPolygon":for(var d=[],m=0;m<u.length;m++)for(var g=0;g<u[m].length;g++){for(var x=[],E=0;E<u[m][g].length;E++)x.push(this.hvector_(u[m][g][E],c));d.push(x)}return{type:"MultiPolygon",feature:n,geom:d,height:c};case"Point":return{type:"Point",feature:n,geom:this.hvector_(u,c),height:c};default:return{}}},ol.render3D.prototype.drawFeature3D_=function(n,c){var h,u,d,m;for(h=0;h<c.length;h++)switch(c[h].type){case"MultiPolygon":{for(u=0;u<c[h].geom.length;u++)for(d=c[h].geom[u],m=0;m<d.length;m++)n.beginPath(),n.moveTo(d[m].p0[0],d[m].p0[1]),n.lineTo(d[m].p1[0],d[m].p1[1]),n.stroke();break}case"Point":{var g=c[h].geom;n.beginPath(),n.moveTo(g.p0[0],g.p0[1]),n.lineTo(g.p1[0],g.p1[1]),n.stroke();break}default:break}for(h=0;h<c.length;h++)switch(c[h].type){case"MultiPolygon":{for(n.beginPath(),u=0;u<c[h].geom.length;u++){if(d=c[h].geom[u],u==0)for(n.moveTo(d[0].p1[0],d[0].p1[1]),m=1;m<d.length;m++)n.lineTo(d[m].p1[0],d[m].p1[1]);else for(n.moveTo(d[0].p1[0],d[0].p1[1]),m=d.length-2;m>=0;m--)n.lineTo(d[m].p1[0],d[m].p1[1]);n.closePath()}n.fill("evenodd"),n.stroke();break}case"Point":{d=c[h];var x=d.feature.get("label");if(x){var E=d.geom.p1,P=n.fillStyle;n.fillStyle=n.strokeStyle,n.textAlign="center",n.textBaseline="bottom",n.fillText(x,E[0],E[1]);var L=n.measureText(x),F=Number(n.font.match(/\d+(\.\d+)?/g).join([]));n.fillStyle="rgba(255,255,255,0.5)",n.fillRect(E[0]-L.width/2-5,E[1]-F-5,L.width+10,F+10),n.strokeRect(E[0]-L.width/2-5,E[1]-F-5,L.width+10,F+10),n.fillStyle=P}break}default:break}},ol.render3D.prototype.drawGhost3D_=function(n,c){var h,u,d,m;for(h=0;h<c.length;h++)switch(c[h].type){case"MultiPolygon":{for(u=0;u<c[h].geom.length;u++)for(d=c[h].geom[u],m=0;m<d.length-1;m++){n.beginPath(),n.moveTo(d[m].p0[0],d[m].p0[1]),n.lineTo(d[m].p1[0],d[m].p1[1]),n.lineTo(d[m+1].p1[0],d[m+1].p1[1]),n.lineTo(d[m+1].p0[0],d[m+1].p0[1]),n.lineTo(d[m].p0[0],d[m].p0[1]);var g=[(d[m].p0[0]+d[m+1].p0[0])/2,(d[m].p0[1]+d[m+1].p0[1])/2],x=[d[m].p0[1]-d[m+1].p0[1],-d[m].p0[0]+d[m+1].p0[0]],E=ol.coordinate.getIntersectionPoint([g,[g[0]+x[0],g[1]+x[1]]],[d[m].p1,d[m+1].p1]),P=n.createLinearGradient(g[0],g[1],E[0],E[1]);P.addColorStop(0,"rgba(255,255,255,.2)"),P.addColorStop(1,"rgba(255,255,255,0)"),n.fillStyle=P,n.fill()}break}case"Point":{var L=c[h].geom;n.beginPath(),n.moveTo(L.p0[0],L.p0[1]),n.lineTo(L.p1[0],L.p1[1]),n.stroke();break}default:break}},ol.layer.SketchOverlay=function(n){n=n||{};var c=n.style||ol.style.Style.defaultStyle(!0),h=n.sketchStyle;h||(h=ol.style.Style.defaultStyle(),h=[new ol.style.Style({image:new ol.style.RegularShape({points:4,radius:10,radius2:0,stroke:new ol.style.Stroke({color:[255,255,255,.5],width:3})})}),h[0].clone()],h[1].setImage(new ol.style.RegularShape({points:4,radius:10,radius2:0,stroke:new ol.style.Stroke({color:[0,153,255,1],width:1.25})}))),this._geom=[],ol.layer.Vector.call(this,{name:"sketch",source:new ol.source.Vector({useSpatialIndex:!1}),style:function(u){return u.get("sketch")?h:c},updateWhileAnimating:!0,updateWhileInteracting:!0}),this.getSource().addFeatures([new ol.Feature({sketch:!0,geometry:new ol.geom.Point([])}),new ol.Feature({sketch:!0,geometry:new ol.geom.LineString([])}),new ol.Feature,new ol.Feature(new ol.geom.Point([]))]),this.setGeometryType(n.type)},ol.ext.inherits(ol.layer.SketchOverlay,ol.layer.Vector),ol.layer.SketchOverlay.prototype.setGeometryType=function(n){var c=/^Point$|^LineString$|^Polygon$|^Circle$/.test(n)?n:"LineString";return c!==this._type&&(this.abortDrawing(),this._type=c),this._type},ol.layer.SketchOverlay.prototype.getGeometryType=function(){return this._type},ol.layer.SketchOverlay.prototype.addPoint=function(n){return this._lastCoord!==this._position?(this._geom.length||this.startDrawing(),this._geom.push(n),this._lastCoord=n,this._position=n,this.drawSketch(),this.getGeometryType()==="Point"&&this.finishDrawing(),this.getGeometryType()==="Circle"&&this._geom.length>=2&&this.finishDrawing(),!0):!1},ol.layer.SketchOverlay.prototype.removeLastPoint=function(){this._geom.pop(),this._lastCoord=this._geom[this._geom.length-1],this.drawSketch()},ol.layer.SketchOverlay.prototype.startDrawing=function(n){n=n||{},this._geom=[],n.type&&this.setGeometryType(n.type),this.drawSketch(),this._drawing||this.dispatchEvent({type:"drawstart",feature:this.getFeature()}),this._drawing=!0},ol.layer.SketchOverlay.prototype.finishDrawing=function(n){var c=this.getSource().getFeatures()[2].clone(),h=!!c;switch(this.getGeometryType()){case"Circle":case"LineString":{h=this._geom.length>1;break}case"Polygon":{h=this._geom.length>2;break}}return n&&!h?!1:(this._geom=[],this._lastCoord=null,this.drawSketch(),this._drawing&&this.dispatchEvent({type:"drawend",valid:h,feature:c}),this._drawing=!1,c)},ol.layer.SketchOverlay.prototype.abortDrawing=function(){this._drawing&&this.dispatchEvent({type:"drawabort",feature:this.getFeature()}),this._drawing=!1,this._geom=[],this._lastCoord=null,this.drawSketch()},ol.layer.SketchOverlay.prototype.setPosition=function(n){this._position=n,this.drawLink()},ol.layer.SketchOverlay.prototype.getPosition=function(){return this._position},ol.layer.SketchOverlay.prototype.drawLink=function(){var n=this.getSource().getFeatures();this._position?(this._lastCoord&&this._lastCoord===this._position?n[0].getGeometry().setCoordinates([]):n[0].getGeometry().setCoordinates(this._position),this._geom.length?this.getGeometryType()==="Circle"?n[1].setGeometry(new ol.geom.Circle(this._geom[0],ol.coordinate.dist2d(this._geom[0],this._position))):this.getGeometryType()==="Polygon"?n[1].setGeometry(new ol.geom.LineString([this._lastCoord,this._position,this._geom[0]])):n[1].setGeometry(new ol.geom.LineString([this._lastCoord,this._position])):n[1].setGeometry(new ol.geom.LineString([]))):(n[0].getGeometry().setCoordinates([]),n[1].setGeometry(new ol.geom.LineString([])))},ol.layer.SketchOverlay.prototype.getFeature=function(){return this.getSource().getFeatures()[2]},ol.layer.SketchOverlay.prototype.drawSketch=function(){this.drawLink();var n=this.getSource().getFeatures();if(!this._geom.length)n[2].setGeometry(null),n[3].setGeometry(new ol.geom.Point([]));else switch(this._lastCoord||(this._lastCoord=this._geom[this._geom.length-1]),n[3].getGeometry().setCoordinates(this._lastCoord),this._type){case"Point":{n[2].setGeometry(new ol.geom.Point(this._lastCoord));break}case"Circle":{n[2].getGeometry()?n[2].getGeometry().setRadius(ol.coordinate.dist2d(this._geom[0],this._geom[this._geom.length-1])):n[2].setGeometry(new ol.geom.Circle(this._geom[0],ol.coordinate.dist2d(this._geom[0],this._geom[this._geom.length-1])));break}case"LineString":{n[2].getGeometry()?n[2].getGeometry().setCoordinates(this._geom):n[2].setGeometry(new ol.geom.LineString(this._geom));break}case"Polygon":{this._geom.push(this._geom[0]),n[2].getGeometry()?n[2].getGeometry().setCoordinates([this._geom]):n[2].setGeometry(new ol.geom.Polygon([this._geom])),this._geom.pop();break}default:{console.error("[ol/layer/SketchOverlay~drawSketch] geometry type not supported ("+this._type+")");break}}},ol.PerspectiveMap=function(n){var c=n.target instanceof Element?n.target:document.getElementById(n.target);window.getComputedStyle(c).position!=="absolute"&&(c.style.position="relative"),c.style.overflow="hidden";var h=ol.ext.element.create("DIV",{className:"ol-perspective-map",parent:c}),u={};Object.assign(u,n),u.target=h,ol.Map.call(this,u),this._tiltCondition=n.tiltCondition||ol.events.condition.altKeyOnly},ol.ext.inherits(ol.PerspectiveMap,ol.Map),ol.PerspectiveMap.prototype.getPixelRatio=function(){return window.devicePixelRatio},ol.PerspectiveMap.prototype.setPerspective=function(n,c){c=c||{},n>30?n=30:n<0&&(n=0);var h=this._angle||0,u=Math.round(n*10)/10,d=this.getTarget().querySelector(".ol-layers").style;cancelAnimationFrame(this._animatedPerspective),requestAnimationFrame(function(m){this._animatePerpective(m,m,d,h,u,c.duration,c.easing||ol.easing.inAndOut)}.bind(this))},ol.PerspectiveMap.prototype._animatePerpective=function(n,c,h,u,d,m,g){var x,E;m===0?(x=1,E=!0):(x=(c-n)/(m||500),E=x>=1),x=g(x);var P;E?P=this._angle=d:P=this._angle=u+(d-u)*x;var L=P/30;h.transform="translateY(-"+17*L+"%) perspective(200px) rotateX("+P+"deg) scaleY("+(1-L/2)+")",this.getMatrix3D(!0),this.render(),E||requestAnimationFrame(function(F){this._animatePerpective(n,F,h,u,d,m||500,g||ol.easing.inAndOut)}.bind(this)),this.dispatchEvent({type:"change:perspective",angle:P,animating:!E})},ol.PerspectiveMap.prototype.handleMapBrowserEvent=function(n){if(n.pixel=[n.originalEvent.offsetX/this.getPixelRatio(),n.originalEvent.offsetY/this.getPixelRatio()],n.coordinate=this.getCoordinateFromPixel(n.pixel),ol.Map.prototype.handleMapBrowserEvent.call(this,n),this._tiltCondition(n))switch(n.type){case"pointerdown":{this._dragging=n.originalEvent.offsetY;break}case"pointerup":{this._dragging=!1;break}case"pointerdrag":{if(this._dragging!==!1){var c=n.originalEvent.offsetY>this._dragging?.5:-.5;c&&this.setPerspective((this._angle||0)+c,{duration:0}),this._dragging=n.originalEvent.offsetY}break}}else this._dragging=!1},ol.PerspectiveMap.prototype.getMatrix3D=function(n){if(n){var c=this.getTarget().querySelector(".ol-layers"),h=ol.matrix3D.getTransform(c),u=ol.matrix3D.getTransformOrigin(c);this._matrixTransform=ol.matrix3D.computeTransformMatrix(h,u)}return this._matrixTransform||(this._matrixTransform=ol.matrix3D.identity()),this._matrixTransform},ol.PerspectiveMap.prototype.getPixelScreenFromCoordinate=function(n){var c=this.getPixelFromCoordinate(n),h=this.getMatrix3D(),u=ol.matrix3D.transformVertex(h,c);return u=ol.matrix3D.projectVertex(u),[u[0],u[1]]},ol.PerspectiveMap.prototype.getPixelFromPixelScreen=function(n){var c=ol.matrix3D.inverse(this.getMatrix3D()),h=ol.matrix3D.transformVertex(c,n);return h=ol.matrix3D.projectVertex(h),[h[0],h[1]]},function(){var n=ol.Overlay.prototype.updatePixelPosition;ol.Overlay.prototype.updatePixelPosition=function(){var c=this.getMap();if(c&&c instanceof ol.PerspectiveMap){var h=this.getPosition();if(!c||!c.isRendered()||!h){this.setVisible(!1);return}var u=c.getPixelScreenFromCoordinate(h),d=c.getSize();u[0]-=d[0]/4,u[1]-=d[1]/4,this.updateRenderedPosition(u,d)}else n.call(this)}}(),window.ol&&!ol.particule&&(ol.particule={}),ol.particule.Base=function(n){n||(n={}),ol.Object.call(this),this.setOverlay(n.overlay),this.coordinate=n.coordinate||[0,0]},ol.ext.inherits(ol.particule.Base,ol.Object),ol.particule.Base.prototype.setOverlay=function(n){this._overlay=n},ol.particule.Base.prototype.getOverlay=function(){return this._overlay},ol.particule.Base.prototype.draw=function(){},ol.particule.Base.prototype.update=function(){},ol.particule.Base.prototype.getRandomCoord=function(n){return this.getOverlay().randomCoord?this.getOverlay().randomCoord():[n,0]},ol.particule.Bird=function(n){n||(n={}),ol.particule.Base.call(this,n),this.bird=new Image,this.bird.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABDCAQAAAD+S8VaAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAAvMAAALzAdLpCioAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAG90lEQVR42uWaaVRTRxTHJ4AUUIoIiqISOArIDiIhBBfccCMoR0vVUpXjTqun4Fr1tO5i3YuodaFqRMECKm4VUHEhUvWgBYuilgpiRVZpCARI3r8fWA4hYY9AXu77+ObNzO/O8u787xDSyeYSTzSICpu+DjV0ogrze84PBneByuJv3JpbBlx6MEBbJfG/8S2RAACFXXtU0gERN1BjCc9UEN/e7I2w1gFPinv3UDkHbFiGOqOwJVjlHMALRT3LLJ7trGIOuHwFUsY7q2IOuJ0u7YB//pswWFn6/vnUcbOCAn7ctfnUrsijl85dv5pw786fd9OTsvg5/JykN3fTb6ZcTDgVvefIkqXmVvKr0NN/IUQDO7C1qwJrOwyftIZ7cmIiN21eZlB+SOUtFKNl9kF0hb9ujmyVM73FMmWv3m+2J4zxw74NDN5/5vT1qzeT7j3n5/Bz7mcmPk24cy32Ai8i9Pj2nwIX+jo4kc8UMMqeXr5bfC6N/2tUHrdsCQ4gAR/QNhNRJ8+6GklXH7xStlxW+ViLxrpjqBswJ/z4rYyCFrQnwJPCxGe/x53i+fO+XOth2xpsvQm+PkfGP3YuYIo1oInTyIJiLDFtoZfUP+AXeaW2rZHXKZ8xJ35NeU+1odVSbIIBbEQeb70Tffd6ckmj0QbDy9/zOufdILE6SN0TBkVafnn0ka/NatrrditDXpmYKw36pREwPyr+Y0V72n0CsxoedTDFrMJJyRMDZJYIx8+yYICQKbDJtcjtL9IGAcEMKN7efIy+snnTYv/tR8Ry3+eWRUYFzavRB9SWL7icXKWAVrPRr96wEqjBTjg5bop03GGi77XF85FdqVZNIQ1konOsEvx35yOCN1xMFimszjNSDqh+ektGfVG3xjyTzaqkX3uDTiaCdh0ZA/qSgWXWWfb7CYMQQsiUUANK1j8hoJf1lSFUg0u+z1xCiFuMUYWsAy7QCj9ZzhIgIDCkpi4nhBCGsafNGx2peXCQRvhlcGrEAQSOhYQQQtyTG74YCglN8CswrVF8goEVhBBCrMzdozi33OOHJmvUvQqghQtKMEUu+GDB0Cj2Q/vsUdJn0JH8+oXG4rWS46djSD0ePcr2lUuafbZlIbN0UAnngpyA0I3FumeZxxQYVlZ/ooWleKm0+FHQbTDuWnAp5F6cbNfskcDtcg9J9aMGNUxDIiglgy+CPxhypj4Ddu/cfFpxOrIqrv7QAsH4V2nwYxoEvwQEOpRlAeeG07hWnopH7FMHgTr6VmhAA1xEQNjF4bMxQwpcj2I9duVZLiVtTb7YT7T2I30JccyqrrA7ZuESRF0SvhQ/QKfByDu/VZAs5O6rXS9U6onZ+A2CLgQvwWn0l5n4TAFnjOKksR5En6i73q6/q3IRhvwugB8LBylwi6IhixxX9Wd/CoWQwTrJTuaEOSwzENcKDR7Yj4xOg4+Hq3SEXzX8fIfcObAZPizV+bGxqLZhMyxBWgdP+xi4ScGbCNnhhrodqxnrso65pLidNxMQENihqoPgS3AY5rU7krh35eCPbon2c4hap2nnxob2GQQE+zpAM4qFb53EoUWxE3t93jXyBwyXcG1KD+8/IXwBAmFYg26Vx37oHjnIlnQlGzbJvMCX+lQrPgT6dat9yAcT/S6aSOIs2rjjxLaQ9SsX83gv8uShiNuAn4mR9fZ5dizpphRpREvj1YvOhiU84OdmoghFyKH47y/GHohtLf45ITvVuLyfyKLI5RlntyJSXx2+P+gaejt5O7FNCSEkcFHTuAmPom6/qqxJqFRee33wHGc6rVLjXtym8C8nTTcnDNMh/n5BfnN8mFY18jWdbPlceeBViEsPi16xxFSL7ncjukVelTvxUzsxjOlAUzsULv8/GfdEJa7G7D7YWLCcUzbNkfb42zaXNaG2h4XTHH/n9x+bjIHKqeAdNMZf55fbrKBYLNq+lqb433lkFrUk5hNKdu6mIf5XA1KetzibR+09TLcfonrMtVYlNKk9h2gV//FCW3tCFmMXT0nOe83bxpklbdDJqrD+BC1mwUzTtOw2Sl/UFjpsh8ci2pHirFgxV8nxV/oJxO2RwR6+HNFbmfkZ15PaqwQe/VmJ+R18Aql37XTAsQ9EefUBW6NeEk34IaWN8HkIQk+Jva0SzwGXP6p1XDeEoqB1qx/L0B3dKY+VSr0JDurDFNaK2ZoYg5142sx1m3LEYxUsq+Vv8ejVSv8bdJ/UXySds9eDB4JwEnFIRS6KUIi/8RJxCEEARte74GBR6DycFpGgtZNFPkHrHgOx61miSaPDEOtEn8qWwvepZMc5Mel3ItZmHbbM12wSXV/snMHZQ6eRlzEzI9d9rnftskwERhXVNxF7ik1Krd87pbLCbWYR9Y7v0f/htaJHbsoDhwAAAABJRU5ErkJggg==",this.set("size",[this.bird.width||50,this.bird.height||50])},ol.ext.inherits(ol.particule.Bird,ol.particule.Base),ol.particule.Bird.prototype.draw=function(n){var c=this.getOverlay().get("angle");n.save(),n.translate(this.coordinate[0],this.coordinate[1]),n.rotate(c+Math.PI/2),n.scale(.5,.5),n.drawImage(this.bird,-this.bird.width/2,-this.bird.height/2),n.restore()},ol.particule.Bird.prototype.update=function(n){var c=this.getOverlay().get("speed")*n/this.getOverlay()._fps,h=this.getOverlay().get("angle");this.coordinate[0]+=c*Math.cos(h),this.coordinate[1]+=c*Math.sin(h)},ol.particule.Cloud=function(n){n||(n={}),ol.particule.Base.call(this,n),this.set("size",[100,100]);var c=document.createElement("CANVAS");c.width=200,c.height=200;var h=c.getContext("2d"),u=this.gradient=h.createRadialGradient(50,50,0,50,50,50);u.addColorStop(0,"rgba(255,255,255,.2"),u.addColorStop(1,"rgba(255,255,255,0"),this.image=c;for(var d=0;d<7;d++){h.save();var m=Math.random()*100,g=Math.random()*100;h.translate(m,g),h.fillStyle=u,h.fillRect(0,0,c.width,c.height),h.restore()}},ol.ext.inherits(ol.particule.Cloud,ol.particule.Base),ol.particule.Cloud.prototype.draw=function(n){n.save(),n.translate(this.coordinate[0],this.coordinate[1]),n.drawImage(this.image,-this.image.width/2,-this.image.width/2),n.restore()},ol.particule.Cloud.prototype.update=function(n){var c=this.getOverlay().get("speed")*n/this.getOverlay()._fps,h=this.getOverlay().get("angle");this.coordinate[0]+=c*Math.cos(h),this.coordinate[1]+=c*Math.sin(h)},ol.particule.Rain=function(n){n||(n={}),ol.particule.Base.call(this,n),this.z=Math.floor(Math.random()*5)+1;var c=document.createElement("CANVAS");c.width=50,c.height=50;var h=c.getContext("2d");this.gradient=h.createRadialGradient(0,0,0,0,0,25),this.gradient.addColorStop(0,"rgba(0,0,80,0)"),this.gradient.addColorStop(1,"rgba(0,0,80,.3)")},ol.ext.inherits(ol.particule.Rain,ol.particule.Base),ol.particule.Rain.prototype.draw=function(n){n.save();var c=this.getOverlay().get("angle");n.beginPath();var h=Math.cos(c)*10*(1+this.z/2),u=Math.sin(c)*10*(1+this.z/2);n.lineWidth=Math.round(this.z/2),n.strokeStyle=this.gradient,n.translate(this.coordinate[0],this.coordinate[1]),n.moveTo(0,0),n.lineTo(h,u),n.stroke(),n.restore()},ol.particule.Rain.prototype.update=function(n){var c=this.getOverlay().get("speed")*n/this.getOverlay()._fps*this.z,h=this.getOverlay().get("angle");this.coordinate[0]+=c*Math.cos(h),this.coordinate[1]+=c*Math.sin(h)},ol.particule.RainDrop=function(n){n||(n={}),ol.particule.Base.call(this,n),this.size=0;var c=document.createElement("CANVAS");c.width=100,c.height=100;var h=c.getContext("2d"),u=h.createRadialGradient(50,50,0,50,50,50);u.addColorStop(0,"rgba(128,128,192,.8"),u.addColorStop(1,"rgba(128,128,192,0"),this.image=c,h.fillStyle=u,h.fillRect(0,0,c.width,c.height)},ol.ext.inherits(ol.particule.RainDrop,ol.particule.Base),ol.particule.RainDrop.prototype.draw=function(n){this.size>0&&(n.save(),n.translate(this.coordinate[0],this.coordinate[1]),n.globalAlpha=this.size/50,n.scale(1-this.size/50,1-this.size/50),n.drawImage(this.image,-50,-50),n.restore())},ol.particule.RainDrop.prototype.update=function(n){(this.size>0||Math.random()<.01)&&(this.size<=0&&(this.size=50,this.coordinates=this.getRandomCoord()),this.size=this.size-Math.round(n/20))},ol.particule.Snow=function(n){n||(n={}),ol.particule.Base.call(this,n),this.z=(Math.floor(Math.random()*5)+1)/5,this.angle=Math.random()*Math.PI;var c=document.createElement("CANVAS");c.width=20,c.height=20;var h=c.getContext("2d"),u=h.createRadialGradient(10,10,0,10,10,10);u.addColorStop(0,"rgba(255, 255, 255,1)"),u.addColorStop(.8,"rgba(210, 236, 242,.8)"),u.addColorStop(1,"rgba(237, 247, 249,0)"),this.image=c,h.fillStyle=u,h.fillRect(0,0,c.width,c.height)},ol.ext.inherits(ol.particule.Snow,ol.particule.Base),ol.particule.Snow.prototype.draw=function(n){n.save(),n.translate(this.coordinate[0],this.coordinate[1]),n.globalAlpha=.4+this.z/2,n.scale(this.z,this.z),n.drawImage(this.image,-10,-10),n.restore()},ol.particule.Snow.prototype.update=function(n){var c=this.getOverlay().get("speed")*n/this.getOverlay()._fps*this.z*5,h=this.getOverlay().get("angle");this.angle=this.angle+n/this.getOverlay()._fps/100,this.coordinate[0]+=Math.sin(this.angle+this.z)*2+c*Math.cos(h),this.coordinate[1]+=Math.cos(this.angle)+c*Math.sin(h)},ol.Overlay.Popup=function(n){n=n||{},typeof n.offsetBox=="number"?this.offsetBox=[n.offsetBox,n.offsetBox,n.offsetBox,n.offsetBox]:this.offsetBox=n.offsetBox;var c=document.createElement("div");n.element=c,this.closeBox=n.closeBox,this.onclose=n.onclose,this.onshow=n.onshow,ol.ext.element.create("BUTTON",{className:"closeBox"+(n.closeBox?" hasclosebox":""),type:"button",click:function(){this.hide()}.bind(this),parent:c}),n.anchor!==!1&&ol.ext.element.create("DIV",{className:"anchor",parent:c}),this.content=ol.ext.element.create("DIV",{html:n.html||"",className:"ol-popup-content skill-india-scroll",parent:c}),n.minibar&&ol.ext.element.scrollDiv(this.content,{vertical:!0,mousewheel:!0,minibar:!0}),n.stopEvent&&(c.addEventListener("mousedown",function(h){h.stopPropagation()}),c.addEventListener("touchstart",function(h){h.stopPropagation()})),ol.Overlay.call(this,n),this._elt=c,this.setPositioning(n.positioning||"auto"),this.setPopupClass(n.popupClass||n.className||"default"),n.anim&&this.addPopupClass("anim"),n.position&&setTimeout(function(){this.show(n.position)}.bind(this))},ol.ext.inherits(ol.Overlay.Popup,ol.Overlay),ol.Overlay.Popup.prototype.getClassPositioning=function(){var n="",c=this.getPositioning();return/bottom/.test(c)&&(n+="ol-popup-bottom "),/top/.test(c)&&(n+="ol-popup-top "),/left/.test(c)&&(n+="ol-popup-left "),/right/.test(c)&&(n+="ol-popup-right "),/^center/.test(c)&&(n+="ol-popup-middle "),/center$/.test(c)&&(n+="ol-popup-center "),n},ol.Overlay.Popup.prototype.setClosebox=function(n){this.closeBox=n,n?this.element.classList.add("hasclosebox"):this.element.classList.remove("hasclosebox")},ol.Overlay.Popup.prototype.setPopupClass=function(n){var c=["ol-popup"];this.getVisible()&&c.push("visible"),this.element.className="";var h=this.getClassPositioning().split(" ").filter(function(u){return u.length>0});n?n.split(" ").filter(function(u){return u.length>0}).forEach(function(u){c.push(u)}):c.push("default"),h.forEach(function(u){c.push(u)}),this.closeBox&&c.push("hasclosebox"),this.element.classList.add.apply(this.element.classList,c)},ol.Overlay.Popup.prototype.addPopupClass=function(n){this.element.classList.add(n)},ol.Overlay.Popup.prototype.removePopupClass=function(n){this.element.classList.remove(n)},ol.Overlay.Popup.prototype.setPositioning=function(n){n!==void 0&&(/auto/.test(n)?(this.autoPositioning=n.split("-"),this.autoPositioning.length==1&&(this.autoPositioning[1]="auto")):this.autoPositioning=!1,n=n.replace(/auto/g,"center"),n=="center"&&(n="bottom-center"),this.setPositioning_(n))},ol.Overlay.Popup.prototype.setPositioning_=function(n){if(this.element){ol.Overlay.prototype.setPositioning.call(this,n),this.element.classList.remove("ol-popup-top","ol-popup-bottom","ol-popup-left","ol-popup-right","ol-popup-center","ol-popup-middle");var c=this.getClassPositioning().split(" ").filter(function(h){return h.length>0});this.element.classList.add.apply(this.element.classList,c)}},ol.Overlay.Popup.prototype.getVisible=function(){return this.element.classList.contains("visible")},ol.Overlay.Popup.prototype.show=function(n,c){!c&&typeof n=="string"&&(c=n,n=null),n===!0&&(n=this.getPosition());var h=this,u=this.getMap();if(u&&(c&&c!==this.prevHTML&&(this.prevHTML=c,this.content.innerHTML="",c instanceof Element?this.content.appendChild(c):ol.ext.element.create("DIV",{html:c,parent:this.content}),Array.prototype.slice.call(this.content.querySelectorAll("img")).forEach(function(x){x.addEventListener("load",function(){try{u.renderSync()}catch{}h.content.dispatchEvent(new Event("scroll"))})})),n)){if(this.autoPositioning){var d=u.getPixelFromCoordinate(n),m=u.getSize(),g=[];this.autoPositioning[0]=="auto"?g[0]=d[1]<m[1]/3?"top":"bottom":g[0]=this.autoPositioning[0],g[1]=d[0]<2*m[0]/3?"left":"right",this.setPositioning_(g[0]+"-"+g[1]),this.offsetBox&&this.setOffset([this.offsetBox[g[1]=="left"?2:0],this.offsetBox[g[0]=="top"?3:1]])}else this.offsetBox&&this.setOffset(this.offsetBox);this.setPosition(n),this.element.parentElement.style.display="",typeof this.onshow=="function"&&this.onshow(),this.dispatchEvent({type:"show"}),this._tout=setTimeout(function(){h.element.classList.add("visible")},0)}},ol.Overlay.Popup.prototype.hide=function(){this.getPosition()!=null&&(typeof this.onclose=="function"&&this.onclose(),this.setPosition(void 0),this._tout&&clearTimeout(this._tout),this.element.classList.remove("visible"),this.dispatchEvent({type:"hide"}))},ol.Overlay.AnimatedCanvas=function(n){n||(n={}),this._canvas=ol.ext.element.create("CANVAS",{className:((n.className||"")+" ol-animated-overlay").trim()}),this._ctx=this._canvas.getContext("2d"),ol.Overlay.call(this,{element:this._canvas,stopEvent:!1}),this._listener=[],this._time=0,this._particuleClass=n.particule||ol.particule.Base,n.createParticule&&(this._createParticule=n.createParticule),this._fps=1e3/(n.fps||25);var c=this._createParticule();this._psize=c.get("size")||[50,50],this.set("density",n.density||.5),this.set("speed",n.speed||4),this.set("angle",typeof n.angle=="number"?n.angle:Math.PI/4),n.animate!==!1&&this.setAnimation(!0),document.addEventListener("visibilitychange",function(){this._pause=!0}.bind(this))},ol.ext.inherits(ol.Overlay.AnimatedCanvas,ol.Overlay),ol.Overlay.AnimatedCanvas.prototype.setVisible=function(n){this.element.style.display=n?"block":"none",n&&this.setAnimation(this.get("animation"))},ol.Overlay.AnimatedCanvas.prototype.getVisible=function(){return this.element.style.display!="none"},ol.Overlay.AnimatedCanvas.prototype.updatePixelPosition=function(){},ol.Overlay.AnimatedCanvas.prototype.setMap=function(n){if(this.getMap()&&this.getMap().getViewport().querySelector(".ol-overlaycontainer").removeChild(this._canvas),this._listener.forEach(function(h){ol.Observable.unByKey(h)}),this._listener=[],ol.Overlay.prototype.setMap.call(this,n),n){var c=n.getSize();this._canvas.width=c[0],this._canvas.height=c[1],this.draw(),this._listener.push(n.on("change:size",function(){var h=n.getSize();(this._canvas.width!==h[0]||this._canvas.height!==h[1])&&(this._canvas.width=h[0],this._canvas.height=h[1],this.draw())}.bind(this)))}},ol.Overlay.AnimatedCanvas.prototype.getParticules=function(){var n=this._psize[0],c=this._psize[1],h=this.get("density")*this._canvas.width*this._canvas.height/n/c<<0;if(this._particules||(this._particules=[]),h>this._particules.length)for(var u=this._particules.length;u<h;u++)this._particules.push(this._createParticule(this,this.randomCoord()));else this._particules.length=h;return this._particules},ol.Overlay.AnimatedCanvas.prototype._createParticule=function(n,c){return new this._particuleClass({overlay:n,coordinate:c})},ol.Overlay.AnimatedCanvas.prototype.randomCoord=function(){return[Math.random()*(this._canvas.width+this._psize[0])-this._psize[0]/2,Math.random()*(this._canvas.height+this._psize[1])-this._psize[1]/2]},ol.Overlay.AnimatedCanvas.prototype.draw=function(n){var c=this._ctx;this.clear(),c.beginPath(),this.getParticules().forEach(function(h){n&&(h.update(n),this.testExit(h)),h.draw(this._ctx)}.bind(this))},ol.Overlay.AnimatedCanvas.prototype.testExit=function(n){var c=this._psize;n.coordinate[0]<-c[0]?(n.coordinate[0]=this._canvas.width+c[0],n.coordinate[1]=Math.random()*(this._canvas.height+c[1])-c[1]/2):n.coordinate[0]>this._canvas.width+c[0]?(n.coordinate[0]=-c[0],n.coordinate[1]=Math.random()*(this._canvas.height+c[1])-c[1]/2):n.coordinate[1]<-c[1]?(n.coordinate[0]=Math.random()*(this._canvas.width+c[0])-c[0]/2,n.coordinate[1]=this._canvas.height+c[1]):n.coordinate[1]>this._canvas.height+c[1]&&(n.coordinate[0]=Math.random()*(this._canvas.width+c[0])-c[0]/2,n.coordinate[1]=-c[1])},ol.Overlay.AnimatedCanvas.prototype.clear=function(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)},ol.Overlay.AnimatedCanvas.prototype.getCanvas=function(){return this._canvas},ol.Overlay.AnimatedCanvas.prototype.setAnimation=function(n){n=n!==!1,this.set("animation",n),n?(this._pause=!0,requestAnimationFrame(this._animate.bind(this))):this.dispatchEvent({type:"animation:stop",time:this._time})},ol.Overlay.AnimatedCanvas.prototype._animate=function(n){this.getVisible()&&this.get("animation")&&(this._pause?requestAnimationFrame(function(c){this._time=c,requestAnimationFrame(this._animate.bind(this))}.bind(this)):(n-this._time>this._fps&&(this.draw(n-this._time),this._time=n),requestAnimationFrame(this._animate.bind(this)))),this._pause=!1},ol.Overlay.Fixed=function(n){ol.Overlay.call(this,n)},ol.ext.inherits(ol.Overlay.Fixed,ol.Overlay),ol.Overlay.Fixed.prototype.setPosition=function(n,c){this.getMap()&&n&&(this._pixel=this.getMap().getPixelFromCoordinate(n)),ol.Overlay.prototype.setPosition.call(this,n),c&&ol.Overlay.prototype.updatePixelPosition.call(this)},ol.Overlay.Fixed.prototype.updatePixelPosition=function(){if(this.getMap()&&this._pixel&&this.getPosition()){var n=this.getMap().getPixelFromCoordinate(this.getPosition());(Math.round(n[0]*1e3)!==Math.round(this._pixel[0]*1e3)||Math.round(n[0]*1e3)!==Math.round(this._pixel[0]*1e3))&&this.setPosition(this.getMap().getCoordinateFromPixel(this._pixel))}},ol.Overlay.FixedPopup=function(n){n.anchor=!1,n.positioning=n.positioning||"center-center",n.className=(n.className||"")+" ol-fixPopup",ol.Overlay.Popup.call(this,n),this.set("minScale",n.minScale||.5),this.set("maxScale",n.maxScale||2);var c=document.createElement("canvas");this._overlay=new ol.layer.Image({source:new ol.source.ImageCanvas({canvasFunction:function(G,B,O,K){return c.width=K[0],c.height=K[1],c}})}),this._style=n.style||new ol.style.Style({fill:new ol.style.Fill({color:[102,153,255]})}),this._overlay.on(["postcompose","postrender"],function(G){if(this.getVisible()&&this._pixel){var B=this.getMap(),O=this.getPosition(),K=B.getPixelFromCoordinate(O),Q=this.element.getBoundingClientRect(),et=this.getMap().getTargetElement().getBoundingClientRect(),lt=[Q.left-et.left+Q.width/2,Q.top-et.top+Q.height/2];G.context.save();var pt=G.inversePixelTransform;pt?G.context.transform(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]):G.context.scale(G.frameState.pixelRatio,G.frameState.pixelRatio),G.context.beginPath(),G.context.moveTo(K[0],K[1]),Math.abs(lt[0]-K[0])>Math.abs(lt[1]-K[1])?(G.context.lineTo(lt[0],lt[1]-8),G.context.lineTo(lt[0],lt[1]+8)):(G.context.lineTo(lt[0]-8,lt[1]),G.context.lineTo(lt[0]+8,lt[1])),G.context.moveTo(K[0],K[1]),this._style.getFill()&&(G.context.fillStyle=ol.color.asString(this._style.getFill().getColor()),G.context.fill()),this._style.getStroke()&&(G.context.strokeStyle=ol.color.asString(this._style.getStroke().getColor()),G.context.lineWidth=this._style.getStroke().width(),G.context.stroke()),G.context.restore()}}.bind(this));var h=function(){this.setPixelPosition()}.bind(this);this.on(["hide","show"],function(){setTimeout(h)}.bind(this));function u(G){var B=0,O=0,K=0;for(var Q in G)B+=G[Q].clientX,O+=G[Q].clientY,K++;return[B/K,O/K]}function d(){var G,B,O=Object.keys(g);if(O.length<2)return!1;G=g[O[0]],B=g[O[1]];var K=[B.clientX-G.clientX,B.clientY-G.clientY];G=x[O[0]],B=x[O[1]];var Q=[B.clientX-G.clientX,B.clientY-G.clientY],et=Math.sqrt(K[0]*K[0]+K[1]*K[1]),lt=Math.sqrt(Q[0]*Q[0]+Q[1]*Q[1]),pt=Math.acos((K[0]*Q[0]+K[1]*Q[1])/(et*lt))*360/Math.PI;return K[0]*Q[1]-K[1]*Q[0]<0?-pt:pt}function m(G){var B=Object.keys(G);return B.length<2?!1:ol.coordinate.dist2d([G[B[0]].clientX,G[B[0]].clientY],[G[B[1]].clientX,G[B[1]].clientY])}var g={},x={},E=[],P,L,F,U;this.element.addEventListener("pointerdown",function(G){G.preventDefault(),G.stopPropagation();for(var B in g)x[B]&&(g[B]=x[B]);g[G.pointerId]=G,E=this._pixel,L=this.get("rotation")||0,F=this.get("scale")||1,P=m(g),U=!1}.bind(this)),this.element.addEventListener("click",function(G){U&&(G.preventDefault(),G.stopPropagation())},!0);var A=function(G){g[G.pointerId]&&(delete g[G.pointerId],G.preventDefault()),x[G.pointerId]&&delete x[G.pointerId]}.bind(this);document.addEventListener("pointerup",A),document.addEventListener("pointercancel",A),document.addEventListener("pointermove",function(G){if(g[G.pointerId]){G.preventDefault(),x[G.pointerId]=G;var B=u(g),O=u(x),K=O[0]-B[0],Q=O[1]-B[1];U=U||Math.abs(K)>3||Math.abs(Q)>3;var et=d();et&&this.setRotation(L+et*1.5,!1);var lt=m(x);lt!==!1&&P&&(this.setScale(F*lt/P,!1),P=F*lt/this.get("scale")),this.setPixelPosition([E[0]+K,E[1]+Q])}}.bind(this))},ol.ext.inherits(ol.Overlay.FixedPopup,ol.Overlay.Popup),ol.Overlay.FixedPopup.prototype.setMap=function(n){ol.Overlay.Popup.prototype.setMap.call(this,n),this._overlay.setMap(this.getMap()),this._listener&&ol.Observable.unByKey(this._listener),n&&(this._listener=n.on("change:size",function(){this.setPixelPosition()}.bind(this)))},ol.Overlay.FixedPopup.prototype.updatePixelPosition=function(){var n=this.getMap(),c=this.getPosition();if(!n||!n.isRendered()||!c){this.setVisible(!1);return}if(this._pixel)this.setVisible(!0);else{this._pixel=n.getPixelFromCoordinate(c);var h=n.getSize();this.updateRenderedPosition(this._pixel,h)}},ol.Overlay.FixedPopup.prototype.updateRenderedPosition=function(n,c){ol.Overlay.Popup.prototype.updateRenderedPosition.call(this,n,c),this.setRotation(),this.setScale()},ol.Overlay.FixedPopup.prototype.setPixelPosition=function(n,c){var h,u=this.getMap(),d=u?u.getSize():[0,0];if(c&&(this.setPositioning(c),h=ol.ext.element.offsetRect(this.element),h.width=h.height=0,/top/.test(c)?n[1]+=h.height/2:/bottom/.test(c)?n[1]=d[1]-h.height/2-n[1]:n[1]=d[1]/2+n[1],/left/.test(c)?n[0]+=h.width/2:/right/.test(c)?n[0]=d[0]-h.width/2-n[0]:n[0]=d[0]/2+n[0]),n&&(this._pixel=n),u&&u.getTargetElement()&&this._pixel){this.updateRenderedPosition(this._pixel,d);var m=!1;h=ol.ext.element.offsetRect(this.element);var g=ol.ext.element.offsetRect(u.getTargetElement());h.left<g.left?(this._pixel[0]=this._pixel[0]+g.left-h.left,m=!0):h.left+h.width>g.left+g.width&&(this._pixel[0]=this._pixel[0]+g.left-h.left+g.width-h.width,m=!0),h.top<g.top?(this._pixel[1]=this._pixel[1]+g.top-h.top,m=!0):h.top+h.height>g.top+g.height&&(this._pixel[1]=this._pixel[1]+g.top-h.top+g.height-h.height,m=!0),m&&this.updateRenderedPosition(this._pixel,d),this._overlay.changed()}},ol.Overlay.FixedPopup.prototype.getPixelPosition=function(){return this._pixel},ol.Overlay.FixedPopup.prototype.setPopupClass=function(n){ol.Overlay.Popup.prototype.setPopupClass.call(this,n),this.addPopupClass("ol-fixPopup")},ol.Overlay.FixedPopup.prototype.setRotation=function(n,c){typeof n=="number"&&this.set("rotation",n),c!==!1&&(/rotate/.test(this.element.style.transform)?this.element.style.transform=this.element.style.transform.replace(/rotate\((-?[\d,.]+)deg\)/,"rotate("+(this.get("rotation")||0)+"deg)"):this.element.style.transform=this.element.style.transform+" rotate("+(this.get("rotation")||0)+"deg)")},ol.Overlay.FixedPopup.prototype.setScale=function(n,c){typeof n=="number"&&this.set("scale",n),n=Math.min(Math.max(this.get("minScale")||0,this.get("scale")||1),this.get("maxScale")||2),this.set("scale",n),c!==!1&&(/scale/.test(this.element.style.transform)?this.element.style.transform=this.element.style.transform.replace(/scale\(([\d,.]+)\)/,"scale("+n+")"):this.element.style.transform=this.element.style.transform+" scale("+n+")")},ol.Overlay.FixedPopup.prototype.setLinkStyle=function(n){this._style=n,this._overlay.changed()},ol.Overlay.FixedPopup.prototype.getLinkStyle=function(){return this._style},ol.Overlay.Magnify=function(n){var c=document.createElement("div");c.className="ol-magnify",this._elt=c,ol.Overlay.call(this,{positioning:n.positioning||"center-center",element:this._elt,stopEvent:!1}),this.mgmap_=new ol.Map({controls:new ol.Collection,interactions:new ol.Collection,target:n.target||this._elt,view:new ol.View({projection:n.projection}),layers:n.layers}),this.mgview_=this.mgmap_.getView(),this.external_=!!n.target,this.set("zoomOffset",n.zoomOffset||1),this.set("active",!0),this.on("propertychange",this.setView_.bind(this))},ol.ext.inherits(ol.Overlay.Magnify,ol.Overlay),ol.Overlay.Magnify.prototype.setMap=function(n){this.getMap()&&this.getMap().getViewport().removeEventListener("mousemove",this.onMouseMove_),this._listener&&ol.Observable.unByKey(this._listener),this._listener=null,ol.Overlay.prototype.setMap.call(this,n),n.getViewport().addEventListener("mousemove",this.onMouseMove_.bind(this)),this._listener=n.getView().on("propertychange",this.setView_.bind(this)),this.setView_()},ol.Overlay.Magnify.prototype.getMagMap=function(){return this.mgmap_},ol.Overlay.Magnify.prototype.getActive=function(){return this.get("active")},ol.Overlay.Magnify.prototype.setActive=function(n){return this.set("active",n)},ol.Overlay.Magnify.prototype.onMouseMove_=function(n){var c=this;if(!c.get("active"))c.setPosition();else{var h=c.getMap().getEventCoordinate(n);c.external_||c.setPosition(h),c.mgview_.setCenter(h),(!c._elt.querySelector("canvas")||c._elt.querySelector("canvas").style.display=="none")&&c.mgmap_.updateSize()}},ol.Overlay.Magnify.prototype.setView_=function(n){if(!this.get("active")){this.setPosition();return}if(!n){this.setView_({key:"rotation"}),this.setView_({key:"resolution"});return}switch(n.key){case"rotation":this.mgview_.setRotation(this.getMap().getView().getRotation());break;case"zoomOffset":case"resolution":{var c=Math.max(0,this.getMap().getView().getZoom()+Number(this.get("zoomOffset")));this.mgview_.setZoom(c);break}default:break}},ol.Overlay.Placemark=function(n){n=n||{},n.popupClass=(n.popupClass||"")+" placemark anim",n.positioning="bottom-center",ol.Overlay.Popup.call(this,n),this.setPositioning=function(){},n.color&&(this.element.style.color=n.color),n.backgroundColor&&(this.element.style.backgroundColor=n.backgroundColor),n.contentColor&&this.setContentColor(n.contentColor),n.size&&this.setRadius(n.size)},ol.ext.inherits(ol.Overlay.Placemark,ol.Overlay.Popup),ol.Overlay.Placemark.prototype.show=function(n,c){n===!0&&(n=this.getPosition()),this.hide(),ol.Overlay.Popup.prototype.show.apply(this,[n,c])},ol.Overlay.Placemark.prototype.setColor=function(n){this.element.style.color=n},ol.Overlay.Placemark.prototype.setBackgroundColor=function(n){this._elt.style.backgroundColor=n},ol.Overlay.Placemark.prototype.setContentColor=function(n){var c=this.element.getElementsByClassName("ol-popup-content")[0];c&&(c.style.color=n)},ol.Overlay.Placemark.prototype.setClassName=function(n){var c=this.element.className;this.element.className="ol-popup placemark ol-popup-bottom ol-popup-center "+(/visible/.test(c)?"visible ":"")+(/anim/.test(c)?"anim ":"")+n},ol.Overlay.Placemark.prototype.setRadius=function(n){this.element.style.fontSize=n+"px"},ol.Overlay.PopupFeature=function(n){n=n||{},ol.Overlay.Popup.call(this,n),this.setTemplate(n.template),this.set("canFix",n.canFix),this.set("showImage",n.showImage),this.set("maxChar",n.maxChar||200),this.set("keepSelection",n.keepSelection),n.select&&typeof n.select.on=="function"&&(this._select=n.select,n.select.on("select",function(c){this._noselect||(c.selected[0]?this.show(c.mapBrowserEvent.coordinate,n.select.getFeatures().getArray(),c.selected[0]):this.hide())}.bind(this)))},ol.ext.inherits(ol.Overlay.PopupFeature,ol.Overlay.Popup),ol.Overlay.PopupFeature.prototype.setTemplate=function(n){n||(n=function(c){var h=c.getProperties();return delete h[c.getGeometryName()],{attributes:Object.keys(h)}}),this._template=n,this._attributeObject(this._template)},ol.Overlay.PopupFeature.prototype._attributeObject=function(n){if(n&&n.attributes instanceof Array){var c={};n.attributes.forEach(function(h){c[h]=!0}),n.attributes=c}return n.attributes},ol.Overlay.PopupFeature.prototype.show=function(n,c,h){(n instanceof ol.Feature||n instanceof Array&&n[0]instanceof ol.Feature)&&(c=n,n=null),c instanceof Array||(c=[c]),this._features=c.slice(),this._count||(this._count=1),this._count=1;var u=this.get("keepSelection")&&h||c[0],d=this._getHtml(u);d?(this.element.classList.contains("ol-fixed")||this.hide(),(!n||c[0].getGeometry().getType()==="Point")&&(n=c[0].getGeometry().getFirstCoordinate()),ol.Overlay.Popup.prototype.show.call(this,n,d)):this.hide()},ol.Overlay.PopupFeature.prototype._getHtml=function(n){if(!n)return"";var c=ol.ext.element.create("DIV",{className:"ol-popupfeature"});this.get("canFix")&&ol.ext.element.create("I",{className:"ol-fix",parent:c}).addEventListener("click",function(){this.element.classList.toggle("ol-fixed")}.bind(this));var h=this._template;if(typeof h=="function")h=h(n,this._count,this._features.length);else if(!h||!h.attributes){h=h||{},h.attributes={};for(var u in n.getProperties())u!="geometry"&&(h.attributes[u]=u)}if(h.title){var d;typeof h.title=="function"?d=h.title(n):d=n.get(h.title),ol.ext.element.create("H1",{html:d,parent:c})}if(h.attributes){var m,g=ol.ext.element.create("TABLE",{parent:c}),x=this._attributeObject(h),E=n.getProperties();for(var P in x)if(E.hasOwnProperty(P)){var L=x[P],F,U=E[P];typeof L.format=="function"&&(U=L.format(U,n));var A=!0;if(typeof L.visible=="boolean"?A=L.visible:typeof L.visible=="function"&&(A=L.visible(n,U)),A){if(m=ol.ext.element.create("TR",{parent:g}),ol.ext.element.create("TD",{html:L.title||P,parent:m}),this.get("showImage")&&/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|gif|png)/.test(U))F=ol.ext.element.create("IMG",{src:U});else{F=(L.before||"")+U+(L.after||"");var G=this.get("maxChar")||200;typeof F=="string"&&F.length>G&&(F=F.substr(0,G)+"[...]")}ol.ext.element.create("TD",{html:F,parent:m})}}}if(ol.ext.element.create("BUTTON",{className:"ol-zoombt",parent:c}).addEventListener("click",function(){if(n.getGeometry().getType()==="Point")this.getMap().getView().animate({center:n.getGeometry().getFirstCoordinate(),zoom:Math.max(this.getMap().getView().getZoom(),18)});else{var O=n.getGeometry().getExtent();this.getMap().getView().fit(O,{duration:1e3})}}.bind(this)),!this.get("keepSelection")&&this._features.length>1){var B=ol.ext.element.create("DIV",{className:"ol-count",parent:c});ol.ext.element.create("DIV",{className:"ol-prev",parent:B,click:function(){this._count--,this._count<1&&(this._count=this._features.length),c=this._getHtml(this._features[this._count-1]),setTimeout(function(){ol.Overlay.Popup.prototype.show.call(this,this.getPosition(),c)}.bind(this),350)}.bind(this)}),ol.ext.element.create("TEXT",{html:this._count+"/"+this._features.length,parent:B}),ol.ext.element.create("DIV",{className:"ol-next",parent:B,click:function(){this._count++,this._count>this._features.length&&(this._count=1),c=this._getHtml(this._features[this._count-1]),setTimeout(function(){ol.Overlay.Popup.prototype.show.call(this,this.getPosition(),c)}.bind(this),350)}.bind(this)})}return this._select&&!this.get("keepSelection")&&(this._noselect=!0,this._select.getFeatures().clear(),this._select.getFeatures().push(n),this._noselect=!1),this.dispatchEvent({type:"select",feature:n,index:this._count}),c},ol.Overlay.PopupFeature.prototype.setFix=function(n){n?this.element.classList.add("ol-fixed"):this.element.classList.remove("ol-fixed")},ol.Overlay.PopupFeature.prototype.getFix=function(){return this.element.classList.contains("ol-fixed")},ol.Overlay.PopupFeature.localString=function(n,c){return function(h){if(h&&h.toLocaleString)return h.toLocaleString(n,c);var u=new Date(h);return isNaN(u)?h:u.toLocaleString(n,c)}},ol.Overlay.Tooltip=function(n){n=n||{},n.popupClass=n.popupClass||n.className||"tooltips black",n.positioning=n.positioning||"center-left",n.stopEvent=!!n.stopEvent,ol.Overlay.Popup.call(this,n),this.set("maximumFractionDigits",n.maximumFractionDigits||2),typeof n.formatLength=="function"&&(this.formatLength=n.formatLength),typeof n.formatArea=="function"&&(this.formatArea=n.formatArea),typeof n.getHTML=="function"&&(this.getHTML=n.getHTML),this._interaction=new ol.interaction.Interaction({handleEvent:function(c){if(c.type==="pointermove"||c.type==="click"){var h=this.getHTML(this._feature,this.get("info"));h?this.show(c.coordinate,h):this.hide(),this._coord=c.coordinate}return!0}.bind(this)})},ol.ext.inherits(ol.Overlay.Tooltip,ol.Overlay.Popup),ol.Overlay.Tooltip.prototype.setMap=function(n){this.getMap()&&this.getMap().removeInteraction(this._interaction),ol.Overlay.Popup.prototype.setMap.call(this,n),this.getMap()&&this.getMap().addInteraction(this._interaction)},ol.Overlay.Tooltip.prototype.getHTML=function(n,c){return this.get("measure")?this.get("measure")+(c?"<br/>"+c:""):c||""},ol.Overlay.Tooltip.prototype.setInfo=function(n){n?setTimeout(function(){this.set("info",n),this.show(this._coord,this.get("info"))}.bind(this)):(this.set("info",""),this.hide())},ol.Overlay.Tooltip.prototype.removeFeature=function(){this.setFeature()},ol.Overlay.Tooltip.prototype.formatArea=function(n){return n>Math.pow(10,-1*this.get("maximumFractionDigits"))?n>1e4?(n/1e6).toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits)")})+" km\xB2":n.toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" m\xB2":""},ol.Overlay.Tooltip.prototype.formatLength=function(n){return n>Math.pow(10,-1*this.get("maximumFractionDigits"))?n>100?(n/1e3).toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" km":n.toLocaleString(void 0,{maximumFractionDigits:this.get("maximumFractionDigits")})+" m":""},ol.Overlay.Tooltip.prototype.setFeature=function(n){n&&n.feature&&(n=n.feature),this._feature=n,this._listener&&this._listener.forEach(function(c){ol.Observable.unByKey(c)}),this._listener=[],this.set("measure",""),n&&this._listener.push(n.getGeometry().on("change",function(c){var h=c.target,u;h.getArea?u=this.formatArea(ol.sphere.getArea(h,{projection:this.getMap().getView().getProjection()})):h.getLength&&(u=this.formatLength(ol.sphere.getLength(h,{projection:this.getMap().getView().getProjection()}))),this.set("measure",u)}.bind(this)))},ol.coordinate.convexHull,function(){var n=function(h,u,d){return(h[0]-d[0])*(u[1]-d[1])-(h[1]-d[1])*(u[0]-d[0])<=0};ol.coordinate.convexHull=function(h){var u;h.sort(function(g,x){return g[0]==x[0]?g[1]-x[1]:g[0]-x[0]});var d=[];for(u=0;u<h.length;u++){for(;d.length>=2&&n(d[d.length-2],d[d.length-1],h[u]);)d.pop();d.push(h[u])}var m=[];for(u=h.length-1;u>=0;u--){for(;m.length>=2&&n(m[m.length-2],m[m.length-1],h[u]);)m.pop();m.push(h[u])}return m.pop(),d.pop(),d.concat(m)};var c=function(h){var u,d,m=[];switch(h.getType()){case"Point":m.push(h.getCoordinates());break;case"LineString":case"LinearRing":case"MultiPoint":m=h.getCoordinates();break;case"MultiLineString":for(d=h.getLineStrings(),u=0;u<d.length;u++)m.concat(c(d[u]));break;case"Polygon":m=c(h.getLinearRing(0));break;case"MultiPolygon":for(d=h.getPolygons(),u=0;u<d.length;u++)m.concat(c(d[u]));break;case"GeometryCollection":for(d=h.getGeometries(),u=0;u<d.length;u++)m.concat(c(d[u]));break;default:break}return m};ol.geom.Geometry.prototype.convexHull=function(){return ol.coordinate.convexHull(c(this))}}(),ol.coordinate.toDFCI=function(n,c,h){!c&&c!==0&&(c=3),h&&(ol.proj.get("EPSG:27572")||(proj4.defs["EPSG:27572"]||proj4.defs("EPSG:27572","+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),ol.proj.proj4.register(proj4)),n=ol.proj.transform(n,h,"EPSG:27572"));var u=n[0],d=n[1],m="",g=1e5;if(m+=String.fromCharCode(65+Math.floor((u<8e5?u:u+2e5)/g))+String.fromCharCode(65+Math.floor((d<23e5?d:d+2e5)/g)-15e5/g),c===0)return m;var x=1e5/5;if(m+=2*Math.floor(u%g/x),m+=2*Math.floor(d%g/x),c===1)return m;var E=x/10,P=Math.floor(u%x/E);if(m+=String.fromCharCode(65+(P<8?P:P+2)),m+=Math.floor(d%x/E),c===2)return m;var L=Math.floor(u%E/500),F=Math.floor(d%E/500);return L<1?F>1?m+=".1":m+=".4":L>2?F>1?m+=".2":m+=".3":F>2?L<2?m+=".1":m+=".2":F<1?L<2?m+=".4":m+=".3":m+=".5",m},ol.coordinate.fromDFCI=function(n,c){var h,u=1e5,d=n.charCodeAt(0)-65;d=(d<8?d:d-2)*u;var m=n.charCodeAt(1)-65;if(m=(m<8?m:m-2)*u+15e5,n.length===2)h=[d+u/2,m+u/2];else if(u/=5,d+=Number(n.charAt(2))/2*u,m+=Number(n.charAt(3))/2*u,n.length===4)h=[d+u/2,m+u/2];else{u/=10;var g=n.charCodeAt(4)-65;if(d+=(g<8?g:g-2)*u,m+=Number(n.charAt(5))*u,n.length===6)h=[d+u/2,m+u/2];else switch(n.charAt(7)){case"1":h=[d+u/4,m+3*u/4];break;case"2":h=[d+3*u/4,m+3*u/4];break;case"3":h=[d+3*u/4,m+u/4];break;case"4":h=[d+u/4,m+u/4];break;default:h=[d+u/2,m+u/2];break}}return c&&(ol.proj.get("EPSG:27572")||(proj4.defs["EPSG:27572"]||proj4.defs("EPSG:27572","+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),ol.proj.proj4.register(proj4)),h=ol.proj.transform(h,"EPSG:27572",c)),h},ol.coordinate.validDFCI=function(n){return!(n.length<2||n.length>8||/[^A-H|^K-N]/.test(n.substr(0,1))||/[^B-H|^K-N]/.test(n.substr(1,1))||n.length>2&&(n.length<4||/[^0,^2,^4,^6,^8]/.test(n.substr(2,1))||/[^0,^2,^4,^6,^8]/.test(n.substr(3,1)))||n.length>4&&(n.length<6||/[^A-H|^K-L]/.test(n.substr(4,1))||/[^0-9]/.test(n.substr(5,1)))||n.length>6&&(n.length<8||n.substr(6,1)!=="."||/[^1-5]/.test(n.substr(7,1))))},ol.coordinate.validDFCICoord=function(n,c){return c&&(ol.proj.get("EPSG:27572")||(proj4.defs["EPSG:27572"]||proj4.defs("EPSG:27572","+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),ol.proj.proj4.register(proj4)),n=ol.proj.transform(n,c,"EPSG:27572")),!(0>n[0]||n[0]>12e5||16e5>n[1]||n[1]>27e5)},ol.graph={},ol.graph.Dijskra=function(n){n=n||{},this.source=n.source,this.nodes=new ol.source.Vector,this.maxIteration=n.maxIteration||2e4,this.stepIteration=n.stepIteration||2e3,this.astar=!0,this.candidat=[],ol.Object.call(this),this.set("epsilon",n.epsilon||1e-6)},ol.ext.inherits(ol.graph.Dijskra,ol.Object),ol.graph.Dijskra.prototype.weight=function(){return 1},ol.graph.Dijskra.prototype.direction=function(){return 2},ol.graph.Dijskra.prototype.getLength=function(n){return n.getGeometry&&(n=n.getGeometry()),n.getLength()},ol.graph.Dijskra.prototype.getNodeSource=function(){return this.nodes},ol.graph.Dijskra.prototype.getEdges=function(n){var c=ol.extent.buffer(ol.extent.boundingExtent([n]),this.get("epsilon")),h=[];return this.source.forEachFeatureIntersectingExtent(c,function(u){h.push(u)}),h},ol.graph.Dijskra.prototype.getNode=function(n){var c=ol.extent.buffer(ol.extent.boundingExtent([n]),this.get("epsilon")),h=[];return this.nodes.forEachFeatureIntersectingExtent(c,function(u){h.push(u)}),h[0]},ol.graph.Dijskra.prototype.addNode=function(n,c,h,u,d){if(this.wdist&&c>this.wdist)return!1;var m=this.getNode(n),g=c+this.getLength(new ol.geom.LineString([this.end,n]))*this.weight();if(this.astar&&this.wdist&&g>this.wdist)return!1;if(m){if(m!==this.arrival&&m.get("wdist")<=c)return m;m.set("dist",h),m.set("wdist",c),m.set("dtotal",g),m.set("from",u),m.set("prev",d),m===this.arrival&&(this.wdist=c),this.candidat.push(m)}else m=new ol.Feature({geometry:new ol.geom.Point(n),from:u,prev:d,dist:h||0,wdist:c,dtotal:g}),c<0?m.set("wdist",!1):this.candidat.push(m),this.nodes.addFeature(m);return m},ol.graph.Dijskra.prototype.closestCoordinate=function(n){var c=this.source.getClosestFeatureToCoordinate(n),h=c.getGeometry().getFirstCoordinate(),u=c.getGeometry().getLastCoordinate();return ol.coordinate.dist2d(n,h)<ol.coordinate.dist2d(n,u)?h:u},ol.graph.Dijskra.prototype.path=function(n,c){if(this.running)return!1;if(n=this.closestCoordinate(n),this.end=this.closestCoordinate(c),n[0]===this.end[0]&&n[1]===this.end[1])return this.dispatchEvent({type:"finish",route:[],wDistance:-1,distance:this.wdist}),!1;var h=this;return this.nodes.clear(),this.candidat=[],this.wdist=0,this.running=!0,this.addNode(n,0),this.arrival=this.addNode(this.end,-1),this.nb=0,this.dispatchEvent({type:"start"}),setTimeout(function(){h._resume()}),[n,this.end]},ol.graph.Dijskra.prototype.resume=function(){this.running||this.candidat.length&&(this.running=!0,this.nb=0,this._resume())},ol.graph.Dijskra.prototype.pause=function(){this.running&&(this.nb=-1)},ol.graph.Dijskra.prototype.getBestWay=function(){for(var n,c=-1,h=0,u;u=this.candidat[h];h++)u.get("wdist")>c&&(n=u,c=u.get("wdist"));return this.getRoute(n)},ol.graph.Dijskra.prototype._resume=function(){if(this.running){for(;this.candidat.length;){this.candidat.sort(function(F,U){return F.get("dtotal")<U.get("dtotal")?1:F.get("dtotal")===U.get("dtotal")?0:-1});for(var n=this.candidat.pop(),c=n.getGeometry().getCoordinates(),h=this.getEdges(c),u=0,d;d=h[u];u++){if(n.get("from")!==d){var m=this.getLength(d);m<0&&console.log("distance < 0!");var g=n.get("wdist")+m*this.weight(d);m=n.get("dist")+m;var x=d.getGeometry().getFirstCoordinate(),E=d.getGeometry().getLastCoordinate(),P=this.direction(d);P!==0&&(c[0]===x[0]&&c[1]===x[1]&&P!==-1&&this.addNode(E,g,m,d,n),c[0]===E[0]&&c[0]===E[0]&&P!==1&&this.addNode(x,g,m,d,n))}if(this.nb===-1||this.nb++>this.maxIteration){this.running=!1,this.dispatchEvent({type:"pause",overflow:this.nb!==-1});return}if(!(this.nb%this.stepIteration)){var L=this;window.setTimeout(function(){L._resume()},5),this.dispatchEvent({type:"calculating"});return}}}this.nodes.clear(),this.running=!1,this.dispatchEvent({type:"finish",route:this.getRoute(this.arrival),wDistance:this.wdist,distance:this.arrival.get("dist")})}},ol.graph.Dijskra.prototype.getRoute=function(n){for(var c=[];n;)c.unshift(n.get("from")),n=n.get("prev");return c.shift(),c},ol.geom.GPAltiCode=function(n,c){c=c||{};var h=n.getType();if(h!=="Point"&&h!=="LineString"){console.warn("[GPAltiCode] "+h+" not supported...");return}var u=c.projection||"EPSG:3857",d=c.sampling||0;if(c.samplingDist){var m=n.getLength();d=Math.max(d,Math.round(m/c.samplingDist))}d>5e3&&(d=5e3),d<2&&(d=0),n=n.clone().transform(u,"EPSG:4326");var g,x=[],E=[];switch(h){case"Point":{g=[n.getCoordinates()];break}case"LineString":{g=n.getCoordinates();break}default:return}d<=g.length&&(d=0),g.forEach(function(L){x.push(Math.round(L[0]*1e6)/1e6),E.push(Math.round(L[1]*1e6)/1e6)});var P="lon="+x.join("|")+"&lat="+E.join("|");d&&(P+="&sampling="+d),ol.ext.Ajax.get({url:"https://wxs.ign.fr/"+(c.apiKey||"essentiels")+"/alti/rest/"+(x.length>1?"elevationLine":"elevation")+".json?"+P,success:function(L){var F=[];L.elevations.forEach(function(A,G){d?F.push([A.lon,A.lat,A.z]):F.push([g[G][0],g[G][1],A.z])}),h==="Point"&&(F=F[0]);var U=ol.geom.createFromType(h,F);U.transform("EPSG:4326",u),typeof c.success=="function"&&c.success(U)},error:function(L){typeof c.error=="function"&&c.error(L)}})},ol.coordinate.GPAltiCode=function(n,c){c=c||{};var h=!n[0].length,u=h?new ol.geom.Point(n):new ol.geom.LineString(n);ol.geom.GPAltiCode(u,{projection:c.projection,apiKey:c.apiKey,sampling:c.sampling,samplingDist:c.samplingDist,success:function(d){typeof c.success=="function"&&c.success(d.getCoordinates())},error:c.error})},ol.coordinate.dist2d=function(n,c){var h=n[0]-c[0],u=n[1]-c[1];return Math.sqrt(h*h+u*u)},ol.coordinate.equal=function(n,c){return n[0]==c[0]&&n[1]==c[1]},ol.coordinate.getFeatureCenter=function(n){return ol.coordinate.getGeomCenter(n.getGeometry())},ol.coordinate.getGeomCenter=function(n){switch(n.getType()){case"Point":return n.getCoordinates();case"MultiPolygon":n=n.getPolygon(0);case"Polygon":return n.getInteriorPoint().getCoordinates();default:return n.getClosestPoint(ol.extent.getCenter(n.getExtent()))}},ol.coordinate.offsetCoords=function(n,c){var h=[],u=n.length-1,d=u,m,g,x,E,P,L,F,U,A,G,B,O,K,Q=ol.coordinate.equal(n[0],n[u]);Q||(B=n[0],O=n[1],K=[B[0]+(O[1]-B[1])/ol.coordinate.dist2d(B,O)*c,B[1]-(O[0]-B[0])/ol.coordinate.dist2d(B,O)*c],h.push(K),n.push(n[u]),u++,d--);for(var et=0;et<d;et++)B=n[et],O=n[(et+1)%u],K=n[(et+2)%u],m=(O[1]-B[1])/(O[0]-B[0]),g=(K[1]-O[1])/(K[0]-O[0]),Math.abs(m-g)>1e-10&&(x=Math.sqrt((O[0]-B[0])*(O[0]-B[0])+(O[1]-B[1])*(O[1]-B[1])),E=Math.sqrt((K[0]-O[0])*(K[0]-O[0])+(K[1]-O[1])*(K[1]-O[1])),P=B[0]+c*(O[1]-B[1])/x,L=O[0]+c*(K[1]-O[1])/E,F=B[1]-c*(O[0]-B[0])/x,U=O[1]-c*(K[0]-O[0])/E,A=(g*L-m*P+F-U)/(g-m),G=(m*g*(L-P)+g*F-m*U)/(g-m),O[0]-B[0]==0&&(A=O[0]+c*(O[1]-B[1])/Math.abs(O[1]-B[1]),G=g*A-g*L+U),K[0]-O[0]==0&&(A=K[0]+c*(K[1]-O[1])/Math.abs(K[1]-O[1]),G=m*A-m*P+F),h.push([A,G]));return Q?h.push(h[0]):(n.pop(),B=n[n.length-1],O=n[n.length-2],K=[B[0]-(O[1]-B[1])/ol.coordinate.dist2d(B,O)*c,B[1]+(O[0]-B[0])/ol.coordinate.dist2d(B,O)*c],h.push(K)),h},ol.coordinate.findSegment=function(n,c){for(var h=0;h<c.length-1;h++){var u=c[h],d=c[h+1];if(ol.coordinate.equal(n,u)||ol.coordinate.equal(n,d))return{index:1,segment:[u,d]};var m=ol.coordinate.dist2d(u,d),g=[(d[0]-u[0])/m,(d[1]-u[1])/m],x=ol.coordinate.dist2d(u,n),E=[(n[0]-u[0])/x,(n[1]-u[1])/x];if(Math.abs(g[0]*E[1]-g[1]*E[0])<1e-10)return{index:1,segment:[u,d]}}return{index:-1}},ol.coordinate.splitH=function(n,c,h){for(var u,d,m=[],g=0;g<n.length-1;g++)!n[g].length||!n[g+1].length||(n[g][1]<=c&&n[g+1][1]>c||n[g][1]>=c&&n[g+1][1]<c)&&(d=(c-n[g][1])/(n[g+1][1]-n[g][1]),u=d*(n[g+1][0]-n[g][0])+n[g][0],m.push({contour:h,index:g,pt:[u,c],abs:d}));m.sort(function(P,L){return P.pt[0]-L.pt[0]});for(var x=[],E=0;E<m.length-1;E+=2)x.push([m[E],m[E+1]]);return x},ol.geom.createFromType=function(n,c){switch(n){case"LineString":return new ol.geom.LineString(c);case"LinearRing":return new ol.geom.LinearRing(c);case"MultiLineString":return new ol.geom.MultiLineString(c);case"MultiPoint":return new ol.geom.MultiPoint(c);case"MultiPolygon":return new ol.geom.MultiPolygon(c);case"Point":return new ol.geom.Point(c);case"Polygon":return new ol.geom.Polygon(c);default:return console.error("[createFromType] Unsupported type: "+n),null}},ol.coordinate.getIntersectionPoint=function(n,c){var h=n[1][0]-n[0][0],u=n[1][1]-n[0][1],d=c[1][0]-c[0][0],m=c[1][1]-c[0][1],g=h*m-u*d;if(g!=0){var x=(h*n[0][1]-h*c[0][1]-u*n[0][0]+u*c[0][0])/g;return[c[0][0]+x*d,c[0][1]+x*m]}else return!1},ol.extent.intersection,function(){function n(h,u){for(var d,m=h.length-1;m>0;m--)(h[m][0]>u&&h[m-1][0]<u||h[m][0]<u&&h[m-1][0]>u)&&(d=[u,(u-h[m][0])/(h[m-1][0]-h[m][0])*(h[m-1][1]-h[m][1])+h[m][1]],h.splice(m,0,d))}function c(h,u){for(var d,m=h.length-1;m>0;m--)(h[m][1]>u&&h[m-1][1]<u||h[m][1]<u&&h[m-1][1]>u)&&(d=[(u-h[m][1])/(h[m-1][1]-h[m][1])*(h[m-1][0]-h[m][0])+h[m][0],u],h.splice(m,0,d))}ol.extent.intersection=function(h,u){var d=u.getType()==="Polygon";if(!d&&u.getType()!=="MultiPolygon")return null;var m=u.getCoordinates();return d&&(m=[m]),m.forEach(function(g){g.forEach(function(x){n(x,h[0]),n(x,h[2]),c(x,h[1]),c(x,h[3])})}),m.forEach(function(g){g.forEach(function(x){x.forEach(function(E){E[0]<h[0]?E[0]=h[0]:E[0]>h[2]&&(E[0]=h[2]),E[1]<h[1]?E[1]=h[1]:E[1]>h[3]&&(E[1]=h[3])})})}),d?new ol.geom.Polygon(m[0]):new ol.geom.MultiPolygon(m)}}(),ol.coordinate.sampleAt=function(n,c,h,u){var d=[];u!==!1&&d.push(n);var m=ol.coordinate.dist2d(n,c);if(m){var g=Math.round(m/h);if(g>1)for(var x=(c[0]-n[0])/g,E=(c[1]-n[1])/g,P=1;P<g;P++)d.push([n[0]+x*P,n[1]+E*P])}return d.push(c),d},ol.geom.LineString.prototype.sampleAt=function(n){for(var c=this.getCoordinates(),h=[],u=1;u<c.length;u++)h=h.concat(ol.coordinate.sampleAt(c[u-1],c[u],n,u===1));return new ol.geom.LineString(h)},ol.geom.MultiLineString.prototype.sampleAt=function(n){var c=this.getCoordinates(),h=[];return c.forEach(function(u){for(var d=[],m=1;m<u.length;m++)d=d.concat(ol.coordinate.sampleAt(u[m-1],u[m],n,m===1));h.push(d)}),new ol.geom.MultiLineString(h)},ol.geom.Polygon.prototype.sampleAt=function(n){var c=this.getCoordinates(),h=[];return c.forEach(function(u){for(var d=[],m=1;m<u.length;m++)d=d.concat(ol.coordinate.sampleAt(u[m-1],u[m],n,m===1));h.push(d)}),new ol.geom.Polygon(h)},ol.geom.MultiPolygon.prototype.sampleAt=function(n){var c=this.getCoordinates(),h=[];return c.forEach(function(u){var d=[];h.push(d),u.forEach(function(m){for(var g=[],x=1;x<m.length;x++)g=g.concat(ol.coordinate.sampleAt(m[x-1],m[x],n,x===1));d.push(g)})}),new ol.geom.MultiPolygon(h)},ol.geom.Circle.prototype.intersection=function(n,c){if(n.sampleAt){var h=ol.extent.buffer(this.getCenter().concat(this.getCenter()),this.getRadius());n=ol.extent.intersection(h,n),n=n.simplify(c);var u=this.getCenter(),d=this.getRadius(),m=n.sampleAt(c).getCoordinates();switch(n.getType()){case"Polygon":m=[m];case"MultiPolygon":{var g=!1,x=[];return m.forEach(function(E){var P=[];x.push(P),E.forEach(function(L){var F=[];P.push(F),L.forEach(function(U){var A=ol.coordinate.dist2d(u,U);A>d?(g=!0,F.push([u[0]+d/A*(U[0]-u[0]),u[1]+d/A*(U[1]-u[1])])):F.push(U)})})}),g?n.getType()==="Polygon"?new ol.geom.Polygon(x[0]):new ol.geom.MultiPolygon(x):n}}}else console.warn("[ol/geom/Circle~intersection] Unsupported geometry type: "+n.getType());return n},ol.geom.LineString.prototype.splitAt=function(n,c){var h;if(!n)return[this];if(c||(c=1e-10),n.length&&n[0].length){var u=[this];for(h=0;h<n.length;h++){for(var d=[],m=0;m<u.length;m++){var g=u[m].splitAt(n[h],c);d=d.concat(g)}u=d}return u}if(ol.coordinate.equal(n,this.getFirstCoordinate())||ol.coordinate.equal(n,this.getLastCoordinate()))return[this];var x=this.getCoordinates(),E=[x[0]],P=[];for(h=0;h<x.length-1;h++)if(!ol.coordinate.equal(x[h],x[h+1])){if(ol.coordinate.equal(n,x[h+1]))E.push(x[h+1]),P.push(new ol.geom.LineString(E)),E=[];else if(!ol.coordinate.equal(n,x[h])){var L,F,U=!1;x[h][0]==x[h+1][0]?(L=(x[h][1]-n[1])/(x[h][1]-x[h+1][1]),U=x[h][0]==n[0]&&0<L&&L<=1):x[h][1]==x[h+1][1]?(L=(x[h][0]-n[0])/(x[h][0]-x[h+1][0]),U=x[h][1]==n[1]&&0<L&&L<=1):(L=(x[h][0]-n[0])/(x[h][0]-x[h+1][0]),F=(x[h][1]-n[1])/(x[h][1]-x[h+1][1]),U=Math.abs(L-F)<=c&&0<L&&L<=1),U&&(E.push(n),P.push(new ol.geom.LineString(E)),E=[n])}E.push(x[h+1])}return E.length>1&&P.push(new ol.geom.LineString(E)),P.length?P:[this]},ol.geom.MultiPolygon.prototype.scribbleFill=function(n){var c=[],h=this.getPolygons(),u,d,m;for(u=0;d=h[u];u++){var g=d.scribbleFill(n);g&&c.push(g)}if(!c.length)return null;var x=c[0],E;for(u=0;m=c[u];u++){E=m.getLineStrings();for(var P=0;P<E.length;P++)x.appendLineString(E[P])}return x},ol.geom.Polygon.prototype.scribbleFill=function(n){var c=n.interval,h=n.angle||Math.PI/2,u,d,m,g=this.clone();g.rotate(h,[0,0]);var x=g.getCoordinates(),E=x[0];for(u=1;u<x.length;u++)E.push([]),E=E.concat(x[u]);for(var P=g.getExtent(),L=[],F=(Math.floor(P[1]/c)+1)*c;F<P[3];F+=c)m=ol.coordinate.splitH(E,F,u),L=L.concat(m);if(!L.length)return null;var U=E.length-1,A=L[0][0].index;for(d=0;m=L[d];d++)L[d][0].index=(L[d][0].index-A+U)%U,L[d][1].index=(L[d][1].index-A+U)%U;for(var G=[];;){for(d=0;(m=L[d])&&m[0].done;d++);if(!m)break;for(var B=[];m;){m[0].done=!0,B.push(m[0].pt),B.push(m[1].pt);for(var O=m[0].pt[1]+c,K=1/0,Q=null;L[d]&&!(L[d][0].pt[1]>O);){if(L[d][0].pt[1]===O){var et=Math.min((L[d][0].index-m[0].index+U)%U,(m[0].index-L[d][0].index+U)%U),lt=Math.min((m[1].index-m[0].index+U)%U,(m[0].index-m[1].index+U)%U);et<K&&et<lt&&(K=et,L[d][0].done?Q=null:Q=L[d])}d++}m=Q}B.length&&G.push(B)}if(!G.length)return null;var pt=new ol.geom.MultiLineString(G);return pt.rotate(-h,[0,0]),pt.cspline({pointsPerSeg:8,tension:.9})},ol.geohash={base32:"0123456789bcdefghjkmnpqrstuvwxyz"},ol.geohash.fromLonLat=function(n,c){var h=n[0],u=n[1];if(!c){for(var d=1;d<=12;d++){var m=ol.geohash.fromLonLat([h,u],d),g=ol.geohash.toLonLat(m);if(g.lat==u&&g.lon==h)return m}c=12}(c<1||c>12)&&(c=12);for(var x=0,E=0,P=!0,L="",F=-90,U=90,A=-180,G=180;L.length<c;){if(P){var B=(A+G)/2;h>=B?(x=x*2+1,A=B):(x=x*2,G=B)}else{var O=(F+U)/2;u>=O?(x=x*2+1,F=O):(x=x*2,U=O)}P=!P,++E==5&&(L+=ol.geohash.base32.charAt(x),E=0,x=0)}return L},ol.geohash.toLonLat=function(n){var c=ol.geohash.getExtent(n),h=c[1],u=c[0],d=c[3],m=c[2],g=(h+d)/2,x=(u+m)/2;return g=g.toFixed(Math.floor(2-Math.log(d-h)/Math.LN10)),x=x.toFixed(Math.floor(2-Math.log(m-u)/Math.LN10)),[Number(x),Number(g)]},ol.geohash.getExtent=function(n){if(!n)return!1;n=n.toLowerCase();for(var c=!0,h=-90,u=90,d=-180,m=180,g=0;g<n.length;g++){var x=n.charAt(g),E=ol.geohash.base32.indexOf(x);if(E==-1)return!1;for(var P=4;P>=0;P--){var L=E>>P&1;if(c){var F=(d+m)/2;L==1?d=F:m=F}else{var U=(h+u)/2;L==1?h=U:u=U}c=!c}}return[d,h,m,u]},ol.geohash.getAdjacent=function(n,c){if(n=n.toLowerCase(),c=c.toLowerCase(),!n||"nsew".indexOf(c)==-1)return!1;var h={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},u={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},d=n.slice(-1),m=n.slice(0,-1),g=n.length%2;return u[c][g].indexOf(d)!=-1&&m!=""&&(m=ol.geohash.getAdjacent(m,c)),m+ol.geohash.base32.charAt(h[c][g].indexOf(d))},ol.geohash.getNeighbours=function(n){return{n:ol.geohash.getAdjacent(n,"n"),ne:ol.geohash.getAdjacent(ol.geohash.getAdjacent(n,"n"),"e"),e:ol.geohash.getAdjacent(n,"e"),se:ol.geohash.getAdjacent(ol.geohash.getAdjacent(n,"s"),"e"),s:ol.geohash.getAdjacent(n,"s"),sw:ol.geohash.getAdjacent(ol.geohash.getAdjacent(n,"s"),"w"),w:ol.geohash.getAdjacent(n,"w"),nw:ol.geohash.getAdjacent(ol.geohash.getAdjacent(n,"n"),"w")}},ol.sphere.greatCircleBearing=function(n,c){var h=Math.PI/180,u=[n[0]*h,n[1]*h],d=[c[0]*h,c[1]*h],m=Math.atan2(Math.sin(d[0]-u[0])*Math.cos(d[1]),Math.cos(u[1])*Math.sin(d[1])-Math.sin(u[1])*Math.cos(d[1])*Math.cos(d[0]-u[0]));return m},ol.sphere.computeDestinationPoint=function(n,c,h,u){u=u||{};var d=Math.PI/180,m=u.radius||63710088e-1,g=n[1]*d,x=n[0]*d,E=c/m,P=Math.asin(Math.sin(g)*Math.cos(E)+Math.cos(g)*Math.sin(E)*Math.cos(h)),L=x+Math.atan2(Math.sin(h)*Math.sin(E)*Math.cos(g),Math.cos(E)-Math.sin(g)*Math.sin(P)),F=L/d;return u.normalize!==!1&&(F<-180||F>180)&&(F=F*540%360-180),[F,P/d]},ol.sphere.greatCircleTrack=function(n,c,h){h=h||{};for(var u=ol.sphere.greatCircleBearing(n,c),d=ol.sphere.getDistance(n,c,h.radius),m=h.distance||1e3,g=m,x=[n];g<d;)x.push(ol.sphere.computeDestinationPoint(n,g,u,{radius:h.radius,normalize:!1})),g+=m;var E=ol.sphere.computeDestinationPoint(n,d,u,{radius:h.radius,normalize:!1});return Math.abs(E[0]-c[0])>1&&(E[0]>c[0]?c[0]+=360:c[0]-=360),x.push(c),x},ol.sphere.getMapScale=function(n,c){var h=n.getView(),u=h.getProjection(),d=h.getCenter(),m=n.getPixelFromCoordinate(d);m[1]+=1;var g=n.getCoordinateFromPixel(m),x=ol.sphere.getDistance(ol.proj.transform(d,u,"EPSG:4326"),ol.proj.transform(g,u,"EPSG:4326"));return x*=(c||96)/.0254,x},ol.sphere.setMapScale=function(n,c,h){if(n&&c){var u=c;if(typeof c=="string"&&(u=c.split("/")[1],u||(u=c),u=u.replace(/[^\d]/g,""),u=parseInt(u)),!u)return;var d=n.getView(),m=d.getProjection(),g=d.getCenter(),x=n.getPixelFromCoordinate(g);x[1]+=1;var E=n.getCoordinateFromPixel(x),P=ol.sphere.getDistance(ol.proj.transform(g,m,"EPSG:4326"),ol.proj.transform(E,m,"EPSG:4326"));return P*=(h||96)/.0254,d.setResolution(d.getResolution()*u/P),u}},ol.Map.prototype.animExtent=function(n,c){var h;c=c||{},c.projection&&(n=ol.proj.transformExtent(n,c.projection,this.getView().getProjection()));var u=new Date().getTime(),d=c.duration||1e3,m=c.easing||ol.easing.upAndDown,g=c.style&&c.style.getWidth()||2,x=c.style&&c.style.getColr()||"red";function E(P){var L=P.frameState,F=L.pixelRatio,U=L.time-u;if(U>d)ol.Observable.unByKey(h);else{var A=U/d,G=this.getPixelFromCoordinate([n[0],n[1]]),B=this.getPixelFromCoordinate([n[2],n[3]]),O=P.context;O.save(),O.scale(F,F),O.beginPath(),O.globalAlpha=m(1-A),O.lineWidth=g,O.strokeStyle=x,O.rect(G[0],G[1],B[0]-G[0],B[1]-G[1]),O.stroke(),O.restore(),L.animate=!0}}h=this.on("postcompose",E.bind(this));try{this.renderSync()}catch{}},ol.geom.Geometry.prototype.cspline=function(n){return this.calcCSpline_?((this.csplineGeometryRevision!=this.getRevision()||this.csplineOption!=JSON.stringify(n))&&(this.csplineGeometry_=this.calcCSpline_(n),this.csplineGeometryRevision=this.getRevision(),this.csplineOption=JSON.stringify(n)),this.csplineGeometry_):this},ol.geom.GeometryCollection.prototype.calcCSpline_=function(n){for(var c=[],h=this.getGeometries(),u=0;u<h.length;u++)c.push(h[u].cspline(n));return new ol.geom.GeometryCollection(c)},ol.geom.MultiLineString.prototype.calcCSpline_=function(n){for(var c=[],h=this.getLineStrings(),u=0;u<h.length;u++)c.push(h[u].cspline(n).getCoordinates());return new ol.geom.MultiLineString(c)},ol.geom.Polygon.prototype.calcCSpline_=function(n){for(var c=[],h=this.getCoordinates(),u=0;u<h.length;u++)c.push(new ol.geom.LineString(h[u]).cspline(n).getCoordinates());return new ol.geom.Polygon(c)},ol.geom.MultiPolygon.prototype.calcCSpline_=function(n){for(var c=[],h=this.getPolygons(),u=0;u<h.length;u++)c.push(h[u].cspline(n).getCoordinates());return new ol.geom.MultiPolygon(c)},ol.coordinate.cspline=function(n,c){c||(c={});var h=typeof c.tension=="number"?c.tension:.5,u=0,d=n[0];n.forEach(function($){u+=ol.coordinate.dist2d(d,$),d=$});var m=c.resolution||u/n.length/(c.pointsPerSeg||10),g,x=[],E,P,L,F,U,A,G,B,O,K,Q,et,lt;g=n.slice(0),n.length>2&&n[0][0]==n[n.length-1][0]&&n[0][1]==n[n.length-1][1]?(g.unshift(n[n.length-2]),g.push(n[1])):(g.unshift(n[0]),g.push(n[n.length-1]));function pt($,_t,W,rt){var nt=W-$,vt=rt-_t;return Math.sqrt(nt*nt+vt*vt)}for(lt=1;lt<g.length-2;lt++){var T=pt(g[lt][0],g[lt][1],g[lt+1][0],g[lt+1][1]),ct=Math.round(T/m),ut=1;if(c.normalize){T=pt(g[lt+1][0],g[lt+1][1],g[lt-1][0],g[lt-1][1]);var ft=pt(g[lt+2][0],g[lt+2][1],g[lt][0],g[lt][1]);T<ft?ut=T/ft:ut=ft/T}for(L=(g[lt+1][0]-g[lt-1][0])*h*ut,F=(g[lt+2][0]-g[lt][0])*h*ut,U=(g[lt+1][1]-g[lt-1][1])*h*ut,A=(g[lt+2][1]-g[lt][1])*h*ut,et=0;et<=ct;et++)Q=et/ct,G=2*Math.pow(Q,3)-3*Math.pow(Q,2)+1,B=-(2*Math.pow(Q,3))+3*Math.pow(Q,2),O=Math.pow(Q,3)-2*Math.pow(Q,2)+Q,K=Math.pow(Q,3)-Math.pow(Q,2),E=G*g[lt][0]+B*g[lt+1][0]+O*L+K*F,P=G*g[lt][1]+B*g[lt+1][1]+O*U+K*A,E&&P&&x.push([E,P])}return x},ol.geom.LineString.prototype.calcCSpline_=function(n){var c=this.getCoordinates(),h=ol.coordinate.cspline(c,n);return new ol.geom.LineString(h)},ol.HexGrid=function(n){n=n||{},ol.Object.call(this,n),this.size_=n.size||8e4,this.origin_=n.origin||[0,0],this.layout_=this.layout[n.layout]||this.layout.pointy},ol.ext.inherits(ol.HexGrid,ol.Object),ol.HexGrid.prototype.layout={pointy:[Math.sqrt(3),Math.sqrt(3)/2,0,3/2,Math.sqrt(3)/3,-1/3,0,2/3,Math.cos(Math.PI/180*(60*0+30)),Math.sin(Math.PI/180*(60*0+30)),Math.cos(Math.PI/180*(60*1+30)),Math.sin(Math.PI/180*(60*1+30)),Math.cos(Math.PI/180*(60*2+30)),Math.sin(Math.PI/180*(60*2+30)),Math.cos(Math.PI/180*(60*3+30)),Math.sin(Math.PI/180*(60*3+30)),Math.cos(Math.PI/180*(60*4+30)),Math.sin(Math.PI/180*(60*4+30)),Math.cos(Math.PI/180*(60*5+30)),Math.sin(Math.PI/180*(60*5+30))],flat:[3/2,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,Math.cos(Math.PI/180*(60*0)),Math.sin(Math.PI/180*(60*0)),Math.cos(Math.PI/180*(60*1)),Math.sin(Math.PI/180*(60*1)),Math.cos(Math.PI/180*(60*2)),Math.sin(Math.PI/180*(60*2)),Math.cos(Math.PI/180*(60*3)),Math.sin(Math.PI/180*(60*3)),Math.cos(Math.PI/180*(60*4)),Math.sin(Math.PI/180*(60*4)),Math.cos(Math.PI/180*(60*5)),Math.sin(Math.PI/180*(60*5))]},ol.HexGrid.prototype.setLayout=function(n){this.layout_=this.layout[n]||this.layout.pointy,this.changed()},ol.HexGrid.prototype.getLayout=function(){return this.layout_[9]!=0?"pointy":"flat"},ol.HexGrid.prototype.setOrigin=function(n){this.origin_=n,this.changed()},ol.HexGrid.prototype.getOrigin=function(){return this.origin_},ol.HexGrid.prototype.setSize=function(n){this.size_=n||8e4,this.changed()},ol.HexGrid.prototype.getSize=function(){return this.size_},ol.HexGrid.prototype.cube2hex=function(n){return[n[0],n[2]]},ol.HexGrid.prototype.hex2cube=function(n){return[n[0],-n[0]-n[1],n[1]]},ol.HexGrid.prototype.hex2offset=function(n){return this.layout_[9]?[n[0]+(n[1]-(n[1]&1))/2,n[1]]:[n[0],n[1]+(n[0]+(n[0]&1))/2]},ol.HexGrid.prototype.offset2hex=function(n){return this.layout_[9]?[n[0]-(n[1]-(n[1]&1))/2,n[1]]:[n[0],n[1]-(n[0]+(n[0]&1))/2]},ol.HexGrid.prototype.cube_round=function(n){var c=Math.round(n[0]),h=Math.round(n[1]),u=Math.round(n[2]),d=Math.abs(c-n[0]),m=Math.abs(h-n[1]),g=Math.abs(u-n[2]);return d>m&&d>g?c=-h-u:m>g?h=-c-u:u=-c-h,[c,h,u]},ol.HexGrid.prototype.hex_round=function(n){return this.cube2hex(this.cube_round(this.hex2cube(n)))},ol.HexGrid.prototype.hex_corner=function(n,c,h){return[n[0]+c*this.layout_[8+2*(h%6)],n[1]+c*this.layout_[9+2*(h%6)]]},ol.HexGrid.prototype.getHexagonAtCoord=function(n){return this.getHexagon(this.coord2hex(n))},ol.HexGrid.prototype.getHexagon=function(n){for(var c=[],h=this.hex2coord(n),u=0;u<=7;u++)c.push(this.hex_corner(h,this.size_,u,this.layout_[8]));return c},ol.HexGrid.prototype.hex2coord=function(n){return[this.origin_[0]+this.size_*(this.layout_[0]*n[0]+this.layout_[1]*n[1]),this.origin_[1]+this.size_*(this.layout_[2]*n[0]+this.layout_[3]*n[1])]},ol.HexGrid.prototype.coord2hex=function(n){var c=[(n[0]-this.origin_[0])/this.size_,(n[1]-this.origin_[1])/this.size_],h=this.layout_[4]*c[0]+this.layout_[5]*c[1],u=this.layout_[6]*c[0]+this.layout_[7]*c[1];return this.hex_round([h,u])},ol.HexGrid.prototype.cube_distance=function(n,c){return Math.max(Math.abs(n[0]-c[0]),Math.abs(n[1]-c[1]),Math.abs(n[2]-c[2]))},function(){function n(h,u,d){return h+(u-h)*d}function c(h,u,d){return[n(h[0]+1e-6,u[0],d),n(h[1]+1e-6,u[1],d),n(h[2]+1e-6,u[2],d)]}ol.HexGrid.prototype.cube_line=function(h,u){var d=this.cube_distance(h,u);if(!d)return[h];for(var m=[],g=0;g<=d;g++)m.push(this.cube_round(c(h,u,g/d)));return m}}(),ol.HexGrid.prototype.neighbors={cube:[[1,-1,0],[1,0,-1],[0,1,-1],[-1,1,0],[-1,0,1],[0,-1,1]],hex:[[1,0],[1,-1],[0,-1],[-1,0],[-1,1],[0,1]]},ol.HexGrid.prototype.hex_neighbors=function(n,c){if(c!==void 0)return[n[0]+this.neighbors.hex[c%6][0],n[1]+this.neighbors.hex[c%6][1]];var h=[];for(c=0;c<6;c++)h.push([n[0]+this.neighbors.hex[c][0],n[1]+this.neighbors.hex[c][1]]);return h},ol.HexGrid.prototype.cube_neighbors=function(n,c){if(c!==void 0)return[n[0]+this.neighbors.cube[c%6][0],n[1]+this.neighbors.cube[c%6][1],n[2]+this.neighbors.cube[c%6][2]];var h=[];for(c=0;c<6;c++)h.push([n[0]+this.neighbors.cube[c][0],n[1]+this.neighbors.cube[c][1],n[2]+this.neighbors.cube[c][2]]);for(c=0;c<6;c++)h[c]=this.cube2hex(h[c]);return h},ol.InseeGrid=function(n){n=n||{},proj4.defs["EPSG:3035"]||(proj4.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs"),ol.proj.proj4.register(proj4)),ol.Object.call(this,n);var c=Math.max(200,Math.round((n.size||0)/200)*200);this.set("size",c)},ol.ext.inherits(ol.InseeGrid,ol.Object),ol.InseeGrid.extent=[32e5,2e6,43e5,314e4],ol.InseeGrid.prototype.getExtent=function(n){return ol.proj.transformExtent(ol.InseeGrid.extent,n||"EPSG:3035","EPSG:3857")},ol.InseeGrid.prototype.getGridAtCoordinate=function(n,c){var h=ol.proj.transform(n,c||"EPSG:3857","EPSG:3035"),u=this.get("size"),d=Math.floor(h[0]/u)*u,m=Math.floor(h[1]/u)*u,g=new ol.geom.Polygon([[[d,m],[d+u,m],[d+u,m+u],[d,m+u],[d,m]]]);return g.transform("EPSG:3035",c||"EPSG:3857"),g},ol.Map.prototype.markup=function(n,c){var h,u=this;c=c||{},c.projection&&(n=ol.proj.transform(n,c.projection,this.getView().getProjection()));var d=new Date().getTime(),m=c.delay||3e3,g=1e3,x=c.maxZoom||100,E=ol.easing.easeOut,P=c.style;P||(P=new ol.style.Circle({radius:10,stroke:new ol.style.Stroke({color:"red",width:2})})),P instanceof ol.style.Image&&(P=new ol.style.Style({image:P})),P instanceof Array||(P=[P]);function L(F){var U=F.frameState,A=U.time-d;if(A>m+g)ol.Observable.unByKey(h),h=null;else{m>A&&this.getView().getZoom()>x&&(m=A);var G=U.pixelRatio,B=0;A>m&&(B=(A-m)/g);var O=F.context;O.save(),O.beginPath(),O.globalAlpha=E(1-B);for(var K=0;K<P.length;K++){var Q=P[K].getImage(),et=Q.getScale();Q.setScale(et*G),F.vectorContext.setStyle(P[K]),F.vectorContext.drawGeometry(new ol.geom.Point(n)),Q.setScale(et)}O.restore(),A>=m&&(U.animate=!0)}}setTimeout(function(){if(h)try{u.renderSync()}catch{}},m),h=this.on("postcompose",L.bind(this));try{this.renderSync()}catch{}return h.stop=function(){m=g=0;try{this.target.renderSync()}catch{}},h},ol.ordering={},ol.ordering.yOrdering=function(){return function(n,c){return c.getGeometry().getExtent()[1]-n.getGeometry().getExtent()[1]}},ol.ordering.zIndex=function(n){n||(n={});var c=n.attribute||"zIndex";return n.equalFn?function(h,u){return h.get(c)==u.get(c)?n.equalFn(h,u):h.get(c)<u.get(c)?1:-1}:function(h,u){return h.get(c)==u.get(c)?0:h.get(c)<u.get(c)?1:-1}},ol.Map.prototype.pulse=function(n,c){var h;c=c||{},c.projection&&(n=ol.proj.transform(n,c.projection,this.getView().getProjection()));var u=new Date().getTime(),d=c.duration||3e3,m=c.easing||ol.easing.easeOut,g=c.style;g||(g=new ol.style.Circle({radius:30,stroke:new ol.style.Stroke({color:"red",width:2})})),g instanceof ol.style.Image&&(g=new ol.style.Style({image:g})),g instanceof Array||(g=[g]);var x=c.amplitude||1;x<0&&(x=0);var E=c.radius||15;E<0&&(E=5);function P(L){var F=L.frameState,U=F.pixelRatio,A=F.time-u;if(A>d)ol.Observable.unByKey(h);else{var G=A/d,B=L.context;B.save(),B.beginPath();var O=m(G);B.globalAlpha=m(1-G),console.log("anim");for(var K=0;K<g.length;K++){var Q=g[K].getImage(),et=Q.getScale();Q.setScale(U*et*(1+x*(O-1))),L.vectorContext.setStyle(g[K]),L.vectorContext.drawGeometry(new ol.geom.Point(n)),Q.setScale(et)}B.restore(),F.animate=!0}}h=this.on("postcompose",P.bind(this));try{this.renderSync()}catch{}},ol.style.Chart=function(n){var c=n||{},h=0;n.stroke&&(h=n.stroke.getWidth()),ol.style.RegularShape.call(this,{radius:c.radius+h,fill:new ol.style.Fill({color:[0,0,0]}),rotation:c.rotation,displacement:c.displacement,snapToPixel:c.snapToPixel}),c.scale&&this.setScale(c.scale),this._stroke=c.stroke,this._radius=c.radius||20,this._donutratio=c.donutRatio||.5,this._type=c.type,this._offset=[c.offsetX?c.offsetX:0,c.offsetY?c.offsetY:0],this._animation=typeof c.animation=="number"?{animate:!0,step:c.animation}:this._animation={animate:!1,step:1},this._max=c.max,this._data=c.data,c.colors instanceof Array?this._colors=c.colors:(this._colors=ol.style.Chart.colors[c.colors],this._colors||(this._colors=ol.style.Chart.colors.classic)),this.renderChart_()},ol.ext.inherits(ol.style.Chart,ol.style.RegularShape),ol.style.Chart.colors={classic:["#ffa500","blue","red","green","cyan","magenta","yellow","#0f0"],dark:["#960","#003","#900","#060","#099","#909","#990","#090"],pale:["#fd0","#369","#f64","#3b7","#880","#b5d","#666"],pastel:["#fb4","#79c","#f66","#7d7","#acc","#fdd","#ff9","#b9b"],neon:["#ff0","#0ff","#0f0","#f0f","#f00","#00f"]},ol.style.Chart.prototype.clone=function(){var n=new ol.style.Chart({type:this._type,radius:this._radius,rotation:this.getRotation(),scale:this.getScale(),data:this.getData(),snapToPixel:this.getSnapToPixel?this.getSnapToPixel():!1,stroke:this._stroke,colors:this._colors,offsetX:this._offset[0],offsetY:this._offset[1],animation:this._animation});return n.setScale(this.getScale()),n.setOpacity(this.getOpacity()),n},ol.style.Chart.prototype.getData=function(){return this._data},ol.style.Chart.prototype.setData=function(n){this._data=n,this.renderChart_()},ol.style.Chart.prototype.getRadius=function(){return this._radius},ol.style.Chart.prototype.setRadius=function(n,c){this._radius=n,this.donuratio_=c||this.donuratio_,this.renderChart_()},ol.style.Chart.prototype.setAnimation=function(n){if(n===!1){if(this._animation.animate==!1)return;this._animation.animate=!1}else{if(this._animation.step==n)return;this._animation.animate=!0,this._animation.step=n}this.renderChart_()},ol.style.Chart.prototype.renderChart_=function(n){if(!n){this.getPixelRatio?(n=window.devicePixelRatio,this.renderChart_(n),this.getPixelRatio&&n!==1&&this.renderChart_(1)):this.renderChart_(1);return}var c,h=0;this._stroke&&(c=ol.color.asString(this._stroke.getColor()),h=this._stroke.getWidth());var u=this.getImage(n),d=u.getContext("2d");d.save(),d.setTransform(n,0,0,n,0,0),d.clearRect(0,0,u.width,u.height),d.lineJoin="round";var m=0,g,x;for(g=0;g<this._data.length;g++)m+=this._data[g];d.translate(0,0);var E=this._animation.animate?this._animation.step:1;switch(this._type){case"donut":case"pie3D":case"pie":{var P,L=Math.PI*(E-1.5);for(x=u.width/2/n,d.strokeStyle=c,d.lineWidth=h,d.save(),this._type=="pie3D"&&(d.translate(0,x*.3),d.scale(1,.7),d.beginPath(),d.fillStyle="#369",d.arc(x,x*1.4,this._radius*E,0,2*Math.PI),d.fill(),d.stroke()),this._type=="donut"&&(d.save(),d.beginPath(),d.rect(0,0,2*x,2*x),d.arc(x,x,this._radius*E*this._donutratio,0,2*Math.PI),d.clip("evenodd")),g=0;g<this._data.length;g++)d.beginPath(),d.moveTo(x,x),d.fillStyle=this._colors[g%this._colors.length],P=L+2*Math.PI*this._data[g]/m*E,d.arc(x,x,this._radius*E,L,P),d.closePath(),d.fill(),d.stroke(),L=P;this._type=="donut"&&(d.restore(),d.beginPath(),d.strokeStyle=c,d.lineWidth=h,d.arc(x,x,this._radius*E*this._donutratio,Math.PI*(E-1.5),L),d.stroke()),d.restore();break}case"bar":default:{var F=0;if(this._max)F=this._max;else for(g=0;g<this._data.length;g++)F<this._data[g]&&(F=this._data[g]);var U=Math.min(5,2*this._radius/this._data.length);x=u.width/2/n;var A=u.width/n-h,G,B=x-this._data.length*U/2;for(d.strokeStyle=c,d.lineWidth=h,g=0;g<this._data.length;g++){d.beginPath(),d.fillStyle=this._colors[g%this._colors.length],G=B+U;var O=this._data[g]/F*2*this._radius*E;d.rect(B,A-O,U,O),d.closePath(),d.fill(),d.stroke(),B=G}}}if(d.restore(),!this.setDisplacement){var K=this.getAnchor();K[0]=x-this._offset[0],K[1]=x-this._offset[1]}},ol.style.FillPattern=function(n){n||(n={});var c,h=this.canvas_=document.createElement("canvas"),u=Number(n.scale)>0?Number(n.scale):1,d=u*ol.has.DEVICE_PIXEL_RATIO||ol.has.DEVICE_PIXEL_RATIO,m=h.getContext("2d");if(n.image){n.image.load();var g,x=n.image.getImage();if(x.width)h.width=Math.round(x.width*d),h.height=Math.round(x.height*d),m.globalAlpha=typeof n.opacity=="number"?n.opacity:1,m.drawImage(x,0,0,x.width,x.height,0,0,h.width,h.height),c=m.createPattern(h,"repeat");else{var E=this;c=[0,0,0,0],x.onload=function(){h.width=Math.round(x.width*d),h.height=Math.round(x.height*d),m.globalAlpha=typeof n.opacity=="number"?n.opacity:1,m.drawImage(x,0,0,x.width,x.height,0,0,h.width,h.height),c=m.createPattern(h,"repeat"),E.setColor(c)}}}else{var P=this.getPattern_(n);if(h.width=Math.round(P.width*d),h.height=Math.round(P.height*d),m.beginPath(),n.fill&&(m.fillStyle=ol.color.asString(n.fill.getColor()),m.fillRect(0,0,h.width,h.height)),m.scale(d,d),m.lineCap="round",m.lineWidth=P.stroke||1,m.fillStyle=ol.color.asString(n.color||"#000"),m.strokeStyle=ol.color.asString(n.color||"#000"),P.circles)for(g=0;g<P.circles.length;g++){var L=P.circles[g];m.beginPath(),m.arc(L[0],L[1],L[2],0,2*Math.PI),P.fill&&m.fill(),P.stroke&&m.stroke()}if(P.repeat||(P.repeat=[[0,0]]),P.char&&(m.font=P.font||P.width+"px Arial",m.textAlign="center",m.textBaseline="middle",P.angle?(m.fillText(P.char,P.width/4,P.height/4),m.fillText(P.char,5*P.width/4,5*P.height/4),m.fillText(P.char,P.width/4,5*P.height/4),m.fillText(P.char,5*P.width/4,P.height/4),m.fillText(P.char,3*P.width/4,3*P.height/4),m.fillText(P.char,-P.width/4,-P.height/4),m.fillText(P.char,3*P.width/4,-P.height/4),m.fillText(P.char,-P.width/4,3*P.height/4)):m.fillText(P.char,P.width/2,P.height/2)),P.lines)for(g=0;g<P.lines.length;g++)for(var F=0;F<P.repeat.length;F++){var U=P.lines[g];m.beginPath(),m.moveTo(U[0]+P.repeat[F][0],U[1]+P.repeat[F][1]);for(var A=2;A<U.length;A+=2)m.lineTo(U[A]+P.repeat[F][0],U[A+1]+P.repeat[F][1]);P.fill&&m.fill(),P.stroke&&m.stroke(),m.save(),m.strokeStyle="red",m.strokeWidth=.1,m.restore()}if(c=m.createPattern(h,"repeat"),n.offset){var G=n.offset;if(typeof G=="number"&&(G=[G,G]),G instanceof Array){var B=Math.round(G[0]*d),O=Math.round(G[1]*d);m.scale(1/d,1/d),m.clearRect(0,0,h.width,h.height),m.translate(B,O),m.fillStyle=c,m.fillRect(-B,-O,h.width,h.height),c=m.createPattern(h,"repeat")}}}ol.style.Fill.call(this,{color:c})},ol.ext.inherits(ol.style.FillPattern,ol.style.Fill),ol.style.FillPattern.prototype.clone=function(){var n=ol.style.Fill.prototype.clone.call(this);return n.canvas_=this.canvas_,n},ol.style.FillPattern.prototype.getImage=function(){return this.canvas_},ol.style.FillPattern.prototype.getPattern_=function(n){var c=ol.style.FillPattern.prototype.patterns[n.pattern]||ol.style.FillPattern.prototype.patterns.dot,h=Math.round(n.spacing)||10,u;switch(n.pattern){case"dot":case"circle":{u=n.size===0?0:n.size/2||2,n.angle?(h=c.width=c.height=Math.round(h*1.4),c.circles=[[h/4,h/4,u],[3*h/4,3*h/4,u]],n.pattern=="circle"&&(c.circles=c.circles.concat([[h/4+h,h/4,u],[h/4,h/4+h,u],[3*h/4-h,3*h/4,u],[3*h/4,3*h/4-h,u],[h/4+h,h/4+h,u],[3*h/4-h,3*h/4-h,u]]))):(c.width=c.height=h,c.circles=[[h/2,h/2,u]],n.pattern=="circle"&&(c.circles=c.circles.concat([[h/2+h,h/2,u],[h/2-h,h/2,u],[h/2,h/2+h,u],[h/2,h/2-h,u],[h/2+h,h/2+h,u],[h/2+h,h/2-h,u],[h/2-h,h/2+h,u],[h/2-h,h/2-h,u]])));break}case"tile":case"square":{u=n.size===0?0:n.size/2||2,n.angle?(c.width=c.height=h,c.lines=[[h/2-u,h/2,h/2,h/2-u,h/2+u,h/2,h/2,h/2+u,h/2-u,h/2]]):(c.width=c.height=h,c.lines=[[h/2-u,h/2-u,h/2+u,h/2-u,h/2+u,h/2+u,h/2-u,h/2+u,h/2-u,h/2-u]]),n.pattern=="square"&&(c.repeat=[[0,0],[0,h],[h,0],[0,-h],[-h,0],[-h,-h],[h,h],[-h,h],[h,-h]]);break}case"cross":n.angle&&(n.angle=45);case"hatch":{var d=Math.round(((n.angle||0)-90)%360);d>180&&(d-=360),d*=Math.PI/180;var m=Math.cos(d),g=Math.sin(d);if(Math.abs(g)<1e-4)c.width=c.height=h,c.lines=[[0,.5,h,.5]],c.repeat=[[0,0],[0,h]];else if(Math.abs(m)<1e-4)c.width=c.height=h,c.lines=[[.5,0,.5,h]],c.repeat=[[0,0],[h,0]],n.pattern=="cross"&&(c.lines.push([0,.5,h,.5]),c.repeat.push([0,h]));else{var x=c.width=Math.round(Math.abs(h/g))||1,E=c.height=Math.round(Math.abs(h/m))||1;n.pattern=="cross"?(c.lines=[[-x,-E,2*x,2*E],[2*x,-E,-x,2*E]],c.repeat=[[0,0]]):m*g>0?(c.lines=[[-x,-E,2*x,2*E]],c.repeat=[[0,0],[x,0],[0,E]]):(c.lines=[[2*x,-E,-x,2*E]],c.repeat=[[0,0],[-x,0],[0,E]])}c.stroke=n.size===0?0:n.size||4;break}default:break}return c},ol.style.FillPattern.addPattern=function(n,c){c||(c={}),ol.style.FillPattern.prototype.patterns[n||c.char]={width:c.width||c.size||10,height:c.height||c.size||10,font:c.font,char:c.char,circles:c.circles,lines:c.lines,repeat:c.repeat,stroke:c.stroke,angle:c.angle,fill:c.fill}},ol.style.FillPattern.prototype.patterns={hatch:{width:5,height:5,lines:[[0,2.5,5,2.5]],stroke:1},cross:{width:7,height:7,lines:[[0,3,10,3],[3,0,3,10]],stroke:1},dot:{width:8,height:8,circles:[[5,5,2]],stroke:!1,fill:!0},circle:{width:10,height:10,circles:[[5,5,2]],stroke:1,fill:!1},square:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],stroke:1,fill:!1},tile:{width:10,height:10,lines:[[3,3,3,8,8,8,8,3,3,3]],fill:!0},woven:{width:12,height:12,lines:[[3,3,9,9],[0,12,3,9],[9,3,12,0],[-1,1,1,-1],[13,11,11,13]],stroke:1},crosses:{width:8,height:8,lines:[[2,2,6,6],[2,6,6,2]],stroke:1},caps:{width:8,height:8,lines:[[2,6,4,2,6,6]],stroke:1},nylon:{width:20,height:20,lines:[[1,6,1,1,6,1],[6,11,11,11,11,6],[11,16,11,21,16,21],[16,11,21,11,21,16]],repeat:[[0,0],[-20,0],[0,-20]],stroke:1},hexagon:{width:20,height:12,lines:[[0,10,4,4,10,4,14,10,10,16,4,16,0,10]],stroke:1,repeat:[[0,0],[10,6],[10,-6],[-10,-6]]},cemetry:{width:15,height:19,lines:[[0,3.5,7,3.5],[3.5,0,3.5,10]],stroke:1,repeat:[[0,0],[7,9]]},sand:{width:20,height:20,circles:[[1,2,1],[9,3,1],[2,16,1],[7,8,1],[6,14,1],[4,19,1],[14,2,1],[12,10,1],[14,18,1],[18,8,1],[18,14,1]],fill:1},conglomerate:{width:60,height:40,circles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],lines:[[7,5,6,7,9,9,11,8,11,6,9,5,7,5],[16,10,15,13,16,14,19,15,21,13,22,9,20,8,19,8,16,10],[24,6,26,7,27,5,26,4,24,4,24,6]],repeat:[[30,0],[-15,20],[15,20],[45,20]],stroke:1},conglomerate2:{width:60,height:40,circles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],lines:[[7,5,6,7,9,9,11,8,11,6,9,5,7,5],[16,10,15,13,16,14,19,15,21,13,22,9,20,8,19,8,16,10],[24,6,26,7,27,5,26,4,24,4,24,6]],repeat:[[30,0],[-15,20],[15,20],[45,20]],fill:1},gravel:{width:15,height:10,circles:[[4,2,1],[5,9,1],[1,7,1]],lines:[[7,5,6,6,7,7,8,7,9,7,10,5,9,4,7,5],[11,2,14,4,14,1,12,1,11,2]],stroke:1},brick:{width:18,height:16,lines:[[0,1,18,1],[0,10,18,10],[6,1,6,10],[12,10,12,18],[12,0,12,1]],stroke:1},dolomite:{width:20,height:16,lines:[[0,1,20,1],[0,9,20,9],[1,9,6,1],[11,9,14,16],[14,0,14.4,1]],stroke:1},coal:{width:20,height:16,lines:[[1,5,7,1,7,7],[11,10,12,5,18,9],[5,10,2,15,9,15],[15,16,15,13,20,16],[15,0,15,2,20,0]],fill:1},breccia:{width:20,height:16,lines:[[1,5,7,1,7,7,1,5],[11,10,12,5,18,9,11,10],[5,10,2,15,9,15,5,10],[15,16,15,13,22,18],[15,0,15,2,20,0]],stroke:1},clay:{width:20,height:20,lines:[[0,0,3,11,0,20],[11,0,10,3,13,13,11,20],[0,0,10,3,20,0],[0,12,3,11,13,13,20,12]],stroke:1},flooded:{width:15,height:10,lines:[[0,1,10,1],[0,6,5,6],[10,6,15,6]],stroke:1},chaos:{width:40,height:40,lines:[[40,2,40,0,38,0,40,2],[4,0,3,2,2,5,0,0,0,3,2,7,5,6,7,7,8,10,9,12,9,13,9,14,8,14,6,15,2,15,0,20,0,22,2,20,5,19,8,15,10,14,11,12.25,10,12,10,10,12,9,13,7,12,6,13,4,16,7,17,4,20,0,18,0,15,3,14,2,14,0,12,1,11,0,10,1,11,4,10,7,9,8,8,5,6,4,5,3,5,1,5,0,4,0],[7,1,7,3,8,3,8,2,7,1],[4,3,5,5,4,5,4,3],[34,5,33,7,38,10,38,8,36,5,34,5],[27,0,23,2,21,8,30,0,27,0],[25,8,26,12,26,16,22.71875,15.375,20,13,18,15,17,18,13,22,17,21,19,22,21,20,19,18,22,17,30,25,26,26,24,28,21.75,33.34375,20,36,18,40,20,40,24,37,25,32,27,31,26,38,27,37,30,32,32,35,36,37,38,40,38,39,40,40,37,36,34,32,37,31,36,29,33,27,34,24,39,21,40,21,40,16,37,20,31,22,32,25,27,20,29,15,30,20,32,20,34,18,33,12,31,11,29,14,26,9,25,8],[39,24,37,26,40,28,39,24],[13,15,9,19,14,18,13,15],[18,23,14,27,16,27,17,25,20,26,18,23],[6,24,2,26,1,28,2,30,5,28,12,30,16,32,18,30,15,30,12,28,9,25,7,27,6,24],[29,27,32,28,33,31,30,29,27,28,29,27],[5,35,1,33,3,36,13,38,15,35,10,36,5,35]],fill:1},grass:{width:27,height:22,lines:[[0,10.5,13,10.5],[2.5,10,1.5,7],[4.5,10,4.5,5,3.5,4],[7,10,7.5,6,8.5,3],[10,10,11,6]],repeat:[[0,0],[14,10]],stroke:1},swamp:{width:24,height:23,lines:[[0,10.5,9.5,10.5],[2.5,10,2.5,7],[4.5,10,4.5,4],[6.5,10,6.5,6],[3,12.5,7,12.5]],repeat:[[0,0],[14,10]],stroke:1},reed:{width:26,height:23,lines:[[2.5,10,2,7],[4.5,10,4.2,4],[6.5,10,6.8,4],[8.5,10,9,6],[3.7,4,3.7,2.5],[4.7,4,4.7,2.5],[6.3,4,6.3,2.5],[7.3,4,7.3,2.5]],circles:[[4.2,2.5,.5],[18.2,12.5,.5],[6.8,2.5,.5],[20.8,12.5,.5],[9,6,.5],[23,16,.5]],repeat:[[0,0],[14,10]],stroke:1},wave:{width:10,height:8,lines:[[0,0,5,4,10,0]],stroke:1},vine:{width:13,height:13,lines:[[3,0,3,6],[9,7,9,13]],stroke:1},forest:{width:55,height:30,circles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],stroke:1},forest2:{width:55,height:30,circles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],fill:1,stroke:1},scrub:{width:26,height:20,lines:[[1,4,4,8,6,4]],circles:[[20,13,1.5]],stroke:1},tree:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78]],repeat:[[3,1],[18,16]],stroke:1},tree2:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61]],repeat:[[3,1],[18,16]],fill:1,stroke:1},pine:{width:30,height:30,lines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49]],repeat:[[3,1],[18,16]],stroke:1},pine2:{width:30,height:30,lines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49,2.83,11.31,5.66,11.31]],repeat:[[3,1],[18,16]],fill:1,stroke:1},mixtree:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61],[23.66,27.31,20.83,27.31,20.83,24.49,18,24.49,20.83,16,23.66,24.49,20.83,24.49,20.83,27.31,23.66,27.31]],repeat:[[3,1]],stroke:1},mixtree2:{width:30,height:30,lines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,.71,6.36,0,4.24,.71,2.12,4.24,0,7.78,.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78,4.95,10.61,7.78,10.61],[23.66,27.31,20.83,27.31,20.83,24.49,18,24.49,20.83,16,23.66,24.49,20.83,24.49,20.83,27.31,23.66,27.31]],repeat:[[3,1]],fill:1,stroke:1},pines:{width:22,height:20,lines:[[1,4,3.5,1,6,4],[1,8,3.5,5,6,8],[3.5,1,3.5,11],[12,14.5,14.5,14,17,14.5],[12,18,17,18],[14.5,12,14.5,18]],repeat:[[2,1]],stroke:1},rock:{width:20,height:20,lines:[[1,0,1,9],[4,0,4,9],[7,0,7,9],[10,1,19,1],[10,4,19,4],[10,7,19,7],[0,11,9,11],[0,14,9,14],[0,17,9,17],[12,10,12,19],[15,10,15,19],[18,10,18,19]],repeat:[[.5,.5]],stroke:1},rocks:{width:20,height:20,lines:[[5,0,3,0,5,4,4,6,0,3,0,5,3,6,5,9,3.75,10,2.5,10,0,9,0,10,4,11,5,14,4,15,0,13,0,13,0,13,0,14,0,14,5,16,5,18,3,19,0,19,-.25,19.9375,5,20,10,19,10,20,11,20,12,19,14,20,15,20,17,19,20,20,20,19,19,16,20,15,20,11,20,10,19,8,20,5,20,0,19,0,20,2,19,4,17,4,16,3,15,0,14,0,15,4,11,5,10,4,11,0,10,0,9,4,6,5,5,0],[18,5,19,6,18,10,16,10,14,9,16,5,18,5],[5,6,9,5,10,6,10,9,6,10,5,6],[14,5,14,8,13,9,12,9,11,7,12,5,14,5],[5,11,8,10,9,11,10,14,6,15,6,15,5,11],[13,10,14,11,15,14,15,14,15,14,11,15,10,11,11,10,13,10],[15,12,16,11,19,11,19,15,16,14,16,14,15,12],[6,16,9,15,10,18,5,19,6,16],[10,16,14,16,14,18,13,19,11,18,10,16],[15,15,18,16,18,18,16,19,15,18,15,15]],stroke:1}},ol.style.FlowLine=function(n){n||(n={}),ol.style.Style.call(this,{renderer:this._render.bind(this),stroke:n.stroke,text:n.text,zIndex:n.zIndex,geometry:n.geometry}),this._visible=n.visible!==!1,typeof n.width=="function"?this._widthFn=n.width:this.setWidth(n.width),this.setWidth2(n.width2),typeof n.color=="function"?this._colorFn=n.color:this.setColor(n.color),this.setColor2(n.color2),this.setLineCap(n.lineCap),this.setArrow(n.arrow),this.setArrowSize(n.arrowSize),this.setArrowColor(n.arrowColor),this._offset=[0,0],this.setOffset(n.offset0,0),this.setOffset(n.offset1,1),this._noOverlap=n.noOverlap},ol.ext.inherits(ol.style.FlowLine,ol.style.Style),ol.style.FlowLine.prototype.setWidth=function(n){this._width=n||0},ol.style.FlowLine.prototype.setWidth2=function(n){this._width2=n},ol.style.FlowLine.prototype.getOffset=function(n){return this._offset[n]},ol.style.FlowLine.prototype.setOffset=function(n,c){switch(n=Math.max(0,parseFloat(n)),c){case 0:{this._offset[0]=n;break}case 1:{this._offset[1]=n;break}}},ol.style.FlowLine.prototype.setLineCap=function(n){this._lineCap=n==="round"?"round":"butt"},ol.style.FlowLine.prototype.getWidth=function(n,c){if(this._widthFn)return this._widthFn(n,c);var h=typeof this._width2=="number"?this._width2:this._width;return this._width+(h-this._width)*c},ol.style.FlowLine.prototype.setColor=function(n){try{this._color=ol.color.asArray(n)}catch{this._color=[0,0,0,1]}},ol.style.FlowLine.prototype.setColor2=function(n){try{this._color2=ol.color.asArray(n)}catch{this._color2=null}},ol.style.FlowLine.prototype.setArrowColor=function(n){try{this._acolor=ol.color.asString(n)}catch{this._acolor=null}},ol.style.FlowLine.prototype.getColor=function(n,c){if(this._colorFn)return ol.color.asString(this._colorFn(n,c));var h=this._color,u=this._color2||this._color;return"rgba("+ +Math.round(h[0]+(u[0]-h[0])*c)+","+Math.round(h[1]+(u[1]-h[1])*c)+","+Math.round(h[2]+(u[2]-h[2])*c)+","+(h[3]+(u[3]-h[3])*c)+")"},ol.style.FlowLine.prototype.getArrow=function(){return this._arrow},ol.style.FlowLine.prototype.setArrow=function(n){this._arrow=parseInt(n),(this._arrow<-1||this._arrow>2)&&(this._arrow=0)},ol.style.FlowLine.prototype.getArrowSize=function(){return this._arrowSize||[16,16]},ol.style.FlowLine.prototype.setArrowSize=function(n){Array.isArray(n)?this._arrowSize=n:typeof n=="number"&&(this._arrowSize=[n,n])},ol.style.FlowLine.prototype.drawArrow=function(n,c,h,u,d){var m=this.getArrowSize()[0]*d,g=ol.coordinate.dist2d(c,h),x=(c[0]-h[0])/g,E=(c[1]-h[1])/g;u=Math.max(this.getArrowSize()[1]/2,u/2)*d,n.beginPath(),n.moveTo(c[0],c[1]),n.lineTo(c[0]-m*x+u*E,c[1]-m*E-u*x),n.lineTo(c[0]-m*x-u*E,c[1]-m*E+u*x),n.lineTo(c[0],c[1]),n.fill()},ol.style.FlowLine.prototype._render=function(n,c){if(c.geometry.getType()==="LineString"){var h,u,d,m=c.context;if(!this._visible){var g=c.pixelRatio/c.resolution,x=Math.cos(c.rotation),E=Math.sin(c.rotation);u=c.geometry.getCoordinates();var P=n[0][0]-u[0][0]*g*x-u[0][1]*g*E,L=n[0][1]-u[0][0]*g*E+u[0][1]*g*x;for(n=[],h=0;d=u[h];h++)n[h]=[P+d[0]*g*x+d[1]*g*E,L+d[0]*g*E-d[1]*g*x,d[2]]}var F=this.getArrowSize()[0]*c.pixelRatio;m.save(),this.getOffset(0)&&this._splitAsize(n,this.getOffset(0)*c.pixelRatio),this.getOffset(1)&&this._splitAsize(n,this.getOffset(1)*c.pixelRatio,!0),n.length>1&&(this.getArrow()===-1||this.getArrow()===2)&&(d=this._splitAsize(n,F),this._acolor?m.fillStyle=this._acolor:m.fillStyle=this.getColor(c.feature,0),this.drawArrow(m,d[0],d[1],this.getWidth(c.feature,0),c.pixelRatio)),n.length>1&&this.getArrow()>0&&(d=this._splitAsize(n,F,!0),this._acolor?m.fillStyle=this._acolor:m.fillStyle=this.getColor(c.feature,1),this.drawArrow(m,d[0],d[1],this.getWidth(c.feature,1),c.pixelRatio));var U=this._splitInto(n,255,2),A=0,G=U.length;if(m.lineJoin="round",m.lineCap=this._lineCap||"butt",U.length>1)for(A=0;A<U.length;A++){var B=A/G;for(u=U[A],m.lineWidth=this.getWidth(c.feature,B)*c.pixelRatio,m.strokeStyle=this.getColor(c.feature,B),m.beginPath(),m.moveTo(u[0][0],u[0][1]),h=1;d=u[h];h++)m.lineTo(d[0],d[1]);m.stroke()}m.restore()}},ol.style.FlowLine.prototype._splitAsize=function(n,c,h){var u,d,m,g,x=0;for(h?m=n.pop():m=n.shift(),u=m;n.length;){if(h?d=n.pop():d=n.shift(),g=ol.coordinate.dist2d(u,d),x+g>c){u=[u[0]+(d[0]-u[0])*(c-x)/g,u[1]+(d[1]-u[1])*(c-x)/g],g=ol.coordinate.dist2d(u,m),h?(n.push(d),n.push(u),n.push([u[0]+(m[0]-u[0])/g,u[1]+(m[1]-u[1])/g])):(n.unshift(d),n.unshift(u),n.unshift([u[0]+(m[0]-u[0])/g,u[1]+(m[1]-u[1])/g]));break}x+=g,u=d}return[m,u]},ol.style.FlowLine.prototype._splitInto=function(n,c,h){var u,d,m=this._noOverlap?1:.9,g=[],x,E=0;for(u=1;d=n[u];u++)E+=ol.coordinate.dist2d(n[u-1],d);var P=Math.max(h||2,E/(c||255)),L=n[0];E=0;var F=[L];for(u=1,d=n[1];u<n.length;){var U=d[0]-L[0],A=d[1]-L[1];if(x=Math.sqrt(U*U+A*A),E+x>P){var G=(P-E)/x;F.push([L[0]+U*G,L[1]+A*G]),g.push(F),L=[L[0]+U*G*m,L[1]+A*G*m],F=[L],E=0}else E+=x,L=d,F.push(L),u++,d=n[u]}return g.push(F),g},ol.style.FontSymbol=function(n){n=n||{};var c=0;n.stroke&&(c=n.stroke.getWidth()),n.displacement||(n.displacement=[n.offsetX||0,-n.offsetY||0]),typeof n.opacity=="number"&&this.setOpacity(n.opacity),this._color=n.color,this._fontSize=n.fontSize||1,this._fontStyle=n.fontStyle||"",this._stroke=n.stroke,this._fill=n.fill,this._radius=n.radius-c,this._form=n.form||"none",this._gradient=n.gradient,this._offset=[n.offsetX?n.offsetX:0,n.offsetY?n.offsetY:0],n.glyph?this._glyph=this.getGlyph(n.glyph):this._glyph=this.getTextGlyph(n.text||"",n.font),ol.style.RegularShape.call(this,{radius:n.radius,fill:n.fill,rotation:n.rotation,displacement:n.displacement,rotateWithView:n.rotateWithView}),this.getDisplacement||this.getImage()},ol.ext.inherits(ol.style.FontSymbol,ol.style.RegularShape),ol.style.Image.prototype.getImagePNG=function(n){n=n||window.devicePixelRatio;var c=this.getImage(n);if(c)try{return c.toDataURL("image/png")}catch{return!1}else return!1},ol.style.FontSymbol.prototype.defs={fonts:{},glyphs:{}},ol.style.FontSymbol.addDefs=function(n,c){var h=n;if(typeof n=="string"&&(h={font:n,name:n,copyright:""}),!h.font||typeof h.font!="string"){console.log("bad font def");return}var u=h.font;ol.style.FontSymbol.prototype.defs.fonts[u]=h;for(var d in c){var m=c[d];typeof m=="string"&&m.length==1&&(m={char:m}),ol.style.FontSymbol.prototype.defs.glyphs[d]={font:h.font,char:m.char||""+String.fromCharCode(m.code)||"",theme:m.theme||h.name,name:m.name||d,search:m.search||""}}},ol.style.FontSymbol.prototype.clone=function(){var n=new ol.style.FontSymbol({glyph:"",color:this._color,fontSize:this._fontSize,fontStyle:this._fontStyle,stroke:this._stroke,fill:this._fill,radius:this._radius+(this._stroke?this._stroke.getWidth():0),form:this._form,gradient:this._gradient,offsetX:this._offset[0],offsetY:this._offset[1],opacity:this.getOpacity(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()});return n.setScale(this.getScale()),n.glyph_=this._glyph,n.getImage(),n},ol.style.FontSymbol.prototype.getFill=function(){return this._fill},ol.style.FontSymbol.prototype.getStroke=function(){return this._stroke},ol.style.FontSymbol.prototype.getGlyph=function(n){return n?ol.style.FontSymbol.prototype.defs.glyphs[n]||{font:"sans-serif",char:n.charAt(0),theme:"none",name:"none",search:""}:this._glyph},ol.style.FontSymbol.prototype.getTextGlyph=function(n,c){return{font:c||"sans-serif",char:String(n),theme:"none",name:"none",search:""}},ol.style.FontSymbol.prototype.getGlyphName=function(){for(var n in ol.style.FontSymbol.prototype.defs.glyphs)if(ol.style.FontSymbol.prototype.defs.glyphs[n]===this._glyph)return n;return""},ol.style.FontSymbol.prototype.getFontInfo=function(n){return ol.style.FontSymbol.prototype.defs.fonts[n.font]},ol.style.FontSymbol.prototype.getImage=function(n){n=n||1;var c=ol.style.RegularShape.prototype.getImage.call(this,n),h,u=0;this._stroke&&(h=ol.color.asString(this._stroke.getColor()),u=this._stroke.getWidth());var d={strokeStyle:h,strokeWidth:u,size:c.width/n},m=c.getContext("2d");if(m.clearRect(0,0,c.width,c.height),this.drawMarker_(d,m,0,0,n),!this.getDisplacement){var g=this.getAnchor();g[0]=c.width/2-this._offset[0],g[1]=c.width/2-this._offset[1]}return c},ol.style.FontSymbol.prototype.drawPath_=function(n,c){var h=2*this._radius+n.strokeWidth,u=n.strokeWidth/2,d=n.size/2,m={fac:1,posX:n.size/2,posY:n.size/2};switch(c.lineJoin="round",c.lineCap="round",c.beginPath(),this._form){case"none":{m.fac=1;break}case"circle":case"ban":{c.arc(d,d,h/2,0,2*Math.PI,!0);break}case"poi":{c.arc(d,d-.4*this._radius,.6*this._radius,.15*Math.PI,.85*Math.PI,!0),c.lineTo(d-.89*.05*h,(.95+.45*.05)*h+u),c.arc(d,.95*h+u,.05*h,.85*Math.PI,.15*Math.PI,!0),m={fac:.45,posX:d,posY:d-.35*this._radius};break}case"bubble":{c.arc(d,d-.2*this._radius,.8*this._radius,.4*Math.PI,.6*Math.PI,!0),c.lineTo(.5*h+u,h+u),m={fac:.7,posX:d,posY:d-.2*this._radius};break}case"marker":{c.arc(d,d-.2*this._radius,.8*this._radius,.25*Math.PI,.75*Math.PI,!0),c.lineTo(.5*h+u,h+u),m={fac:.7,posX:d,posY:d-.2*this._radius};break}case"coma":{c.moveTo(d+.8*this._radius,d-.2*this._radius),c.quadraticCurveTo(.95*h+u,.75*h+u,.5*h+u,h+u),c.arc(d,d-.2*this._radius,.8*this._radius,.45*Math.PI,0,!1),m={fac:.7,posX:d,posY:d-.2*this._radius};break}default:{var g;switch(this._form){case"shield":{g=[.05,0,.95,0,.95,.8,.5,1,.05,.8,.05,0],m.posY=.45*h+u;break}case"blazon":{g=[.1,0,.9,0,.9,.8,.6,.8,.5,1,.4,.8,.1,.8,.1,0],m.fac=.8,m.posY=.4*h+u;break}case"bookmark":{g=[.05,0,.95,0,.95,1,.5,.8,.05,1,.05,0],m.fac=.9,m.posY=.4*h+u;break}case"hexagon":{g=[.05,.2,.5,0,.95,.2,.95,.8,.5,1,.05,.8,.05,.2],m.fac=.9,m.posY=.5*h+u;break}case"diamond":{g=[.25,0,.75,0,1,.2,1,.4,.5,1,0,.4,0,.2,.25,0],m.fac=.75,m.posY=.35*h+u;break}case"triangle":{g=[0,0,1,0,.5,1,0,0],m.fac=.6,m.posY=.3*h+u;break}case"sign":{g=[.5,.05,1,.95,0,.95,.5,.05],m.fac=.7,m.posY=.65*h+u;break}case"lozenge":{g=[.5,0,1,.5,.5,1,0,.5,.5,0],m.fac=.7;break}case"square":default:{g=[0,0,1,0,1,1,0,1,0,0];break}}for(var x=0;x<g.length;x+=2)c.lineTo(g[x]*h+u,g[x+1]*h+u)}}return c.closePath(),m},ol.style.FontSymbol.prototype.drawMarker_=function(n,c,h,u,d){var m=this._fill?this._fill.getColor():"#000",g=this._stroke?this._stroke.getColor():"#000";this._form=="none"&&this._stroke&&this._fill&&(g=this._fill.getColor(),m=this._stroke.getColor()),c.setTransform(d,0,0,d,0,0),c.translate(h,u);var x=this.drawPath_(n,c,d);if(this._fill){if(this._gradient&&this._form!="none"){var E=c.createLinearGradient(0,0,n.size/2,n.size);E.addColorStop(1,ol.color.asString(m)),E.addColorStop(0,ol.color.asString(g)),c.fillStyle=E}else c.fillStyle=ol.color.asString(m);c.fill()}if(this._stroke&&n.strokeWidth&&(c.strokeStyle=n.strokeStyle,c.lineWidth=n.strokeWidth,c.stroke()),this._glyph.char){c.font=this._fontStyle+" "+2*x.fac*this._radius*this._fontSize+"px "+this._glyph.font,c.strokeStyle=c.fillStyle,c.lineWidth=n.strokeWidth*(this._form=="none"?2:1),c.fillStyle=ol.color.asString(this._color||g),c.textAlign="center",c.textBaseline="middle";var P=this._glyph.char;n.strokeWidth&&g!="transparent"&&c.strokeText(P,x.posX,x.posY),c.fillText(P,x.posX,x.posY)}if(this._form=="ban"&&this._stroke&&n.strokeWidth){c.strokeStyle=n.strokeStyle,c.lineWidth=n.strokeWidth;var L=this._radius+n.strokeWidth,F=this._radius*Math.cos(Math.PI/4);c.moveTo(L+F,L-F),c.lineTo(L-F,L+F),c.stroke()}},ol.style.FontSymbol.prototype.getChecksum=function(){var n=this._stroke!==null?this._stroke.getChecksum():"-",c=this._fill!==null?this._fill.getChecksum():"-",h=this.checksums_===null||n!=this.checksums_[1]||c!=this.checksums_[2]||this._radius!=this.checksums_[3]||this._form+"-"+this.glyphs_!=this.checksums_[4];if(h){var u="c"+n+c+(this._radius!==void 0?this._radius.toString():"-")+this._form+"-"+this.glyphs_;this.checksums_=[u,n,c,this._radius,this._form+"-"+this.glyphs_]}return this.checksums_[0]},ol.style.Photo=function(n){n=n||{},n.displacement||(n.displacement=[n.offsetX||0,-n.offsetY||0]),this.sanchor_=n.kind==="anchored"?8:0,this._shadow=Number(n.shadow)||0,n.stroke||(n.stroke=new ol.style.Stroke({width:0,color:"#000"}));var c=n.stroke.getWidth();if(c<0&&(c=0),n.kind=="folio"&&(c+=6),n.stroke.setWidth(c),ol.style.RegularShape.call(this,{radius:n.radius+c+this.sanchor_/2+this._shadow/2,points:0,displacement:[n.displacement[0]||0,(n.displacement[1]||0)+this.sanchor_],fill:ol.style.RegularShape.prototype.render?new ol.style.Fill({color:[0,0,0,0]}):null}),!this.getHitDetectionImage){var h=ol.style.RegularShape.prototype.getImage.call(this);if(!this.hitDetectionCanvas_){for(var u in this)if(this[u]&&this[u].getContext&&this[u]!==h){this.hitDetectionCanvas_=this[u];break}}this.hitDetectionCanvas_=document.createElement("canvas"),this.hitDetectionCanvas_.width=h.width,this.hitDetectionCanvas_.height=h.height;var d=this.hitDetectionCanvas_;this.getHitDetectionImage=function(){return d},setTimeout(function(){this.getImage()}.bind(this))}this._stroke=n.stroke,this._fill=n.fill,this._crop=n.crop,this._crossOrigin=n.crossOrigin,this._kind=n.kind||"default",this._radius=n.radius,this._src=n.src,this._offset=[n.offsetX?n.offsetX:0,n.offsetY?n.offsetY:0],this._onload=n.onload,typeof n.opacity=="number"&&this.setOpacity(n.opacity),typeof n.rotation=="number"&&this.setRotation(n.rotation)},ol.ext.inherits(ol.style.Photo,ol.style.RegularShape),ol.style.Photo.prototype.setOffset=function(n){this._offset=[n[0]||0,n[1]||0],this.getImage()},ol.style.Photo.prototype.clone=function(){var n=new ol.style.Photo({stroke:this._stroke,fill:this._fill,shadow:this._shadow,crop:this._crop,crossOrigin:this._crossOrigin,kind:this._kind,radius:this._radius,src:this._src,offsetX:this._offset[0],offsetY:this._offset[1],opacity:this.getOpacity(),rotation:this.getRotation()});return n.getImage(),n},CanvasRenderingContext2D.prototype.roundRect=function(n,c,h,u,d){return d?(h<2*d&&(d=h/2),u<2*d&&(d=u/2),this.beginPath(),this.moveTo(n+d,c),this.arcTo(n+h,c,n+h,c+u,d),this.arcTo(n+h,c+u,n,c+u,d),this.arcTo(n,c+u,n,c,d),this.arcTo(n,c,n+h,c,d),this.closePath()):this.rect(n,c,h,u),this},ol.style.Photo.prototype.drawBack_=function(n,c,h,u){var d=this._shadow,m=n.canvas;n.beginPath(),n.fillStyle=c,n.clearRect(0,0,m.width,m.height);var g=m.width/u,x=m.height/u;switch(this._kind){case"square":{n.rect(0,0,g-d,x-d);break}case"circle":{n.arc(this._radius+h,this._radius+h,this._radius+h,0,2*Math.PI,!1);break}case"folio":{var E=6;h-=E,n.strokeStyle="rgba(0,0,0,0.5)",n.lineWidth=1;var P=g-d-2*E,L=Math.atan(6/P);n.save(),n.rotate(-L),n.translate(-6,2),n.beginPath(),n.rect(E,E,P,P),n.stroke(),n.fill(),n.restore(),n.save(),n.translate(6,-1),n.rotate(L),n.beginPath(),n.rect(E,E,P,P),n.stroke(),n.fill(),n.restore(),n.beginPath(),n.rect(E,E,P,P),n.stroke();break}case"anchored":{n.roundRect(this.sanchor_/2,0,g-this.sanchor_-d,x-this.sanchor_-d,h),n.moveTo(g/2-this.sanchor_-d/2,x-this.sanchor_-d),n.lineTo(g/2+this.sanchor_-d/2,x-this.sanchor_-d),n.lineTo(g/2-d/2,x-d);break}default:{n.roundRect(0,0,g-d,x-d,h);break}}n.closePath()},ol.style.Photo.prototype.getImage=function(n){n=n||1;var c=ol.style.RegularShape.prototype.getImage.call(this,n);if(this._gethit)return c;var h,u=0;this._stroke&&(h=ol.color.asString(this._stroke.getColor()),u=this._stroke.getWidth()),this._gethit=!0;var d=this.getHitDetectionImage().getContext("2d");d.save(),d.setTransform(1,0,0,1,0,0),this.drawBack_(d,"#000",u,1),d.fill(),d.restore(),this._gethit=!1,d=c.getContext("2d"),d.save(),d.setTransform(n,0,0,n,0,0),this.drawBack_(d,h,u,n),this._shadow&&(d.shadowColor="rgba(0,0,0,0.5)",d.shadowBlur=n*this._shadow/2,d.shadowOffsetX=n*this._shadow/2,d.shadowOffsetY=n*this._shadow/2),d.fill(),d.restore();var m=this,g=this.img_=new Image;if(this._crossOrigin&&(g.crossOrigin=this._crossOrigin),g.src=this._src,g.width?m.drawImage_(c,g,n):g.onload=function(){m.drawImage_(c,g,n),m._onload&&m._onload()},!this.getDisplacement){var x=this.getAnchor();x[0]=(c.width/n-this._shadow)/2-this._offset[0],this.sanchor_?x[1]=c.height/n-this._shadow-this._offset[1]:x[1]=(c.height/n-this._shadow)/2-this._offset[1]}return c},ol.style.Photo.prototype.drawImage_=function(n,c,h){var u=n.getContext("2d"),d=0;this._stroke&&(d=this._stroke.getWidth());var m=2*this._radius;u.save(),ol.style.RegularShape.prototype.render&&u.setTransform(h,0,0,h,0,0),this._kind=="circle"&&(u.beginPath(),u.arc(this._radius+d,this._radius+d,this._radius,0,2*Math.PI,!1),u.clip());var g,x,E,P,L,F,U,A,G;this._crop?(g=Math.min(c.width/m,c.height/m),A=G=g*m,F=(c.width-A)/2,U=(c.height-G)/2,x=E=0,P=L=m+1):(g=Math.min(m/c.width,m/c.height),F=U=0,A=c.width,G=c.height,P=g*A,L=g*G,x=(m-P)/2,E=(m-L)/2),x+=d+this.sanchor_/2,E+=d,u.drawImage(c,F,U,A,G,x,E,P,L),this._kind=="circle"&&d&&(u.beginPath(),u.strokeStyle=ol.color.asString(this._stroke.getColor()),u.lineWidth=d/4,u.arc(this._radius+d,this._radius+d,this._radius,0,2*Math.PI,!1),u.stroke()),u.restore()},ol.style.Profile=function(n){n||(n={}),ol.style.Style.call(this,{renderer:this._render.bind(this),zIndex:n.zIndex,geometry:n.geometry}),this.setStroke(n.stroke),this.setFill(n.fill),this.setScale(n.scale)},ol.ext.inherits(ol.style.Profile,ol.style.Style),ol.style.Profile.prototype.setStroke=function(n){this._stroke=n||new ol.style.Stroke({color:"#fff",width:1})},ol.style.Profile.prototype.getStroke=function(){return this._stroke},ol.style.Profile.prototype.setFill=function(n){this._fill=n||new ol.style.Fill({color:"rgba(255,255,255,.3"})},ol.style.Profile.prototype.getFill=function(){return this._fill},ol.style.Profile.prototype.setScale=function(n){this._scale=n||.2},ol.style.Profile.prototype.getScale=function(){return this._scale},ol.style.Profile.prototype._render=function(n,c){if(/Z/.test(c.feature.getGeometry().getLayout())){var h=c.geometry.getCoordinates();switch(c.geometry.getType()){case"LineString":{this._renderLine(n,h,c.feature.getGeometry(),c);break}case"MultiLineString":{c.feature.getGeometry().getLineStrings().forEach(function(u,d){this._renderLine(n[d],h[d],u,c)}.bind(this));break}case"Point":break}}},ol.style.Profile.prototype._renderLine=function(n,c,h,u){var d,m,g=u.context,x=Math.cos(u.rotation),E=Math.sin(u.rotation),P=ol.coordinate.dist2d(n[0],n[1])/ol.coordinate.dist2d(c[0],c[1]),L=n[0][0]-c[0][0]*P*x-c[0][1]*P*E,F=n[0][1]-c[0][0]*P*E+c[0][1]*P*x;n=h.getCoordinates();var U=1/0;for(d=0;m=n[d];d++){var A=L+m[0]*P*x+m[1]*P*E,G=F+m[0]*P*E-m[1]*P*x;U=Math.min(U,m[2]),n[d]=[A,G,m[2]]}g.save(),g.fillStyle=ol.color.asString(this.getFill().getColor()),g.strokeStyle=ol.color.asString(this.getStroke().getColor()),g.lineWidth=this.getStroke().getWidth();var B=n[0],O=this.getScale()*u.pixelRatio;for(d=1;m=n[d];d++)g.beginPath(),g.moveTo(B[0],B[1]),g.lineTo(m[0],m[1]),g.lineTo(m[0],m[1]-(m[2]-U)*O),g.lineTo(B[0],B[1]-(B[2]-U)*O),g.lineTo(B[0],B[1]),g.fill(),B=m;for(B=n[0],g.beginPath(),g.moveTo(B[0],B[1]-(B[2]-U)*O),d=1;m=n[d];d++)g.lineTo(m[0],m[1]-(m[2]-U)*O);g.stroke(),g.restore()},function(){function n(c){if(c.frameState.viewState.resolution>this.textPathMaxResolution_)return;var h=c.frameState.extent,u=c.frameState.coordinateToPixelTransform,d;function m(K,Q){var et=[];for(d=0;d<K.length;d++)et.push(u[0]*K[d][0]+u[1]*K[d][1]+u[4]),et.push(u[2]*K[d][0]+u[3]*K[d][1]+u[5]);if(Q&&et[0]>et[et.length-2]){var lt=[];for(d=et.length-2;d>=0;d-=2)lt.push(et[d]),lt.push(et[d+1]);return lt}else return et}var g=c.context;g.save(),g.scale(c.frameState.pixelRatio,c.frameState.pixelRatio);for(var x=this.getSource().getFeaturesInExtent(h),E=0,P;P=x[E];E++)for(var L=this.textPathStyle_(P,c.frameState.viewState.resolution),F,U=0;F=L[U];U++){var A=F.getGeometry()||P.getGeometry(),G;switch(A.getType()){case"LineString":G=A.getCoordinates();break;case"MultiLineString":G=A.getLineString(0).getCoordinates();break;default:continue}var B=F.getText(),O=m(G,B.getRotateWithView());g.font=B.getFont(),g.textBaseline=B.getTextBaseline(),g.textAlign=B.getTextAlign(),g.lineWidth=B.getStroke()&&B.getStroke().getWidth()||0,g.strokeStyle=B.getStroke()&&B.getStroke().getColor()||"#fff",g.fillStyle=B.getFill()&&B.getFill().getColor()||"#000",g.textJustify=B.getTextAlign()=="justify",g.textOverflow=B.getTextOverflow?B.getTextOverflow():"",g.minWidth=B.getMinWidth?B.getMinWidth():0,g.textPath(B.getText()||P.get("name"),O)}g.restore()}ol.layer.Vector.prototype.setTextPathStyle=function(c,h){if(c===null){this.textPath_&&this.unByKey(this.textPath_),this.textPath_=null,this.changed();return}this.textPath_||(this.textPath_=this.on(["postcompose","postrender"],n.bind(this))),c===void 0&&(c=[new ol.style.Style({text:new ol.style.Text})]),typeof c=="function"?this.textPathStyle_=c:this.textPathStyle_=function(){return c},this.textPathMaxResolution_=Number(h)||Number.MAX_VALUE,this.changed()},ol.style.TextPath=function(c){c||(c={}),ol.style.Text.call(this,c),this.textOverflow_=typeof c.textOverflow<"u"?c.textOverflow:"visible",this.minWidth_=c.minWidth||0},ol.ext.inherits(ol.style.TextPath,ol.style.Text),ol.style.TextPath.prototype.getTextOverflow=function(){return this.textOverflow_},ol.style.TextPath.prototype.getMinWidth=function(){return this.minWidth_}}(),CanvasRenderingContext2D.prototype.textPath=function(n,c){var h=this;function u(Q,et,lt,pt){var T=lt-Q,ct=pt-et;return Math.sqrt(T*T+ct*ct)}var d,m=0,g=2;function x(Q,et){if(!d||m+d<et)for(;g<Q.length&&(d=u(Q[g-2],Q[g-1],Q[g],Q[g+1]),!(m+d>et||(g+=2,g>=Q.length)));)m+=d;var lt,pt,T,ct=et-m;return g>=Q.length&&(g=Q.length-2),ct?(lt=Q[g-2]+(Q[g]-Q[g-2])*ct/d,pt=Q[g-1]+(Q[g+1]-Q[g-1])*ct/d,T=Math.atan2(Q[g+1]-Q[g-1],Q[g]-Q[g-2])):(lt=Q[g-2],pt=Q[g-1],T=Math.atan2(Q[g+1]-Q[g-1],Q[g]-Q[g-2])),[lt,pt,T]}for(var E=h.measureText(" ").width*.25,P=0,L=0,F=2;F<c.length;F+=2)L+=u(c[F-2],c[F-1],c[F],c[F+1]);if(!(L<h.minWidth)){var U=n.split(" ").length-1;if(h.textOverflow!="visible"&&L<h.measureText(n).width+(n.length-1+U)*E){var A=h.textOverflow=="ellipsis"?"\u2026":h.textOverflow;do U=n.split(" ").length-1,n=n.slice(0,n.length-1);while(n&&L<h.measureText(n+A).width+(n.length+A.length-1+U)*E);n+=A}switch(h.textJustify||h.textAlign){case!0:case"center":case"end":case"right":{h.textJustify?(P=0,E=(L-h.measureText(n).width)/(n.length-1+U)):(P=L-h.measureText(n).width-(n.length+U)*E,h.textAlign=="center"&&(P/=2));break}default:break}for(var G=0;G<n.length;G++){var B=n[G],O=h.measureText(B).width,K=x(c,P+O/2);h.save(),h.textAlign="center",h.translate(K[0],K[1]),h.rotate(K[2]),h.lineWidth&&h.strokeText(B,0,0),h.fillText(B,0,0),h.restore(),P+=O+E*(B==" "?2:1)}}},ol.style.Shadow=function(n){n=n||{},this._fill=n.fill||new ol.style.Fill({color:"rgba(0,0,0,0.5)"}),this._radius=n.radius,this._blur=n.blur===0?0:n.blur||n.radius/3,this._offset=[n.offsetX?n.offsetX:0,n.offsetY?n.offsetY:0],n.displacement||(n.displacement=[n.offsetX||0,-n.offsetY||0]),ol.style.RegularShape.call(this,{radius:n.radius,fill:n.fill,displacement:n.displacement}),this.setDisplacement||this.getImage()},ol.ext.inherits(ol.style.Shadow,ol.style.RegularShape),ol.style.Shadow.prototype.clone=function(){var n=new ol.style.Shadow({fill:this._fill,radius:this._radius,blur:this._blur,offsetX:this._offset[0],offsetY:this._offset[1]});return n.setScale(this.getScale()),n.setOpacity(this.getOpacity()),n},ol.style.Shadow.prototype.getImage=function(n){n=n||1;var c=this._radius,h=ol.style.RegularShape.prototype.getImage.call(this,n),u=h.getContext("2d");if(u.save(),u.resetTransform(),u.clearRect(0,0,h.width,h.height),u.beginPath(),u.setTransform(n,0,0,n,0,0),u.scale(1,.5),u.arc(c,-c,c-this._blur,0,2*Math.PI,!1),u.fillStyle="#000",u.shadowColor=this._fill.getColor(),u.shadowBlur=.7*this._blur*n,u.shadowOffsetX=0,u.shadowOffsetY=1.5*c*n,u.closePath(),u.fill(),u.shadowColor="transparent",u.restore(),!this.getDisplacement){var d=this.getAnchor();d[0]=h.width/2-this._offset[0],d[1]=h.height/2-this._offset[1]}return h},ol.style.StrokePattern=function(n){n||(n={});var c,h,u=this.canvas_=document.createElement("canvas"),d=Number(n.scale)>0?Number(n.scale):1,m=d*ol.has.DEVICE_PIXEL_RATIO||ol.has.DEVICE_PIXEL_RATIO,g=u.getContext("2d");if(n.image){n.image.load();var x=n.image.getImage();if(x.width)u.width=Math.round(x.width*m),u.height=Math.round(x.height*m),g.globalAlpha=typeof n.opacity=="number"?n.opacity:1,g.drawImage(x,0,0,x.width,x.height,0,0,u.width,u.height),c=g.createPattern(u,"repeat");else{var E=this;c=[0,0,0,0],x.onload=function(){u.width=Math.round(x.width*m),u.height=Math.round(x.height*m),g.globalAlpha=typeof n.opacity=="number"?n.opacity:1,g.drawImage(x,0,0,x.width,x.height,0,0,u.width,u.height),c=g.createPattern(u,"repeat"),E.setColor(c)}}}else{var P=this.getPattern_(n);if(u.width=Math.round(P.width*m),u.height=Math.round(P.height*m),g.beginPath(),n.fill&&(g.fillStyle=ol.color.asString(n.fill.getColor()),g.fillRect(0,0,u.width,u.height)),g.scale(m,m),g.lineCap="round",g.lineWidth=P.stroke||1,g.fillStyle=ol.color.asString(n.color||"#000"),g.strokeStyle=ol.color.asString(n.color||"#000"),P.circles)for(h=0;h<P.circles.length;h++){var L=P.circles[h];g.beginPath(),g.arc(L[0],L[1],L[2],0,2*Math.PI),P.fill&&g.fill(),P.stroke&&g.stroke()}if(P.repeat||(P.repeat=[[0,0]]),P.char&&(g.font=P.font||P.width+"px Arial",g.textAlign="center",g.textBaseline="middle",P.angle?(g.fillText(P.char,P.width/4,P.height/4),g.fillText(P.char,5*P.width/4,5*P.height/4),g.fillText(P.char,P.width/4,5*P.height/4),g.fillText(P.char,5*P.width/4,P.height/4),g.fillText(P.char,3*P.width/4,3*P.height/4),g.fillText(P.char,-P.width/4,-P.height/4),g.fillText(P.char,3*P.width/4,-P.height/4),g.fillText(P.char,-P.width/4,3*P.height/4)):g.fillText(P.char,P.width/2,P.height/2)),P.lines)for(h=0;h<P.lines.length;h++)for(var F=0;F<P.repeat.length;F++){var U=P.lines[h];g.beginPath(),g.moveTo(U[0]+P.repeat[F][0],U[1]+P.repeat[F][1]);for(var A=2;A<U.length;A+=2)g.lineTo(U[A]+P.repeat[F][0],U[A+1]+P.repeat[F][1]);P.fill&&g.fill(),P.stroke&&g.stroke(),g.save(),g.strokeStyle="red",g.strokeWidth=.1,g.restore()}if(c=g.createPattern(u,"repeat"),n.offset){var G=n.offset;if(typeof G=="number"&&(G=[G,G]),G instanceof Array){var B=Math.round(G[0]*m),O=Math.round(G[1]*m);g.scale(1/m,1/m),g.clearRect(0,0,u.width,u.height),g.translate(B,O),g.fillStyle=c,g.fillRect(-B,-O,u.width,u.height),c=g.createPattern(u,"repeat")}}}n.color=c,ol.style.Stroke.call(this,n)},ol.ext.inherits(ol.style.StrokePattern,ol.style.Stroke),ol.style.StrokePattern.prototype.clone=function(){var n=ol.style.Fill.prototype.clone.call(this);return n.canvas_=this.canvas_,n},ol.style.StrokePattern.prototype.getImage=function(){return this.canvas_},ol.style.StrokePattern.prototype.getPattern_=function(n){var c=ol.style.FillPattern.prototype.patterns[n.pattern]||ol.style.FillPattern.prototype.patterns.dot,h=Math.round(n.spacing)||10,u;switch(n.pattern){case"dot":case"circle":{u=n.size===0?0:n.size/2||2,n.angle?(h=c.width=c.height=Math.round(h*1.4),c.circles=[[h/4,h/4,u],[3*h/4,3*h/4,u]],n.pattern=="circle"&&(c.circles=c.circles.concat([[h/4+h,h/4,u],[h/4,h/4+h,u],[3*h/4-h,3*h/4,u],[3*h/4,3*h/4-h,u],[h/4+h,h/4+h,u],[3*h/4-h,3*h/4-h,u]]))):(c.width=c.height=h,c.circles=[[h/2,h/2,u]],n.pattern=="circle"&&(c.circles=c.circles.concat([[h/2+h,h/2,u],[h/2-h,h/2,u],[h/2,h/2+h,u],[h/2,h/2-h,u],[h/2+h,h/2+h,u],[h/2+h,h/2-h,u],[h/2-h,h/2+h,u],[h/2-h,h/2-h,u]])));break}case"tile":case"square":{u=n.size===0?0:n.size/2||2,n.angle?(c.width=c.height=h,c.lines=[[h/2-u,h/2,h/2,h/2-u,h/2+u,h/2,h/2,h/2+u,h/2-u,h/2]]):(c.width=c.height=h,c.lines=[[h/2-u,h/2-u,h/2+u,h/2-u,h/2+u,h/2+u,h/2-u,h/2+u,h/2-u,h/2-u]]),n.pattern=="square"&&(c.repeat=[[0,0],[0,h],[h,0],[0,-h],[-h,0],[-h,-h],[h,h],[-h,h],[h,-h]]);break}case"cross":n.angle&&(n.angle=45);case"hatch":{var d=Math.round(((n.angle||0)-90)%360);d>180&&(d-=360),d*=Math.PI/180;var m=Math.cos(d),g=Math.sin(d);if(Math.abs(g)<1e-4)c.width=c.height=h,c.lines=[[0,.5,h,.5]],c.repeat=[[0,0],[0,h]];else if(Math.abs(m)<1e-4)c.width=c.height=h,c.lines=[[.5,0,.5,h]],c.repeat=[[0,0],[h,0]],n.pattern=="cross"&&(c.lines.push([0,.5,h,.5]),c.repeat.push([0,h]));else{var x=c.width=Math.round(Math.abs(h/g))||1,E=c.height=Math.round(Math.abs(h/m))||1;n.pattern=="cross"?(c.lines=[[-x,-E,2*x,2*E],[2*x,-E,-x,2*E]],c.repeat=[[0,0]]):m*g>0?(c.lines=[[-x,-E,2*x,2*E]],c.repeat=[[0,0],[x,0],[0,E]]):(c.lines=[[2*x,-E,-x,2*E]],c.repeat=[[0,0],[-x,0],[0,E]])}c.stroke=n.size===0?0:n.size||4;break}default:break}return c},ol.style.Style.defaultStyle,function(){var n=[255,255,255,1],c=[0,153,255,1],h=3,u=[new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:h+2})}),new ol.style.Style({image:new ol.style.Circle({radius:h*2,fill:new ol.style.Fill({color:c}),stroke:new ol.style.Stroke({color:n,width:h/2})}),stroke:new ol.style.Stroke({color:c,width:h}),fill:new ol.style.Fill({color:[255,255,255,.5]})})];ol.style.Style.defaultStyle=function(d){if(d===!0)return u;d=d||{};var m=new ol.style.Fill({color:d.fillColor||"rgba(255,255,255,0.4)"}),g=new ol.style.Stroke({color:d.color||"#3399CC",width:1.25}),x=new ol.style.Style({image:new ol.style.Circle({fill:m,stroke:g,radius:5}),fill:m,stroke:g});return[x]}}(),ol.style.geoportailStyle,function(){var n={},c=0;function h(x){var E=function(B){if(x.vert&&B.get("itineraire_vert"))return B.get("position_par_rapport_au_sol")<0?[0,128,0,.7]:B.get("position_par_rapport_au_sol")>0?[0,100,0,1]:[0,128,0,1];if(!B.get("importance"))return"magenta";if(B.get("nature")==="Piste cyclable")return[27,177,27,.5];if(B.get("position_par_rapport_au_sol")!="0"){var O;switch(B.get("importance")){case"1":O=[177,27,177,1];break;case"2":O=[177,27,27,1];break;case"3":O=[217,119,0,1];break;case"4":O=[255,225,0,1];break;case"5":O=[204,204,204,1];break;default:O=[211,211,211,1];break}return B.get("position_par_rapport_au_sol")<0&&(O[3]=.7),O}else switch(B.get("importance")){case"1":return[255,0,255,1];case"2":return[255,0,0,1];case"3":return[255,165,0,1];case"4":return[255,255,0,1];case"5":return[255,255,255,1];default:return[211,211,211,1]}},P=function(B){return Math.max(B.get("largeur_de_chaussee")||2,2)},L=function(B){if(!B.get("position_par_rapport_au_sol"))return 100;var O=Number(B.get("position_par_rapport_au_sol"));return O>0?10+O*10-(Number(B.get("importance"))||10):O<0?Math.max(4+O,0):10-(Number(B.get("importance"))||10)},F=function(B){for(var O=B.getCoordinates(),K,Q,et=0,lt=B.getLength(),pt=0;pt<O.length-1&&(K=O[pt+1][0]-O[pt][0],Q=O[pt+1][1]-O[pt][1],et+=Math.sqrt(K*K+Q*Q),!(et>=lt/2));pt++);return-Math.atan2(Q,K)},U=function(B){return x.sens&&!/double|sans/i.test(B.get("sens_de_circulation"))?new ol.style.Text({text:B.get("sens_de_circulation")=="Sens direct"?"\u2192":"\u2190",font:"bold 12px sans-serif",placement:"point",textAlign:"center",fill:new ol.style.Fill({color:[0,0,0,.3]}),stroke:new ol.style.Stroke({color:[0,0,0,.3],width:1.5}),rotateWithView:!0}):null},A=function(B){switch(B.get("nature")){case"Escalier":return[1,4];case"Sentier":return[8,10]}},G="ROUT-"+c+++"-";return function(B,O){var K=x.sens===!0||O<x.sens,Q=G+B.get("nature")+"-"+B.get("position_par_rapport_au_sol")+"-"+(K?B.get("sens_de_circulation"):"Sans objet")+"-"+B.get("position_par_rapport_au_sol")+"-"+B.get("importance")+"-"+B.get("largeur_de_chaussee")+"-"+B.get("itineraire_vert"),et=n[Q];return et||(et=n[Q]=[new ol.style.Style({text:K?U(B):null,stroke:new ol.style.Stroke({color:E(B),width:P(B),lineDash:A(B)}),zIndex:L(B)-100})]),et[0].getText()&&et[0].getText().setRotation(F(B.getGeometry())),et}}function u(x){var E=function(F){switch(F.get("nature")){case"Industriel, agricole ou commercial":return[51,102,153,1];case"Remarquable":return[0,192,0,1];default:switch(F.get("usage_1")){case"R\xE9sidentiel":case"Indiff\xE9renci\xE9":return[128,128,128,1];case"Industriel":case"Commercial et services":return[51,102,153,1];case"Sportif":return[51,153,102,1];case"Religieux":return[153,102,51,1];default:return[153,51,51,1]}}},P=function(F){switch(F.get("usage_1")){case"Commercial et services":return"\uF217";case"Sportif":return"\uF1E3";default:return null}},L="BATI-"+c+++"-";return function(F){if(F.get("detruit"))return[];var U=L+F.get("usage_1")+"-"+F.get("nature")+"-"+F.get("etat_de_l_objet"),A=n[U];if(!A){var G=E(F),B=[G[0],G[1],G[1],.5],O=!/en service/i.test(F.get("etat_de_l_objet"));O&&(B[3]=.1);var K=x.symbol?P(F):null;return[new ol.style.Style({text:K?new ol.style.Text({text:K,font:"12px FontAwesome",fill:new ol.style.Fill({color:[0,0,0,.6]})}):null,fill:new ol.style.Fill({color:B}),stroke:new ol.style.Stroke({color:G,width:1.5,lineDash:O?[5,5]:null})})]}return A}}function d(x){var E=new ol.style.Style({text:new ol.style.Text({text:"0000",font:"bold 12px sans-serif",fill:new ol.style.Fill({color:[100,0,255,1]}),stroke:new ol.style.Stroke({color:[255,255,255,.8],width:3})}),stroke:new ol.style.Stroke({color:[255,165,0,1],width:1.5}),fill:new ol.style.Fill({color:[100,0,255,.1]})});return function(P,L){return L<.8?E.getText().setFont("bold 12px sans-serif"):E.getText().setFont("bold 10px sans-serif"),x.section?E.getText().setText(P.get("section")+"-"+(P.get("numero")||"").replace(/^0*/,"")):E.getText().setText((P.get("numero")||"").replace(/^0*/,"")),E}}var m={111:{color:[230,0,77,255],title:"Continuous urban fabric"},112:{color:[255,0,0,255],title:"Discontinuous urban fabric"},121:{color:[204,77,242,255],title:"Industrial or commercial units"},122:{color:[204,0,0,255],title:"Road and rail networks and associated land"},123:{color:[230,204,204,255],title:"Port areas"},124:{color:[230,204,230,255],title:"Airports"},131:{color:[166,0,204,255],title:"Mineral extraction sites"},132:{color:[166,77,0,255],title:"Dump sites"},133:{color:[255,77,255,255],title:"Construction sites"},141:{color:[255,166,255,255],title:"Green urban areas"},142:{color:[255,230,255,255],title:"Sport and leisure facilities"},211:{color:[255,255,168,255],title:"Non-irrigated arable land"},212:{color:[255,255,0,255],title:"Permanently irrigated land"},213:{color:[230,230,0,255],title:"Rice fields"},221:{color:[230,128,0,255],title:"Vineyards"},222:{color:[242,166,77,255],title:"Fruit trees and berry plantations"},223:{color:[230,166,0,255],title:"Olive groves"},231:{color:[230,230,77,255],title:"Pastures"},241:{color:[255,230,166,255],title:"Annual crops associated with permanent crops"},242:{color:[255,230,77,255],title:"Complex cultivation patterns"},243:{color:[230,204,77,255],title:"Land principally occupied by agriculture with significant areas of natural vegetation"},244:{color:[242,204,166,255],title:"Agro-forestry areas"},311:{color:[128,255,0,255],title:"Broad-leaved forest"},312:{color:[0,166,0,255],title:"Coniferous forest"},313:{color:[77,255,0,255],title:"Mixed forest"},321:{color:[204,242,77,255],title:"Natural grasslands"},322:{color:[166,255,128,255],title:"Moors and heathland"},323:{color:[166,230,77,255],title:"Sclerophyllous vegetation"},324:{color:[166,242,0,255],title:"Transitional woodland-shrub"},331:{color:[230,230,230,255],title:"Beaches dunes sands"},332:{color:[204,204,204,255],title:"Bare rocks"},333:{color:[204,255,204,255],title:"Sparsely vegetated areas"},334:{color:[0,0,0,255],title:"Burnt areas"},335:{color:[166,230,204,255],title:"Glaciers and perpetual snow"},411:{color:[166,166,255,255],title:"Inland marshes"},412:{color:[77,77,255,255],title:"Peat bogs"},421:{color:[204,204,255,255],title:"Salt marshes"},422:{color:[230,230,255,255],title:"Salines"},423:{color:[166,166,230,255],title:"Intertidal flats"},511:{color:[0,204,242,255],title:"Water courses"},512:{color:[128,242,230,255],title:"Water bodies"},521:{color:[0,255,166,255],title:"Coastal lagoons"},522:{color:[166,255,230,255],title:"Estuaries"},523:{color:[230,242,255,255],title:"Sea and ocean"}};function g(x){return function(E){var P=E.get("code_"+x.date),L=n["CLC-"+P];if(!L){var F=m[P].color.slice();F[3]=x.opacity||1,L=n["CLC-"+P]=new ol.style.Style({fill:new ol.style.Fill({color:F||[255,255,255,.5]})})}return L}}ol.style.geoportailStyle=function(x,E){switch(E=E||{},x){case"BDTOPO_V3:troncon_de_route":return h(E);case"BDTOPO_V3:batiment":return u(E);case"CADASTRALPARCELS.PARCELLAIRE_EXPRESS:parcelle":return d(E);default:return/LANDCOVER/.test(x)?(E.date=x.replace(/[^\d]*(\d*).*/,"$1"),g(E)):(console.warn("[ol/style/geoportailStyle] no style defined for type: "+x),ol.style.Style.defaultStyle())}},ol.style.geoportailStyle.clcColors=JSON.parse(JSON.stringify(m))}();/**
 * JSTS. See https://github.com/bjornharrtell/jsts
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EDLv1.txt
 * https://github.com/bjornharrtell/jsts/blob/master/LICENSE_EPLv1.txt
 * @license
 */(function(n,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):c((n=typeof globalThis<"u"?globalThis:n||self).jsts={})})(this,function(n){"use strict";class c{static equalsWithTolerance(r,a,p){return Math.abs(r-a)<=p}}class h extends Error{constructor(r){super(r),this.name=Object.keys({Exception:h})[0]}toString(){return this.message}}class u extends h{constructor(r){super(r),this.name=Object.keys({IllegalArgumentException:u})[0]}}class d{constructor(r,a){this.low=a||0,this.high=r||0}static toBinaryString(r){let a,p="";for(a=2147483648;a>0;a>>>=1)p+=(r.high&a)===a?"1":"0";for(a=2147483648;a>0;a>>>=1)p+=(r.low&a)===a?"1":"0";return p}}function m(){}function g(){}function x(){}m.NaN=NaN,m.isNaN=dt=>Number.isNaN(dt),m.isInfinite=dt=>!Number.isFinite(dt),m.MAX_VALUE=Number.MAX_VALUE,m.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,m.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?function(){const r=new Float64Array(1),a=new Int32Array(r.buffer);m.doubleToLongBits=function(p){r[0]=p;let _=0|a[0],C=0|a[1];return(C&2146435072)===2146435072&&1048575&C&&_!==0&&(_=0,C=2146959360),new d(C,_)},m.longBitsToDouble=function(p){return a[0]=p.low,a[1]=p.high,r[0]}}():function(){const r=Math.log2,a=Math.floor,p=Math.pow,_=function(){for(let C=53;C>0;C--){const k=p(2,C)-1;if(a(r(k))+1===C)return k}return 0}();m.doubleToLongBits=function(C){let k,X,J,Ct,te,ce,Ye,sr,Cr;if(C<0||1/C===Number.NEGATIVE_INFINITY?(ce=1<<31,C=-C):ce=0,C===0)return Cr=0,sr=ce,new d(sr,Cr);if(C===1/0)return Cr=0,sr=2146435072|ce,new d(sr,Cr);if(C!=C)return Cr=0,sr=2146959360,new d(sr,Cr);if(Ct=0,Cr=0,k=a(C),k>1)if(k<=_)Ct=a(r(k)),Ct<=20?(Cr=0,sr=k<<20-Ct&1048575):(J=Ct-20,X=p(2,J),Cr=k%X<<32-J,sr=k/X&1048575);else for(J=k,Cr=0;X=J/2,J=a(X),J!==0;)Ct++,Cr>>>=1,Cr|=(1&sr)<<31,sr>>>=1,X!==J&&(sr|=524288);if(Ye=Ct+1023,te=k===0,k=C-k,Ct<52&&k!==0)for(J=0;;){if(X=2*k,X>=1?(k=X-1,te?(Ye--,te=!1):(J<<=1,J|=1,Ct++)):(k=X,te?--Ye==0&&(Ct++,te=!1):(J<<=1,Ct++)),Ct===20)sr|=J,J=0;else if(Ct===52){Cr|=J;break}if(X===1){Ct<20?sr|=J<<20-Ct:Ct<52&&(Cr|=J<<52-Ct);break}}return sr|=Ye<<20,sr|=ce,new d(sr,Cr)},m.longBitsToDouble=function(C){let k,X,J,Ct;const te=C.high,ce=C.low,Ye=te&1<<31?-1:1;for(J=((2146435072&te)>>20)-1023,Ct=0,X=1<<19,k=1;k<=20;k++)te&X&&(Ct+=p(2,-k)),X>>>=1;for(X=1<<31,k=21;k<=52;k++)ce&X&&(Ct+=p(2,-k)),X>>>=1;if(J===-1023){if(Ct===0)return 0*Ye;J=-1022}else{if(J===1024)return Ct===0?Ye/0:NaN;Ct+=1}return Ye*Ct*p(2,J)}}();class E extends h{constructor(r){super(r),this.name=Object.keys({RuntimeException:E})[0]}}class P extends E{constructor(){super(),P.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)E.constructor_.call(this);else if(arguments.length===1){const r=arguments[0];E.constructor_.call(this,r)}}}class L{static isTrue(){if(arguments.length===1){const r=arguments[0];L.isTrue(r,null)}else if(arguments.length===2){const r=arguments[1];if(!arguments[0])throw r===null?new P:new P(r)}}static shouldNeverReachHere(){if(arguments.length===0)L.shouldNeverReachHere(null);else if(arguments.length===1){const r=arguments[0];throw new P("Should never reach here"+(r!==null?": "+r:""))}}static equals(){if(arguments.length===2){const r=arguments[0],a=arguments[1];L.equals(r,a,null)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(!a.equals(r))throw new P("Expected "+r+" but encountered "+a+(p!==null?": "+p:""))}}}function F(){}function U(){}const A=new ArrayBuffer(8),G=new Float64Array(A),B=new Int32Array(A);class O{constructor(){O.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)O.constructor_.call(this,0,0);else if(arguments.length===1){const r=arguments[0];O.constructor_.call(this,r.x,r.y,r.getZ())}else if(arguments.length===2){const r=arguments[0],a=arguments[1];O.constructor_.call(this,r,a,O.NULL_ORDINATE)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this.x=r,this.y=a,this.z=p}}static hashCode(r){return G[0]=r,B[0]^B[1]}equals2D(){if(arguments.length===1){const r=arguments[0];return this.x===r.x&&this.y===r.y}if(arguments.length===2){const r=arguments[0],a=arguments[1];return!!c.equalsWithTolerance(this.x,r.x,a)&&!!c.equalsWithTolerance(this.y,r.y,a)}}setM(r){throw new u("Invalid ordinate index: "+O.M)}equals3D(r){return this.x===r.x&&this.y===r.y&&(this.getZ()===r.getZ()||m.isNaN(this.getZ())&&m.isNaN(r.getZ()))}setX(r){this.x=r}compareTo(r){const a=r;return this.x<a.x?-1:this.x>a.x?1:this.y<a.y?-1:this.y>a.y?1:0}getX(){return this.x}copy(){return new O(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(r){const a=this.x-r.x,p=this.y-r.y,_=this.getZ()-r.getZ();return Math.sqrt(a*a+p*p+_*_)}getY(){return this.y}getM(){return m.NaN}setOrdinate(r,a){switch(r){case O.X:this.x=a;break;case O.Y:this.y=a;break;case O.Z:this.setZ(a);break;default:throw new u("Invalid ordinate index: "+r)}}getZ(){return this.z}getOrdinate(r){switch(r){case O.X:return this.x;case O.Y:return this.y;case O.Z:return this.getZ()}throw new u("Invalid ordinate index: "+r)}equals(r){return r instanceof O&&this.equals2D(r)}equalInZ(r,a){return c.equalsWithTolerance(this.getZ(),r.getZ(),a)}setZ(r){this.z=r}clone(){try{return null}catch(r){if(r instanceof CloneNotSupportedException)return L.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw r}}setY(r){this.y=r}distance(r){const a=this.x-r.x,p=this.y-r.y;return Math.sqrt(a*a+p*p)}hashCode(){let r=17;return r=37*r+O.hashCode(this.x),r=37*r+O.hashCode(this.y),r}setCoordinate(r){this.x=r.x,this.y=r.y,this.z=r.getZ()}get interfaces_(){return[g,F,x]}}class K{constructor(){K.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,arguments.length===0)K.constructor_.call(this,2);else if(arguments.length===1){const r=arguments[0];if(r!==2&&r!==3)throw new u("only 2 or 3 dimensions may be specified");this._dimensionsToTest=r}}static compare(r,a){return r<a?-1:r>a?1:m.isNaN(r)?m.isNaN(a)?0:-1:m.isNaN(a)?1:0}compare(r,a){const p=K.compare(r.x,a.x);if(p!==0)return p;const _=K.compare(r.y,a.y);return _!==0?_:this._dimensionsToTest<=2?0:K.compare(r.getZ(),a.getZ())}get interfaces_(){return[U]}}O.DimensionalComparator=K,O.NULL_ORDINATE=m.NaN,O.X=0,O.Y=1,O.Z=2,O.M=3;class Q extends O{constructor(){super(),Q.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)O.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof Q){const r=arguments[0];O.constructor_.call(this,r.x,r.y)}else if(arguments[0]instanceof O){const r=arguments[0];O.constructor_.call(this,r.x,r.y)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];O.constructor_.call(this,r,a,O.NULL_ORDINATE)}}setOrdinate(r,a){switch(r){case Q.X:this.x=a;break;case Q.Y:this.y=a;break;default:throw new u("Invalid ordinate index: "+r)}}setZ(r){throw new u("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Q(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(r){this.x=r.x,this.y=r.y,this.z=r.getZ()}getZ(){return O.NULL_ORDINATE}getOrdinate(r){switch(r){case Q.X:return this.x;case Q.Y:return this.y}throw new u("Invalid ordinate index: "+r)}}Q.X=0,Q.Y=1,Q.Z=-1,Q.M=-1;class et extends O{constructor(){super(),et.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)O.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof et){const r=arguments[0];O.constructor_.call(this,r.x,r.y),this._m=r._m}else if(arguments[0]instanceof O){const r=arguments[0];O.constructor_.call(this,r.x,r.y),this._m=this.getM()}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];O.constructor_.call(this,r,a,O.NULL_ORDINATE),this._m=p}}setM(r){this._m=r}setZ(r){throw new u("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new et(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(r){this.x=r.x,this.y=r.y,this.z=r.getZ(),this._m=r.getM()}getM(){return this._m}setOrdinate(r,a){switch(r){case et.X:this.x=a;break;case et.Y:this.y=a;break;case et.M:this._m=a;break;default:throw new u("Invalid ordinate index: "+r)}}getZ(){return O.NULL_ORDINATE}getOrdinate(r){switch(r){case et.X:return this.x;case et.Y:return this.y;case et.M:return this._m}throw new u("Invalid ordinate index: "+r)}}et.X=0,et.Y=1,et.Z=-1,et.M=2;class lt extends O{constructor(){super(),lt.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)O.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof lt){const r=arguments[0];O.constructor_.call(this,r),this._m=r._m}else if(arguments[0]instanceof O){const r=arguments[0];O.constructor_.call(this,r),this._m=this.getM()}}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];O.constructor_.call(this,r,a,p),this._m=_}}setM(r){this._m=r}getOrdinate(r){switch(r){case O.X:return this.x;case O.Y:return this.y;case O.Z:return this.getZ();case O.M:return this.getM()}throw new u("Invalid ordinate index: "+r)}copy(){return new lt(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(r){this.x=r.x,this.y=r.y,this.z=r.getZ(),this._m=r.getM()}getM(){return this._m}setOrdinate(r,a){switch(r){case O.X:this.x=a;break;case O.Y:this.y=a;break;case O.Z:this.z=a;break;case O.M:this._m=a;break;default:throw new u("Invalid ordinate index: "+r)}}}function pt(dt,r){return dt.interfaces_&&dt.interfaces_.indexOf(r)>-1}class T{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class ct extends h{constructor(r){super(r),this.name=Object.keys({IndexOutOfBoundsException:ct})[0]}}class ut extends T{get(){}set(){}isEmpty(){}}class ft extends h{constructor(r){super(r),this.name=Object.keys({NoSuchElementException:ft})[0]}}class $ extends ut{constructor(r){super(),this.array=[],r instanceof T&&this.addAll(r)}get interfaces_(){return[ut,T]}ensureCapacity(){}add(r){return arguments.length===1?this.array.push(r):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(r){for(const a of r)this.array.push(a)}set(r,a){const p=this.array[r];return this.array[r]=a,p}iterator(){return new _t(this)}get(r){if(r<0||r>=this.size())throw new ct;return this.array[r]}isEmpty(){return this.array.length===0}sort(r){r?this.array.sort((a,p)=>r.compare(a,p)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(r){for(let a=0,p=this.array.length;a<p;a++)if(this.array[a]===r)return!!this.array.splice(a,1);return!1}[Symbol.iterator](){return this.array.values()}}let _t=class{constructor(dt){this.arrayList=dt,this.position=0}next(){if(this.position===this.arrayList.size())throw new ft;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(dt){return this.arrayList.set(this.position-1,dt)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}};class W extends ${constructor(){super(),W.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length!==0){if(arguments.length===1){const r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.ensureCapacity(r.length),this.add(r,a)}}}getCoordinate(r){return this.get(r)}addAll(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&pt(arguments[0],T)){const r=arguments[1];let a=!1;for(let p=arguments[0].iterator();p.hasNext();)this.add(p.next(),r),a=!0;return a}return super.addAll.apply(this,arguments)}clone(){const r=super.clone.call(this);for(let a=0;a<this.size();a++)r.add(a,this.get(a).clone());return r}closeRing(){if(this.size()>0){const r=this.get(0).copy();this.add(r,!1)}}toCoordinateArray(){if(arguments.length===0)return this.toArray(W.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(W.coordArrayType);const r=this.size(),a=new Array(r).fill(null);for(let p=0;p<r;p++)a[p]=this.get(r-p-1);return a}}add(){if(arguments.length===1){const r=arguments[0];return super.add.call(this,r)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const r=arguments[0],a=arguments[1];return this.add(r,a,!0),!0}if(arguments[0]instanceof O&&typeof arguments[1]=="boolean"){const r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;super.add.call(this,r)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){const r=arguments[0],a=arguments[1];return this.add(r,a),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const r=arguments[0],a=arguments[1];if(arguments[2])for(let p=0;p<r.length;p++)this.add(r[p],a);else for(let p=r.length-1;p>=0;p--)this.add(r[p],a);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1];if(!arguments[2]){const p=this.size();if(p>0&&(r>0&&this.get(r-1).equals2D(a)||r<p&&this.get(r).equals2D(a)))return null}super.add.call(this,r,a)}}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];let C=1;p>_&&(C=-1);for(let k=p;k!==_;k+=C)this.add(r[k],a);return!0}}}W.coordArrayType=new Array(0).fill(null);class rt{filter(r,a){}isGeometryChanged(){}isDone(){}}class nt{constructor(){nt.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof O){const r=arguments[0];this.init(r.x,r.x,r.y,r.y)}else if(arguments[0]instanceof nt){const r=arguments[0];this.init(r)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.init(r.x,a.x,r.y,a.y)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this.init(r,a,p,_)}}static intersects(){if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return p.x>=(r.x<a.x?r.x:a.x)&&p.x<=(r.x>a.x?r.x:a.x)&&p.y>=(r.y<a.y?r.y:a.y)&&p.y<=(r.y>a.y?r.y:a.y)}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];let C=Math.min(p.x,_.x),k=Math.max(p.x,_.x),X=Math.min(r.x,a.x),J=Math.max(r.x,a.x);return!(X>k)&&!(J<C)&&(C=Math.min(p.y,_.y),k=Math.max(p.y,_.y),X=Math.min(r.y,a.y),J=Math.max(r.y,a.y),!(X>k)&&!(J<C))}}getArea(){return this.getWidth()*this.getHeight()}getMinX(){return this._minx}expandToInclude(){if(arguments.length===1){if(arguments[0]instanceof O){const r=arguments[0];this.expandToInclude(r.x,r.y)}else if(arguments[0]instanceof nt){const r=arguments[0];if(r.isNull())return null;this.isNull()?(this._minx=r.getMinX(),this._maxx=r.getMaxX(),this._miny=r.getMinY(),this._maxy=r.getMaxY()):(r._minx<this._minx&&(this._minx=r._minx),r._maxx>this._maxx&&(this._maxx=r._maxx),r._miny<this._miny&&(this._miny=r._miny),r._maxy>this._maxy&&(this._maxy=r._maxy))}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=a,this._maxy=a):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),a<this._miny&&(this._miny=a),a>this._maxy&&(this._maxy=a))}}compareTo(r){const a=r;return this.isNull()?a.isNull()?0:-1:a.isNull()?1:this._minx<a._minx?-1:this._minx>a._minx?1:this._miny<a._miny?-1:this._miny>a._miny?1:this._maxx<a._maxx?-1:this._maxx>a._maxx?1:this._maxy<a._maxy?-1:this._maxy>a._maxy?1:0}translate(r,a){if(this.isNull())return null;this.init(this.getMinX()+r,this.getMaxX()+r,this.getMinY()+a,this.getMaxY()+a)}copy(){return new nt(this)}expandBy(){if(arguments.length===1){const r=arguments[0];this.expandBy(r,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this.isNull())return null;this._minx-=r,this._maxx+=r,this._miny-=a,this._maxy+=a,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(arguments.length===1){if(arguments[0]instanceof nt){const r=arguments[0];return this.covers(r)}if(arguments[0]instanceof O){const r=arguments[0];return this.covers(r)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.covers(r,a)}}hashCode(){let r=17;return r=37*r+O.hashCode(this._minx),r=37*r+O.hashCode(this._maxx),r=37*r+O.hashCode(this._miny),r=37*r+O.hashCode(this._maxy),r}equals(r){if(!(r instanceof nt))return!1;const a=r;return this.isNull()?a.isNull():this._maxx===a.getMaxX()&&this._maxy===a.getMaxY()&&this._minx===a.getMinX()&&this._miny===a.getMinY()}intersection(r){if(this.isNull()||r.isNull()||!this.intersects(r))return new nt;const a=this._minx>r._minx?this._minx:r._minx,p=this._miny>r._miny?this._miny:r._miny,_=this._maxx<r._maxx?this._maxx:r._maxx,C=this._maxy<r._maxy?this._maxy:r._maxy;return new nt(a,_,p,C)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(arguments.length===1){if(arguments[0]instanceof O){const r=arguments[0];return this.covers(r.x,r.y)}if(arguments[0]instanceof nt){const r=arguments[0];return!this.isNull()&&!r.isNull()&&r.getMinX()>=this._minx&&r.getMaxX()<=this._maxx&&r.getMinY()>=this._miny&&r.getMaxY()<=this._maxy}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];return!this.isNull()&&r>=this._minx&&r<=this._maxx&&a>=this._miny&&a<=this._maxy}}intersects(){if(arguments.length===1){if(arguments[0]instanceof nt){const r=arguments[0];return!this.isNull()&&!r.isNull()&&!(r._minx>this._maxx||r._maxx<this._minx||r._miny>this._maxy||r._maxy<this._miny)}if(arguments[0]instanceof O){const r=arguments[0];return this.intersects(r.x,r.y)}}else if(arguments.length===2){if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1];return this.isNull()||(r.x<a.x?r.x:a.x)>this._maxx||(r.x>a.x?r.x:a.x)<this._minx||(r.y<a.y?r.y:a.y)>this._maxy?!1:!((r.y>a.y?r.y:a.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];return!this.isNull()&&!(r>this._maxx||r<this._minx||a>this._maxy||a<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const r=this.getWidth(),a=this.getHeight();return Math.sqrt(r*r+a*a)}minExtent(){if(this.isNull())return 0;const r=this.getWidth(),a=this.getHeight();return r<a?r:a}getWidth(){return this.isNull()?0:this._maxx-this._minx}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(r){return!(!this.isNull()&&!r.isNull())||r._minx>this._maxx||r._maxx<this._minx||r._miny>this._maxy||r._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const r=this.getWidth(),a=this.getHeight();return r>a?r:a}centre(){return this.isNull()?null:new O((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof O){const r=arguments[0];this.init(r.x,r.x,r.y,r.y)}else if(arguments[0]instanceof nt){const r=arguments[0];this._minx=r._minx,this._maxx=r._maxx,this._miny=r._miny,this._maxy=r._maxy}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.init(r.x,a.x,r.y,a.y)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];r<a?(this._minx=r,this._maxx=a):(this._minx=a,this._maxx=r),p<_?(this._miny=p,this._maxy=_):(this._miny=_,this._maxy=p)}}getMaxY(){return this._maxy}distance(r){if(this.intersects(r))return 0;let a=0;this._maxx<r._minx?a=r._minx-this._maxx:this._minx>r._maxx&&(a=this._minx-r._maxx);let p=0;return this._maxy<r._miny?p=r._miny-this._maxy:this._miny>r._maxy&&(p=this._miny-r._maxy),a===0?p:p===0?a:Math.sqrt(a*a+p*p)}get interfaces_(){return[g,x]}}class vt{constructor(r){this.str=r}append(r){this.str+=r}setCharAt(r,a){this.str=this.str.substr(0,r)+a+this.str.substr(r+1)}toString(){return this.str}}class Mt{constructor(r){this.value=r}intValue(){return this.value}compareTo(r){return this.value<r?-1:this.value>r?1:0}static compare(r,a){return r<a?-1:r>a?1:0}static isNan(r){return Number.isNaN(r)}static valueOf(r){return new Mt(r)}}class Bt{static isWhitespace(r){return r<=32&&r>=0||r===127}static toUpperCase(r){return r.toUpperCase()}}class Vt extends h{constructor(r){super(r),this.name=Object.keys({IllegalStateException:Vt})[0]}}class Lt{constructor(){Lt.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){const r=arguments[0];this.init(r)}else if(arguments[0]instanceof Lt){const r=arguments[0];this.init(r)}else if(typeof arguments[0]=="string"){const r=arguments[0];Lt.constructor_.call(this,Lt.parse(r))}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.init(r,a)}}static determinant(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];return Lt.determinant(Lt.valueOf(r),Lt.valueOf(a),Lt.valueOf(p),Lt.valueOf(_))}if(arguments[3]instanceof Lt&&arguments[2]instanceof Lt&&arguments[0]instanceof Lt&&arguments[1]instanceof Lt){const r=arguments[1],a=arguments[2],p=arguments[3];return arguments[0].multiply(p).selfSubtract(r.multiply(a))}}static sqr(r){return Lt.valueOf(r).selfMultiply(r)}static valueOf(){if(typeof arguments[0]=="string"){const r=arguments[0];return Lt.parse(r)}if(typeof arguments[0]=="number")return new Lt(arguments[0])}static sqrt(r){return Lt.valueOf(r).sqrt()}static parse(r){let a=0;const p=r.length;for(;Bt.isWhitespace(r.charAt(a));)a++;let _=!1;if(a<p){const Ye=r.charAt(a);Ye!=="-"&&Ye!=="+"||(a++,Ye==="-"&&(_=!0))}const C=new Lt;let k=0,X=0,J=0,Ct=!1;for(;!(a>=p);){const Ye=r.charAt(a);if(a++,Bt.isDigit(Ye)){const sr=Ye-"0";C.selfMultiply(Lt.TEN),C.selfAdd(sr),k++}else{if(Ye!=="."){if(Ye==="e"||Ye==="E"){const sr=r.substring(a);try{J=Mt.parseInt(sr)}catch(Cr){throw Cr instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+sr+" in string "+r):Cr}break}throw new NumberFormatException("Unexpected character '"+Ye+"' at position "+a+" in string "+r)}X=k,Ct=!0}}let te=C;Ct||(X=k);const ce=k-X-J;if(ce===0)te=C;else if(ce>0){const Ye=Lt.TEN.pow(ce);te=C.divide(Ye)}else if(ce<0){const Ye=Lt.TEN.pow(-ce);te=C.multiply(Ye)}return _?te.negate():te}static createNaN(){return new Lt(m.NaN,m.NaN)}static copy(r){return new Lt(r)}static magnitude(r){const a=Math.abs(r),p=Math.log(a)/Math.log(10);let _=Math.trunc(Math.floor(p));return 10*Math.pow(10,_)<=a&&(_+=1),_}static stringOfChar(r,a){const p=new vt;for(let _=0;_<a;_++)p.append(r);return p.toString()}le(r){return this._hi<r._hi||this._hi===r._hi&&this._lo<=r._lo}extractSignificantDigits(r,a){let p=this.abs(),_=Lt.magnitude(p._hi);const C=Lt.TEN.pow(_);p=p.divide(C),p.gt(Lt.TEN)?(p=p.divide(Lt.TEN),_+=1):p.lt(Lt.ONE)&&(p=p.multiply(Lt.TEN),_-=1);const k=_+1,X=new vt,J=Lt.MAX_PRINT_DIGITS-1;for(let Ct=0;Ct<=J;Ct++){r&&Ct===k&&X.append(".");const te=Math.trunc(p._hi);if(te<0)break;let ce=!1,Ye=0;te>9?(ce=!0,Ye="9"):Ye="0"+te,X.append(Ye),p=p.subtract(Lt.valueOf(te)).multiply(Lt.TEN),ce&&p.selfAdd(Lt.TEN);let sr=!0;const Cr=Lt.magnitude(p._hi);if(Cr<0&&Math.abs(Cr)>=J-Ct&&(sr=!1),!sr)break}return a[0]=_,X.toString()}sqr(){return this.multiply(this)}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}setValue(){if(arguments[0]instanceof Lt){const r=arguments[0];return this.init(r),this}if(typeof arguments[0]=="number"){const r=arguments[0];return this.init(r),this}}multiply(){if(arguments[0]instanceof Lt){const r=arguments[0];return r.isNaN()?Lt.createNaN():Lt.copy(this).selfMultiply(r)}if(typeof arguments[0]=="number"){const r=arguments[0];return m.isNaN(r)?Lt.createNaN():Lt.copy(this).selfMultiply(r,0)}}isNaN(){return m.isNaN(this._hi)}reciprocal(){let r=null,a=null,p=null,_=null,C=null,k=null,X=null,J=null;C=1/this._hi,k=Lt.SPLIT*C,r=k-C,J=Lt.SPLIT*this._hi,r=k-r,a=C-r,p=J-this._hi,X=C*this._hi,p=J-p,_=this._hi-p,J=r*p-X+r*_+a*p+a*_,k=(1-X-J-C*this._lo)/this._hi;const Ct=C+k;return new Lt(Ct,C-Ct+k)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof Lt){const r=arguments[0];return this.add(r.negate())}if(typeof arguments[0]=="number"){const r=arguments[0];return this.add(-r)}}equals(){if(arguments.length===1&&arguments[0]instanceof Lt){const r=arguments[0];return this._hi===r._hi&&this._lo===r._lo}}isZero(){return this._hi===0&&this._lo===0}selfSubtract(){if(arguments[0]instanceof Lt){const r=arguments[0];return this.isNaN()?this:this.selfAdd(-r._hi,-r._lo)}if(typeof arguments[0]=="number"){const r=arguments[0];return this.isNaN()?this:this.selfAdd(-r,0)}}min(r){return this.le(r)?this:r}selfDivide(){if(arguments.length===1){if(arguments[0]instanceof Lt){const r=arguments[0];return this.selfDivide(r._hi,r._lo)}if(typeof arguments[0]=="number"){const r=arguments[0];return this.selfDivide(r,0)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=null,_=null,C=null,k=null,X=null,J=null,Ct=null,te=null;return X=this._hi/r,J=Lt.SPLIT*X,p=J-X,te=Lt.SPLIT*r,p=J-p,_=X-p,C=te-r,Ct=X*r,C=te-C,k=r-C,te=p*C-Ct+p*k+_*C+_*k,J=(this._hi-Ct-te+this._lo-X*a)/r,te=X+J,this._hi=te,this._lo=X-te+J,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof Lt){const r=arguments[0];let a=null,p=null,_=null,C=null,k=null,X=null,J=null,Ct=null;return k=this._hi/r._hi,X=Lt.SPLIT*k,a=X-k,Ct=Lt.SPLIT*r._hi,a=X-a,p=k-a,_=Ct-r._hi,J=k*r._hi,_=Ct-_,C=r._hi-_,Ct=a*_-J+a*C+p*_+p*C,X=(this._hi-J-Ct+this._lo-k*r._lo)/r._hi,Ct=k+X,new Lt(Ct,k-Ct+X)}if(typeof arguments[0]=="number"){const r=arguments[0];return m.isNaN(r)?Lt.createNaN():Lt.copy(this).selfDivide(r,0)}}ge(r){return this._hi>r._hi||this._hi===r._hi&&this._lo>=r._lo}pow(r){if(r===0)return Lt.valueOf(1);let a=new Lt(this),p=Lt.valueOf(1),_=Math.abs(r);if(_>1)for(;_>0;)_%2==1&&p.selfMultiply(a),_/=2,_>0&&(a=a.sqr());else p=a;return r<0?p.reciprocal():p}ceil(){if(this.isNaN())return Lt.NaN;const r=Math.ceil(this._hi);let a=0;return r===this._hi&&(a=Math.ceil(this._lo)),new Lt(r,a)}compareTo(r){const a=r;return this._hi<a._hi?-1:this._hi>a._hi?1:this._lo<a._lo?-1:this._lo>a._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}max(r){return this.ge(r)?this:r}sqrt(){if(this.isZero())return Lt.valueOf(0);if(this.isNegative())return Lt.NaN;const r=1/Math.sqrt(this._hi),a=this._hi*r,p=Lt.valueOf(a),_=this.subtract(p.sqr())._hi*(.5*r);return p.add(_)}selfAdd(){if(arguments.length===1){if(arguments[0]instanceof Lt){const r=arguments[0];return this.selfAdd(r._hi,r._lo)}if(typeof arguments[0]=="number"){const r=arguments[0];let a=null,p=null,_=null,C=null,k=null,X=null;return _=this._hi+r,k=_-this._hi,C=_-k,C=r-k+(this._hi-C),X=C+this._lo,a=_+X,p=X+(_-a),this._hi=a+p,this._lo=p+(a-this._hi),this}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=null,_=null,C=null,k=null,X=null,J=null,Ct=null,te=null;X=this._hi+r,C=this._lo+a,Ct=X-this._hi,te=C-this._lo,J=X-Ct,k=C-te,J=r-Ct+(this._hi-J),k=a-te+(this._lo-k),Ct=J+C,p=X+Ct,_=Ct+(X-p),Ct=k+_;const ce=p+Ct,Ye=Ct+(p-ce);return this._hi=ce,this._lo=Ye,this}}selfMultiply(){if(arguments.length===1){if(arguments[0]instanceof Lt){const r=arguments[0];return this.selfMultiply(r._hi,r._lo)}if(typeof arguments[0]=="number"){const r=arguments[0];return this.selfMultiply(r,0)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=null,_=null,C=null,k=null,X=null,J=null;X=Lt.SPLIT*this._hi,p=X-this._hi,J=Lt.SPLIT*r,p=X-p,_=this._hi-p,C=J-r,X=this._hi*r,C=J-C,k=r-C,J=p*C-X+p*k+_*C+_*k+(this._hi*a+this._lo*r);const Ct=X+J;p=X-Ct;const te=J+p;return this._hi=Ct,this._lo=te,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return Lt.NaN;const r=Math.floor(this._hi);let a=0;return r===this._hi&&(a=Math.floor(this._lo)),new Lt(r,a)}negate(){return this.isNaN()?this:new Lt(-this._hi,-this._lo)}clone(){try{return null}catch(r){if(r instanceof CloneNotSupportedException)return null;throw r}}intValue(){return Math.trunc(this._hi)}toString(){const r=Lt.magnitude(this._hi);return r>=-3&&r<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const r=this.getSpecialNumberString();if(r!==null)return r;const a=new Array(1).fill(null),p=this.extractSignificantDigits(!0,a),_=a[0]+1;let C=p;if(p.charAt(0)===".")C="0"+p;else if(_<0)C="0."+Lt.stringOfChar("0",-_)+p;else if(p.indexOf(".")===-1){const k=_-p.length;C=p+Lt.stringOfChar("0",k)+".0"}return this.isNegative()?"-"+C:C}toSciNotation(){if(this.isZero())return Lt.SCI_NOT_ZERO;const r=this.getSpecialNumberString();if(r!==null)return r;const a=new Array(1).fill(null),p=this.extractSignificantDigits(!1,a),_=Lt.SCI_NOT_EXPONENT_CHAR+a[0];if(p.charAt(0)==="0")throw new Vt("Found leading zero: "+p);let C="";p.length>1&&(C=p.substring(1));const k=p.charAt(0)+"."+C;return this.isNegative()?"-"+k+_:k+_}abs(){return this.isNaN()?Lt.NaN:this.isNegative()?this.negate():new Lt(this)}isPositive(){return this._hi>0||this._hi===0&&this._lo>0}lt(r){return this._hi<r._hi||this._hi===r._hi&&this._lo<r._lo}add(){if(arguments[0]instanceof Lt){const r=arguments[0];return Lt.copy(this).selfAdd(r)}if(typeof arguments[0]=="number"){const r=arguments[0];return Lt.copy(this).selfAdd(r)}}init(){if(arguments.length===1){if(typeof arguments[0]=="number"){const r=arguments[0];this._hi=r,this._lo=0}else if(arguments[0]instanceof Lt){const r=arguments[0];this._hi=r._hi,this._lo=r._lo}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._hi=r,this._lo=a}}gt(r){return this._hi>r._hi||this._hi===r._hi&&this._lo>r._lo}isNegative(){return this._hi<0||this._hi===0&&this._lo<0}trunc(){return this.isNaN()?Lt.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[x,g,F]}}Lt.PI=new Lt(3.141592653589793,12246467991473532e-32),Lt.TWO_PI=new Lt(6.283185307179586,24492935982947064e-32),Lt.PI_2=new Lt(1.5707963267948966,6123233995736766e-32),Lt.E=new Lt(2.718281828459045,14456468917292502e-32),Lt.NaN=new Lt(m.NaN,m.NaN),Lt.EPS=123259516440783e-46,Lt.SPLIT=134217729,Lt.MAX_PRINT_DIGITS=32,Lt.TEN=Lt.valueOf(10),Lt.ONE=Lt.valueOf(1),Lt.SCI_NOT_EXPONENT_CHAR="E",Lt.SCI_NOT_ZERO="0.0E0";class Ne{static orientationIndex(r,a,p){const _=Ne.orientationIndexFilter(r,a,p);if(_<=1)return _;const C=Lt.valueOf(a.x).selfAdd(-r.x),k=Lt.valueOf(a.y).selfAdd(-r.y),X=Lt.valueOf(p.x).selfAdd(-a.x),J=Lt.valueOf(p.y).selfAdd(-a.y);return C.selfMultiply(J).selfSubtract(k.selfMultiply(X)).signum()}static signOfDet2x2(){if(arguments[3]instanceof Lt&&arguments[2]instanceof Lt&&arguments[0]instanceof Lt&&arguments[1]instanceof Lt){const r=arguments[1],a=arguments[2],p=arguments[3];return arguments[0].multiply(p).selfSubtract(r.multiply(a)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=Lt.valueOf(r),k=Lt.valueOf(a),X=Lt.valueOf(p),J=Lt.valueOf(_);return C.multiply(J).selfSubtract(k.multiply(X)).signum()}}static intersection(r,a,p,_){const C=new Lt(r.y).selfSubtract(a.y),k=new Lt(a.x).selfSubtract(r.x),X=new Lt(r.x).selfMultiply(a.y).selfSubtract(new Lt(a.x).selfMultiply(r.y)),J=new Lt(p.y).selfSubtract(_.y),Ct=new Lt(_.x).selfSubtract(p.x),te=new Lt(p.x).selfMultiply(_.y).selfSubtract(new Lt(_.x).selfMultiply(p.y)),ce=k.multiply(te).selfSubtract(Ct.multiply(X)),Ye=J.multiply(X).selfSubtract(C.multiply(te)),sr=C.multiply(Ct).selfSubtract(J.multiply(k)),Cr=ce.selfDivide(sr).doubleValue(),Ii=Ye.selfDivide(sr).doubleValue();return m.isNaN(Cr)||m.isInfinite(Cr)||m.isNaN(Ii)||m.isInfinite(Ii)?null:new O(Cr,Ii)}static orientationIndexFilter(r,a,p){let _=null;const C=(r.x-p.x)*(a.y-p.y),k=(r.y-p.y)*(a.x-p.x),X=C-k;if(C>0){if(k<=0)return Ne.signum(X);_=C+k}else{if(!(C<0)||k>=0)return Ne.signum(X);_=-C-k}const J=Ne.DP_SAFE_EPSILON*_;return X>=J||-X>=J?Ne.signum(X):2}static signum(r){return r>0?1:r<0?-1:0}}Ne.DP_SAFE_EPSILON=1e-15;class ge{getCoordinate(){}getCoordinateCopy(r){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(r){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(r){}copy(){}getY(r){}toCoordinateArray(){}getM(r){if(this.hasM()){const a=this.getDimension()-this.getMeasures();return this.getOrdinate(r,a)}return m.NaN}setOrdinate(r,a,p){}getZ(r){return this.hasZ()?this.getOrdinate(r,2):m.NaN}size(){}getOrdinate(r,a){}get interfaces_(){return[F]}}ge.X=0,ge.Y=1,ge.Z=2,ge.M=3;class Yt{static isCCW(){if(arguments[0]instanceof Array){const r=arguments[0],a=r.length-1;if(a<3)throw new u("Ring has fewer than 4 points, so orientation cannot be determined");let p=r[0],_=0;for(let ce=1;ce<=a;ce++){const Ye=r[ce];Ye.y>p.y&&(p=Ye,_=ce)}let C=_;do C-=1,C<0&&(C=a);while(r[C].equals2D(p)&&C!==_);let k=_;do k=(k+1)%a;while(r[k].equals2D(p)&&k!==_);const X=r[C],J=r[k];if(X.equals2D(p)||J.equals2D(p)||X.equals2D(J))return!1;const Ct=Yt.index(X,p,J);let te=null;return te=Ct===0?X.x>J.x:Ct>0,te}if(pt(arguments[0],ge)){const r=arguments[0],a=r.size()-1;if(a<3)throw new u("Ring has fewer than 4 points, so orientation cannot be determined");let p=r.getCoordinate(0),_=0;for(let ce=1;ce<=a;ce++){const Ye=r.getCoordinate(ce);Ye.y>p.y&&(p=Ye,_=ce)}let C=null,k=_;do k-=1,k<0&&(k=a),C=r.getCoordinate(k);while(C.equals2D(p)&&k!==_);let X=null,J=_;do J=(J+1)%a,X=r.getCoordinate(J);while(X.equals2D(p)&&J!==_);if(C.equals2D(p)||X.equals2D(p)||C.equals2D(X))return!1;const Ct=Yt.index(C,p,X);let te=null;return te=Ct===0?C.x>X.x:Ct>0,te}}static index(r,a,p){return Ne.orientationIndex(r,a,p)}}Yt.CLOCKWISE=-1,Yt.RIGHT=Yt.CLOCKWISE,Yt.COUNTERCLOCKWISE=1,Yt.LEFT=Yt.COUNTERCLOCKWISE,Yt.COLLINEAR=0,Yt.STRAIGHT=Yt.COLLINEAR;class ue{static intersection(r,a,p,_){const C=r.x<a.x?r.x:a.x,k=r.y<a.y?r.y:a.y,X=r.x>a.x?r.x:a.x,J=r.y>a.y?r.y:a.y,Ct=p.x<_.x?p.x:_.x,te=p.y<_.y?p.y:_.y,ce=p.x>_.x?p.x:_.x,Ye=p.y>_.y?p.y:_.y,sr=((C>Ct?C:Ct)+(X<ce?X:ce))/2,Cr=((k>te?k:te)+(J<Ye?J:Ye))/2,Ii=r.x-sr,Vn=r.y-Cr,no=a.x-sr,ma=a.y-Cr,fp=p.x-sr,gh=p.y-Cr,Pn=_.x-sr,Hd=_.y-Cr,If=Vn-ma,Mf=no-Ii,dp=Ii*ma-no*Vn,Xd=gh-Hd,ya=Pn-fp,Wd=fp*Hd-Pn*gh,Lf=If*ya-Xd*Mf,Af=(Mf*Wd-ya*dp)/Lf,gp=(Xd*dp-If*Wd)/Lf;return m.isNaN(Af)||m.isInfinite(Af)||m.isNaN(gp)||m.isInfinite(gp)?null:new O(Af+sr,gp+Cr)}}class ne{static arraycopy(r,a,p,_,C){let k=0;for(let X=a;X<a+C;X++)p[_+k]=r[X],k++}static getProperty(r){return{"line.separator":`
`}[r]}}class dr{static log10(r){const a=Math.log(r);return m.isInfinite(a)||m.isNaN(a)?a:a/dr.LOG_10}static min(r,a,p,_){let C=r;return a<C&&(C=a),p<C&&(C=p),_<C&&(C=_),C}static clamp(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1],p=arguments[2];return r<a?a:r>p?p:r}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=arguments[2];return r<a?a:r>p?p:r}}static average(r,a){return(r+a)/2}static wrap(r,a){return r<0?a- -r%a:r%a}static max(){if(arguments.length===3){const r=arguments[1],a=arguments[2];let p=arguments[0];return r>p&&(p=r),a>p&&(p=a),p}if(arguments.length===4){const r=arguments[1],a=arguments[2],p=arguments[3];let _=arguments[0];return r>_&&(_=r),a>_&&(_=a),p>_&&(_=p),_}}}dr.LOG_10=Math.log(10);class je{static pointToSegmentString(r,a){if(a.length===0)throw new u("Line array must contain at least one vertex");let p=r.distance(a[0]);for(let _=0;_<a.length-1;_++){const C=je.pointToSegment(r,a[_],a[_+1]);C<p&&(p=C)}return p}static segmentToSegment(r,a,p,_){if(r.equals(a))return je.pointToSegment(r,p,_);if(p.equals(_))return je.pointToSegment(_,r,a);let C=!1;if(nt.intersects(r,a,p,_)){const k=(a.x-r.x)*(_.y-p.y)-(a.y-r.y)*(_.x-p.x);if(k===0)C=!0;else{const X=(r.y-p.y)*(_.x-p.x)-(r.x-p.x)*(_.y-p.y),J=((r.y-p.y)*(a.x-r.x)-(r.x-p.x)*(a.y-r.y))/k,Ct=X/k;(Ct<0||Ct>1||J<0||J>1)&&(C=!0)}}else C=!0;return C?dr.min(je.pointToSegment(r,p,_),je.pointToSegment(a,p,_),je.pointToSegment(p,r,a),je.pointToSegment(_,r,a)):0}static pointToLinePerpendicular(r,a,p){const _=(p.x-a.x)*(p.x-a.x)+(p.y-a.y)*(p.y-a.y),C=((a.y-r.y)*(p.x-a.x)-(a.x-r.x)*(p.y-a.y))/_;return Math.abs(C)*Math.sqrt(_)}static pointToSegment(r,a,p){if(a.x===p.x&&a.y===p.y)return r.distance(a);const _=(p.x-a.x)*(p.x-a.x)+(p.y-a.y)*(p.y-a.y),C=((r.x-a.x)*(p.x-a.x)+(r.y-a.y)*(p.y-a.y))/_;if(C<=0)return r.distance(a);if(C>=1)return r.distance(p);const k=((a.y-r.y)*(p.x-a.x)-(a.x-r.x)*(p.y-a.y))/_;return Math.abs(k)*Math.sqrt(_)}}class Br{static ofLine(r){const a=r.size();if(a<=1)return 0;let p=0;const _=new O;r.getCoordinate(0,_);let C=_.x,k=_.y;for(let X=1;X<a;X++){r.getCoordinate(X,_);const J=_.x,Ct=_.y,te=J-C,ce=Ct-k;p+=Math.sqrt(te*te+ce*ce),C=J,k=Ct}return p}}class Ue{filter(r){}}class Fe extends h{constructor(r){super(r),this.name=Object.keys({UnsupportedOperationException:Fe})[0]}}class Lr{static measures(r){return r instanceof Q?0:r instanceof et||r instanceof lt?1:0}static create(){if(arguments.length===1){const r=arguments[0];return Lr.create(r,0)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return r===2?new Q:r===3&&a===0?new O:r===3&&a===1?new et:r===4&&a===1?new lt:new O}}static dimension(r){return r instanceof Q?2:r instanceof et?3:r instanceof lt?4:3}}class De{static scroll(r,a){const p=De.indexOf(a,r);if(p<0)return null;const _=new Array(r.length).fill(null);ne.arraycopy(r,p,_,0,r.length-p),ne.arraycopy(r,0,_,r.length-p,p),ne.arraycopy(_,0,r,0,r.length)}static removeRepeatedPoints(r){return De.hasRepeatedPoints(r)?new W(r,!1).toCoordinateArray():r}static reverse(r){const a=r.length-1,p=Math.trunc(a/2);for(let _=0;_<=p;_++){const C=r[_];r[_]=r[a-_],r[a-_]=C}}static removeNull(r){let a=0;for(let C=0;C<r.length;C++)r[C]!==null&&a++;const p=new Array(a).fill(null);if(a===0)return p;let _=0;for(let C=0;C<r.length;C++)r[C]!==null&&(p[_++]=r[C]);return p}static copyDeep(){if(arguments.length===1){const r=arguments[0],a=new Array(r.length).fill(null);for(let p=0;p<r.length;p++)a[p]=r[p].copy();return a}if(arguments.length===5){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4];for(let k=0;k<C;k++)p[_+k]=r[a+k].copy()}}static isEqualReversed(r,a){for(let p=0;p<r.length;p++){const _=r[p],C=a[r.length-p-1];if(_.compareTo(C)!==0)return!1}return!0}static envelope(r){const a=new nt;for(let p=0;p<r.length;p++)a.expandToInclude(r[p]);return a}static extract(r,a,p){a=dr.clamp(a,0,r.length);let _=(p=dr.clamp(p,-1,r.length))-a+1;p<0&&(_=0),a>=r.length&&(_=0),p<a&&(_=0);const C=new Array(_).fill(null);if(_===0)return C;let k=0;for(let X=a;X<=p;X++)C[k++]=r[X];return C}static isRing(r){return!(r.length<4)&&!!r[0].equals2D(r[r.length-1])}static ptNotInList(r,a){for(let p=0;p<r.length;p++){const _=r[p];if(De.indexOf(_,a)<0)return _}return null}static equals(){if(arguments.length===2){const r=arguments[0],a=arguments[1];if(r===a)return!0;if(r===null||a===null||r.length!==a.length)return!1;for(let p=0;p<r.length;p++)if(!r[p].equals(a[p]))return!1;return!0}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(r===a)return!0;if(r===null||a===null||r.length!==a.length)return!1;for(let _=0;_<r.length;_++)if(p.compare(r[_],a[_])!==0)return!1;return!0}}static intersection(r,a){const p=new W;for(let _=0;_<r.length;_++)a.intersects(r[_])&&p.add(r[_],!0);return p.toCoordinateArray()}static measures(r){if(r===null||r.length===0)return 0;let a=0;for(const p of r)a=Math.max(a,Lr.measures(p));return a}static hasRepeatedPoints(r){for(let a=1;a<r.length;a++)if(r[a-1].equals(r[a]))return!0;return!1}static toCoordinateArray(r){return r.toArray(De.coordArrayType)}static dimension(r){if(r===null||r.length===0)return 3;let a=0;for(const p of r)a=Math.max(a,Lr.dimension(p));return a}static atLeastNCoordinatesOrNothing(r,a){return a.length>=r?a:[]}static indexOf(r,a){for(let p=0;p<a.length;p++)if(r.equals(a[p]))return p;return-1}static increasingDirection(r){for(let a=0;a<Math.trunc(r.length/2);a++){const p=r.length-1-a,_=r[a].compareTo(r[p]);if(_!==0)return _}return 1}static compare(r,a){let p=0;for(;p<r.length&&p<a.length;){const _=r[p].compareTo(a[p]);if(_!==0)return _;p++}return p<a.length?-1:p<r.length?1:0}static minCoordinate(r){let a=null;for(let p=0;p<r.length;p++)(a===null||a.compareTo(r[p])>0)&&(a=r[p]);return a}}De.ForwardComparator=class{compare(dt,r){const a=dt,p=r;return De.compare(a,p)}get interfaces_(){return[U]}},De.BidirectionalComparator=class{compare(dt,r){const a=dt,p=r;if(a.length<p.length)return-1;if(a.length>p.length)return 1;if(a.length===0)return 0;const _=De.compare(a,p);return De.isEqualReversed(a,p)?0:_}OLDcompare(dt,r){const a=dt,p=r;if(a.length<p.length)return-1;if(a.length>p.length)return 1;if(a.length===0)return 0;const _=De.increasingDirection(a),C=De.increasingDirection(p);let k=_>0?0:a.length-1,X=C>0?0:a.length-1;for(let J=0;J<a.length;J++){const Ct=a[k].compareTo(p[X]);if(Ct!==0)return Ct;k+=_,X+=C}return 0}get interfaces_(){return[U]}},De.coordArrayType=new Array(0).fill(null);class se{static toDimensionSymbol(r){switch(r){case se.FALSE:return se.SYM_FALSE;case se.TRUE:return se.SYM_TRUE;case se.DONTCARE:return se.SYM_DONTCARE;case se.P:return se.SYM_P;case se.L:return se.SYM_L;case se.A:return se.SYM_A}throw new u("Unknown dimension value: "+r)}static toDimensionValue(r){switch(Bt.toUpperCase(r)){case se.SYM_FALSE:return se.FALSE;case se.SYM_TRUE:return se.TRUE;case se.SYM_DONTCARE:return se.DONTCARE;case se.SYM_P:return se.P;case se.SYM_L:return se.L;case se.SYM_A:return se.A}throw new u("Unknown dimension symbol: "+r)}}se.P=0,se.L=1,se.A=2,se.FALSE=-1,se.TRUE=-2,se.DONTCARE=-3,se.SYM_FALSE="F",se.SYM_TRUE="T",se.SYM_DONTCARE="*",se.SYM_P="0",se.SYM_L="1",se.SYM_A="2";class oe{constructor(){oe.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===oe.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(r){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(r){return this===r||this.equalsExact(r,0)}geometryChanged(){this.apply(oe.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(r){return r!==null&&this.norm().equalsExact(r.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let r;if(arguments.length===1){const a=arguments[0];return r=a,this.getTypeCode()!==r.getTypeCode()?this.getTypeCode()-r.getTypeCode():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(a)}if(arguments.length===2){const a=arguments[0],p=arguments[1];return r=a,this.getTypeCode()!==r.getTypeCode()?this.getTypeCode()-r.getTypeCode():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(a,p)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(r){if(r.getTypeCode()===oe.TYPECODE_GEOMETRYCOLLECTION)throw new u("This method does not support GeometryCollection arguments")}equal(r,a,p){return p===0?r.equals(a):r.distance(a)<=p}norm(){const r=this.copy();return r.normalize(),r}reverse(){const r=this.reverseInternal();return this.envelope!=null&&(r.envelope=this.envelope.copy()),r.setSRID(this.getSRID()),r}copy(){const r=this.copyInternal();return r.envelope=this._envelope==null?null:this._envelope.copy(),r._SRID=this._SRID,r._userData=this._userData,r}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new nt(this._envelope)}setSRID(r){this._SRID=r}setUserData(r){this._userData=r}compare(r,a){const p=r.iterator(),_=a.iterator();for(;p.hasNext()&&_.hasNext();){const C=p.next(),k=_.next(),X=C.compareTo(k);if(X!==0)return X}return p.hasNext()?1:_.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(r){return this.getTypeCode()==r.getTypeCode()}get interfaces_(){return[F,g,x]}getClass(){return oe}static hasNonEmptyElements(r){for(let a=0;a<r.length;a++)if(!r[a].isEmpty())return!0;return!1}static hasNullElements(r){for(let a=0;a<r.length;a++)if(r[a]===null)return!0;return!1}}oe.constructor_=function(dt){dt&&(this._envelope=null,this._userData=null,this._factory=dt,this._SRID=dt.getSRID())},oe.TYPECODE_POINT=0,oe.TYPECODE_MULTIPOINT=1,oe.TYPECODE_LINESTRING=2,oe.TYPECODE_LINEARRING=3,oe.TYPECODE_MULTILINESTRING=4,oe.TYPECODE_POLYGON=5,oe.TYPECODE_MULTIPOLYGON=6,oe.TYPECODE_GEOMETRYCOLLECTION=7,oe.TYPENAME_POINT="Point",oe.TYPENAME_MULTIPOINT="MultiPoint",oe.TYPENAME_LINESTRING="LineString",oe.TYPENAME_LINEARRING="LinearRing",oe.TYPENAME_MULTILINESTRING="MultiLineString",oe.TYPENAME_POLYGON="Polygon",oe.TYPENAME_MULTIPOLYGON="MultiPolygon",oe.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",oe.geometryChangedFilter={get interfaces_(){return[Ue]},filter(dt){dt.geometryChangedAction()}};class Ar{filter(r){}}class vr{}class Kr{static scroll(){if(arguments.length===2){if(pt(arguments[0],ge)&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1];Kr.scroll(r,a,Kr.isRing(r))}else if(pt(arguments[0],ge)&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=Kr.indexOf(a,r);if(p<=0)return null;Kr.scroll(r,p)}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(a<=0)return null;const _=r.copy(),C=p?r.size()-1:r.size();for(let k=0;k<C;k++)for(let X=0;X<r.getDimension();X++)r.setOrdinate(k,X,_.getOrdinate((a+k)%C,X));if(p)for(let k=0;k<r.getDimension();k++)r.setOrdinate(C,k,r.getOrdinate(0,k))}}static isEqual(r,a){const p=r.size();if(p!==a.size())return!1;const _=Math.min(r.getDimension(),a.getDimension());for(let C=0;C<p;C++)for(let k=0;k<_;k++){const X=r.getOrdinate(C,k),J=a.getOrdinate(C,k);if(r.getOrdinate(C,k)!==a.getOrdinate(C,k)&&(!m.isNaN(X)||!m.isNaN(J)))return!1}return!0}static minCoordinateIndex(){if(arguments.length===1){const r=arguments[0];return Kr.minCoordinateIndex(r,0,r.size()-1)}if(arguments.length===3){const r=arguments[0],a=arguments[2];let p=-1,_=null;for(let C=arguments[1];C<=a;C++){const k=r.getCoordinate(C);(_===null||_.compareTo(k)>0)&&(_=k,p=C)}return p}}static extend(r,a,p){const _=r.create(p,a.getDimension()),C=a.size();if(Kr.copy(a,0,_,0,C),C>0)for(let k=C;k<p;k++)Kr.copy(a,C-1,_,k,1);return _}static reverse(r){const a=r.size()-1,p=Math.trunc(a/2);for(let _=0;_<=p;_++)Kr.swap(r,_,a-_)}static ensureValidRing(r,a){const p=a.size();return p===0?a:p<=3?Kr.createClosedRing(r,a,4):a.getOrdinate(0,ge.X)===a.getOrdinate(p-1,ge.X)&&a.getOrdinate(0,ge.Y)===a.getOrdinate(p-1,ge.Y)?a:Kr.createClosedRing(r,a,p+1)}static minCoordinate(r){let a=null;for(let p=0;p<r.size();p++){const _=r.getCoordinate(p);(a===null||a.compareTo(_)>0)&&(a=_)}return a}static copyCoord(r,a,p,_){const C=Math.min(r.getDimension(),p.getDimension());for(let k=0;k<C;k++)p.setOrdinate(_,k,r.getOrdinate(a,k))}static isRing(r){const a=r.size();return a===0||!(a<=3)&&r.getOrdinate(0,ge.X)===r.getOrdinate(a-1,ge.X)&&r.getOrdinate(0,ge.Y)===r.getOrdinate(a-1,ge.Y)}static swap(r,a,p){if(a===p)return null;for(let _=0;_<r.getDimension();_++){const C=r.getOrdinate(a,_);r.setOrdinate(a,_,r.getOrdinate(p,_)),r.setOrdinate(p,_,C)}}static copy(r,a,p,_,C){for(let k=0;k<C;k++)Kr.copyCoord(r,a+k,p,_+k)}static indexOf(r,a){for(let p=0;p<a.size();p++)if(r.x===a.getOrdinate(p,ge.X)&&r.y===a.getOrdinate(p,ge.Y))return p;return-1}static createClosedRing(r,a,p){const _=r.create(p,a.getDimension()),C=a.size();Kr.copy(a,0,_,0,C);for(let k=C;k<p;k++)Kr.copy(a,0,_,k,1);return _}}class wi{filter(r){}}class Ee extends oe{constructor(){super(),Ee.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,arguments.length!==0){if(arguments.length===2){const r=arguments[0],a=arguments[1];oe.constructor_.call(this,a),this.init(r)}}}computeEnvelopeInternal(){return this.isEmpty()?new nt:this._points.expandEnvelope(new nt)}isRing(){return this.isClosed()&&De.isRing(this.getCoordinates())}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new Ee(this._points.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];if(!this.isEquivalentClass(r))return!1;const p=r;if(this._points.size()!==p._points.size())return!1;for(let _=0;_<this._points.size();_++)if(!this.equal(this._points.getCoordinate(_),p._points.getCoordinate(_),a))return!1;return!0}return super.equalsExact.apply(this,arguments)}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const r=this._points.copy();return Kr.reverse(r),this.getFactory().createLineString(r)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return oe.TYPECODE_LINESTRING}getDimension(){return 1}getBoundary(){throw new Fe}isEquivalentClass(r){return r instanceof Ee}getCoordinateSequence(){return this._points}getPointN(r){return this.getFactory().createPoint(this._points.getCoordinate(r))}normalize(){for(let r=0;r<Math.trunc(this._points.size()/2);r++){const a=this._points.size()-1-r;if(!this._points.getCoordinate(r).equals(this._points.getCoordinate(a))){if(this._points.getCoordinate(r).compareTo(this._points.getCoordinate(a))>0){const p=this._points.copy();Kr.reverse(p),this._points=p}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?se.FALSE:0}getLength(){return Br.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(arguments.length===1){const r=arguments[0];let a=0,p=0;for(;a<this._points.size()&&p<r._points.size();){const _=this._points.getCoordinate(a).compareTo(r._points.getCoordinate(p));if(_!==0)return _;a++,p++}return a<this._points.size()?1:p<r._points.size()?-1:0}if(arguments.length===2){const r=arguments[0];return arguments[1].compare(this._points,r._points)}}apply(){if(pt(arguments[0],Ar)){const r=arguments[0];for(let a=0;a<this._points.size();a++)r.filter(this._points.getCoordinate(a))}else if(pt(arguments[0],rt)){const r=arguments[0];if(this._points.size()===0)return null;for(let a=0;a<this._points.size()&&(r.filter(this._points,a),!r.isDone());a++);r.isGeometryChanged()&&this.geometryChanged()}else pt(arguments[0],wi)?arguments[0].filter(this):pt(arguments[0],Ue)&&arguments[0].filter(this)}getCoordinateN(r){return this._points.getCoordinate(r)}getGeometryType(){return oe.TYPENAME_LINESTRING}isEmpty(){return this._points.size()===0}init(r){if(r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),r.size()===1)throw new u("Invalid number of points in LineString (found "+r.size()+" - must be 0 or >= 2)");this._points=r}isCoordinate(r){for(let a=0;a<this._points.size();a++)if(this._points.getCoordinate(a).equals(r))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}get interfaces_(){return[vr]}}class Sr extends Ee{constructor(){super(),Sr.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ee.constructor_.call(this,r,a),this.validateConstruction()}copyInternal(){return new Sr(this._points.copy(),this._factory)}getBoundaryDimension(){return se.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){const r=this._points.copy();return Kr.reverse(r),this.getFactory().createLinearRing(r)}getTypeCode(){return oe.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new u("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Sr.MINIMUM_VALID_SIZE)throw new u("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return oe.TYPENAME_LINEARRING}}Sr.MINIMUM_VALID_SIZE=4;class Or{create(){if(arguments.length===1)arguments[0]instanceof Array||pt(arguments[0],ge);else if(arguments.length!==2){if(arguments.length===3){const r=arguments[0],a=arguments[1];return this.create(r,a)}}}}class xn{constructor(r){this.str=r}append(r){this.str+=r}setCharAt(r,a){this.str=this.str.substr(0,r)+a+this.str.substr(r+1)}toString(){return this.str}}class ye{constructor(){ye.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){const r=arguments[0];ye.constructor_.call(this,r,De.dimension(r),De.measures(r))}else if(Number.isInteger(arguments[0])){const r=arguments[0];this._coordinates=new Array(r).fill(null);for(let a=0;a<r;a++)this._coordinates[a]=new O}else if(pt(arguments[0],ge)){const r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._measures=r.getMeasures(),this._coordinates=new Array(r.size()).fill(null);for(let a=0;a<this._coordinates.length;a++)this._coordinates[a]=r.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1];ye.constructor_.call(this,r,a,De.measures(r))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1];this._coordinates=new Array(r).fill(null),this._dimension=a;for(let p=0;p<r;p++)this._coordinates[p]=Lr.create(a)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=arguments[2];this._dimension=a,this._measures=p,this._coordinates=r===null?new Array(0).fill(null):r}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=arguments[2];this._coordinates=new Array(r).fill(null),this._dimension=a,this._measures=p;for(let _=0;_<r;_++)this._coordinates[_]=this.createCoordinate()}}}getCoordinate(){if(arguments.length===1){const r=arguments[0];return this._coordinates[r]}if(arguments.length===2){const r=arguments[0];arguments[1].setCoordinate(this._coordinates[r])}}getCoordinateCopy(r){const a=this.createCoordinate();return a.setCoordinate(this._coordinates[r]),a}createCoordinate(){return Lr.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(r){return this._coordinates[r].x}getMeasures(){return this._measures}expandEnvelope(r){for(let a=0;a<this._coordinates.length;a++)r.expandToInclude(this._coordinates[a]);return r}copy(){const r=new Array(this.size()).fill(null);for(let a=0;a<this._coordinates.length;a++){const p=this.createCoordinate();p.setCoordinate(this._coordinates[a]),r[a]=p}return new ye(r,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const r=new xn(17*this._coordinates.length);r.append("("),r.append(this._coordinates[0]);for(let a=1;a<this._coordinates.length;a++)r.append(", "),r.append(this._coordinates[a]);return r.append(")"),r.toString()}return"()"}getY(r){return this._coordinates[r].y}toCoordinateArray(){return this._coordinates}getM(r){return this.hasM()?this._coordinates[r].getM():m.NaN}setOrdinate(r,a,p){switch(a){case ge.X:this._coordinates[r].x=p;break;case ge.Y:this._coordinates[r].y=p;break;default:this._coordinates[r].setOrdinate(a,p)}}getZ(r){return this.hasZ()?this._coordinates[r].getZ():m.NaN}size(){return this._coordinates.length}getOrdinate(r,a){switch(a){case ge.X:return this._coordinates[r].x;case ge.Y:return this._coordinates[r].y;default:return this._coordinates[r].getOrdinate(a)}}get interfaces_(){return[ge,x]}}class oi{static instance(){return oi.instanceObject}readResolve(){return oi.instance()}create(){if(arguments.length===1){if(arguments[0]instanceof Array)return new ye(arguments[0]);if(pt(arguments[0],ge))return new ye(arguments[0])}else{if(arguments.length===2){let r=arguments[1];return r>3&&(r=3),r<2&&(r=2),new ye(arguments[0],r)}if(arguments.length===3){let r=arguments[2],a=arguments[1]-r;return r>1&&(r=1),a>3&&(a=3),a<2&&(a=2),new ye(arguments[0],a+r,r)}}}get interfaces_(){return[Or,x]}}oi.instanceObject=new oi;class eo extends T{contains(){}}class Xo extends eo{}class Xn extends Xo{constructor(r){super(),this.array=[],r instanceof T&&this.addAll(r)}contains(r){for(const a of this.array)if(a.compareTo(r)===0)return!0;return!1}add(r){if(this.contains(r))return!1;for(let a=0,p=this.array.length;a<p;a++)if(this.array[a].compareTo(r)===1)return!!this.array.splice(a,0,r);return this.array.push(r),!0}addAll(r){for(const a of r)this.add(a);return!0}remove(){throw new Fe}size(){return this.array.length}isEmpty(){return this.array.length===0}toArray(){return this.array.slice()}iterator(){return new cn(this.array)}}let cn=class{constructor(dt){this.array=dt,this.position=0}next(){if(this.position===this.array.length)throw new ft;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new Fe}};class Ft{static sort(){const r=arguments[0];if(arguments.length===1)r.sort((a,p)=>a.compareTo(p));else if(arguments.length===2)r.sort((a,p)=>arguments[1].compare(a,p));else if(arguments.length===3){const a=r.slice(arguments[1],arguments[2]);a.sort();const p=r.slice(0,arguments[1]).concat(a,r.slice(arguments[2],r.length));r.splice(0,r.length);for(const _ of p)r.push(_)}else if(arguments.length===4){const a=r.slice(arguments[1],arguments[2]);a.sort((_,C)=>arguments[3].compare(_,C));const p=r.slice(0,arguments[1]).concat(a,r.slice(arguments[2],r.length));r.splice(0,r.length);for(const _ of p)r.push(_)}}static asList(r){const a=new $;for(const p of r)a.add(p);return a}static copyOf(r,a){return r.slice(0,a)}}class Ot extends oe{constructor(){super(),Ot.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){let r=arguments[0],a=arguments[1];if(oe.constructor_.call(this,a),r===null&&(r=[]),oe.hasNullElements(r))throw new u("geometries must not contain null elements");this._geometries=r}}}computeEnvelopeInternal(){const r=new nt;for(let a=0;a<this._geometries.length;a++)r.expandToInclude(this._geometries[a].getEnvelopeInternal());return r}getGeometryN(r){return this._geometries[r]}getCoordinates(){const r=new Array(this.getNumPoints()).fill(null);let a=-1;for(let p=0;p<this._geometries.length;p++){const _=this._geometries[p].getCoordinates();for(let C=0;C<_.length;C++)a++,r[a]=_[C]}return r}getArea(){let r=0;for(let a=0;a<this._geometries.length;a++)r+=this._geometries[a].getArea();return r}copyInternal(){const r=new Array(this._geometries.length).fill(null);for(let a=0;a<r.length;a++)r[a]=this._geometries[a].copy();return new Ot(r,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];if(!this.isEquivalentClass(r))return!1;const p=r;if(this._geometries.length!==p._geometries.length)return!1;for(let _=0;_<this._geometries.length;_++)if(!this._geometries[_].equalsExact(p._geometries[_],a))return!1;return!0}return super.equalsExact.apply(this,arguments)}reverseInternal(){const r=this._geometries.length,a=new $(r);for(let p=0;p<r;p++)a.add(this._geometries[p].reverse());return this.getFactory().buildGeometry(a)}getTypeCode(){return oe.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let r=se.FALSE;for(let a=0;a<this._geometries.length;a++)r=Math.max(r,this._geometries[a].getDimension());return r}getNumGeometries(){return this._geometries.length}getBoundary(){return oe.checkNotGeometryCollection(this),L.shouldNeverReachHere(),null}getGeometryType(){return oe.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let r=0;r<this._geometries.length;r++)if(!this._geometries[r].isEmpty())return!1;return!0}normalize(){for(let r=0;r<this._geometries.length;r++)this._geometries[r].normalize();Ft.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let r=se.FALSE;for(let a=0;a<this._geometries.length;a++)r=Math.max(r,this._geometries[a].getBoundaryDimension());return r}getLength(){let r=0;for(let a=0;a<this._geometries.length;a++)r+=this._geometries[a].getLength();return r}getNumPoints(){let r=0;for(let a=0;a<this._geometries.length;a++)r+=this._geometries[a].getNumPoints();return r}compareToSameClass(){if(arguments.length===1){const r=arguments[0],a=new Xn(Ft.asList(this._geometries)),p=new Xn(Ft.asList(r._geometries));return this.compare(a,p)}if(arguments.length===2){const r=arguments[1],a=arguments[0],p=this.getNumGeometries(),_=a.getNumGeometries();let C=0;for(;C<p&&C<_;){const k=this.getGeometryN(C),X=a.getGeometryN(C),J=k.compareToSameClass(X,r);if(J!==0)return J;C++}return C<p?1:C<_?-1:0}}apply(){if(pt(arguments[0],Ar)){const r=arguments[0];for(let a=0;a<this._geometries.length;a++)this._geometries[a].apply(r)}else if(pt(arguments[0],rt)){const r=arguments[0];if(this._geometries.length===0)return null;for(let a=0;a<this._geometries.length&&(this._geometries[a].apply(r),!r.isDone());a++);r.isGeometryChanged()&&this.geometryChanged()}else if(pt(arguments[0],wi)){const r=arguments[0];r.filter(this);for(let a=0;a<this._geometries.length;a++)this._geometries[a].apply(r)}else if(pt(arguments[0],Ue)){const r=arguments[0];r.filter(this);for(let a=0;a<this._geometries.length;a++)this._geometries[a].apply(r)}}}class Kt{}class ae extends Ot{constructor(){super(),ae.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ot.constructor_.call(this,r,a)}copyInternal(){const r=new Array(this._geometries.length).fill(null);for(let a=0;a<r.length;a++)r[a]=this._geometries[a].copy();return new ae(r,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];return!!this.isEquivalentClass(r)&&super.equalsExact.call(this,r,a)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return oe.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const r=new $;for(let p=0;p<this._geometries.length;p++){const _=this._geometries[p].getBoundary();for(let C=0;C<_.getNumGeometries();C++)r.add(_.getGeometryN(C))}const a=new Array(r.size()).fill(null);return this.getFactory().createMultiLineString(r.toArray(a))}getGeometryType(){return oe.TYPENAME_MULTIPOLYGON}get interfaces_(){return[Kt]}}let Ve=class{get(){}put(){}size(){}values(){}entrySet(){}};class Be extends eo{constructor(r){super(),this.map=new Map,r instanceof T&&this.addAll(r)}contains(r){const a=r.hashCode?r.hashCode():r;return!!this.map.has(a)}add(r){const a=r.hashCode?r.hashCode():r;return!this.map.has(a)&&!!this.map.set(a,r)}addAll(r){for(const a of r)this.add(a);return!0}remove(){throw new Fe}size(){return this.map.size}isEmpty(){return this.map.size===0}toArray(){return Array.from(this.map.values())}iterator(){return new Er(this.map)}[Symbol.iterator](){return this.map}}let Er=class{constructor(dt){this.iterator=dt.values();const{done:r,value:a}=this.iterator.next();this.done=r,this.value=a}next(){if(this.done)throw new ft;const dt=this.value,{done:r,value:a}=this.iterator.next();return this.done=r,this.value=a,dt}hasNext(){return!this.done}remove(){throw new Fe}};class br extends Ve{constructor(){super(),this.map=new Map}get(r){return this.map.get(r)||null}put(r,a){return this.map.set(r,a),a}values(){const r=new $,a=this.map.values();let p=a.next();for(;!p.done;)r.add(p.value),p=a.next();return r}entrySet(){const r=new Be;return this.map.entries().forEach(a=>r.add(a)),r}size(){return this.map.size()}}class Oe{constructor(){Oe.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=Oe.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof ur){const r=arguments[0];this._modelType=r,r===Oe.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){const r=arguments[0];this._modelType=Oe.FIXED,this.setScale(r)}else if(arguments[0]instanceof Oe){const r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}}static mostPrecise(r,a){return r.compareTo(a)>=0?r:a}equals(r){if(!(r instanceof Oe))return!1;const a=r;return this._modelType===a._modelType&&this._scale===a._scale}compareTo(r){const a=r,p=this.getMaximumSignificantDigits(),_=a.getMaximumSignificantDigits();return Mt.compare(p,_)}getType(){return this._modelType}toString(){let r="UNKNOWN";return this._modelType===Oe.FLOATING?r="Floating":this._modelType===Oe.FLOATING_SINGLE?r="Floating-Single":this._modelType===Oe.FIXED&&(r="Fixed (Scale="+this.getScale()+")"),r}makePrecise(){if(typeof arguments[0]=="number"){const r=arguments[0];return m.isNaN(r)||this._modelType===Oe.FLOATING_SINGLE?r:this._modelType===Oe.FIXED?Math.round(r*this._scale)/this._scale:r}if(arguments[0]instanceof O){const r=arguments[0];if(this._modelType===Oe.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}}getMaximumSignificantDigits(){let r=16;return this._modelType===Oe.FLOATING?r=16:this._modelType===Oe.FLOATING_SINGLE?r=6:this._modelType===Oe.FIXED&&(r=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),r}setScale(r){this._scale=Math.abs(r)}getScale(){return this._scale}isFloating(){return this._modelType===Oe.FLOATING||this._modelType===Oe.FLOATING_SINGLE}get interfaces_(){return[x,g]}}class ur{constructor(){ur.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const r=arguments[0];this._name=r,ur.nameToTypeMap.put(r,this)}readResolve(){return ur.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[x]}}ur.nameToTypeMap=new br,Oe.Type=ur,Oe.FIXED=new ur("FIXED"),Oe.FLOATING=new ur("FLOATING"),Oe.FLOATING_SINGLE=new ur("FLOATING SINGLE"),Oe.maximumPreciseValue=9007199254740992;class ar extends Ot{constructor(){super(),ar.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ot.constructor_.call(this,r,a)}copyInternal(){const r=new Array(this._geometries.length).fill(null);for(let a=0;a<r.length;a++)r[a]=this._geometries[a].copy();return new ar(r,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];return!!this.isEquivalentClass(r)&&super.equalsExact.call(this,r,a)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?se.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let r=0;r<this._geometries.length;r++)if(!this._geometries[r].isClosed())return!1;return!0}getTypeCode(){return oe.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new Fe}getGeometryType(){return oe.TYPENAME_MULTILINESTRING}get interfaces_(){return[vr]}}class ot{}class zt extends oe{constructor(){super(),zt.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const r=arguments[0],a=arguments[1];oe.constructor_.call(this,a),this.init(r)}computeEnvelopeInternal(){if(this.isEmpty())return new nt;const r=new nt;return r.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),r}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new zt(this._coordinates.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];return!!this.isEquivalentClass(r)&&(!(!this.isEmpty()||!r.isEmpty())||this.isEmpty()===r.isEmpty()&&this.equal(r.getCoordinate(),this.getCoordinate(),a))}return super.equalsExact.apply(this,arguments)}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return oe.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(this.getCoordinate()===null)throw new Vt("getX called on empty Point");return this.getCoordinate().x}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return oe.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(this.getCoordinate()===null)throw new Vt("getY called on empty Point");return this.getCoordinate().y}isSimple(){return!0}normalize(){}getCoordinate(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return se.FALSE}compareToSameClass(){if(arguments.length===1){const r=arguments[0];return this.getCoordinate().compareTo(r.getCoordinate())}if(arguments.length===2){const r=arguments[0];return arguments[1].compare(this._coordinates,r._coordinates)}}apply(){if(pt(arguments[0],Ar)){const r=arguments[0];if(this.isEmpty())return null;r.filter(this.getCoordinate())}else if(pt(arguments[0],rt)){const r=arguments[0];if(this.isEmpty())return null;r.filter(this._coordinates,0),r.isGeometryChanged()&&this.geometryChanged()}else pt(arguments[0],wi)?arguments[0].filter(this):pt(arguments[0],Ue)&&arguments[0].filter(this)}isEmpty(){return this._coordinates.size()===0}init(r){r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),L.isTrue(r.size()<=1),this._coordinates=r}get interfaces_(){return[ot]}}class Wt{static ofRingSigned(){if(arguments[0]instanceof Array){const r=arguments[0];if(r.length<3)return 0;let a=0;const p=r[0].x;for(let _=1;_<r.length-1;_++){const C=r[_].x-p,k=r[_+1].y;a+=C*(r[_-1].y-k)}return a/2}if(pt(arguments[0],ge)){const r=arguments[0],a=r.size();if(a<3)return 0;const p=new O,_=new O,C=new O;r.getCoordinate(0,_),r.getCoordinate(1,C);const k=_.x;C.x-=k;let X=0;for(let J=1;J<a-1;J++)p.y=_.y,_.x=C.x,_.y=C.y,r.getCoordinate(J+1,C),C.x-=k,X+=_.x*(p.y-C.y);return X/2}}static ofRing(){if(arguments[0]instanceof Array){const r=arguments[0];return Math.abs(Wt.ofRingSigned(r))}if(pt(arguments[0],ge)){const r=arguments[0];return Math.abs(Wt.ofRingSigned(r))}}}class Ut extends oe{constructor(){super(),Ut.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let r=arguments[0],a=arguments[1],p=arguments[2];if(oe.constructor_.call(this,p),r===null&&(r=this.getFactory().createLinearRing()),a===null&&(a=[]),oe.hasNullElements(a))throw new u("holes must not contain null elements");if(r.isEmpty()&&oe.hasNonEmptyElements(a))throw new u("shell is empty but holes are not");this._shell=r,this._holes=a}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const r=new Array(this.getNumPoints()).fill(null);let a=-1;const p=this._shell.getCoordinates();for(let _=0;_<p.length;_++)a++,r[a]=p[_];for(let _=0;_<this._holes.length;_++){const C=this._holes[_].getCoordinates();for(let k=0;k<C.length;k++)a++,r[a]=C[k]}return r}getArea(){let r=0;r+=Wt.ofRing(this._shell.getCoordinateSequence());for(let a=0;a<this._holes.length;a++)r-=Wt.ofRing(this._holes[a].getCoordinateSequence());return r}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];if(!this.isEquivalentClass(r))return!1;const p=r,_=this._shell,C=p._shell;if(!_.equalsExact(C,a)||this._holes.length!==p._holes.length)return!1;for(let k=0;k<this._holes.length;k++)if(!this._holes[k].equalsExact(p._holes[k],a))return!1;return!0}return super.equalsExact.apply(this,arguments)}reverseInternal(){const r=this.getExteriorRing().reverse(),a=new Array(this.getNumInteriorRing()).fill(null);for(let p=0;p<a.length;p++)a[p]=this.getInteriorRingN(p).reverse();return this.getFactory().createPolygon(r,a)}getTypeCode(){return oe.TYPECODE_POLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const r=new Array(this._holes.length+1).fill(null);r[0]=this._shell;for(let a=0;a<this._holes.length;a++)r[a+1]=this._holes[a];return r.length<=1?this.getFactory().createLinearRing(r[0].getCoordinateSequence()):this.getFactory().createMultiLineString(r)}getGeometryType(){return oe.TYPENAME_POLYGON}getExteriorRing(){return this._shell}copyInternal(){const r=this._shell.copy(),a=new Array(this._holes.length).fill(null);for(let p=0;p<this._holes.length;p++)a[p]=this._holes[p].copy();return new Ut(r,a,this._factory)}isRectangle(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;const r=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal();for(let C=0;C<5;C++){const k=r.getX(C);if(k!==a.getMinX()&&k!==a.getMaxX())return!1;const X=r.getY(C);if(X!==a.getMinY()&&X!==a.getMaxY())return!1}let p=r.getX(0),_=r.getY(0);for(let C=1;C<=4;C++){const k=r.getX(C),X=r.getY(C);if(k!==p==(X!==_))return!1;p=k,_=X}return!0}normalize(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(let r=0;r<this._holes.length;r++)this._holes[r]=this.normalized(this._holes[r],!1);Ft.sort(this._holes)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];if(r.isEmpty())return null;const p=r.getCoordinateSequence(),_=Kr.minCoordinateIndex(p,0,p.size()-2);Kr.scroll(p,_,!0),Yt.isCCW(p)===a&&Kr.reverse(p)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getLength(){let r=0;r+=this._shell.getLength();for(let a=0;a<this._holes.length;a++)r+=this._holes[a].getLength();return r}getNumPoints(){let r=this._shell.getNumPoints();for(let a=0;a<this._holes.length;a++)r+=this._holes[a].getNumPoints();return r}convexHull(){return this.getExteriorRing().convexHull()}normalized(r,a){const p=r.copy();return this.normalize(p,a),p}compareToSameClass(){if(arguments.length===1){const r=arguments[0],a=this._shell,p=r._shell;return a.compareToSameClass(p)}if(arguments.length===2){const r=arguments[1],a=arguments[0],p=this._shell,_=a._shell,C=p.compareToSameClass(_,r);if(C!==0)return C;const k=this.getNumInteriorRing(),X=a.getNumInteriorRing();let J=0;for(;J<k&&J<X;){const Ct=this.getInteriorRingN(J),te=a.getInteriorRingN(J),ce=Ct.compareToSameClass(te,r);if(ce!==0)return ce;J++}return J<k?1:J<X?-1:0}}apply(){if(pt(arguments[0],Ar)){const r=arguments[0];this._shell.apply(r);for(let a=0;a<this._holes.length;a++)this._holes[a].apply(r)}else if(pt(arguments[0],rt)){const r=arguments[0];if(this._shell.apply(r),!r.isDone())for(let a=0;a<this._holes.length&&(this._holes[a].apply(r),!r.isDone());a++);r.isGeometryChanged()&&this.geometryChanged()}else if(pt(arguments[0],wi))arguments[0].filter(this);else if(pt(arguments[0],Ue)){const r=arguments[0];r.filter(this),this._shell.apply(r);for(let a=0;a<this._holes.length;a++)this._holes[a].apply(r)}}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(r){return this._holes[r]}get interfaces_(){return[Kt]}}class ve extends Ot{constructor(){super(),ve.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ot.constructor_.call(this,r,a)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof oe){const r=arguments[0],a=arguments[1];return!!this.isEquivalentClass(r)&&super.equalsExact.call(this,r,a)}return super.equalsExact.apply(this,arguments)}getTypeCode(){return oe.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return oe.TYPENAME_MULTIPOINT}copyInternal(){const r=new Array(this._geometries.length).fill(null);for(let a=0;a<r.length;a++)r[a]=this._geometries[a].copy();return new ve(r,this._factory)}isValid(){return!0}getCoordinate(){if(arguments.length===1&&Number.isInteger(arguments[0])){const r=arguments[0];return this._geometries[r].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return se.FALSE}get interfaces_(){return[ot]}}class Se{constructor(){Se.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)Se.constructor_.call(this,new Oe,0);else if(arguments.length===1){if(pt(arguments[0],Or)){const r=arguments[0];Se.constructor_.call(this,new Oe,0,r)}else if(arguments[0]instanceof Oe){const r=arguments[0];Se.constructor_.call(this,r,0,Se.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];Se.constructor_.call(this,r,a,Se.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._precisionModel=r,this._coordinateSequenceFactory=p,this._SRID=a}}static toMultiPolygonArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toGeometryArray(r){if(r===null)return null;const a=new Array(r.size()).fill(null);return r.toArray(a)}static getDefaultCoordinateSequenceFactory(){return oi.instance()}static toMultiLineStringArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toLineStringArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toMultiPointArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toLinearRingArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toPointArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static toPolygonArray(r){const a=new Array(r.size()).fill(null);return r.toArray(a)}static createPointFromInternalCoord(r,a){return a.getPrecisionModel().makePrecise(r),a.getFactory().createPoint(r)}createEmpty(r){switch(r){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new u("Invalid dimension: "+r)}}toGeometry(r){return r.isNull()?this.createPoint():r.getMinX()===r.getMaxX()&&r.getMinY()===r.getMaxY()?this.createPoint(new O(r.getMinX(),r.getMinY())):r.getMinX()===r.getMaxX()||r.getMinY()===r.getMaxY()?this.createLineString([new O(r.getMinX(),r.getMinY()),new O(r.getMaxX(),r.getMaxY())]):this.createPolygon(this.createLinearRing([new O(r.getMinX(),r.getMinY()),new O(r.getMinX(),r.getMaxY()),new O(r.getMaxX(),r.getMaxY()),new O(r.getMaxX(),r.getMinY()),new O(r.getMinX(),r.getMinY())]),null)}createLineString(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const r=arguments[0];return this.createLineString(r!==null?this.getCoordinateSequenceFactory().create(r):null)}if(pt(arguments[0],ge))return new Ee(arguments[0],this)}}createMultiLineString(){if(arguments.length===0)return new ar(null,this);if(arguments.length===1)return new ar(arguments[0],this)}createPolygon(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(pt(arguments[0],ge)){const r=arguments[0];return this.createPolygon(this.createLinearRing(r))}if(arguments[0]instanceof Array){const r=arguments[0];return this.createPolygon(this.createLinearRing(r))}if(arguments[0]instanceof Sr){const r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2)return new Ut(arguments[0],arguments[1],this)}getSRID(){return this._SRID}createGeometryCollection(){if(arguments.length===0)return new Ot(null,this);if(arguments.length===1)return new Ot(arguments[0],this)}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const r=arguments[0];return this.createLinearRing(r!==null?this.getCoordinateSequenceFactory().create(r):null)}if(pt(arguments[0],ge))return new Sr(arguments[0],this)}}createMultiPolygon(){if(arguments.length===0)return new ae(null,this);if(arguments.length===1)return new ae(arguments[0],this)}createMultiPoint(){if(arguments.length===0)return new ve(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new ve(arguments[0],this);if(pt(arguments[0],ge)){const r=arguments[0];if(r===null)return this.createMultiPoint(new Array(0).fill(null));const a=new Array(r.size()).fill(null);for(let p=0;p<r.size();p++){const _=this.getCoordinateSequenceFactory().create(1,r.getDimension(),r.getMeasures());Kr.copy(r,p,_,0,1),a[p]=this.createPoint(_)}return this.createMultiPoint(a)}}}buildGeometry(r){let a=null,p=!1,_=!1;for(let k=r.iterator();k.hasNext();){const X=k.next(),J=X.getTypeCode();a===null&&(a=J),J!==a&&(p=!0),X instanceof Ot&&(_=!0)}if(a===null)return this.createGeometryCollection();if(p||_)return this.createGeometryCollection(Se.toGeometryArray(r));const C=r.iterator().next();if(r.size()>1){if(C instanceof Ut)return this.createMultiPolygon(Se.toPolygonArray(r));if(C instanceof Ee)return this.createMultiLineString(Se.toLineStringArray(r));if(C instanceof zt)return this.createMultiPoint(Se.toPointArray(r));L.shouldNeverReachHere("Unhandled geometry type: "+C.getGeometryType())}return C}createMultiPointFromCoords(r){return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}createPoint(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof O){const r=arguments[0];return this.createPoint(r!==null?this.getCoordinateSequenceFactory().create([r]):null)}if(pt(arguments[0],ge))return new zt(arguments[0],this)}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}get interfaces_(){return[x]}}const nr="XY",xr="XYZ",Me="XYM",ei="XYZM",fr={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Mr="EMPTY",hr=1,Vr=2,yi=3,Qr=4,Fi=5,ro=6;for(const dt in fr)fr[dt].toUpperCase();class Ln{constructor(r){this.wkt=r,this.index_=-1}isAlpha_(r){return r>="a"&&r<="z"||r>="A"&&r<="Z"}isNumeric_(r,a){return r>="0"&&r<="9"||r=="."&&!(a!==void 0&&a)}isWhiteSpace_(r){return r==" "||r=="	"||r=="\r"||r==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const r=this.nextChar_(),a=this.index_;let p,_=r;if(r=="(")p=Vr;else if(r==",")p=Fi;else if(r==")")p=yi;else if(this.isNumeric_(r)||r=="-")p=Qr,_=this.readNumber_();else if(this.isAlpha_(r))p=hr,_=this.readText_();else{if(this.isWhiteSpace_(r))return this.nextToken();if(r!=="")throw new Error("Unexpected character: "+r);p=ro}return{position:a,value:_,type:p}}readNumber_(){let r;const a=this.index_;let p=!1,_=!1;do r=="."?p=!0:r!="e"&&r!="E"||(_=!0),r=this.nextChar_();while(this.isNumeric_(r,p)||!_&&(r=="e"||r=="E")||_&&(r=="-"||r=="+"));return parseFloat(this.wkt.substring(a,this.index_--))}readText_(){let r;const a=this.index_;do r=this.nextChar_();while(this.isAlpha_(r));return this.wkt.substring(a,this.index_--).toUpperCase()}}class Di{constructor(r,a){this.lexer_=r,this.token_,this.layout_=nr,this.factory=a}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(r){return this.token_.type==r}match(r){const a=this.isTokenType(r);return a&&this.consume_(),a}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let r=nr;const a=this.token_;if(this.isTokenType(hr)){const p=a.value;p==="Z"?r=xr:p==="M"?r=Me:p==="ZM"&&(r=ei),r!==nr&&this.consume_()}return r}parseGeometryCollectionText_(){if(this.match(Vr)){const r=[];do r.push(this.parseGeometry_());while(this.match(Fi));if(this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(Vr)){const r=this.parsePoint_();if(this.match(yi))return r}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(Vr)){const r=this.parsePointList_();if(this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(Vr)){const r=this.parseLineStringTextList_();if(this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(Vr)){let r;if(r=this.token_.type==Vr?this.parsePointTextList_():this.parsePointList_(),this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(Vr)){const r=this.parseLineStringTextList_();if(this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(Vr)){const r=this.parsePolygonTextList_();if(this.match(yi))return r}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}parsePoint_(){const r=[],a=this.layout_.length;for(let p=0;p<a;++p){const _=this.token_;if(!this.match(Qr))break;r.push(_.value)}if(r.length==a)return r;throw new Error(this.formatErrorMessage_())}parsePointList_(){const r=[this.parsePoint_()];for(;this.match(Fi);)r.push(this.parsePoint_());return r}parsePointTextList_(){const r=[this.parsePointText_()];for(;this.match(Fi);)r.push(this.parsePointText_());return r}parseLineStringTextList_(){const r=[this.parseLineStringText_()];for(;this.match(Fi);)r.push(this.parseLineStringText_());return r}parsePolygonTextList_(){const r=[this.parsePolygonText_()];for(;this.match(Fi);)r.push(this.parsePolygonText_());return r}isEmptyGeometry_(){const r=this.isTokenType(hr)&&this.token_.value==Mr;return r&&this.consume_(),r}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const r=this.factory,a=C=>C?new O(...C):new O,p=C=>{const k=C.map(X=>r.createLinearRing(X.map(a)));return k.length>1?r.createPolygon(k[0],k.slice(1)):k.length===1?r.createPolygon(k[0]):r.createPolygon()},_=this.token_;if(this.match(hr)){const C=_.value;if(this.layout_=this.parseGeometryLayout_(),C=="GEOMETRYCOLLECTION"){const k=this.parseGeometryCollectionText_();return r.createGeometryCollection(k)}switch(C){case"POINT":{const k=this.parsePointText_();return k?r.createPoint(new O(...k)):r.createPoint()}case"LINESTRING":{const k=this.parseLineStringText_().map(a);return r.createLineString(k)}case"LINEARRING":{const k=this.parseLineStringText_().map(a);return r.createLinearRing(k)}case"POLYGON":{const k=this.parsePolygonText_();return k&&k.length!==0?p(k):r.createPolygon()}case"MULTIPOINT":{const k=this.parseMultiPointText_();if(!k||k.length===0)return r.createMultiPoint();const X=k.map(a).map(J=>r.createPoint(J));return r.createMultiPoint(X)}case"MULTILINESTRING":{const k=this.parseMultiLineStringText_().map(X=>r.createLineString(X.map(a)));return r.createMultiLineString(k)}case"MULTIPOLYGON":{const k=this.parseMultiPolygonText_();if(!k||k.length===0)return r.createMultiPolygon();const X=k.map(p);return r.createMultiPolygon(X)}default:throw new Error("Invalid geometry type: "+C)}}throw new Error(this.formatErrorMessage_())}}function un(dt){if(dt.isEmpty())return"";const r=dt.getCoordinate(),a=[r.x,r.y];return r.z===void 0||Number.isNaN(r.z)||a.push(r.z),r.m===void 0||Number.isNaN(r.m)||a.push(r.m),a.join(" ")}function Mi(dt){const r=dt.getCoordinates().map(p=>{const _=[p.x,p.y];return p.z===void 0||Number.isNaN(p.z)||_.push(p.z),p.m===void 0||Number.isNaN(p.m)||_.push(p.m),_}),a=[];for(let p=0,_=r.length;p<_;++p)a.push(r[p].join(" "));return a.join(", ")}function Qi(dt){const r=[];r.push("("+Mi(dt.getExteriorRing())+")");for(let a=0,p=dt.getNumInteriorRing();a<p;++a)r.push("("+Mi(dt.getInteriorRingN(a))+")");return r.join(", ")}const Qo={Point:un,LineString:Mi,LinearRing:Mi,Polygon:Qi,MultiPoint:function(dt){const r=[];for(let a=0,p=dt.getNumGeometries();a<p;++a)r.push("("+un(dt.getGeometryN(a))+")");return r.join(", ")},MultiLineString:function(dt){const r=[];for(let a=0,p=dt.getNumGeometries();a<p;++a)r.push("("+Mi(dt.getGeometryN(a))+")");return r.join(", ")},MultiPolygon:function(dt){const r=[];for(let a=0,p=dt.getNumGeometries();a<p;++a)r.push("("+Qi(dt.getGeometryN(a))+")");return r.join(", ")},GeometryCollection:function(dt){const r=[];for(let a=0,p=dt.getNumGeometries();a<p;++a)r.push(ci(dt.getGeometryN(a)));return r.join(", ")}};function ci(dt){let r=dt.getGeometryType();const a=Qo[r];r=r.toUpperCase();const p=function(_){let C="";if(_.isEmpty())return C;const k=_.getCoordinate();return k.z===void 0||Number.isNaN(k.z)||(C+="Z"),k.m===void 0||Number.isNaN(k.m)||(C+="M"),C}(dt);return p.length>0&&(r+=" "+p),dt.isEmpty()?r+" "+Mr:r+" ("+a(dt)+")"}class wn{constructor(r){this.geometryFactory=r||new Se,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(r){const a=new Ln(r);return new Di(a,this.geometryFactory).parse()}write(r){return ci(r)}}class vi{constructor(r){this.parser=new wn(r)}write(r){return this.parser.write(r)}static toLineString(r,a){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+r.x+" "+r.y+", "+a.x+" "+a.y+" )"}}class Jr{constructor(){Jr.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new O,this._intPt[1]=new O,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static nonRobustComputeEdgeDistance(r,a,p){const _=r.x-a.x,C=r.y-a.y,k=Math.sqrt(_*_+C*C);return L.isTrue(!(k===0&&!r.equals(a)),"Invalid distance calculation"),k}static computeEdgeDistance(r,a,p){const _=Math.abs(p.x-a.x),C=Math.abs(p.y-a.y);let k=-1;if(r.equals(a))k=0;else if(r.equals(p))k=_>C?_:C;else{const X=Math.abs(r.x-a.x),J=Math.abs(r.y-a.y);k=_>C?X:J,k!==0||r.equals(a)||(k=Math.max(X,J))}return L.isTrue(!(k===0&&!r.equals(a)),"Bad distance calculation"),k}computeIntersection(r,a,p,_){this._inputLines[0][0]=r,this._inputLines[0][1]=a,this._inputLines[1][0]=p,this._inputLines[1][1]=_,this._result=this.computeIntersect(r,a,p,_)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){const r=arguments[0];this.getEdgeDistance(r,0)>this.getEdgeDistance(r,1)?(this._intLineIndex[r][0]=0,this._intLineIndex[r][1]=1):(this._intLineIndex[r][0]=1,this._intLineIndex[r][1]=0)}}isInteriorIntersection(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){const r=arguments[0];for(let a=0;a<this._result;a++)if(!this._intPt[a].equals2D(this._inputLines[r][0])&&!this._intPt[a].equals2D(this._inputLines[r][1]))return!0;return!1}}getIntersection(r){return this._intPt[r]}getEdgeDistance(r,a){return Jr.computeEdgeDistance(this._intPt[a],this._inputLines[r][0],this._inputLines[r][1])}isCollinear(){return this._result===Jr.COLLINEAR_INTERSECTION}toString(){return vi.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+vi.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(r,a){return this._inputLines[r][a]}getIndexAlongSegment(r,a){return this.computeIntLineIndex(),this._intLineIndex[r][a]}getTopologySummary(){const r=new xn;return this.isEndPoint()&&r.append(" endpoint"),this._isProper&&r.append(" proper"),this.isCollinear()&&r.append(" collinear"),r.toString()}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(r){this._precisionModel=r}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==Jr.NO_INTERSECTION}isIntersection(r){for(let a=0;a<this._result;a++)if(this._intPt[a].equals2D(r))return!0;return!1}getIntersectionAlongSegment(r,a){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[r][a]]}}Jr.DONT_INTERSECT=0,Jr.DO_INTERSECT=1,Jr.COLLINEAR=2,Jr.NO_INTERSECTION=0,Jr.POINT_INTERSECTION=1,Jr.COLLINEAR_INTERSECTION=2;class tn extends Jr{constructor(){super()}static nearestEndpoint(r,a,p,_){let C=r,k=je.pointToSegment(r,p,_),X=je.pointToSegment(a,p,_);return X<k&&(k=X,C=a),X=je.pointToSegment(p,r,a),X<k&&(k=X,C=p),X=je.pointToSegment(_,r,a),X<k&&(k=X,C=_),C}isInSegmentEnvelopes(r){const a=new nt(this._inputLines[0][0],this._inputLines[0][1]),p=new nt(this._inputLines[1][0],this._inputLines[1][1]);return a.contains(r)&&p.contains(r)}computeIntersection(){if(arguments.length!==3)return super.computeIntersection.apply(this,arguments);{const r=arguments[0],a=arguments[1],p=arguments[2];if(this._isProper=!1,nt.intersects(a,p,r)&&Yt.index(a,p,r)===0&&Yt.index(p,a,r)===0)return this._isProper=!0,(r.equals(a)||r.equals(p))&&(this._isProper=!1),this._result=Jr.POINT_INTERSECTION,null;this._result=Jr.NO_INTERSECTION}}intersection(r,a,p,_){let C=this.intersectionSafe(r,a,p,_);return this.isInSegmentEnvelopes(C)||(C=new O(tn.nearestEndpoint(r,a,p,_))),this._precisionModel!==null&&this._precisionModel.makePrecise(C),C}checkDD(r,a,p,_,C){const k=Ne.intersection(r,a,p,_),X=this.isInSegmentEnvelopes(k);ne.out.println("DD in env = "+X+"  --------------------- "+k),C.distance(k)>1e-4&&ne.out.println("Distance = "+C.distance(k))}intersectionSafe(r,a,p,_){let C=ue.intersection(r,a,p,_);return C===null&&(C=tn.nearestEndpoint(r,a,p,_)),C}computeCollinearIntersection(r,a,p,_){const C=nt.intersects(r,a,p),k=nt.intersects(r,a,_),X=nt.intersects(p,_,r),J=nt.intersects(p,_,a);return C&&k?(this._intPt[0]=p,this._intPt[1]=_,Jr.COLLINEAR_INTERSECTION):X&&J?(this._intPt[0]=r,this._intPt[1]=a,Jr.COLLINEAR_INTERSECTION):C&&X?(this._intPt[0]=p,this._intPt[1]=r,!p.equals(r)||k||J?Jr.COLLINEAR_INTERSECTION:Jr.POINT_INTERSECTION):C&&J?(this._intPt[0]=p,this._intPt[1]=a,!p.equals(a)||k||X?Jr.COLLINEAR_INTERSECTION:Jr.POINT_INTERSECTION):k&&X?(this._intPt[0]=_,this._intPt[1]=r,!_.equals(r)||C||J?Jr.COLLINEAR_INTERSECTION:Jr.POINT_INTERSECTION):k&&J?(this._intPt[0]=_,this._intPt[1]=a,!_.equals(a)||C||X?Jr.COLLINEAR_INTERSECTION:Jr.POINT_INTERSECTION):Jr.NO_INTERSECTION}computeIntersect(r,a,p,_){if(this._isProper=!1,!nt.intersects(r,a,p,_))return Jr.NO_INTERSECTION;const C=Yt.index(r,a,p),k=Yt.index(r,a,_);if(C>0&&k>0||C<0&&k<0)return Jr.NO_INTERSECTION;const X=Yt.index(p,_,r),J=Yt.index(p,_,a);return X>0&&J>0||X<0&&J<0?Jr.NO_INTERSECTION:C===0&&k===0&&X===0&&J===0?this.computeCollinearIntersection(r,a,p,_):(C===0||k===0||X===0||J===0?(this._isProper=!1,r.equals2D(p)||r.equals2D(_)?this._intPt[0]=r:a.equals2D(p)||a.equals2D(_)?this._intPt[0]=a:C===0?this._intPt[0]=new O(p):k===0?this._intPt[0]=new O(_):X===0?this._intPt[0]=new O(r):J===0&&(this._intPt[0]=new O(a))):(this._isProper=!0,this._intPt[0]=this.intersection(r,a,p,_)),Jr.POINT_INTERSECTION)}}class gr{constructor(){gr.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,arguments.length===0)gr.constructor_.call(this,new O,new O);else if(arguments.length===1){const r=arguments[0];gr.constructor_.call(this,r.p0,r.p1)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.p0=r,this.p1=a}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];gr.constructor_.call(this,new O(r,a),new O(p,_))}}static midPoint(r,a){return new O((r.x+a.x)/2,(r.y+a.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof gr){const r=arguments[0],a=Yt.index(this.p0,this.p1,r.p0),p=Yt.index(this.p0,this.p1,r.p1);return a>=0&&p>=0||a<=0&&p<=0?Math.max(a,p):0}if(arguments[0]instanceof O){const r=arguments[0];return Yt.index(this.p0,this.p1,r)}}toGeometry(r){return r.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return gr.midPoint(this.p0,this.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(r,a){const p=this.p0.x+r*(this.p1.x-this.p0.x),_=this.p0.y+r*(this.p1.y-this.p0.y),C=this.p1.x-this.p0.x,k=this.p1.y-this.p0.y,X=Math.sqrt(C*C+k*k);let J=0,Ct=0;if(a!==0){if(X<=0)throw new Vt("Cannot compute offset from zero-length line segment");J=a*C/X,Ct=a*k/X}return new O(p-Ct,_+J)}setCoordinates(){if(arguments.length===1){const r=arguments[0];this.setCoordinates(r.p0,r.p1)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.p0.x=r.x,this.p0.y=r.y,this.p1.x=a.x,this.p1.y=a.y}}segmentFraction(r){let a=this.projectionFactor(r);return a<0?a=0:(a>1||m.isNaN(a))&&(a=1),a}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}distance(){if(arguments[0]instanceof gr){const r=arguments[0];return je.segmentToSegment(this.p0,this.p1,r.p0,r.p1)}if(arguments[0]instanceof O){const r=arguments[0];return je.pointToSegment(r,this.p0,this.p1)}}equals(r){if(!(r instanceof gr))return!1;const a=r;return this.p0.equals(a.p0)&&this.p1.equals(a.p1)}intersection(r){const a=new tn;return a.computeIntersection(this.p0,this.p1,r.p0,r.p1),a.hasIntersection()?a.getIntersection(0):null}project(){if(arguments[0]instanceof O){const r=arguments[0];if(r.equals(this.p0)||r.equals(this.p1))return new O(r);const a=this.projectionFactor(r),p=new O;return p.x=this.p0.x+a*(this.p1.x-this.p0.x),p.y=this.p0.y+a*(this.p1.y-this.p0.y),p}if(arguments[0]instanceof gr){const r=arguments[0],a=this.projectionFactor(r.p0),p=this.projectionFactor(r.p1);if(a>=1&&p>=1||a<=0&&p<=0)return null;let _=this.project(r.p0);a<0&&(_=this.p0),a>1&&(_=this.p1);let C=this.project(r.p1);return p<0&&(C=this.p0),p>1&&(C=this.p1),new gr(_,C)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(r){return r===0?this.p0:this.p1}distancePerpendicular(r){return je.pointToLinePerpendicular(r,this.p0,this.p1)}closestPoint(r){const a=this.projectionFactor(r);return a>0&&a<1?this.project(r):this.p0.distance(r)<this.p1.distance(r)?this.p0:this.p1}projectionFactor(r){if(r.equals(this.p0))return 0;if(r.equals(this.p1))return 1;const a=this.p1.x-this.p0.x,p=this.p1.y-this.p0.y,_=a*a+p*p;return _<=0?m.NaN:((r.x-this.p0.x)*a+(r.y-this.p0.y)*p)/_}closestPoints(r){const a=this.intersection(r);if(a!==null)return[a,a];const p=new Array(2).fill(null);let _=m.MAX_VALUE,C=null;const k=this.closestPoint(r.p0);_=k.distance(r.p0),p[0]=k,p[1]=r.p0;const X=this.closestPoint(r.p1);C=X.distance(r.p1),C<_&&(_=C,p[0]=X,p[1]=r.p1);const J=r.closestPoint(this.p0);C=J.distance(this.p0),C<_&&(_=C,p[0]=this.p0,p[1]=J);const Ct=r.closestPoint(this.p1);return C=Ct.distance(this.p1),C<_&&(_=C,p[0]=this.p1,p[1]=Ct),p}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(r){const a=r,p=this.p0.compareTo(a.p0);return p!==0?p:this.p1.compareTo(a.p1)}reverse(){const r=this.p0;this.p0=this.p1,this.p1=r}equalsTopo(r){return this.p0.equals(r.p0)&&this.p1.equals(r.p1)||this.p0.equals(r.p1)&&this.p1.equals(r.p0)}lineIntersection(r){return ue.intersection(this.p0,this.p1,r.p0,r.p1)}isHorizontal(){return this.p0.y===this.p1.y}reflect(r){const a=this.p1.getY()-this.p0.getY(),p=this.p0.getX()-this.p1.getX(),_=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),C=a*a+p*p,k=a*a-p*p,X=r.getX(),J=r.getY();return new O((-k*X-2*a*p*J-2*a*_)/C,(k*J-2*a*p*X-2*p*_)/C)}pointAlong(r){const a=new O;return a.x=this.p0.x+r*(this.p1.x-this.p0.x),a.y=this.p0.y+r*(this.p1.y-this.p0.y),a}hashCode(){let r=m.doubleToLongBits(this.p0.x);r^=31*m.doubleToLongBits(this.p0.y);const a=Math.trunc(r)^Math.trunc(r>>32);let p=m.doubleToLongBits(this.p1.x);return p^=31*m.doubleToLongBits(this.p1.y),a^(Math.trunc(p)^Math.trunc(p>>32))}get interfaces_(){return[g,x]}}class St{static toLocationSymbol(r){switch(r){case St.EXTERIOR:return"e";case St.BOUNDARY:return"b";case St.INTERIOR:return"i";case St.NONE:return"-"}throw new u("Unknown location value: "+r)}}St.INTERIOR=0,St.BOUNDARY=1,St.EXTERIOR=2,St.NONE=-1;class _i{constructor(){_i.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(se.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){const r=arguments[0];_i.constructor_.call(this),this.set(r)}else if(arguments[0]instanceof _i){const r=arguments[0];_i.constructor_.call(this),this._matrix[St.INTERIOR][St.INTERIOR]=r._matrix[St.INTERIOR][St.INTERIOR],this._matrix[St.INTERIOR][St.BOUNDARY]=r._matrix[St.INTERIOR][St.BOUNDARY],this._matrix[St.INTERIOR][St.EXTERIOR]=r._matrix[St.INTERIOR][St.EXTERIOR],this._matrix[St.BOUNDARY][St.INTERIOR]=r._matrix[St.BOUNDARY][St.INTERIOR],this._matrix[St.BOUNDARY][St.BOUNDARY]=r._matrix[St.BOUNDARY][St.BOUNDARY],this._matrix[St.BOUNDARY][St.EXTERIOR]=r._matrix[St.BOUNDARY][St.EXTERIOR],this._matrix[St.EXTERIOR][St.INTERIOR]=r._matrix[St.EXTERIOR][St.INTERIOR],this._matrix[St.EXTERIOR][St.BOUNDARY]=r._matrix[St.EXTERIOR][St.BOUNDARY],this._matrix[St.EXTERIOR][St.EXTERIOR]=r._matrix[St.EXTERIOR][St.EXTERIOR]}}}static isTrue(r){return r>=0||r===se.TRUE}static matches(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){const r=arguments[0],a=arguments[1];return a===se.SYM_DONTCARE||a===se.SYM_TRUE&&(r>=0||r===se.TRUE)||a===se.SYM_FALSE&&r===se.FALSE||a===se.SYM_P&&r===se.P||a===se.SYM_L&&r===se.L||a===se.SYM_A&&r===se.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){const r=arguments[1];return new _i(arguments[0]).matches(r)}}isIntersects(){return!this.isDisjoint()}set(){if(arguments.length===1){const r=arguments[0];for(let a=0;a<r.length;a++){const p=Math.trunc(a/3),_=a%3;this._matrix[p][_]=se.toDimensionValue(r.charAt(a))}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._matrix[r][a]=p}}isContains(){return _i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&this._matrix[St.EXTERIOR][St.INTERIOR]===se.FALSE&&this._matrix[St.EXTERIOR][St.BOUNDARY]===se.FALSE}isWithin(){return _i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&this._matrix[St.INTERIOR][St.EXTERIOR]===se.FALSE&&this._matrix[St.BOUNDARY][St.EXTERIOR]===se.FALSE}isTouches(r,a){return r>a?this.isTouches(a,r):(r===se.A&&a===se.A||r===se.L&&a===se.L||r===se.L&&a===se.A||r===se.P&&a===se.A||r===se.P&&a===se.L)&&this._matrix[St.INTERIOR][St.INTERIOR]===se.FALSE&&(_i.isTrue(this._matrix[St.INTERIOR][St.BOUNDARY])||_i.isTrue(this._matrix[St.BOUNDARY][St.INTERIOR])||_i.isTrue(this._matrix[St.BOUNDARY][St.BOUNDARY]))}isOverlaps(r,a){return r===se.P&&a===se.P||r===se.A&&a===se.A?_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&_i.isTrue(this._matrix[St.INTERIOR][St.EXTERIOR])&&_i.isTrue(this._matrix[St.EXTERIOR][St.INTERIOR]):r===se.L&&a===se.L&&this._matrix[St.INTERIOR][St.INTERIOR]===1&&_i.isTrue(this._matrix[St.INTERIOR][St.EXTERIOR])&&_i.isTrue(this._matrix[St.EXTERIOR][St.INTERIOR])}isEquals(r,a){return r===a&&_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&this._matrix[St.INTERIOR][St.EXTERIOR]===se.FALSE&&this._matrix[St.BOUNDARY][St.EXTERIOR]===se.FALSE&&this._matrix[St.EXTERIOR][St.INTERIOR]===se.FALSE&&this._matrix[St.EXTERIOR][St.BOUNDARY]===se.FALSE}matches(r){if(r.length!==9)throw new u("Should be length 9: "+r);for(let a=0;a<3;a++)for(let p=0;p<3;p++)if(!_i.matches(this._matrix[a][p],r.charAt(3*a+p)))return!1;return!0}add(r){for(let a=0;a<3;a++)for(let p=0;p<3;p++)this.setAtLeast(a,p,r.get(a,p))}isDisjoint(){return this._matrix[St.INTERIOR][St.INTERIOR]===se.FALSE&&this._matrix[St.INTERIOR][St.BOUNDARY]===se.FALSE&&this._matrix[St.BOUNDARY][St.INTERIOR]===se.FALSE&&this._matrix[St.BOUNDARY][St.BOUNDARY]===se.FALSE}isCrosses(r,a){return r===se.P&&a===se.L||r===se.P&&a===se.A||r===se.L&&a===se.A?_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&_i.isTrue(this._matrix[St.INTERIOR][St.EXTERIOR]):r===se.L&&a===se.P||r===se.A&&a===se.P||r===se.A&&a===se.L?_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])&&_i.isTrue(this._matrix[St.EXTERIOR][St.INTERIOR]):r===se.L&&a===se.L&&this._matrix[St.INTERIOR][St.INTERIOR]===0}isCovers(){return(_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])||_i.isTrue(this._matrix[St.INTERIOR][St.BOUNDARY])||_i.isTrue(this._matrix[St.BOUNDARY][St.INTERIOR])||_i.isTrue(this._matrix[St.BOUNDARY][St.BOUNDARY]))&&this._matrix[St.EXTERIOR][St.INTERIOR]===se.FALSE&&this._matrix[St.EXTERIOR][St.BOUNDARY]===se.FALSE}isCoveredBy(){return(_i.isTrue(this._matrix[St.INTERIOR][St.INTERIOR])||_i.isTrue(this._matrix[St.INTERIOR][St.BOUNDARY])||_i.isTrue(this._matrix[St.BOUNDARY][St.INTERIOR])||_i.isTrue(this._matrix[St.BOUNDARY][St.BOUNDARY]))&&this._matrix[St.INTERIOR][St.EXTERIOR]===se.FALSE&&this._matrix[St.BOUNDARY][St.EXTERIOR]===se.FALSE}setAtLeast(){if(arguments.length===1){const r=arguments[0];for(let a=0;a<r.length;a++){const p=Math.trunc(a/3),_=a%3;this.setAtLeast(p,_,se.toDimensionValue(r.charAt(a)))}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._matrix[r][a]<p&&(this._matrix[r][a]=p)}}setAtLeastIfValid(r,a,p){r>=0&&a>=0&&this.setAtLeast(r,a,p)}toString(){const r=new xn("123456789");for(let a=0;a<3;a++)for(let p=0;p<3;p++)r.setCharAt(3*a+p,se.toDimensionSymbol(this._matrix[a][p]));return r.toString()}setAll(r){for(let a=0;a<3;a++)for(let p=0;p<3;p++)this._matrix[a][p]=r}get(r,a){return this._matrix[r][a]}transpose(){let r=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=r,r=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=r,r=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=r,this}get interfaces_(){return[F]}}class Wr{static toDegrees(r){return 180*r/Math.PI}static isAcute(r,a,p){const _=r.x-a.x,C=r.y-a.y;return _*(p.x-a.x)+C*(p.y-a.y)>0}static isObtuse(r,a,p){const _=r.x-a.x,C=r.y-a.y;return _*(p.x-a.x)+C*(p.y-a.y)<0}static interiorAngle(r,a,p){const _=Wr.angle(a,r),C=Wr.angle(a,p);return Math.abs(C-_)}static normalizePositive(r){if(r<0){for(;r<0;)r+=Wr.PI_TIMES_2;r>=Wr.PI_TIMES_2&&(r=0)}else{for(;r>=Wr.PI_TIMES_2;)r-=Wr.PI_TIMES_2;r<0&&(r=0)}return r}static angleBetween(r,a,p){const _=Wr.angle(a,r),C=Wr.angle(a,p);return Wr.diff(_,C)}static diff(r,a){let p=null;return p=r<a?a-r:r-a,p>Math.PI&&(p=2*Math.PI-p),p}static toRadians(r){return r*Math.PI/180}static normalize(r){for(;r>Math.PI;)r-=Wr.PI_TIMES_2;for(;r<=-Math.PI;)r+=Wr.PI_TIMES_2;return r}static angle(){if(arguments.length===1){const r=arguments[0];return Math.atan2(r.y,r.x)}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=a.x-r.x,_=a.y-r.y;return Math.atan2(_,p)}}static getTurn(r,a){const p=Math.sin(a-r);return p>0?Wr.COUNTERCLOCKWISE:p<0?Wr.CLOCKWISE:Wr.NONE}static angleBetweenOriented(r,a,p){const _=Wr.angle(a,r),C=Wr.angle(a,p)-_;return C<=-Math.PI?C+Wr.PI_TIMES_2:C>Math.PI?C-Wr.PI_TIMES_2:C}}Wr.PI_TIMES_2=2*Math.PI,Wr.PI_OVER_2=Math.PI/2,Wr.PI_OVER_4=Math.PI/4,Wr.COUNTERCLOCKWISE=Yt.COUNTERCLOCKWISE,Wr.CLOCKWISE=Yt.CLOCKWISE,Wr.NONE=Yt.COLLINEAR;class Vs extends h{constructor(){super(),Vs.constructor_.apply(this,arguments)}static constructor_(){h.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class In{constructor(){In.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){const r=arguments[0];this.x=r.x,this.y=r.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];this.x=r,this.y=a,this.w=1}else if(arguments[0]instanceof In&&arguments[1]instanceof In){const r=arguments[0],a=arguments[1];this.x=r.y*a.w-a.y*r.w,this.y=a.x*r.w-r.x*a.w,this.w=r.x*a.y-a.x*r.y}else if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1];this.x=r.y-a.y,this.y=a.x-r.x,this.w=r.x*a.y-a.x*r.y}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this.x=r,this.y=a,this.w=p}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=r.y-a.y,k=a.x-r.x,X=r.x*a.y-a.x*r.y,J=p.y-_.y,Ct=_.x-p.x,te=p.x*_.y-_.x*p.y;this.x=k*te-Ct*X,this.y=J*X-C*te,this.w=C*Ct-J*k}}getCoordinate(){const r=new O;return r.x=this.getX(),r.y=this.getY(),r}getX(){const r=this.x/this.w;if(m.isNaN(r)||m.isInfinite(r))throw new Vs;return r}getY(){const r=this.y/this.w;if(m.isNaN(r)||m.isInfinite(r))throw new Vs;return r}}class qi{constructor(){qi.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;const r=arguments[0],a=arguments[1],p=arguments[2];this.p0=r,this.p1=a,this.p2=p}static isAcute(r,a,p){return!!Wr.isAcute(r,a,p)&&!!Wr.isAcute(a,p,r)&&!!Wr.isAcute(p,r,a)}static circumcentre(r,a,p){const _=p.x,C=p.y,k=r.x-_,X=r.y-C,J=a.x-_,Ct=a.y-C,te=2*qi.det(k,X,J,Ct),ce=qi.det(X,k*k+X*X,Ct,J*J+Ct*Ct),Ye=qi.det(k,k*k+X*X,J,J*J+Ct*Ct);return new O(_-ce/te,C+Ye/te)}static perpendicularBisector(r,a){const p=a.x-r.x,_=a.y-r.y,C=new In(r.x+p/2,r.y+_/2,1),k=new In(r.x-_+p/2,r.y+p+_/2,1);return new In(C,k)}static angleBisector(r,a,p){const _=a.distance(r),C=_/(_+a.distance(p)),k=p.x-r.x,X=p.y-r.y;return new O(r.x+C*k,r.y+C*X)}static inCentre(r,a,p){const _=a.distance(p),C=r.distance(p),k=r.distance(a),X=_+C+k,J=(_*r.x+C*a.x+k*p.x)/X,Ct=(_*r.y+C*a.y+k*p.y)/X;return new O(J,Ct)}static area(r,a,p){return Math.abs(((p.x-r.x)*(a.y-r.y)-(a.x-r.x)*(p.y-r.y))/2)}static signedArea(r,a,p){return((p.x-r.x)*(a.y-r.y)-(a.x-r.x)*(p.y-r.y))/2}static det(r,a,p,_){return r*_-a*p}static interpolateZ(r,a,p,_){const C=a.x,k=a.y,X=p.x-C,J=_.x-C,Ct=p.y-k,te=_.y-k,ce=X*te-J*Ct,Ye=r.x-C,sr=r.y-k,Cr=(te*Ye-J*sr)/ce,Ii=(-Ct*Ye+X*sr)/ce;return a.getZ()+Cr*(p.getZ()-a.getZ())+Ii*(_.getZ()-a.getZ())}static longestSideLength(r,a,p){const _=r.distance(a),C=a.distance(p),k=p.distance(r);let X=_;return C>X&&(X=C),k>X&&(X=k),X}static circumcentreDD(r,a,p){const _=Lt.valueOf(r.x).subtract(p.x),C=Lt.valueOf(r.y).subtract(p.y),k=Lt.valueOf(a.x).subtract(p.x),X=Lt.valueOf(a.y).subtract(p.y),J=Lt.determinant(_,C,k,X).multiply(2),Ct=_.sqr().add(C.sqr()),te=k.sqr().add(X.sqr()),ce=Lt.determinant(C,Ct,X,te),Ye=Lt.determinant(_,Ct,k,te),sr=Lt.valueOf(p.x).subtract(ce.divide(J)).doubleValue(),Cr=Lt.valueOf(p.y).add(Ye.divide(J)).doubleValue();return new O(sr,Cr)}static area3D(r,a,p){const _=a.x-r.x,C=a.y-r.y,k=a.getZ()-r.getZ(),X=p.x-r.x,J=p.y-r.y,Ct=p.getZ()-r.getZ(),te=C*Ct-k*J,ce=k*X-_*Ct,Ye=_*J-C*X,sr=te*te+ce*ce+Ye*Ye;return Math.sqrt(sr)/2}static centroid(r,a,p){const _=(r.x+a.x+p.x)/3,C=(r.y+a.y+p.y)/3;return new O(_,C)}interpolateZ(r){if(r===null)throw new u("Supplied point is null.");return qi.interpolateZ(r,this.p0,this.p1,this.p2)}longestSideLength(){return qi.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return qi.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return qi.circumcentre(this.p0,this.p1,this.p2)}inCentre(){return qi.inCentre(this.p0,this.p1,this.p2)}area(){return qi.area(this.p0,this.p1,this.p2)}signedArea(){return qi.signedArea(this.p0,this.p1,this.p2)}area3D(){return qi.area3D(this.p0,this.p1,this.p2)}centroid(){return qi.centroid(this.p0,this.p1,this.p2)}}class vo extends h{constructor(){super(),vo.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)h.constructor_.call(this);else if(arguments.length===1){const r=arguments[0];h.constructor_.call(this,r)}}}class xi{constructor(){xi.constructor_.apply(this,arguments)}static constructor_(){if(this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null,arguments.length===0)this.setToIdentity();else if(arguments.length===1){if(arguments[0]instanceof Array){const r=arguments[0];this._m00=r[0],this._m01=r[1],this._m02=r[2],this._m10=r[3],this._m11=r[4],this._m12=r[5]}else if(arguments[0]instanceof xi){const r=arguments[0];this.setTransformation(r)}}else if(arguments.length===6&&typeof arguments[5]=="number"&&typeof arguments[4]=="number"&&typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];this.setTransformation(r,a,p,_,C,k)}}static translationInstance(r,a){const p=new xi;return p.setToTranslation(r,a),p}static shearInstance(r,a){const p=new xi;return p.setToShear(r,a),p}static reflectionInstance(){if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new xi;return p.setToReflection(r,a),p}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=new xi;return C.setToReflection(r,a,p,_),C}}static rotationInstance(){if(arguments.length===1){const r=arguments[0];return xi.rotationInstance(Math.sin(r),Math.cos(r))}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new xi;return p.setToRotation(r,a),p}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return xi.rotationInstance(Math.sin(r),Math.cos(r),a,p)}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=new xi;return C.setToRotation(r,a,p,_),C}}static scaleInstance(){if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new xi;return p.setToScale(r,a),p}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=new xi;return C.translate(-p,-_),C.scale(r,a),C.translate(p,_),C}}setToReflectionBasic(r,a,p,_){if(r===p&&a===_)throw new u("Reflection line points must be distinct");const C=p-r,k=_-a,X=Math.sqrt(C*C+k*k),J=k/X,Ct=C/X,te=2*J*Ct,ce=Ct*Ct-J*J;return this._m00=ce,this._m01=te,this._m02=0,this._m10=te,this._m11=-ce,this._m12=0,this}setToRotation(){if(arguments.length===1){const r=arguments[0];return this.setToRotation(Math.sin(r),Math.cos(r)),this}if(arguments.length===2){const r=arguments[0],a=arguments[1];return this._m00=a,this._m01=-r,this._m02=0,this._m10=r,this._m11=a,this._m12=0,this}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return this.setToRotation(Math.sin(r),Math.cos(r),a,p),this}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];return this._m00=a,this._m01=-r,this._m02=p-p*a+_*r,this._m10=r,this._m11=a,this._m12=_-p*r-_*a,this}}getMatrixEntries(){return[this._m00,this._m01,this._m02,this._m10,this._m11,this._m12]}filter(r,a){this.transform(r,a)}composeBefore(r){const a=this._m00*r._m00+this._m01*r._m10,p=this._m00*r._m01+this._m01*r._m11,_=this._m00*r._m02+this._m01*r._m12+this._m02,C=this._m10*r._m00+this._m11*r._m10,k=this._m10*r._m01+this._m11*r._m11,X=this._m10*r._m02+this._m11*r._m12+this._m12;return this._m00=a,this._m01=p,this._m02=_,this._m10=C,this._m11=k,this._m12=X,this}clone(){try{return null}catch(r){if(!(r instanceof h))throw r;L.shouldNeverReachHere()}return null}translate(r,a){return this.compose(xi.translationInstance(r,a)),this}setToReflection(){if(arguments.length===2){const r=arguments[0],a=arguments[1];if(r===0&&a===0)throw new u("Reflection vector must be non-zero");if(r===a)return this._m00=0,this._m01=1,this._m02=0,this._m10=1,this._m11=0,this._m12=0,this;const p=Math.sqrt(r*r+a*a),_=a/p,C=r/p;return this.rotate(-_,C),this.scale(1,-1),this.rotate(_,C),this}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];if(r===p&&a===_)throw new u("Reflection line points must be distinct");this.setToTranslation(-r,-a);const C=p-r,k=_-a,X=Math.sqrt(C*C+k*k),J=k/X,Ct=C/X;return this.rotate(-J,Ct),this.scale(1,-1),this.rotate(J,Ct),this.translate(r,a),this}}shear(r,a){return this.compose(xi.shearInstance(r,a)),this}getInverse(){const r=this.getDeterminant();if(r===0)throw new vo("Transformation is non-invertible");const a=this._m11/r,p=-this._m10/r,_=-this._m01/r,C=this._m00/r,k=(this._m01*this._m12-this._m02*this._m11)/r,X=(-this._m00*this._m12+this._m10*this._m02)/r;return new xi(a,_,k,p,C,X)}compose(r){const a=r._m00*this._m00+r._m01*this._m10,p=r._m00*this._m01+r._m01*this._m11,_=r._m00*this._m02+r._m01*this._m12+r._m02,C=r._m10*this._m00+r._m11*this._m10,k=r._m10*this._m01+r._m11*this._m11,X=r._m10*this._m02+r._m11*this._m12+r._m12;return this._m00=a,this._m01=p,this._m02=_,this._m10=C,this._m11=k,this._m12=X,this}equals(r){if(r===null||!(r instanceof xi))return!1;const a=r;return this._m00===a._m00&&this._m01===a._m01&&this._m02===a._m02&&this._m10===a._m10&&this._m11===a._m11&&this._m12===a._m12}setToScale(r,a){return this._m00=r,this._m01=0,this._m02=0,this._m10=0,this._m11=a,this._m12=0,this}isIdentity(){return this._m00===1&&this._m01===0&&this._m02===0&&this._m10===0&&this._m11===1&&this._m12===0}scale(r,a){return this.compose(xi.scaleInstance(r,a)),this}setToIdentity(){return this._m00=1,this._m01=0,this._m02=0,this._m10=0,this._m11=1,this._m12=0,this}isGeometryChanged(){return!0}setTransformation(){if(arguments.length===1){const r=arguments[0];return this._m00=r._m00,this._m01=r._m01,this._m02=r._m02,this._m10=r._m10,this._m11=r._m11,this._m12=r._m12,this}if(arguments.length===6){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];return this._m00=r,this._m01=a,this._m02=p,this._m10=_,this._m11=C,this._m12=k,this}}rotate(){if(arguments.length===1){const r=arguments[0];return this.compose(xi.rotationInstance(r)),this}if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.compose(xi.rotationInstance(r,a)),this}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return this.compose(xi.rotationInstance(r,a,p)),this}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];return this.compose(xi.rotationInstance(r,a,p,_)),this}}getDeterminant(){return this._m00*this._m11-this._m01*this._m10}setToShear(r,a){return this._m00=1,this._m01=r,this._m02=0,this._m10=a,this._m11=1,this._m12=0,this}isDone(){return!1}toString(){return"AffineTransformation[["+this._m00+", "+this._m01+", "+this._m02+"], ["+this._m10+", "+this._m11+", "+this._m12+"]]"}setToTranslation(r,a){return this._m00=1,this._m01=0,this._m02=r,this._m10=0,this._m11=1,this._m12=a,this}transform(){if(arguments.length===1){const r=arguments[0].copy();return r.apply(this),r}if(arguments.length===2){if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=this._m00*r.x+this._m01*r.y+this._m02,_=this._m10*r.x+this._m11*r.y+this._m12;return a.x=p,a.y=_,a}if(pt(arguments[0],ge)&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=this._m00*r.getOrdinate(a,0)+this._m01*r.getOrdinate(a,1)+this._m02,_=this._m10*r.getOrdinate(a,0)+this._m11*r.getOrdinate(a,1)+this._m12;r.setOrdinate(a,0,p),r.setOrdinate(a,1,_)}}}reflect(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.compose(xi.reflectionInstance(r,a)),this}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];return this.compose(xi.reflectionInstance(r,a,p,_)),this}}get interfaces_(){return[F,rt]}}class Ei{static solve(r,a){const p=a.length;if(r.length!==p||r[0].length!==p)throw new u("Matrix A is incorrectly sized");for(let C=0;C<p;C++){let k=C;for(let X=C+1;X<p;X++)Math.abs(r[X][C])>Math.abs(r[k][C])&&(k=X);if(r[k][C]===0)return null;Ei.swapRows(r,C,k),Ei.swapRows(a,C,k);for(let X=C+1;X<p;X++){const J=r[X][C]/r[C][C];for(let Ct=p-1;Ct>=C;Ct--)r[X][Ct]-=r[C][Ct]*J;a[X]-=a[C]*J}}const _=new Array(p).fill(null);for(let C=p-1;C>=0;C--){let k=0;for(let X=C+1;X<p;X++)k+=r[C][X]*_[X];_[C]=(a[C]-k)/r[C][C]}return _}static swapRows(){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=arguments[2];if(a===p)return null;for(let _=0;_<r[0].length;_++){const C=r[a][_];r[a][_]=r[p][_],r[p][_]=C}}else if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const r=arguments[0],a=arguments[1],p=arguments[2];if(a===p)return null;const _=r[a];r[a]=r[p],r[p]=_}}}class hn{constructor(){hn.constructor_.apply(this,arguments)}static constructor_(){this._src0=null,this._src1=null,this._src2=null,this._dest0=null,this._dest1=null,this._dest2=null,this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null;const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];this._src0=r,this._src1=a,this._src2=p,this._dest0=_,this._dest1=C,this._dest2=k}compute(){const r=[this._dest0.x,this._dest1.x,this._dest2.x],a=this.solve(r);if(a===null)return!1;this._m00=a[0],this._m01=a[1],this._m02=a[2];const p=[this._dest0.y,this._dest1.y,this._dest2.y],_=this.solve(p);return _!==null&&(this._m10=_[0],this._m11=_[1],this._m12=_[2],!0)}getTransformation(){return this.compute()?new xi(this._m00,this._m01,this._m02,this._m10,this._m11,this._m12):null}solve(r){const a=[[this._src0.x,this._src0.y,1],[this._src1.x,this._src1.y,1],[this._src2.x,this._src2.y,1]];return Ei.solve(a,r)}}class Mn{static createFromBaseLines(r,a,p,_){const C=new O(r.x+_.x-p.x,r.y+_.y-p.y),k=Wr.angleBetweenOriented(a,r,C),X=a.distance(r),J=_.distance(p);if(X===0)return new xi;const Ct=J/X,te=xi.translationInstance(-r.x,-r.y);return te.rotate(k),te.scale(Ct,Ct),te.translate(p.x,p.y),te}static createFromControlVectors(){if(arguments.length===2){if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=a.x-r.x,_=a.y-r.y;return xi.translationInstance(p,_)}if(arguments[0]instanceof Array&&arguments[1]instanceof Array){const r=arguments[0],a=arguments[1];if(r.length!==a.length)throw new u("Src and Dest arrays are not the same length");if(r.length<=0)throw new u("Too few control points");if(r.length>3)throw new u("Too many control points");return r.length===1?Mn.createFromControlVectors(r[0],a[0]):r.length===2?Mn.createFromControlVectors(r[0],r[1],a[0],a[1]):Mn.createFromControlVectors(r[0],r[1],r[2],a[0],a[1],a[2])}}else{if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=new O(_.x-p.x,_.y-p.y),k=Wr.angleBetweenOriented(a,r,C),X=a.distance(r),J=_.distance(p);if(X===0)return null;const Ct=J/X,te=xi.translationInstance(-r.x,-r.y);return te.rotate(k),te.scale(Ct,Ct),te.translate(p.x,p.y),te}if(arguments.length===6)return new hn(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]).getTransformation()}}}class bt{constructor(){bt.constructor_.apply(this,arguments)}static constructor_(){this._coords=null;const r=arguments[0];this._coords=r}static getCoordinates(r){const a=new $;return r.apply(new bt(a)),a}filter(r){(r instanceof Ee||r instanceof zt)&&this._coords.add(r.getCoordinate())}get interfaces_(){return[Ue]}}class Gt{constructor(){Gt.constructor_.apply(this,arguments)}static constructor_(){this._mapOp=null;const r=arguments[0];this._mapOp=r}static map(r,a){return new Gt(a).map(r)}map(r){const a=new $;for(let p=0;p<r.getNumGeometries();p++){const _=this._mapOp.map(r.getGeometryN(p));_.isEmpty()||a.add(_)}return r.getFactory().createGeometryCollection(Se.toGeometryArray(a))}}class At{constructor(){At.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;const r=arguments[0];this._geomFactory=At.extractFactory(r),this._inputGeoms=r}static extractFactory(r){return r.isEmpty()?null:r.iterator().next().getFactory()}static createList(){if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new $;return p.add(r),p.add(a),p}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2],_=new $;return _.add(r),_.add(a),_.add(p),_}}static combine(){if(arguments.length===1)return new At(arguments[0]).combine();if(arguments.length===2){const r=arguments[0],a=arguments[1];return new At(At.createList(r,a)).combine()}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return new At(At.createList(r,a,p)).combine()}}extractElements(r,a){if(r===null)return null;for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p);this._skipEmpty&&_.isEmpty()||a.add(_)}}combine(){const r=new $;for(let a=this._inputGeoms.iterator();a.hasNext();){const p=a.next();this.extractElements(p,r)}return r.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(r)}}class Qt{constructor(){Qt.constructor_.apply(this,arguments)}static constructor_(){if(this._factory=null,this._isUserDataCopied=!1,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this._factory=r}}}setCopyUserData(r){this._isUserDataCopied=r}edit(r,a){if(r===null)return null;const p=this.editInternal(r,a);return this._isUserDataCopied&&p.setUserData(r.getUserData()),p}editInternal(r,a){return this._factory===null&&(this._factory=r.getFactory()),r instanceof Ot?this.editGeometryCollection(r,a):r instanceof Ut?this.editPolygon(r,a):r instanceof zt||r instanceof Ee?a.edit(r,this._factory):(L.shouldNeverReachHere("Unsupported Geometry type: "+r.getGeometryType()),null)}editGeometryCollection(r,a){const p=a.edit(r,this._factory),_=new $;for(let C=0;C<p.getNumGeometries();C++){const k=this.edit(p.getGeometryN(C),a);k===null||k.isEmpty()||_.add(k)}return p.getGeometryType()===oe.TYPENAME_MULTIPOINT?this._factory.createMultiPoint(_.toArray([])):p.getGeometryType()===oe.TYPENAME_MULTILINESTRING?this._factory.createMultiLineString(_.toArray([])):p.getGeometryType()===oe.TYPENAME_MULTIPOLYGON?this._factory.createMultiPolygon(_.toArray([])):this._factory.createGeometryCollection(_.toArray([]))}editPolygon(r,a){let p=a.edit(r,this._factory);if(p===null&&(p=this._factory.createPolygon()),p.isEmpty())return p;const _=this.edit(p.getExteriorRing(),a);if(_===null||_.isEmpty())return this._factory.createPolygon();const C=new $;for(let k=0;k<p.getNumInteriorRing();k++){const X=this.edit(p.getInteriorRingN(k),a);X===null||X.isEmpty()||C.add(X)}return this._factory.createPolygon(_,C.toArray([]))}}function le(){}Qt.GeometryEditorOperation=le,Qt.NoOpGeometryOperation=class{edit(dt,r){return dt}get interfaces_(){return[le]}},Qt.CoordinateOperation=class{edit(dt,r){const a=this.edit(dt.getCoordinates(),dt);return dt instanceof Sr?a===null?r.createLinearRing():r.createLinearRing(a):dt instanceof Ee?a===null?r.createLineString():r.createLineString(a):dt instanceof zt?a===null||a.length===0?r.createPoint():r.createPoint(a[0]):dt}get interfaces_(){return[le]}},Qt.CoordinateSequenceOperation=class{edit(dt,r){return dt instanceof Sr?r.createLinearRing(this.edit(dt.getCoordinateSequence(),dt)):dt instanceof Ee?r.createLineString(this.edit(dt.getCoordinateSequence(),dt)):dt instanceof zt?r.createPoint(this.edit(dt.getCoordinateSequence(),dt)):dt}get interfaces_(){return[le]}};class re{constructor(){re.constructor_.apply(this,arguments)}static constructor_(){this._geometryType=null,this._comps=null;const r=arguments[0],a=arguments[1];this._geometryType=r,this._comps=a}static extract(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return re.extract(r,a,new $)}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return r.getGeometryType()===a?p.add(r):r instanceof Ot&&r.apply(new re(a,p)),p}}static isOfType(r,a){return r.getGeometryType()===a||a===oe.TYPENAME_LINESTRING&&r.getGeometryType()===oe.TYPENAME_LINEARRING}filter(r){(this._geometryType===null||re.isOfType(r,this._geometryType))&&this._comps.add(r)}get interfaces_(){return[wi]}}class Pe{static map(){if(arguments[0]instanceof oe&&pt(arguments[1],Ce)){const r=arguments[0],a=arguments[1],p=new $;for(let _=0;_<r.getNumGeometries();_++){const C=a.map(r.getGeometryN(_));C!==null&&p.add(C)}return r.getFactory().buildGeometry(p)}if(pt(arguments[0],T)&&pt(arguments[1],Ce)){const r=arguments[0],a=arguments[1],p=new $;for(let _=r.iterator();_.hasNext();){const C=_.next(),k=a.map(C);k!==null&&p.add(k)}return p}}}function Ce(){}Pe.MapOp=Ce;class Xe{constructor(){Xe.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}transformPoint(r,a){return this._factory.createPoint(this.transformCoordinates(r.getCoordinateSequence(),r))}transformPolygon(r,a){let p=!0;const _=this.transformLinearRing(r.getExteriorRing(),r);_!==null&&_ instanceof Sr&&!_.isEmpty()||(p=!1);const C=new $;for(let k=0;k<r.getNumInteriorRing();k++){const X=this.transformLinearRing(r.getInteriorRingN(k),r);X===null||X.isEmpty()||(X instanceof Sr||(p=!1),C.add(X))}if(p)return this._factory.createPolygon(_,C.toArray([]));{const k=new $;return _!==null&&k.add(_),k.addAll(C),this._factory.buildGeometry(k)}}createCoordinateSequence(r){return this._factory.getCoordinateSequenceFactory().create(r)}getInputGeometry(){return this._inputGeom}transformMultiLineString(r,a){const p=new $;for(let _=0;_<r.getNumGeometries();_++){const C=this.transformLineString(r.getGeometryN(_),r);C!==null&&(C.isEmpty()||p.add(C))}return this._factory.buildGeometry(p)}transformCoordinates(r,a){return this.copy(r)}transformLineString(r,a){return this._factory.createLineString(this.transformCoordinates(r.getCoordinateSequence(),r))}transformMultiPoint(r,a){const p=new $;for(let _=0;_<r.getNumGeometries();_++){const C=this.transformPoint(r.getGeometryN(_),r);C!==null&&(C.isEmpty()||p.add(C))}return this._factory.buildGeometry(p)}transformMultiPolygon(r,a){const p=new $;for(let _=0;_<r.getNumGeometries();_++){const C=this.transformPolygon(r.getGeometryN(_),r);C!==null&&(C.isEmpty()||p.add(C))}return this._factory.buildGeometry(p)}copy(r){return r.copy()}transformLinearRing(r,a){const p=this.transformCoordinates(r.getCoordinateSequence(),r);if(p===null)return this._factory.createLinearRing(null);const _=p.size();return _>0&&_<4&&!this._preserveType?this._factory.createLineString(p):this._factory.createLinearRing(p)}transformGeometryCollection(r,a){const p=new $;for(let _=0;_<r.getNumGeometries();_++){const C=this.transform(r.getGeometryN(_));C!==null&&(this._pruneEmptyGeometry&&C.isEmpty()||p.add(C))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Se.toGeometryArray(p)):this._factory.buildGeometry(p)}transform(r){if(this._inputGeom=r,this._factory=r.getFactory(),r instanceof zt)return this.transformPoint(r,null);if(r instanceof ve)return this.transformMultiPoint(r,null);if(r instanceof Sr)return this.transformLinearRing(r,null);if(r instanceof Ee)return this.transformLineString(r,null);if(r instanceof ar)return this.transformMultiLineString(r,null);if(r instanceof Ut)return this.transformPolygon(r,null);if(r instanceof ae)return this.transformMultiPolygon(r,null);if(r instanceof Ot)return this.transformGeometryCollection(r,null);throw new u("Unknown Geometry subtype: "+r.getGeometryType())}}class Ae{constructor(){Ae.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;const r=arguments[0];this._comps=r}static getLines(){if(arguments.length===1){const r=arguments[0];return Ae.getLines(r,new $)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return r instanceof Ee?a.add(r):r instanceof Ot&&r.apply(new Ae(a)),a}}static getGeometry(r){return r.getFactory().buildGeometry(Ae.getLines(r))}filter(r){r instanceof Ee&&this._comps.add(r)}get interfaces_(){return[wi]}}class ke{constructor(){ke.constructor_.apply(this,arguments)}static constructor_(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){const r=arguments[0];this._lines=r}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._lines=r,this._isForcedToLineString=a}}static getLines(){if(arguments.length===1){const r=arguments[0];return ke.getLines(r,!1)}if(arguments.length===2){if(pt(arguments[0],T)&&pt(arguments[1],T)){const r=arguments[1];for(let a=arguments[0].iterator();a.hasNext();){const p=a.next();ke.getLines(p,r)}return r}if(arguments[0]instanceof oe&&typeof arguments[1]=="boolean"){const r=arguments[0],a=arguments[1],p=new $;return r.apply(new ke(p,a)),p}if(arguments[0]instanceof oe&&pt(arguments[1],T)){const r=arguments[0],a=arguments[1];return r instanceof Ee?a.add(r):r.apply(new ke(a)),a}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&pt(arguments[0],T)&&pt(arguments[1],T)){const r=arguments[1],a=arguments[2];for(let p=arguments[0].iterator();p.hasNext();){const _=p.next();ke.getLines(_,r,a)}return r}if(typeof arguments[2]=="boolean"&&arguments[0]instanceof oe&&pt(arguments[1],T)){const r=arguments[1],a=arguments[2];return arguments[0].apply(new ke(r,a)),r}}}static getGeometry(){if(arguments.length===1){const r=arguments[0];return r.getFactory().buildGeometry(ke.getLines(r))}if(arguments.length===2){const r=arguments[0],a=arguments[1];return r.getFactory().buildGeometry(ke.getLines(r,a))}}filter(r){if(this._isForcedToLineString&&r instanceof Sr){const a=r.getFactory().createLineString(r.getCoordinateSequence());return this._lines.add(a),null}r instanceof Ee&&this._lines.add(r)}setForceToLineString(r){this._isForcedToLineString=r}get interfaces_(){return[Ue]}}const lr={reverseOrder:function(){return{compare:(dt,r)=>r.compareTo(dt)}},min:function(dt){return lr.sort(dt),dt.get(0)},sort:function(dt,r){const a=dt.toArray();r?Ft.sort(a,r):Ft.sort(a);const p=dt.iterator();for(let _=0,C=a.length;_<C;_++)p.next(),p.set(a[_])},singletonList:function(dt){const r=new $;return r.add(dt),r}};class mr{constructor(){mr.constructor_.apply(this,arguments)}static constructor_(){this._pts=null;const r=arguments[0];this._pts=r}static getPoints(){if(arguments.length===1){const r=arguments[0];return r instanceof zt?lr.singletonList(r):mr.getPoints(r,new $)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return r instanceof zt?a.add(r):r instanceof Ot&&r.apply(new mr(a)),a}}filter(r){r instanceof zt&&this._pts.add(r)}get interfaces_(){return[wi]}}class Fr{constructor(){Fr.constructor_.apply(this,arguments)}static constructor_(){this._comps=null;const r=arguments[0];this._comps=r}static getPolygons(){if(arguments.length===1){const r=arguments[0];return Fr.getPolygons(r,new $)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return r instanceof Ut?a.add(r):r instanceof Ot&&r.apply(new Fr(a)),a}}filter(r){r instanceof Ut&&this._comps.add(r)}get interfaces_(){return[wi]}}class Ur{constructor(){Ur.constructor_.apply(this,arguments)}static constructor_(){this._isDone=!1}applyTo(r){for(let a=0;a<r.getNumGeometries()&&!this._isDone;a++){const p=r.getGeometryN(a);if(p instanceof Ot)this.applyTo(p);else if(this.visit(p),this.isDone())return this._isDone=!0,null}}}class ui{constructor(){ui.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._precModel=null,this._dim=new nn,this._nPts=100,this._rotationAngle=0,arguments.length===0)ui.constructor_.call(this,new Se);else if(arguments.length===1){const r=arguments[0];this._geomFact=r,this._precModel=r.getPrecisionModel()}}setBase(r){this._dim.setBase(r)}setRotation(r){this._rotationAngle=r}setWidth(r){this._dim.setWidth(r)}createEllipse(){const r=this._dim.getEnvelope(),a=r.getWidth()/2,p=r.getHeight()/2,_=r.getMinX()+a,C=r.getMinY()+p,k=new Array(this._nPts+1).fill(null);let X=0;for(let te=0;te<this._nPts;te++){const ce=te*(2*Math.PI/this._nPts),Ye=a*Math.cos(ce)+_,sr=p*Math.sin(ce)+C;k[X++]=this.coord(Ye,sr)}k[X]=new O(k[0]);const J=this._geomFact.createLinearRing(k),Ct=this._geomFact.createPolygon(J);return this.rotate(Ct)}createArc(r,a){const p=this._dim.getEnvelope(),_=p.getWidth()/2,C=p.getHeight()/2,k=p.getMinX()+_,X=p.getMinY()+C;let J=a;(J<=0||J>2*Math.PI)&&(J=2*Math.PI);const Ct=J/(this._nPts-1),te=new Array(this._nPts).fill(null);let ce=0;for(let sr=0;sr<this._nPts;sr++){const Cr=r+sr*Ct,Ii=_*Math.cos(Cr)+k,Vn=C*Math.sin(Cr)+X;te[ce++]=this.coord(Ii,Vn)}const Ye=this._geomFact.createLineString(te);return this.rotate(Ye)}rotate(r){if(this._rotationAngle!==0){const a=xi.rotationInstance(this._rotationAngle,this._dim.getCentre().x,this._dim.getCentre().y);r.apply(a)}return r}coord(r,a){const p=new O(r,a);return this._precModel.makePrecise(p),p}createArcPolygon(r,a){const p=this._dim.getEnvelope(),_=p.getWidth()/2,C=p.getHeight()/2,k=p.getMinX()+_,X=p.getMinY()+C;let J=a;(J<=0||J>2*Math.PI)&&(J=2*Math.PI);const Ct=J/(this._nPts-1),te=new Array(this._nPts+2).fill(null);let ce=0;te[ce++]=this.coord(k,X);for(let Cr=0;Cr<this._nPts;Cr++){const Ii=r+Ct*Cr,Vn=_*Math.cos(Ii)+k,no=C*Math.sin(Ii)+X;te[ce++]=this.coord(Vn,no)}te[ce++]=this.coord(k,X);const Ye=this._geomFact.createLinearRing(te),sr=this._geomFact.createPolygon(Ye);return this.rotate(sr)}createRectangle(){let r=null,a=0,p=Math.trunc(this._nPts/4);p<1&&(p=1);const _=this._dim.getEnvelope().getWidth()/p,C=this._dim.getEnvelope().getHeight()/p,k=new Array(4*p+1).fill(null),X=this._dim.getEnvelope();for(r=0;r<p;r++){const te=X.getMinX()+r*_,ce=X.getMinY();k[a++]=this.coord(te,ce)}for(r=0;r<p;r++){const te=X.getMaxX(),ce=X.getMinY()+r*C;k[a++]=this.coord(te,ce)}for(r=0;r<p;r++){const te=X.getMaxX()-r*_,ce=X.getMaxY();k[a++]=this.coord(te,ce)}for(r=0;r<p;r++){const te=X.getMinX(),ce=X.getMaxY()-r*C;k[a++]=this.coord(te,ce)}k[a++]=new O(k[0]);const J=this._geomFact.createLinearRing(k),Ct=this._geomFact.createPolygon(J);return this.rotate(Ct)}createCircle(){return this.createEllipse()}setHeight(r){this._dim.setHeight(r)}setSize(r){this._dim.setSize(r)}createSupercircle(r){const a=1/r,p=this._dim.getMinSize()/2,_=this._dim.getCentre(),C=Math.pow(p,r),k=p,X=Math.pow(C/2,a),J=Math.trunc(this._nPts/8),Ct=new Array(8*J+1).fill(null),te=X/J;for(let sr=0;sr<=J;sr++){let Cr=0,Ii=k;if(sr!==0){Cr=te*sr;const Vn=Math.pow(Cr,r);Ii=Math.pow(C-Vn,a)}Ct[sr]=this.coordTrans(Cr,Ii,_),Ct[2*J-sr]=this.coordTrans(Ii,Cr,_),Ct[2*J+sr]=this.coordTrans(Ii,-Cr,_),Ct[4*J-sr]=this.coordTrans(Cr,-Ii,_),Ct[4*J+sr]=this.coordTrans(-Cr,-Ii,_),Ct[6*J-sr]=this.coordTrans(-Ii,-Cr,_),Ct[6*J+sr]=this.coordTrans(-Ii,Cr,_),Ct[8*J-sr]=this.coordTrans(-Cr,Ii,_)}Ct[Ct.length-1]=new O(Ct[0]);const ce=this._geomFact.createLinearRing(Ct),Ye=this._geomFact.createPolygon(ce);return this.rotate(Ye)}setNumPoints(r){this._nPts=r}coordTrans(r,a,p){return this.coord(r+p.x,a+p.y)}createSquircle(){return this.createSupercircle(4)}setEnvelope(r){this._dim.setEnvelope(r)}setCentre(r){this._dim.setCentre(r)}}class nn{constructor(){nn.constructor_.apply(this,arguments)}static constructor_(){this.base=null,this.centre=null,this.width=null,this.height=null}setBase(r){this.base=r}setWidth(r){this.width=r}getBase(){return this.base}getWidth(){return this.width}getEnvelope(){return this.base!==null?new nt(this.base.x,this.base.x+this.width,this.base.y,this.base.y+this.height):this.centre!==null?new nt(this.centre.x-this.width/2,this.centre.x+this.width/2,this.centre.y-this.height/2,this.centre.y+this.height/2):new nt(0,this.width,0,this.height)}getCentre(){return this.centre===null&&(this.centre=new O(this.base.x+this.width/2,this.base.y+this.height/2)),this.centre}getHeight(){return this.height}setHeight(r){this.height=r}setSize(r){this.height=r,this.width=r}setEnvelope(r){this.width=r.getWidth(),this.height=r.getHeight(),this.base=new O(r.getMinX(),r.getMinY()),this.centre=new O(r.centre())}setCentre(r){this.centre=r}getMinSize(){return Math.min(this.width,this.height)}}ui.Dimensions=nn;class pn extends ui{constructor(){super(),pn.constructor_.apply(this,arguments)}static constructor_(){if(this._numArms=8,this._armLengthRatio=.5,arguments.length===0)ui.constructor_.call(this);else if(arguments.length===1){const r=arguments[0];ui.constructor_.call(this,r)}}static create(r,a,p,_,C){const k=new pn;return k.setCentre(r),k.setSize(a),k.setNumPoints(p),k.setArmLengthRatio(C),k.setNumArms(_),k.createSineStar()}setArmLengthRatio(r){this._armLengthRatio=r}createSineStar(){const r=this._dim.getEnvelope(),a=r.getWidth()/2;let p=this._armLengthRatio;p<0&&(p=0),p>1&&(p=1);const _=p*a,C=(1-p)*a,k=r.getMinX()+a,X=r.getMinY()+a,J=new Array(this._nPts+1).fill(null);let Ct=0;for(let ce=0;ce<this._nPts;ce++){const Ye=ce/this._nPts*this._numArms,sr=Ye-Math.floor(Ye),Cr=2*Math.PI*sr,Ii=C+_*((Math.cos(Cr)+1)/2),Vn=ce*(2*Math.PI/this._nPts),no=Ii*Math.cos(Vn)+k,ma=Ii*Math.sin(Vn)+X;J[Ct++]=this.coord(no,ma)}J[Ct]=new O(J[0]);const te=this._geomFact.createLinearRing(J);return this._geomFact.createPolygon(te)}setNumArms(r){this._numArms=r}}var Co=Object.freeze({__proto__:null,AffineTransformation:xi,AffineTransformationBuilder:hn,AffineTransformationFactory:Mn,ComponentCoordinateExtracter:bt,GeometryCollectionMapper:Gt,GeometryCombiner:At,GeometryEditor:Qt,GeometryExtracter:re,GeometryMapper:Pe,GeometryTransformer:Xe,LineStringExtracter:Ae,LinearComponentExtracter:ke,PointExtracter:mr,PolygonExtracter:Fr,ShortCircuitedGeometryVisitor:Ur,SineStarFactory:pn}),Us=Object.freeze({__proto__:null,Coordinate:O,CoordinateList:W,CoordinateSequenceFilter:rt,CoordinateXY:Q,CoordinateXYM:et,CoordinateXYZM:lt,Dimension:se,Envelope:nt,Geometry:oe,GeometryCollection:Ot,GeometryFactory:Se,IntersectionMatrix:_i,LineSegment:gr,LineString:Ee,LinearRing:Sr,Location:St,MultiLineString:ar,MultiPoint:ve,MultiPolygon:ae,Point:zt,Polygon:Ut,PrecisionModel:Oe,Triangle:qi,util:Co});class Wn{constructor(){Wn.constructor_.apply(this,arguments)}static constructor_(){this._pt=[new O,new O],this._distance=m.NaN,this._isNull=!0}getCoordinates(){return this._pt}getCoordinate(r){return this._pt[r]}setMinimum(){if(arguments.length===1){const r=arguments[0];this.setMinimum(r._pt[0],r._pt[1])}else if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this._isNull)return this.initialize(r,a),null;const p=r.distance(a);p<this._distance&&this.initialize(r,a,p)}}initialize(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(a),this._distance=r.distance(a),this._isNull=!1}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(a),this._distance=p,this._isNull=!1}}toString(){return vi.toLineString(this._pt[0],this._pt[1])}getDistance(){return this._distance}setMaximum(){if(arguments.length===1){const r=arguments[0];this.setMaximum(r._pt[0],r._pt[1])}else if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this._isNull)return this.initialize(r,a),null;const p=r.distance(a);p>this._distance&&this.initialize(r,a,p)}}}class En{static computeDistance(){if(arguments[2]instanceof Wn&&arguments[0]instanceof Ee&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=arguments[2],_=new gr,C=r.getCoordinates();for(let k=0;k<C.length-1;k++){_.setCoordinates(C[k],C[k+1]);const X=_.closestPoint(a);p.setMinimum(X,a)}}else if(arguments[2]instanceof Wn&&arguments[0]instanceof Ut&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=arguments[2];En.computeDistance(r.getExteriorRing(),a,p);for(let _=0;_<r.getNumInteriorRing();_++)En.computeDistance(r.getInteriorRingN(_),a,p)}else if(arguments[2]instanceof Wn&&arguments[0]instanceof oe&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=arguments[2];if(r instanceof Ee)En.computeDistance(r,a,p);else if(r instanceof Ut)En.computeDistance(r,a,p);else if(r instanceof Ot){const _=r;for(let C=0;C<_.getNumGeometries();C++){const k=_.getGeometryN(C);En.computeDistance(k,a,p)}}else p.setMinimum(r.getCoordinate(),a)}else if(arguments[2]instanceof Wn&&arguments[0]instanceof gr&&arguments[1]instanceof O){const r=arguments[1],a=arguments[2],p=arguments[0].closestPoint(r);a.setMinimum(p,r)}}}class ao{constructor(){ao.constructor_.apply(this,arguments)}static constructor_(){this._g0=null,this._g1=null,this._ptDist=new Wn,this._densifyFrac=0;const r=arguments[0],a=arguments[1];this._g0=r,this._g1=a}static distance(){if(arguments.length===2)return new ao(arguments[0],arguments[1]).distance();if(arguments.length===3){const r=arguments[2],a=new ao(arguments[0],arguments[1]);return a.setDensifyFraction(r),a.distance()}}getCoordinates(){return this._ptDist.getCoordinates()}setDensifyFraction(r){if(r>1||r<=0)throw new u("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=r}compute(r,a){this.computeOrientedDistance(r,a,this._ptDist),this.computeOrientedDistance(a,r,this._ptDist)}distance(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}computeOrientedDistance(r,a,p){const _=new as(a);if(r.apply(_),p.setMaximum(_.getMaxPointDistance()),this._densifyFrac>0){const C=new vs(a,this._densifyFrac);r.apply(C),p.setMaximum(C.getMaxPointDistance())}}orientedDistance(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}}class as{constructor(){as.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Wn,this._minPtDist=new Wn,this._euclideanDist=new En,this._geom=null;const r=arguments[0];this._geom=r}filter(r){this._minPtDist.initialize(),En.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}getMaxPointDistance(){return this._maxPtDist}get interfaces_(){return[Ar]}}class vs{constructor(){vs.constructor_.apply(this,arguments)}static constructor_(){this._maxPtDist=new Wn,this._minPtDist=new Wn,this._geom=null,this._numSubSegs=0;const r=arguments[0],a=arguments[1];this._geom=r,this._numSubSegs=Math.trunc(Math.round(1/a))}filter(r,a){if(a===0)return null;const p=r.getCoordinate(a-1),_=r.getCoordinate(a),C=(_.x-p.x)/this._numSubSegs,k=(_.y-p.y)/this._numSubSegs;for(let X=0;X<this._numSubSegs;X++){const J=p.x+X*C,Ct=p.y+X*k,te=new O(J,Ct);this._minPtDist.initialize(),En.computeDistance(this._geom,te,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}isGeometryChanged(){return!1}getMaxPointDistance(){return this._maxPtDist}isDone(){return!1}get interfaces_(){return[rt]}}ao.MaxPointDistanceFilter=as,ao.MaxDensifiedByFractionDistanceFilter=vs;var ko=Object.freeze({__proto__:null,DiscreteHausdorffDistance:ao,DistanceToPoint:En,PointPairDistance:Wn});class ba{visitItem(r){}}class _s{locate(r){}}class Wo{constructor(){Wo.constructor_.apply(this,arguments)}static constructor_(){this._min=m.POSITIVE_INFINITY,this._max=m.NEGATIVE_INFINITY}getMin(){return this._min}intersects(r,a){return!(this._min>a||this._max<r)}getMax(){return this._max}toString(){return vi.toLineString(new O(this._min,0),new O(this._max,0))}}Wo.NodeComparator=class{compare(dt,r){const a=dt,p=r,_=(a._min+a._max)/2,C=(p._min+p._max)/2;return _<C?-1:_>C?1:0}get interfaces_(){return[U]}};class Qa extends Wo{constructor(){super(),Qa.constructor_.apply(this,arguments)}static constructor_(){this._item=null;const r=arguments[0],a=arguments[1],p=arguments[2];this._min=r,this._max=a,this._item=p}query(r,a,p){if(!this.intersects(r,a))return null;p.visitItem(this._item)}}class tl extends Wo{constructor(){super(),tl.constructor_.apply(this,arguments)}static constructor_(){this._node1=null,this._node2=null;const r=arguments[0],a=arguments[1];this._node1=r,this._node2=a,this.buildExtent(this._node1,this._node2)}buildExtent(r,a){this._min=Math.min(r._min,a._min),this._max=Math.max(r._max,a._max)}query(r,a,p){if(!this.intersects(r,a))return null;this._node1!==null&&this._node1.query(r,a,p),this._node2!==null&&this._node2.query(r,a,p)}}class bl{constructor(){bl.constructor_.apply(this,arguments)}static constructor_(){this._leaves=new $,this._root=null,this._level=0}buildTree(){lr.sort(this._leaves,new Wo.NodeComparator);let r=this._leaves,a=null,p=new $;for(;;){if(this.buildLevel(r,p),p.size()===1)return p.get(0);a=r,r=p,p=a}}insert(r,a,p){if(this._root!==null)throw new Vt("Index cannot be added to once it has been queried");this._leaves.add(new Qa(r,a,p))}query(r,a,p){if(this.init(),this._root===null)return null;this._root.query(r,a,p)}buildRoot(){if(this._root!==null)return null;this._root=this.buildTree()}printNode(r){ne.out.println(vi.toLineString(new O(r._min,this._level),new O(r._max,this._level)))}init(){return this._root!==null||this._leaves.size()===0?null:void this.buildRoot()}buildLevel(r,a){this._level++,a.clear();for(let p=0;p<r.size();p+=2){const _=r.get(p);if((p+1<r.size()?r.get(p):null)===null)a.add(_);else{const C=new tl(r.get(p),r.get(p+1));a.add(C)}}}}class el{constructor(){el.constructor_.apply(this,arguments)}static constructor_(){this._items=new $}getItems(){return this._items}visitItem(r){this._items.add(r)}get interfaces_(){return[ba]}}class xs{constructor(){xs.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const r=arguments[0];this._p=r}static locatePointInRing(){if(arguments[0]instanceof O&&pt(arguments[1],ge)){const r=arguments[1],a=new xs(arguments[0]),p=new O,_=new O;for(let C=1;C<r.size();C++)if(r.getCoordinate(C,p),r.getCoordinate(C-1,_),a.countSegment(p,_),a.isOnSegment())return a.getLocation();return a.getLocation()}if(arguments[0]instanceof O&&arguments[1]instanceof Array){const r=arguments[1],a=new xs(arguments[0]);for(let p=1;p<r.length;p++){const _=r[p],C=r[p-1];if(a.countSegment(_,C),a.isOnSegment())return a.getLocation()}return a.getLocation()}}getLocation(){return this._isPointOnSegment?St.BOUNDARY:this._crossingCount%2==1?St.INTERIOR:St.EXTERIOR}isPointInPolygon(){return this.getLocation()!==St.EXTERIOR}isOnSegment(){return this._isPointOnSegment}countSegment(r,a){if(r.x<this._p.x&&a.x<this._p.x)return null;if(this._p.x===a.x&&this._p.y===a.y)return this._isPointOnSegment=!0,null;if(r.y===this._p.y&&a.y===this._p.y){let p=r.x,_=a.x;return p>_&&(p=a.x,_=r.x),this._p.x>=p&&this._p.x<=_&&(this._isPointOnSegment=!0),null}if(r.y>this._p.y&&a.y<=this._p.y||a.y>this._p.y&&r.y<=this._p.y){let p=Yt.index(r,a,this._p);if(p===Yt.COLLINEAR)return this._isPointOnSegment=!0,null;a.y<r.y&&(p=-p),p===Yt.LEFT&&this._crossingCount++}}}class _o{constructor(){_o.constructor_.apply(this,arguments)}static constructor_(){this._geom=null,this._index=null;const r=arguments[0];if(!(pt(r,Kt)||r instanceof Sr))throw new u("Argument must be Polygonal or LinearRing");this._geom=r}locate(r){this._index===null&&(this._index=new Yo(this._geom),this._geom=null);const a=new xs(r),p=new To(a);return this._index.query(r.y,r.y,p),a.getLocation()}get interfaces_(){return[_s]}}class To{constructor(){To.constructor_.apply(this,arguments)}static constructor_(){this._counter=null;const r=arguments[0];this._counter=r}visitItem(r){const a=r;this._counter.countSegment(a.getCoordinate(0),a.getCoordinate(1))}get interfaces_(){return[ba]}}class Yo{constructor(){Yo.constructor_.apply(this,arguments)}static constructor_(){this._isEmpty=!1,this._index=new bl;const r=arguments[0];r.isEmpty()?this._isEmpty=!0:this.init(r)}init(r){for(let a=ke.getLines(r).iterator();a.hasNext();){const p=a.next().getCoordinates();this.addLine(p)}}addLine(r){for(let a=1;a<r.length;a++){const p=new gr(r[a-1],r[a]),_=Math.min(p.p0.y,p.p1.y),C=Math.max(p.p0.y,p.p1.y);this._index.insert(_,C,p)}}query(){if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this._isEmpty)return new $;const p=new el;return this._index.query(r,a,p),p.getItems()}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(this._isEmpty)return null;this._index.query(r,a,p)}}}_o.SegmentVisitor=To,_o.IntervalIndexedGeometry=Yo;class Gi{static isInRing(r,a){return Gi.locateInRing(r,a)!==St.EXTERIOR}static locateInRing(r,a){return xs.locatePointInRing(r,a)}static isOnLine(){if(arguments[0]instanceof O&&pt(arguments[1],ge)){const r=arguments[0],a=arguments[1],p=new tn,_=new O,C=new O,k=a.size();for(let X=1;X<k;X++)if(a.getCoordinate(X-1,_),a.getCoordinate(X,C),p.computeIntersection(r,_,C),p.hasIntersection())return!0;return!1}if(arguments[0]instanceof O&&arguments[1]instanceof Array){const r=arguments[0],a=arguments[1],p=new tn;for(let _=1;_<a.length;_++){const C=a[_-1],k=a[_];if(p.computeIntersection(r,C,k),p.hasIntersection())return!0}return!1}}}class Sl{hasNext(){}next(){}remove(){}}class Po{constructor(){Po.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const r=arguments[0];this._parent=r,this._atStart=!0,this._index=0,this._max=r.getNumGeometries()}static isAtomic(r){return!(r instanceof Ot)}next(){if(this._atStart)return this._atStart=!1,Po.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new ft;const r=this._parent.getGeometryN(this._index++);return r instanceof Ot?(this._subcollectionIterator=new Po(r),this._subcollectionIterator.next()):r}hasNext(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}remove(){throw new Fe(this.getClass().getName())}get interfaces_(){return[Sl]}}class Yn{constructor(){Yn.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;const r=arguments[0];this._geom=r}static locatePointInPolygon(r,a){if(a.isEmpty())return St.EXTERIOR;const p=a.getExteriorRing(),_=Yn.locatePointInRing(r,p);if(_!==St.INTERIOR)return _;for(let C=0;C<a.getNumInteriorRing();C++){const k=a.getInteriorRingN(C),X=Yn.locatePointInRing(r,k);if(X===St.BOUNDARY)return St.BOUNDARY;if(X===St.INTERIOR)return St.EXTERIOR}return St.INTERIOR}static locatePointInRing(r,a){return a.getEnvelopeInternal().intersects(r)?Gi.locateInRing(r,a.getCoordinates()):St.EXTERIOR}static isContained(r,a){return St.EXTERIOR!==Yn.locate(r,a)}static locate(r,a){return a.isEmpty()?St.EXTERIOR:a.getEnvelopeInternal().intersects(r)?Yn.locateInGeometry(r,a):St.EXTERIOR}static containsPointInPolygon(r,a){return St.EXTERIOR!==Yn.locatePointInPolygon(r,a)}static locateInGeometry(r,a){if(a instanceof Ut)return Yn.locatePointInPolygon(r,a);if(a instanceof Ot){const p=new Po(a);for(;p.hasNext();){const _=p.next();if(_!==a){const C=Yn.locateInGeometry(r,_);if(C!==St.EXTERIOR)return C}}}return St.EXTERIOR}locate(r){return Yn.locate(r,this._geom)}get interfaces_(){return[_s]}}var Ki=Object.freeze({__proto__:null,IndexedPointInAreaLocator:_o,PointOnGeometryLocator:_s,SimplePointInAreaLocator:Yn});class fn{measure(r,a){}}class Zr{constructor(){Zr.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=Zr.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=Zr.CAP_ROUND,this._joinStyle=Zr.JOIN_ROUND,this._mitreLimit=Zr.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=Zr.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this.setQuadrantSegments(r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.setQuadrantSegments(r),this.setEndCapStyle(a)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(a),this.setJoinStyle(p),this.setMitreLimit(_)}}}static bufferDistanceError(r){const a=Math.PI/2/r;return 1-Math.cos(a/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(r){this._quadrantSegments=r,this._quadrantSegments===0&&(this._joinStyle=Zr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Zr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),r<=0&&(this._quadrantSegments=1),this._joinStyle!==Zr.JOIN_ROUND&&(this._quadrantSegments=Zr.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(r){this._joinStyle=r}setSimplifyFactor(r){this._simplifyFactor=r<0?0:r}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(r){this._endCapStyle=r}getMitreLimit(){return this._mitreLimit}setMitreLimit(r){this._mitreLimit=r}setSingleSided(r){this._isSingleSided=r}}Zr.CAP_ROUND=1,Zr.CAP_FLAT=2,Zr.CAP_SQUARE=3,Zr.JOIN_ROUND=1,Zr.JOIN_MITRE=2,Zr.JOIN_BEVEL=3,Zr.DEFAULT_QUADRANT_SEGMENTS=8,Zr.DEFAULT_MITRE_LIMIT=5,Zr.DEFAULT_SIMPLIFY_FACTOR=.01;class Qn{static relativeSign(r,a){return r<a?-1:r>a?1:0}static compareValue(r,a){return r<0?-1:r>0?1:a<0?-1:a>0?1:0}static compare(r,a,p){if(a.equals2D(p))return 0;const _=Qn.relativeSign(a.x,p.x),C=Qn.relativeSign(a.y,p.y);switch(r){case 0:return Qn.compareValue(_,C);case 1:return Qn.compareValue(C,_);case 2:return Qn.compareValue(C,-_);case 3:return Qn.compareValue(-_,C);case 4:return Qn.compareValue(-_,-C);case 5:return Qn.compareValue(-C,-_);case 6:return Qn.compareValue(-C,_);case 7:return Qn.compareValue(_,-C)}return L.shouldNeverReachHere("invalid octant value"),0}}class Gr{constructor(){Gr.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this._segString=r,this.coord=new O(a),this.segmentIndex=p,this._segmentOctant=_,this._isInterior=!a.equals2D(r.getCoordinate(p))}getCoordinate(){return this.coord}print(r){r.print(this.coord),r.print(" seg # = "+this.segmentIndex)}compareTo(r){const a=r;return this.segmentIndex<a.segmentIndex?-1:this.segmentIndex>a.segmentIndex?1:this.coord.equals2D(a.coord)?0:this._isInterior?a._isInterior?Qn.compare(this._segmentOctant,this.coord,a.coord):1:-1}isEndPoint(r){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===r}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[g]}}class on extends Ve{}function ws(dt){return dt==null?0:dt.color}function Hi(dt){return dt==null?null:dt.parent}function v(dt,r){dt!==null&&(dt.color=r)}function S(dt){return dt==null?null:dt.left}function M(dt){return dt==null?null:dt.right}class R extends on{constructor(){super(),this.root_=null,this.size_=0}get(r){let a=this.root_;for(;a!==null;){const p=r.compareTo(a.key);if(p<0)a=a.left;else{if(!(p>0))return a.value;a=a.right}}return null}put(r,a){if(this.root_===null)return this.root_={key:r,value:a,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let p,_,C=this.root_;do if(p=C,_=r.compareTo(C.key),_<0)C=C.left;else{if(!(_>0)){const X=C.value;return C.value=a,X}C=C.right}while(C!==null);const k={key:r,left:null,right:null,value:a,parent:p,color:0,getValue(){return this.value},getKey(){return this.key}};return _<0?p.left=k:p.right=k,this.fixAfterInsertion(k),this.size_++,null}fixAfterInsertion(r){let a;for(r.color=1;r!=null&&r!==this.root_&&r.parent.color===1;)Hi(r)===S(Hi(Hi(r)))?(a=M(Hi(Hi(r))),ws(a)===1?(v(Hi(r),0),v(a,0),v(Hi(Hi(r)),1),r=Hi(Hi(r))):(r===M(Hi(r))&&(r=Hi(r),this.rotateLeft(r)),v(Hi(r),0),v(Hi(Hi(r)),1),this.rotateRight(Hi(Hi(r))))):(a=S(Hi(Hi(r))),ws(a)===1?(v(Hi(r),0),v(a,0),v(Hi(Hi(r)),1),r=Hi(Hi(r))):(r===S(Hi(r))&&(r=Hi(r),this.rotateRight(r)),v(Hi(r),0),v(Hi(Hi(r)),1),this.rotateLeft(Hi(Hi(r)))));this.root_.color=0}values(){const r=new $;let a=this.getFirstEntry();if(a!==null)for(r.add(a.value);(a=R.successor(a))!==null;)r.add(a.value);return r}entrySet(){const r=new Be;let a=this.getFirstEntry();if(a!==null)for(r.add(a);(a=R.successor(a))!==null;)r.add(a);return r}rotateLeft(r){if(r!=null){const a=r.right;r.right=a.left,a.left!=null&&(a.left.parent=r),a.parent=r.parent,r.parent==null?this.root_=a:r.parent.left===r?r.parent.left=a:r.parent.right=a,a.left=r,r.parent=a}}rotateRight(r){if(r!=null){const a=r.left;r.left=a.right,a.right!=null&&(a.right.parent=r),a.parent=r.parent,r.parent==null?this.root_=a:r.parent.right===r?r.parent.right=a:r.parent.left=a,a.right=r,r.parent=a}}getFirstEntry(){let r=this.root_;if(r!=null)for(;r.left!=null;)r=r.left;return r}static successor(r){let a;if(r===null)return null;if(r.right!==null){for(a=r.right;a.left!==null;)a=a.left;return a}{a=r.parent;let p=r;for(;a!==null&&p===a.right;)p=a,a=a.parent;return a}}size(){return this.size_}containsKey(r){let a=this.root_;for(;a!==null;){const p=r.compareTo(a.key);if(p<0)a=a.left;else{if(!(p>0))return!0;a=a.right}}return!1}}class V{constructor(){V.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new R,this._edge=null;const r=arguments[0];this._edge=r}getSplitCoordinates(){const r=new W;this.addEndpoints();const a=this.iterator();let p=a.next();for(;a.hasNext();){const _=a.next();this.addEdgeCoordinates(p,_,r),p=_}return r.toCoordinateArray()}print(r){r.println("Intersections:");for(let a=this.iterator();a.hasNext();)a.next().print(r)}findCollapsesFromExistingVertices(r){for(let a=0;a<this._edge.size()-2;a++){const p=this._edge.getCoordinate(a);this._edge.getCoordinate(a+1);const _=this._edge.getCoordinate(a+2);p.equals2D(_)&&r.add(Mt.valueOf(a+1))}}addEdgeCoordinates(r,a,p){const _=this.createSplitEdgePts(r,a);p.add(_,!1)}findCollapseIndex(r,a,p){if(!r.coord.equals2D(a.coord))return!1;let _=a.segmentIndex-r.segmentIndex;return a.isInterior()||_--,_===1&&(p[0]=r.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(r){const a=new Array(1).fill(null),p=this.iterator();let _=p.next();for(;p.hasNext();){const C=p.next();this.findCollapseIndex(_,C,a)&&r.add(Mt.valueOf(a[0])),_=C}}getEdge(){return this._edge}addEndpoints(){const r=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(r),r)}createSplitEdge(r,a){const p=this.createSplitEdgePts(r,a);return new st(p,this._edge.getData())}add(r,a){const p=new Gr(this._edge,r,a,this._edge.getSegmentOctant(a)),_=this._nodeMap.get(p);return _!==null?(L.isTrue(_.coord.equals2D(r),"Found equal nodes with different coordinates"),_):(this._nodeMap.put(p,p),p)}checkSplitEdgesCorrectness(r){const a=this._edge.getCoordinates(),p=r.get(0).getCoordinate(0);if(!p.equals2D(a[0]))throw new E("bad split edge start point at "+p);const _=r.get(r.size()-1).getCoordinates(),C=_[_.length-1];if(!C.equals2D(a[a.length-1]))throw new E("bad split edge end point at "+C)}addCollapsedNodes(){const r=new $;this.findCollapsesFromInsertedNodes(r),this.findCollapsesFromExistingVertices(r);for(let a=r.iterator();a.hasNext();){const p=a.next().intValue();this.add(this._edge.getCoordinate(p),p)}}createSplitEdgePts(r,a){let p=a.segmentIndex-r.segmentIndex+2;if(p===2)return[new O(r.coord),new O(a.coord)];const _=this._edge.getCoordinate(a.segmentIndex),C=a.isInterior()||!a.coord.equals2D(_);C||p--;const k=new Array(p).fill(null);let X=0;k[X++]=new O(r.coord);for(let J=r.segmentIndex+1;J<=a.segmentIndex;J++)k[X++]=this._edge.getCoordinate(J);return C&&(k[X]=new O(a.coord)),k}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(r){this.addEndpoints(),this.addCollapsedNodes();const a=this.iterator();let p=a.next();for(;a.hasNext();){const _=a.next(),C=this.createSplitEdge(p,_);r.add(C),p=_}}}class q{static octant(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];if(r===0&&a===0)throw new u("Cannot compute the octant for point ( "+r+", "+a+" )");const p=Math.abs(r),_=Math.abs(a);return r>=0?a>=0?p>=_?0:1:p>=_?7:6:a>=0?p>=_?3:2:p>=_?4:5}if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1],p=a.x-r.x,_=a.y-r.y;if(p===0&&_===0)throw new u("Cannot compute the octant for two identical points "+r);return q.octant(p,_)}}}class Y{getCoordinates(){}size(){}getCoordinate(r){}isClosed(){}setData(r){}getData(){}}class ht{addIntersection(r,a){}get interfaces_(){return[Y]}}class st{constructor(){st.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new V(this),this._pts=null,this._data=null;const r=arguments[0],a=arguments[1];this._pts=r,this._data=a}static getNodedSubstrings(){if(arguments.length===1){const r=arguments[0],a=new $;return st.getNodedSubstrings(r,a),a}if(arguments.length===2){const r=arguments[1];for(let a=arguments[0].iterator();a.hasNext();)a.next().getNodeList().addSplitEdges(r)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(r){return this._pts[r]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(r){return r===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(r),this.getCoordinate(r+1))}toString(){return vi.toLineString(new ye(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(r,a){let p=a;const _=p+1;if(_<this._pts.length){const C=this._pts[_];r.equals2D(C)&&(p=_)}return this._nodeList.add(r,p)}addIntersections(r,a,p){for(let _=0;_<r.getIntersectionNum();_++)this.addIntersection(r,a,p,_)}setData(r){this._data=r}safeOctant(r,a){return r.equals2D(a)?0:q.octant(r,a)}getData(){return this._data}addIntersection(){if(arguments.length===2){const r=arguments[0],a=arguments[1];this.addIntersectionNode(r,a)}else if(arguments.length===4){const r=arguments[1],a=arguments[3],p=new O(arguments[0].getIntersection(a));this.addIntersection(p,r)}}get interfaces_(){return[ht]}}class xt{getNodedSubstrings(){}computeNodes(r){}}class Tt{constructor(){Tt.constructor_.apply(this,arguments)}static constructor_(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){const r=arguments[0],a=arguments[1];Tt.constructor_.call(this,r,a,0,0)}else if(arguments.length===4){const r=arguments[0],a=arguments[1];this._noder=r,this._scaleFactor=a,this._isScaled=!this.isIntegerPrecision()}}rescale(){if(pt(arguments[0],T))for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.rescale(a.getCoordinates())}else if(arguments[0]instanceof Array){const r=arguments[0];for(let a=0;a<r.length;a++)r[a].x=r[a].x/this._scaleFactor+this._offsetX,r[a].y=r[a].y/this._scaleFactor+this._offsetY;r.length===2&&r[0].equals2D(r[1])&&ne.out.println(r)}}scale(){if(pt(arguments[0],T)){const r=arguments[0],a=new $(r.size());for(let p=r.iterator();p.hasNext();){const _=p.next();a.add(new st(this.scale(_.getCoordinates()),_.getData()))}return a}if(arguments[0]instanceof Array){const r=arguments[0],a=new Array(r.length).fill(null);for(let p=0;p<r.length;p++)a[p]=new O(Math.round((r[p].x-this._offsetX)*this._scaleFactor),Math.round((r[p].y-this._offsetY)*this._scaleFactor),r[p].getZ());return De.removeRepeatedPoints(a)}}isIntegerPrecision(){return this._scaleFactor===1}getNodedSubstrings(){const r=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(r),r}computeNodes(r){let a=r;this._isScaled&&(a=this.scale(r)),this._noder.computeNodes(a)}get interfaces_(){return[xt]}}class jt extends E{constructor(r,a){super(a?r+" [ "+a+" ]":r),this.pt=a?new O(a):void 0,this.name=Object.keys({TopologyException:jt})[0]}getCoordinate(){return this.pt}}class Et{constructor(){Et.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._segStrings=null;const r=arguments[0];this._segStrings=r}checkEndPtVertexIntersections(){if(arguments.length===0)for(let r=this._segStrings.iterator();r.hasNext();){const a=r.next().getCoordinates();this.checkEndPtVertexIntersections(a[0],this._segStrings),this.checkEndPtVertexIntersections(a[a.length-1],this._segStrings)}else if(arguments.length===2){const r=arguments[0];for(let a=arguments[1].iterator();a.hasNext();){const p=a.next().getCoordinates();for(let _=1;_<p.length-1;_++)if(p[_].equals(r))throw new E("found endpt/interior pt intersection at index "+_+" :pt "+r)}}}checkInteriorIntersections(){if(arguments.length===0)for(let r=this._segStrings.iterator();r.hasNext();){const a=r.next();for(let p=this._segStrings.iterator();p.hasNext();){const _=p.next();this.checkInteriorIntersections(a,_)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1],p=r.getCoordinates(),_=a.getCoordinates();for(let C=0;C<p.length-1;C++)for(let k=0;k<_.length-1;k++)this.checkInteriorIntersections(r,C,a,k)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];if(r===p&&a===_)return null;const C=r.getCoordinates()[a],k=r.getCoordinates()[a+1],X=p.getCoordinates()[_],J=p.getCoordinates()[_+1];if(this._li.computeIntersection(C,k,X,J),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,C,k)||this.hasInteriorIntersection(this._li,X,J)))throw new E("found non-noded intersection at "+C+"-"+k+" and "+X+"-"+J)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(arguments.length===0)for(let r=this._segStrings.iterator();r.hasNext();){const a=r.next();this.checkCollapses(a)}else if(arguments.length===1){const r=arguments[0].getCoordinates();for(let a=0;a<r.length-2;a++)this.checkCollapse(r[a],r[a+1],r[a+2])}}hasInteriorIntersection(r,a,p){for(let _=0;_<r.getIntersectionNum();_++){const C=r.getIntersection(_);if(!C.equals(a)&&!C.equals(p))return!0}return!1}checkCollapse(r,a,p){if(r.equals(p))throw new E("found non-noded collapse at "+Et.fact.createLineString([r,a,p]))}}Et.fact=new Se;class qt{getBounds(){}}class be{constructor(){be.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;const r=arguments[0],a=arguments[1];this._bounds=r,this._item=a}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[qt,x]}}function We(dt){return dt&&dt.__esModule&&Object.prototype.hasOwnProperty.call(dt,"default")?dt.default:dt}var Ze,si,gi=function(){if(si)return Ze;si=1;var dt=function(a,p){return a<p};function r(a){if(!(this instanceof r))return new r(a);this.array=[],this.size=0,this.compare=a||dt}return r.prototype.clone=function(){var a=new r(this.compare);return a.size=this.size,a.array=this.array.slice(0,this.size),a},r.prototype.add=function(a){var p,_,C=this.size;for(this.array[this.size]=a,this.size+=1;C>0&&(p=C-1>>1,_=this.array[p],this.compare(a,_));)this.array[C]=_,C=p;this.array[C]=a},r.prototype.heapify=function(a){var p;for(this.array=a,this.size=a.length,p=this.size>>1;p>=0;p--)this._percolateDown(p)},r.prototype._percolateUp=function(a,p){for(var _,C,k=this.array[a];a>0&&(_=a-1>>1,C=this.array[_],p||this.compare(k,C));)this.array[a]=C,a=_;this.array[a]=k},r.prototype._percolateDown=function(a){for(var p,_,C,k=this.size,X=this.size>>>1,J=this.array[a];a<X&&(_=(p=1+(a<<1))+1,C=this.array[p],_<k&&this.compare(this.array[_],C)&&(p=_,C=this.array[_]),this.compare(C,J));)this.array[a]=C,a=p;this.array[a]=J},r.prototype._removeAt=function(a){if(!(a>this.size-1||a<0))return this._percolateUp(a,!0),this.poll()},r.prototype.remove=function(a){for(var p=0;p<this.size;p++)if(!this.compare(this.array[p],a)&&!this.compare(a,this.array[p]))return this._removeAt(p),!0;return!1},r.prototype.removeOne=function(a){if(typeof a=="function"){for(var p=0;p<this.size;p++)if(a(this.array[p]))return this._removeAt(p)}},r.prototype.removeMany=function(a,p){if(typeof a!="function"||this.size<1)return[];p=p?Math.min(p,this.size):this.size;for(var _=0,C=new Array(p),k=0,X=new Array(this.size);_<p&&!this.isEmpty();){var J=this.poll();a(J)?C[_++]=J:X[k++]=J}C.length=_;for(var Ct=0;Ct<k;)this.add(X[Ct++]);return C},r.prototype.peek=function(){if(this.size!=0)return this.array[0]},r.prototype.poll=function(){if(this.size!=0){var a=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,a}},r.prototype.replaceTop=function(a){if(this.size!=0){var p=this.array[0];return this.array[0]=a,this._percolateDown(0),p}},r.prototype.trim=function(){this.array=this.array.slice(0,this.size)},r.prototype.isEmpty=function(){return this.size===0},r.prototype.forEach=function(a){if(!this.isEmpty()&&typeof a=="function")for(var p=0,_=this.clone();!_.isEmpty();)a(_.poll(),p++)},r.prototype.kSmallest=function(a){if(this.size==0||a<=0)return[];a=Math.min(this.size,a);const p=Math.min(this.size,2**(a-1)+1);if(p<2)return[this.peek()];const _=new r(this.compare);_.size=p,_.array=this.array.slice(0,p);const C=new Array(a);for(let k=0;k<a;k++)C[k]=_.poll();return C},Ze=r}(),dn=We(gi);let Dn=class{constructor(){this._fpQueue=new dn((dt,r)=>dt.compareTo(r)<0)}poll(){return this._fpQueue.poll()}size(){return this._fpQueue.size}clear(){this._fpQueue=new dn}peek(){return this._fpQueue.peek()}remove(){return this._fpQueue.poll()}isEmpty(){return this._fpQueue.isEmpty()}add(dt){this._fpQueue.add(dt)}};class pr{query(){}insert(r,a){}remove(r,a){}}class Xi{constructor(){Xi.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new $,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this._level=r}}}getLevel(){return this._level}addChildBoundable(r){L.isTrue(this._bounds===null),this._childBoundables.add(r)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}get interfaces_(){return[qt,x]}}class rr{static distance(r,a,p,_){const C=p-r,k=_-a;return Math.sqrt(C*C+k*k)}static maximumDistance(r,a){const p=Math.min(r.getMinX(),a.getMinX()),_=Math.min(r.getMinY(),a.getMinY()),C=Math.max(r.getMaxX(),a.getMaxX()),k=Math.max(r.getMaxY(),a.getMaxY());return rr.distance(p,_,C,k)}static minMaxDistance(r,a){const p=r.getMinX(),_=r.getMinY(),C=r.getMaxX(),k=r.getMaxY(),X=a.getMinX(),J=a.getMinY(),Ct=a.getMaxX(),te=a.getMaxY();let ce=rr.maxDistance(p,_,p,k,X,J,X,te);return ce=Math.min(ce,rr.maxDistance(p,_,p,k,X,J,Ct,J)),ce=Math.min(ce,rr.maxDistance(p,_,p,k,Ct,te,X,te)),ce=Math.min(ce,rr.maxDistance(p,_,p,k,Ct,te,Ct,J)),ce=Math.min(ce,rr.maxDistance(p,_,C,_,X,J,X,te)),ce=Math.min(ce,rr.maxDistance(p,_,C,_,X,J,Ct,J)),ce=Math.min(ce,rr.maxDistance(p,_,C,_,Ct,te,X,te)),ce=Math.min(ce,rr.maxDistance(p,_,C,_,Ct,te,Ct,J)),ce=Math.min(ce,rr.maxDistance(C,k,p,k,X,J,X,te)),ce=Math.min(ce,rr.maxDistance(C,k,p,k,X,J,Ct,J)),ce=Math.min(ce,rr.maxDistance(C,k,p,k,Ct,te,X,te)),ce=Math.min(ce,rr.maxDistance(C,k,p,k,Ct,te,Ct,J)),ce=Math.min(ce,rr.maxDistance(C,k,C,_,X,J,X,te)),ce=Math.min(ce,rr.maxDistance(C,k,C,_,X,J,Ct,J)),ce=Math.min(ce,rr.maxDistance(C,k,C,_,Ct,te,X,te)),ce=Math.min(ce,rr.maxDistance(C,k,C,_,Ct,te,Ct,J)),ce}static maxDistance(r,a,p,_,C,k,X,J){let Ct=rr.distance(r,a,C,k);return Ct=Math.max(Ct,rr.distance(r,a,X,J)),Ct=Math.max(Ct,rr.distance(p,_,C,k)),Ct=Math.max(Ct,rr.distance(p,_,X,J)),Ct}}class Rr{constructor(){Rr.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;const r=arguments[0],a=arguments[1],p=arguments[2];this._boundable1=r,this._boundable2=a,this._itemDistance=p,this._distance=this.distance()}static area(r){return r.getBounds().getArea()}static isComposite(r){return r instanceof Xi}maximumDistance(){return rr.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(r,a){const p=Rr.isComposite(this._boundable1),_=Rr.isComposite(this._boundable2);if(p&&_)return Rr.area(this._boundable1)>Rr.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,r,a),null):(this.expand(this._boundable2,this._boundable1,!0,r,a),null);if(p)return this.expand(this._boundable1,this._boundable2,!1,r,a),null;if(_)return this.expand(this._boundable2,this._boundable1,!0,r,a),null;throw new u("neither boundable is composite")}isLeaves(){return!(Rr.isComposite(this._boundable1)||Rr.isComposite(this._boundable2))}getBoundable(r){return r===0?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}compareTo(r){const a=r;return this._distance<a._distance?-1:this._distance>a._distance?1:0}expand(r,a,p,_,C){for(let k=r.getChildBoundables().iterator();k.hasNext();){const X=k.next();let J=null;J=p?new Rr(a,X,this._itemDistance):new Rr(X,a,this._itemDistance),J.getDistance()<C&&_.add(J)}}get interfaces_(){return[g]}}class Gn{constructor(){Gn.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new $,this._nodeCapacity=null,arguments.length===0)Gn.constructor_.call(this,Gn.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){const r=arguments[0];L.isTrue(r>1,"Node capacity must be greater than 1"),this._nodeCapacity=r}}static compareDoubles(r,a){return r>a?1:r<a?-1:0}queryInternal(){if(pt(arguments[2],ba)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi){const r=arguments[0],a=arguments[2],p=arguments[1].getChildBoundables();for(let _=0;_<p.size();_++){const C=p.get(_);this.getIntersectsOp().intersects(C.getBounds(),r)&&(C instanceof Xi?this.queryInternal(r,C,a):C instanceof be?a.visitItem(C.getItem()):L.shouldNeverReachHere())}}else if(pt(arguments[2],ut)&&arguments[0]instanceof Object&&arguments[1]instanceof Xi){const r=arguments[0],a=arguments[2],p=arguments[1].getChildBoundables();for(let _=0;_<p.size();_++){const C=p.get(_);this.getIntersectsOp().intersects(C.getBounds(),r)&&(C instanceof Xi?this.queryInternal(r,C,a):C instanceof be?a.add(C.getItem()):L.shouldNeverReachHere())}}}insert(r,a){L.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new be(r,a))}boundablesAtLevel(){if(arguments.length===1){const r=arguments[0],a=new $;return this.boundablesAtLevel(r,this._root,a),a}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(L.isTrue(r>-2),a.getLevel()===r)return p.add(a),null;for(let _=a.getChildBoundables().iterator();_.hasNext();){const C=_.next();C instanceof Xi?this.boundablesAtLevel(r,C,p):(L.isTrue(C instanceof be),r===-1&&p.add(C))}return null}}getRoot(){return this.build(),this._root}remove(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.remove(r,this._root,a)}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];let _=this.removeItem(a,p);if(_)return!0;let C=null;for(let k=a.getChildBoundables().iterator();k.hasNext();){const X=k.next();if(this.getIntersectsOp().intersects(X.getBounds(),r)&&X instanceof Xi&&(_=this.remove(r,X,p),_)){C=X;break}}return C!==null&&C.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(C),_}}createHigherLevels(r,a){L.isTrue(!r.isEmpty());const p=this.createParentBoundables(r,a+1);return p.size()===1?p.get(0):this.createHigherLevels(p,a+1)}depth(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){let r=0;for(let a=arguments[0].getChildBoundables().iterator();a.hasNext();){const p=a.next();if(p instanceof Xi){const _=this.depth(p);_>r&&(r=_)}}return r+1}}createParentBoundables(r,a){L.isTrue(!r.isEmpty());const p=new $;p.add(this.createNode(a));const _=new $(r);lr.sort(_,this.getComparator());for(let C=_.iterator();C.hasNext();){const k=C.next();this.lastNode(p).getChildBoundables().size()===this.getNodeCapacity()&&p.add(this.createNode(a)),this.lastNode(p).addChildBoundable(k)}return p}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}getNodeCapacity(){return this._nodeCapacity}lastNode(r){return r.get(r.size()-1)}size(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){let r=0;for(let a=arguments[0].getChildBoundables().iterator();a.hasNext();){const p=a.next();p instanceof Xi?r+=this.size(p):p instanceof be&&(r+=1)}return r}}removeItem(r,a){let p=null;for(let _=r.getChildBoundables().iterator();_.hasNext();){const C=_.next();C instanceof be&&C.getItem()===a&&(p=C)}return p!==null&&(r.getChildBoundables().remove(p),!0)}itemsTree(){if(arguments.length===0){this.build();const r=this.itemsTree(this._root);return r===null?new $:r}if(arguments.length===1){const r=arguments[0],a=new $;for(let p=r.getChildBoundables().iterator();p.hasNext();){const _=p.next();if(_ instanceof Xi){const C=this.itemsTree(_);C!==null&&a.add(C)}else _ instanceof be?a.add(_.getItem()):L.shouldNeverReachHere()}return a.size()<=0?null:a}}query(){if(arguments.length===1){const r=arguments[0];this.build();const a=new $;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.queryInternal(r,this._root,a),a}if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.queryInternal(r,this._root,a)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}get interfaces_(){return[x]}}Gn.IntersectsOp=function(){},Gn.DEFAULT_NODE_CAPACITY=10;class ts{distance(r,a){}}class ri extends Gn{constructor(){super(),ri.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)ri.constructor_.call(this,ri.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){const r=arguments[0];Gn.constructor_.call(this,r)}}static getItems(r){const a=new Array(r.size()).fill(null);let p=0;for(;!r.isEmpty();){const _=r.poll();a[p]=_.getBoundable(0).getItem(),p++}return a}static avg(r,a){return(r+a)/2}static centreY(r){return ri.avg(r.getMinY(),r.getMaxY())}static centreX(r){return ri.avg(r.getMinX(),r.getMaxX())}size(){return arguments.length===0?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof nt))return super.insert.apply(this,arguments);{const r=arguments[0],a=arguments[1];if(r.isNull())return null;super.insert.call(this,r,a)}}getIntersectsOp(){return ri.intersectsOp}verticalSlices(r,a){const p=Math.trunc(Math.ceil(r.size()/a)),_=new Array(a).fill(null),C=r.iterator();for(let k=0;k<a;k++){_[k]=new $;let X=0;for(;C.hasNext()&&X<p;){const J=C.next();_[k].add(J),X++}}return _}query(){if(arguments.length===1){const r=arguments[0];return super.query.call(this,r)}if(arguments.length===2){const r=arguments[0],a=arguments[1];super.query.call(this,r,a)}}getComparator(){return ri.yComparator}createParentBoundablesFromVerticalSlice(r,a){return super.createParentBoundables.call(this,r,a)}remove(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof nt){const r=arguments[0],a=arguments[1];return super.remove.call(this,r,a)}return super.remove.apply(this,arguments)}depth(){return arguments.length===0?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(r,a){L.isTrue(!r.isEmpty());const p=Math.trunc(Math.ceil(r.size()/this.getNodeCapacity())),_=new $(r);lr.sort(_,ri.xComparator);const C=this.verticalSlices(_,Math.trunc(Math.ceil(Math.sqrt(p))));return this.createParentBoundablesFromVerticalSlices(C,a)}nearestNeighbour(){if(arguments.length===1){if(pt(arguments[0],ts)){const r=arguments[0];if(this.isEmpty())return null;const a=new Rr(this.getRoot(),this.getRoot(),r);return this.nearestNeighbour(a)}if(arguments[0]instanceof Rr){const r=arguments[0];let a=m.POSITIVE_INFINITY,p=null;const _=new Dn;for(_.add(r);!_.isEmpty()&&a>0;){const C=_.poll(),k=C.getDistance();if(k>=a)break;C.isLeaves()?(a=k,p=C):C.expandToQueue(_,a)}return p===null?null:[p.getBoundable(0).getItem(),p.getBoundable(1).getItem()]}}else{if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this.isEmpty()||r.isEmpty())return null;const p=new Rr(this.getRoot(),r.getRoot(),a);return this.nearestNeighbour(p)}if(arguments.length===3){const r=arguments[2],a=new be(arguments[0],arguments[1]),p=new Rr(this.getRoot(),a,r);return this.nearestNeighbour(p)[0]}if(arguments.length===4){const r=arguments[2],a=arguments[3],p=new be(arguments[0],arguments[1]),_=new Rr(this.getRoot(),p,r);return this.nearestNeighbourK(_,a)}}}isWithinDistance(){if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=m.POSITIVE_INFINITY;const _=new Dn;for(_.add(r);!_.isEmpty();){const C=_.poll(),k=C.getDistance();if(k>a)return!1;if(C.maximumDistance()<=a)return!0;if(C.isLeaves()){if(p=k,p<=a)return!0}else C.expandToQueue(_,p)}return!1}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2],_=new Rr(this.getRoot(),r.getRoot(),a);return this.isWithinDistance(_,p)}}createParentBoundablesFromVerticalSlices(r,a){L.isTrue(r.length>0);const p=new $;for(let _=0;_<r.length;_++)p.addAll(this.createParentBoundablesFromVerticalSlice(r[_],a));return p}nearestNeighbourK(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.nearestNeighbourK(r,m.POSITIVE_INFINITY,a)}if(arguments.length===3){const r=arguments[0],a=arguments[2];let p=arguments[1];const _=new Dn;_.add(r);const C=new Dn;for(;!_.isEmpty()&&p>=0;){const k=_.poll(),X=k.getDistance();if(X>=p)break;k.isLeaves()?C.size()<a?C.add(k):(C.peek().getDistance()>X&&(C.poll(),C.add(k)),p=C.peek().getDistance()):k.expandToQueue(_,p)}return ri.getItems(C)}}createNode(r){return new Fo(r)}get interfaces_(){return[pr,x]}}class Fo extends Xi{constructor(){super(),Fo.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0];Xi.constructor_.call(this,r)}computeBounds(){let r=null;for(let a=this.getChildBoundables().iterator();a.hasNext();){const p=a.next();r===null?r=new nt(p.getBounds()):r.expandToInclude(p.getBounds())}return r}}ri.STRtreeNode=Fo,ri.xComparator=new class{get interfaces_(){return[U]}compare(dt,r){return Gn.compareDoubles(ri.centreX(dt.getBounds()),ri.centreX(r.getBounds()))}},ri.yComparator=new class{get interfaces_(){return[U]}compare(dt,r){return Gn.compareDoubles(ri.centreY(dt.getBounds()),ri.centreY(r.getBounds()))}},ri.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(dt,r){return dt.intersects(r)}},ri.DEFAULT_NODE_CAPACITY=10;class Zn{constructor(){Zn.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new gr,this._overlapSeg2=new gr}overlap(){if(arguments.length!==2){if(arguments.length===4){const r=arguments[1],a=arguments[2],p=arguments[3];arguments[0].getLineSegment(r,this._overlapSeg1),a.getLineSegment(p,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}let ho=class sE{constructor(){sE.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this._pts=r,this._start=a,this._end=p,this._context=_}computeOverlaps(){if(arguments.length===2){const r=arguments[0],a=arguments[1];this.computeOverlaps(this._start,this._end,r,r._start,r._end,a)}else if(arguments.length===6){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];if(a-r==1&&C-_==1)return k.overlap(this,r,p,_),null;if(!this.overlaps(r,a,p,_,C))return null;const X=Math.trunc((r+a)/2),J=Math.trunc((_+C)/2);r<X&&(_<J&&this.computeOverlaps(r,X,p,_,J,k),J<C&&this.computeOverlaps(r,X,p,J,C,k)),X<a&&(_<J&&this.computeOverlaps(X,a,p,_,J,k),J<C&&this.computeOverlaps(X,a,p,J,C,k))}}setId(r){this._id=r}select(r,a){this.computeSelect(r,this._start,this._end,a)}getEnvelope(){if(this._env===null){const r=this._pts[this._start],a=this._pts[this._end];this._env=new nt(r,a)}return this._env}overlaps(r,a,p,_,C){return nt.intersects(this._pts[r],this._pts[a],p._pts[_],p._pts[C])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}getLineSegment(r,a){a.p0=this._pts[r],a.p1=this._pts[r+1]}computeSelect(r,a,p,_){const C=this._pts[a],k=this._pts[p];if(p-a==1)return _.select(this,a),null;if(!r.intersects(C,k))return null;const X=Math.trunc((a+p)/2);a<X&&this.computeSelect(r,a,X,_),X<p&&this.computeSelect(r,X,p,_)}getCoordinates(){const r=new Array(this._end-this._start+1).fill(null);let a=0;for(let p=this._start;p<=this._end;p++)r[a++]=this._pts[p];return r}};class hi{static isNorthern(r){return r===hi.NE||r===hi.NW}static isOpposite(r,a){return r===a?!1:(r-a+4)%4===2}static commonHalfPlane(r,a){if(r===a)return r;if((r-a+4)%4===2)return-1;const p=r<a?r:a;return p===0&&(r>a?r:a)===3?3:p}static isInHalfPlane(r,a){return a===hi.SE?r===hi.SE||r===hi.SW:r===a||r===a+1}static quadrant(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];if(r===0&&a===0)throw new u("Cannot compute the quadrant for point ( "+r+", "+a+" )");return r>=0?a>=0?hi.NE:hi.SE:a>=0?hi.NW:hi.SW}if(arguments[0]instanceof O&&arguments[1]instanceof O){const r=arguments[0],a=arguments[1];if(a.x===r.x&&a.y===r.y)throw new u("Cannot compute the quadrant for two identical points "+r);return a.x>=r.x?a.y>=r.y?hi.NE:hi.SE:a.y>=r.y?hi.NW:hi.SW}}}hi.NE=0,hi.NW=1,hi.SW=2,hi.SE=3;class gn{static findChainEnd(r,a){let p=a;for(;p<r.length-1&&r[p].equals2D(r[p+1]);)p++;if(p>=r.length-1)return r.length-1;const _=hi.quadrant(r[p],r[p+1]);let C=a+1;for(;C<r.length&&!(!r[C-1].equals2D(r[C])&&hi.quadrant(r[C-1],r[C])!==_);)C++;return C-1}static getChains(){if(arguments.length===1){const r=arguments[0];return gn.getChains(r,null)}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new $;let _=0;do{const C=gn.findChainEnd(r,_),k=new ho(r,_,C,a);p.add(k),_=C}while(_<r.length-1);return p}}}class bi{constructor(){bi.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this.setSegmentIntersector(r)}}}setSegmentIntersector(r){this._segInt=r}get interfaces_(){return[xt]}}class Yr extends bi{constructor(){super(),Yr.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new $,this._index=new ri,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){const r=arguments[0];bi.constructor_.call(this,r)}}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return st.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(r){for(let a=gn.getChains(r.getCoordinates(),r).iterator();a.hasNext();){const p=a.next();p.setId(this._idCounter++),this._index.insert(p.getEnvelope(),p),this._monoChains.add(p)}}computeNodes(r){this._nodedSegStrings=r;for(let a=r.iterator();a.hasNext();)this.add(a.next());this.intersectChains()}intersectChains(){const r=new Bi(this._segInt);for(let a=this._monoChains.iterator();a.hasNext();){const p=a.next();for(let _=this._index.query(p.getEnvelope()).iterator();_.hasNext();){const C=_.next();if(C.getId()>p.getId()&&(p.computeOverlaps(C,r),this._nOverlaps++),this._segInt.isDone())return null}}}}class Bi extends Zn{constructor(){super(),Bi.constructor_.apply(this,arguments)}static constructor_(){this._si=null;const r=arguments[0];this._si=r}overlap(){if(arguments.length!==4)return super.overlap.apply(this,arguments);{const r=arguments[1],a=arguments[2],p=arguments[3],_=arguments[0].getContext(),C=a.getContext();this._si.processIntersections(_,r,C,p)}}}Yr.SegmentOverlapAction=Bi;class An{constructor(){An.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;const r=arguments[0],a=arguments[1],p=arguments[2];if(this._originalPt=r,this._pt=r,this._scaleFactor=a,this._li=p,a<=0)throw new u("Scale factor must be non-zero");a!==1&&(this._pt=new O(this.scale(r.x),this.scale(r.y)),this._p0Scaled=new O,this._p1Scaled=new O),this.initCorners(this._pt)}intersectsScaled(r,a){const p=Math.min(r.x,a.x),_=Math.max(r.x,a.x),C=Math.min(r.y,a.y),k=Math.max(r.y,a.y),X=this._maxx<p||this._minx>_||this._maxy<C||this._miny>k;if(X)return!1;const J=this.intersectsToleranceSquare(r,a);return L.isTrue(!(X&&J),"Found bad envelope test"),J}copyScaled(r,a){a.x=this.scale(r.x),a.y=this.scale(r.y)}getSafeEnvelope(){if(this._safeEnv===null){const r=An.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new nt(this._originalPt.x-r,this._originalPt.x+r,this._originalPt.y-r,this._originalPt.y+r)}return this._safeEnv}intersectsPixelClosure(r,a){return this._li.computeIntersection(r,a,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(r,a,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(r,a,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(r,a,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}intersectsToleranceSquare(r,a){let p=!1,_=!1;return this._li.computeIntersection(r,a,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(r,a,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(p=!0),this._li.computeIntersection(r,a,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(_=!0),this._li.computeIntersection(r,a,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!p||!_)||!!r.equals(this._pt)||!!a.equals(this._pt))))}addSnappedNode(r,a){const p=r.getCoordinate(a),_=r.getCoordinate(a+1);return!!this.intersects(p,_)&&(r.addIntersection(this.getCoordinate(),a),!0)}initCorners(r){this._minx=r.x-.5,this._maxx=r.x+.5,this._miny=r.y-.5,this._maxy=r.y+.5,this._corner[0]=new O(this._maxx,this._maxy),this._corner[1]=new O(this._minx,this._maxy),this._corner[2]=new O(this._minx,this._miny),this._corner[3]=new O(this._maxx,this._miny)}intersects(r,a){return this._scaleFactor===1?this.intersectsScaled(r,a):(this.copyScaled(r,this._p0Scaled),this.copyScaled(a,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(r){return Math.round(r*this._scaleFactor)}getCoordinate(){return this._originalPt}}An.SAFE_ENV_EXPANSION_FACTOR=.75;class Wi{constructor(){Wi.constructor_.apply(this,arguments)}static constructor_(){this.selectedSegment=new gr}select(){if(arguments.length!==1){if(arguments.length===2){const r=arguments[1];arguments[0].getLineSegment(r,this.selectedSegment),this.select(this.selectedSegment)}}}}class ze{constructor(){ze.constructor_.apply(this,arguments)}static constructor_(){this._index=null;const r=arguments[0];this._index=r}snap(){if(arguments.length===1){const r=arguments[0];return this.snap(r,null,-1)}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2],_=r.getSafeEnvelope(),C=new ii(r,a,p);return this._index.query(_,new class{get interfaces_(){return[ba]}visitItem(k){k.select(_,C)}}),C.isNodeAdded()}}}class ii extends Wi{constructor(){super(),ii.constructor_.apply(this,arguments)}static constructor_(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;const r=arguments[0],a=arguments[1],p=arguments[2];this._hotPixel=r,this._parentEdge=a,this._hotPixelVertexIndex=p}select(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof ho))return super.select.apply(this,arguments);{const r=arguments[1],a=arguments[0].getContext();if(this._parentEdge===a&&(r===this._hotPixelVertexIndex||r+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(a,r)}}isNodeAdded(){return this._isNodeAdded}}ze.HotPixelSnapAction=ii;let zr=class{isDone(){}processIntersections(dt,r,a,p){}};class qr{constructor(){qr.constructor_.apply(this,arguments)}static constructor_(){this._li=null,this._interiorIntersections=null;const r=arguments[0];this._li=r,this._interiorIntersections=new $}isDone(){return!1}processIntersections(r,a,p,_){if(r===p&&a===_)return null;const C=r.getCoordinates()[a],k=r.getCoordinates()[a+1],X=p.getCoordinates()[_],J=p.getCoordinates()[_+1];if(this._li.computeIntersection(C,k,X,J),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(let Ct=0;Ct<this._li.getIntersectionNum();Ct++)this._interiorIntersections.add(this._li.getIntersection(Ct));r.addIntersections(this._li,a,0),p.addIntersections(this._li,_,1)}}getInteriorIntersections(){return this._interiorIntersections}get interfaces_(){return[zr]}}class vn{constructor(){vn.constructor_.apply(this,arguments)}static constructor_(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;const r=arguments[0];this._pm=r,this._li=new tn,this._li.setPrecisionModel(r),this._scaleFactor=r.getScale()}checkCorrectness(r){const a=st.getNodedSubstrings(r),p=new Et(a);try{p.checkValid()}catch(_){if(!(_ instanceof h))throw _;_.printStackTrace()}}getNodedSubstrings(){return st.getNodedSubstrings(this._nodedSegStrings)}snapRound(r,a){const p=this.findInteriorIntersections(r,a);this.computeIntersectionSnaps(p),this.computeVertexSnaps(r)}findInteriorIntersections(r,a){const p=new qr(a);return this._noder.setSegmentIntersector(p),this._noder.computeNodes(r),p.getInteriorIntersections()}computeVertexSnaps(){if(pt(arguments[0],T))for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.computeVertexSnaps(a)}else if(arguments[0]instanceof st){const r=arguments[0],a=r.getCoordinates();for(let p=0;p<a.length;p++){const _=new An(a[p],this._scaleFactor,this._li);this._pointSnapper.snap(_,r,p)&&r.addIntersection(a[p],p)}}}computeNodes(r){this._nodedSegStrings=r,this._noder=new Yr,this._pointSnapper=new ze(this._noder.getIndex()),this.snapRound(r,this._li)}computeIntersectionSnaps(r){for(let a=r.iterator();a.hasNext();){const p=a.next(),_=new An(p,this._scaleFactor,this._li);this._pointSnapper.snap(_)}}get interfaces_(){return[xt]}}class Ie{static opposite(r){return r===Ie.LEFT?Ie.RIGHT:r===Ie.RIGHT?Ie.LEFT:r}}Ie.ON=0,Ie.LEFT=1,Ie.RIGHT=2;class lo extends h{constructor(r){super(r),this.name=Object.keys({EmptyStackException:lo})[0]}}class Bn extends ut{constructor(){super(),this.array=[]}add(r){return this.array.push(r),!0}get(r){if(r<0||r>=this.size())throw new ct;return this.array[r]}push(r){return this.array.push(r),r}pop(){if(this.array.length===0)throw new lo;return this.array.pop()}peek(){if(this.array.length===0)throw new lo;return this.array[this.array.length-1]}empty(){return this.array.length===0}isEmpty(){return this.empty()}search(r){return this.array.indexOf(r)}size(){return this.array.length}toArray(){return this.array.slice()}}class bs{constructor(){bs.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(r,a){let p=this.getRightmostSideOfSegment(r,a);return p<0&&(p=this.getRightmostSideOfSegment(r,a-1)),p<0&&(this._minCoord=null,this.checkForRightmostCoordinate(r)),p}findRightmostEdgeAtVertex(){const r=this._minDe.getEdge().getCoordinates();L.isTrue(this._minIndex>0&&this._minIndex<r.length,"rightmost point expected to be interior vertex of edge");const a=r[this._minIndex-1],p=r[this._minIndex+1],_=Yt.index(this._minCoord,p,a);let C=!1;(a.y<this._minCoord.y&&p.y<this._minCoord.y&&_===Yt.COUNTERCLOCKWISE||a.y>this._minCoord.y&&p.y>this._minCoord.y&&_===Yt.CLOCKWISE)&&(C=!0),C&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(r,a){const p=r.getEdge().getCoordinates();if(a<0||a+1>=p.length||p[a].y===p[a+1].y)return-1;let _=Ie.LEFT;return p[a].y<p[a+1].y&&(_=Ie.RIGHT),_}getEdge(){return this._orientedDe}checkForRightmostCoordinate(r){const a=r.getEdge().getCoordinates();for(let p=0;p<a.length-1;p++)(this._minCoord===null||a[p].x>this._minCoord.x)&&(this._minDe=r,this._minIndex=p,this._minCoord=a[p])}findRightmostEdgeAtNode(){const r=this._minDe.getNode().getEdges();this._minDe=r.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(r){for(let a=r.iterator();a.hasNext();){const p=a.next();p.isForward()&&this.checkForRightmostCoordinate(p)}L.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ie.LEFT&&(this._orientedDe=this._minDe.getSym())}}class io{constructor(){this.array=[]}addLast(r){this.array.push(r)}removeFirst(){return this.array.shift()}isEmpty(){return this.array.length===0}}class Ss{constructor(){Ss.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new $,this._nodes=new $,this._rightMostCoord=null,this._env=null,this._finder=new bs}clearVisitedEdges(){for(let r=this._dirEdgeList.iterator();r.hasNext();)r.next().setVisited(!1)}compareTo(r){const a=r;return this._rightMostCoord.x<a._rightMostCoord.x?-1:this._rightMostCoord.x>a._rightMostCoord.x?1:0}getEnvelope(){if(this._env===null){const r=new nt;for(let a=this._dirEdgeList.iterator();a.hasNext();){const p=a.next().getEdge().getCoordinates();for(let _=0;_<p.length-1;_++)r.expandToInclude(p[_])}this._env=r}return this._env}addReachable(r){const a=new Bn;for(a.add(r);!a.empty();){const p=a.pop();this.add(p,a)}}copySymDepths(r){const a=r.getSym();a.setDepth(Ie.LEFT,r.getDepth(Ie.RIGHT)),a.setDepth(Ie.RIGHT,r.getDepth(Ie.LEFT))}add(r,a){r.setVisited(!0),this._nodes.add(r);for(let p=r.getEdges().iterator();p.hasNext();){const _=p.next();this._dirEdgeList.add(_);const C=_.getSym().getNode();C.isVisited()||a.push(C)}}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(r){let a=null;for(let p=r.getEdges().iterator();p.hasNext();){const _=p.next();if(_.isVisited()||_.getSym().isVisited()){a=_;break}}if(a===null)throw new jt("unable to find edge to compute depths at "+r.getCoordinate());r.getEdges().computeDepths(a);for(let p=r.getEdges().iterator();p.hasNext();){const _=p.next();_.setVisited(!0),this.copySymDepths(_)}}computeDepth(r){this.clearVisitedEdges();const a=this._finder.getEdge();a.getNode(),a.getLabel(),a.setEdgeDepths(Ie.RIGHT,r),this.copySymDepths(a),this.computeDepths(a)}create(r){this.addReachable(r),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let r=this._dirEdgeList.iterator();r.hasNext();){const a=r.next();a.getDepth(Ie.RIGHT)>=1&&a.getDepth(Ie.LEFT)<=0&&!a.isInteriorAreaEdge()&&a.setInResult(!0)}}computeDepths(r){const a=new Be,p=new io,_=r.getNode();for(p.addLast(_),a.add(_),r.setVisited(!0);!p.isEmpty();){const C=p.removeFirst();a.add(C),this.computeNodeDepth(C);for(let k=C.getEdges().iterator();k.hasNext();){const X=k.next().getSym();if(X.isVisited())continue;const J=X.getNode();a.contains(J)||(p.addLast(J),a.add(J))}}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[g]}}class en{constructor(){en.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Yt.COUNTERCLOCKWISE;const r=arguments[0];this._inputLine=r}static simplify(r,a){return new en(r).simplify(a)}isDeletable(r,a,p,_){const C=this._inputLine[r],k=this._inputLine[a],X=this._inputLine[p];return!!this.isConcave(C,k,X)&&!!this.isShallow(C,k,X,_)&&this.isShallowSampled(C,k,r,p,_)}deleteShallowConcavities(){let r=1,a=this.findNextNonDeletedIndex(r),p=this.findNextNonDeletedIndex(a),_=!1;for(;p<this._inputLine.length;){let C=!1;this.isDeletable(r,a,p,this._distanceTol)&&(this._isDeleted[a]=en.DELETE,C=!0,_=!0),r=C?p:a,a=this.findNextNonDeletedIndex(r),p=this.findNextNonDeletedIndex(a)}return _}isShallowConcavity(r,a,p,_){return Yt.index(r,a,p)!==this._angleOrientation?!1:je.pointToSegment(a,r,p)<_}isShallowSampled(r,a,p,_,C){let k=Math.trunc((_-p)/en.NUM_PTS_TO_CHECK);k<=0&&(k=1);for(let X=p;X<_;X+=k)if(!this.isShallow(r,a,this._inputLine[X],C))return!1;return!0}isConcave(r,a,p){return Yt.index(r,a,p)===this._angleOrientation}simplify(r){this._distanceTol=Math.abs(r),r<0&&(this._angleOrientation=Yt.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let a=!1;do a=this.deleteShallowConcavities();while(a);return this.collapseLine()}findNextNonDeletedIndex(r){let a=r+1;for(;a<this._inputLine.length&&this._isDeleted[a]===en.DELETE;)a++;return a}isShallow(r,a,p,_){return je.pointToSegment(a,r,p)<_}collapseLine(){const r=new W;for(let a=0;a<this._inputLine.length;a++)this._isDeleted[a]!==en.DELETE&&r.add(this._inputLine[a]);return r.toCoordinateArray()}}en.INIT=0,en.DELETE=1,en.KEEP=1,en.NUM_PTS_TO_CHECK=10;class Zo{constructor(){Zo.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new $}getCoordinates(){return this._ptList.toArray(Zo.COORDINATE_ARRAY_TYPE)}setPrecisionModel(r){this._precisionModel=r}addPt(r){const a=new O(r);if(this._precisionModel.makePrecise(a),this.isRedundant(a))return null;this._ptList.add(a)}reverse(){}addPts(r,a){if(a)for(let p=0;p<r.length;p++)this.addPt(r[p]);else for(let p=r.length-1;p>=0;p--)this.addPt(r[p])}isRedundant(r){if(this._ptList.size()<1)return!1;const a=this._ptList.get(this._ptList.size()-1);return r.distance(a)<this._minimimVertexDistance}toString(){return new Se().createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;const r=new O(this._ptList.get(0)),a=this._ptList.get(this._ptList.size()-1);if(r.equals(a))return null;this._ptList.add(r)}setMinimumVertexDistance(r){this._minimimVertexDistance=r}}Zo.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class mn{constructor(){mn.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gr,this._seg1=new gr,this._offset0=new gr,this._offset1=new gr,this._side=0,this._hasNarrowConcaveAngle=!1;const r=arguments[0],a=arguments[1],p=arguments[2];this._precisionModel=r,this._bufParams=a,this._li=new tn,this._filletAngleQuantum=Math.PI/2/a.getQuadrantSegments(),a.getQuadrantSegments()>=8&&a.getJoinStyle()===Zr.JOIN_ROUND&&(this._closingSegLengthFactor=mn.MAX_CLOSING_SEG_LEN_FACTOR),this.init(p)}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(r,a,p,_){const C=ue.intersection(a.p0,a.p1,p.p0,p.p1);if(C!==null&&(_<=0?1:C.distance(r)/Math.abs(_))<=this._bufParams.getMitreLimit())return this._segList.addPt(C),null;this.addLimitedMitreJoin(a,p,_,this._bufParams.getMitreLimit())}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(r,a,p){this._s1=r,this._s2=a,this._side=p,this._seg1.setCoordinates(r,a),this.computeOffsetSegment(this._seg1,p,this._distance,this._offset1)}addLimitedMitreJoin(r,a,p,_){const C=this._seg0.p1,k=Wr.angle(C,this._seg0.p0),X=Wr.angleBetweenOriented(this._seg0.p0,C,this._seg1.p1)/2,J=Wr.normalize(k+X),Ct=Wr.normalize(J+Math.PI),te=_*p,ce=p-te*Math.abs(Math.sin(X)),Ye=C.x+te*Math.cos(Ct),sr=C.y+te*Math.sin(Ct),Cr=new O(Ye,sr),Ii=new gr(C,Cr),Vn=Ii.pointAlongOffset(1,ce),no=Ii.pointAlongOffset(1,-ce);this._side===Ie.LEFT?(this._segList.addPt(Vn),this._segList.addPt(no)):(this._segList.addPt(no),this._segList.addPt(Vn))}addDirectedFillet(r,a,p,_,C){const k=_===Yt.CLOCKWISE?-1:1,X=Math.abs(a-p),J=Math.trunc(X/this._filletAngleQuantum+.5);if(J<1)return null;const Ct=X/J,te=new O;for(let ce=0;ce<J;ce++){const Ye=a+k*ce*Ct;te.x=r.x+C*Math.cos(Ye),te.y=r.y+C*Math.sin(Ye),this._segList.addPt(te)}}computeOffsetSegment(r,a,p,_){const C=a===Ie.LEFT?1:-1,k=r.p1.x-r.p0.x,X=r.p1.y-r.p0.y,J=Math.sqrt(k*k+X*X),Ct=C*p*k/J,te=C*p*X/J;_.p0.x=r.p0.x-te,_.p0.y=r.p0.y+Ct,_.p1.x=r.p1.x-te,_.p1.y=r.p1.y+Ct}addInsideTurn(r,a){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*mn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){const p=new O((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(p);const _=new O((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(_)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(r){const a=new O(r.x+this._distance,r.y);this._segList.addPt(a),this.addDirectedFillet(r,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(r,a){this._segList.addPt(r.p1),this._segList.addPt(a.p0)}init(r){this._distance=r,this._maxCurveSegmentError=r*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Zo,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(r*mn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(r){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Zr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Zr.JOIN_MITRE?(r&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Yt.CLOCKWISE,this._distance))}addNextSegment(r,a){if(this._s0=this._s1,this._s1=this._s2,this._s2=r,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;const p=Yt.index(this._s0,this._s1,this._s2),_=p===Yt.CLOCKWISE&&this._side===Ie.LEFT||p===Yt.COUNTERCLOCKWISE&&this._side===Ie.RIGHT;p===0?this.addCollinear(a):_?this.addOutsideTurn(p,a):this.addInsideTurn(p,a)}addLineEndCap(r,a){const p=new gr(r,a),_=new gr;this.computeOffsetSegment(p,Ie.LEFT,this._distance,_);const C=new gr;this.computeOffsetSegment(p,Ie.RIGHT,this._distance,C);const k=a.x-r.x,X=a.y-r.y,J=Math.atan2(X,k);switch(this._bufParams.getEndCapStyle()){case Zr.CAP_ROUND:this._segList.addPt(_.p1),this.addDirectedFillet(a,J+Math.PI/2,J-Math.PI/2,Yt.CLOCKWISE,this._distance),this._segList.addPt(C.p1);break;case Zr.CAP_FLAT:this._segList.addPt(_.p1),this._segList.addPt(C.p1);break;case Zr.CAP_SQUARE:const Ct=new O;Ct.x=Math.abs(this._distance)*Math.cos(J),Ct.y=Math.abs(this._distance)*Math.sin(J);const te=new O(_.p1.x+Ct.x,_.p1.y+Ct.y),ce=new O(C.p1.x+Ct.x,C.p1.y+Ct.y);this._segList.addPt(te),this._segList.addPt(ce)}}addOutsideTurn(r,a){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*mn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Zr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Zr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(a&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,r,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(r){this._segList.addPt(new O(r.x+this._distance,r.y+this._distance)),this._segList.addPt(new O(r.x+this._distance,r.y-this._distance)),this._segList.addPt(new O(r.x-this._distance,r.y-this._distance)),this._segList.addPt(new O(r.x-this._distance,r.y+this._distance)),this._segList.closeRing()}addSegments(r,a){this._segList.addPts(r,a)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(r,a,p,_,C){const k=a.x-r.x,X=a.y-r.y;let J=Math.atan2(X,k);const Ct=p.x-r.x,te=p.y-r.y,ce=Math.atan2(te,Ct);_===Yt.CLOCKWISE?J<=ce&&(J+=2*Math.PI):J>=ce&&(J-=2*Math.PI),this._segList.addPt(a),this.addDirectedFillet(r,J,ce,_,C),this._segList.addPt(p)}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}mn.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,mn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,mn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,mn.MAX_CLOSING_SEG_LEN_FACTOR=80;class es{constructor(){es.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;const r=arguments[0],a=arguments[1];this._precisionModel=r,this._bufParams=a}static copyCoordinates(r){const a=new Array(r.length).fill(null);for(let p=0;p<a.length;p++)a[p]=new O(r[p]);return a}getOffsetCurve(r,a){if(this._distance=a,a===0)return null;const p=a<0,_=Math.abs(a),C=this.getSegGen(_);r.length<=1?this.computePointCurve(r[0],C):this.computeOffsetCurve(r,p,C);const k=C.getCoordinates();return p&&De.reverse(k),k}computeSingleSidedBufferCurve(r,a,p){const _=this.simplifyTolerance(this._distance);if(a){p.addSegments(r,!0);const C=en.simplify(r,-_),k=C.length-1;p.initSideSegments(C[k],C[k-1],Ie.LEFT),p.addFirstSegment();for(let X=k-2;X>=0;X--)p.addNextSegment(C[X],!0)}else{p.addSegments(r,!1);const C=en.simplify(r,_),k=C.length-1;p.initSideSegments(C[0],C[1],Ie.LEFT),p.addFirstSegment();for(let X=2;X<=k;X++)p.addNextSegment(C[X],!0)}p.addLastSegment(),p.closeRing()}computeRingBufferCurve(r,a,p){let _=this.simplifyTolerance(this._distance);a===Ie.RIGHT&&(_=-_);const C=en.simplify(r,_),k=C.length-1;p.initSideSegments(C[k-1],C[0],a);for(let X=1;X<=k;X++){const J=X!==1;p.addNextSegment(C[X],J)}p.closeRing()}computeLineBufferCurve(r,a){const p=this.simplifyTolerance(this._distance),_=en.simplify(r,p),C=_.length-1;a.initSideSegments(_[0],_[1],Ie.LEFT);for(let J=2;J<=C;J++)a.addNextSegment(_[J],!0);a.addLastSegment(),a.addLineEndCap(_[C-1],_[C]);const k=en.simplify(r,-p),X=k.length-1;a.initSideSegments(k[X],k[X-1],Ie.LEFT);for(let J=X-2;J>=0;J--)a.addNextSegment(k[J],!0);a.addLastSegment(),a.addLineEndCap(k[1],k[0]),a.closeRing()}computePointCurve(r,a){switch(this._bufParams.getEndCapStyle()){case Zr.CAP_ROUND:a.createCircle(r);break;case Zr.CAP_SQUARE:a.createSquare(r)}}getLineCurve(r,a){if(this._distance=a,this.isLineOffsetEmpty(a))return null;const p=Math.abs(a),_=this.getSegGen(p);if(r.length<=1)this.computePointCurve(r[0],_);else if(this._bufParams.isSingleSided()){const C=a<0;this.computeSingleSidedBufferCurve(r,C,_)}else this.computeLineBufferCurve(r,_);return _.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(r){return r*this._bufParams.getSimplifyFactor()}getRingCurve(r,a,p){if(this._distance=p,r.length<=2)return this.getLineCurve(r,p);if(p===0)return es.copyCoordinates(r);const _=this.getSegGen(p);return this.computeRingBufferCurve(r,a,_),_.getCoordinates()}computeOffsetCurve(r,a,p){const _=this.simplifyTolerance(this._distance);if(a){const C=en.simplify(r,-_),k=C.length-1;p.initSideSegments(C[k],C[k-1],Ie.LEFT),p.addFirstSegment();for(let X=k-2;X>=0;X--)p.addNextSegment(C[X],!0)}else{const C=en.simplify(r,_),k=C.length-1;p.initSideSegments(C[0],C[1],Ie.LEFT),p.addFirstSegment();for(let X=2;X<=k;X++)p.addNextSegment(C[X],!0)}p.addLastSegment()}isLineOffsetEmpty(r){return r===0||r<0&&!this._bufParams.isSingleSided()}getSegGen(r){return new mn(this._precisionModel,this._bufParams,r)}}class On{constructor(){On.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){const r=arguments[0];this.init(r.length)}else if(Number.isInteger(arguments[0])){const r=arguments[0];this.init(1),this.location[Ie.ON]=r}else if(arguments[0]instanceof On){const r=arguments[0];if(this.init(r.location.length),r!==null)for(let a=0;a<this.location.length;a++)this.location[a]=r.location[a]}}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this.init(3),this.location[Ie.ON]=r,this.location[Ie.LEFT]=a,this.location[Ie.RIGHT]=p}}setAllLocations(r){for(let a=0;a<this.location.length;a++)this.location[a]=r}isNull(){for(let r=0;r<this.location.length;r++)if(this.location[r]!==St.NONE)return!1;return!0}setAllLocationsIfNull(r){for(let a=0;a<this.location.length;a++)this.location[a]===St.NONE&&(this.location[a]=r)}isLine(){return this.location.length===1}merge(r){if(r.location.length>this.location.length){const a=new Array(3).fill(null);a[Ie.ON]=this.location[Ie.ON],a[Ie.LEFT]=St.NONE,a[Ie.RIGHT]=St.NONE,this.location=a}for(let a=0;a<this.location.length;a++)this.location[a]===St.NONE&&a<r.location.length&&(this.location[a]=r.location[a])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;const r=this.location[Ie.LEFT];this.location[Ie.LEFT]=this.location[Ie.RIGHT],this.location[Ie.RIGHT]=r}get(r){return r<this.location.length?this.location[r]:St.NONE}isEqualOnSide(r,a){return this.location[a]===r.location[a]}allPositionsEqual(r){for(let a=0;a<this.location.length;a++)if(this.location[a]!==r)return!1;return!0}toString(){const r=new vt;return this.location.length>1&&r.append(St.toLocationSymbol(this.location[Ie.LEFT])),r.append(St.toLocationSymbol(this.location[Ie.ON])),this.location.length>1&&r.append(St.toLocationSymbol(this.location[Ie.RIGHT])),r.toString()}setLocations(r,a,p){this.location[Ie.ON]=r,this.location[Ie.LEFT]=a,this.location[Ie.RIGHT]=p}isArea(){return this.location.length>1}isAnyNull(){for(let r=0;r<this.location.length;r++)if(this.location[r]===St.NONE)return!0;return!1}setLocation(){if(arguments.length===1){const r=arguments[0];this.setLocation(Ie.ON,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.location[r]=a}}init(r){this.location=new Array(r).fill(null),this.setAllLocations(St.NONE)}}class mi{constructor(){mi.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){const r=arguments[0];this.elt[0]=new On(r),this.elt[1]=new On(r)}else if(arguments[0]instanceof mi){const r=arguments[0];this.elt[0]=new On(r.elt[0]),this.elt[1]=new On(r.elt[1])}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.elt[0]=new On(St.NONE),this.elt[1]=new On(St.NONE),this.elt[r].setLocation(a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this.elt[0]=new On(r,a,p),this.elt[1]=new On(r,a,p)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this.elt[0]=new On(St.NONE,St.NONE,St.NONE),this.elt[1]=new On(St.NONE,St.NONE,St.NONE),this.elt[r].setLocations(a,p,_)}}static toLineLabel(r){const a=new mi(St.NONE);for(let p=0;p<2;p++)a.setLocation(p,r.getLocation(p));return a}getGeometryCount(){let r=0;return this.elt[0].isNull()||r++,this.elt[1].isNull()||r++,r}setAllLocations(r,a){this.elt[r].setAllLocations(a)}isNull(r){return this.elt[r].isNull()}setAllLocationsIfNull(){if(arguments.length===1){const r=arguments[0];this.setAllLocationsIfNull(0,r),this.setAllLocationsIfNull(1,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.elt[r].setAllLocationsIfNull(a)}}isLine(r){return this.elt[r].isLine()}merge(r){for(let a=0;a<2;a++)this.elt[a]===null&&r.elt[a]!==null?this.elt[a]=new On(r.elt[a]):this.elt[a].merge(r.elt[a])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(arguments.length===1){const r=arguments[0];return this.elt[r].get(Ie.ON)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.elt[r].get(a)}}toString(){const r=new vt;return this.elt[0]!==null&&(r.append("A:"),r.append(this.elt[0].toString())),this.elt[1]!==null&&(r.append(" B:"),r.append(this.elt[1].toString())),r.toString()}setLocation(){if(arguments.length===2){const r=arguments[0],a=arguments[1];this.elt[r].setLocation(Ie.ON,a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this.elt[r].setLocation(a,p)}}isEqualOnSide(r,a){return this.elt[0].isEqualOnSide(r.elt[0],a)&&this.elt[1].isEqualOnSide(r.elt[1],a)}allPositionsEqual(r,a){return this.elt[r].allPositionsEqual(a)}toLine(r){this.elt[r].isArea()&&(this.elt[r]=new On(this.elt[r].location[0]))}isArea(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){const r=arguments[0];return this.elt[r].isArea()}}isAnyNull(r){return this.elt[r].isAnyNull()}}let Es=class aE{constructor(){aE.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this._label=r}}}setVisited(r){this._isVisited=r}setInResult(r){this._isInResult=r}setLabel(r){this._label=r}getLabel(){return this._label}setCovered(r){this._isCovered=r,this._isCoveredSet=!0}updateIM(r){L.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(r)}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}isInResult(){return this._isInResult}isVisited(){return this._isVisited}},Do=class W0 extends Es{constructor(){super(),W0.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;const r=arguments[0],a=arguments[1];this._coord=r,this._edges=a,this._label=new mi(0,St.NONE)}isIncidentEdgeInResult(){for(let r=this.getEdges().getEdges().iterator();r.hasNext();)if(r.next().getEdge().isInResult())return!0;return!1}isIsolated(){return this._label.getGeometryCount()===1}getCoordinate(){return this._coord}computeMergedLocation(r,a){let p=St.NONE;if(p=this._label.getLocation(a),!r.isNull(a)){const _=r.getLocation(a);p!==St.BOUNDARY&&(p=_)}return p}setLabel(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{const r=arguments[0],a=arguments[1];this._label===null?this._label=new mi(r,a):this._label.setLocation(r,a)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof W0){const r=arguments[0];this.mergeLabel(r._label)}else if(arguments[0]instanceof mi){const r=arguments[0];for(let a=0;a<2;a++){const p=this.computeMergedLocation(r,a);this._label.getLocation(a)===St.NONE&&this._label.setLocation(a,p)}}}add(r){this._edges.insert(r),r.setNode(this)}setLabelBoundary(r){if(this._label===null)return null;let a=St.NONE;this._label!==null&&(a=this._label.getLocation(r));let p=null;switch(a){case St.BOUNDARY:p=St.INTERIOR;break;case St.INTERIOR:default:p=St.BOUNDARY}this._label.setLocation(r,p)}print(r){r.println("node "+this._coord+" lbl: "+this._label)}computeIM(r){}},ia=class lE{constructor(){lE.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new R,this.nodeFact=null;const r=arguments[0];this.nodeFact=r}print(r){for(let a=this.iterator();a.hasNext();)a.next().print(r)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(r){const a=new $;for(let p=this.iterator();p.hasNext();){const _=p.next();_.getLabel().getLocation(r)===St.BOUNDARY&&a.add(_)}return a}add(r){const a=r.getCoordinate();this.addNode(a).add(r)}find(r){return this.nodeMap.get(r)}addNode(){if(arguments[0]instanceof O){const r=arguments[0];let a=this.nodeMap.get(r);return a===null&&(a=this.nodeFact.createNode(r),this.nodeMap.put(r,a)),a}if(arguments[0]instanceof Do){const r=arguments[0],a=this.nodeMap.get(r.getCoordinate());return a===null?(this.nodeMap.put(r.getCoordinate(),r),r):(a.mergeLabel(r),a)}}};class tt{createNode(r){return new Do(r,null)}}class mt{constructor(){mt.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){const r=arguments[0];this._edge=r}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];mt.constructor_.call(this,r,a,p,null)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];mt.constructor_.call(this,r),this.init(a,p),this._label=_}}compareDirection(r){return this._dx===r._dx&&this._dy===r._dy?0:this._quadrant>r._quadrant?1:this._quadrant<r._quadrant?-1:Yt.index(r._p0,r._p1,this._p1)}getDy(){return this._dy}print(r){const a=Math.atan2(this._dy,this._dx),p=this.getClass().getName(),_=p.lastIndexOf("."),C=p.substring(_+1);r.print("  "+C+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+a+"   "+this._label)}getLabel(){return this._label}getEdge(){return this._edge}toString(){const r=Math.atan2(this._dy,this._dx),a=this.getClass().getName(),p=a.lastIndexOf(".");return"  "+a.substring(p+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+r+"   "+this._label}computeLabel(r){}init(r,a){this._p0=r,this._p1=a,this._dx=a.x-r.x,this._dy=a.y-r.y,this._quadrant=hi.quadrant(this._dx,this._dy),L.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}getCoordinate(){return this._p0}setNode(r){this._node=r}compareTo(r){const a=r;return this.compareDirection(a)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getQuadrant(){return this._quadrant}getNode(){return this._node}get interfaces_(){return[g]}}let Pt=class cE extends mt{constructor(){super(),cE.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];const r=arguments[0],a=arguments[1];if(mt.constructor_.call(this,r),this._isForward=a,a)this.init(r.getCoordinate(0),r.getCoordinate(1));else{const p=r.getNumPoints()-1;this.init(r.getCoordinate(p),r.getCoordinate(p-1))}this.computeDirectedLabel()}static depthFactor(r,a){return r===St.EXTERIOR&&a===St.INTERIOR?1:r===St.INTERIOR&&a===St.EXTERIOR?-1:0}setVisited(r){this._isVisited=r}setDepth(r,a){if(this._depth[r]!==-999&&this._depth[r]!==a)throw new jt("assigned depths do not match",this.getCoordinate());this._depth[r]=a}isInteriorAreaEdge(){let r=!0;for(let a=0;a<2;a++)this._label.isArea(a)&&this._label.getLocation(a,Ie.LEFT)===St.INTERIOR&&this._label.getLocation(a,Ie.RIGHT)===St.INTERIOR||(r=!1);return r}setNextMin(r){this._nextMin=r}print(r){super.print.call(this,r),r.print(" "+this._depth[Ie.LEFT]+"/"+this._depth[Ie.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")}setMinEdgeRing(r){this._minEdgeRing=r}getSym(){return this._sym}isForward(){return this._isForward}setSym(r){this._sym=r}setVisitedEdge(r){this.setVisited(r),this._sym.setVisited(r)}getNextMin(){return this._nextMin}getDepth(r){return this._depth[r]}computeDirectedLabel(){this._label=new mi(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}isLineEdge(){const r=this._label.isLine(0)||this._label.isLine(1),a=!this._label.isArea(0)||this._label.allPositionsEqual(0,St.EXTERIOR),p=!this._label.isArea(1)||this._label.allPositionsEqual(1,St.EXTERIOR);return r&&a&&p}setEdgeRing(r){this._edgeRing=r}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let r=this._edge.getDepthDelta();return this._isForward||(r=-r),r}setInResult(r){this._isInResult=r}getEdge(){return this._edge}printEdge(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)}setEdgeDepths(r,a){let p=this.getEdge().getDepthDelta();this._isForward||(p=-p);let _=1;r===Ie.LEFT&&(_=-1);const C=Ie.opposite(r),k=a+p*_;this.setDepth(r,a),this.setDepth(C,k)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(r){this._next=r}isVisited(){return this._isVisited}},Nt=class uE{constructor(){uE.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new $,this._nodes=null,this._edgeEndList=new $,arguments.length===0)this._nodes=new ia(new tt);else if(arguments.length===1){const r=arguments[0];this._nodes=new ia(r)}}static linkResultDirectedEdges(r){for(let a=r.iterator();a.hasNext();)a.next().getEdges().linkResultDirectedEdges()}printEdges(r){r.println("Edges:");for(let a=0;a<this._edges.size();a++){r.println("edge "+a+":");const p=this._edges.get(a);p.print(r),p.eiList.print(r)}}debugPrintln(r){ne.out.println(r)}isBoundaryNode(r,a){const p=this._nodes.find(a);if(p===null)return!1;const _=p.getLabel();return _!==null&&_.getLocation(r)===St.BOUNDARY}linkAllDirectedEdges(){for(let r=this._nodes.iterator();r.hasNext();)r.next().getEdges().linkAllDirectedEdges()}debugPrint(r){ne.out.print(r)}findEdgeEnd(r){for(let a=this.getEdgeEnds().iterator();a.hasNext();){const p=a.next();if(p.getEdge()===r)return p}return null}getNodes(){return this._nodes.values()}findEdge(r,a){for(let p=0;p<this._edges.size();p++){const _=this._edges.get(p),C=_.getCoordinates();if(r.equals(C[0])&&a.equals(C[1]))return _}return null}find(r){return this._nodes.find(r)}addNode(){if(arguments[0]instanceof Do){const r=arguments[0];return this._nodes.addNode(r)}if(arguments[0]instanceof O){const r=arguments[0];return this._nodes.addNode(r)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let r=this._nodes.iterator();r.hasNext();)r.next().getEdges().linkResultDirectedEdges()}matchInSameDirection(r,a,p,_){return!!r.equals(p)&&Yt.index(r,a,_)===Yt.COLLINEAR&&hi.quadrant(r,a)===hi.quadrant(p,_)}getEdgeEnds(){return this._edgeEndList}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(r,a){for(let p=0;p<this._edges.size();p++){const _=this._edges.get(p),C=_.getCoordinates();if(this.matchInSameDirection(r,a,C[0],C[1])||this.matchInSameDirection(r,a,C[C.length-1],C[C.length-2]))return _}return null}insertEdge(r){this._edges.add(r)}addEdges(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this._edges.add(p);const _=new Pt(p,!0),C=new Pt(p,!1);_.setSym(C),C.setSym(_),this.add(_),this.add(C)}}add(r){this._nodes.add(r),this._edgeEndList.add(r)}},Ht=class hE{constructor(){hE.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new $,this._pts=new $,this._label=new mi(St.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new $,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){const r=arguments[0],a=arguments[1];this._geometryFactory=a,this.computePoints(r),this.computeRing()}}}computeRing(){if(this._ring!==null)return null;const r=new Array(this._pts.size()).fill(null);for(let a=0;a<this._pts.size();a++)r[a]=this._pts.get(a);this._ring=this._geometryFactory.createLinearRing(r),this._isHole=Yt.isCCW(this._ring.getCoordinates())}isIsolated(){return this._label.getGeometryCount()===1}computePoints(r){this._startDe=r;let a=r,p=!0;do{if(a===null)throw new jt("Found null DirectedEdge");if(a.getEdgeRing()===this)throw new jt("Directed Edge visited twice during ring-building at "+a.getCoordinate());this._edges.add(a);const _=a.getLabel();L.isTrue(_.isArea()),this.mergeLabel(_),this.addPoints(a.getEdge(),a.isForward(),p),p=!1,this.setEdgeRing(a,this),a=this.getNext(a)}while(a!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(r){return this._pts.get(r)}computeMaxNodeDegree(){this._maxNodeDegree=0;let r=this._startDe;do{const a=r.getNode().getEdges().getOutgoingDegree(this);a>this._maxNodeDegree&&(this._maxNodeDegree=a),r=this.getNext(r)}while(r!==this._startDe);this._maxNodeDegree*=2}addPoints(r,a,p){const _=r.getCoordinates();if(a){let C=1;p&&(C=0);for(let k=C;k<_.length;k++)this._pts.add(_[k])}else{let C=_.length-2;p&&(C=_.length-1);for(let k=C;k>=0;k--)this._pts.add(_[k])}}containsPoint(r){const a=this.getLinearRing();if(!a.getEnvelopeInternal().contains(r)||!Gi.isInRing(r,a.getCoordinates()))return!1;for(let p=this._holes.iterator();p.hasNext();)if(p.next().containsPoint(r))return!1;return!0}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}setShell(r){this._shell=r,r!==null&&r.addHole(this)}toPolygon(r){const a=new Array(this._holes.size()).fill(null);for(let p=0;p<this._holes.size();p++)a[p]=this._holes.get(p).getLinearRing();return r.createPolygon(this.getLinearRing(),a)}isHole(){return this._isHole}setInResult(){let r=this._startDe;do r.getEdge().setInResult(!0),r=r.getNext();while(r!==this._startDe)}addHole(r){this._holes.add(r)}isShell(){return this._shell===null}getLabel(){return this._label}getEdges(){return this._edges}getShell(){return this._shell}mergeLabel(){if(arguments.length===1){const r=arguments[0];this.mergeLabel(r,0),this.mergeLabel(r,1)}else if(arguments.length===2){const r=arguments[1],a=arguments[0].getLocation(r,Ie.RIGHT);if(a===St.NONE)return null;if(this._label.getLocation(r)===St.NONE)return this._label.setLocation(r,a),null}}};class _e extends Ht{constructor(){super(),_e.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ht.constructor_.call(this,r,a)}getNext(r){return r.getNextMin()}setEdgeRing(r,a){r.setMinEdgeRing(a)}}class we extends Ht{constructor(){super(),we.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Ht.constructor_.call(this,r,a)}linkDirectedEdgesForMinimalEdgeRings(){let r=this._startDe;do r.getNode().getEdges().linkMinimalDirectedEdges(this),r=r.getNext();while(r!==this._startDe)}buildMinimalRings(){const r=new $;let a=this._startDe;do{if(a.getMinEdgeRing()===null){const p=new _e(a,this._geometryFactory);r.add(p)}a=a.getNext()}while(a!==this._startDe);return r}getNext(r){return r.getNext()}setEdgeRing(r,a){r.setEdgeRing(a)}}class Te{constructor(){Te.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new $;const r=arguments[0];this._geometryFactory=r}static findEdgeRingContaining(r,a){const p=r.getLinearRing(),_=p.getEnvelopeInternal();let C=p.getCoordinateN(0),k=null,X=null;for(let J=a.iterator();J.hasNext();){const Ct=J.next(),te=Ct.getLinearRing(),ce=te.getEnvelopeInternal();if(ce.equals(_)||!ce.contains(_))continue;C=De.ptNotInList(p.getCoordinates(),te.getCoordinates());let Ye=!1;Gi.isInRing(C,te.getCoordinates())&&(Ye=!0),Ye&&(k===null||X.contains(ce))&&(k=Ct,X=k.getLinearRing().getEnvelopeInternal())}return k}sortShellsAndHoles(r,a,p){for(let _=r.iterator();_.hasNext();){const C=_.next();C.isHole()?p.add(C):a.add(C)}}computePolygons(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next().toPolygon(this._geometryFactory);a.add(_)}return a}placeFreeHoles(r,a){for(let p=a.iterator();p.hasNext();){const _=p.next();if(_.getShell()===null){const C=Te.findEdgeRingContaining(_,r);if(C===null)throw new jt("unable to assign hole to a shell",_.getCoordinate(0));_.setShell(C)}}}buildMinimalEdgeRings(r,a,p){const _=new $;for(let C=r.iterator();C.hasNext();){const k=C.next();if(k.getMaxNodeDegree()>2){k.linkDirectedEdgesForMinimalEdgeRings();const X=k.buildMinimalRings(),J=this.findShell(X);J!==null?(this.placePolygonHoles(J,X),a.add(J)):p.addAll(X)}else _.add(k)}return _}buildMaximalEdgeRings(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();if(_.isInResult()&&_.getLabel().isArea()&&_.getEdgeRing()===null){const C=new we(_,this._geometryFactory);a.add(C),C.setInResult()}}return a}placePolygonHoles(r,a){for(let p=a.iterator();p.hasNext();){const _=p.next();_.isHole()&&_.setShell(r)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(r){let a=0,p=null;for(let _=r.iterator();_.hasNext();){const C=_.next();C.isHole()||(p=C,a++)}return L.isTrue(a<=1,"found two shells in MinimalEdgeRing list"),p}add(){if(arguments.length===1){const r=arguments[0];this.add(r.getEdgeEnds(),r.getNodes())}else if(arguments.length===2){const r=arguments[0],a=arguments[1];Nt.linkResultDirectedEdges(a);const p=this.buildMaximalEdgeRings(r),_=new $,C=this.buildMinimalEdgeRings(p,this._shellList,_);this.sortShellsAndHoles(C,this._shellList,_),this.placeFreeHoles(this._shellList,_)}}}class me{constructor(){me.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new gr;const r=arguments[0];this._subgraphs=r}findStabbedSegments(){if(arguments.length===1){const r=arguments[0],a=new $;for(let p=this._subgraphs.iterator();p.hasNext();){const _=p.next(),C=_.getEnvelope();r.y<C.getMinY()||r.y>C.getMaxY()||this.findStabbedSegments(r,_.getDirectedEdges(),a)}return a}if(arguments.length===3){if(pt(arguments[2],ut)&&arguments[0]instanceof O&&arguments[1]instanceof Pt){const r=arguments[0],a=arguments[1],p=arguments[2],_=a.getEdge().getCoordinates();for(let C=0;C<_.length-1;C++){if(this._seg.p0=_[C],this._seg.p1=_[C+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<r.x||this._seg.isHorizontal()||r.y<this._seg.p0.y||r.y>this._seg.p1.y||Yt.index(this._seg.p0,this._seg.p1,r)===Yt.RIGHT)continue;let k=a.getDepth(Ie.LEFT);this._seg.p0.equals(_[C])||(k=a.getDepth(Ie.RIGHT));const X=new _r(this._seg,k);p.add(X)}}else if(pt(arguments[2],ut)&&arguments[0]instanceof O&&pt(arguments[1],ut)){const r=arguments[0],a=arguments[2];for(let p=arguments[1].iterator();p.hasNext();){const _=p.next();_.isForward()&&this.findStabbedSegments(r,_,a)}}}}getDepth(r){const a=this.findStabbedSegments(r);return a.size()===0?0:lr.min(a)._leftDepth}}class _r{constructor(){_r.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;const r=arguments[0],a=arguments[1];this._upwardSeg=new gr(r),this._leftDepth=a}compareX(r,a){const p=r.p0.compareTo(a.p0);return p!==0?p:r.p1.compareTo(a.p1)}toString(){return this._upwardSeg.toString()}compareTo(r){const a=r;if(this._upwardSeg.minX()>=a._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=a._upwardSeg.minX())return-1;let p=this._upwardSeg.orientationIndex(a._upwardSeg);return p!==0?p:(p=-1*a._upwardSeg.orientationIndex(this._upwardSeg),p!==0?p:this._upwardSeg.compareTo(a._upwardSeg))}get interfaces_(){return[g]}}me.DepthSegment=_r;class Ke{constructor(){Ke.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new $;const r=arguments[0],a=arguments[1],p=arguments[2];this._inputGeom=r,this._distance=a,this._curveBuilder=p}addRingSide(r,a,p,_,C){if(a===0&&r.length<Sr.MINIMUM_VALID_SIZE)return null;let k=_,X=C;r.length>=Sr.MINIMUM_VALID_SIZE&&Yt.isCCW(r)&&(k=C,X=_,p=Ie.opposite(p));const J=this._curveBuilder.getRingCurve(r,p,a);this.addCurve(J,k,X)}addRingBothSides(r,a){this.addRingSide(r,a,Ie.LEFT,St.EXTERIOR,St.INTERIOR),this.addRingSide(r,a,Ie.RIGHT,St.INTERIOR,St.EXTERIOR)}addPoint(r){if(this._distance<=0)return null;const a=r.getCoordinates(),p=this._curveBuilder.getLineCurve(a,this._distance);this.addCurve(p,St.EXTERIOR,St.INTERIOR)}addPolygon(r){let a=this._distance,p=Ie.LEFT;this._distance<0&&(a=-this._distance,p=Ie.RIGHT);const _=r.getExteriorRing(),C=De.removeRepeatedPoints(_.getCoordinates());if(this._distance<0&&this.isErodedCompletely(_,this._distance)||this._distance<=0&&C.length<3)return null;this.addRingSide(C,a,p,St.EXTERIOR,St.INTERIOR);for(let k=0;k<r.getNumInteriorRing();k++){const X=r.getInteriorRingN(k),J=De.removeRepeatedPoints(X.getCoordinates());this._distance>0&&this.isErodedCompletely(X,-this._distance)||this.addRingSide(J,a,Ie.opposite(p),St.INTERIOR,St.EXTERIOR)}}isTriangleErodedCompletely(r,a){const p=new qi(r[0],r[1],r[2]),_=p.inCentre();return je.pointToSegment(_,p.p0,p.p1)<Math.abs(a)}addLineString(r){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;const a=De.removeRepeatedPoints(r.getCoordinates());if(De.isRing(a)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(a,this._distance);else{const p=this._curveBuilder.getLineCurve(a,this._distance);this.addCurve(p,St.EXTERIOR,St.INTERIOR)}}add(r){if(r.isEmpty())return null;if(r instanceof Ut)this.addPolygon(r);else if(r instanceof Ee)this.addLineString(r);else if(r instanceof zt)this.addPoint(r);else if(r instanceof ve)this.addCollection(r);else if(r instanceof ar)this.addCollection(r);else if(r instanceof ae)this.addCollection(r);else{if(!(r instanceof Ot))throw new Fe(r.getGeometryType());this.addCollection(r)}}addCurve(r,a,p){if(r===null||r.length<2)return null;const _=new st(r,new mi(0,St.BOUNDARY,a,p));this._curveList.add(_)}getCurves(){return this.add(this._inputGeom),this._curveList}isErodedCompletely(r,a){const p=r.getCoordinates();if(p.length<4)return a<0;if(p.length===4)return this.isTriangleErodedCompletely(p,a);const _=r.getEnvelopeInternal(),C=Math.min(_.getHeight(),_.getWidth());return a<0&&2*Math.abs(a)>C}addCollection(r){for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);this.add(p)}}}class er{constructor(){er.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new R,this._edgeList=null,this._ptInAreaLocation=[St.NONE,St.NONE]}getNextCW(r){this.getEdges();const a=this._edgeList.indexOf(r);let p=a-1;return a===0&&(p=this._edgeList.size()-1),this._edgeList.get(p)}propagateSideLabels(r){let a=St.NONE;for(let _=this.iterator();_.hasNext();){const C=_.next().getLabel();C.isArea(r)&&C.getLocation(r,Ie.LEFT)!==St.NONE&&(a=C.getLocation(r,Ie.LEFT))}if(a===St.NONE)return null;let p=a;for(let _=this.iterator();_.hasNext();){const C=_.next(),k=C.getLabel();if(k.getLocation(r,Ie.ON)===St.NONE&&k.setLocation(r,Ie.ON,p),k.isArea(r)){const X=k.getLocation(r,Ie.LEFT),J=k.getLocation(r,Ie.RIGHT);if(J!==St.NONE){if(J!==p)throw new jt("side location conflict",C.getCoordinate());X===St.NONE&&L.shouldNeverReachHere("found single null side (at "+C.getCoordinate()+")"),p=X}else L.isTrue(k.getLocation(r,Ie.LEFT)===St.NONE,"found single null side"),k.setLocation(r,Ie.RIGHT,p),k.setLocation(r,Ie.LEFT,p)}}}getCoordinate(){const r=this.iterator();return r.hasNext()?r.next().getCoordinate():null}checkAreaLabelsConsistent(r){const a=this.getEdges();if(a.size()<=0)return!0;const p=a.size()-1,_=a.get(p).getLabel().getLocation(r,Ie.LEFT);L.isTrue(_!==St.NONE,"Found unlabelled area edge");let C=_;for(let k=this.iterator();k.hasNext();){const X=k.next().getLabel();L.isTrue(X.isArea(r),"Found non-area edge");const J=X.getLocation(r,Ie.LEFT),Ct=X.getLocation(r,Ie.RIGHT);if(J===Ct||Ct!==C)return!1;C=J}return!0}findIndex(r){this.iterator();for(let a=0;a<this._edgeList.size();a++)if(this._edgeList.get(a)===r)return a;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return this._edgeList===null&&(this._edgeList=new $(this._edgeMap.values())),this._edgeList}getLocation(r,a,p){return this._ptInAreaLocation[r]===St.NONE&&(this._ptInAreaLocation[r]=Yn.locate(a,p[r].getGeometry())),this._ptInAreaLocation[r]}toString(){const r=new vt;r.append("EdgeEndStar:   "+this.getCoordinate()),r.append(`
`);for(let a=this.iterator();a.hasNext();){const p=a.next();r.append(p),r.append(`
`)}return r.toString()}computeEdgeEndLabels(r){for(let a=this.iterator();a.hasNext();)a.next().computeLabel(r)}computeLabelling(r){this.computeEdgeEndLabels(r[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);const a=[!1,!1];for(let p=this.iterator();p.hasNext();){const _=p.next().getLabel();for(let C=0;C<2;C++)_.isLine(C)&&_.getLocation(C)===St.BOUNDARY&&(a[C]=!0)}for(let p=this.iterator();p.hasNext();){const _=p.next(),C=_.getLabel();for(let k=0;k<2;k++)if(C.isAnyNull(k)){let X=St.NONE;if(a[k])X=St.EXTERIOR;else{const J=_.getCoordinate();X=this.getLocation(k,J,r)}C.setAllLocationsIfNull(k,X)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(r,a){this._edgeMap.put(r,a),this._edgeList=null}print(r){ne.out.println("EdgeEndStar:   "+this.getCoordinate());for(let a=this.iterator();a.hasNext();)a.next().print(r)}isAreaLabelsConsistent(r){return this.computeEdgeEndLabels(r.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}}let wr=class pE extends er{constructor(){super(),pE.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let r=null,a=null,p=this._SCANNING_FOR_INCOMING;for(let _=0;_<this._resultAreaEdgeList.size();_++){const C=this._resultAreaEdgeList.get(_),k=C.getSym();if(C.getLabel().isArea())switch(r===null&&C.isInResult()&&(r=C),p){case this._SCANNING_FOR_INCOMING:if(!k.isInResult())continue;a=k,p=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!C.isInResult())continue;a.setNext(C),p=this._SCANNING_FOR_INCOMING}}if(p===this._LINKING_TO_OUTGOING){if(r===null)throw new jt("no outgoing dirEdge found",this.getCoordinate());L.isTrue(r.isInResult(),"unable to link last incoming dirEdge"),a.setNext(r)}}insert(r){const a=r;this.insertEdgeEnd(a,a)}getRightmostEdge(){const r=this.getEdges(),a=r.size();if(a<1)return null;const p=r.get(0);if(a===1)return p;const _=r.get(a-1),C=p.getQuadrant(),k=_.getQuadrant();return hi.isNorthern(C)&&hi.isNorthern(k)?p:hi.isNorthern(C)||hi.isNorthern(k)?p.getDy()!==0?p:_.getDy()!==0?_:(L.shouldNeverReachHere("found two horizontal edges incident on node"),null):_}updateLabelling(r){for(let a=this.iterator();a.hasNext();){const p=a.next().getLabel();p.setAllLocationsIfNull(0,r.getLocation(0)),p.setAllLocationsIfNull(1,r.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let r=null,a=null;for(let p=this._edgeList.size()-1;p>=0;p--){const _=this._edgeList.get(p),C=_.getSym();a===null&&(a=C),r!==null&&C.setNext(r),r=_}a.setNext(r)}computeDepths(){if(arguments.length===1){const r=arguments[0],a=this.findIndex(r),p=r.getDepth(Ie.LEFT),_=r.getDepth(Ie.RIGHT),C=this.computeDepths(a+1,this._edgeList.size(),p);if(this.computeDepths(0,a,C)!==_)throw new jt("depth mismatch at "+r.getCoordinate())}else if(arguments.length===3){const r=arguments[1];let a=arguments[2];for(let p=arguments[0];p<r;p++){const _=this._edgeList.get(p);_.setEdgeDepths(Ie.RIGHT,a),a=_.getDepth(Ie.LEFT)}return a}}mergeSymLabels(){for(let r=this.iterator();r.hasNext();){const a=r.next();a.getLabel().merge(a.getSym().getLabel())}}linkMinimalDirectedEdges(r){let a=null,p=null,_=this._SCANNING_FOR_INCOMING;for(let C=this._resultAreaEdgeList.size()-1;C>=0;C--){const k=this._resultAreaEdgeList.get(C),X=k.getSym();switch(a===null&&k.getEdgeRing()===r&&(a=k),_){case this._SCANNING_FOR_INCOMING:if(X.getEdgeRing()!==r)continue;p=X,_=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(k.getEdgeRing()!==r)continue;p.setNextMin(k),_=this._SCANNING_FOR_INCOMING}}_===this._LINKING_TO_OUTGOING&&(L.isTrue(a!==null,"found null for first outgoing dirEdge"),L.isTrue(a.getEdgeRing()===r,"unable to link last incoming dirEdge"),p.setNextMin(a))}getOutgoingDegree(){if(arguments.length===0){let r=0;for(let a=this.iterator();a.hasNext();)a.next().isInResult()&&r++;return r}if(arguments.length===1){const r=arguments[0];let a=0;for(let p=this.iterator();p.hasNext();)p.next().getEdgeRing()===r&&a++;return a}}getLabel(){return this._label}findCoveredLineEdges(){let r=St.NONE;for(let p=this.iterator();p.hasNext();){const _=p.next(),C=_.getSym();if(!_.isLineEdge()){if(_.isInResult()){r=St.INTERIOR;break}if(C.isInResult()){r=St.EXTERIOR;break}}}if(r===St.NONE)return null;let a=r;for(let p=this.iterator();p.hasNext();){const _=p.next(),C=_.getSym();_.isLineEdge()?_.getEdge().setCovered(a===St.INTERIOR):(_.isInResult()&&(a=St.EXTERIOR),C.isInResult()&&(a=St.INTERIOR))}}computeLabelling(r){super.computeLabelling.call(this,r),this._label=new mi(St.NONE);for(let a=this.iterator();a.hasNext();){const p=a.next().getEdge().getLabel();for(let _=0;_<2;_++){const C=p.getLocation(_);C!==St.INTERIOR&&C!==St.BOUNDARY||this._label.setLocation(_,St.INTERIOR)}}}print(r){ne.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let a=this.iterator();a.hasNext();){const p=a.next();r.print("out "),p.print(r),r.println(),r.print("in "),p.getSym().print(r),r.println()}}getResultAreaEdges(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new $;for(let r=this.iterator();r.hasNext();){const a=r.next();(a.isInResult()||a.getSym().isInResult())&&this._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList}};class ie extends tt{constructor(){super()}createNode(r){return new Do(r,new wr)}}class ti{constructor(){ti.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;const r=arguments[0];this._pts=r,this._orientation=ti.orientation(r)}static orientation(r){return De.increasingDirection(r)===1}static compareOriented(r,a,p,_){const C=a?1:-1,k=_?1:-1,X=a?r.length:-1,J=_?p.length:-1;let Ct=a?0:r.length-1,te=_?0:p.length-1;for(;;){const ce=r[Ct].compareTo(p[te]);if(ce!==0)return ce;Ct+=C,te+=k;const Ye=Ct===X,sr=te===J;if(Ye&&!sr)return-1;if(!Ye&&sr)return 1;if(Ye&&sr)return 0}}compareTo(r){const a=r;return ti.compareOriented(this._pts,this._orientation,a._pts,a._orientation)}get interfaces_(){return[g]}}class Ti{constructor(){Ti.constructor_.apply(this,arguments)}static constructor_(){this._edges=new $,this._ocaMap=new R}print(r){r.print("MULTILINESTRING ( ");for(let a=0;a<this._edges.size();a++){const p=this._edges.get(a);a>0&&r.print(","),r.print("(");const _=p.getCoordinates();for(let C=0;C<_.length;C++)C>0&&r.print(","),r.print(_[C].x+" "+_[C].y);r.println(")")}r.print(")  ")}addAll(r){for(let a=r.iterator();a.hasNext();)this.add(a.next())}findEdgeIndex(r){for(let a=0;a<this._edges.size();a++)if(this._edges.get(a).equals(r))return a;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(r){return this._edges.get(r)}findEqualEdge(r){const a=new ti(r.getCoordinates());return this._ocaMap.get(a)}add(r){this._edges.add(r);const a=new ti(r.getCoordinates());this._ocaMap.put(a,r)}}class Si{constructor(){Si.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;const r=arguments[0];this._li=r}static isAdjacentSegments(r,a){return Math.abs(r-a)===1}isTrivialIntersection(r,a,p,_){if(r===p&&this._li.getIntersectionNum()===1){if(Si.isAdjacentSegments(a,_))return!0;if(r.isClosed()){const C=r.size()-1;if(a===0&&_===C||_===0&&a===C)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(r,a,p,_){if(r===p&&a===_)return null;this.numTests++;const C=r.getCoordinates()[a],k=r.getCoordinates()[a+1],X=p.getCoordinates()[_],J=p.getCoordinates()[_+1];this._li.computeIntersection(C,k,X,J),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(r,a,p,_)||(this._hasIntersection=!0,r.addIntersections(this._li,a,0),p.addIntersections(this._li,_,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[zr]}}class Yi{constructor(){Yi.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;const r=arguments[0],a=arguments[1],p=arguments[2];this.coord=new O(r),this.segmentIndex=a,this.dist=p}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(r){r.print(this.coord),r.print(" seg # = "+this.segmentIndex),r.println(" dist = "+this.dist)}compareTo(r){const a=r;return this.compare(a.segmentIndex,a.dist)}isEndPoint(r){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===r}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(r,a){return this.segmentIndex<r?-1:this.segmentIndex>r?1:this.dist<a?-1:this.dist>a?1:0}get interfaces_(){return[g]}}class sn{constructor(){sn.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new R,this.edge=null;const r=arguments[0];this.edge=r}print(r){r.println("Intersections:");for(let a=this.iterator();a.hasNext();)a.next().print(r)}addEndpoints(){const r=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[r],r,0)}createSplitEdge(r,a){let p=a.segmentIndex-r.segmentIndex+2;const _=this.edge.pts[a.segmentIndex],C=a.dist>0||!a.coord.equals2D(_);C||p--;const k=new Array(p).fill(null);let X=0;k[X++]=new O(r.coord);for(let J=r.segmentIndex+1;J<=a.segmentIndex;J++)k[X++]=this.edge.pts[J];return C&&(k[X]=a.coord),new zn(k,new mi(this.edge._label))}add(r,a,p){const _=new Yi(r,a,p),C=this._nodeMap.get(_);return C!==null?C:(this._nodeMap.put(_,_),_)}isIntersection(r){for(let a=this.iterator();a.hasNext();)if(a.next().coord.equals(r))return!0;return!1}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(r){this.addEndpoints();const a=this.iterator();let p=a.next();for(;a.hasNext();){const _=a.next(),C=this.createSplitEdge(p,_);r.add(C),p=_}}}class Zi{constructor(){Zi.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map(()=>Array(3));for(let r=0;r<2;r++)for(let a=0;a<3;a++)this._depth[r][a]=Zi.NULL_VALUE}static depthAtLocation(r){return r===St.EXTERIOR?0:r===St.INTERIOR?1:Zi.NULL_VALUE}getDepth(r,a){return this._depth[r][a]}setDepth(r,a,p){this._depth[r][a]=p}isNull(){if(arguments.length===0){for(let r=0;r<2;r++)for(let a=0;a<3;a++)if(this._depth[r][a]!==Zi.NULL_VALUE)return!1;return!0}if(arguments.length===1){const r=arguments[0];return this._depth[r][1]===Zi.NULL_VALUE}if(arguments.length===2){const r=arguments[0],a=arguments[1];return this._depth[r][a]===Zi.NULL_VALUE}}normalize(){for(let r=0;r<2;r++)if(!this.isNull(r)){let a=this._depth[r][1];this._depth[r][2]<a&&(a=this._depth[r][2]),a<0&&(a=0);for(let p=1;p<3;p++){let _=0;this._depth[r][p]>a&&(_=1),this._depth[r][p]=_}}}getDelta(r){return this._depth[r][Ie.RIGHT]-this._depth[r][Ie.LEFT]}getLocation(r,a){return this._depth[r][a]<=0?St.EXTERIOR:St.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(arguments.length===1){const r=arguments[0];for(let a=0;a<2;a++)for(let p=1;p<3;p++){const _=r.getLocation(a,p);_!==St.EXTERIOR&&_!==St.INTERIOR||(this.isNull(a,p)?this._depth[a][p]=Zi.depthAtLocation(_):this._depth[a][p]+=Zi.depthAtLocation(_))}}else if(arguments.length===3){const r=arguments[0],a=arguments[1];arguments[2]===St.INTERIOR&&this._depth[r][a]++}}}Zi.NULL_VALUE=-1;class jr{constructor(){jr.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,arguments.length===0)jr.constructor_.call(this,10);else if(arguments.length===1){const r=arguments[0];this._data=new Array(r).fill(null)}}size(){return this._size}addAll(r){return r===null||r.length===0?null:(this.ensureCapacity(this._size+r.length),ne.arraycopy(r,0,this._data,this._size,r.length),void(this._size+=r.length))}ensureCapacity(r){if(r<=this._data.length)return null;const a=Math.max(r,2*this._data.length);this._data=Ft.copyOf(this._data,a)}toArray(){const r=new Array(this._size).fill(null);return ne.arraycopy(this._data,0,r,0,this._size),r}add(r){this.ensureCapacity(this._size+1),this._data[this._size]=r,++this._size}}class an{static toIntArray(r){const a=new Array(r.size()).fill(null);for(let p=0;p<a.length;p++)a[p]=r.get(p).intValue();return a}findChainEnd(r,a){const p=hi.quadrant(r[a],r[a+1]);let _=a+1;for(;_<r.length&&hi.quadrant(r[_-1],r[_])===p;)_++;return _-1}OLDgetChainStartIndices(r){let a=0;const p=new $;p.add(a);do{const _=this.findChainEnd(r,a);p.add(_),a=_}while(a<r.length-1);return an.toIntArray(p)}getChainStartIndices(r){let a=0;const p=new jr(Math.trunc(r.length/2));p.add(a);do{const _=this.findChainEnd(r,a);p.add(_),a=_}while(a<r.length-1);return p.toArray()}}class ji{constructor(){ji.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;const r=arguments[0];this.e=r,this.pts=r.getCoordinates();const a=new an;this.startIndex=a.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(r){const a=this.pts[this.startIndex[r]].x,p=this.pts[this.startIndex[r+1]].x;return a>p?a:p}getMinX(r){const a=this.pts[this.startIndex[r]].x,p=this.pts[this.startIndex[r+1]].x;return a<p?a:p}computeIntersectsForChain(){if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this.computeIntersectsForChain(this.startIndex[r],this.startIndex[r+1],a,a.startIndex[p],a.startIndex[p+1],_)}else if(arguments.length===6){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];if(a-r==1&&C-_==1)return k.addIntersections(this.e,r,p.e,_),null;if(!this.overlaps(r,a,p,_,C))return null;const X=Math.trunc((r+a)/2),J=Math.trunc((_+C)/2);r<X&&(_<J&&this.computeIntersectsForChain(r,X,p,_,J,k),J<C&&this.computeIntersectsForChain(r,X,p,J,C,k)),X<a&&(_<J&&this.computeIntersectsForChain(X,a,p,_,J,k),J<C&&this.computeIntersectsForChain(X,a,p,J,C,k))}}overlaps(r,a,p,_,C){return nt.intersects(this.pts[r],this.pts[a],p.pts[_],p.pts[C])}getStartIndexes(){return this.startIndex}computeIntersects(r,a){for(let p=0;p<this.startIndex.length-1;p++)for(let _=0;_<r.startIndex.length-1;_++)this.computeIntersectsForChain(p,r,_,a)}}let zn=class af extends Es{constructor(){super(),af.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new sn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Zi,this._depthDelta=0,arguments.length===1){const r=arguments[0];af.constructor_.call(this,r,null)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this.pts=r,this._label=a}}static updateIM(){if(!(arguments.length===2&&arguments[1]instanceof _i&&arguments[0]instanceof mi))return super.updateIM.apply(this,arguments);{const r=arguments[0],a=arguments[1];a.setAtLeastIfValid(r.getLocation(0,Ie.ON),r.getLocation(1,Ie.ON),1),r.isArea()&&(a.setAtLeastIfValid(r.getLocation(0,Ie.LEFT),r.getLocation(1,Ie.LEFT),2),a.setAtLeastIfValid(r.getLocation(0,Ie.RIGHT),r.getLocation(1,Ie.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){const r=new Array(2).fill(null);return r[0]=this.pts[0],r[1]=this.pts[1],new af(r,mi.toLineLabel(this._label))}setIsolated(r){this._isIsolated=r}setName(r){this._name=r}equals(r){if(!(r instanceof af))return!1;const a=r;if(this.pts.length!==a.pts.length)return!1;let p=!0,_=!0,C=this.pts.length;for(let k=0;k<this.pts.length;k++)if(this.pts[k].equals2D(a.pts[k])||(p=!1),this.pts[k].equals2D(a.pts[--C])||(_=!1),!p&&!_)return!1;return!0}getCoordinate(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){const r=arguments[0];return this.pts[r]}}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}setDepthDelta(r){this._depthDelta=r}getEdgeIntersectionList(){return this.eiList}addIntersections(r,a,p){for(let _=0;_<r.getIntersectionNum();_++)this.addIntersection(r,a,p,_)}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}print(r){r.print("edge "+this._name+": "),r.print("LINESTRING (");for(let a=0;a<this.pts.length;a++)a>0&&r.print(","),r.print(this.pts[a].x+" "+this.pts[a].y);r.print(")  "+this._label+" "+this._depthDelta)}computeIM(r){af.updateIM(this._label,r)}isCollapsed(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(r){r.print("edge "+this._name+": ");for(let a=this.pts.length-1;a>=0;a--)r.print(this.pts[a]+" ");r.println("")}getMonotoneChainEdge(){return this._mce===null&&(this._mce=new ji(this)),this._mce}getEnvelope(){if(this._env===null){this._env=new nt;for(let r=0;r<this.pts.length;r++)this._env.expandToInclude(this.pts[r])}return this._env}addIntersection(r,a,p,_){const C=new O(r.getIntersection(_));let k=a,X=r.getEdgeDistance(p,_);const J=k+1;if(J<this.pts.length){const Ct=this.pts[J];C.equals2D(Ct)&&(k=J,X=0)}this.eiList.add(C,k,X)}toString(){const r=new xn;r.append("edge "+this._name+": "),r.append("LINESTRING (");for(let a=0;a<this.pts.length;a++)a>0&&r.append(","),r.append(this.pts[a].x+" "+this.pts[a].y);return r.append(")  "+this._label+" "+this._depthDelta),r.toString()}isPointwiseEqual(r){if(this.pts.length!==r.pts.length)return!1;for(let a=0;a<this.pts.length;a++)if(!this.pts[a].equals2D(r.pts[a]))return!1;return!0}};class xo{constructor(){xo.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ti;const r=arguments[0];this._bufParams=r}static convertSegStrings(r){const a=new Se,p=new $;for(;r.hasNext();){const _=r.next(),C=a.createLineString(_.getCoordinates());p.add(C)}return a.buildGeometry(p)}static depthDelta(r){const a=r.getLocation(0,Ie.LEFT),p=r.getLocation(0,Ie.RIGHT);return a===St.INTERIOR&&p===St.EXTERIOR?1:a===St.EXTERIOR&&p===St.INTERIOR?-1:0}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(r){if(this._workingNoder!==null)return this._workingNoder;const a=new Yr,p=new tn;return p.setPrecisionModel(r),a.setSegmentIntersector(new Si(p)),a}buffer(r,a){let p=this._workingPrecisionModel;p===null&&(p=r.getPrecisionModel()),this._geomFact=r.getFactory();const _=new es(p,this._bufParams),C=new Ke(r,a,_).getCurves();if(C.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(C,p),this._graph=new Nt(new ie),this._graph.addEdges(this._edgeList.getEdges());const k=this.createSubgraphs(this._graph),X=new Te(this._geomFact);this.buildSubgraphs(k,X);const J=X.getPolygons();return J.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(J)}computeNodedEdges(r,a){const p=this.getNoder(a);p.computeNodes(r);for(let _=p.getNodedSubstrings().iterator();_.hasNext();){const C=_.next(),k=C.getCoordinates();if(k.length===2&&k[0].equals2D(k[1]))continue;const X=C.getData(),J=new zn(C.getCoordinates(),new mi(X));this.insertUniqueEdge(J)}}setNoder(r){this._workingNoder=r}setWorkingPrecisionModel(r){this._workingPrecisionModel=r}insertUniqueEdge(r){const a=this._edgeList.findEqualEdge(r);if(a!==null){const p=a.getLabel();let _=r.getLabel();a.isPointwiseEqual(r)||(_=new mi(r.getLabel()),_.flip()),p.merge(_);const C=xo.depthDelta(_),k=a.getDepthDelta()+C;a.setDepthDelta(k)}else this._edgeList.add(r),r.setDepthDelta(xo.depthDelta(r.getLabel()))}buildSubgraphs(r,a){const p=new $;for(let _=r.iterator();_.hasNext();){const C=_.next(),k=C.getRightmostCoordinate(),X=new me(p).getDepth(k);C.computeDepth(X),C.findResultEdges(),p.add(C),a.add(C.getDirectedEdges(),C.getNodes())}}createSubgraphs(r){const a=new $;for(let p=r.getNodes().iterator();p.hasNext();){const _=p.next();if(!_.isVisited()){const C=new Ss;C.create(_),a.add(C)}}return lr.sort(a,lr.reverseOrder()),a}}class Vi{constructor(){Vi.constructor_.apply(this,arguments)}static constructor_(){if(this._argGeom=null,this._distance=null,this._bufParams=new Zr,this._resultGeometry=null,this._saveException=null,arguments.length===1){const r=arguments[0];this._argGeom=r}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._argGeom=r,this._bufParams=a}}static bufferOp(){if(arguments.length===2){const r=arguments[1];return new Vi(arguments[0]).getResultGeometry(r)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof oe&&typeof arguments[1]=="number"){const r=arguments[1],a=arguments[2],p=new Vi(arguments[0]);return p.setQuadrantSegments(a),p.getResultGeometry(r)}if(arguments[2]instanceof Zr&&arguments[0]instanceof oe&&typeof arguments[1]=="number"){const r=arguments[1];return new Vi(arguments[0],arguments[2]).getResultGeometry(r)}}else if(arguments.length===4){const r=arguments[1],a=arguments[2],p=arguments[3],_=new Vi(arguments[0]);return _.setQuadrantSegments(a),_.setEndCapStyle(p),_.getResultGeometry(r)}}static precisionScaleFactor(r,a,p){const _=r.getEnvelopeInternal(),C=dr.max(Math.abs(_.getMaxX()),Math.abs(_.getMaxY()),Math.abs(_.getMinX()),Math.abs(_.getMinY()))+2*(a>0?a:0),k=p-Math.trunc(Math.log(C)/Math.log(10)+1);return Math.pow(10,k)}bufferFixedPrecision(r){const a=new Tt(new vn(new Oe(1)),r.getScale()),p=new xo(this._bufParams);p.setWorkingPrecisionModel(r),p.setNoder(a),this._resultGeometry=p.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(arguments.length===0){for(let r=Vi.MAX_PRECISION_DIGITS;r>=0;r--){try{this.bufferReducedPrecision(r)}catch(a){if(!(a instanceof jt))throw a;this._saveException=a}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){const r=arguments[0],a=Vi.precisionScaleFactor(this._argGeom,this._distance,r),p=new Oe(a);this.bufferFixedPrecision(p)}}bufferOriginalPrecision(){try{const r=new xo(this._bufParams);this._resultGeometry=r.buffer(this._argGeom,this._distance)}catch(r){if(!(r instanceof E))throw r;this._saveException=r}}getResultGeometry(r){return this._distance=r,this.computeGeometry(),this._resultGeometry}setEndCapStyle(r){this._bufParams.setEndCapStyle(r)}computeGeometry(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;const r=this._argGeom.getFactory().getPrecisionModel();r.getType()===Oe.FIXED?this.bufferFixedPrecision(r):this.bufferReducedPrecision()}setQuadrantSegments(r){this._bufParams.setQuadrantSegments(r)}}Vi.CAP_ROUND=Zr.CAP_ROUND,Vi.CAP_BUTT=Zr.CAP_FLAT,Vi.CAP_FLAT=Zr.CAP_FLAT,Vi.CAP_SQUARE=Zr.CAP_SQUARE,Vi.MAX_PRECISION_DIGITS=12;class $n{constructor(){$n.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gr,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Ee&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];$n.constructor_.call(this,r.getCoordinates(),a)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){const r=arguments[0],a=arguments[1];this._srcPts=r,this._isClosed=$n.isClosed(r),this._snapTolerance=a}}static isClosed(r){return!(r.length<=1)&&r[0].equals2D(r[r.length-1])}snapVertices(r,a){const p=this._isClosed?r.size()-1:r.size();for(let _=0;_<p;_++){const C=r.get(_),k=this.findSnapForVertex(C,a);k!==null&&(r.set(_,new O(k)),_===0&&this._isClosed&&r.set(r.size()-1,new O(k)))}}findSnapForVertex(r,a){for(let p=0;p<a.length;p++){if(r.equals2D(a[p]))return null;if(r.distance(a[p])<this._snapTolerance)return a[p]}return null}snapTo(r){const a=new W(this._srcPts);return this.snapVertices(a,r),this.snapSegments(a,r),a.toCoordinateArray()}snapSegments(r,a){if(a.length===0)return null;let p=a.length;a[0].equals2D(a[a.length-1])&&(p=a.length-1);for(let _=0;_<p;_++){const C=a[_],k=this.findSegmentIndexToSnap(C,r);k>=0&&r.add(k+1,new O(C),!1)}}findSegmentIndexToSnap(r,a){let p=m.MAX_VALUE,_=-1;for(let C=0;C<a.size()-1;C++){if(this._seg.p0=a.get(C),this._seg.p1=a.get(C+1),this._seg.p0.equals2D(r)||this._seg.p1.equals2D(r)){if(this._allowSnappingToSourceVertices)continue;return-1}const k=this._seg.distance(r);k<this._snapTolerance&&k<p&&(p=k,_=C)}return _}setAllowSnappingToSourceVertices(r){this._allowSnappingToSourceVertices=r}}class rs{constructor(){rs.constructor_.apply(this,arguments)}static constructor_(){this._srcGeom=null;const r=arguments[0];this._srcGeom=r}static computeSizeBasedSnapTolerance(r){const a=r.getEnvelopeInternal();return Math.min(a.getHeight(),a.getWidth())*rs.SNAP_PRECISION_FACTOR}static computeOverlaySnapTolerance(){if(arguments.length===1){const r=arguments[0];let a=rs.computeSizeBasedSnapTolerance(r);const p=r.getPrecisionModel();if(p.getType()===Oe.FIXED){const _=1/p.getScale()*2/1.415;_>a&&(a=_)}return a}if(arguments.length===2){const r=arguments[0],a=arguments[1];return Math.min(rs.computeOverlaySnapTolerance(r),rs.computeOverlaySnapTolerance(a))}}static snapToSelf(r,a,p){return new rs(r).snapToSelf(a,p)}static snap(r,a,p){const _=new Array(2).fill(null),C=new rs(r);_[0]=C.snapTo(a,p);const k=new rs(a);return _[1]=k.snapTo(_[0],p),_}computeSnapTolerance(r){return this.computeMinimumSegmentLength(r)/10}snapTo(r,a){const p=this.extractTargetCoordinates(r);return new wo(a,p).transform(this._srcGeom)}snapToSelf(r,a){const p=this.extractTargetCoordinates(this._srcGeom),_=new wo(r,p,!0).transform(this._srcGeom);let C=_;return a&&pt(C,Kt)&&(C=Vi.bufferOp(_,0)),C}extractTargetCoordinates(r){const a=new Xn,p=r.getCoordinates();for(let _=0;_<p.length;_++)a.add(p[_]);return a.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(r){let a=m.MAX_VALUE;for(let p=0;p<r.length-1;p++){const _=r[p].distance(r[p+1]);_<a&&(a=_)}return a}}rs.SNAP_PRECISION_FACTOR=1e-9;class wo extends Xe{constructor(){super(),wo.constructor_.apply(this,arguments)}static constructor_(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,arguments.length===2){const r=arguments[0],a=arguments[1];this._snapTolerance=r,this._snapPts=a}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._snapTolerance=r,this._snapPts=a,this._isSelfSnap=p}}transformCoordinates(r,a){const p=r.toCoordinateArray(),_=this.snapLine(p,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(_)}snapLine(r,a){const p=new $n(r,this._snapTolerance);return p.setAllowSnappingToSourceVertices(this._isSelfSnap),p.snapTo(a)}}class Io{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new d,this._commonSignExp=null}getCommon(){return m.longBitsToDouble(this._commonBits)}add(r){const a=m.doubleToLongBits(r);if(this._isFirst)return this._commonBits=a,this._commonSignExp=Io.signExpBits(this._commonBits),this._isFirst=!1,null;if(Io.signExpBits(a)!==this._commonSignExp)return this._commonBits.high=0,this._commonBits.low=0,null;this._commonMantissaBitsCount=Io.numCommonMostSigMantissaBits(this._commonBits,a),this._commonBits=Io.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))}toString(){if(arguments.length===1){const r=arguments[0],a=m.longBitsToDouble(r),p="0000000000000000000000000000000000000000000000000000000000000000"+d.toBinaryString(r),_=p.substring(p.length-64);return _.substring(0,1)+"  "+_.substring(1,12)+"(exp) "+_.substring(12)+" [ "+a+" ]"}}getClass(){return Io}get interfaces_(){return[]}static getBit(r,a){const p=1<<a%32;return a<32?r.low&p?1:0:r.high&p?1:0}static signExpBits(r){return r.high>>>20}static zeroLowerBits(r,a){let p="low";if(a>32&&(r.low=0,a%=32,p="high"),a>0){const _=a<32?~((1<<a)-1):0;r[p]&=_}return r}static numCommonMostSigMantissaBits(r,a){let p=0;for(let _=52;_>=0;_--){if(Io.getBit(r,_)!==Io.getBit(a,_))return p;p++}return 52}}class $i{constructor(){$i.constructor_.apply(this,arguments)}static constructor_(){this._commonCoord=null,this._ccFilter=new na}add(r){r.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}removeCommonBits(r){if(this._commonCoord.x===0&&this._commonCoord.y===0)return r;const a=new O(this._commonCoord);a.x=-a.x,a.y=-a.y;const p=new Mo(a);return r.apply(p),r.geometryChanged(),r}addCommonBits(r){const a=new Mo(this._commonCoord);r.apply(a),r.geometryChanged()}getCommonCoordinate(){return this._commonCoord}}class na{constructor(){na.constructor_.apply(this,arguments)}static constructor_(){this._commonBitsX=new Io,this._commonBitsY=new Io}filter(r){this._commonBitsX.add(r.x),this._commonBitsY.add(r.y)}getCommonCoordinate(){return new O(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}get interfaces_(){return[Ar]}}class Mo{constructor(){Mo.constructor_.apply(this,arguments)}static constructor_(){this.trans=null;const r=arguments[0];this.trans=r}filter(r,a){const p=r.getOrdinate(a,0)+this.trans.x,_=r.getOrdinate(a,1)+this.trans.y;r.setOrdinate(a,0,p),r.setOrdinate(a,1,_)}isGeometryChanged(){return!0}isDone(){return!1}get interfaces_(){return[rt]}}$i.CommonCoordinateFilter=na,$i.Translater=Mo;class Yh{constructor(){Yh.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new $,this._resultLineList=new $;const r=arguments[0],a=arguments[1],p=arguments[2];this._op=r,this._geometryFactory=a,this._ptLocator=p}collectLines(r){for(let a=this._op.getGraph().getEdgeEnds().iterator();a.hasNext();){const p=a.next();this.collectLineEdge(p,r,this._lineEdgesList),this.collectBoundaryTouchEdge(p,r,this._lineEdgesList)}}labelIsolatedLine(r,a){const p=this._ptLocator.locate(r.getCoordinate(),this._op.getArgGeometry(a));r.getLabel().setLocation(a,p)}build(r){return this.findCoveredLineEdges(),this.collectLines(r),this.buildLines(r),this._resultLineList}collectLineEdge(r,a,p){const _=r.getLabel(),C=r.getEdge();r.isLineEdge()&&(r.isVisited()||!Ir.isResultOfOp(_,a)||C.isCovered()||(p.add(C),r.setVisitedEdge(!0)))}findCoveredLineEdges(){for(let r=this._op.getGraph().getNodes().iterator();r.hasNext();)r.next().getEdges().findCoveredLineEdges();for(let r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){const a=r.next(),p=a.getEdge();if(a.isLineEdge()&&!p.isCoveredSet()){const _=this._op.isCoveredByA(a.getCoordinate());p.setCovered(_)}}}labelIsolatedLines(r){for(let a=r.iterator();a.hasNext();){const p=a.next(),_=p.getLabel();p.isIsolated()&&(_.isNull(0)?this.labelIsolatedLine(p,0):this.labelIsolatedLine(p,1))}}buildLines(r){for(let a=this._lineEdgesList.iterator();a.hasNext();){const p=a.next(),_=this._geometryFactory.createLineString(p.getCoordinates());this._resultLineList.add(_),p.setInResult(!0)}}collectBoundaryTouchEdge(r,a,p){const _=r.getLabel();return r.isLineEdge()||r.isVisited()||r.isInteriorAreaEdge()||r.getEdge().isInResult()?null:(L.isTrue(!(r.isInResult()||r.getSym().isInResult())||!r.getEdge().isInResult()),void(Ir.isResultOfOp(_,a)&&a===Ir.INTERSECTION&&(p.add(r.getEdge()),r.setVisitedEdge(!0))))}}class Zh{constructor(){Zh.constructor_.apply(this,arguments)}static constructor_(){this._op=null,this._geometryFactory=null,this._resultPointList=new $;const r=arguments[0],a=arguments[1];this._op=r,this._geometryFactory=a}build(r){return this.extractNonCoveredResultNodes(r),this._resultPointList}extractNonCoveredResultNodes(r){for(let a=this._op.getGraph().getNodes().iterator();a.hasNext();){const p=a.next();if(!p.isInResult()&&!p.isIncidentEdgeInResult()&&(p.getEdges().getDegree()===0||r===Ir.INTERSECTION)){const _=p.getLabel();Ir.isResultOfOp(_,r)&&this.filterCoveredNodeToPoint(p)}}}filterCoveredNodeToPoint(r){const a=r.getCoordinate();if(!this._op.isCoveredByLA(a)){const p=this._geometryFactory.createPoint(a);this._resultPointList.add(p)}}}class po{isInBoundary(r){}}class lf{isInBoundary(r){return r%2==1}get interfaces_(){return[po]}}class Sa{isInBoundary(r){return r>0}get interfaces_(){return[po]}}class Uu{isInBoundary(r){return r>1}get interfaces_(){return[po]}}class cf{isInBoundary(r){return r===1}get interfaces_(){return[po]}}po.Mod2BoundaryNodeRule=lf,po.EndPointBoundaryNodeRule=Sa,po.MultiValentEndPointBoundaryNodeRule=Uu,po.MonoValentEndPointBoundaryNodeRule=cf,po.MOD2_BOUNDARY_RULE=new lf,po.ENDPOINT_BOUNDARY_RULE=new Sa,po.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new Uu,po.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new cf,po.OGC_SFS_BOUNDARY_RULE=po.MOD2_BOUNDARY_RULE;class Ea{constructor(){Ea.constructor_.apply(this,arguments)}static constructor_(){if(this._boundaryRule=po.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){const r=arguments[0];if(r===null)throw new u("Rule must be non-null");this._boundaryRule=r}}}locateInPolygonRing(r,a){return a.getEnvelopeInternal().intersects(r)?Gi.locateInRing(r,a.getCoordinates()):St.EXTERIOR}intersects(r,a){return this.locate(r,a)!==St.EXTERIOR}updateLocationInfo(r){r===St.INTERIOR&&(this._isIn=!0),r===St.BOUNDARY&&this._numBoundaries++}computeLocation(r,a){if(a instanceof zt&&this.updateLocationInfo(this.locateOnPoint(r,a)),a instanceof Ee)this.updateLocationInfo(this.locateOnLineString(r,a));else if(a instanceof Ut)this.updateLocationInfo(this.locateInPolygon(r,a));else if(a instanceof ar){const p=a;for(let _=0;_<p.getNumGeometries();_++){const C=p.getGeometryN(_);this.updateLocationInfo(this.locateOnLineString(r,C))}}else if(a instanceof ae){const p=a;for(let _=0;_<p.getNumGeometries();_++){const C=p.getGeometryN(_);this.updateLocationInfo(this.locateInPolygon(r,C))}}else if(a instanceof Ot){const p=new Po(a);for(;p.hasNext();){const _=p.next();_!==a&&this.computeLocation(r,_)}}}locateOnPoint(r,a){return a.getCoordinate().equals2D(r)?St.INTERIOR:St.EXTERIOR}locateOnLineString(r,a){if(!a.getEnvelopeInternal().intersects(r))return St.EXTERIOR;const p=a.getCoordinateSequence();return a.isClosed()||!r.equals(p.getCoordinate(0))&&!r.equals(p.getCoordinate(p.size()-1))?Gi.isOnLine(r,p)?St.INTERIOR:St.EXTERIOR:St.BOUNDARY}locateInPolygon(r,a){if(a.isEmpty())return St.EXTERIOR;const p=a.getExteriorRing(),_=this.locateInPolygonRing(r,p);if(_===St.EXTERIOR)return St.EXTERIOR;if(_===St.BOUNDARY)return St.BOUNDARY;for(let C=0;C<a.getNumInteriorRing();C++){const k=a.getInteriorRingN(C),X=this.locateInPolygonRing(r,k);if(X===St.INTERIOR)return St.EXTERIOR;if(X===St.BOUNDARY)return St.BOUNDARY}return St.INTERIOR}locate(r,a){return a.isEmpty()?St.EXTERIOR:a instanceof Ee?this.locateOnLineString(r,a):a instanceof Ut?this.locateInPolygon(r,a):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(r,a),this._boundaryRule.isInBoundary(this._numBoundaries)?St.BOUNDARY:this._numBoundaries>0||this._isIn?St.INTERIOR:St.EXTERIOR)}}class uf{constructor(){uf.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._data=null;const r=arguments[0],a=arguments[1];this._pts=r,this._data=a}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(r){return this._pts[r]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(r){return r===this._pts.length-1?-1:q.octant(this.getCoordinate(r),this.getCoordinate(r+1))}setData(r){this._data=r}getData(){return this._data}toString(){return vi.toLineString(new ye(this._pts))}get interfaces_(){return[Y]}}class $o{constructor(){$o.constructor_.apply(this,arguments)}static constructor_(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._keepIntersections=!0,this._isInteriorIntersectionsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new $,this._intersectionCount=0;const r=arguments[0];this._li=r,this._interiorIntersection=null}static createAllIntersectionsFinder(r){const a=new $o(r);return a.setFindAllIntersections(!0),a}static isInteriorVertexIntersection(){if(arguments.length===4){const r=arguments[1];return(!arguments[2]||!arguments[3])&&!!arguments[0].equals2D(r)}if(arguments.length===8){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5],X=arguments[6],J=arguments[7];return!!$o.isInteriorVertexIntersection(r,p,C,X)||!!$o.isInteriorVertexIntersection(r,_,C,J)||!!$o.isInteriorVertexIntersection(a,p,k,X)||!!$o.isInteriorVertexIntersection(a,_,k,J)}}static createInteriorIntersectionCounter(r){const a=new $o(r);return a.setInteriorIntersectionsOnly(!0),a.setFindAllIntersections(!0),a.setKeepIntersections(!1),a}static createIntersectionCounter(r){const a=new $o(r);return a.setFindAllIntersections(!0),a.setKeepIntersections(!1),a}static isEndSegment(r,a){return a===0||a>=r.size()-2}static createAnyIntersectionFinder(r){return new $o(r)}static createInteriorIntersectionsFinder(r){const a=new $o(r);return a.setFindAllIntersections(!0),a.setInteriorIntersectionsOnly(!0),a}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(r){this._findAllIntersections=r}setKeepIntersections(r){this._keepIntersections=r}getIntersection(){return this._interiorIntersection}processIntersections(r,a,p,_){if(!this._findAllIntersections&&this.hasIntersection())return null;const C=r===p;if(C&&a===_||this._isCheckEndSegmentsOnly&&!($o.isEndSegment(r,a)||$o.isEndSegment(p,_)))return null;const k=r.getCoordinate(a),X=r.getCoordinate(a+1),J=p.getCoordinate(_),Ct=p.getCoordinate(_+1),te=a===0,ce=a+2===r.size(),Ye=_===0,sr=_+2===p.size();this._li.computeIntersection(k,X,J,Ct);const Cr=this._li.hasIntersection()&&this._li.isInteriorIntersection();let Ii=!1;this._isInteriorIntersectionsOnly||(Ii=!(C&&Math.abs(_-a)<=1)&&$o.isInteriorVertexIntersection(k,X,J,Ct,te,ce,Ye,sr)),(Cr||Ii)&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=k,this._intSegments[1]=X,this._intSegments[2]=J,this._intSegments[3]=Ct,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}hasIntersection(){return this._interiorIntersection!==null}isDone(){return!this._findAllIntersections&&this._interiorIntersection!==null}setInteriorIntersectionsOnly(r){this._isInteriorIntersectionsOnly=r}setCheckEndSegmentsOnly(r){this._isCheckEndSegmentsOnly=r}getIntersectionSegments(){return this._intSegments}get interfaces_(){return[zr]}}class zc{constructor(){zc.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;const r=arguments[0];this._segStrings=r}static computeIntersections(r){const a=new zc(r);return a.setFindAllIntersections(!0),a.isValid(),a.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(r){this._findAllIntersections=r}checkInteriorIntersections(){this._isValid=!0,this._segInt=new $o(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);const r=new Yr;if(r.setSegmentIntersector(this._segInt),r.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new jt(this.getErrorMessage(),this._segInt.getIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";const r=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+vi.toLineString(r[0],r[1])+" and "+vi.toLineString(r[2],r[3])}execute(){if(this._segInt!==null)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}}class qu{constructor(){qu.constructor_.apply(this,arguments)}static constructor_(){this._nv=null;const r=arguments[0];this._nv=new zc(qu.toSegmentStrings(r))}static toSegmentStrings(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();a.add(new uf(_.getCoordinates(),_))}return a}static checkValid(r){new qu(r).checkValid()}checkValid(){this._nv.checkValid()}}class Vc{}class El{constructor(){El.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;const r=arguments[0],a=arguments[1],p=arguments[2];this._li=r,this._includeProper=a,this._recordIsolated=p}static isAdjacentSegments(r,a){return Math.abs(r-a)===1}isTrivialIntersection(r,a,p,_){if(r===p&&this._li.getIntersectionNum()===1){if(El.isAdjacentSegments(a,_))return!0;if(r.isClosed()){const C=r.getNumPoints()-1;if(a===0&&_===C||_===0&&a===C)return!0}}return!1}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(r,a){for(let p=a.iterator();p.hasNext();){const _=p.next().getCoordinate();if(r.isIntersection(_))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(r,a){return a!==null&&(!!this.isBoundaryPointInternal(r,a[0])||!!this.isBoundaryPointInternal(r,a[1]))}setBoundaryNodes(r,a){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=r,this._bdyNodes[1]=a}addIntersections(r,a,p,_){if(r===p&&a===_)return null;this.numTests++;const C=r.getCoordinates()[a],k=r.getCoordinates()[a+1],X=p.getCoordinates()[_],J=p.getCoordinates()[_+1];this._li.computeIntersection(C,k,X,J),this._li.hasIntersection()&&(this._recordIsolated&&(r.setIsolated(!1),p.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(r,a,p,_)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(r.addIntersections(this._li,a,0),p.addIntersections(this._li,_,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(r){this._isDoneWhenProperInt=r}}class Cs{constructor(){Cs.constructor_.apply(this,arguments)}static constructor_(){this.mce=null,this.chainIndex=null;const r=arguments[0],a=arguments[1];this.mce=r,this.chainIndex=a}computeIntersections(r,a){this.mce.computeIntersectsForChain(this.chainIndex,r.mce,r.chainIndex,a)}}class oa{constructor(){oa.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){const r=arguments[0],a=arguments[1];this._eventType=oa.DELETE,this._xValue=r,this._insertEvent=a}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._eventType=oa.INSERT,this._label=r,this._xValue=a,this._obj=p}}getObject(){return this._obj}getDeleteEventIndex(){return this._deleteEventIndex}isDelete(){return this._eventType===oa.DELETE}setDeleteEventIndex(r){this._deleteEventIndex=r}compareTo(r){const a=r;return this._xValue<a._xValue?-1:this._xValue>a._xValue?1:this._eventType<a._eventType?-1:this._eventType>a._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===oa.INSERT}isSameLabel(r){return this._label!==null&&this._label===r._label}get interfaces_(){return[g]}}oa.INSERT=1,oa.DELETE=2;class Uc extends Vc{constructor(){super(),Uc.constructor_.apply(this,arguments)}static constructor_(){this.events=new $,this.nOverlaps=null}prepareEvents(){lr.sort(this.events);for(let r=0;r<this.events.size();r++){const a=this.events.get(r);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(r)}}computeIntersections(){if(arguments.length===1){const r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(let a=0;a<this.events.size();a++){const p=this.events.get(a);if(p.isInsert()&&this.processOverlaps(a,p.getDeleteEventIndex(),p,r),r.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof El&&pt(arguments[0],ut)&&pt(arguments[1],ut)){const r=arguments[0],a=arguments[1],p=arguments[2];this.addEdges(r,r),this.addEdges(a,a),this.computeIntersections(p)}else if(typeof arguments[2]=="boolean"&&pt(arguments[0],ut)&&arguments[1]instanceof El){const r=arguments[0],a=arguments[1];arguments[2]?this.addEdges(r,null):this.addEdges(r),this.computeIntersections(a)}}}addEdge(r,a){const p=r.getMonotoneChainEdge(),_=p.getStartIndexes();for(let C=0;C<_.length-1;C++){const k=new Cs(p,C),X=new oa(a,p.getMinX(C),k);this.events.add(X),this.events.add(new oa(p.getMaxX(C),X))}}processOverlaps(r,a,p,_){const C=p.getObject();for(let k=r;k<a;k++){const X=this.events.get(k);if(X.isInsert()){const J=X.getObject();p.isSameLabel(X)||(C.computeIntersections(J,_),this.nOverlaps++)}}}addEdges(){if(arguments.length===1)for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.addEdge(a,a)}else if(arguments.length===2){const r=arguments[1];for(let a=arguments[0].iterator();a.hasNext();){const p=a.next();this.addEdge(p,r)}}}}class Go extends Nt{constructor(){super(),Go.constructor_.apply(this,arguments)}static constructor_(){if(this._parentGeom=null,this._lineEdgeMap=new br,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Ea,arguments.length===2){const r=arguments[0],a=arguments[1];Go.constructor_.call(this,r,a,po.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._argIndex=r,this._parentGeom=a,this._boundaryNodeRule=p,a!==null&&this.add(a)}}static determineBoundary(r,a){return r.isInBoundary(a)?St.BOUNDARY:St.INTERIOR}insertBoundaryPoint(r,a){const p=this._nodes.addNode(a).getLabel();let _=1,C=St.NONE;C=p.getLocation(r,Ie.ON),C===St.BOUNDARY&&_++;const k=Go.determineBoundary(this._boundaryNodeRule,_);p.setLocation(r,k)}computeSelfNodes(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return this.computeSelfNodes(r,a,!1)}if(arguments.length===3){const r=arguments[1],a=arguments[2],p=new El(arguments[0],!0,!1);p.setIsDoneIfProperInt(a);const _=this.createEdgeSetIntersector(),C=this._parentGeom instanceof Sr||this._parentGeom instanceof Ut||this._parentGeom instanceof ae,k=r||!C;return _.computeIntersections(this._edges,p,k),this.addSelfIntersectionNodes(this._argIndex),p}}addPolygon(r){this.addPolygonRing(r.getExteriorRing(),St.EXTERIOR,St.INTERIOR);for(let a=0;a<r.getNumInteriorRing();a++){const p=r.getInteriorRingN(a);this.addPolygonRing(p,St.INTERIOR,St.EXTERIOR)}}addEdge(r){this.insertEdge(r);const a=r.getCoordinates();this.insertPoint(this._argIndex,a[0],St.BOUNDARY),this.insertPoint(this._argIndex,a[a.length-1],St.BOUNDARY)}addLineString(r){const a=De.removeRepeatedPoints(r.getCoordinates());if(a.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=a[0],null;const p=new zn(a,new mi(this._argIndex,St.INTERIOR));this._lineEdgeMap.put(r,p),this.insertEdge(p),L.isTrue(a.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,a[0]),this.insertBoundaryPoint(this._argIndex,a[a.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){const r=this.getBoundaryNodes(),a=new Array(r.size()).fill(null);let p=0;for(let _=r.iterator();_.hasNext();){const C=_.next();a[p++]=C.getCoordinate().copy()}return a}addSelfIntersectionNodes(r){for(let a=this._edges.iterator();a.hasNext();){const p=a.next(),_=p.getLabel().getLocation(r);for(let C=p.eiList.iterator();C.hasNext();){const k=C.next();this.addSelfIntersectionNode(r,k.coord,_)}}}add(){if(!(arguments.length===1&&arguments[0]instanceof oe))return super.add.apply(this,arguments);{const r=arguments[0];if(r.isEmpty())return null;if(r instanceof ae&&(this._useBoundaryDeterminationRule=!1),r instanceof Ut)this.addPolygon(r);else if(r instanceof Ee)this.addLineString(r);else if(r instanceof zt)this.addPoint(r);else if(r instanceof ve)this.addCollection(r);else if(r instanceof ar)this.addCollection(r);else if(r instanceof ae)this.addCollection(r);else{if(!(r instanceof Ot))throw new Fe(r.getGeometryType());this.addCollection(r)}}}addCollection(r){for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);this.add(p)}}locate(r){return pt(this._parentGeom,Kt)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new _o(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)}findEdge(){if(arguments.length===1&&arguments[0]instanceof Ee){const r=arguments[0];return this._lineEdgeMap.get(r)}return super.findEdge.apply(this,arguments)}computeSplitEdges(r){for(let a=this._edges.iterator();a.hasNext();)a.next().eiList.addSplitEdges(r)}computeEdgeIntersections(r,a,p){const _=new El(a,p,!0);return _.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,r._edges,_),_}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof zt){const r=arguments[0].getCoordinate();this.insertPoint(this._argIndex,r,St.INTERIOR)}else if(arguments[0]instanceof O){const r=arguments[0];this.insertPoint(this._argIndex,r,St.INTERIOR)}}getBoundaryNodes(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(r,a,p){if(this.isBoundaryNode(r,a))return null;p===St.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,a):this.insertPoint(r,a,p)}addPolygonRing(r,a,p){if(r.isEmpty())return null;const _=De.removeRepeatedPoints(r.getCoordinates());if(_.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=_[0],null;let C=a,k=p;Yt.isCCW(_)&&(C=p,k=a);const X=new zn(_,new mi(this._argIndex,St.BOUNDARY,C,k));this._lineEdgeMap.put(r,X),this.insertEdge(X),this.insertPoint(this._argIndex,_[0],St.BOUNDARY)}insertPoint(r,a,p){const _=this._nodes.addNode(a),C=_.getLabel();C===null?_._label=new mi(r,p):C.setLocation(r,p)}createEdgeSetIntersector(){return new Uc}}class rl{constructor(){rl.constructor_.apply(this,arguments)}static constructor_(){if(this._li=new tn,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){const r=arguments[0];this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Go(0,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];rl.constructor_.call(this,r,a,po.OGC_SFS_BOUNDARY_RULE)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];r.getPrecisionModel().compareTo(a.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(a.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Go(0,r,p),this._arg[1]=new Go(1,a,p)}}setComputationPrecision(r){this._resultPrecisionModel=r,this._li.setPrecisionModel(this._resultPrecisionModel)}getArgGeometry(r){return this._arg[r].getGeometry()}}class Ir extends rl{constructor(){super(),Ir.constructor_.apply(this,arguments)}static constructor_(){this._ptLocator=new Ea,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Ti,this._resultPolyList=new $,this._resultLineList=new $,this._resultPointList=new $;const r=arguments[0],a=arguments[1];rl.constructor_.call(this,r,a),this._graph=new Nt(new ie),this._geomFact=r.getFactory()}static overlayOp(r,a,p){return new Ir(r,a).getResultGeometry(p)}static union(r,a){if(r.isEmpty()||a.isEmpty()){if(r.isEmpty()&&a.isEmpty())return Ir.createEmptyResult(Ir.UNION,r,a,r.getFactory());if(r.isEmpty())return a.copy();if(a.isEmpty())return r.copy()}if(r.isGeometryCollection()||a.isGeometryCollection())throw new u("This method does not support GeometryCollection arguments");return ls.overlayOp(r,a,Ir.UNION)}static intersection(r,a){if(r.isEmpty()||a.isEmpty())return Ir.createEmptyResult(Ir.INTERSECTION,r,a,r.getFactory());if(r.isGeometryCollection()){const p=a;return Gt.map(r,new class{get interfaces_(){return[MapOp]}map(_){return Ir.intersection(_,p)}})}return ls.overlayOp(r,a,Ir.INTERSECTION)}static symDifference(r,a){if(r.isEmpty()||a.isEmpty()){if(r.isEmpty()&&a.isEmpty())return Ir.createEmptyResult(Ir.SYMDIFFERENCE,r,a,r.getFactory());if(r.isEmpty())return a.copy();if(a.isEmpty())return r.copy()}if(r.isGeometryCollection()||a.isGeometryCollection())throw new u("This method does not support GeometryCollection arguments");return ls.overlayOp(r,a,Ir.SYMDIFFERENCE)}static resultDimension(r,a,p){const _=a.getDimension(),C=p.getDimension();let k=-1;switch(r){case Ir.INTERSECTION:k=Math.min(_,C);break;case Ir.UNION:k=Math.max(_,C);break;case Ir.DIFFERENCE:k=_;break;case Ir.SYMDIFFERENCE:k=Math.max(_,C)}return k}static createEmptyResult(r,a,p,_){const C=Ir.resultDimension(r,a,p);return _.createEmpty(C)}static difference(r,a){if(r.isEmpty())return Ir.createEmptyResult(Ir.DIFFERENCE,r,a,r.getFactory());if(a.isEmpty())return r.copy();if(r.isGeometryCollection()||a.isGeometryCollection())throw new u("This method does not support GeometryCollection arguments");return ls.overlayOp(r,a,Ir.DIFFERENCE)}static isResultOfOp(){if(arguments.length===2){const r=arguments[0],a=arguments[1],p=r.getLocation(0),_=r.getLocation(1);return Ir.isResultOfOp(p,_,a)}if(arguments.length===3){let r=arguments[0],a=arguments[1],p=arguments[2];switch(r===St.BOUNDARY&&(r=St.INTERIOR),a===St.BOUNDARY&&(a=St.INTERIOR),p){case Ir.INTERSECTION:return r===St.INTERIOR&&a===St.INTERIOR;case Ir.UNION:return r===St.INTERIOR||a===St.INTERIOR;case Ir.DIFFERENCE:return r===St.INTERIOR&&a!==St.INTERIOR;case Ir.SYMDIFFERENCE:return r===St.INTERIOR&&a!==St.INTERIOR||r!==St.INTERIOR&&a===St.INTERIOR}return!1}}insertUniqueEdge(r){const a=this._edgeList.findEqualEdge(r);if(a!==null){const p=a.getLabel();let _=r.getLabel();a.isPointwiseEqual(r)||(_=new mi(r.getLabel()),_.flip());const C=a.getDepth();C.isNull()&&C.add(p),C.add(_),p.merge(_)}else this._edgeList.add(r)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(let r=this._graph.getEdgeEnds().iterator();r.hasNext();){const a=r.next(),p=a.getSym();a.isInResult()&&p.isInResult()&&(a.setInResult(!1),p.setInResult(!1))}}mergeSymLabels(){for(let r=this._graph.getNodes().iterator();r.hasNext();)r.next().getEdges().mergeSymLabels()}computeOverlay(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);const a=new $;this._arg[0].computeSplitEdges(a),this._arg[1].computeSplitEdges(a),this.insertUniqueEdges(a),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),qu.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();const p=new Te(this._geomFact);p.add(this._graph),this._resultPolyList=p.getPolygons();const _=new Yh(this,this._geomFact,this._ptLocator);this._resultLineList=_.build(r);const C=new Zh(this,this._geomFact,this._ptLocator);this._resultPointList=C.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)}findResultAreaEdges(r){for(let a=this._graph.getEdgeEnds().iterator();a.hasNext();){const p=a.next(),_=p.getLabel();_.isArea()&&!p.isInteriorAreaEdge()&&Ir.isResultOfOp(_.getLocation(0,Ie.RIGHT),_.getLocation(1,Ie.RIGHT),r)&&p.setInResult(!0)}}computeLabelsFromDepths(){for(let r=this._edgeList.iterator();r.hasNext();){const a=r.next(),p=a.getLabel(),_=a.getDepth();if(!_.isNull()){_.normalize();for(let C=0;C<2;C++)p.isNull(C)||!p.isArea()||_.isNull(C)||(_.getDelta(C)===0?p.toLine(C):(L.isTrue(!_.isNull(C,Ie.LEFT),"depth of LEFT side has not been initialized"),p.setLocation(C,Ie.LEFT,_.getLocation(C,Ie.LEFT)),L.isTrue(!_.isNull(C,Ie.RIGHT),"depth of RIGHT side has not been initialized"),p.setLocation(C,Ie.RIGHT,_.getLocation(C,Ie.RIGHT))))}}}isCoveredByA(r){return!!this.isCovered(r,this._resultPolyList)}isCoveredByLA(r){return!!this.isCovered(r,this._resultLineList)||!!this.isCovered(r,this._resultPolyList)}computeGeometry(r,a,p,_){const C=new $;return C.addAll(r),C.addAll(a),C.addAll(p),C.isEmpty()?Ir.createEmptyResult(_,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(C)}isCovered(r,a){for(let p=a.iterator();p.hasNext();){const _=p.next();if(this._ptLocator.locate(r,_)!==St.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){const r=new $;for(let a=this._edgeList.iterator();a.hasNext();){const p=a.next();p.isCollapsed()&&(a.remove(),r.add(p.getCollapsedEdge()))}this._edgeList.addAll(r)}updateNodeLabelling(){for(let r=this._graph.getNodes().iterator();r.hasNext();){const a=r.next(),p=a.getEdges().getLabel();a.getLabel().merge(p)}}getResultGeometry(r){return this.computeOverlay(r),this._resultGeom}insertUniqueEdges(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this.insertUniqueEdge(p)}}labelIncompleteNode(r,a){const p=this._ptLocator.locate(r.getCoordinate(),this._arg[a].getGeometry());r.getLabel().setLocation(a,p)}copyPoints(r){for(let a=this._arg[r].getNodeIterator();a.hasNext();){const p=a.next();this._graph.addNode(p.getCoordinate()).setLabel(r,p.getLabel().getLocation(r))}}computeLabelling(){for(let r=this._graph.getNodes().iterator();r.hasNext();)r.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(let r=this._graph.getNodes().iterator();r.hasNext();){const a=r.next(),p=a.getLabel();a.isIsolated()&&(p.isNull(0)?this.labelIncompleteNode(a,0):this.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(p)}}}Ir.INTERSECTION=1,Ir.UNION=2,Ir.DIFFERENCE=3,Ir.SYMDIFFERENCE=4;class sa{constructor(){sa.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;const r=arguments[0],a=arguments[1];this._geom[0]=r,this._geom[1]=a,this.computeSnapTolerance()}static overlayOp(r,a,p){return new sa(r,a).getResultGeometry(p)}static union(r,a){return sa.overlayOp(r,a,Ir.UNION)}static intersection(r,a){return sa.overlayOp(r,a,Ir.INTERSECTION)}static symDifference(r,a){return sa.overlayOp(r,a,Ir.SYMDIFFERENCE)}static difference(r,a){return sa.overlayOp(r,a,Ir.DIFFERENCE)}selfSnap(r){return new rs(r).snapTo(r,this._snapTolerance)}removeCommonBits(r){this._cbr=new $i,this._cbr.add(r[0]),this._cbr.add(r[1]);const a=new Array(2).fill(null);return a[0]=this._cbr.removeCommonBits(r[0].copy()),a[1]=this._cbr.removeCommonBits(r[1].copy()),a}prepareResult(r){return this._cbr.addCommonBits(r),r}getResultGeometry(r){const a=this.snap(this._geom),p=Ir.overlayOp(a[0],a[1],r);return this.prepareResult(p)}checkValid(r){r.isValid()||ne.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=rs.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(r){const a=this.removeCommonBits(r);return rs.snap(a[0],a[1],this._snapTolerance)}}class ls{constructor(){ls.constructor_.apply(this,arguments)}static constructor_(){this._geom=new Array(2).fill(null);const r=arguments[0],a=arguments[1];this._geom[0]=r,this._geom[1]=a}static overlayOp(r,a,p){return new ls(r,a).getResultGeometry(p)}static union(r,a){return ls.overlayOp(r,a,Ir.UNION)}static intersection(r,a){return ls.overlayOp(r,a,Ir.INTERSECTION)}static symDifference(r,a){return ls.overlayOp(r,a,Ir.SYMDIFFERENCE)}static difference(r,a){return ls.overlayOp(r,a,Ir.DIFFERENCE)}getResultGeometry(r){let a=null,p=!1,_=null;try{a=Ir.overlayOp(this._geom[0],this._geom[1],r),p=!0}catch(C){if(!(C instanceof E))throw C;_=C}if(!p)try{a=sa.overlayOp(this._geom[0],this._geom[1],r)}catch(C){throw C instanceof E?_:C}return a}}class ac{static union(r,a){if(r.isEmpty()||a.isEmpty()){if(r.isEmpty()&&a.isEmpty())return Ir.createEmptyResult(Ir.UNION,r,a,r.getFactory());if(r.isEmpty())return a.copy();if(a.isEmpty())return r.copy()}return oe.checkNotGeometryCollection(r),oe.checkNotGeometryCollection(a),ls.overlayOp(r,a,Ir.UNION)}}class Ca{static diagonalSize(r){if(r.isNull())return 0;const a=r.getWidth(),p=r.getHeight();return Math.sqrt(a*a+p*p)}measure(r,a){const p=ao.distance(r,a,Ca.DENSIFY_FRACTION),_=new nt(r.getEnvelopeInternal());return _.expandToInclude(a.getEnvelopeInternal()),1-p/Ca.diagonalSize(_)}get interfaces_(){return[fn]}}Ca.DENSIFY_FRACTION=.25;var $h=Object.freeze({__proto__:null,AreaSimilarityMeasure:class{measure(dt,r){return Ir.intersection(dt,r).getArea()/ac.union(dt,r).getArea()}get interfaces_(){return[fn]}},HausdorffSimilarityMeasure:Ca,SimilarityMeasure:fn,SimilarityMeasureCombiner:class{static combine(dt,r){return Math.min(dt,r)}}});class Ta{constructor(){Ta.constructor_.apply(this,arguments)}static constructor_(){this._areaBasePt=null,this._triangleCent3=new O,this._areasum2=0,this._cg3=new O,this._lineCentSum=new O,this._totalLength=0,this._ptCount=0,this._ptCentSum=new O;const r=arguments[0];this._areaBasePt=null,this.add(r)}static centroid3(r,a,p,_){return _.x=r.x+a.x+p.x,_.y=r.y+a.y+p.y,null}static getCentroid(r){return new Ta(r).getCentroid()}static area2(r,a,p){return(a.x-r.x)*(p.y-r.y)-(p.x-r.x)*(a.y-r.y)}setAreaBasePoint(r){this._areaBasePt=r}addPoint(r){this._ptCount+=1,this._ptCentSum.x+=r.x,this._ptCentSum.y+=r.y}addLineSegments(r){let a=0;for(let p=0;p<r.length-1;p++){const _=r[p].distance(r[p+1]);if(_===0)continue;a+=_;const C=(r[p].x+r[p+1].x)/2;this._lineCentSum.x+=_*C;const k=(r[p].y+r[p+1].y)/2;this._lineCentSum.y+=_*k}this._totalLength+=a,a===0&&r.length>0&&this.addPoint(r[0])}addHole(r){const a=Yt.isCCW(r);for(let p=0;p<r.length-1;p++)this.addTriangle(this._areaBasePt,r[p],r[p+1],a);this.addLineSegments(r)}getCentroid(){const r=new O;if(Math.abs(this._areasum2)>0)r.x=this._cg3.x/3/this._areasum2,r.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)r.x=this._lineCentSum.x/this._totalLength,r.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;r.x=this._ptCentSum.x/this._ptCount,r.y=this._ptCentSum.y/this._ptCount}return r}add(){if(arguments[0]instanceof Ut){const r=arguments[0];this.addShell(r.getExteriorRing().getCoordinates());for(let a=0;a<r.getNumInteriorRing();a++)this.addHole(r.getInteriorRingN(a).getCoordinates())}else if(arguments[0]instanceof oe){const r=arguments[0];if(r.isEmpty())return null;if(r instanceof zt)this.addPoint(r.getCoordinate());else if(r instanceof Ee)this.addLineSegments(r.getCoordinates());else if(r instanceof Ut){const a=r;this.add(a)}else if(r instanceof Ot){const a=r;for(let p=0;p<a.getNumGeometries();p++)this.add(a.getGeometryN(p))}}}addShell(r){r.length>0&&this.setAreaBasePoint(r[0]);const a=!Yt.isCCW(r);for(let p=0;p<r.length-1;p++)this.addTriangle(this._areaBasePt,r[p],r[p+1],a);this.addLineSegments(r)}addTriangle(r,a,p,_){const C=_?1:-1;Ta.centroid3(r,a,p,this._triangleCent3);const k=Ta.area2(r,a,p);this._cg3.x+=C*k*this._triangleCent3.x,this._cg3.y+=C*k*this._triangleCent3.y,this._areasum2+=C*k}}class Pa{constructor(){Pa.constructor_.apply(this,arguments)}static constructor_(){this._coordSet=new Be,this._list=new $}static filterCoordinates(r){const a=new Pa;for(let p=0;p<r.length;p++)a.filter(r[p]);return a.getCoordinates()}filter(r){this._coordSet.add(r)&&this._list.add(r)}getCoordinates(){const r=new Array(this._list.size()).fill(null);return this._list.toArray(r)}get interfaces_(){return[Ar]}}class aa{constructor(){aa.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFactory=null,this._inputPts=null,arguments.length===1){const r=arguments[0];aa.constructor_.call(this,aa.extractCoordinates(r),r.getFactory())}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._inputPts=Pa.filterCoordinates(r),this._geomFactory=a}}static extractCoordinates(r){const a=new Pa;return r.apply(a),a.getCoordinates()}lineOrPolygon(r){if((r=this.cleanRing(r)).length===3)return this._geomFactory.createLineString([r[0],r[1]]);const a=this._geomFactory.createLinearRing(r);return this._geomFactory.createPolygon(a)}cleanRing(r){L.equals(r[0],r[r.length-1]);const a=new $;let p=null;for(let C=0;C<=r.length-2;C++){const k=r[C],X=r[C+1];k.equals(X)||p!==null&&this.isBetween(p,k,X)||(a.add(k),p=k)}a.add(r[r.length-1]);const _=new Array(a.size()).fill(null);return a.toArray(_)}isBetween(r,a,p){return Yt.index(r,a,p)!==0?!1:r.x!==p.x&&(r.x<=a.x&&a.x<=p.x||p.x<=a.x&&a.x<=r.x)||r.y!==p.y&&(r.y<=a.y&&a.y<=p.y||p.y<=a.y&&a.y<=r.y)}reduce(r){const a=this.computeOctRing(r);if(a===null)return r;const p=new Xn;for(let C=0;C<a.length;C++)p.add(a[C]);for(let C=0;C<r.length;C++)Gi.isInRing(r[C],a)||p.add(r[C]);const _=De.toCoordinateArray(p);return _.length<3?this.padArray3(_):_}getConvexHull(){if(this._inputPts.length===0)return this._geomFactory.createGeometryCollection();if(this._inputPts.length===1)return this._geomFactory.createPoint(this._inputPts[0]);if(this._inputPts.length===2)return this._geomFactory.createLineString(this._inputPts);let r=this._inputPts;this._inputPts.length>50&&(r=this.reduce(this._inputPts));const a=this.preSort(r),p=this.grahamScan(a),_=this.toCoordinateArray(p);return this.lineOrPolygon(_)}padArray3(r){const a=new Array(3).fill(null);for(let p=0;p<a.length;p++)p<r.length?a[p]=r[p]:a[p]=r[0];return a}computeOctPts(r){const a=new Array(8).fill(null);for(let p=0;p<a.length;p++)a[p]=r[0];for(let p=1;p<r.length;p++)r[p].x<a[0].x&&(a[0]=r[p]),r[p].x-r[p].y<a[1].x-a[1].y&&(a[1]=r[p]),r[p].y>a[2].y&&(a[2]=r[p]),r[p].x+r[p].y>a[3].x+a[3].y&&(a[3]=r[p]),r[p].x>a[4].x&&(a[4]=r[p]),r[p].x-r[p].y>a[5].x-a[5].y&&(a[5]=r[p]),r[p].y<a[6].y&&(a[6]=r[p]),r[p].x+r[p].y<a[7].x+a[7].y&&(a[7]=r[p]);return a}toCoordinateArray(r){const a=new Array(r.size()).fill(null);for(let p=0;p<r.size();p++){const _=r.get(p);a[p]=_}return a}grahamScan(r){let a=null;const p=new Bn;p.push(r[0]),p.push(r[1]),p.push(r[2]);for(let _=3;_<r.length;_++){for(a=p.pop();!p.empty()&&Yt.index(p.peek(),a,r[_])>0;)a=p.pop();p.push(a),p.push(r[_])}return p.push(r[0]),p}preSort(r){let a=null;for(let p=1;p<r.length;p++)(r[p].y<r[0].y||r[p].y===r[0].y&&r[p].x<r[0].x)&&(a=r[0],r[0]=r[p],r[p]=a);return Ft.sort(r,1,r.length,new qc(r[0])),r}computeOctRing(r){const a=this.computeOctPts(r),p=new W;return p.add(a,!1),p.size()<3?null:(p.closeRing(),p.toCoordinateArray())}}class qc{constructor(){qc.constructor_.apply(this,arguments)}static constructor_(){this._origin=null;const r=arguments[0];this._origin=r}static polarCompare(r,a,p){const _=a.x-r.x,C=a.y-r.y,k=p.x-r.x,X=p.y-r.y,J=Yt.index(r,a,p);if(J===Yt.COUNTERCLOCKWISE)return 1;if(J===Yt.CLOCKWISE)return-1;const Ct=_*_+C*C,te=k*k+X*X;return Ct<te?-1:Ct>te?1:0}compare(r,a){const p=r,_=a;return qc.polarCompare(this._origin,p,_)}get interfaces_(){return[U]}}aa.RadialComparator=qc;class jo{constructor(){jo.constructor_.apply(this,arguments)}static constructor_(){this._interiorPoint=null,this._maxWidth=-1;const r=arguments[0];this.process(r)}static avg(r,a){return(r+a)/2}static getInteriorPoint(r){return new jo(r).getInteriorPoint()}process(r){if(r.isEmpty())return null;if(r instanceof Ut)this.processPolygon(r);else if(r instanceof Ot){const a=r;for(let p=0;p<a.getNumGeometries();p++)this.process(a.getGeometryN(p))}}getInteriorPoint(){return this._interiorPoint}processPolygon(r){const a=new Ia(r);a.process();const p=a.getWidth();p>this._maxWidth&&(this._maxWidth=p,this._interiorPoint=a.getInteriorPoint())}}class Ia{constructor(){Ia.constructor_.apply(this,arguments)}static constructor_(){this._polygon=null,this._interiorPointY=null,this._interiorSectionWidth=0,this._interiorPoint=null;const r=arguments[0];this._polygon=r,this._interiorPointY=Hc.getScanLineY(r)}static isEdgeCrossingCounted(r,a,p){const _=r.getY(),C=a.getY();return _!==C&&!(_===p&&C<p)&&!(C===p&&_<p)}static intersectsHorizontalLine(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return!(a<r.getMinY())&&!(a>r.getMaxY())}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return!(r.getY()>p&&a.getY()>p)&&!(r.getY()<p&&a.getY()<p)}}static intersection(r,a,p){const _=r.getX(),C=a.getX();if(_===C)return _;const k=C-_,X=(a.getY()-r.getY())/k;return _+(p-r.getY())/X}findBestMidpoint(r){if(r.size()===0)return null;L.isTrue(r.size()%2==0,"Interior Point robustness failure: odd number of scanline crossings"),r.sort(new Kh);for(let a=0;a<r.size();a+=2){const p=r.get(a),_=r.get(a+1),C=_-p;if(C>this._interiorSectionWidth){this._interiorSectionWidth=C;const k=jo.avg(p,_);this._interiorPoint=new O(k,this._interiorPointY)}}}getWidth(){return this._interiorSectionWidth}getInteriorPoint(){return this._interiorPoint}addEdgeCrossing(r,a,p,_){if(!Ia.intersectsHorizontalLine(r,a,p)||!Ia.isEdgeCrossingCounted(r,a,p))return null;const C=Ia.intersection(r,a,p);_.add(C)}process(){if(this._polygon.isEmpty())return null;this._interiorPoint=new O(this._polygon.getCoordinate());const r=new $;this.scanRing(this._polygon.getExteriorRing(),r);for(let a=0;a<this._polygon.getNumInteriorRing();a++)this.scanRing(this._polygon.getInteriorRingN(a),r);this.findBestMidpoint(r)}scanRing(r,a){if(!Ia.intersectsHorizontalLine(r.getEnvelopeInternal(),this._interiorPointY))return null;const p=r.getCoordinateSequence();for(let _=1;_<p.size();_++){const C=p.getCoordinate(_-1),k=p.getCoordinate(_);this.addEdgeCrossing(C,k,this._interiorPointY,a)}}}class Kh{compare(r,a){return r<a?-1:r>a?1:0}get interfaces_(){return[U]}}Ia.DoubleComparator=Kh;class Hc{constructor(){Hc.constructor_.apply(this,arguments)}static constructor_(){this._poly=null,this._centreY=null,this._hiY=m.MAX_VALUE,this._loY=-m.MAX_VALUE;const r=arguments[0];this._poly=r,this._hiY=r.getEnvelopeInternal().getMaxY(),this._loY=r.getEnvelopeInternal().getMinY(),this._centreY=jo.avg(this._loY,this._hiY)}static getScanLineY(r){return new Hc(r).getScanLineY()}process(r){const a=r.getCoordinateSequence();for(let p=0;p<a.size();p++){const _=a.getY(p);this.updateInterval(_)}}getScanLineY(){this.process(this._poly.getExteriorRing());for(let r=0;r<this._poly.getNumInteriorRing();r++)this.process(this._poly.getInteriorRingN(r));return jo.avg(this._hiY,this._loY)}updateInterval(r){r<=this._centreY?r>this._loY&&(this._loY=r):r>this._centreY&&r<this._hiY&&(this._hiY=r)}}jo.InteriorPointPolygon=Ia,jo.ScanLineYOrdinateFinder=Hc;class cs{constructor(){cs.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=m.MAX_VALUE,this._interiorPoint=null;const r=arguments[0];r.isEmpty()?this._centroid=null:(this._centroid=Ta.getCentroid(r),r.getPrecisionModel().makePrecise(this._centroid)),this.addInterior(r),this._interiorPoint===null&&this.addEndpoints(r)}static getInteriorPoint(r){return new cs(r).getInteriorPoint()}add(r){const a=r.distance(this._centroid);a<this._minDistance&&(this._interiorPoint=new O(r),this._minDistance=a)}getInteriorPoint(){return this._interiorPoint}addEndpoints(){if(arguments[0]instanceof oe){const r=arguments[0];if(r instanceof Ee)this.addEndpoints(r.getCoordinates());else if(r instanceof Ot){const a=r;for(let p=0;p<a.getNumGeometries();p++)this.addEndpoints(a.getGeometryN(p))}}else if(arguments[0]instanceof Array){const r=arguments[0];this.add(r[0]),this.add(r[r.length-1])}}addInterior(){if(arguments[0]instanceof oe){const r=arguments[0];if(r instanceof Ee)this.addInterior(r.getCoordinates());else if(r instanceof Ot){const a=r;for(let p=0;p<a.getNumGeometries();p++)this.addInterior(a.getGeometryN(p))}}else if(arguments[0]instanceof Array){const r=arguments[0];for(let a=1;a<r.length-1;a++)this.add(r[a])}}}class Ma{constructor(){Ma.constructor_.apply(this,arguments)}static constructor_(){this._centroid=null,this._minDistance=m.MAX_VALUE,this._interiorPoint=null;const r=arguments[0];this._centroid=Ta.getCentroid(r),this.add(r)}static getInteriorPoint(r){return new Ma(r).getInteriorPoint()}add(){if(arguments[0]instanceof oe){const r=arguments[0];if(r instanceof zt)this.add(r.getCoordinate());else if(r instanceof Ot){const a=r;for(let p=0;p<a.getNumGeometries();p++)this.add(a.getGeometryN(p))}}else if(arguments[0]instanceof O){const r=arguments[0],a=r.distance(this._centroid);a<this._minDistance&&(this._interiorPoint=new O(r),this._minDistance=a)}}getInteriorPoint(){return this._interiorPoint}}class La{constructor(){La.constructor_.apply(this,arguments)}static constructor_(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;const r=arguments[0];this._input=r}static pointWithMinAngleWithSegment(r,a,p){let _=m.MAX_VALUE,C=null;for(let k=0;k<r.length;k++){const X=r[k];if(X===a||X===p)continue;const J=Wr.angleBetween(a,X,p);J<_&&(_=J,C=X)}return C}static pointWitMinAngleWithX(r,a){let p=m.MAX_VALUE,_=null;for(let C=0;C<r.length;C++){const k=r[C];if(k===a)continue;const X=k.x-a.x;let J=k.y-a.y;J<0&&(J=-J);const Ct=J/Math.sqrt(X*X+J*J);Ct<p&&(p=Ct,_=k)}return _}static lowestPoint(r){let a=r[0];for(let p=1;p<r.length;p++)r[p].y<a.y&&(a=r[p]);return a}static farthestPoints(r){const a=r[0].distance(r[1]),p=r[1].distance(r[2]),_=r[2].distance(r[0]);return a>=p&&a>=_?[r[0],r[1]]:p>=a&&p>=_?[r[1],r[2]]:[r[2],r[0]]}getRadius(){return this.compute(),this._radius}getDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}const r=this._extremalPts[0],a=this._extremalPts[1];return this._input.getFactory().createLineString([r,a])}getExtremalPoints(){return this.compute(),this._extremalPts}computeCirclePoints(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(this._input.getNumPoints()===1){const C=this._input.getCoordinates();return this._extremalPts=[new O(C[0])],null}const r=this._input.convexHull().getCoordinates();let a=r;if(r[0].equals2D(r[r.length-1])&&(a=new Array(r.length-1).fill(null),De.copyDeep(r,0,a,0,r.length-1)),a.length<=2)return this._extremalPts=De.copyDeep(a),null;let p=La.lowestPoint(a),_=La.pointWitMinAngleWithX(a,p);for(let C=0;C<a.length;C++){const k=La.pointWithMinAngleWithSegment(a,p,_);if(Wr.isObtuse(p,k,_))return this._extremalPts=[new O(p),new O(_)],null;if(Wr.isObtuse(k,p,_))p=k;else{if(!Wr.isObtuse(k,_,p))return this._extremalPts=[new O(p),new O(_),new O(k)],null;_=k}}L.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}compute(){if(this._extremalPts!==null)return null;this.computeCirclePoints(),this.computeCentre(),this._centre!==null&&(this._radius=this._centre.distance(this._extremalPts[0]))}getCircle(){if(this.compute(),this._centre===null)return this._input.getFactory().createPolygon();const r=this._input.getFactory().createPoint(this._centre);return this._radius===0?r:Vi.bufferOp(r,this._radius)}getCentre(){return this.compute(),this._centre}getMaximumDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre);case 2:return this._input.getFactory().createLineString([this._extremalPts[0],this._extremalPts[1]]);default:const r=La.farthestPoints(this._extremalPts);return this._input.getFactory().createLineString(r)}}computeCentre(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new O((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=qi.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}}class Ko{constructor(){Ko.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new gr,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,arguments.length===1){const r=arguments[0];Ko.constructor_.call(this,r,!1)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._inputGeom=r,this._isConvex=a}}static nextIndex(r,a){return++a>=r.length&&(a=0),a}static computeC(r,a,p){return r*p.y-a*p.x}static getMinimumDiameter(r){return new Ko(r).getDiameter()}static getMinimumRectangle(r){return new Ko(r).getMinimumRectangle()}static computeSegmentForLine(r,a,p){let _=null,C=null;return Math.abs(a)>Math.abs(r)?(_=new O(0,p/a),C=new O(1,p/a-r/a)):(_=new O(p/r,0),C=new O(p/r-a/r,1)),new gr(_,C)}getWidthCoordinate(){return this.computeMinimumDiameter(),this._minWidthPt}getSupportingSegment(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}getDiameter(){if(this.computeMinimumDiameter(),this._minWidthPt===null)return this._inputGeom.getFactory().createLineString();const r=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([r,this._minWidthPt])}computeWidthConvex(r){this._convexHullPts=r instanceof Ut?r.getExteriorRing().getCoordinates():r.getCoordinates(),this._convexHullPts.length===0?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):this._convexHullPts.length===1?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):this._convexHullPts.length===2||this._convexHullPts.length===3?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}computeConvexRingMinDiameter(r){this._minWidth=m.MAX_VALUE;let a=1;const p=new gr;for(let _=0;_<r.length-1;_++)p.p0=r[_],p.p1=r[_+1],a=this.findMaxPerpDistance(r,p,a)}findMaxPerpDistance(r,a,p){let _=a.distancePerpendicular(r[p]),C=_,k=p,X=k;for(;C>=_;)_=C,k=X,X=Ko.nextIndex(r,k),C=a.distancePerpendicular(r[X]);return _<this._minWidth&&(this._minPtIndex=k,this._minWidth=_,this._minWidthPt=r[this._minPtIndex],this._minBaseSeg=new gr(a)),k}getMinimumRectangle(){if(this.computeMinimumDiameter(),this._minWidth===0)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());const r=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,a=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y;let p=m.MAX_VALUE,_=-m.MAX_VALUE,C=m.MAX_VALUE,k=-m.MAX_VALUE;for(let Vn=0;Vn<this._convexHullPts.length;Vn++){const no=Ko.computeC(r,a,this._convexHullPts[Vn]);no>_&&(_=no),no<p&&(p=no);const ma=Ko.computeC(-a,r,this._convexHullPts[Vn]);ma>k&&(k=ma),ma<C&&(C=ma)}const X=Ko.computeSegmentForLine(-r,-a,k),J=Ko.computeSegmentForLine(-r,-a,C),Ct=Ko.computeSegmentForLine(-a,r,_),te=Ko.computeSegmentForLine(-a,r,p),ce=Ct.lineIntersection(X),Ye=te.lineIntersection(X),sr=te.lineIntersection(J),Cr=Ct.lineIntersection(J),Ii=this._inputGeom.getFactory().createLinearRing([ce,Ye,sr,Cr,ce]);return this._inputGeom.getFactory().createPolygon(Ii)}computeMinimumDiameter(){if(this._minWidthPt!==null)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{const r=new aa(this._inputGeom).getConvexHull();this.computeWidthConvex(r)}}getLength(){return this.computeMinimumDiameter(),this._minWidth}}var hf=Object.freeze({__proto__:null,Angle:Wr,Area:Wt,Centroid:Ta,ConvexHull:aa,Distance:je,InteriorPointArea:jo,InteriorPointLine:cs,InteriorPointPoint:Ma,Length:Br,MinimumBoundingCircle:La,MinimumDiameter:Ko,Orientation:Yt,PointLocation:Gi,PointLocator:Ea,RobustLineIntersector:tn,distance:ko,locate:Ki,match:$h});class lc{constructor(){lc.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null;const r=arguments[0];this._inputGeom=r}static densify(r,a){const p=new lc(r);return p.setDistanceTolerance(a),p.getResultGeometry()}static densifyPoints(r,a,p){const _=new gr,C=new W;for(let k=0;k<r.length-1;k++){_.p0=r[k],_.p1=r[k+1],C.add(_.p0,!1);const X=_.getLength(),J=Math.trunc(X/a)+1;if(J>1){const Ct=X/J;for(let te=1;te<J;te++){const ce=te*Ct/X,Ye=_.pointAlong(ce);p.makePrecise(Ye),C.add(Ye,!1)}}}return C.add(r[r.length-1],!1),C.toCoordinateArray()}setDistanceTolerance(r){if(r<=0)throw new u("Tolerance must be positive");this._distanceTolerance=r}getResultGeometry(){return new Jh(this._distanceTolerance).transform(this._inputGeom)}}class Jh extends Xe{constructor(){super(),Jh.constructor_.apply(this,arguments)}static constructor_(){this.distanceTolerance=null;const r=arguments[0];this.distanceTolerance=r}transformCoordinates(r,a){const p=r.toCoordinateArray();let _=lc.densifyPoints(p,this.distanceTolerance,a.getPrecisionModel());return a instanceof Ee&&_.length===1&&(_=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(_)}transformPolygon(r,a){const p=super.transformPolygon.call(this,r,a);return a instanceof ae?p:this.createValidArea(p)}createValidArea(r){return Vi.bufferOp(r,0)}transformMultiPolygon(r,a){const p=super.transformMultiPolygon.call(this,r,a);return this.createValidArea(p)}}lc.DensifyTransformer=Jh;var Xc=Object.freeze({__proto__:null,Densifier:lc});class cc{constructor(){cc.constructor_.apply(this,arguments)}static constructor_(){this._orig=null,this._sym=null,this._next=null;const r=arguments[0];this._orig=r}static create(r,a){const p=new cc(r),_=new cc(a);return p.link(_),p}oNext(){return this._sym._next}directionY(){return this.directionPt().getY()-this._orig.getY()}equals(){if(arguments.length===2&&arguments[1]instanceof O&&arguments[0]instanceof O){const r=arguments[0],a=arguments[1];return this._orig.equals2D(r)&&this._sym._orig.equals(a)}}findLowest(){let r=this,a=this.oNext();do a.compareTo(r)<0&&(r=a),a=a.oNext();while(a!==this);return r}compareTo(r){const a=r;return this.compareAngularDirection(a)}toStringNode(){const r=this.orig();this.dest();const a=new xn;a.append("Node( "+vi.format(r)+` )
`);let p=this;do a.append("  -> "+p),a.append(`
`),p=p.oNext();while(p!==this);return a.toString()}link(r){this.setSym(r),r.setSym(this),this.setNext(r),r.setNext(this)}orig(){return this._orig}setNext(r){this._next=r}find(r){let a=this;do{if(a===null)return null;if(a.dest().equals2D(r))return a;a=a.oNext()}while(a!==this);return null}dest(){return this._sym._orig}isEdgesSorted(){const r=this.findLowest();let a=r;do{const p=a.oNext();if(p===r)break;if(!(p.compareTo(a)>0))return!1;a=p}while(a!==r);return!0}insert(r){if(this.oNext()===this)return this.insertAfter(r),null;this.insertionEdge(r).insertAfter(r)}insertAfter(r){L.equals(this._orig,r.orig());const a=this.oNext();this._sym.setNext(r),r.sym().setNext(a)}degree(){let r=0,a=this;do r++,a=a.oNext();while(a!==this);return r}directionPt(){return this.dest()}sym(){return this._sym}prev(){return this._sym.next()._sym}compareAngularDirection(r){const a=this.directionX(),p=this.directionY(),_=r.directionX(),C=r.directionY();if(a===_&&p===C)return 0;const k=hi.quadrant(a,p),X=hi.quadrant(_,C);if(k>X)return 1;if(k<X)return-1;const J=this.directionPt(),Ct=r.directionPt();return Yt.index(r._orig,Ct,J)}prevNode(){let r=this;for(;r.degree()===2;)if(r=r.prev(),r===this)return null;return r}directionX(){return this.directionPt().getX()-this._orig.getX()}insertionEdge(r){let a=this;do{const p=a.oNext();if(p.compareTo(a)>0&&r.compareTo(a)>=0&&r.compareTo(p)<=0||p.compareTo(a)<=0&&(r.compareTo(p)<=0||r.compareTo(a)>=0))return a;a=p}while(a!==this);return L.shouldNeverReachHere(),null}next(){return this._next}setSym(r){this._sym=r}toString(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}toStringNodeEdge(){return"  -> ("+vi.format(this.dest())}}class rn extends cc{constructor(){super(),rn.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1;const r=arguments[0];cc.constructor_.call(this,r)}static setMarkBoth(r,a){r.setMark(a),r.sym().setMark(a)}static isMarked(r){return r.isMarked()}static setMark(r,a){r.setMark(a)}static markBoth(r){r.mark(),r.sym().mark()}static mark(r){r.mark()}setMark(r){this._isMarked=r}mark(){this._isMarked=!0}isMarked(){return this._isMarked}}class Hu{constructor(){Hu.constructor_.apply(this,arguments)}static constructor_(){this._vertexMap=new br}static isValidEdge(r,a){return a.compareTo(r)!==0}insert(r,a,p){const _=this.create(r,a);p!==null?p.insert(_):this._vertexMap.put(r,_);const C=this._vertexMap.get(a);return C!==null?C.insert(_.sym()):this._vertexMap.put(a,_.sym()),_}create(r,a){const p=this.createEdge(r),_=this.createEdge(a);return p.link(_),p}createEdge(r){return new cc(r)}addEdge(r,a){if(!Hu.isValidEdge(r,a))return null;const p=this._vertexMap.get(r);let _=null;return p!==null&&(_=p.find(a)),_!==null?_:this.insert(r,a,p)}getVertexEdges(){return this._vertexMap.values()}findEdge(r,a){const p=this._vertexMap.get(r);return p===null?null:p.find(a)}}class Aa extends rn{constructor(){super(),Aa.constructor_.apply(this,arguments)}static constructor_(){this._isStart=!1;const r=arguments[0];rn.constructor_.call(this,r)}setStart(){this._isStart=!0}isStart(){return this._isStart}}class Qh extends Hu{constructor(){super()}createEdge(r){return new Aa(r)}}class Xu{constructor(){Xu.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._factory=null,this._graph=null,this._lines=new $,this._nodeEdgeStack=new Bn,this._ringStartEdge=null,this._graph=new Qh}static dissolve(r){const a=new Xu;return a.add(r),a.getResult()}addLine(r){this._lines.add(this._factory.createLineString(r.toCoordinateArray()))}updateRingStartEdge(r){return r.isStart()||(r=r.sym()).isStart()?this._ringStartEdge===null?(this._ringStartEdge=r,null):void(r.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=r)):null}getResult(){return this._result===null&&this.computeResult(),this._result}process(r){let a=r.prevNode();a===null&&(a=r),this.stackEdges(a),this.buildLines()}stackEdges(r){let a=r;do rn.isMarked(a)||this._nodeEdgeStack.add(a),a=a.oNext();while(a!==r)}computeResult(){for(let r=this._graph.getVertexEdges().iterator();r.hasNext();){const a=r.next();rn.isMarked(a)||this.process(a)}this._result=this._factory.buildGeometry(this._lines)}buildLines(){for(;!this._nodeEdgeStack.empty();){const r=this._nodeEdgeStack.pop();rn.isMarked(r)||this.buildLine(r)}}add(){if(arguments[0]instanceof oe)arguments[0].apply(new class{get interfaces_(){return[Ue]}filter(r){r instanceof Ee&&this.add(r)}});else if(pt(arguments[0],T))for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.add(a)}else if(arguments[0]instanceof Ee){const r=arguments[0];this._factory===null&&(this._factory=r.getFactory());const a=r.getCoordinateSequence();let p=!1;for(let _=1;_<a.size();_++){const C=this._graph.addEdge(a.getCoordinate(_-1),a.getCoordinate(_));C!==null&&(p||(C.setStart(),p=!0))}}}buildRing(r){const a=new W;let p=r;for(a.add(p.orig().copy(),!1);p.sym().degree()===2;){const _=p.next();if(_===r)break;a.add(_.orig().copy(),!1),p=_}a.add(p.dest().copy(),!1),this.addLine(a)}buildLine(r){const a=new W;let p=r;for(this._ringStartEdge=null,rn.markBoth(p),a.add(p.orig().copy(),!1);p.sym().degree()===2;){this.updateRingStartEdge(p);const _=p.next();if(_===r)return this.buildRing(this._ringStartEdge),null;a.add(_.orig().copy(),!1),p=_,rn.markBoth(p)}a.add(p.dest().clone(),!1),this.stackEdges(p.sym()),this.addLine(a)}}var tp=Object.freeze({__proto__:null,LineDissolver:Xu}),pf=Object.freeze({__proto__:null,GeometryGraph:Go});class Wu{visit(r){}}class Cl{constructor(){Cl.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,arguments.length===2){const r=arguments[0],a=arguments[1];this._p=new O(r),this._left=null,this._right=null,this._count=1,this._data=a}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._p=new O(r,a),this._left=null,this._right=null,this._count=1,this._data=p}}isRepeated(){return this._count>1}getRight(){return this._right}getCoordinate(){return this._p}setLeft(r){this._left=r}getX(){return this._p.x}getData(){return this._data}getCount(){return this._count}increment(){this._count=this._count+1}setRight(r){this._right=r}getLeft(){return this._left}getY(){return this._p.y}}class Tl{constructor(){Tl.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,arguments.length===0)Tl.constructor_.call(this,0);else if(arguments.length===1){const r=arguments[0];this._tolerance=r}}static toCoordinates(){if(arguments.length===1){const r=arguments[0];return Tl.toCoordinates(r,!1)}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=new W;for(let _=r.iterator();_.hasNext();){const C=_.next(),k=a?C.getCount():1;for(let X=0;X<k;X++)p.add(C.getCoordinate(),!0)}return p.toCoordinateArray()}}insert(){if(arguments.length===1){const r=arguments[0];return this.insert(r,null)}if(arguments.length===2){const r=arguments[0],a=arguments[1];if(this._root===null)return this._root=new Cl(r,a),this._root;if(this._tolerance>0){const p=this.findBestMatchNode(r);if(p!==null)return p.increment(),p}return this.insertExact(r,a)}}query(){if(arguments.length===1){const r=arguments[0],a=new $;return this.query(r,a),a}if(arguments.length===2){if(arguments[0]instanceof nt&&pt(arguments[1],ut)){const r=arguments[0],a=arguments[1];this.queryNode(this._root,r,!0,new class{get interfaces_(){return[Wu]}visit(p){a.add(p)}})}else if(arguments[0]instanceof nt&&pt(arguments[1],Wu)){const r=arguments[0],a=arguments[1];this.queryNode(this._root,r,!0,a)}}}queryNode(r,a,p,_){if(r===null)return null;let C=null,k=null,X=null;p?(C=a.getMinX(),k=a.getMaxX(),X=r.getX()):(C=a.getMinY(),k=a.getMaxY(),X=r.getY());const J=X<=k;C<X&&this.queryNode(r.getLeft(),a,!p,_),a.contains(r.getCoordinate())&&_.visit(r),J&&this.queryNode(r.getRight(),a,!p,_)}findBestMatchNode(r){const a=new Wc(r,this._tolerance);return this.query(a.queryEnvelope(),a),a.getNode()}isEmpty(){return this._root===null}insertExact(r,a){let p=this._root,_=this._root,C=!0,k=!0;for(;p!==null;){if(p!==null&&r.distance(p.getCoordinate())<=this._tolerance)return p.increment(),p;k=C?r.x<p.getX():r.y<p.getY(),_=p,p=k?p.getLeft():p.getRight(),C=!C}this._numberOfNodes=this._numberOfNodes+1;const X=new Cl(r,a);return k?_.setLeft(X):_.setRight(X),X}}class Wc{constructor(){Wc.constructor_.apply(this,arguments)}static constructor_(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;const r=arguments[0],a=arguments[1];this._p=r,this._tolerance=a}queryEnvelope(){const r=new nt(this._p);return r.expandBy(this._tolerance),r}getNode(){return this._matchNode}visit(r){const a=this._p.distance(r.getCoordinate());if(!(a<=this._tolerance))return null;let p=!1;(this._matchNode===null||a<this._matchDist||this._matchNode!==null&&a===this._matchDist&&r.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(p=!0),p&&(this._matchNode=r,this._matchDist=a)}get interfaces_(){return[Wu]}}Tl.BestMatchVisitor=Wc;var ff=Object.freeze({__proto__:null,KdTree:Tl});class il{constructor(){il.constructor_.apply(this,arguments)}static constructor_(){this._items=new $,this._subnode=new Array(4).fill(null)}static getSubnodeIndex(r,a,p){let _=-1;return r.getMinX()>=a&&(r.getMinY()>=p&&(_=3),r.getMaxY()<=p&&(_=1)),r.getMaxX()<=a&&(r.getMinY()>=p&&(_=2),r.getMaxY()<=p&&(_=0)),_}size(){let r=0;for(let a=0;a<4;a++)this._subnode[a]!==null&&(r+=this._subnode[a].size());return r+this._items.size()}addAllItemsFromOverlapping(r,a){if(!this.isSearchMatch(r))return null;a.addAll(this._items);for(let p=0;p<4;p++)this._subnode[p]!==null&&this._subnode[p].addAllItemsFromOverlapping(r,a)}visitItems(r,a){for(let p=this._items.iterator();p.hasNext();)a.visitItem(p.next())}hasItems(){return!this._items.isEmpty()}remove(r,a){if(!this.isSearchMatch(r))return!1;let p=!1;for(let _=0;_<4;_++)if(this._subnode[_]!==null&&(p=this._subnode[_].remove(r,a),p)){this._subnode[_].isPrunable()&&(this._subnode[_]=null);break}return p||(p=this._items.remove(a),p)}visit(r,a){if(!this.isSearchMatch(r))return null;this.visitItems(r,a);for(let p=0;p<4;p++)this._subnode[p]!==null&&this._subnode[p].visit(r,a)}getItems(){return this._items}depth(){let r=0;for(let a=0;a<4;a++)if(this._subnode[a]!==null){const p=this._subnode[a].depth();p>r&&(r=p)}return r+1}hasChildren(){for(let r=0;r<4;r++)if(this._subnode[r]!==null)return!0;return!1}isPrunable(){return!(this.hasChildren()||this.hasItems())}addAllItems(r){r.addAll(this._items);for(let a=0;a<4;a++)this._subnode[a]!==null&&this._subnode[a].addAllItems(r);return r}getNodeCount(){let r=0;for(let a=0;a<4;a++)this._subnode[a]!==null&&(r+=this._subnode[a].size());return r+1}isEmpty(){let r=!0;if(this._items.isEmpty()){for(let a=0;a<4;a++)if(this._subnode[a]!==null&&!this._subnode[a].isEmpty()){r=!1;break}}else r=!1;return r}add(r){this._items.add(r)}get interfaces_(){return[x]}}function Yc(){}Yc.exponent=function(dt){return function(r,a){let p,_,C,k;const X={64:{d:32752,c:0,b:0,a:0}},J={64:11}[r];if(k||(p=a<0||1/a<0,isFinite(a)||(k=X[r],p&&(k.d+=1<<r/4-1),_=Math.pow(2,J)-1,C=0)),!k){for(_={64:1023}[r],C=Math.abs(a);C>=2;)_++,C/=2;for(;C<1&&_>0;)_--,C*=2;_<=0&&(C/=2)}return _}(64,dt)-1023},Yc.powerOf2=function(dt){return Math.pow(2,dt)};class Pl{constructor(){Pl.constructor_.apply(this,arguments)}static constructor_(){this._pt=new O,this._level=0,this._env=null;const r=arguments[0];this.computeKey(r)}static computeQuadLevel(r){const a=r.getWidth(),p=r.getHeight(),_=a>p?a:p;return Yc.exponent(_)+1}getLevel(){return this._level}computeKey(){if(arguments.length===1){const r=arguments[0];for(this._level=Pl.computeQuadLevel(r),this._env=new nt,this.computeKey(this._level,r);!this._env.contains(r);)this._level+=1,this.computeKey(this._level,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1],p=Yc.powerOf2(r);this._pt.x=Math.floor(a.getMinX()/p)*p,this._pt.y=Math.floor(a.getMinY()/p)*p,this._env.init(this._pt.x,this._pt.x+p,this._pt.y,this._pt.y+p)}}getEnvelope(){return this._env}getCentre(){return new O((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}getPoint(){return this._pt}}let df=class Fd extends il{constructor(){super(),Fd.constructor_.apply(this,arguments)}static constructor_(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;const r=arguments[0],a=arguments[1];this._env=r,this._level=a,this._centrex=(r.getMinX()+r.getMaxX())/2,this._centrey=(r.getMinY()+r.getMaxY())/2}static createNode(r){const a=new Pl(r);return new Fd(a.getEnvelope(),a.getLevel())}static createExpanded(r,a){const p=new nt(a);r!==null&&p.expandToInclude(r._env);const _=Fd.createNode(p);return r!==null&&_.insertNode(r),_}find(r){const a=il.getSubnodeIndex(r,this._centrex,this._centrey);return a===-1?this:this._subnode[a]!==null?this._subnode[a].find(r):this}isSearchMatch(r){return r!==null&&this._env.intersects(r)}getSubnode(r){return this._subnode[r]===null&&(this._subnode[r]=this.createSubnode(r)),this._subnode[r]}getEnvelope(){return this._env}getNode(r){const a=il.getSubnodeIndex(r,this._centrex,this._centrey);return a!==-1?this.getSubnode(a).getNode(r):this}createSubnode(r){let a=0,p=0,_=0,C=0;switch(r){case 0:a=this._env.getMinX(),p=this._centrex,_=this._env.getMinY(),C=this._centrey;break;case 1:a=this._centrex,p=this._env.getMaxX(),_=this._env.getMinY(),C=this._centrey;break;case 2:a=this._env.getMinX(),p=this._centrex,_=this._centrey,C=this._env.getMaxY();break;case 3:a=this._centrex,p=this._env.getMaxX(),_=this._centrey,C=this._env.getMaxY()}const k=new nt(a,p,_,C);return new Fd(k,this._level-1)}insertNode(r){L.isTrue(this._env===null||this._env.contains(r._env));const a=il.getSubnodeIndex(r._env,this._centrex,this._centrey);if(r._level===this._level-1)this._subnode[a]=r;else{const p=this.createSubnode(a);p.insertNode(r),this._subnode[a]=p}}};class Zc{static isZeroWidth(r,a){const p=a-r;if(p===0)return!0;const _=p/Math.max(Math.abs(r),Math.abs(a));return Yc.exponent(_)<=Zc.MIN_BINARY_EXPONENT}}Zc.MIN_BINARY_EXPONENT=-50;class Il extends il{constructor(){super()}insertContained(r,a,p){L.isTrue(r.getEnvelope().contains(a));const _=Zc.isZeroWidth(a.getMinX(),a.getMaxX()),C=Zc.isZeroWidth(a.getMinY(),a.getMaxY());let k=null;k=_||C?r.find(a):r.getNode(a),k.add(p)}isSearchMatch(r){return!0}insert(r,a){const p=il.getSubnodeIndex(r,Il.origin.x,Il.origin.y);if(p===-1)return this.add(a),null;const _=this._subnode[p];if(_===null||!_.getEnvelope().contains(r)){const C=df.createExpanded(_,r);this._subnode[p]=C}this.insertContained(this._subnode[p],r,a)}}Il.origin=new O(0,0);class Ml{constructor(){Ml.constructor_.apply(this,arguments)}static constructor_(){this._root=null,this._minExtent=1,this._root=new Il}static ensureExtent(r,a){let p=r.getMinX(),_=r.getMaxX(),C=r.getMinY(),k=r.getMaxY();return p!==_&&C!==k?r:(p===_&&(p-=a/2,_+=a/2),C===k&&(C-=a/2,k+=a/2),new nt(p,_,C,k))}size(){return this._root!==null?this._root.size():0}insert(r,a){this.collectStats(r);const p=Ml.ensureExtent(r,this._minExtent);this._root.insert(p,a)}query(){if(arguments.length===1){const r=arguments[0],a=new el;return this.query(r,a),a.getItems()}if(arguments.length===2){const r=arguments[0],a=arguments[1];this._root.visit(r,a)}}queryAll(){const r=new $;return this._root.addAllItems(r),r}remove(r,a){const p=Ml.ensureExtent(r,this._minExtent);return this._root.remove(p,a)}collectStats(r){const a=r.getWidth();a<this._minExtent&&a>0&&(this._minExtent=a);const p=r.getHeight();p<this._minExtent&&p>0&&(this._minExtent=p)}depth(){return this._root!==null?this._root.depth():0}isEmpty(){return this._root===null||this._root.isEmpty()}get interfaces_(){return[pr,x]}}var gf=Object.freeze({__proto__:null,Quadtree:Ml}),Dm=Object.freeze({__proto__:null,STRtree:ri}),ep=Object.freeze({__proto__:null,kdtree:ff,quadtree:gf,strtree:Dm});const Lo=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class mf{constructor(r){this.geometryFactory=r||new Se}read(r){let a;a=typeof r=="string"?JSON.parse(r):r;const p=a.type;if(!Ao[p])throw new Error("Unknown GeoJSON type: "+a.type);return Lo.indexOf(p)!==-1?Ao[p].call(this,a.coordinates):p==="GeometryCollection"?Ao[p].call(this,a.geometries):Ao[p].call(this,a)}write(r){const a=r.getGeometryType();if(!us[a])throw new Error("Geometry is not supported");return us[a].call(this,r)}}const Ao={Feature:function(dt){const r={};for(const a in dt)r[a]=dt[a];if(dt.geometry){const a=dt.geometry.type;if(!Ao[a])throw new Error("Unknown GeoJSON type: "+dt.type);r.geometry=this.read(dt.geometry)}return dt.bbox&&(r.bbox=Ao.bbox.call(this,dt.bbox)),r},FeatureCollection:function(dt){const r={};if(dt.features){r.features=[];for(let a=0;a<dt.features.length;++a)r.features.push(this.read(dt.features[a]))}return dt.bbox&&(r.bbox=this.parse.bbox.call(this,dt.bbox)),r},coordinates:function(dt){const r=[];for(let a=0;a<dt.length;++a){const p=dt[a];r.push(new O(...p))}return r},bbox:function(dt){return this.geometryFactory.createLinearRing([new O(dt[0],dt[1]),new O(dt[2],dt[1]),new O(dt[2],dt[3]),new O(dt[0],dt[3]),new O(dt[0],dt[1])])},Point:function(dt){const r=new O(...dt);return this.geometryFactory.createPoint(r)},MultiPoint:function(dt){const r=[];for(let a=0;a<dt.length;++a)r.push(Ao.Point.call(this,dt[a]));return this.geometryFactory.createMultiPoint(r)},LineString:function(dt){const r=Ao.coordinates.call(this,dt);return this.geometryFactory.createLineString(r)},MultiLineString:function(dt){const r=[];for(let a=0;a<dt.length;++a)r.push(Ao.LineString.call(this,dt[a]));return this.geometryFactory.createMultiLineString(r)},Polygon:function(dt){const r=Ao.coordinates.call(this,dt[0]),a=this.geometryFactory.createLinearRing(r),p=[];for(let _=1;_<dt.length;++_){const C=dt[_],k=Ao.coordinates.call(this,C),X=this.geometryFactory.createLinearRing(k);p.push(X)}return this.geometryFactory.createPolygon(a,p)},MultiPolygon:function(dt){const r=[];for(let a=0;a<dt.length;++a){const p=dt[a];r.push(Ao.Polygon.call(this,p))}return this.geometryFactory.createMultiPolygon(r)},GeometryCollection:function(dt){const r=[];for(let a=0;a<dt.length;++a){const p=dt[a];r.push(this.read(p))}return this.geometryFactory.createGeometryCollection(r)}},us={coordinate:function(dt){const r=[dt.x,dt.y];return dt.z&&r.push(dt.z),dt.m&&r.push(dt.m),r},Point:function(dt){return{type:"Point",coordinates:us.coordinate.call(this,dt.getCoordinate())}},MultiPoint:function(dt){const r=[];for(let a=0;a<dt._geometries.length;++a){const p=dt._geometries[a],_=us.Point.call(this,p);r.push(_.coordinates)}return{type:"MultiPoint",coordinates:r}},LineString:function(dt){const r=[],a=dt.getCoordinates();for(let p=0;p<a.length;++p){const _=a[p];r.push(us.coordinate.call(this,_))}return{type:"LineString",coordinates:r}},MultiLineString:function(dt){const r=[];for(let a=0;a<dt._geometries.length;++a){const p=dt._geometries[a],_=us.LineString.call(this,p);r.push(_.coordinates)}return{type:"MultiLineString",coordinates:r}},Polygon:function(dt){const r=[],a=us.LineString.call(this,dt._shell);r.push(a.coordinates);for(let p=0;p<dt._holes.length;++p){const _=dt._holes[p],C=us.LineString.call(this,_);r.push(C.coordinates)}return{type:"Polygon",coordinates:r}},MultiPolygon:function(dt){const r=[];for(let a=0;a<dt._geometries.length;++a){const p=dt._geometries[a],_=us.Polygon.call(this,p);r.push(_.coordinates)}return{type:"MultiPolygon",coordinates:r}},GeometryCollection:function(dt){const r=[];for(let a=0;a<dt._geometries.length;++a){const p=dt._geometries[a],_=p.getGeometryType();r.push(us[_].call(this,p))}return{type:"GeometryCollection",geometries:r}}};function uc(dt){return[dt.x,dt.y]}var Dd=Object.freeze({__proto__:null,GeoJSONReader:class{constructor(dt){this.parser=new mf(dt||new Se)}read(dt){return this.parser.read(dt)}},GeoJSONWriter:class{constructor(){this.parser=new mf(this.geometryFactory)}write(dt){return this.parser.write(dt)}},OL3Parser:class{constructor(dt,r){this.geometryFactory=dt||new Se,this.ol=r||typeof ol<"u"&&ol}inject(dt,r,a,p,_,C,k,X){this.ol={geom:{Point:dt,LineString:r,LinearRing:a,Polygon:p,MultiPoint:_,MultiLineString:C,MultiPolygon:k,GeometryCollection:X}}}read(dt){const r=this.ol;return dt instanceof r.geom.Point?this.convertFromPoint(dt):dt instanceof r.geom.LineString?this.convertFromLineString(dt):dt instanceof r.geom.LinearRing?this.convertFromLinearRing(dt):dt instanceof r.geom.Polygon?this.convertFromPolygon(dt):dt instanceof r.geom.MultiPoint?this.convertFromMultiPoint(dt):dt instanceof r.geom.MultiLineString?this.convertFromMultiLineString(dt):dt instanceof r.geom.MultiPolygon?this.convertFromMultiPolygon(dt):dt instanceof r.geom.GeometryCollection?this.convertFromCollection(dt):void 0}convertFromPoint(dt){const r=dt.getCoordinates();return this.geometryFactory.createPoint(new O(r[0],r[1]))}convertFromLineString(dt){return this.geometryFactory.createLineString(dt.getCoordinates().map(function(r){return new O(r[0],r[1])}))}convertFromLinearRing(dt){return this.geometryFactory.createLinearRing(dt.getCoordinates().map(function(r){return new O(r[0],r[1])}))}convertFromPolygon(dt){const r=dt.getLinearRings();let a=null;const p=[];for(let _=0;_<r.length;_++){const C=this.convertFromLinearRing(r[_]);_===0?a=C:p.push(C)}return this.geometryFactory.createPolygon(a,p)}convertFromMultiPoint(dt){const r=dt.getPoints().map(function(a){return this.convertFromPoint(a)},this);return this.geometryFactory.createMultiPoint(r)}convertFromMultiLineString(dt){const r=dt.getLineStrings().map(function(a){return this.convertFromLineString(a)},this);return this.geometryFactory.createMultiLineString(r)}convertFromMultiPolygon(dt){const r=dt.getPolygons().map(function(a){return this.convertFromPolygon(a)},this);return this.geometryFactory.createMultiPolygon(r)}convertFromCollection(dt){const r=dt.getGeometries().map(function(a){return this.read(a)},this);return this.geometryFactory.createGeometryCollection(r)}write(dt){return dt.getGeometryType()==="Point"?this.convertToPoint(dt.getCoordinate()):dt.getGeometryType()==="LineString"?this.convertToLineString(dt):dt.getGeometryType()==="LinearRing"?this.convertToLinearRing(dt):dt.getGeometryType()==="Polygon"?this.convertToPolygon(dt):dt.getGeometryType()==="MultiPoint"?this.convertToMultiPoint(dt):dt.getGeometryType()==="MultiLineString"?this.convertToMultiLineString(dt):dt.getGeometryType()==="MultiPolygon"?this.convertToMultiPolygon(dt):dt.getGeometryType()==="GeometryCollection"?this.convertToCollection(dt):void 0}convertToPoint(dt){return new this.ol.geom.Point([dt.x,dt.y])}convertToLineString(dt){const r=dt._points._coordinates.map(uc);return new this.ol.geom.LineString(r)}convertToLinearRing(dt){const r=dt._points._coordinates.map(uc);return new this.ol.geom.LinearRing(r)}convertToPolygon(dt){const r=[dt._shell._points._coordinates.map(uc)];for(let a=0;a<dt._holes.length;a++)r.push(dt._holes[a]._points._coordinates.map(uc));return new this.ol.geom.Polygon(r)}convertToMultiPoint(dt){return new this.ol.geom.MultiPoint(dt.getCoordinates().map(uc))}convertToMultiLineString(dt){const r=[];for(let a=0;a<dt._geometries.length;a++)r.push(this.convertToLineString(dt._geometries[a]).getCoordinates());return new this.ol.geom.MultiLineString(r)}convertToMultiPolygon(dt){const r=[];for(let a=0;a<dt._geometries.length;a++)r.push(this.convertToPolygon(dt._geometries[a]).getCoordinates());return new this.ol.geom.MultiPolygon(r)}convertToCollection(dt){const r=[];for(let a=0;a<dt._geometries.length;a++){const p=dt._geometries[a];r.push(this.write(p))}return new this.ol.geom.GeometryCollection(r)}},WKTReader:class{constructor(dt){this.parser=new wn(dt||new Se)}read(dt){return this.parser.read(dt)}},WKTWriter:vi}),Gd=Object.freeze({__proto__:null,MCIndexNoder:Yr,ScaledNoder:Tt,SegmentString:Y});class nl{constructor(){nl.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){const r=arguments[0];nl.constructor_.call(this,r,po.MOD2_BOUNDARY_RULE)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=a}}static getBoundary(){if(arguments.length===1)return new nl(arguments[0]).getBoundary();if(arguments.length===2)return new nl(arguments[0],arguments[1]).getBoundary()}boundaryMultiLineString(r){if(this._geom.isEmpty())return this.getEmptyMultiPoint();const a=this.computeBoundaryCoordinates(r);return a.length===1?this._geomFact.createPoint(a[0]):this._geomFact.createMultiPointFromCoords(a)}getBoundary(){return this._geom instanceof Ee?this.boundaryLineString(this._geom):this._geom instanceof ar?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(r){return this._geom.isEmpty()?this.getEmptyMultiPoint():r.isClosed()?this._bnRule.isInBoundary(2)?r.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([r.getStartPoint(),r.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(r){const a=new $;this._endpointMap=new R;for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p);_.getNumPoints()!==0&&(this.addEndpoint(_.getCoordinateN(0)),this.addEndpoint(_.getCoordinateN(_.getNumPoints()-1)))}for(let p=this._endpointMap.entrySet().iterator();p.hasNext();){const _=p.next(),C=_.getValue().count;this._bnRule.isInBoundary(C)&&a.add(_.getKey())}return De.toCoordinateArray(a)}addEndpoint(r){let a=this._endpointMap.get(r);a===null&&(a=new jd,this._endpointMap.put(r,a)),a.count++}}let jd=class fE{constructor(){fE.constructor_.apply(this,arguments)}static constructor_(){this.count=null}};class Ll{constructor(){Ll.constructor_.apply(this,arguments)}static constructor_(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,arguments.length===1){const r=arguments[0];this._inputGeom=r}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._inputGeom=r,this._isClosedEndpointsInInterior=!a.isInBoundary(2)}}static isSimple(){if(arguments.length===1)return new Ll(arguments[0]).isSimple();if(arguments.length===2)return new Ll(arguments[0],arguments[1]).isSimple()}isSimpleMultiPoint(r){if(r.isEmpty())return!0;const a=new Xn;for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p).getCoordinate();if(a.contains(_))return this._nonSimpleLocation=_,!1;a.add(_)}return!0}isSimplePolygonal(r){for(let a=ke.getLines(r).iterator();a.hasNext();){const p=a.next();if(!this.isSimpleLinearGeometry(p))return!1}return!0}hasClosedEndpointIntersection(r){const a=new R;for(let p=r.getEdgeIterator();p.hasNext();){const _=p.next(),C=_.isClosed(),k=_.getCoordinate(0);this.addEndpoint(a,k,C);const X=_.getCoordinate(_.getNumPoints()-1);this.addEndpoint(a,X,C)}for(let p=a.values().iterator();p.hasNext();){const _=p.next();if(_.isClosed&&_.degree!==2)return this._nonSimpleLocation=_.getCoordinate(),!0}return!1}getNonSimpleLocation(){return this._nonSimpleLocation}isSimpleLinearGeometry(r){if(r.isEmpty())return!0;const a=new Go(0,r),p=new tn,_=a.computeSelfNodes(p,!0);return!_.hasIntersection()||(_.hasProperIntersection()?(this._nonSimpleLocation=_.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(a)&&(!this._isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(a)))}hasNonEndpointIntersection(r){for(let a=r.getEdgeIterator();a.hasNext();){const p=a.next(),_=p.getMaximumSegmentIndex();for(let C=p.getEdgeIntersectionList().iterator();C.hasNext();){const k=C.next();if(!k.isEndPoint(_))return this._nonSimpleLocation=k.getCoordinate(),!0}}return!1}addEndpoint(r,a,p){let _=r.get(a);_===null&&(_=new Yu(a),r.put(a,_)),_.addEndpoint(p)}computeSimple(r){return this._nonSimpleLocation=null,!!r.isEmpty()||(r instanceof Ee||r instanceof ar?this.isSimpleLinearGeometry(r):r instanceof ve?this.isSimpleMultiPoint(r):pt(r,Kt)?this.isSimplePolygonal(r):!(r instanceof Ot)||this.isSimpleGeometryCollection(r))}isSimple(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}isSimpleGeometryCollection(r){for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);if(!this.computeSimple(p))return!1}return!0}}class Yu{constructor(){Yu.constructor_.apply(this,arguments)}static constructor_(){this.pt=null,this.isClosed=null,this.degree=null;const r=arguments[0];this.pt=r,this.isClosed=!1,this.degree=0}getCoordinate(){return this.pt}addEndpoint(r){this.degree++,this.isClosed|=r}}Ll.EndpointInfo=Yu;var yf=Object.freeze({__proto__:null,BufferOp:Vi,BufferParameters:Zr});class to{constructor(){to.constructor_.apply(this,arguments)}static constructor_(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){const r=arguments[0],a=arguments[1];to.constructor_.call(this,r,to.INSIDE_AREA,a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._component=r,this._segIndex=a,this._pt=p}}getSegmentIndex(){return this._segIndex}getCoordinate(){return this._pt}isInsideArea(){return this._segIndex===to.INSIDE_AREA}toString(){return this._component.getGeometryType()+"["+this._segIndex+"]-"+vi.toPoint(this._pt)}getGeometryComponent(){return this._component}}to.INSIDE_AREA=-1;class Zu{constructor(){Zu.constructor_.apply(this,arguments)}static constructor_(){this._locations=null;const r=arguments[0];this._locations=r}static getLocations(r){const a=new $;return r.apply(new Zu(a)),a}filter(r){if(r.isEmpty())return null;(r instanceof zt||r instanceof Ee||r instanceof Ut)&&this._locations.add(new to(r,0,r.getCoordinate()))}get interfaces_(){return[wi]}}class la{constructor(){la.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Ea,this._minDistanceLocation=null,this._minDistance=m.MAX_VALUE,arguments.length===2){const r=arguments[0],a=arguments[1];la.constructor_.call(this,r,a,0)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=a,this._terminateDistance=p}}static distance(r,a){return new la(r,a).distance()}static isWithinDistance(r,a,p){return r.getEnvelopeInternal().distance(a.getEnvelopeInternal())>p?!1:new la(r,a,p).distance()<=p}static nearestPoints(r,a){return new la(r,a).nearestPoints()}computeContainmentDistance(){if(arguments.length===0){const r=new Array(2).fill(null);if(this.computeContainmentDistance(0,r),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1],p=this._geom[r];if(p.getDimension()<2)return null;const _=1-r,C=Fr.getPolygons(p);if(C.size()>0){const k=Zu.getLocations(this._geom[_]);if(this.computeContainmentDistance(k,C,a),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[_]=a[0],this._minDistanceLocation[r]=a[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&pt(arguments[0],ut)&&pt(arguments[1],ut)){const r=arguments[0],a=arguments[1],p=arguments[2];for(let _=0;_<r.size();_++){const C=r.get(_);for(let k=0;k<a.size();k++)if(this.computeContainmentDistance(C,a.get(k),p),this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof to&&arguments[1]instanceof Ut){const r=arguments[0],a=arguments[1],p=arguments[2],_=r.getCoordinate();if(St.EXTERIOR!==this._ptLocator.locate(_,a))return this._minDistance=0,p[0]=r,p[1]=new to(a,_),null}}}computeMinDistanceLinesPoints(r,a,p){for(let _=0;_<r.size();_++){const C=r.get(_);for(let k=0;k<a.size();k++){const X=a.get(k);if(this.computeMinDistance(C,X,p),this._minDistance<=this._terminateDistance)return null}}}computeFacetDistance(){const r=new Array(2).fill(null),a=ke.getLines(this._geom[0]),p=ke.getLines(this._geom[1]),_=mr.getPoints(this._geom[0]),C=mr.getPoints(this._geom[1]);return this.computeMinDistanceLines(a,p,r),this.updateMinDistance(r,!1),this._minDistance<=this._terminateDistance?null:(r[0]=null,r[1]=null,this.computeMinDistanceLinesPoints(a,C,r),this.updateMinDistance(r,!1),this._minDistance<=this._terminateDistance?null:(r[0]=null,r[1]=null,this.computeMinDistanceLinesPoints(p,_,r),this.updateMinDistance(r,!0),this._minDistance<=this._terminateDistance?null:(r[0]=null,r[1]=null,this.computeMinDistancePoints(_,C,r),void this.updateMinDistance(r,!1))))}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(r,a){if(r[0]===null)return null;a?(this._minDistanceLocation[0]=r[1],this._minDistanceLocation[1]=r[0]):(this._minDistanceLocation[0]=r[0],this._minDistanceLocation[1]=r[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Ee&&arguments[1]instanceof zt){const r=arguments[0],a=arguments[1],p=arguments[2];if(r.getEnvelopeInternal().distance(a.getEnvelopeInternal())>this._minDistance)return null;const _=r.getCoordinates(),C=a.getCoordinate();for(let k=0;k<_.length-1;k++){const X=je.pointToSegment(C,_[k],_[k+1]);if(X<this._minDistance){this._minDistance=X;const J=new gr(_[k],_[k+1]).closestPoint(C);p[0]=new to(r,k,J),p[1]=new to(a,0,C)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ee&&arguments[1]instanceof Ee){const r=arguments[0],a=arguments[1],p=arguments[2];if(r.getEnvelopeInternal().distance(a.getEnvelopeInternal())>this._minDistance)return null;const _=r.getCoordinates(),C=a.getCoordinates();for(let k=0;k<_.length-1;k++){const X=new nt(_[k],_[k+1]);if(!(X.distance(a.getEnvelopeInternal())>this._minDistance))for(let J=0;J<C.length-1;J++){const Ct=new nt(C[J],C[J+1]);if(X.distance(Ct)>this._minDistance)continue;const te=je.segmentToSegment(_[k],_[k+1],C[J],C[J+1]);if(te<this._minDistance){this._minDistance=te;const ce=new gr(_[k],_[k+1]),Ye=new gr(C[J],C[J+1]),sr=ce.closestPoints(Ye);p[0]=new to(r,k,sr[0]),p[1]=new to(a,J,sr[1])}if(this._minDistance<=this._terminateDistance)return null}}}}}computeMinDistancePoints(r,a,p){for(let _=0;_<r.size();_++){const C=r.get(_);for(let k=0;k<a.size();k++){const X=a.get(k),J=C.getCoordinate().distance(X.getCoordinate());if(J<this._minDistance&&(this._minDistance=J,p[0]=new to(C,0,C.getCoordinate()),p[1]=new to(X,0,X.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}}distance(){if(this._geom[0]===null||this._geom[1]===null)throw new u("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(r,a,p){for(let _=0;_<r.size();_++){const C=r.get(_);for(let k=0;k<a.size();k++){const X=a.get(k);if(this.computeMinDistance(C,X,p),this._minDistance<=this._terminateDistance)return null}}}}var Bd=Object.freeze({__proto__:null,DistanceOp:la});class vf{constructor(){vf.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._directedEdges=new $,this._coordinates=null;const r=arguments[0];this._factory=r}add(r){this._directedEdges.add(r)}toLineString(){return this._factory.createLineString(this.getCoordinates())}getCoordinates(){if(this._coordinates===null){let r=0,a=0;const p=new W;for(let _=this._directedEdges.iterator();_.hasNext();){const C=_.next();C.getEdgeDirection()?r++:a++,p.add(C.getEdge().getLine().getCoordinates(),!1,C.getEdgeDirection())}this._coordinates=p.toCoordinateArray(),a>r&&De.reverse(this._coordinates)}return this._coordinates}}class sl{constructor(){sl.constructor_.apply(this,arguments)}static constructor_(){this._isMarked=!1,this._isVisited=!1,this._data=null}static setMarked(r,a){for(;r.hasNext();)r.next().setMarked(a)}static setVisited(r,a){for(;r.hasNext();)r.next().setVisited(a)}static getComponentWithVisitedState(r,a){for(;r.hasNext();){const p=r.next();if(p.isVisited()===a)return p}return null}setVisited(r){this._isVisited=r}isMarked(){return this._isMarked}setData(r){this._data=r}getData(){return this._data}setMarked(r){this._isMarked=r}getContext(){return this._data}isVisited(){return this._isVisited}setContext(r){this._data=r}}class qs extends sl{constructor(){super(),qs.constructor_.apply(this,arguments)}static constructor_(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,arguments.length!==0){if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this._from=r,this._to=a,this._edgeDirection=_,this._p0=r.getCoordinate(),this._p1=p;const C=this._p1.x-this._p0.x,k=this._p1.y-this._p0.y;this._quadrant=hi.quadrant(C,k),this._angle=Math.atan2(k,C)}}}static toEdges(r){const a=new $;for(let p=r.iterator();p.hasNext();)a.add(p.next()._parentEdge);return a}isRemoved(){return this._parentEdge===null}compareDirection(r){return this._quadrant>r._quadrant?1:this._quadrant<r._quadrant?-1:Yt.index(r._p0,r._p1,this._p1)}getCoordinate(){return this._from.getCoordinate()}print(r){const a=this.getClass().getName(),p=a.lastIndexOf("."),_=a.substring(p+1);r.print("  "+_+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}getDirectionPt(){return this._p1}getAngle(){return this._angle}getSym(){return this._sym}getEdge(){return this._parentEdge}getToNode(){return this._to}getEdgeDirection(){return this._edgeDirection}compareTo(r){const a=r;return this.compareDirection(a)}getFromNode(){return this._from}setEdge(r){this._parentEdge=r}remove(){this._sym=null,this._parentEdge=null}getQuadrant(){return this._quadrant}setSym(r){this._sym=r}get interfaces_(){return[g]}}class hc extends qs{constructor(){super(),hc.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];qs.constructor_.call(this,r,a,p,_)}getNext(){return this.getToNode().getDegree()!==2?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(L.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}}class co extends sl{constructor(){super(),co.constructor_.apply(this,arguments)}static constructor_(){if(this._dirEdge=null,arguments.length!==0){if(arguments.length===2){const r=arguments[0],a=arguments[1];this.setDirectedEdges(r,a)}}}isRemoved(){return this._dirEdge===null}setDirectedEdges(r,a){this._dirEdge=[r,a],r.setEdge(this),a.setEdge(this),r.setSym(a),a.setSym(r),r.getFromNode().addOutEdge(r),a.getFromNode().addOutEdge(a)}getDirEdge(){if(Number.isInteger(arguments[0])){const r=arguments[0];return this._dirEdge[r]}if(arguments[0]instanceof Nn){const r=arguments[0];return this._dirEdge[0].getFromNode()===r?this._dirEdge[0]:this._dirEdge[1].getFromNode()===r?this._dirEdge[1]:null}}remove(){this._dirEdge=null}getOppositeNode(r){return this._dirEdge[0].getFromNode()===r?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===r?this._dirEdge[1].getToNode():null}}class Oa{constructor(){Oa.constructor_.apply(this,arguments)}static constructor_(){this._outEdges=new $,this._sorted=!1}getNextEdge(r){const a=this.getIndex(r);return this._outEdges.get(this.getIndex(a+1))}getCoordinate(){const r=this.iterator();return r.hasNext()?r.next().getCoordinate():null}iterator(){return this.sortEdges(),this._outEdges.iterator()}sortEdges(){this._sorted||(lr.sort(this._outEdges),this._sorted=!0)}remove(r){this._outEdges.remove(r)}getEdges(){return this.sortEdges(),this._outEdges}getNextCWEdge(r){const a=this.getIndex(r);return this._outEdges.get(this.getIndex(a-1))}getIndex(){if(arguments[0]instanceof co){const r=arguments[0];this.sortEdges();for(let a=0;a<this._outEdges.size();a++)if(this._outEdges.get(a).getEdge()===r)return a;return-1}if(arguments[0]instanceof qs){const r=arguments[0];this.sortEdges();for(let a=0;a<this._outEdges.size();a++)if(this._outEdges.get(a)===r)return a;return-1}if(Number.isInteger(arguments[0])){let r=arguments[0]%this._outEdges.size();return r<0&&(r+=this._outEdges.size()),r}}add(r){this._outEdges.add(r),this._sorted=!1}getDegree(){return this._outEdges.size()}}class Nn extends sl{constructor(){super(),Nn.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,this._deStar=null,arguments.length===1){const r=arguments[0];Nn.constructor_.call(this,r,new Oa)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._pt=r,this._deStar=a}}static getEdgesBetween(r,a){const p=qs.toEdges(r.getOutEdges().getEdges()),_=new Be(p),C=qs.toEdges(a.getOutEdges().getEdges());return _.retainAll(C),_}isRemoved(){return this._pt===null}addOutEdge(r){this._deStar.add(r)}getCoordinate(){return this._pt}getOutEdges(){return this._deStar}remove(){if(arguments.length===0)this._pt=null;else if(arguments.length===1){const r=arguments[0];this._deStar.remove(r)}}getIndex(r){return this._deStar.getIndex(r)}getDegree(){return this._deStar.getDegree()}}class ca extends co{constructor(){super(),ca.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const r=arguments[0];this._line=r}getLine(){return this._line}}class $u{constructor(){$u.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new R}find(r){return this._nodeMap.get(r)}iterator(){return this._nodeMap.values().iterator()}remove(r){return this._nodeMap.remove(r)}values(){return this._nodeMap.values()}add(r){return this._nodeMap.put(r.getCoordinate(),r),r}}class rp{constructor(){rp.constructor_.apply(this,arguments)}static constructor_(){this._edges=new Be,this._dirEdges=new Be,this._nodeMap=new $u}findNodesOfDegree(r){const a=new $;for(let p=this.nodeIterator();p.hasNext();){const _=p.next();_.getDegree()===r&&a.add(_)}return a}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}getEdges(){return this._edges}nodeIterator(){return this._nodeMap.iterator()}contains(){if(arguments[0]instanceof co){const r=arguments[0];return this._edges.contains(r)}if(arguments[0]instanceof qs){const r=arguments[0];return this._dirEdges.contains(r)}}add(){if(arguments[0]instanceof Nn){const r=arguments[0];this._nodeMap.add(r)}else if(arguments[0]instanceof co){const r=arguments[0];this._edges.add(r),this.add(r.getDirEdge(0)),this.add(r.getDirEdge(1))}else if(arguments[0]instanceof qs){const r=arguments[0];this._dirEdges.add(r)}}getNodes(){return this._nodeMap.values()}remove(){if(arguments[0]instanceof co){const r=arguments[0];this.remove(r.getDirEdge(0)),this.remove(r.getDirEdge(1)),this._edges.remove(r),r.remove()}else if(arguments[0]instanceof qs){const r=arguments[0],a=r.getSym();a!==null&&a.setSym(null),r.getFromNode().remove(r),r.remove(),this._dirEdges.remove(r)}else if(arguments[0]instanceof Nn){const r=arguments[0];for(let a=r.getOutEdges().getEdges().iterator();a.hasNext();){const p=a.next(),_=p.getSym();_!==null&&this.remove(_),this._dirEdges.remove(p);const C=p.getEdge();C!==null&&this._edges.remove(C)}this._nodeMap.remove(r.getCoordinate()),r.remove()}}findNode(r){return this._nodeMap.find(r)}}class Ku extends rp{constructor(){super()}getNode(r){let a=this.findNode(r);return a===null&&(a=new Nn(r),this.add(a)),a}addEdge(r){if(r.isEmpty())return null;const a=De.removeRepeatedPoints(r.getCoordinates());if(a.length<=1)return null;const p=a[0],_=a[a.length-1],C=this.getNode(p),k=this.getNode(_),X=new hc(C,k,a[1],!0),J=new hc(k,C,a[a.length-2],!1),Ct=new ca(r);Ct.setDirectedEdges(X,J),this.add(Ct)}}class pc{constructor(){pc.constructor_.apply(this,arguments)}static constructor_(){this._graph=new Ku,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null}buildEdgeStringsForUnprocessedNodes(){for(let r=this._graph.getNodes().iterator();r.hasNext();){const a=r.next();a.isMarked()||(L.isTrue(a.getDegree()===2),this.buildEdgeStringsStartingAt(a),a.setMarked(!0))}}buildEdgeStringsForNonDegree2Nodes(){for(let r=this._graph.getNodes().iterator();r.hasNext();){const a=r.next();a.getDegree()!==2&&(this.buildEdgeStringsStartingAt(a),a.setMarked(!0))}}buildEdgeStringsStartingAt(r){for(let a=r.getOutEdges().iterator();a.hasNext();){const p=a.next();p.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(p))}}merge(){if(this._mergedLineStrings!==null)return null;sl.setMarked(this._graph.nodeIterator(),!1),sl.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new $,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new $;for(let r=this._edgeStrings.iterator();r.hasNext();){const a=r.next();this._mergedLineStrings.add(a.toLineString())}}addLineString(r){this._factory===null&&(this._factory=r.getFactory()),this._graph.addEdge(r)}buildEdgeStringStartingWith(r){const a=new vf(this._factory);let p=r;do a.add(p),p.getEdge().setMarked(!0),p=p.getNext();while(p!==null&&p!==r);return a}add(){if(arguments[0]instanceof oe){const r=arguments[0];for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);p instanceof Ee&&this.addLineString(p)}}else if(pt(arguments[0],T)){const r=arguments[0];this._mergedLineStrings=null;for(let a=r.iterator();a.hasNext();){const p=a.next();this.add(p)}}}buildEdgeStringsForIsolatedLoops(){this.buildEdgeStringsForUnprocessedNodes()}buildEdgeStringsForObviousStartNodes(){this.buildEdgeStringsForNonDegree2Nodes()}getMergedLineStrings(){return this.merge(),this._mergedLineStrings}}class _f{constructor(){_f.constructor_.apply(this,arguments)}static constructor_(){this._parentGraph=null,this._edges=new Be,this._dirEdges=new $,this._nodeMap=new $u;const r=arguments[0];this._parentGraph=r}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}getParent(){return this._parentGraph}nodeIterator(){return this._nodeMap.iterator()}contains(r){return this._edges.contains(r)}add(r){if(this._edges.contains(r))return null;this._edges.add(r),this._dirEdges.add(r.getDirEdge(0)),this._dirEdges.add(r.getDirEdge(1)),this._nodeMap.add(r.getDirEdge(0).getFromNode()),this._nodeMap.add(r.getDirEdge(1).getFromNode())}}class $c{constructor(){$c.constructor_.apply(this,arguments)}static constructor_(){this._graph=null;const r=arguments[0];this._graph=r}findSubgraph(r){const a=new _f(this._graph);return this.addReachable(r,a),a}addEdges(r,a,p){r.setVisited(!0);for(let _=r.getOutEdges().iterator();_.hasNext();){const C=_.next();p.add(C.getEdge());const k=C.getToNode();k.isVisited()||a.push(k)}}addReachable(r,a){const p=new Bn;for(p.add(r);!p.empty();){const _=p.pop();this.addEdges(_,p,a)}}getConnectedSubgraphs(){const r=new $;sl.setVisited(this._graph.nodeIterator(),!1);for(let a=this._graph.edgeIterator();a.hasNext();){const p=a.next().getDirEdge(0).getFromNode();p.isVisited()||r.add(this.findSubgraph(p))}return r}}class Cn{constructor(){Cn.constructor_.apply(this,arguments)}static constructor_(){this._graph=new Ku,this._factory=new Se,this._lineCount=0,this._isRun=!1,this._sequencedGeometry=null,this._isSequenceable=!1}static findUnvisitedBestOrientedDE(r){let a=null,p=null;for(let _=r.getOutEdges().iterator();_.hasNext();){const C=_.next();C.getEdge().isVisited()||(p=C,C.getEdgeDirection()&&(a=C))}return a!==null?a:p}static findLowestDegreeNode(r){let a=Mt.MAX_VALUE,p=null;for(let _=r.nodeIterator();_.hasNext();){const C=_.next();(p===null||C.getDegree()<a)&&(a=C.getDegree(),p=C)}return p}static isSequenced(r){if(!(r instanceof ar))return!0;const a=r,p=new Xn;let _=null;const C=new $;for(let k=0;k<a.getNumGeometries();k++){const X=a.getGeometryN(k),J=X.getCoordinateN(0),Ct=X.getCoordinateN(X.getNumPoints()-1);if(p.contains(J)||p.contains(Ct))return!1;_!==null&&(J.equals(_)||(p.addAll(C),C.clear())),C.add(J),C.add(Ct),_=Ct}return!0}static reverse(r){const a=r.getCoordinates(),p=new Array(a.length).fill(null),_=a.length;for(let C=0;C<_;C++)p[_-1-C]=new O(a[C]);return r.getFactory().createLineString(p)}static sequence(r){const a=new Cn;return a.add(r),a.getSequencedLineStrings()}computeSequence(){if(this._isRun)return null;this._isRun=!0;const r=this.findSequences();if(r===null)return null;this._sequencedGeometry=this.buildSequencedGeometry(r),this._isSequenceable=!0;const a=this._sequencedGeometry.getNumGeometries();L.isTrue(this._lineCount===a,"Lines were missing from result"),L.isTrue(this._sequencedGeometry instanceof Ee||this._sequencedGeometry instanceof ar,"Result is not lineal")}findSequences(){const r=new $;for(let a=new $c(this._graph).getConnectedSubgraphs().iterator();a.hasNext();){const p=a.next();if(!this.hasSequence(p))return null;{const _=this.findSequence(p);r.add(_)}}return r}addReverseSubpath(r,a,p){const _=r.getToNode();let C=null;for(;;){a.add(r.getSym()),r.getEdge().setVisited(!0),C=r.getFromNode();const k=Cn.findUnvisitedBestOrientedDE(C);if(k===null)break;r=k.getSym()}p&&L.isTrue(C===_,"path not contiguous")}findSequence(r){sl.setVisited(r.edgeIterator(),!1);const a=Cn.findLowestDegreeNode(r).getOutEdges().iterator().next().getSym(),p=new io,_=p.listIterator();for(this.addReverseSubpath(a,_,!1);_.hasPrevious();){const C=_.previous(),k=Cn.findUnvisitedBestOrientedDE(C.getFromNode());k!==null&&this.addReverseSubpath(k.getSym(),_,!0)}return this.orient(p)}reverse(r){const a=new io;for(let p=r.iterator();p.hasNext();){const _=p.next();a.addFirst(_.getSym())}return a}add(){if(pt(arguments[0],T))for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.add(a)}else arguments[0]instanceof oe&&arguments[0].apply(new class{get interfaces_(){return[Ue]}filter(r){r instanceof Ee&&this.addLine(r)}})}addLine(r){this._factory===null&&(this._factory=r.getFactory()),this._graph.addEdge(r),this._lineCount++}hasSequence(r){let a=0;for(let p=r.nodeIterator();p.hasNext();)p.next().getDegree()%2==1&&a++;return a<=2}orient(r){const a=r.get(0),p=r.get(r.size()-1),_=a.getFromNode(),C=p.getToNode();let k=!1;if(_.getDegree()===1||C.getDegree()===1){let X=!1;p.getToNode().getDegree()===1&&p.getEdgeDirection()===!1&&(X=!0,k=!0),a.getFromNode().getDegree()===1&&a.getEdgeDirection()===!0&&(X=!0,k=!1),X||a.getFromNode().getDegree()===1&&(k=!0)}return k?this.reverse(r):r}buildSequencedGeometry(r){const a=new $;for(let p=r.iterator();p.hasNext();)for(let _=p.next().iterator();_.hasNext();){const C=_.next(),k=C.getEdge().getLine();let X=k;C.getEdgeDirection()||k.isClosed()||(X=Cn.reverse(k)),a.add(X)}return a.size()===0?this._factory.createMultiLineString(new Array(0).fill(null)):this._factory.buildGeometry(a)}getSequencedLineStrings(){return this.computeSequence(),this._sequencedGeometry}isSequenceable(){return this.computeSequence(),this._isSequenceable}}var ip=Object.freeze({__proto__:null,LineMerger:pc,LineSequencer:Cn}),zd=Object.freeze({__proto__:null,GeometrySnapper:rs,LineStringSnapper:$n}),Vd=Object.freeze({__proto__:null,OverlayOp:Ir,snap:zd});class Na{constructor(){Na.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=new Se,this._geomGraph=null,this._disconnectedRingcoord=null;const r=arguments[0];this._geomGraph=r}static findDifferentPoint(r,a){for(let p=0;p<r.length;p++)if(!r[p].equals(a))return r[p];return null}visitInteriorRing(r,a){if(r.isEmpty())return null;const p=r.getCoordinates(),_=p[0],C=Na.findDifferentPoint(p,_),k=a.findEdgeInSameDirection(_,C),X=a.findEdgeEnd(k);let J=null;X.getLabel().getLocation(0,Ie.RIGHT)===St.INTERIOR?J=X:X.getSym().getLabel().getLocation(0,Ie.RIGHT)===St.INTERIOR&&(J=X.getSym()),L.isTrue(J!==null,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(J)}visitShellInteriors(r,a){if(r instanceof Ut){const p=r;this.visitInteriorRing(p.getExteriorRing(),a)}if(r instanceof ae){const p=r;for(let _=0;_<p.getNumGeometries();_++){const C=p.getGeometryN(_);this.visitInteriorRing(C.getExteriorRing(),a)}}}getCoordinate(){return this._disconnectedRingcoord}setInteriorEdgesInResult(r){for(let a=r.getEdgeEnds().iterator();a.hasNext();){const p=a.next();p.getLabel().getLocation(0,Ie.RIGHT)===St.INTERIOR&&p.setInResult(!0)}}visitLinkedDirectedEdges(r){const a=r;let p=r;do L.isTrue(p!==null,"found null Directed Edge"),p.setVisited(!0),p=p.getNext();while(p!==a)}buildEdgeRings(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();if(_.isInResult()&&_.getEdgeRing()===null){const C=new we(_,this._geometryFactory);C.linkDirectedEdgesForMinimalEdgeRings();const k=C.buildMinimalRings();a.addAll(k)}}return a}hasUnvisitedShellEdge(r){for(let a=0;a<r.size();a++){const p=r.get(a);if(p.isHole())continue;const _=p.getEdges();let C=_.get(0);if(C.getLabel().getLocation(0,Ie.RIGHT)===St.INTERIOR){for(let k=0;k<_.size();k++)if(C=_.get(k),!C.isVisited())return this._disconnectedRingcoord=C.getCoordinate(),!0}}return!1}isInteriorsConnected(){const r=new $;this._geomGraph.computeSplitEdges(r);const a=new Nt(new ie);a.addEdges(r),this.setInteriorEdgesInResult(a),a.linkResultDirectedEdges();const p=this.buildEdgeRings(a.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),a),!this.hasUnvisitedShellEdge(p)}}class Kc{computeEdgeEnds(){if(arguments.length===1){const r=arguments[0],a=new $;for(let p=r;p.hasNext();){const _=p.next();this.computeEdgeEnds(_,a)}return a}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=r.getEdgeIntersectionList();p.addEndpoints();const _=p.iterator();let C=null,k=null;if(!_.hasNext())return null;let X=_.next();do C=k,k=X,X=null,_.hasNext()&&(X=_.next()),k!==null&&(this.createEdgeEndForPrev(r,a,k,C),this.createEdgeEndForNext(r,a,k,X));while(k!==null)}}createEdgeEndForNext(r,a,p,_){const C=p.segmentIndex+1;if(C>=r.getNumPoints()&&_===null)return null;let k=r.getCoordinate(C);_!==null&&_.segmentIndex===p.segmentIndex&&(k=_.coord);const X=new mt(r,p.coord,k,new mi(r.getLabel()));a.add(X)}createEdgeEndForPrev(r,a,p,_){let C=p.segmentIndex;if(p.dist===0){if(C===0)return null;C--}let k=r.getCoordinate(C);_!==null&&_.segmentIndex>=C&&(k=_.coord);const X=new mi(r.getLabel());X.flip();const J=new mt(r,p.coord,k,X);a.add(J)}}class Jc extends mt{constructor(){super(),Jc.constructor_.apply(this,arguments)}static constructor_(){if(this._edgeEnds=new $,arguments.length===1){const r=arguments[0];Jc.constructor_.call(this,null,r)}else if(arguments.length===2){const r=arguments[1];mt.constructor_.call(this,r.getEdge(),r.getCoordinate(),r.getDirectedCoordinate(),new mi(r.getLabel())),this.insert(r)}}insert(r){this._edgeEnds.add(r)}print(r){r.println("EdgeEndBundle--> Label: "+this._label);for(let a=this.iterator();a.hasNext();)a.next().print(r),r.println()}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(r,a){let p=0,_=!1;for(let k=this.iterator();k.hasNext();){const X=k.next().getLabel().getLocation(r);X===St.BOUNDARY&&p++,X===St.INTERIOR&&(_=!0)}let C=St.NONE;_&&(C=St.INTERIOR),p>0&&(C=Go.determineBoundary(a,p)),this._label.setLocation(r,C)}computeLabelSide(r,a){for(let p=this.iterator();p.hasNext();){const _=p.next();if(_.getLabel().isArea()){const C=_.getLabel().getLocation(r,a);if(C===St.INTERIOR)return this._label.setLocation(r,a,St.INTERIOR),null;C===St.EXTERIOR&&this._label.setLocation(r,a,St.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(r){this.computeLabelSide(r,Ie.LEFT),this.computeLabelSide(r,Ie.RIGHT)}updateIM(r){zn.updateIM(this._label,r)}computeLabel(r){let a=!1;for(let p=this.iterator();p.hasNext();)p.next().getLabel().isArea()&&(a=!0);this._label=a?new mi(St.NONE,St.NONE,St.NONE):new mi(St.NONE);for(let p=0;p<2;p++)this.computeLabelOn(p,r),a&&this.computeLabelSides(p)}}class Ud extends er{constructor(){super()}updateIM(r){for(let a=this.iterator();a.hasNext();)a.next().updateIM(r)}insert(r){let a=this._edgeMap.get(r);a===null?(a=new Jc(r),this.insertEdgeEnd(r,a)):a.insert(r)}}class xf extends Do{constructor(){super(),xf.constructor_.apply(this,arguments)}static constructor_(){const r=arguments[0],a=arguments[1];Do.constructor_.call(this,r,a)}computeIM(r){r.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}updateIMFromEdges(r){this._edges.updateIM(r)}}class fc extends tt{constructor(){super()}createNode(r){return new xf(r,new Ud)}}class np{constructor(){np.constructor_.apply(this,arguments)}static constructor_(){this._nodes=new ia(new fc)}insertEdgeEnds(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this._nodes.add(p)}}getNodeIterator(){return this._nodes.iterator()}copyNodesAndLabels(r,a){for(let p=r.getNodeIterator();p.hasNext();){const _=p.next();this._nodes.addNode(_.getCoordinate()).setLabel(a,_.getLabel().getLocation(a))}}build(r){this.computeIntersectionNodes(r,0),this.copyNodesAndLabels(r,0);const a=new Kc().computeEdgeEnds(r.getEdgeIterator());this.insertEdgeEnds(a)}computeIntersectionNodes(r,a){for(let p=r.getEdgeIterator();p.hasNext();){const _=p.next(),C=_.getLabel().getLocation(a);for(let k=_.getEdgeIntersectionList().iterator();k.hasNext();){const X=k.next(),J=this._nodes.addNode(X.coord);C===St.BOUNDARY?J.setLabelBoundary(a):J.getLabel().isNull(a)&&J.setLabel(a,St.INTERIOR)}}}}class Ju{constructor(){Ju.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._geomGraph=null,this._nodeGraph=new np,this._invalidPoint=null;const r=arguments[0];this._geomGraph=r}isNodeEdgeAreaLabelsConsistent(){for(let r=this._nodeGraph.getNodeIterator();r.hasNext();){const a=r.next();if(!a.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=a.getCoordinate().copy(),!1}return!0}hasDuplicateRings(){for(let r=this._nodeGraph.getNodeIterator();r.hasNext();)for(let a=r.next().getEdges().iterator();a.hasNext();){const p=a.next();if(p.getEdgeEnds().size()>1)return this._invalidPoint=p.getEdge().getCoordinate(0),!0}return!1}isNodeConsistentArea(){const r=this._geomGraph.computeSelfNodes(this._li,!0,!0);return r.hasProperIntersection()?(this._invalidPoint=r.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}getInvalidPoint(){return this._invalidPoint}}class op{constructor(){op.constructor_.apply(this,arguments)}static constructor_(){this._graph=null,this._rings=new $,this._totalEnv=new nt,this._index=null,this._nestedPt=null;const r=arguments[0];this._graph=r}add(r){this._rings.add(r),this._totalEnv.expandToInclude(r.getEnvelopeInternal())}getNestedPoint(){return this._nestedPt}buildIndex(){this._index=new ri;for(let r=0;r<this._rings.size();r++){const a=this._rings.get(r),p=a.getEnvelopeInternal();this._index.insert(p,a)}}isNonNested(){this.buildIndex();for(let r=0;r<this._rings.size();r++){const a=this._rings.get(r),p=a.getCoordinates(),_=this._index.query(a.getEnvelopeInternal());for(let C=0;C<_.size();C++){const k=_.get(C),X=k.getCoordinates();if(a===k||!a.getEnvelopeInternal().intersects(k.getEnvelopeInternal()))continue;const J=hs.findPtNotNode(p,k,this._graph);if(J!==null&&Gi.isInRing(J,X))return this._nestedPt=J,!1}}return!0}}class Pi{constructor(){Pi.constructor_.apply(this,arguments)}static constructor_(){if(this._errorType=null,this._pt=null,arguments.length===1){const r=arguments[0];Pi.constructor_.call(this,r,null)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._errorType=r,a!==null&&(this._pt=a.copy())}}getCoordinate(){return this._pt}getMessage(){return Pi.errMsg[this._errorType]}toString(){let r="";return this._pt!==null&&(r=" at or near point "+this._pt),this.getMessage()+r}getErrorType(){return this._errorType}}Pi.ERROR=0,Pi.REPEATED_POINT=1,Pi.HOLE_OUTSIDE_SHELL=2,Pi.NESTED_HOLES=3,Pi.DISCONNECTED_INTERIOR=4,Pi.SELF_INTERSECTION=5,Pi.RING_SELF_INTERSECTION=6,Pi.NESTED_SHELLS=7,Pi.DUPLICATE_RINGS=8,Pi.TOO_FEW_POINTS=9,Pi.INVALID_COORDINATE=10,Pi.RING_NOT_CLOSED=11,Pi.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];class hs{constructor(){hs.constructor_.apply(this,arguments)}static constructor_(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;const r=arguments[0];this._parentGeometry=r}static findPtNotNode(r,a,p){const _=p.findEdge(a).getEdgeIntersectionList();for(let C=0;C<r.length;C++){const k=r[C];if(!_.isIntersection(k))return k}return null}static isValid(){if(arguments[0]instanceof oe)return new hs(arguments[0]).isValid();if(arguments[0]instanceof O){const r=arguments[0];return!m.isNaN(r.x)&&!m.isInfinite(r.x)&&!m.isNaN(r.y)&&!m.isInfinite(r.y)}}checkInvalidCoordinates(){if(arguments[0]instanceof Array){const r=arguments[0];for(let a=0;a<r.length;a++)if(!hs.isValid(r[a]))return this._validErr=new Pi(Pi.INVALID_COORDINATE,r[a]),null}else if(arguments[0]instanceof Ut){const r=arguments[0];if(this.checkInvalidCoordinates(r.getExteriorRing().getCoordinates()),this._validErr!==null)return null;for(let a=0;a<r.getNumInteriorRing();a++)if(this.checkInvalidCoordinates(r.getInteriorRingN(a).getCoordinates()),this._validErr!==null)return null}}checkHolesNotNested(r,a){if(r.getNumInteriorRing()<=0)return null;const p=new op(a);for(let _=0;_<r.getNumInteriorRing();_++){const C=r.getInteriorRingN(_);C.isEmpty()||p.add(C)}p.isNonNested()||(this._validErr=new Pi(Pi.NESTED_HOLES,p.getNestedPoint()))}checkConsistentArea(r){const a=new Ju(r);if(!a.isNodeConsistentArea())return this._validErr=new Pi(Pi.SELF_INTERSECTION,a.getInvalidPoint()),null;a.hasDuplicateRings()&&(this._validErr=new Pi(Pi.DUPLICATE_RINGS,a.getInvalidPoint()))}isValid(){return this.checkValid(this._parentGeometry),this._validErr===null}checkShellInsideHole(r,a,p){const _=r.getCoordinates(),C=a.getCoordinates(),k=hs.findPtNotNode(_,a,p);if(k!==null&&!Gi.isInRing(k,C))return k;const X=hs.findPtNotNode(C,r,p);return X!==null?Gi.isInRing(X,_)?X:null:(L.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}checkNoSelfIntersectingRings(r){for(let a=r.getEdgeIterator();a.hasNext();){const p=a.next();if(this.checkNoSelfIntersectingRing(p.getEdgeIntersectionList()),this._validErr!==null)return null}}checkHolesInShell(r,a){if(r.getNumInteriorRing()<=0)return null;const p=r.getExteriorRing(),_=p.isEmpty(),C=new _o(p);for(let k=0;k<r.getNumInteriorRing();k++){const X=r.getInteriorRingN(k);let J=null;if(!X.isEmpty()){if(J=hs.findPtNotNode(X.getCoordinates(),p,a),J===null)return null;if(_||St.EXTERIOR===C.locate(J))return this._validErr=new Pi(Pi.HOLE_OUTSIDE_SHELL,J),null}}}checkShellNotNested(r,a,p){const _=r.getCoordinates(),C=a.getExteriorRing();if(C.isEmpty())return null;const k=C.getCoordinates(),X=hs.findPtNotNode(_,C,p);if(X===null||!Gi.isInRing(X,k))return null;if(a.getNumInteriorRing()<=0)return this._validErr=new Pi(Pi.NESTED_SHELLS,X),null;let J=null;for(let Ct=0;Ct<a.getNumInteriorRing();Ct++){const te=a.getInteriorRingN(Ct);if(J=this.checkShellInsideHole(r,te,p),J===null)return null}this._validErr=new Pi(Pi.NESTED_SHELLS,J)}checkClosedRings(r){if(this.checkClosedRing(r.getExteriorRing()),this._validErr!==null)return null;for(let a=0;a<r.getNumInteriorRing();a++)if(this.checkClosedRing(r.getInteriorRingN(a)),this._validErr!==null)return null}checkConnectedInteriors(r){const a=new Na(r);a.isInteriorsConnected()||(this._validErr=new Pi(Pi.DISCONNECTED_INTERIOR,a.getCoordinate()))}checkNoSelfIntersectingRing(r){const a=new Xn;let p=!0;for(let _=r.iterator();_.hasNext();){const C=_.next();if(p)p=!1;else{if(a.contains(C.coord))return this._validErr=new Pi(Pi.RING_SELF_INTERSECTION,C.coord),null;a.add(C.coord)}}}checkTooFewPoints(r){if(r.hasTooFewPoints())return this._validErr=new Pi(Pi.TOO_FEW_POINTS,r.getInvalidPoint()),null}getValidationError(){return this.checkValid(this._parentGeometry),this._validErr}checkValid(){if(arguments[0]instanceof zt){const r=arguments[0];this.checkInvalidCoordinates(r.getCoordinates())}else if(arguments[0]instanceof ve){const r=arguments[0];this.checkInvalidCoordinates(r.getCoordinates())}else if(arguments[0]instanceof Sr){const r=arguments[0];if(this.checkInvalidCoordinates(r.getCoordinates()),this._validErr!==null||(this.checkClosedRing(r),this._validErr!==null))return null;const a=new Go(0,r);if(this.checkTooFewPoints(a),this._validErr!==null)return null;const p=new tn;a.computeSelfNodes(p,!0,!0),this.checkNoSelfIntersectingRings(a)}else if(arguments[0]instanceof Ee){const r=arguments[0];if(this.checkInvalidCoordinates(r.getCoordinates()),this._validErr!==null)return null;const a=new Go(0,r);this.checkTooFewPoints(a)}else if(arguments[0]instanceof Ut){const r=arguments[0];if(this.checkInvalidCoordinates(r),this._validErr!==null||(this.checkClosedRings(r),this._validErr!==null))return null;const a=new Go(0,r);if(this.checkTooFewPoints(a),this._validErr!==null||(this.checkConsistentArea(a),this._validErr!==null)||!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(a),this._validErr!==null)||(this.checkHolesInShell(r,a),this._validErr!==null)||(this.checkHolesNotNested(r,a),this._validErr!==null))return null;this.checkConnectedInteriors(a)}else if(arguments[0]instanceof ae){const r=arguments[0];for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p);if(this.checkInvalidCoordinates(_),this._validErr!==null||(this.checkClosedRings(_),this._validErr!==null))return null}const a=new Go(0,r);if(this.checkTooFewPoints(a),this._validErr!==null||(this.checkConsistentArea(a),this._validErr!==null)||!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(a),this._validErr!==null))return null;for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p);if(this.checkHolesInShell(_,a),this._validErr!==null)return null}for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p);if(this.checkHolesNotNested(_,a),this._validErr!==null)return null}if(this.checkShellsNotNested(r,a),this._validErr!==null)return null;this.checkConnectedInteriors(a)}else if(arguments[0]instanceof Ot){const r=arguments[0];for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);if(this.checkValid(p),this._validErr!==null)return null}}else if(arguments[0]instanceof oe){const r=arguments[0];if(this._validErr=null,r.isEmpty())return null;if(r instanceof zt)this.checkValid(r);else if(r instanceof ve)this.checkValid(r);else if(r instanceof Sr)this.checkValid(r);else if(r instanceof Ee)this.checkValid(r);else if(r instanceof Ut)this.checkValid(r);else if(r instanceof ae)this.checkValid(r);else{if(!(r instanceof Ot))throw new Fe(r.getGeometryType());this.checkValid(r)}}}setSelfTouchingRingFormingHoleValid(r){this._isSelfTouchingRingFormingHoleValid=r}checkClosedRing(r){if(r.isEmpty())return null;if(!r.isClosed()){let a=null;r.getNumPoints()>=1&&(a=r.getCoordinateN(0)),this._validErr=new Pi(Pi.RING_NOT_CLOSED,a)}}checkShellsNotNested(r,a){for(let p=0;p<r.getNumGeometries();p++){const _=r.getGeometryN(p).getExteriorRing();for(let C=0;C<r.getNumGeometries();C++){if(p===C)continue;const k=r.getGeometryN(C);if(this.checkShellNotNested(_,k,a),this._validErr!==null)return null}}}}class ua{constructor(){ua.constructor_.apply(this,arguments)}static constructor_(){this._factory=null,this._deList=new $,this._lowestEdge=null,this._ring=null,this._locator=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;const r=arguments[0];this._factory=r}static findEdgeRingContaining(r,a){const p=r.getRing(),_=p.getEnvelopeInternal();let C=p.getCoordinateN(0),k=null,X=null;for(let J=a.iterator();J.hasNext();){const Ct=J.next(),te=Ct.getRing().getEnvelopeInternal();te.equals(_)||te.contains(_)&&(C=De.ptNotInList(p.getCoordinates(),Ct.getCoordinates()),Ct.isInRing(C)&&(k===null||X.contains(te))&&(k=Ct,X=k.getRing().getEnvelopeInternal()))}return k}static addEdge(r,a,p){if(a)for(let _=0;_<r.length;_++)p.add(r[_],!1);else for(let _=r.length-1;_>=0;_--)p.add(r[_],!1)}static findDirEdgesInRing(r){let a=r;const p=new $;do p.add(a),a=a.getNext(),L.isTrue(a!==null,"found null DE in ring"),L.isTrue(a===r||!a.isInRing(),"found DE already in ring");while(a!==r);return p}isIncluded(){return this._isIncluded}getCoordinates(){if(this._ringPts===null){const r=new W;for(let a=this._deList.iterator();a.hasNext();){const p=a.next(),_=p.getEdge();ua.addEdge(_.getLine().getCoordinates(),p.getEdgeDirection(),r)}this._ringPts=r.toCoordinateArray()}return this._ringPts}build(r){let a=r;do this.add(a),a.setRing(this),a=a.getNext(),L.isTrue(a!==null,"found null DE in ring"),L.isTrue(a===r||!a.isInRing(),"found DE already in ring");while(a!==r)}isInRing(r){return St.EXTERIOR!==this.getLocator().locate(r)}addHole(){if(arguments[0]instanceof Sr){const r=arguments[0];this._holes===null&&(this._holes=new $),this._holes.add(r)}else if(arguments[0]instanceof ua){const r=arguments[0];r.setShell(this);const a=r.getRing();this._holes===null&&(this._holes=new $),this._holes.add(a)}}computeHole(){const r=this.getRing();this._isHole=Yt.isCCW(r.getCoordinates())}getLocator(){return this._locator===null&&(this._locator=new _o(this.getRing())),this._locator}getShell(){return this.isHole()?this._shell:this}updateIncluded(){if(this.isHole())return null;for(let r=0;r<this._deList.size();r++){const a=this._deList.get(r).getSym().getRing().getShell();if(a!==null&&a.isIncludedSet())return this.setIncluded(!a.isIncluded()),null}}setShell(r){this._shell=r}setProcessed(r){this._isProcessed=r}isIncludedSet(){return this._isIncludedSet}isValid(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),hs.isValid(this._ring))}isOuterHole(){return!!this._isHole&&!this.hasShell()}getPolygon(){let r=null;if(this._holes!==null){r=new Array(this._holes.size()).fill(null);for(let a=0;a<this._holes.size();a++)r[a]=this._holes.get(a)}return this._factory.createPolygon(this._ring,r)}isHole(){return this._isHole}isProcessed(){return this._isProcessed}setIncluded(r){this._isIncluded=r,this._isIncludedSet=!0}getOuterHole(){if(this.isHole())return null;for(let r=0;r<this._deList.size();r++){const a=this._deList.get(r).getSym().getRing();if(a.isOuterHole())return a}return null}hasShell(){return this._shell!==null}isOuterShell(){return this.getOuterHole()!==null}getLineString(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}toString(){return vi.toLineString(new ye(this.getCoordinates()))}add(r){this._deList.add(r)}getRing(){if(this._ring!==null)return this._ring;this.getCoordinates(),this._ringPts.length<3&&ne.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(r){if(!(r instanceof h))throw r;ne.out.println(this._ringPts)}return this._ring}}ua.EnvelopeComparator=class{compare(dt,r){const a=r;return dt.getRing().getEnvelope().compareTo(a.getRing().getEnvelope())}get interfaces_(){return[U]}};class Ra{constructor(){Ra.constructor_.apply(this,arguments)}static constructor_(){this._shells=null,this._shellIndex=null;const r=arguments[0];this._shells=r,this.buildIndex()}static assignHolesToShells(r,a){new Ra(a).assignHolesToShells(r)}assignHolesToShells(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this.assignHoleToShell(p)}}buildIndex(){this._shellIndex=new ri;for(const r of this._shells)this._shellIndex.insert(r.getRing().getEnvelopeInternal(),r)}queryOverlappingShells(r){return this._shellIndex.query(r)}findShellContaining(r){const a=r.getRing().getEnvelopeInternal(),p=this.queryOverlappingShells(a);return ua.findEdgeRingContaining(r,p)}assignHoleToShell(r){const a=this.findShellContaining(r);a!==null&&a.addHole(r)}}class Qc extends qs{constructor(){super(),Qc.constructor_.apply(this,arguments)}static constructor_(){this._edgeRing=null,this._next=null,this._label=-1;const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];qs.constructor_.call(this,r,a,p,_)}getNext(){return this._next}isInRing(){return this._edgeRing!==null}setRing(r){this._edgeRing=r}setLabel(r){this._label=r}getLabel(){return this._label}setNext(r){this._next=r}getRing(){return this._edgeRing}}class Qu extends co{constructor(){super(),Qu.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const r=arguments[0];this._line=r}getLine(){return this._line}}class ps extends rp{constructor(){super(),ps.constructor_.apply(this,arguments)}static constructor_(){this._factory=null;const r=arguments[0];this._factory=r}static findLabeledEdgeRings(r){const a=new $;let p=1;for(let _=r.iterator();_.hasNext();){const C=_.next();if(C.isMarked()||C.getLabel()>=0)continue;a.add(C);const k=ua.findDirEdgesInRing(C);ps.label(k,p),p++}return a}static getDegreeNonDeleted(r){let a=0;for(let p=r.getOutEdges().getEdges().iterator();p.hasNext();)p.next().isMarked()||a++;return a}static deleteAllEdges(r){for(let a=r.getOutEdges().getEdges().iterator();a.hasNext();){const p=a.next();p.setMarked(!0);const _=p.getSym();_!==null&&_.setMarked(!0)}}static label(r,a){for(let p=r.iterator();p.hasNext();)p.next().setLabel(a)}static computeNextCWEdges(r){let a=null,p=null;for(let _=r.getOutEdges().getEdges().iterator();_.hasNext();){const C=_.next();C.isMarked()||(a===null&&(a=C),p!==null&&p.getSym().setNext(C),p=C)}p!==null&&p.getSym().setNext(a)}static computeNextCCWEdges(r,a){let p=null,_=null;const C=r.getOutEdges().getEdges();for(let k=C.size()-1;k>=0;k--){const X=C.get(k),J=X.getSym();let Ct=null;X.getLabel()===a&&(Ct=X);let te=null;J.getLabel()===a&&(te=J),Ct===null&&te===null||(te!==null&&(_=te),Ct!==null&&(_!==null&&(_.setNext(Ct),_=null),p===null&&(p=Ct)))}_!==null&&(L.isTrue(p!==null),_.setNext(p))}static getDegree(r,a){let p=0;for(let _=r.getOutEdges().getEdges().iterator();_.hasNext();)_.next().getLabel()===a&&p++;return p}static findIntersectionNodes(r,a){let p=r,_=null;do{const C=p.getFromNode();ps.getDegree(C,a)>1&&(_===null&&(_=new $),_.add(C)),p=p.getNext(),L.isTrue(p!==null,"found null DE in ring"),L.isTrue(p===r||!p.isInRing(),"found DE already in ring")}while(p!==r);return _}findEdgeRing(r){const a=new ua(this._factory);return a.build(r),a}computeDepthParity(){if(arguments.length===0)for(;;)return null}computeNextCWEdges(){for(let r=this.nodeIterator();r.hasNext();){const a=r.next();ps.computeNextCWEdges(a)}}addEdge(r){if(r.isEmpty())return null;const a=De.removeRepeatedPoints(r.getCoordinates());if(a.length<2)return null;const p=a[0],_=a[a.length-1],C=this.getNode(p),k=this.getNode(_),X=new Qc(C,k,a[1],!0),J=new Qc(k,C,a[a.length-2],!1),Ct=new Qu(r);Ct.setDirectedEdges(X,J),this.add(Ct)}deleteCutEdges(){this.computeNextCWEdges(),ps.findLabeledEdgeRings(this._dirEdges);const r=new $;for(let a=this._dirEdges.iterator();a.hasNext();){const p=a.next();if(p.isMarked())continue;const _=p.getSym();if(p.getLabel()===_.getLabel()){p.setMarked(!0),_.setMarked(!0);const C=p.getEdge();r.add(C.getLine())}}return r}getEdgeRings(){this.computeNextCWEdges(),ps.label(this._dirEdges,-1);const r=ps.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(r);const a=new $;for(let p=this._dirEdges.iterator();p.hasNext();){const _=p.next();if(_.isMarked()||_.isInRing())continue;const C=this.findEdgeRing(_);a.add(C)}return a}getNode(r){let a=this.findNode(r);return a===null&&(a=new Nn(r),this.add(a)),a}convertMaximalToMinimalEdgeRings(r){for(let a=r.iterator();a.hasNext();){const p=a.next(),_=p.getLabel(),C=ps.findIntersectionNodes(p,_);if(C!==null)for(let k=C.iterator();k.hasNext();){const X=k.next();ps.computeNextCCWEdges(X,_)}}}deleteDangles(){const r=this.findNodesOfDegree(1),a=new Be,p=new Bn;for(let _=r.iterator();_.hasNext();)p.push(_.next());for(;!p.isEmpty();){const _=p.pop();ps.deleteAllEdges(_);for(let C=_.getOutEdges().getEdges().iterator();C.hasNext();){const k=C.next();k.setMarked(!0);const X=k.getSym();X!==null&&X.setMarked(!0);const J=k.getEdge();a.add(J.getLine());const Ct=k.getToNode();ps.getDegreeNonDeleted(Ct)===1&&p.push(Ct)}}return a}}class al{constructor(){al.constructor_.apply(this,arguments)}static constructor_(){if(this._lineStringAdder=new th(this),this._graph=null,this._dangles=new $,this._cutEdges=new $,this._invalidRingLines=new $,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,arguments.length===0)al.constructor_.call(this,!1);else if(arguments.length===1){const r=arguments[0];this._extractOnlyPolygonal=r}}static findOuterShells(r){for(let a=r.iterator();a.hasNext();){const p=a.next(),_=p.getOuterHole();_===null||_.isProcessed()||(p.setIncluded(!0),_.setProcessed(!0))}}static extractPolygons(r,a){const p=new $;for(let _=r.iterator();_.hasNext();){const C=_.next();(a||C.isIncluded())&&p.add(C.getPolygon())}return p}static findDisjointShells(r){al.findOuterShells(r);let a=null;do{a=!1;for(let p=r.iterator();p.hasNext();){const _=p.next();_.isIncludedSet()||(_.updateIncluded(),_.isIncludedSet()||(a=!0))}}while(a)}getGeometry(){return this._geomFactory===null&&(this._geomFactory=new Se),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(Se.toGeometryArray(this._polyList))}getInvalidRingLines(){return this.polygonize(),this._invalidRingLines}findValidRings(r,a,p){for(let _=r.iterator();_.hasNext();){const C=_.next();C.isValid()?a.add(C):p.add(C.getLineString())}}polygonize(){if(this._polyList!==null||(this._polyList=new $,this._graph===null))return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();const r=this._graph.getEdgeRings();let a=new $;this._invalidRingLines=new $,this._isCheckingRingsValid?this.findValidRings(r,a,this._invalidRingLines):a=r,this.findShellsAndHoles(a),Ra.assignHolesToShells(this._holeList,this._shellList),lr.sort(this._shellList,new ua.EnvelopeComparator);let p=!0;this._extractOnlyPolygonal&&(al.findDisjointShells(this._shellList),p=!1),this._polyList=al.extractPolygons(this._shellList,p)}getDangles(){return this.polygonize(),this._dangles}add(){if(pt(arguments[0],T))for(let r=arguments[0].iterator();r.hasNext();){const a=r.next();this.add(a)}else if(arguments[0]instanceof Ee){const r=arguments[0];this._geomFactory=r.getFactory(),this._graph===null&&(this._graph=new ps(this._geomFactory)),this._graph.addEdge(r)}else arguments[0]instanceof oe&&arguments[0].apply(this._lineStringAdder)}setCheckRingsValid(r){this._isCheckingRingsValid=r}findShellsAndHoles(r){this._holeList=new $,this._shellList=new $;for(let a=r.iterator();a.hasNext();){const p=a.next();p.computeHole(),p.isHole()?this._holeList.add(p):this._shellList.add(p)}}getCutEdges(){return this.polygonize(),this._cutEdges}getPolygons(){return this.polygonize(),this._polyList}}class th{constructor(){th.constructor_.apply(this,arguments)}static constructor_(){this.p=null;const r=arguments[0];this.p=r}filter(r){r instanceof Ee&&this.p.add(r)}get interfaces_(){return[Ue]}}al.LineStringAdder=th;var Gm=Object.freeze({__proto__:null,Polygonizer:al});class Al{constructor(){Al.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._ptLocator=new Ea,this._arg=null,this._nodes=new ia(new fc),this._im=null,this._isolatedEdges=new $,this._invalidPoint=null;const r=arguments[0];this._arg=r}insertEdgeEnds(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this._nodes.add(p)}}computeProperIntersectionIM(r,a){const p=this._arg[0].getGeometry().getDimension(),_=this._arg[1].getGeometry().getDimension(),C=r.hasProperIntersection(),k=r.hasProperInteriorIntersection();p===2&&_===2?C&&a.setAtLeast("212101212"):p===2&&_===1?(C&&a.setAtLeast("FFF0FFFF2"),k&&a.setAtLeast("1FFFFF1FF")):p===1&&_===2?(C&&a.setAtLeast("F0FFFFFF2"),k&&a.setAtLeast("1F1FFFFFF")):p===1&&_===1&&k&&a.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(r,a){for(let p=this._arg[r].getEdgeIterator();p.hasNext();){const _=p.next();_.isIsolated()&&(this.labelIsolatedEdge(_,a,this._arg[a].getGeometry()),this._isolatedEdges.add(_))}}labelIsolatedEdge(r,a,p){if(p.getDimension()>0){const _=this._ptLocator.locate(r.getCoordinate(),p);r.getLabel().setAllLocations(a,_)}else r.getLabel().setAllLocations(a,St.EXTERIOR)}computeIM(){const r=new _i;if(r.set(St.EXTERIOR,St.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(r),r;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);const a=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(a,r);const p=new Kc,_=p.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(_);const C=p.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(C),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(r),r}labelNodeEdges(){for(let r=this._nodes.iterator();r.hasNext();)r.next().getEdges().computeLabelling(this._arg)}copyNodesAndLabels(r){for(let a=this._arg[r].getNodeIterator();a.hasNext();){const p=a.next();this._nodes.addNode(p.getCoordinate()).setLabel(r,p.getLabel().getLocation(r))}}labelIntersectionNodes(r){for(let a=this._arg[r].getEdgeIterator();a.hasNext();){const p=a.next(),_=p.getLabel().getLocation(r);for(let C=p.getEdgeIntersectionList().iterator();C.hasNext();){const k=C.next(),X=this._nodes.find(k.coord);X.getLabel().isNull(r)&&(_===St.BOUNDARY?X.setLabelBoundary(r):X.setLabel(r,St.INTERIOR))}}}labelIsolatedNode(r,a){const p=this._ptLocator.locate(r.getCoordinate(),this._arg[a].getGeometry());r.getLabel().setAllLocations(a,p)}computeIntersectionNodes(r){for(let a=this._arg[r].getEdgeIterator();a.hasNext();){const p=a.next(),_=p.getLabel().getLocation(r);for(let C=p.getEdgeIntersectionList().iterator();C.hasNext();){const k=C.next(),X=this._nodes.addNode(k.coord);_===St.BOUNDARY?X.setLabelBoundary(r):X.getLabel().isNull(r)&&X.setLabel(r,St.INTERIOR)}}}labelIsolatedNodes(){for(let r=this._nodes.iterator();r.hasNext();){const a=r.next(),p=a.getLabel();L.isTrue(p.getGeometryCount()>0,"node with empty label found"),a.isIsolated()&&(p.isNull(0)?this.labelIsolatedNode(a,0):this.labelIsolatedNode(a,1))}}updateIM(r){for(let a=this._isolatedEdges.iterator();a.hasNext();)a.next().updateIM(r);for(let a=this._nodes.iterator();a.hasNext();){const p=a.next();p.updateIM(r),p.updateIMFromEdges(r)}}computeDisjointIM(r){const a=this._arg[0].getGeometry();a.isEmpty()||(r.set(St.INTERIOR,St.EXTERIOR,a.getDimension()),r.set(St.BOUNDARY,St.EXTERIOR,a.getBoundaryDimension()));const p=this._arg[1].getGeometry();p.isEmpty()||(r.set(St.EXTERIOR,St.INTERIOR,p.getDimension()),r.set(St.EXTERIOR,St.BOUNDARY,p.getBoundaryDimension()))}}class dc{constructor(){dc.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null;const r=arguments[0];this._rectEnv=r.getEnvelopeInternal()}static contains(r,a){return new dc(r).contains(a)}isContainedInBoundary(r){if(r instanceof Ut)return!1;if(r instanceof zt)return this.isPointContainedInBoundary(r);if(r instanceof Ee)return this.isLineStringContainedInBoundary(r);for(let a=0;a<r.getNumGeometries();a++){const p=r.getGeometryN(a);if(!this.isContainedInBoundary(p))return!1}return!0}isLineSegmentContainedInBoundary(r,a){if(r.equals(a))return this.isPointContainedInBoundary(r);if(r.x===a.x){if(r.x===this._rectEnv.getMinX()||r.x===this._rectEnv.getMaxX())return!0}else if(r.y===a.y&&(r.y===this._rectEnv.getMinY()||r.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(r){const a=r.getCoordinateSequence(),p=new O,_=new O;for(let C=0;C<a.size()-1;C++)if(a.getCoordinate(C,p),a.getCoordinate(C+1,_),!this.isLineSegmentContainedInBoundary(p,_))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof zt){const r=arguments[0];return this.isPointContainedInBoundary(r.getCoordinate())}if(arguments[0]instanceof O){const r=arguments[0];return r.x===this._rectEnv.getMinX()||r.x===this._rectEnv.getMaxX()||r.y===this._rectEnv.getMinY()||r.y===this._rectEnv.getMaxY()}}contains(r){return!!this._rectEnv.contains(r.getEnvelopeInternal())&&!this.isContainedInBoundary(r)}}class eh{constructor(){eh.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;const r=arguments[0];this._rectEnv=r,this._diagUp0=new O(r.getMinX(),r.getMinY()),this._diagUp1=new O(r.getMaxX(),r.getMaxY()),this._diagDown0=new O(r.getMinX(),r.getMaxY()),this._diagDown1=new O(r.getMaxX(),r.getMinY())}intersects(r,a){const p=new nt(r,a);if(!this._rectEnv.intersects(p))return!1;if(this._rectEnv.intersects(r)||this._rectEnv.intersects(a))return!0;if(r.compareTo(a)>0){const C=r;r=a,a=C}let _=!1;return a.y>r.y&&(_=!0),_?this._li.computeIntersection(r,a,this._diagDown0,this._diagDown1):this._li.computeIntersection(r,a,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}}class tu{constructor(){tu.constructor_.apply(this,arguments)}static constructor_(){this._rectangle=null,this._rectEnv=null;const r=arguments[0];this._rectangle=r,this._rectEnv=r.getEnvelopeInternal()}static intersects(r,a){return new tu(r).intersects(a)}intersects(r){if(!this._rectEnv.intersects(r.getEnvelopeInternal()))return!1;const a=new rh(this._rectEnv);if(a.applyTo(r),a.intersects())return!0;const p=new ih(this._rectangle);if(p.applyTo(r),p.containsPoint())return!0;const _=new nh(this._rectangle);return _.applyTo(r),!!_.intersects()}}class rh extends Ur{constructor(){super(),rh.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._intersects=!1;const r=arguments[0];this._rectEnv=r}intersects(){return this._intersects}visit(r){const a=r.getEnvelopeInternal();return this._rectEnv.intersects(a)?this._rectEnv.contains(a)||a.getMinX()>=this._rectEnv.getMinX()&&a.getMaxX()<=this._rectEnv.getMaxX()||a.getMinY()>=this._rectEnv.getMinY()&&a.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}isDone(){return this._intersects===!0}}class ih extends Ur{constructor(){super(),ih.constructor_.apply(this,arguments)}static constructor_(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;const r=arguments[0];this._rectSeq=r.getExteriorRing().getCoordinateSequence(),this._rectEnv=r.getEnvelopeInternal()}visit(r){if(!(r instanceof Ut))return null;const a=r.getEnvelopeInternal();if(!this._rectEnv.intersects(a))return null;const p=new O;for(let _=0;_<4;_++)if(this._rectSeq.getCoordinate(_,p),a.contains(p)&&Yn.containsPointInPolygon(p,r))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}isDone(){return this._containsPoint===!0}}class nh extends Ur{constructor(){super(),nh.constructor_.apply(this,arguments)}static constructor_(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new O,this._p1=new O;const r=arguments[0];this._rectEnv=r.getEnvelopeInternal(),this._rectIntersector=new eh(this._rectEnv)}intersects(){return this._hasIntersection}isDone(){return this._hasIntersection===!0}visit(r){const a=r.getEnvelopeInternal();if(!this._rectEnv.intersects(a))return null;const p=ke.getLines(r);this.checkIntersectionWithLineStrings(p)}checkIntersectionWithLineStrings(r){for(let a=r.iterator();a.hasNext();){const p=a.next();if(this.checkIntersectionWithSegments(p),this._hasIntersection)return null}}checkIntersectionWithSegments(r){const a=r.getCoordinateSequence();for(let p=1;p<a.size();p++)if(a.getCoordinate(p-1,this._p0),a.getCoordinate(p,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}}class Tn extends rl{constructor(){super(),Tn.constructor_.apply(this,arguments)}static constructor_(){if(this._relate=null,arguments.length===2){const r=arguments[0],a=arguments[1];rl.constructor_.call(this,r,a),this._relate=new Al(this._arg)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];rl.constructor_.call(this,r,a,p),this._relate=new Al(this._arg)}}static equalsTopo(r,a){return!!r.getEnvelopeInternal().equals(a.getEnvelopeInternal())&&Tn.relate(r,a).isEquals(r.getDimension(),a.getDimension())}static relate(){if(arguments.length===2)return new Tn(arguments[0],arguments[1]).getIntersectionMatrix();if(arguments.length===3)return new Tn(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix()}static overlaps(r,a){return!!r.getEnvelopeInternal().intersects(a.getEnvelopeInternal())&&new Tn(r,a).getIntersectionMatrix().isOverlaps(r.getDimension(),a.getDimension())}static disjoint(r,a){return!Tn.intersects(r,a)}static covers(r,a){return!(a.getDimension()===2&&r.getDimension()<2)&&!(a.getDimension()===1&&r.getDimension()<1&&a.getLength()>0)&&!!r.getEnvelopeInternal().covers(a.getEnvelopeInternal())&&(!!r.isRectangle()||new Tn(r,a).getIntersectionMatrix().isCovers())}static intersects(r,a){if(!r.getEnvelopeInternal().intersects(a.getEnvelopeInternal()))return!1;if(r.isRectangle())return tu.intersects(r,a);if(a.isRectangle())return tu.intersects(a,r);if(r.isGeometryCollection()||a.isGeometryCollection()){for(let p=0;p<r.getNumGeometries();p++)for(let _=0;_<a.getNumGeometries();_++)if(Tn.intersects(r.getGeometryN(p),a.getGeometryN(_)))return!0;return!1}return new Tn(r,a).getIntersectionMatrix().isIntersects()}static touches(r,a){return!!r.getEnvelopeInternal().intersects(a.getEnvelopeInternal())&&new Tn(r,a).getIntersectionMatrix().isTouches(r.getDimension(),a.getDimension())}static crosses(r,a){return!!r.getEnvelopeInternal().intersects(a.getEnvelopeInternal())&&new Tn(r,a).getIntersectionMatrix().isCrosses(r.getDimension(),a.getDimension())}static contains(r,a){return!(a.getDimension()===2&&r.getDimension()<2)&&!(a.getDimension()===1&&r.getDimension()<1&&a.getLength()>0)&&!!r.getEnvelopeInternal().contains(a.getEnvelopeInternal())&&(r.isRectangle()?dc.contains(r,a):new Tn(r,a).getIntersectionMatrix().isContains())}getIntersectionMatrix(){return this._relate.computeIM()}}var wf=Object.freeze({__proto__:null,RelateOp:Tn});class ll{constructor(){ll.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._polygons=new $,this._lines=new $,this._points=new $,this._dimension=se.FALSE}static extract(){if(pt(arguments[0],T)){const r=arguments[0],a=new ll;return a.add(r),a}if(arguments[0]instanceof oe){const r=arguments[0],a=new ll;return a.add(r),a}}getFactory(){return this._geomFactory}filter(r){return this.recordDimension(r.getDimension()),r instanceof Ot||r.isEmpty()?null:r instanceof Ut?(this._polygons.add(r),null):r instanceof Ee?(this._lines.add(r),null):r instanceof zt?(this._points.add(r),null):void L.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}getExtract(r){switch(r){case 0:return this._points;case 1:return this._lines;case 2:return this._polygons}return L.shouldNeverReachHere("Invalid dimension: "+r),null}recordDimension(r){r>this._dimension&&(this._dimension=r)}getDimension(){return this._dimension}isEmpty(){return this._polygons.isEmpty()&&this._lines.isEmpty()&&this._points.isEmpty()}add(){if(pt(arguments[0],T)){const r=arguments[0];for(const a of r)this.add(a)}else if(arguments[0]instanceof oe){const r=arguments[0];this._geomFactory===null&&(this._geomFactory=r.getFactory()),r.apply(this)}}get interfaces_(){return[wi]}}class eu{constructor(){eu.constructor_.apply(this,arguments)}static constructor_(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;const r=arguments[0],a=arguments[1];this._pointGeom=r,this._otherGeom=a,this._geomFact=a.getFactory()}static union(r,a){return new eu(r,a).union()}union(){const r=new Ea,a=new Xn;for(let C=0;C<this._pointGeom.getNumGeometries();C++){const k=this._pointGeom.getGeometryN(C).getCoordinate();r.locate(k,this._otherGeom)===St.EXTERIOR&&a.add(k)}if(a.size()===0)return this._otherGeom;let p=null;const _=De.toCoordinateArray(a);return p=_.length===1?this._geomFact.createPoint(_[0]):this._geomFact.createMultiPointFromCoords(_),At.combine(p,this._otherGeom)}}class Ts{constructor(){Ts.constructor_.apply(this,arguments)}static constructor_(){this._geomFactory=null,this._g0=null,this._g1=null,this._isUnionSafe=null;const r=arguments[0],a=arguments[1];this._g0=r,this._g1=a,this._geomFactory=r.getFactory()}static containsProperly(){if(arguments.length===2){const r=arguments[0],a=arguments[1];return!r.isNull()&&a.getX()>r.getMinX()&&a.getX()<r.getMaxX()&&a.getY()>r.getMinY()&&a.getY()<r.getMaxY()}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];return Ts.containsProperly(r,a)&&Ts.containsProperly(r,p)}}static union(r,a){return new Ts(r,a).union()}static intersects(r,a,p){return r.intersects(a)||r.intersects(p)}static overlapEnvelope(r,a){const p=r.getEnvelopeInternal(),_=a.getEnvelopeInternal();return p.intersection(_)}static extractBorderSegments(r,a,p){r.apply(new class{get interfaces_(){return[rt]}filter(_,C){if(C<=0)return null;const k=_.getCoordinate(C-1),X=_.getCoordinate(C);if(Ts.intersects(a,k,X)&&!Ts.containsProperly(a,k,X)){const J=new gr(k,X);p.add(J)}}isDone(){return!1}isGeometryChanged(){return!1}})}static unionBuffer(r,a){const p=r.getFactory().createGeometryCollection([r,a]);return Vi.bufferOp(p,0)}isBorderSegmentsSame(r,a){const p=this.extractBorderSegments(this._g0,this._g1,a),_=new $;return Ts.extractBorderSegments(r,a,_),this.isEqual(p,_)}union(){const r=Ts.overlapEnvelope(this._g0,this._g1);if(r.isNull()){const X=this._g0.copy(),J=this._g1.copy();return At.combine(X,J)}const a=new $,p=this.extractByEnvelope(r,this._g0,a),_=this.extractByEnvelope(r,this._g1,a),C=this.unionFull(p,_);let k=null;return this._isUnionSafe=this.isBorderSegmentsSame(C,r),k=this._isUnionSafe?this.combine(C,a):this.unionFull(this._g0,this._g1),k}extractBorderSegments(r,a,p){const _=new $;return Ts.extractBorderSegments(r,p,_),a!==null&&Ts.extractBorderSegments(a,p,_),_}isUnionOptimized(){return this._isUnionSafe}extractByEnvelope(r,a,p){const _=new $;for(let C=0;C<a.getNumGeometries();C++){const k=a.getGeometryN(C);if(k.getEnvelopeInternal().intersects(r))_.add(k);else{const X=k.copy();p.add(X)}}return this._geomFactory.buildGeometry(_)}isEqual(r,a){if(r.size()!==a.size())return!1;const p=new Be(r);for(const _ of a)if(!p.contains(_))return!1;return!0}combine(r,a){return a.size()<=0?r:(a.add(r),At.combine(a))}unionFull(r,a){try{return ac.union(r,a)}catch(p){if(p instanceof jt)return Ts.unionBuffer(r,a);throw p}}}class Hs{constructor(){Hs.constructor_.apply(this,arguments)}static constructor_(){this._inputPolys=null,this._geomFactory=null;const r=arguments[0];this._inputPolys=r,this._inputPolys===null&&(this._inputPolys=new $)}static getGeometry(r,a){return a>=r.size()?null:r.get(a)}static union(r){return new Hs(r).union()}static restrictToPolygons(r){if(pt(r,Kt))return r;const a=Fr.getPolygons(r);return a.size()===1?a.get(0):r.getFactory().createMultiPolygon(Se.toPolygonArray(a))}reduceToGeometries(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();let C=null;pt(_,ut)?C=this.unionTree(_):_ instanceof oe&&(C=_),a.add(C)}return a}union(){if(this._inputPolys===null)throw new Vt("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();const r=new ri(Hs.STRTREE_NODE_CAPACITY);for(let p=this._inputPolys.iterator();p.hasNext();){const _=p.next();r.insert(_.getEnvelopeInternal(),_)}this._inputPolys=null;const a=r.itemsTree();return this.unionTree(a)}binaryUnion(){if(arguments.length===1){const r=arguments[0];return this.binaryUnion(r,0,r.size())}if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(p-a<=1){const _=Hs.getGeometry(r,a);return this.unionSafe(_,null)}if(p-a==2)return this.unionSafe(Hs.getGeometry(r,a),Hs.getGeometry(r,a+1));{const _=Math.trunc((p+a)/2),C=this.binaryUnion(r,a,_),k=this.binaryUnion(r,_,p);return this.unionSafe(C,k)}}}unionSafe(r,a){return r===null&&a===null?null:r===null?a.copy():a===null?r.copy():this.unionActual(r,a)}unionActual(r,a){const p=Ts.union(r,a);return Hs.restrictToPolygons(p)}unionTree(r){const a=this.reduceToGeometries(r);return this.binaryUnion(a)}}Hs.STRTREE_NODE_CAPACITY=4;class Ol{constructor(){Ol.constructor_.apply(this,arguments)}static constructor_(){if(this._geomFact=null,this._extracter=null,arguments.length===1){if(pt(arguments[0],T)){const r=arguments[0];this.extract(r)}else if(arguments[0]instanceof oe){const r=arguments[0];this.extract(r)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._geomFact=a,this.extract(r)}}static union(){if(arguments.length===1){if(pt(arguments[0],T))return new Ol(arguments[0]).union();if(arguments[0]instanceof oe)return new Ol(arguments[0]).union()}else if(arguments.length===2)return new Ol(arguments[0],arguments[1]).union()}extract(){if(pt(arguments[0],T)){const r=arguments[0];this._extracter=ll.extract(r)}else if(arguments[0]instanceof oe){const r=arguments[0];this._extracter=ll.extract(r)}}unionWithNull(r,a){return r===null&&a===null?null:a===null?r:r===null?a:Ir.union(r,a)}unionNoOpt(r){const a=this._geomFact.createPoint();return ls.overlayOp(r,a,Ir.UNION)}union(){if(this._geomFact===null&&(this._geomFact=this._extracter.getFactory()),this._geomFact===null)return null;if(this._extracter.isEmpty())return this._geomFact.createEmpty(this._extracter.getDimension());const r=this._extracter.getExtract(0),a=this._extracter.getExtract(1),p=this._extracter.getExtract(2);let _=null;if(r.size()>0){const Ct=this._geomFact.buildGeometry(r);_=this.unionNoOpt(Ct)}let C=null;if(a.size()>0){const Ct=this._geomFact.buildGeometry(a);C=this.unionNoOpt(Ct)}let k=null;p.size()>0&&(k=Hs.union(p));const X=this.unionWithNull(C,k);let J=null;return J=_===null?X:X===null?_:eu.union(_,X),J===null?this._geomFact.createGeometryCollection():J}}var bf=Object.freeze({__proto__:null,UnaryUnionOp:Ol}),sp=Object.freeze({__proto__:null,ConsistentAreaTester:Ju,IsValidOp:hs}),Sf=Object.freeze({__proto__:null,BoundaryOp:nl,IsSimpleOp:Ll,buffer:yf,distance:Bd,linemerge:ip,overlay:Vd,polygonize:Gm,relate:wf,union:bf,valid:sp});class ha{constructor(){ha.constructor_.apply(this,arguments)}static constructor_(){if(this._returnToOriginalPrecision=!0,this._cbr=null,arguments.length===0)ha.constructor_.call(this,!0);else if(arguments.length===1){const r=arguments[0];this._returnToOriginalPrecision=r}}computeResultPrecision(r){return this._returnToOriginalPrecision&&this._cbr.addCommonBits(r),r}union(r,a){const p=this.removeCommonBits(r,a);return this.computeResultPrecision(ac.union(p[0],p[1]))}intersection(r,a){const p=this.removeCommonBits(r,a);return this.computeResultPrecision(Ir.intersection(p[0],p[1]))}removeCommonBits(){if(arguments.length===1){const r=arguments[0];return this._cbr=new $i,this._cbr.add(r),this._cbr.removeCommonBits(r.copy())}if(arguments.length===2){const r=arguments[0],a=arguments[1];this._cbr=new $i,this._cbr.add(r),this._cbr.add(a);const p=new Array(2).fill(null);return p[0]=this._cbr.removeCommonBits(r.copy()),p[1]=this._cbr.removeCommonBits(a.copy()),p}}buffer(r,a){const p=this.removeCommonBits(r);return this.computeResultPrecision(Vi.bufferOp(p,a))}symDifference(r,a){const p=this.removeCommonBits(r,a);return this.computeResultPrecision(Ir.symDifference(p[0],p[1]))}difference(r,a){const p=this.removeCommonBits(r,a);return this.computeResultPrecision(Ir.difference(p[0],p[1]))}}class Ef extends Qt.CoordinateOperation{constructor(){super(),Ef.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0;const r=arguments[0],a=arguments[1];this._targetPM=r,this._removeCollapsed=a}edit(){if(arguments.length===2&&arguments[1]instanceof oe&&arguments[0]instanceof Array){const r=arguments[0],a=arguments[1];if(r.length===0)return null;const p=new Array(r.length).fill(null);for(let X=0;X<r.length;X++){const J=new O(r[X]);this._targetPM.makePrecise(J),p[X]=J}const _=new W(p,!1).toCoordinateArray();let C=0;a instanceof Ee&&(C=2),a instanceof Sr&&(C=4);let k=p;return this._removeCollapsed&&(k=null),_.length<C?k:_}return super.edit.apply(this,arguments)}}class cl{constructor(){cl.constructor_.apply(this,arguments)}static constructor_(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;const r=arguments[0];this._targetPM=r}static reduce(r,a){return new cl(a).reduce(r)}static reducePointwise(r,a){const p=new cl(a);return p.setPointwise(!0),p.reduce(r)}fixPolygonalTopology(r){let a=r;return this._changePrecisionModel||(a=this.changePM(r,this._targetPM)),Vi.bufferOp(a,0)}reducePointwise(r){let a=null;if(this._changePrecisionModel){const _=this.createFactory(r.getFactory(),this._targetPM);a=new Qt(_)}else a=new Qt;let p=this._removeCollapsed;return r.getDimension()>=2&&(p=!0),a.edit(r,new Ef(this._targetPM,p))}changePM(r,a){return this.createEditor(r.getFactory(),a).edit(r,new Qt.NoOpGeometryOperation)}setRemoveCollapsedComponents(r){this._removeCollapsed=r}createFactory(r,a){return new Se(a,r.getSRID(),r.getCoordinateSequenceFactory())}setChangePrecisionModel(r){this._changePrecisionModel=r}reduce(r){const a=this.reducePointwise(r);return this._isPointwise?a:pt(a,Kt)?hs.isValid(a)?a:this.fixPolygonalTopology(a):a}setPointwise(r){this._isPointwise=r}createEditor(r,a){if(r.getPrecisionModel()===a)return new Qt;const p=this.createFactory(r,a);return new Qt(p)}}class pa{constructor(){pa.constructor_.apply(this,arguments)}static constructor_(){if(this._geom=null,this._pts=null,this._start=null,this._end=null,arguments.length===2){const r=arguments[0],a=arguments[1];this._pts=r,this._start=a,this._end=a+1}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._pts=r,this._start=a,this._end=p}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this._geom=r,this._pts=a,this._start=p,this._end=_}}size(){return this._end-this._start}getCoordinate(r){return this._pts.getCoordinate(this._start+r)}updateNearestLocationsLineLine(r,a,p,_,C,k,X,J){const Ct=new gr(a,p),te=new gr(k,X),ce=Ct.closestPoints(te);J[0]=new to(this._geom,r,new O(ce[0])),J[1]=new to(_._geom,C,new O(ce[1]))}toString(){const r=new vt;r.append("LINESTRING ( ");const a=new O;for(let p=this._start;p<this._end;p++)p>this._start&&r.append(", "),this._pts.getCoordinate(p,a),r.append(a.x+" "+a.y);return r.append(" )"),r.toString()}computeDistancePointLine(r,a,p){let _=m.MAX_VALUE;for(let C=a._start;C<a._end-1;C++){const k=a._pts.getCoordinate(C),X=a._pts.getCoordinate(C+1),J=je.pointToSegment(r,k,X);if(J<_&&(_=J,p!==null&&this.updateNearestLocationsPointLine(r,a,C,k,X,p),_<=0))return _}return _}isPoint(){return this._end-this._start==1}distance(r){const a=this.isPoint(),p=r.isPoint();let _=null;if(a&&p){const C=this._pts.getCoordinate(this._start),k=r._pts.getCoordinate(r._start);_=C.distance(k)}else if(a){const C=this._pts.getCoordinate(this._start);_=this.computeDistancePointLine(C,r,null)}else if(p){const C=r._pts.getCoordinate(r._start);_=this.computeDistancePointLine(C,this,null)}else _=this.computeDistanceLineLine(r,null);return _}computeDistanceLineLine(r,a){let p=m.MAX_VALUE;for(let _=this._start;_<this._end-1;_++){const C=this._pts.getCoordinate(_),k=this._pts.getCoordinate(_+1);for(let X=r._start;X<r._end-1;X++){const J=r._pts.getCoordinate(X),Ct=r._pts.getCoordinate(X+1),te=je.segmentToSegment(C,k,J,Ct);if(te<p&&(p=te,a!==null&&this.updateNearestLocationsLineLine(_,C,k,r,X,J,Ct,a),p<=0))return p}}return p}updateNearestLocationsPointLine(r,a,p,_,C,k){k[0]=new to(this._geom,this._start,new O(r));const X=new gr(_,C).closestPoint(r);k[1]=new to(a._geom,p,new O(X))}nearestLocations(r){const a=this.isPoint(),p=r.isPoint(),_=new Array(2).fill(null);if(a&&p){const C=this._pts.getCoordinate(this._start),k=r._pts.getCoordinate(r._start);_[0]=new to(this._geom,this._start,new O(C)),_[1]=new to(r._geom,r._start,new O(k))}else if(a){const C=this._pts.getCoordinate(this._start);this.computeDistancePointLine(C,r,_)}else if(p){const C=r._pts.getCoordinate(r._start);this.computeDistancePointLine(C,this,_);const k=_[0];_[0]=_[1],_[1]=k}else this.computeDistanceLineLine(r,_);return _}getEnvelope(){const r=new nt;for(let a=this._start;a<this._end;a++)r.expandToInclude(this._pts.getX(a),this._pts.getY(a));return r}}class ul{static addFacetSequences(r,a,p){let _=0;const C=a.size();for(;_<=C-1;){let k=_+ul.FACET_SEQUENCE_SIZE+1;k>=C-1&&(k=C);const X=new pa(r,a,_,k);p.add(X),_+=ul.FACET_SEQUENCE_SIZE}}static build(r){const a=new ri(ul.STR_TREE_NODE_CAPACITY);for(let p=ul.computeFacetSequences(r).iterator();p.hasNext();){const _=p.next();a.insert(_.getEnvelope(),_)}return a.build(),a}static computeFacetSequences(r){const a=new $;return r.apply(new class{get interfaces_(){return[Ue]}filter(p){let _=null;(p instanceof Ee||p instanceof zt)&&(_=p.getCoordinateSequence(),ul.addFacetSequences(p,_,a))}}),a}}ul.FACET_SEQUENCE_SIZE=6,ul.STR_TREE_NODE_CAPACITY=4;class ru{constructor(){ru.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;const r=arguments[0];this._inputGeom=r}static getDistance(r){return new ru(r).getDistance()}static getLine(r){return new ru(r).getLine()}getDistance(){return this.compute(),this._minClearance}compute(){if(this._minClearancePts!==null||(this._minClearancePts=new Array(2).fill(null),this._minClearance=m.MAX_VALUE,this._inputGeom.isEmpty()))return null;const r=ul.build(this._inputGeom).nearestNeighbour(new iu),a=new iu;this._minClearance=a.distance(r[0],r[1]),this._minClearancePts=a.getCoordinates()}getLine(){return this.compute(),this._minClearancePts===null||this._minClearancePts[0]===null?this._inputGeom.getFactory().createLineString():this._inputGeom.getFactory().createLineString(this._minClearancePts)}}class iu{constructor(){iu.constructor_.apply(this,arguments)}static constructor_(){this._minDist=m.MAX_VALUE,this._minPts=new Array(2).fill(null)}vertexDistance(r,a){for(let p=0;p<r.size();p++)for(let _=0;_<a.size();_++){const C=r.getCoordinate(p),k=a.getCoordinate(_);if(!C.equals2D(k)){const X=C.distance(k);if(X<this._minDist&&(this._minDist=X,this._minPts[0]=C,this._minPts[1]=k,X===0))return X}}return this._minDist}getCoordinates(){return this._minPts}segmentDistance(r,a){for(let p=0;p<r.size();p++)for(let _=1;_<a.size();_++){const C=r.getCoordinate(p),k=a.getCoordinate(_-1),X=a.getCoordinate(_);if(!C.equals2D(k)&&!C.equals2D(X)){const J=je.pointToSegment(C,k,X);if(J<this._minDist&&(this._minDist=J,this.updatePts(C,k,X),J===0))return J}}return this._minDist}distance(){if(arguments[0]instanceof be&&arguments[1]instanceof be){const r=arguments[1],a=arguments[0].getItem(),p=r.getItem();return this._minDist=m.MAX_VALUE,this.distance(a,p)}if(arguments[0]instanceof pa&&arguments[1]instanceof pa){const r=arguments[0],a=arguments[1];return this.vertexDistance(r,a),r.size()===1&&a.size()===1?this._minDist:this._minDist<=0?this._minDist:(this.segmentDistance(r,a),this._minDist<=0||this.segmentDistance(a,r),this._minDist)}}updatePts(r,a,p){this._minPts[0]=r;const _=new gr(a,p);this._minPts[1]=new O(_.closestPoint(r))}get interfaces_(){return[ts]}}ru.MinClearanceDistance=iu;class gc{constructor(){gc.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._minClearance=null,this._minClearancePts=null;const r=arguments[0];this._inputGeom=r}static getDistance(r){return new gc(r).getDistance()}static getLine(r){return new gc(r).getLine()}getDistance(){return this.compute(),this._minClearance}compute(){if(this._minClearancePts!==null)return null;this._minClearancePts=new Array(2).fill(null),this._minClearance=m.MAX_VALUE,this._inputGeom.apply(new hl(this))}updateClearance(){if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];r<this._minClearance&&(this._minClearance=r,this._minClearancePts[0]=new O(a),this._minClearancePts[1]=new O(p))}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];if(r<this._minClearance){this._minClearance=r,this._minClearancePts[0]=new O(a);const C=new gr(p,_);this._minClearancePts[1]=new O(C.closestPoint(a))}}}getLine(){return this.compute(),this._inputGeom.getFactory().createLineString(this._minClearancePts)}}class hl{constructor(){hl.constructor_.apply(this,arguments)}static constructor_(){this.smc=null;const r=arguments[0];this.smc=r}filter(r){this.smc._inputGeom.apply(new Nl(this.smc,r))}get interfaces_(){return[Ar]}}class Nl{constructor(){Nl.constructor_.apply(this,arguments)}static constructor_(){this.smc=null,this._queryPt=null;const r=arguments[0],a=arguments[1];this.smc=r,this._queryPt=a}filter(r,a){this.checkVertexDistance(r.getCoordinate(a)),a>0&&this.checkSegmentDistance(r.getCoordinate(a-1),r.getCoordinate(a))}checkSegmentDistance(r,a){if(this._queryPt.equals2D(r)||this._queryPt.equals2D(a))return null;const p=je.pointToSegment(this._queryPt,a,r);p>0&&this.smc.updateClearance(p,this._queryPt,a,r)}isDone(){return!1}isGeometryChanged(){return!1}checkVertexDistance(r){const a=r.distance(this._queryPt);a>0&&this.smc.updateClearance(a,this._queryPt,r)}get interfaces_(){return[rt]}}gc.VertexCoordinateFilter=hl,gc.ComputeMCCoordinateSequenceFilter=Nl;var jm=Object.freeze({__proto__:null,CommonBits:Io,CommonBitsOp:ha,CommonBitsRemover:$i,EnhancedPrecisionOp:class{static union(dt,r){let a=null;try{return ac.union(dt,r)}catch(p){if(!(p instanceof E))throw p;a=p}try{const p=new ha(!0).union(dt,r);if(!p.isValid())throw a;return p}catch(p){throw p instanceof E?a:p}}static intersection(dt,r){let a=null;try{return Ir.intersection(dt,r)}catch(p){if(!(p instanceof E))throw p;a=p}try{const p=new ha(!0).intersection(dt,r);if(!p.isValid())throw a;return p}catch(p){throw p instanceof E?a:p}}static buffer(dt,r){let a=null;try{return Vi.bufferOp(dt,r)}catch(p){if(!(p instanceof E))throw p;a=p}try{const p=new ha(!0).buffer(dt,r);if(!p.isValid())throw a;return p}catch(p){throw p instanceof E?a:p}}static symDifference(dt,r){let a=null;try{return Ir.symDifference(dt,r)}catch(p){if(!(p instanceof E))throw p;a=p}try{const p=new ha(!0).symDifference(dt,r);if(!p.isValid())throw a;return p}catch(p){throw p instanceof E?a:p}}static difference(dt,r){let a=null;try{return Ir.difference(dt,r)}catch(p){if(!(p instanceof E))throw p;a=p}try{const p=new ha(!0).difference(dt,r);if(!p.isValid())throw a;return p}catch(p){throw p instanceof E?a:p}}},GeometryPrecisionReducer:cl,MinimumClearance:ru,SimpleMinimumClearance:gc});class mc{constructor(){mc.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new gr;const r=arguments[0];this._pts=r}static simplify(r,a){const p=new mc(r);return p.setDistanceTolerance(a),p.simplify()}setDistanceTolerance(r){this._distanceTolerance=r}simplifySection(r,a){if(r+1===a)return null;this._seg.p0=this._pts[r],this._seg.p1=this._pts[a];let p=-1,_=r;for(let C=r+1;C<a;C++){const k=this._seg.distance(this._pts[C]);k>p&&(p=k,_=C)}if(p<=this._distanceTolerance)for(let C=r+1;C<a;C++)this._usePt[C]=!1;else this.simplifySection(r,_),this.simplifySection(_,a)}simplify(){this._usePt=new Array(this._pts.length).fill(null);for(let a=0;a<this._pts.length;a++)this._usePt[a]=!0;this.simplifySection(0,this._pts.length-1);const r=new W;for(let a=0;a<this._pts.length;a++)this._usePt[a]&&r.add(new O(this._pts[a]));return r.toCoordinateArray()}}class yc{constructor(){yc.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;const r=arguments[0];this._inputGeom=r}static simplify(r,a){const p=new yc(r);return p.setDistanceTolerance(a),p.getResultGeometry()}setDistanceTolerance(r){if(r<0)throw new u("Tolerance must be non-negative");this._distanceTolerance=r}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new fa(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setEnsureValid(r){this._isEnsureValidTopology=r}}class fa extends Xe{constructor(){super(),fa.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;const r=arguments[0],a=arguments[1];this._isEnsureValidTopology=r,this._distanceTolerance=a}transformPolygon(r,a){if(r.isEmpty())return null;const p=super.transformPolygon.call(this,r,a);return a instanceof ae?p:this.createValidArea(p)}createValidArea(r){return this._isEnsureValidTopology?Vi.bufferOp(r,0):r}transformCoordinates(r,a){const p=r.toCoordinateArray();let _=null;return _=p.length===0?new Array(0).fill(null):mc.simplify(p,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(_)}transformMultiPolygon(r,a){const p=super.transformMultiPolygon.call(this,r,a);return this.createValidArea(p)}transformLinearRing(r,a){const p=a instanceof Ut,_=super.transformLinearRing.call(this,r,a);return!p||_ instanceof Sr?_:null}}yc.DPTransformer=fa;class nu extends gr{constructor(){super(),nu.constructor_.apply(this,arguments)}static constructor_(){if(this._parent=null,this._index=null,arguments.length===2){const r=arguments[0],a=arguments[1];nu.constructor_.call(this,r,a,null,-1)}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];gr.constructor_.call(this,r,a),this._parent=p,this._index=_}}getParent(){return this._parent}getIndex(){return this._index}}class Rl{constructor(){Rl.constructor_.apply(this,arguments)}static constructor_(){if(this._parentLine=null,this._segs=null,this._resultSegs=new $,this._minimumSize=null,arguments.length===1){const r=arguments[0];Rl.constructor_.call(this,r,2)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._parentLine=r,this._minimumSize=a,this.init()}}static extractCoordinates(r){const a=new Array(r.size()+1).fill(null);let p=null;for(let _=0;_<r.size();_++)p=r.get(_),a[_]=p.p0;return a[a.length-1]=p.p1,a}addToResult(r){this._resultSegs.add(r)}asLineString(){return this._parentLine.getFactory().createLineString(Rl.extractCoordinates(this._resultSegs))}getResultSize(){const r=this._resultSegs.size();return r===0?0:r+1}getParentCoordinates(){return this._parentLine.getCoordinates()}getMinimumSize(){return this._minimumSize}asLinearRing(){return this._parentLine.getFactory().createLinearRing(Rl.extractCoordinates(this._resultSegs))}getSegments(){return this._segs}init(){const r=this._parentLine.getCoordinates();this._segs=new Array(r.length-1).fill(null);for(let a=0;a<r.length-1;a++){const p=new nu(r[a],r[a+1],this._parentLine,a);this._segs[a]=p}}getResultCoordinates(){return Rl.extractCoordinates(this._resultSegs)}getParent(){return this._parentLine}getSegment(r){return this._segs[r]}}class vc{constructor(){vc.constructor_.apply(this,arguments)}static constructor_(){this._index=new Ml}add(){if(arguments[0]instanceof Rl){const r=arguments[0].getSegments();for(let a=0;a<r.length;a++){const p=r[a];this.add(p)}}else if(arguments[0]instanceof gr){const r=arguments[0];this._index.insert(new nt(r.p0,r.p1),r)}}query(r){const a=new nt(r.p0,r.p1),p=new oh(r);return this._index.query(a,p),p.getItems()}remove(r){this._index.remove(new nt(r.p0,r.p1),r)}}class oh{constructor(){oh.constructor_.apply(this,arguments)}static constructor_(){this._querySeg=null,this._items=new $;const r=arguments[0];this._querySeg=r}getItems(){return this._items}visitItem(r){const a=r;nt.intersects(a.p0,a.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(r)}get interfaces_(){return[ba]}}class ou{constructor(){ou.constructor_.apply(this,arguments)}static constructor_(){this._li=new tn,this._inputIndex=new vc,this._outputIndex=new vc,this._line=null,this._linePts=null,this._distanceTolerance=0;const r=arguments[0],a=arguments[1];this._inputIndex=r,this._outputIndex=a}static isInLineSection(r,a,p){if(p.getParent()!==r.getParent())return!1;const _=p.getIndex();return _>=a[0]&&_<a[1]}flatten(r,a){const p=this._linePts[r],_=this._linePts[a],C=new gr(p,_);return this.remove(this._line,r,a),this._outputIndex.add(C),C}hasBadIntersection(r,a,p){return!!this.hasBadOutputIntersection(p)||!!this.hasBadInputIntersection(r,a,p)}setDistanceTolerance(r){this._distanceTolerance=r}simplifySection(r,a,p){p+=1;const _=new Array(2).fill(null);if(r+1===a){const Ct=this._line.getSegment(r);return this._line.addToResult(Ct),null}let C=!0;this._line.getResultSize()<this._line.getMinimumSize()&&p+1<this._line.getMinimumSize()&&(C=!1);const k=new Array(1).fill(null),X=this.findFurthestPoint(this._linePts,r,a,k);k[0]>this._distanceTolerance&&(C=!1);const J=new gr;if(J.p0=this._linePts[r],J.p1=this._linePts[a],_[0]=r,_[1]=a,this.hasBadIntersection(this._line,_,J)&&(C=!1),C){const Ct=this.flatten(r,a);return this._line.addToResult(Ct),null}this.simplifySection(r,X,p),this.simplifySection(X,a,p)}hasBadOutputIntersection(r){for(let a=this._outputIndex.query(r).iterator();a.hasNext();){const p=a.next();if(this.hasInteriorIntersection(p,r))return!0}return!1}hasInteriorIntersection(r,a){return this._li.computeIntersection(r.p0,r.p1,a.p0,a.p1),this._li.isInteriorIntersection()}hasBadInputIntersection(r,a,p){for(let _=this._inputIndex.query(p).iterator();_.hasNext();){const C=_.next();if(this.hasInteriorIntersection(C,p)){if(ou.isInLineSection(r,a,C))continue;return!0}}return!1}findFurthestPoint(r,a,p,_){const C=new gr;C.p0=r[a],C.p1=r[p];let k=-1,X=a;for(let J=a+1;J<p;J++){const Ct=r[J],te=C.distance(Ct);te>k&&(k=te,X=J)}return _[0]=k,X}simplify(r){this._line=r,this._linePts=r.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}remove(r,a,p){for(let _=a;_<p;_++){const C=r.getSegment(_);this._inputIndex.remove(C)}}}class Xs{constructor(){Xs.constructor_.apply(this,arguments)}static constructor_(){this._inputIndex=new vc,this._outputIndex=new vc,this._distanceTolerance=0}setDistanceTolerance(r){this._distanceTolerance=r}simplify(r){for(let a=r.iterator();a.hasNext();)this._inputIndex.add(a.next());for(let a=r.iterator();a.hasNext();){const p=new ou(this._inputIndex,this._outputIndex);p.setDistanceTolerance(this._distanceTolerance),p.simplify(a.next())}}}class ka{constructor(){ka.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._lineSimplifier=new Xs,this._linestringMap=null;const r=arguments[0];this._inputGeom=r}static simplify(r,a){const p=new ka(r);return p.setDistanceTolerance(a),p.getResultGeometry()}setDistanceTolerance(r){if(r<0)throw new u("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(r)}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new br,this._inputGeom.apply(new Fa(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new pl(this._linestringMap).transform(this._inputGeom))}}class pl extends Xe{constructor(){super(),pl.constructor_.apply(this,arguments)}static constructor_(){this._linestringMap=null;const r=arguments[0];this._linestringMap=r}transformCoordinates(r,a){if(r.size()===0)return null;if(a instanceof Ee){const p=this._linestringMap.get(a);return this.createCoordinateSequence(p.getResultCoordinates())}return super.transformCoordinates.call(this,r,a)}}class Fa{constructor(){Fa.constructor_.apply(this,arguments)}static constructor_(){this.tps=null;const r=arguments[0];this.tps=r}filter(r){if(r instanceof Ee){const a=r;if(a.isEmpty())return null;const p=a.isClosed()?4:2,_=new Rl(a,p);this.tps._linestringMap.put(a,_)}}get interfaces_(){return[Ue]}}ka.LineStringTransformer=pl,ka.LineStringMapBuilderFilter=Fa;class Da{constructor(){Da.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._tolerance=null;const r=arguments[0],a=arguments[1];this._pts=r,this._tolerance=a*a}static simplify(r,a){return new Da(r,a).simplify()}simplifyVertex(r){let a=r,p=a.getArea(),_=null;for(;a!==null;){const C=a.getArea();C<p&&(p=C,_=a),a=a._next}return _!==null&&p<this._tolerance&&_.remove(),r.isLive()?p:-1}simplify(){const r=Ps.buildLine(this._pts);let a=this._tolerance;do a=this.simplifyVertex(r);while(a<this._tolerance);const p=r.getCoordinates();return p.length<2?[p[0],new O(p[0])]:p}}class Ps{constructor(){Ps.constructor_.apply(this,arguments)}static constructor_(){this._pt=null,this._prev=null,this._next=null,this._area=Ps.MAX_AREA,this._isLive=!0;const r=arguments[0];this._pt=r}static buildLine(r){let a=null,p=null;for(let _=0;_<r.length;_++){const C=new Ps(r[_]);a===null&&(a=C),C.setPrev(p),p!==null&&(p.setNext(C),p.updateArea()),p=C}return a}getCoordinates(){const r=new W;let a=this;do r.add(a._pt,!1),a=a._next;while(a!==null);return r.toCoordinateArray()}getArea(){return this._area}updateArea(){if(this._prev===null||this._next===null)return this._area=Ps.MAX_AREA,null;this._area=Math.abs(qi.area(this._prev._pt,this._pt,this._next._pt))}remove(){const r=this._prev,a=this._next;let p=null;return this._prev!==null&&(this._prev.setNext(a),this._prev.updateArea(),p=this._prev),this._next!==null&&(this._next.setPrev(r),this._next.updateArea(),p===null&&(p=this._next)),this._isLive=!1,p}isLive(){return this._isLive}setPrev(r){this._prev=r}setNext(r){this._next=r}}Ps.MAX_AREA=m.MAX_VALUE,Da.VWVertex=Ps;class Ga{constructor(){Ga.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;const r=arguments[0];this._inputGeom=r}static simplify(r,a){const p=new Ga(r);return p.setDistanceTolerance(a),p.getResultGeometry()}setDistanceTolerance(r){if(r<0)throw new u("Tolerance must be non-negative");this._distanceTolerance=r}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new kl(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setEnsureValid(r){this._isEnsureValidTopology=r}}class kl extends Xe{constructor(){super(),kl.constructor_.apply(this,arguments)}static constructor_(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;const r=arguments[0],a=arguments[1];this._isEnsureValidTopology=r,this._distanceTolerance=a}transformPolygon(r,a){if(r.isEmpty())return null;const p=super.transformPolygon.call(this,r,a);return a instanceof ae?p:this.createValidArea(p)}createValidArea(r){return this._isEnsureValidTopology?Vi.bufferOp(r,0):r}transformCoordinates(r,a){const p=r.toCoordinateArray();let _=null;return _=p.length===0?new Array(0).fill(null):Da.simplify(p,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(_)}transformMultiPolygon(r,a){const p=super.transformMultiPolygon.call(this,r,a);return this.createValidArea(p)}transformLinearRing(r,a){const p=a instanceof Ut,_=super.transformLinearRing.call(this,r,a);return!p||_ instanceof Sr?_:null}}Ga.VWTransformer=kl;var Fl=Object.freeze({__proto__:null,DouglasPeuckerSimplifier:yc,TopologyPreservingSimplifier:ka,VWSimplifier:Ga});class da{locate(r){}}class sh{constructor(){sh.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._lastEdge=null;const r=arguments[0];this._subdiv=r,this.init()}init(){this._lastEdge=this.findEdge()}locate(r){this._lastEdge.isLive()||this.init();const a=this._subdiv.locateFromEdge(r,this._lastEdge);return this._lastEdge=a,a}findEdge(){return this._subdiv.getEdges().iterator().next()}get interfaces_(){return[da]}}class fl{constructor(){fl.constructor_.apply(this,arguments)}static constructor_(){if(this._ls=null,this._data=null,arguments.length===2){const r=arguments[0],a=arguments[1];this._ls=new gr(r,a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._ls=new gr(r,a),this._data=p}else if(arguments.length===6){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5];fl.constructor_.call(this,new O(r,a,p),new O(_,C,k))}else if(arguments.length===7){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=arguments[4],k=arguments[5],X=arguments[6];fl.constructor_.call(this,new O(r,a,p),new O(_,C,k),X)}}getStartZ(){return this._ls.getCoordinate(0).getZ()}intersection(r){return this._ls.intersection(r.getLineSegment())}getStart(){return this._ls.getCoordinate(0)}getEnd(){return this._ls.getCoordinate(1)}getEndY(){return this._ls.getCoordinate(1).y}getStartX(){return this._ls.getCoordinate(0).x}setData(r){this._data=r}getData(){return this._data}getEndX(){return this._ls.getCoordinate(1).x}toString(){return this._ls.toString()}getLineSegment(){return this._ls}getEndZ(){return this._ls.getCoordinate(1).getZ()}equalsTopo(r){return this._ls.equalsTopo(r.getLineSegment())}getStartY(){return this._ls.getCoordinate(0).y}}class Oo{constructor(){Oo.constructor_.apply(this,arguments)}static constructor_(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;const r=arguments[0];this._seg=r,this._segLen=r.getLength()}static pointAlongReverse(r,a){const p=new O;return p.x=r.p1.x-a*(r.p1.x-r.p0.x),p.y=r.p1.y-a*(r.p1.y-r.p0.y),p}splitAt(){if(arguments.length===1){const r=arguments[0],a=this._minimumLen/this._segLen;if(r.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(a),null;if(r.distance(this._seg.p1)<this._minimumLen)return this._splitPt=Oo.pointAlongReverse(this._seg,a),null;this._splitPt=r}else if(arguments.length===2){const r=arguments[0],a=arguments[1],p=this.getConstrainedLength(r)/this._segLen;a.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(p):this._splitPt=Oo.pointAlongReverse(this._seg,p)}}getSplitPoint(){return this._splitPt}getConstrainedLength(r){return r<this._minimumLen?this._minimumLen:r}setMinimumLength(r){this._minimumLen=r}}class su{findSplitPoint(r,a){}}class au{static projectedSplitPoint(r,a){return r.getLineSegment().project(a)}findSplitPoint(r,a){const p=r.getLineSegment(),_=p.getLength()/2,C=new Oo(p),k=au.projectedSplitPoint(r,a);let X=2*k.distance(a)*.8;return X>_&&(X=_),C.setMinimumLength(X),C.splitAt(k),C.getSplitPoint()}get interfaces_(){return[su]}}class fo{static checkRobustInCircle(r,a,p,_){const C=fo.isInCircleNonRobust(r,a,p,_),k=fo.isInCircleDDSlow(r,a,p,_),X=fo.isInCircleCC(r,a,p,_),J=qi.circumcentre(r,a,p);ne.out.println("p radius diff a = "+Math.abs(_.distance(J)-r.distance(J))/r.distance(J)),C===k&&C===X||(ne.out.println("inCircle robustness failure (double result = "+C+", DD result = "+k+", CC result = "+X+")"),ne.out.println(vi.toLineString(new ye([r,a,p,_]))),ne.out.println("Circumcentre = "+vi.toPoint(J)+" radius = "+r.distance(J)),ne.out.println("p radius diff a = "+Math.abs(_.distance(J)/r.distance(J)-1)),ne.out.println("p radius diff b = "+Math.abs(_.distance(J)/a.distance(J)-1)),ne.out.println("p radius diff c = "+Math.abs(_.distance(J)/p.distance(J)-1)),ne.out.println())}static isInCircleDDFast(r,a,p,_){const C=Lt.sqr(r.x).selfAdd(Lt.sqr(r.y)).selfMultiply(fo.triAreaDDFast(a,p,_)),k=Lt.sqr(a.x).selfAdd(Lt.sqr(a.y)).selfMultiply(fo.triAreaDDFast(r,p,_)),X=Lt.sqr(p.x).selfAdd(Lt.sqr(p.y)).selfMultiply(fo.triAreaDDFast(r,a,_)),J=Lt.sqr(_.x).selfAdd(Lt.sqr(_.y)).selfMultiply(fo.triAreaDDFast(r,a,p));return C.selfSubtract(k).selfAdd(X).selfSubtract(J).doubleValue()>0}static isInCircleCC(r,a,p,_){const C=qi.circumcentre(r,a,p),k=r.distance(C);return _.distance(C)-k<=0}static isInCircleNormalized(r,a,p,_){const C=r.x-_.x,k=r.y-_.y,X=a.x-_.x,J=a.y-_.y,Ct=p.x-_.x,te=p.y-_.y;return(C*C+k*k)*(X*te-Ct*J)+(X*X+J*J)*(Ct*k-C*te)+(Ct*Ct+te*te)*(C*J-X*k)>0}static isInCircleDDSlow(r,a,p,_){const C=Lt.valueOf(_.x),k=Lt.valueOf(_.y),X=Lt.valueOf(r.x),J=Lt.valueOf(r.y),Ct=Lt.valueOf(a.x),te=Lt.valueOf(a.y),ce=Lt.valueOf(p.x),Ye=Lt.valueOf(p.y),sr=X.multiply(X).add(J.multiply(J)).multiply(fo.triAreaDDSlow(Ct,te,ce,Ye,C,k)),Cr=Ct.multiply(Ct).add(te.multiply(te)).multiply(fo.triAreaDDSlow(X,J,ce,Ye,C,k)),Ii=ce.multiply(ce).add(Ye.multiply(Ye)).multiply(fo.triAreaDDSlow(X,J,Ct,te,C,k)),Vn=C.multiply(C).add(k.multiply(k)).multiply(fo.triAreaDDSlow(X,J,Ct,te,ce,Ye));return sr.subtract(Cr).add(Ii).subtract(Vn).doubleValue()>0}static isInCircleNonRobust(r,a,p,_){return(r.x*r.x+r.y*r.y)*fo.triArea(a,p,_)-(a.x*a.x+a.y*a.y)*fo.triArea(r,p,_)+(p.x*p.x+p.y*p.y)*fo.triArea(r,a,_)-(_.x*_.x+_.y*_.y)*fo.triArea(r,a,p)>0}static isInCircleRobust(r,a,p,_){return fo.isInCircleNormalized(r,a,p,_)}static triAreaDDSlow(r,a,p,_,C,k){return p.subtract(r).multiply(k.subtract(a)).subtract(_.subtract(a).multiply(C.subtract(r)))}static triAreaDDFast(r,a,p){const _=Lt.valueOf(a.x).selfSubtract(r.x).selfMultiply(Lt.valueOf(p.y).selfSubtract(r.y)),C=Lt.valueOf(a.y).selfSubtract(r.y).selfMultiply(Lt.valueOf(p.x).selfSubtract(r.x));return _.selfSubtract(C)}static triArea(r,a,p){return(a.x-r.x)*(p.y-r.y)-(a.y-r.y)*(p.x-r.x)}static isInCircleDDNormalized(r,a,p,_){const C=Lt.valueOf(r.x).selfSubtract(_.x),k=Lt.valueOf(r.y).selfSubtract(_.y),X=Lt.valueOf(a.x).selfSubtract(_.x),J=Lt.valueOf(a.y).selfSubtract(_.y),Ct=Lt.valueOf(p.x).selfSubtract(_.x),te=Lt.valueOf(p.y).selfSubtract(_.y),ce=C.multiply(J).selfSubtract(X.multiply(k)),Ye=X.multiply(te).selfSubtract(Ct.multiply(J)),sr=Ct.multiply(k).selfSubtract(C.multiply(te)),Cr=C.multiply(C).selfAdd(k.multiply(k)),Ii=X.multiply(X).selfAdd(J.multiply(J)),Vn=Ct.multiply(Ct).selfAdd(te.multiply(te));return Cr.selfMultiply(Ye).selfAdd(Ii.selfMultiply(sr)).selfAdd(Vn.selfMultiply(ce)).doubleValue()>0}}class Ji{constructor(){Ji.constructor_.apply(this,arguments)}static constructor_(){if(this._p=null,arguments.length===1){const r=arguments[0];this._p=new O(r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._p=new O(r,a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._p=new O(r,a,p)}}static interpolateZ(){if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2],_=a.distance(p),C=r.distance(a),k=p.getZ()-a.getZ();return a.getZ()+k*(C/_)}if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3],C=a.x,k=a.y,X=p.x-C,J=_.x-C,Ct=p.y-k,te=_.y-k,ce=X*te-J*Ct,Ye=r.x-C,sr=r.y-k,Cr=(te*Ye-J*sr)/ce,Ii=(-Ct*Ye+X*sr)/ce;return a.getZ()+Cr*(p.getZ()-a.getZ())+Ii*(_.getZ()-a.getZ())}}magn(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}equals(){if(arguments.length===1){const r=arguments[0];return this._p.x===r.getX()&&this._p.y===r.getY()}if(arguments.length===2){const r=arguments[0],a=arguments[1];return this._p.distance(r.getCoordinate())<a}}rightOf(r){return this.isCCW(r.dest(),r.orig())}isCCW(r,a){return(r._p.x-this._p.x)*(a._p.y-this._p.y)-(r._p.y-this._p.y)*(a._p.x-this._p.x)>0}getX(){return this._p.x}crossProduct(r){return this._p.x*r.getY()-this._p.y*r.getX()}setZ(r){this._p.setZ(r)}times(r){return new Ji(r*this._p.x,r*this._p.y)}cross(){return new Ji(this._p.y,-this._p.x)}leftOf(r){return this.isCCW(r.orig(),r.dest())}getY(){return this._p.y}classify(r,a){const p=this,_=a.sub(r),C=p.sub(r),k=_.crossProduct(C);return k>0?Ji.LEFT:k<0?Ji.RIGHT:_.getX()*C.getX()<0||_.getY()*C.getY()<0?Ji.BEHIND:_.magn()<C.magn()?Ji.BEYOND:r.equals(p)?Ji.ORIGIN:a.equals(p)?Ji.DESTINATION:Ji.BETWEEN}circumRadiusRatio(r,a){const p=this.circleCenter(r,a),_=this.distance(p,r);let C=this.distance(this,r),k=this.distance(r,a);return k<C&&(C=k),k=this.distance(a,this),k<C&&(C=k),_/C}circleCenter(r,a){const p=new Ji(this.getX(),this.getY()),_=this.bisector(p,r),C=this.bisector(r,a),k=new In(_,C);let X=null;try{X=new Ji(k.getX(),k.getY())}catch(J){if(!(J instanceof Vs))throw J;ne.err.println("a: "+p+"  b: "+r+"  c: "+a),ne.err.println(J)}return X}dot(r){return this._p.x*r.getX()+this._p.y*r.getY()}getZ(){return this._p.getZ()}bisector(r,a){const p=a.getX()-r.getX(),_=a.getY()-r.getY(),C=new In(r.getX()+p/2,r.getY()+_/2,1),k=new In(r.getX()-_+p/2,r.getY()+p+_/2,1);return new In(C,k)}getCoordinate(){return this._p}isInCircle(r,a,p){return fo.isInCircleRobust(r._p,a._p,p._p,this._p)}interpolateZValue(r,a,p){const _=r.getX(),C=r.getY(),k=a.getX()-_,X=p.getX()-_,J=a.getY()-C,Ct=p.getY()-C,te=k*Ct-X*J,ce=this.getX()-_,Ye=this.getY()-C,sr=(Ct*ce-X*Ye)/te,Cr=(-J*ce+k*Ye)/te;return r.getZ()+sr*(a.getZ()-r.getZ())+Cr*(p.getZ()-r.getZ())}midPoint(r){const a=(this._p.x+r.getX())/2,p=(this._p.y+r.getY())/2,_=(this._p.getZ()+r.getZ())/2;return new Ji(a,p,_)}toString(){return"POINT ("+this._p.x+" "+this._p.y+")"}sub(r){return new Ji(this._p.x-r.getX(),this._p.y-r.getY())}sum(r){return new Ji(this._p.x+r.getX(),this._p.y+r.getY())}distance(r,a){return Math.sqrt(Math.pow(a.getX()-r.getX(),2)+Math.pow(a.getY()-r.getY(),2))}}Ji.LEFT=0,Ji.RIGHT=1,Ji.BEYOND=2,Ji.BEHIND=3,Ji.BETWEEN=4,Ji.ORIGIN=5,Ji.DESTINATION=6;class Dl extends Ji{constructor(){super(),Dl.constructor_.apply(this,arguments)}static constructor_(){this._isOnConstraint=null,this._constraint=null;const r=arguments[0];Ji.constructor_.call(this,r)}getConstraint(){return this._constraint}setOnConstraint(r){this._isOnConstraint=r}setConstraint(r){this._isOnConstraint=!0,this._constraint=r}merge(r){r._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=r._constraint)}isOnConstraint(){return this._isOnConstraint}}class Rn{constructor(){Rn.constructor_.apply(this,arguments)}static constructor_(){this._rot=null,this._vertex=null,this._next=null,this._data=null}static swap(r){const a=r.oPrev(),p=r.sym().oPrev();Rn.splice(r,a),Rn.splice(r.sym(),p),Rn.splice(r,a.lNext()),Rn.splice(r.sym(),p.lNext()),r.setOrig(a.dest()),r.setDest(p.dest())}static splice(r,a){const p=r.oNext().rot(),_=a.oNext().rot(),C=a.oNext(),k=r.oNext(),X=_.oNext(),J=p.oNext();r.setNext(C),a.setNext(k),p.setNext(X),_.setNext(J)}static makeEdge(r,a){const p=new Rn,_=new Rn,C=new Rn,k=new Rn;p._rot=_,_._rot=C,C._rot=k,k._rot=p,p.setNext(p),_.setNext(k),C.setNext(C),k.setNext(_);const X=p;return X.setOrig(r),X.setDest(a),X}static connect(r,a){const p=Rn.makeEdge(r.dest(),a.orig());return Rn.splice(p,r.lNext()),Rn.splice(p.sym(),a),p}equalsNonOriented(r){return!!this.equalsOriented(r)||!!this.equalsOriented(r.sym())}oNext(){return this._next}equalsOriented(r){return!(!this.orig().getCoordinate().equals2D(r.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(r.dest().getCoordinate()))}dNext(){return this.sym().oNext().sym()}lPrev(){return this._next.sym()}rPrev(){return this.sym().oNext()}rot(){return this._rot}oPrev(){return this._rot._next._rot}sym(){return this._rot._rot}setOrig(r){this._vertex=r}lNext(){return this.invRot().oNext().rot()}getLength(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}setData(r){this._data=r}getData(){return this._data}delete(){this._rot=null}toString(){const r=this._vertex.getCoordinate(),a=this.dest().getCoordinate();return vi.toLineString(r,a)}isLive(){return this._rot!==null}getPrimary(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}toLineSegment(){return new gr(this._vertex.getCoordinate(),this.dest().getCoordinate())}dest(){return this.sym().orig()}invRot(){return this._rot.sym()}setDest(r){this.sym().setOrig(r)}orig(){return this._vertex}rNext(){return this._rot._next.invRot()}dPrev(){return this.invRot().oNext().invRot()}setNext(r){this._next=r}}class _c{constructor(){_c.constructor_.apply(this,arguments)}static constructor_(){this._subdiv=null,this._isUsingTolerance=!1;const r=arguments[0];this._subdiv=r,this._isUsingTolerance=r.getTolerance()>0}insertSite(r){let a=this._subdiv.locate(r);if(this._subdiv.isVertexOfEdge(a,r))return a;this._subdiv.isOnEdge(a,r.getCoordinate())&&(a=a.oPrev(),this._subdiv.delete(a.oNext()));let p=this._subdiv.makeEdge(a.orig(),r);Rn.splice(p,a);const _=p;do p=this._subdiv.connect(a,p.sym()),a=p.oPrev();while(a.lNext()!==_);for(;;){const C=a.oPrev();if(C.dest().rightOf(a)&&r.isInCircle(a.orig(),C.dest(),a.dest()))Rn.swap(a),a=a.oPrev();else{if(a.oNext()===_)return p;a=a.oNext().lPrev()}}}insertSites(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this.insertSite(p)}}}class ah extends E{constructor(){super(),ah.constructor_.apply(this,arguments)}static constructor_(){if(this._seg=null,arguments.length===1){if(typeof arguments[0]=="string"){const r=arguments[0];E.constructor_.call(this,r)}else if(arguments[0]instanceof gr){const r=arguments[0];E.constructor_.call(this,"Locate failed to converge (at edge: "+r+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new gr(r)}}else if(arguments.length===2){const r=arguments[0],a=arguments[1];E.constructor_.call(this,ah.msgWithSpatial(r,a)),this._seg=new gr(a)}}static msgWithSpatial(r,a){return a!==null?r+" [ "+a+" ]":r}getSegment(){return this._seg}}class lh{visit(r){}}class Is{constructor(){Is.constructor_.apply(this,arguments)}static constructor_(){this._visitedKey=0,this._quadEdges=new $,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new gr,this._triEdges=new Array(3).fill(null);const r=arguments[0],a=arguments[1];this._tolerance=a,this._edgeCoincidenceTolerance=a/Is.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(r),this._startingEdge=this.initSubdiv(),this._locator=new sh(this)}static getTriangleEdges(r,a){if(a[0]=r,a[1]=a[0].lNext(),a[2]=a[1].lNext(),a[2].lNext()!==a[0])throw new u("Edges do not form a triangle")}getTriangleVertices(r){const a=new Ws;return this.visitTriangles(a,r),a.getTriangleVertices()}isFrameVertex(r){return!!r.equals(this._frameVertex[0])||!!r.equals(this._frameVertex[1])||!!r.equals(this._frameVertex[2])}isVertexOfEdge(r,a){return!(!a.equals(r.orig(),this._tolerance)&&!a.equals(r.dest(),this._tolerance))}connect(r,a){const p=Rn.connect(r,a);return this._quadEdges.add(p),p}visitTriangles(r,a){this._visitedKey++;const p=new Bn;p.push(this._startingEdge);const _=new Be;for(;!p.empty();){const C=p.pop();if(!_.contains(C)){const k=this.fetchTriangleToVisit(C,p,a,_);k!==null&&r.visit(k)}}}isFrameEdge(r){return!(!this.isFrameVertex(r.orig())&&!this.isFrameVertex(r.dest()))}isOnEdge(r,a){return this._seg.setCoordinates(r.orig().getCoordinate(),r.dest().getCoordinate()),this._seg.distance(a)<this._edgeCoincidenceTolerance}getEnvelope(){return new nt(this._frameEnv)}getVertexUniqueEdges(r){const a=new $,p=new Be;for(let _=this._quadEdges.iterator();_.hasNext();){const C=_.next(),k=C.orig();p.contains(k)||(p.add(k),!r&&this.isFrameVertex(k)||a.add(C));const X=C.sym(),J=X.orig();p.contains(J)||(p.add(J),!r&&this.isFrameVertex(J)||a.add(X))}return a}locateFromEdge(r,a){let p=0;const _=this._quadEdges.size();let C=a;for(;;){if(p++,p>_)throw new ah(C.toLineSegment());if(r.equals(C.orig())||r.equals(C.dest()))break;if(r.rightOf(C))C=C.sym();else if(r.rightOf(C.oNext())){if(r.rightOf(C.dPrev()))break;C=C.dPrev()}else C=C.oNext()}return C}getVoronoiDiagram(r){const a=this.getVoronoiCellPolygons(r);return r.createGeometryCollection(Se.toGeometryArray(a))}getTriangles(r){const a=this.getTriangleCoordinates(!1),p=new Array(a.size()).fill(null);let _=0;for(let C=a.iterator();C.hasNext();){const k=C.next();p[_++]=r.createPolygon(r.createLinearRing(k))}return r.createGeometryCollection(p)}getVoronoiCellPolygon(r,a){const p=new $,_=r;do{const Ct=r.rot().orig().getCoordinate();p.add(Ct),r=r.oPrev()}while(r!==_);const C=new W;C.addAll(p,!1),C.closeRing(),C.size()<4&&(ne.out.println(C),C.add(C.get(C.size()-1),!0));const k=C.toCoordinateArray(),X=a.createPolygon(a.createLinearRing(k)),J=_.orig();return X.setUserData(J.getCoordinate()),X}setLocator(r){this._locator=r}initSubdiv(){const r=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),a=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);Rn.splice(r.sym(),a);const p=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return Rn.splice(a.sym(),p),Rn.splice(p.sym(),r),r}isFrameBorderEdge(r){const a=new Array(3).fill(null);Is.getTriangleEdges(r,a);const p=new Array(3).fill(null);Is.getTriangleEdges(r.sym(),p);const _=r.lNext().dest();if(this.isFrameVertex(_))return!0;const C=r.sym().lNext().dest();return!!this.isFrameVertex(C)}makeEdge(r,a){const p=Rn.makeEdge(r,a);return this._quadEdges.add(p),p}createFrame(r){const a=r.getWidth(),p=r.getHeight();let _=0;_=a>p?10*a:10*p,this._frameVertex[0]=new Ji((r.getMaxX()+r.getMinX())/2,r.getMaxY()+_),this._frameVertex[1]=new Ji(r.getMinX()-_,r.getMinY()-_),this._frameVertex[2]=new Ji(r.getMaxX()+_,r.getMinY()-_),this._frameEnv=new nt(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}getTriangleCoordinates(r){const a=new lu;return this.visitTriangles(a,r),a.getTriangles()}getVertices(r){const a=new Be;for(let p=this._quadEdges.iterator();p.hasNext();){const _=p.next(),C=_.orig();!r&&this.isFrameVertex(C)||a.add(C);const k=_.dest();!r&&this.isFrameVertex(k)||a.add(k)}return a}fetchTriangleToVisit(r,a,p,_){let C=r,k=0,X=!1;do{this._triEdges[k]=C,this.isFrameEdge(C)&&(X=!0);const J=C.sym();_.contains(J)||a.push(J),_.add(C),k++,C=C.lNext()}while(C!==r);return X&&!p?null:this._triEdges}getEdges(){if(arguments.length===0)return this._quadEdges;if(arguments.length===1){const r=arguments[0],a=this.getPrimaryEdges(!1),p=new Array(a.size()).fill(null);let _=0;for(let C=a.iterator();C.hasNext();){const k=C.next();p[_++]=r.createLineString([k.orig().getCoordinate(),k.dest().getCoordinate()])}return r.createMultiLineString(p)}}getTriangleEdges(r){const a=new ch;return this.visitTriangles(a,r),a.getTriangleEdges()}getPrimaryEdges(r){this._visitedKey++;const a=new $,p=new Bn;p.push(this._startingEdge);const _=new Be;for(;!p.empty();){const C=p.pop();if(!_.contains(C)){const k=C.getPrimary();!r&&this.isFrameEdge(k)||a.add(k),p.push(C.oNext()),p.push(C.sym().oNext()),_.add(C),_.add(C.sym())}}return a}delete(r){Rn.splice(r,r.oPrev()),Rn.splice(r.sym(),r.sym().oPrev());const a=r.sym(),p=r.rot(),_=r.rot().sym();this._quadEdges.remove(r),this._quadEdges.remove(a),this._quadEdges.remove(p),this._quadEdges.remove(_),r.delete(),a.delete(),p.delete(),_.delete()}getTolerance(){return this._tolerance}getVoronoiCellPolygons(r){this.visitTriangles(new ap,!0);const a=new $;for(let p=this.getVertexUniqueEdges(!1).iterator();p.hasNext();){const _=p.next();a.add(this.getVoronoiCellPolygon(_,r))}return a}insertSite(r){let a=this.locate(r);if(r.equals(a.orig(),this._tolerance)||r.equals(a.dest(),this._tolerance))return a;let p=this.makeEdge(a.orig(),r);Rn.splice(p,a);const _=p;do p=this.connect(a,p.sym()),a=p.oPrev();while(a.lNext()!==_);return _}locate(){if(arguments.length===1){if(arguments[0]instanceof Ji){const r=arguments[0];return this._locator.locate(r)}if(arguments[0]instanceof O){const r=arguments[0];return this._locator.locate(new Ji(r))}}else if(arguments.length===2){const r=arguments[0],a=arguments[1],p=this._locator.locate(new Ji(r));if(p===null)return null;let _=p;p.dest().getCoordinate().equals2D(r)&&(_=p.sym());let C=_;do{if(C.dest().getCoordinate().equals2D(a))return C;C=C.oNext()}while(C!==_);return null}}}class ap{visit(r){const a=r[0].orig().getCoordinate(),p=r[1].orig().getCoordinate(),_=r[2].orig().getCoordinate(),C=qi.circumcentreDD(a,p,_),k=new Ji(C);for(let X=0;X<3;X++)r[X].rot().setOrig(k)}get interfaces_(){return[lh]}}class ch{constructor(){ch.constructor_.apply(this,arguments)}static constructor_(){this._triList=new $}getTriangleEdges(){return this._triList}visit(r){this._triList.add(r)}get interfaces_(){return[lh]}}class Ws{constructor(){Ws.constructor_.apply(this,arguments)}static constructor_(){this._triList=new $}getTriangleVertices(){return this._triList}visit(r){this._triList.add([r[0].orig(),r[1].orig(),r[2].orig()])}get interfaces_(){return[lh]}}class lu{constructor(){lu.constructor_.apply(this,arguments)}static constructor_(){this._coordList=new W,this._triCoords=new $}checkTriangleSize(r){r.length>=2?vi.toLineString(r[0],r[1]):r.length>=1&&vi.toPoint(r[0])}visit(r){this._coordList.clear();for(let a=0;a<3;a++){const p=r[a].orig();this._coordList.add(p.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();const a=this._coordList.toCoordinateArray();if(a.length!==4)return null;this._triCoords.add(a)}}getTriangles(){return this._triCoords}get interfaces_(){return[lh]}}Is.TriangleCircumcentreVisitor=ap,Is.TriangleEdgesListVisitor=ch,Is.TriangleVertexListVisitor=Ws,Is.TriangleCoordinatesVisitor=lu,Is.EDGE_COINCIDENCE_TOL_FACTOR=1e3;class Gl extends E{constructor(){super(),Gl.constructor_.apply(this,arguments)}static constructor_(){if(this._pt=null,arguments.length===1){const r=arguments[0];E.constructor_.call(this,r)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];E.constructor_.call(this,Gl.msgWithCoord(r,a)),this._pt=new O(a)}}static msgWithCoord(r,a){return a!==null?r+" [ "+vi.toPoint(a)+" ]":r}getCoordinate(){return this._pt}}class jl{constructor(){jl.constructor_.apply(this,arguments)}static constructor_(){this._initialVertices=null,this._segVertices=null,this._segments=new $,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new au,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;const r=arguments[0],a=arguments[1];this._initialVertices=new $(r),this._tolerance=a,this._kdt=new Tl(a)}static computeVertexEnvelope(r){const a=new nt;for(let p=r.iterator();p.hasNext();){const _=p.next();a.expandToInclude(_.getCoordinate())}return a}getInitialVertices(){return this._initialVertices}getKDT(){return this._kdt}setConstraints(r,a){this._segments=r,this._segVertices=a}computeConvexHull(){const r=new Se,a=this.getPointArray(),p=new aa(a,r);this._convexHull=p.getConvexHull()}addConstraintVertices(){this.computeConvexHull(),this.insertSites(this._segVertices)}getTolerance(){return this._tolerance}setVertexFactory(r){this._vertexFactory=r}formInitialDelaunay(){this.computeBoundingBox(),this._subdiv=new Is(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new sh(this._subdiv)),this._incDel=new _c(this._subdiv),this.insertSites(this._initialVertices)}insertSite(){if(arguments[0]instanceof Dl){const r=arguments[0],a=this._kdt.insert(r.getCoordinate(),r);if(a.isRepeated()){const p=a.getData();return p.merge(r),p}return this._incDel.insertSite(r),r}if(arguments[0]instanceof O){const r=arguments[0];this.insertSite(this.createVertex(r))}}enforceConstraints(){this.addConstraintVertices();let r=0,a=0;do a=this.enforceGabriel(this._segments),r++;while(a>0&&r<jl.MAX_SPLIT_ITER);if(r===jl.MAX_SPLIT_ITER)throw new Gl("Too many splitting iterations while enforcing constraints.  Last split point was at: ",this._splitPt)}insertSites(r){for(let a=r.iterator();a.hasNext();){const p=a.next();this.insertSite(p)}}getVertexFactory(){return this._vertexFactory}getPointArray(){const r=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null);let a=0;for(let p=this._initialVertices.iterator();p.hasNext();){const _=p.next();r[a++]=_.getCoordinate()}for(let p=this._segVertices.iterator();p.hasNext();){const _=p.next();r[a++]=_.getCoordinate()}return r}findNonGabrielPoint(r){const a=r.getStart(),p=r.getEnd(),_=new O((a.x+p.x)/2,(a.y+p.y)/2),C=a.distance(_),k=new nt(_);k.expandBy(C);const X=this._kdt.query(k);let J=null,Ct=m.MAX_VALUE;for(let te=X.iterator();te.hasNext();){const ce=te.next().getCoordinate();if(ce.equals2D(a)||ce.equals2D(p))continue;const Ye=_.distance(ce);Ye<C&&(J===null||Ye<Ct)&&(J=ce,Ct=Ye)}return J}getConstraintSegments(){return this._segments}setSplitPointFinder(r){this._splitFinder=r}getConvexHull(){return this._convexHull}enforceGabriel(r){const a=new $;let p=0;const _=new $;for(let C=r.iterator();C.hasNext();){const k=C.next(),X=this.findNonGabrielPoint(k);if(X===null)continue;this._splitPt=this._splitFinder.findSplitPoint(k,X);const J=this.createVertex(this._splitPt,k);this.insertSite(J).getCoordinate().equals2D(this._splitPt);const Ct=new fl(k.getStartX(),k.getStartY(),k.getStartZ(),J.getX(),J.getY(),J.getZ(),k.getData()),te=new fl(J.getX(),J.getY(),J.getZ(),k.getEndX(),k.getEndY(),k.getEndZ(),k.getData());a.add(Ct),a.add(te),_.add(k),p+=1}return r.removeAll(_),r.addAll(a),p}createVertex(){if(arguments.length===1){const r=arguments[0];let a=null;return a=this._vertexFactory!==null?this._vertexFactory.createVertex(r,null):new Dl(r),a}if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=null;return p=this._vertexFactory!==null?this._vertexFactory.createVertex(r,a):new Dl(r),p.setOnConstraint(!0),p}}getSubdivision(){return this._subdiv}computeBoundingBox(){const r=jl.computeVertexEnvelope(this._initialVertices),a=jl.computeVertexEnvelope(this._segVertices),p=new nt(r);p.expandToInclude(a);const _=.2*p.getWidth(),C=.2*p.getHeight(),k=Math.max(_,C);this._computeAreaEnv=new nt(p),this._computeAreaEnv.expandBy(k)}}jl.MAX_SPLIT_ITER=99;class go{constructor(){go.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null}static envelope(r){const a=new nt;for(let p=r.iterator();p.hasNext();){const _=p.next();a.expandToInclude(_)}return a}static unique(r){const a=De.copyDeep(r);return Ft.sort(a),new W(a,!1)}static extractUniqueCoordinates(r){if(r===null)return new W;const a=r.getCoordinates();return go.unique(a)}static toVertices(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();a.add(new Ji(_))}return a}create(){if(this._subdiv!==null)return null;const r=go.envelope(this._siteCoords),a=go.toVertices(this._siteCoords);this._subdiv=new Is(r,this._tolerance),new _c(this._subdiv).insertSites(a)}setTolerance(r){this._tolerance=r}setSites(){if(arguments[0]instanceof oe){const r=arguments[0];this._siteCoords=go.extractUniqueCoordinates(r)}else if(pt(arguments[0],T)){const r=arguments[0];this._siteCoords=go.unique(De.toCoordinateArray(r))}}getEdges(r){return this.create(),this._subdiv.getEdges(r)}getSubdivision(){return this.create(),this._subdiv}getTriangles(r){return this.create(),this._subdiv.getTriangles(r)}}class uh{constructor(){uh.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new R}static createConstraintSegments(){if(arguments.length===1){const r=arguments[0],a=ke.getLines(r),p=new $;for(let _=a.iterator();_.hasNext();){const C=_.next();uh.createConstraintSegments(C,p)}return p}if(arguments.length===2){const r=arguments[1],a=arguments[0].getCoordinates();for(let p=1;p<a.length;p++)r.add(new fl(a[p-1],a[p]))}}createSiteVertices(r){const a=new $;for(let p=r.iterator();p.hasNext();){const _=p.next();this._constraintVertexMap.containsKey(_)||a.add(new Dl(_))}return a}create(){if(this._subdiv!==null)return null;const r=go.envelope(this._siteCoords);let a=new $;this._constraintLines!==null&&(r.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),a=uh.createConstraintSegments(this._constraintLines));const p=this.createSiteVertices(this._siteCoords),_=new jl(p,this._tolerance);_.setConstraints(a,new $(this._constraintVertexMap.values())),_.formInitialDelaunay(),_.enforceConstraints(),this._subdiv=_.getSubdivision()}setTolerance(r){this._tolerance=r}setConstraints(r){this._constraintLines=r}setSites(r){this._siteCoords=go.extractUniqueCoordinates(r)}getEdges(r){return this.create(),this._subdiv.getEdges(r)}getSubdivision(){return this.create(),this._subdiv}getTriangles(r){return this.create(),this._subdiv.getTriangles(r)}createVertices(r){const a=r.getCoordinates();for(let p=0;p<a.length;p++){const _=new Dl(a[p]);this._constraintVertexMap.put(a[p],_)}}}class Ms{constructor(){Ms.constructor_.apply(this,arguments)}static constructor_(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null}static clipGeometryCollection(r,a){const p=r.getFactory().toGeometry(a),_=new $;for(let C=0;C<r.getNumGeometries();C++){const k=r.getGeometryN(C);let X=null;a.contains(k.getEnvelopeInternal())?X=k:a.intersects(k.getEnvelopeInternal())&&(X=Ir.intersection(p,k),X.setUserData(k.getUserData())),X===null||X.isEmpty()||_.add(X)}return r.getFactory().createGeometryCollection(Se.toGeometryArray(_))}create(){if(this._subdiv!==null)return null;const r=go.envelope(this._siteCoords);if(this._diagramEnv=this._clipEnv,this._diagramEnv===null){this._diagramEnv=r;const p=this._diagramEnv.getDiameter();this._diagramEnv.expandBy(p)}const a=go.toVertices(this._siteCoords);this._subdiv=new Is(r,this._tolerance),new _c(this._subdiv).insertSites(a)}setSites(){if(arguments[0]instanceof oe){const r=arguments[0];this._siteCoords=go.extractUniqueCoordinates(r)}else if(pt(arguments[0],T)){const r=arguments[0];this._siteCoords=go.unique(De.toCoordinateArray(r))}}setClipEnvelope(r){this._clipEnv=r}getSubdivision(){return this.create(),this._subdiv}getDiagram(r){this.create();const a=this._subdiv.getVoronoiDiagram(r);return Ms.clipGeometryCollection(a,this._diagramEnv)}setTolerance(r){this._tolerance=r}}var zi=Object.freeze({__proto__:null,Vertex:Ji}),lp=Object.freeze({__proto__:null,ConformingDelaunayTriangulationBuilder:uh,DelaunayTriangulationBuilder:go,VoronoiDiagramBuilder:Ms,quadedge:zi});class Ls{constructor(){Ls.constructor_.apply(this,arguments)}static constructor_(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,arguments.length===1){const r=arguments[0];Ls.constructor_.call(this,r,0,0)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];Ls.constructor_.call(this,r,a.getComponentIndex(),Ls.segmentEndVertexIndex(a))}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];if(!pt(r,vr))throw new u("Lineal geometry is required");this._linearGeom=r,this._numLines=r.getNumGeometries(),this._componentIndex=a,this._vertexIndex=p,this.loadCurrentLine()}}static segmentEndVertexIndex(r){return r.getSegmentFraction()>0?r.getSegmentIndex()+1:r.getSegmentIndex()}getComponentIndex(){return this._componentIndex}getLine(){return this._currentLine}getVertexIndex(){return this._vertexIndex}getSegmentEnd(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}next(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}loadCurrentLine(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}getSegmentStart(){return this._currentLine.getCoordinateN(this._vertexIndex)}isEndOfLine(){return!(this._componentIndex>=this._numLines)&&!(this._vertexIndex<this._currentLine.getNumPoints()-1)}hasNext(){return!(this._componentIndex>=this._numLines)&&!(this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}}class Bl{constructor(){Bl.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r}static indexOf(r,a){return new Bl(r).indexOf(a)}static indexOfAfter(r,a,p){return new Bl(r).indexOfAfter(a,p)}segmentNearestMeasure(r,a,p){const _=r.projectionFactor(a);return _<=0?p:_<=1?p+_*r.getLength():p+r.getLength()}indexOfFromStart(r,a){let p=m.MAX_VALUE,_=a,C=0;const k=new gr,X=new Ls(this._linearGeom);for(;X.hasNext();){if(!X.isEndOfLine()){k.p0=X.getSegmentStart(),k.p1=X.getSegmentEnd();const J=k.distance(r),Ct=this.segmentNearestMeasure(k,r,C);J<p&&Ct>a&&(_=Ct,p=J),C+=k.getLength()}X.next()}return _}indexOf(r){return this.indexOfFromStart(r,-1)}indexOfAfter(r,a){if(a<0)return this.indexOf(r);const p=this._linearGeom.getLength();if(p<a)return p;const _=this.indexOfFromStart(r,a);return L.isTrue(_>=a,"computed index is before specified minimum index"),_}}class cp{constructor(){cp.constructor_.apply(this,arguments)}static constructor_(){this._geomFact=null,this._lines=new $,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;const r=arguments[0];this._geomFact=r}getGeometry(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}getLastCoordinate(){return this._lastPt}endLine(){if(this._coordList===null)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;const r=this._coordList.toCoordinateArray();let a=r;this._fixInvalidLines&&(a=this.validCoordinateSequence(r)),this._coordList=null;let p=null;try{p=this._geomFact.createLineString(a)}catch(_){if(!(_ instanceof u)||!this._ignoreInvalidLines)throw _}p!==null&&this._lines.add(p)}setFixInvalidLines(r){this._fixInvalidLines=r}add(){if(arguments.length===1){const r=arguments[0];this.add(r,!0)}else if(arguments.length===2){const r=arguments[0],a=arguments[1];this._coordList===null&&(this._coordList=new W),this._coordList.add(r,a),this._lastPt=r}}setIgnoreInvalidLines(r){this._ignoreInvalidLines=r}validCoordinateSequence(r){return r.length>=2?r:[r[0],r[0]]}}class hh{constructor(){hh.constructor_.apply(this,arguments)}static constructor_(){this._line=null;const r=arguments[0];this._line=r}static extract(r,a,p){return new hh(r).extract(a,p)}extract(r,a){return a.compareTo(r)<0?this.reverse(this.computeLinear(a,r)):this.computeLinear(r,a)}computeLine(r,a){const p=this._line.getCoordinates(),_=new W;let C=r.getSegmentIndex();r.getSegmentFraction()>0&&(C+=1);let k=a.getSegmentIndex();a.getSegmentFraction()===1&&(k+=1),k>=p.length&&(k=p.length-1),r.isVertex()||_.add(r.getCoordinate(this._line));for(let J=C;J<=k;J++)_.add(p[J]);a.isVertex()||_.add(a.getCoordinate(this._line)),_.size()<=0&&_.add(r.getCoordinate(this._line));let X=_.toCoordinateArray();return X.length<=1&&(X=[X[0],X[0]]),this._line.getFactory().createLineString(X)}reverse(r){return pt(r,vr)?r.reverse():(L.shouldNeverReachHere("non-linear geometry encountered"),null)}computeLinear(r,a){const p=new cp(this._line.getFactory());p.setFixInvalidLines(!0),r.isVertex()||p.add(r.getCoordinate(this._line));for(let _=new Ls(this._line,r);_.hasNext()&&!(a.compareLocationValues(_.getComponentIndex(),_.getVertexIndex(),0)<0);_.next()){const C=_.getSegmentStart();p.add(C),_.isEndOfLine()&&p.endLine()}return a.isVertex()||p.add(a.getCoordinate(this._line)),p.getGeometry()}}class jn{constructor(){jn.constructor_.apply(this,arguments)}static constructor_(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this._componentIndex=r._componentIndex,this._segmentIndex=r._segmentIndex,this._segmentFraction=r._segmentFraction}else if(arguments.length===2){const r=arguments[0],a=arguments[1];jn.constructor_.call(this,0,r,a)}else if(arguments.length===3){const r=arguments[0],a=arguments[1],p=arguments[2];this._componentIndex=r,this._segmentIndex=a,this._segmentFraction=p,this.normalize()}else if(arguments.length===4){const r=arguments[0],a=arguments[1],p=arguments[2],_=arguments[3];this._componentIndex=r,this._segmentIndex=a,this._segmentFraction=p,_&&this.normalize()}}}static numSegments(r){const a=r.getNumPoints();return a<=1?0:a-1}static compareLocationValues(r,a,p,_,C,k){return r<_?-1:r>_?1:a<C?-1:a>C?1:p<k?-1:p>k?1:0}static pointAlongSegmentByFraction(r,a,p){if(p<=0)return r;if(p>=1)return a;const _=(a.x-r.x)*p+r.x,C=(a.y-r.y)*p+r.y,k=(a.getZ()-r.getZ())*p+r.getZ();return new O(_,C,k)}static getEndLocation(r){const a=new jn;return a.setToEnd(r),a}getSegmentIndex(){return this._segmentIndex}getComponentIndex(){return this._componentIndex}getSegmentFraction(){return this._segmentFraction}setToEnd(r){this._componentIndex=r.getNumGeometries()-1;const a=r.getGeometryN(this._componentIndex);this._segmentIndex=jn.numSegments(a),this._segmentFraction=0}compareTo(r){const a=r;return this._componentIndex<a._componentIndex?-1:this._componentIndex>a._componentIndex?1:this._segmentIndex<a._segmentIndex?-1:this._segmentIndex>a._segmentIndex?1:this._segmentFraction<a._segmentFraction?-1:this._segmentFraction>a._segmentFraction?1:0}copy(){return new jn(this._componentIndex,this._segmentIndex,this._segmentFraction)}toString(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}compareLocationValues(r,a,p){return this._componentIndex<r?-1:this._componentIndex>r?1:this._segmentIndex<a?-1:this._segmentIndex>a?1:this._segmentFraction<p?-1:this._segmentFraction>p?1:0}getSegmentLength(r){const a=r.getGeometryN(this._componentIndex);let p=this._segmentIndex;this._segmentIndex>=jn.numSegments(a)&&(p=a.getNumPoints()-2);const _=a.getCoordinateN(p),C=a.getCoordinateN(p+1);return _.distance(C)}isVertex(){return this._segmentFraction<=0||this._segmentFraction>=1}isEndpoint(r){const a=r.getGeometryN(this._componentIndex),p=jn.numSegments(a);return this._segmentIndex>=p||this._segmentIndex===p-1&&this._segmentFraction>=1}isValid(r){if(this._componentIndex<0||this._componentIndex>=r.getNumGeometries())return!1;const a=r.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>a.getNumPoints())&&(this._segmentIndex!==a.getNumPoints()||this._segmentFraction===0)&&!(this._segmentFraction<0||this._segmentFraction>1)}normalize(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),this._segmentFraction===1&&(this._segmentFraction=0,this._segmentIndex+=1)}toLowest(r){const a=r.getGeometryN(this._componentIndex),p=jn.numSegments(a);return this._segmentIndex<p?this:new jn(this._componentIndex,p-1,1,!1)}getCoordinate(r){const a=r.getGeometryN(this._componentIndex),p=a.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=jn.numSegments(a))return p;const _=a.getCoordinateN(this._segmentIndex+1);return jn.pointAlongSegmentByFraction(p,_,this._segmentFraction)}getSegment(r){const a=r.getGeometryN(this._componentIndex),p=a.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=jn.numSegments(a)){const C=a.getCoordinateN(a.getNumPoints()-2);return new gr(C,p)}const _=a.getCoordinateN(this._segmentIndex+1);return new gr(p,_)}clamp(r){if(this._componentIndex>=r.getNumGeometries())return this.setToEnd(r),null;if(this._segmentIndex>=r.getNumPoints()){const a=r.getGeometryN(this._componentIndex);this._segmentIndex=jn.numSegments(a),this._segmentFraction=1}}isOnSameSegment(r){return this._componentIndex===r._componentIndex&&(this._segmentIndex===r._segmentIndex||r._segmentIndex-this._segmentIndex==1&&r._segmentFraction===0||this._segmentIndex-r._segmentIndex==1&&this._segmentFraction===0)}snapToVertex(r,a){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;const p=this.getSegmentLength(r),_=this._segmentFraction*p,C=p-_;_<=C&&_<a?this._segmentFraction=0:C<=_&&C<a&&(this._segmentFraction=1)}get interfaces_(){return[g]}}class ga{constructor(){ga.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r}static indexOf(r,a){return new ga(r).indexOf(a)}static indexOfAfter(r,a,p){return new ga(r).indexOfAfter(a,p)}indexOfFromStart(r,a){let p=m.MAX_VALUE,_=0,C=0,k=-1;const X=new gr;for(let J=new Ls(this._linearGeom);J.hasNext();J.next())if(!J.isEndOfLine()){X.p0=J.getSegmentStart(),X.p1=J.getSegmentEnd();const Ct=X.distance(r),te=X.segmentFraction(r),ce=J.getComponentIndex(),Ye=J.getVertexIndex();Ct<p&&(a===null||a.compareLocationValues(ce,Ye,te)<0)&&(_=ce,C=Ye,k=te,p=Ct)}return p===m.MAX_VALUE?new jn(a):new jn(_,C,k)}indexOf(r){return this.indexOfFromStart(r,null)}indexOfAfter(r,a){if(a===null)return this.indexOf(r);const p=jn.getEndLocation(this._linearGeom);if(p.compareTo(a)<=0)return p;const _=this.indexOfFromStart(r,a);return L.isTrue(_.compareTo(a)>=0,"computed location is before specified minimum location"),_}}class ph{constructor(){ph.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r}static indicesOf(r,a){return new ph(r).indicesOf(a)}indicesOf(r){const a=r.getGeometryN(0).getCoordinateN(0),p=r.getGeometryN(r.getNumGeometries()-1),_=p.getCoordinateN(p.getNumPoints()-1),C=new ga(this._linearGeom),k=new Array(2).fill(null);return k[0]=C.indexOf(a),r.getLength()===0?k[1]=k[0].copy():k[1]=C.indexOfAfter(_,k[0]),k}}class As{constructor(){As.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r}static getLocation(){if(arguments.length===2){const r=arguments[1];return new As(arguments[0]).getLocation(r)}if(arguments.length===3){const r=arguments[1],a=arguments[2];return new As(arguments[0]).getLocation(r,a)}}static getLength(r,a){return new As(r).getLength(a)}getLocation(){if(arguments.length===1){const r=arguments[0];return this.getLocation(r,!0)}if(arguments.length===2){const r=arguments[0],a=arguments[1];let p=r;r<0&&(p=this._linearGeom.getLength()+r);const _=this.getLocationForward(p);return a?_:this.resolveHigher(_)}}getLocationForward(r){if(r<=0)return new jn;let a=0;const p=new Ls(this._linearGeom);for(;p.hasNext();){if(p.isEndOfLine()){if(a===r){const _=p.getComponentIndex(),C=p.getVertexIndex();return new jn(_,C,0)}}else{const _=p.getSegmentStart(),C=p.getSegmentEnd().distance(_);if(a+C>r){const k=(r-a)/C,X=p.getComponentIndex(),J=p.getVertexIndex();return new jn(X,J,k)}a+=C}p.next()}return jn.getEndLocation(this._linearGeom)}getLength(r){let a=0;const p=new Ls(this._linearGeom);for(;p.hasNext();){if(!p.isEndOfLine()){const _=p.getSegmentStart(),C=p.getSegmentEnd().distance(_);if(r.getComponentIndex()===p.getComponentIndex()&&r.getSegmentIndex()===p.getVertexIndex())return a+C*r.getSegmentFraction();a+=C}p.next()}return a}resolveHigher(r){if(!r.isEndpoint(this._linearGeom))return r;let a=r.getComponentIndex();if(a>=this._linearGeom.getNumGeometries()-1)return r;do a++;while(a<this._linearGeom.getNumGeometries()-1&&this._linearGeom.getGeometryN(a).getLength()===0);return new jn(a,0,0)}}class up{constructor(){up.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r}clampIndex(r){const a=this.positiveIndex(r),p=this.getStartIndex();if(a<p)return p;const _=this.getEndIndex();return a>_?_:a}locationOf(){if(arguments.length===1){const r=arguments[0];return As.getLocation(this._linearGeom,r)}if(arguments.length===2){const r=arguments[0],a=arguments[1];return As.getLocation(this._linearGeom,r,a)}}project(r){return Bl.indexOf(this._linearGeom,r)}positiveIndex(r){return r>=0?r:this._linearGeom.getLength()+r}extractPoint(){if(arguments.length===1){const r=arguments[0];return As.getLocation(this._linearGeom,r).getCoordinate(this._linearGeom)}if(arguments.length===2){const r=arguments[0],a=arguments[1],p=As.getLocation(this._linearGeom,r).toLowest(this._linearGeom);return p.getSegment(this._linearGeom).pointAlongOffset(p.getSegmentFraction(),a)}}getStartIndex(){return 0}indexOfAfter(r,a){return Bl.indexOfAfter(this._linearGeom,r,a)}extractLine(r,a){const p=this.clampIndex(r),_=this.clampIndex(a),C=p===_,k=this.locationOf(p,C),X=this.locationOf(_);return hh.extract(this._linearGeom,k,X)}isValidIndex(r){return r>=this.getStartIndex()&&r<=this.getEndIndex()}getEndIndex(){return this._linearGeom.getLength()}indexOf(r){return Bl.indexOf(this._linearGeom,r)}indicesOf(r){const a=ph.indicesOf(this._linearGeom,r);return[As.getLength(this._linearGeom,a[0]),As.getLength(this._linearGeom,a[1])]}}class hp{constructor(){hp.constructor_.apply(this,arguments)}static constructor_(){this._linearGeom=null;const r=arguments[0];this._linearGeom=r,this.checkGeometryType()}clampIndex(r){const a=r.copy();return a.clamp(this._linearGeom),a}project(r){return ga.indexOf(this._linearGeom,r)}checkGeometryType(){if(!(this._linearGeom instanceof Ee||this._linearGeom instanceof ar))throw new u("Input geometry must be linear")}extractPoint(){if(arguments.length===1)return arguments[0].getCoordinate(this._linearGeom);if(arguments.length===2){const r=arguments[1],a=arguments[0].toLowest(this._linearGeom);return a.getSegment(this._linearGeom).pointAlongOffset(a.getSegmentFraction(),r)}}getStartIndex(){return new jn}indexOfAfter(r,a){return ga.indexOfAfter(this._linearGeom,r,a)}extractLine(r,a){return hh.extract(this._linearGeom,r,a)}isValidIndex(r){return r.isValid(this._linearGeom)}getEndIndex(){return jn.getEndLocation(this._linearGeom)}indexOf(r){return ga.indexOf(this._linearGeom,r)}indicesOf(r){return ph.indicesOf(this._linearGeom,r)}}var pp=Object.freeze({__proto__:null,LengthIndexedLine:up,LengthLocationMap:As,LinearGeometryBuilder:cp,LinearIterator:Ls,LinearLocation:jn,LocationIndexedLine:hp});class fh{static transform(r,a){const p=new $;for(let _=r.iterator();_.hasNext();)p.add(a.execute(_.next()));return p}static select(r,a){const p=new $;for(let _=r.iterator();_.hasNext();){const C=_.next();Boolean.TRUE.equals(a.execute(C))&&p.add(C)}return p}static apply(r,a){for(let p=r.iterator();p.hasNext();)a.execute(p.next())}}fh.Function=function(){};class dl{constructor(){dl.constructor_.apply(this,arguments)}static constructor_(){this.pts=null,this.n=0;const r=arguments[0];this.pts=new Array(r).fill(null)}filter(r){this.pts[this.n++]=r}getCoordinates(){return this.pts}get interfaces_(){return[Ar]}}class zl{constructor(){zl.constructor_.apply(this,arguments)}static constructor_(){this._n=0}filter(r){this._n++}getCount(){return this._n}get interfaces_(){return[Ar]}}class Vl{constructor(){Vl.constructor_.apply(this,arguments)}static constructor_(){this._counts=new br}add(r){const a=this._counts.get(r);a===null?this._counts.put(r,new dh(1)):a.increment()}count(r){const a=this._counts.get(r);return a===null?0:a.count()}}class dh{constructor(){dh.constructor_.apply(this,arguments)}static constructor_(){if(this.count=0,arguments.length!==0){if(arguments.length===1){const r=arguments[0];this.count=r}}}count(){return this.count}increment(){this.count++}}Vl.Counter=dh;class Cf{constructor(){Cf.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new $,this._items.add(null)}poll(){if(this.isEmpty())return null;const r=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),r}size(){return this._size}reorder(r){let a=null;const p=this._items.get(r);for(;2*r<=this._size&&(a=2*r,a!==this._size&&this._items.get(a+1).compareTo(this._items.get(a))<0&&a++,this._items.get(a).compareTo(p)<0);r=a)this._items.set(r,this._items.get(a));this._items.set(r,p)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return this._size===0}add(r){this._items.add(null),this._size+=1;let a=this._size;for(this._items.set(0,r);r.compareTo(this._items.get(Math.trunc(a/2)))<0;a/=2)this._items.set(a,this._items.get(Math.trunc(a/2)));this._items.set(a,r)}}function Tf(){}function qd(){}function is(){}function Os(){}class Ns extends h{}class Ys{static split(r,a){const p=a.length,_=new $;let C=""+r,k=C.indexOf(a);for(;k>=0;){const J=C.substring(0,k);_.add(J),C=C.substring(k+p),k=C.indexOf(a)}C.length>0&&_.add(C);const X=new Array(_.size()).fill(null);for(let J=0;J<X.length;J++)X[J]=_.get(J);return X}static getStackTrace(){if(arguments.length===1){const r=arguments[0],a=new Os,p=new Tf;return r.printStackTrace(p),a.toString()}if(arguments.length===2){const r=arguments[0],a=arguments[1];let p="";new qd(Ys.getStackTrace(r));const _=new is;for(let C=0;C<a;C++)try{p+=_.readLine()+Ys.NEWLINE}catch(k){if(!(k instanceof Ns))throw k;L.shouldNeverReachHere()}return p}}static spaces(r){return Ys.chars(" ",r)}static chars(r,a){const p=new Array(a).fill(null);for(let _=0;_<a;_++)p[_]=r;return new String(p)}}Ys.NEWLINE=ne.getProperty("line.separator");var Pf=Object.freeze({__proto__:null,CollectionUtil:fh,CoordinateArrayFilter:dl,CoordinateCountFilter:zl,GeometricShapeFactory:ui,NumberUtil:c,ObjectCounter:Vl,PriorityQueue:Cf,StringUtil:Ys,UniqueCoordinateArrayFilter:Pa});Ee.prototype.getBoundary=function(){return nl.getBoundary(this)},ar.prototype.getBoundary=function(){return nl.getBoundary(this)},oe.prototype.equalsTopo=function(dt){return Tn.equalsTopo(this,dt)},oe.prototype.equals=function(dt){return dt!==null&&Tn.equalsTopo(this,dt)},oe.prototype.union=function(){if(arguments.length===0)return Ol.union(this);if(arguments.length===1){const dt=arguments[0];return ac.union(this,dt)}},oe.prototype.isValid=function(){return hs.isValid(this)},oe.prototype.intersection=function(dt){return Ir.intersection(this,dt)},oe.prototype.covers=function(dt){return Tn.covers(this,dt)},oe.prototype.coveredBy=function(dt){return Tn.covers(dt,this)},oe.prototype.touches=function(dt){return Tn.touches(this,dt)},oe.prototype.intersects=function(dt){return Tn.intersects(this,dt)},oe.prototype.within=function(dt){return Tn.contains(dt,this)},oe.prototype.overlaps=function(dt){return Tn.overlaps(this,dt)},oe.prototype.disjoint=function(dt){return Tn.disjoint(this,dt)},oe.prototype.crosses=function(dt){return Tn.crosses(this,dt)},oe.prototype.buffer=function(){if(arguments.length===1){const dt=arguments[0];return Vi.bufferOp(this,dt)}if(arguments.length===2){const dt=arguments[0],r=arguments[1];return Vi.bufferOp(this,dt,r)}if(arguments.length===3){const dt=arguments[0],r=arguments[1],a=arguments[2];return Vi.bufferOp(this,dt,r,a)}},oe.prototype.convexHull=function(){return new aa(this).getConvexHull()},oe.prototype.relate=function(){if(arguments.length===1){const dt=arguments[0];return Tn.relate(this,dt)}if(arguments.length===2){const dt=arguments[0],r=arguments[1];return Tn.relate(this,dt).matches(r)}},oe.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();const dt=Ta.getCentroid(this);return this.createPointFromInternalCoord(dt,this)},oe.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();let dt=null;const r=this.getDimension();dt=r===0?new Ma(this):r===1?new cs(this):new jo(this);const a=dt.getInteriorPoint();return this.createPointFromInternalCoord(a,this)},oe.prototype.symDifference=function(dt){return Ir.symDifference(this,dt)},oe.prototype.createPointFromInternalCoord=function(dt,r){return r.getPrecisionModel().makePrecise(dt),r.getFactory().createPoint(dt)},oe.prototype.toText=function(){return new vi().write(this)},oe.prototype.toString=function(){return this.toText()},oe.prototype.contains=function(dt){return Tn.contains(this,dt)},oe.prototype.difference=function(dt){return Ir.difference(this,dt)},oe.prototype.isSimple=function(){return new Ll(this).isSimple()},oe.prototype.isWithinDistance=function(dt,r){return!(this.getEnvelopeInternal().distance(dt.getEnvelopeInternal())>r)&&la.isWithinDistance(this,dt,r)},oe.prototype.distance=function(dt){return la.distance(this,dt)},n.algorithm=hf,n.densify=Xc,n.dissolve=tp,n.geom=Us,n.geomgraph=pf,n.index=ep,n.io=Dd,n.linearref=pp,n.noding=Gd,n.operation=Sf,n.precision=jm,n.simplify=Fl,n.triangulate=lp,n.util=Pf,n.version="2.12.1"}),function(n){n.fn.PACalendar=function(c){function h(){B=n("<header></header>").addClass("PAheader"),O=n("<span></span>").html(P.prevArrow).addClass("PAHprev"),K=n("<span></span>").html(P.nextArrow).addClass("PAHnext"),Q=n("<span></span>").addClass("PAHmonth"),et=n("<section></section>").addClass("PAweek");for(var pt=1;8>pt;pt++)et.append(n("<span></span>").text(moment().isoWeekday(pt).format("dd")));lt=n("<section></section>").addClass("PAmonth"),B.append(O).append(Q).append(K),E.addClass("PACalendar").append(B).append(et).append(lt),P.from.element.addClass("PAcalendar_element").attr("rel",L),P.to.element.addClass("PAcalendar_element").attr("rel",L),u()}function u(){let pt=moment(),T=moment().subtract(0,"days"),ct=moment("1920-01-01");lt.find("span[data-value]").each(function(ut,ft){let $=moment(n(ft).attr("data-value"),"YYYYMMDD");$.isSameOrBefore(ct)||$.isSame(pt)||$.isAfter(T)?(n(ft).addClass("PAoutOfRange"),n(ft).css("color","#44444466"),n(ft).css("pointer-events","none")):(n(ft).removeClass("PAoutOfRange"),n(ft).css("color",""),n(ft).css("pointer-events",""))})}function d(pt){var T=moment(pt),ct=T.month(),ut=T.year();let ft=moment("2022-01-01");if(T.isBefore(ft)){lt.find("span").removeClass("PAactive");return}Q.text(T.format("MMMM YYYY")).attr("data-month",ct).attr("data-year",ut),T.set("date",1),T.subtract((T.isoWeekday()||8)-1,"days"),lt.find("span").remove();for(var $=0;42>$;$++){var _t=T.date(),W=T.month(),rt=moment(T),nt=!1;nt=W===ct,P.limit_to&&nt&&(nt=T.isBefore(P.limit_to)),P.limit_from&&nt&&(nt=T.isAfter(P.limit_from)),T.isBefore(ft)&&(nt=!1);var vt=n("<span></span>").text(_t).attr("data-value",rt.format("YYYYMMDD")).toggleClass("PAactive",nt);P.mode==="range"&&(vt.toggleClass("PAfrom",A.isSame(rt)),G&&G.isValid()&&vt.toggleClass("PAto",G.isSame(rt))),lt.append(vt),T.add(1,"days")}m()}function m(){u(),lt.find("span").removeClass("PAselected PAfrom PAto PAbetween"),P.mode==="range"&&G&&G.isValid()&&A.isValid()&&A.isBefore(G)&&lt.find("span[data-value]").each(function(pt,T){var ct=moment(n(T).attr("data-value"),"YYYYMMDD");n(T).toggleClass("PAbetween",ct.isAfter(A)&&ct.isBefore(G))}),lt.find('span[data-value="'+A.format("YYYYMMDD")+'"]').removeClass("PAbetween").addClass("PAselected PAfrom"),P.mode==="range"&&G&&G.isValid()&&lt.find('span[data-value="'+G.format("YYYYMMDD")+'"]').removeClass("PAbetween").addClass("PAselected PAto")}function g(pt){const T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ct=pt.split("/"),ut=parseInt(ct[0],10),ft=parseInt(ct[1],10)-1,$=parseInt(ct[2],10),_t=new Date($,ft,ut);const W=_t.getDate(),rt=T[_t.getMonth()],nt=_t.getFullYear();return`${W} ${rt} ${nt}`}function x(pt){pt=!(typeof pt>"u"),P.rangeInterval&&P.rangeInterval.length===2&&P.rangeInterval instanceof Array&&P.mode==="range"&&(pt?A=moment(G).subtract(P.rangeInterval[0],P.rangeInterval[1]).add(1,"d"):G=moment(A).add(P.rangeInterval[0],P.rangeInterval[1]).subtract(1,"d"),!pt&&P.to.element&&P.to.element.val(moment(G).format(P.format)),pt&&P.from.element&&P.from.element.val(moment(A).format(P.format)))}var E=this,P=n.extend(!0,{prevArrow:"&laquo;",nextArrow:"&raquo;",from:{date:moment(),element:n('[data-element="from"]')},to:{date:null,element:n('[data-element="to"]')},mode:"date",rangeInterval:null,limit_to:null,limit_from:null,locale:moment.locale(),format:"DD MMM YYYY"},c);moment.locale(P.locale);var L=Math.random().toString(36).substring(7);P.from.element&&(P.from.date=moment(P.from.element.val(),P.format),P.from.date.isValid()||(P.from.date=moment())),P.to.element&&(P.to.date=moment(P.to.element.val(),P.format),P.to.date.isValid()||(P.to.date=moment()),P.to.element.val(moment(P.to.date).format(P.format)),P.to.date.isBefore(P.from.date)&&(P.to.element.val(""),P.to.date=null));var F=!0,U=moment(P.from.date),A=moment(P.from.date),G=P.mode==="range"?moment(P.to.date):null;P.from.element.addClass("PAactive");var B,O,K,Q,et,lt;return x(),h(),d(U),lt.addClass(F?"PAfrom":"PAto"),K.off("click").on("click",function(){U.add(1,"months"),d(U)}),O.off("click").on("click",function(){U.subtract(1,"months"),d(U)}),lt.off("click","span.PAactive").on("click","span.PAactive",function(){var pt=F?"PAto":"PAfrom";lt.find("span:not(."+pt+")").removeClass("PAselected"),n(this).addClass("PAselected");var T=moment(n(this).attr("data-value"),"YYYYMMDD");if(pt=="PAto"){let ct=moment(moment(G)).format("DD MMM YYYY");n("#toDate").val(ct),n("#toDate").css("border-bottom","5px solid #ef7e22"),n("#toDate").css("color","#000")}if(pt=="PAfrom"){let ct=moment(moment(A)).format("DD MMM YYYY");n("#fromDate").val(ct),n("#fromDate").css("border-bottom","5px solid #ef7e22"),n("#fromDate").css("color","#000")}F&&(A=T,P.from.element&&P.from.element.val(moment(T,"YYYYMMDD").format(P.format))),P.mode==="range"&&(F||(G=T,P.to.element&&P.to.element.val(moment(T,"YYYYMMDD").format(P.format))),x(),lt.find("span").removeClass(F?"PAfrom":"PAto"),n(this).addClass(F?"PAfrom":"PAto"),A>G?(lt.find("span").removeClass("PAselected PAbetween PAfrom PAto"),n(this).addClass("PAselected PAfrom"),A=T,P.from.element&&P.from.element.val(moment(T,"YYYYMMDD").format(P.format)),P.to.element&&P.to.element.val(""),F=!1):F=!F,P.rangeInterval&&P.rangeInterval.length===2&&P.rangeInterval instanceof Array&&(F=!0)),P.mode==="range"&&A&&G&&E.trigger({type:"setDate",from:moment(A),to:moment(G)}),P.mode!=="range"&&A&&E.trigger({type:"setDate",from:moment(A)}),n('.PAcalendar_element[rel="'+L+'"]').removeClass("PAactive"),P[F?"from":"to"].element.addClass("PAactive"),m()}),P.from.element&&P.from.element.off("change keyup").on("change keyup",function(){E.setDateFrom(n(this).val())}).off("focus").on("focus",function(){F=!0,n('.PAcalendar_element[rel="'+L+'"]').removeClass("PAactive"),P.from.element.addClass("PAactive")}),P.to.element&&P.to.element.off("change keyup").on("change keyup",function(){E.setDateTo(n(this).val())}).off("focus").on("focus",function(){F=!!(P.rangeInterval&&P.rangeInterval.length===2&&P.rangeInterval instanceof Array&&P.mode==="range"),n('.PAcalendar_element[rel="'+L+'"]').removeClass("PAactive"),P.to.element.addClass("PAactive")}),E.setMode=function(pt){return pt!=="range"&&pt!=="date"||P.mode===pt?!1:(P.mode=pt,P.mode==="date"&&(G=null),x(),d(A),!0)},E.setDateFrom=function(pt,T){T=typeof T=="boolean"?T:!0;var ct=moment(pt,P.format);return ct.isValid()?(lt.find("span:not(.PAto)").removeClass("PAselected PAfrom"),lt.find('span[data-value="'+ct.format("YYYYMMDD")+'"]').addClass("PAselected PAfrom"),A=moment(ct),x(),m(),T&&(P.mode==="range"&&A&&G&&E.trigger({type:"setDate",from:moment(A),to:moment(G)}),P.mode!=="range"&&A&&E.trigger({type:"setDate",from:moment(A)})),!0):!1},E.setDateTo=function(pt,T){T=typeof T=="boolean"?T:!0;var ct=moment(pt,P.format);return ct.isValid()?(lt.find("span:not(.PAfrom)").removeClass("PAselected PAto"),lt.find('span[data-value="'+ct.format("YYYYMMDD")+'"]').addClass("PAselected PAto"),G=moment(ct),x(!0),m(),T&&P.mode==="range"&&A&&G&&E.trigger({type:"setDate",from:moment(A),to:moment(G)}),!0):!1},E.setRangeInterval=function(pt){P.rangeInterval=pt,x(),m()},E.setDate=function(pt,T){return E.setDateFrom(pt)&&E.setDateTo(T)},E}}(jQuery);/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n){if(typeof exports=="object"&&typeof module<"u")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var c;c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this,c.localforage=n()}})(function(){return function n(c,h,u){function d(x,E){if(!h[x]){if(!c[x]){var P=typeof require=="function"&&require;if(!E&&P)return P(x,!0);if(m)return m(x,!0);var L=new Error("Cannot find module '"+x+"'");throw L.code="MODULE_NOT_FOUND",L}var F=h[x]={exports:{}};c[x][0].call(F.exports,function(U){var A=c[x][1][U];return d(A||U)},F,F.exports,n,c,h,u)}return h[x].exports}for(var m=typeof require=="function"&&require,g=0;g<u.length;g++)d(u[g]);return d}({1:[function(n,c,h){(function(u){"use strict";function d(){U=!0;for(var G,B,O=A.length;O;){for(B=A,A=[],G=-1;++G<O;)B[G]();O=A.length}U=!1}function m(G){A.push(G)!==1||U||g()}var g,x=u.MutationObserver||u.WebKitMutationObserver;if(x){var E=0,P=new x(d),L=u.document.createTextNode("");P.observe(L,{characterData:!0}),g=function(){L.data=E=++E%2}}else if(u.setImmediate||u.MessageChannel===void 0)g="document"in u&&"onreadystatechange"in u.document.createElement("script")?function(){var G=u.document.createElement("script");G.onreadystatechange=function(){d(),G.onreadystatechange=null,G.parentNode.removeChild(G),G=null},u.document.documentElement.appendChild(G)}:function(){setTimeout(d,0)};else{var F=new u.MessageChannel;F.port1.onmessage=d,g=function(){F.port2.postMessage(0)}}var U,A=[];c.exports=m}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,c,h){"use strict";function u(){}function d(et){if(typeof et!="function")throw new TypeError("resolver must be a function");this.state=Q,this.queue=[],this.outcome=void 0,et!==u&&E(this,et)}function m(et,lt,pt){this.promise=et,typeof lt=="function"&&(this.onFulfilled=lt,this.callFulfilled=this.otherCallFulfilled),typeof pt=="function"&&(this.onRejected=pt,this.callRejected=this.otherCallRejected)}function g(et,lt,pt){G(function(){var T;try{T=lt(pt)}catch(ct){return B.reject(et,ct)}T===et?B.reject(et,new TypeError("Cannot resolve promise with itself")):B.resolve(et,T)})}function x(et){var lt=et&&et.then;if(et&&(typeof et=="object"||typeof et=="function")&&typeof lt=="function")return function(){lt.apply(et,arguments)}}function E(et,lt){function pt($){ut||(ut=!0,B.reject(et,$))}function T($){ut||(ut=!0,B.resolve(et,$))}function ct(){lt(T,pt)}var ut=!1,ft=P(ct);ft.status==="error"&&pt(ft.value)}function P(et,lt){var pt={};try{pt.value=et(lt),pt.status="success"}catch(T){pt.status="error",pt.value=T}return pt}function L(et){return et instanceof this?et:B.resolve(new this(u),et)}function F(et){var lt=new this(u);return B.reject(lt,et)}function U(et){function lt(W,rt){function nt(vt){ut[rt]=vt,++ft!==T||ct||(ct=!0,B.resolve(_t,ut))}pt.resolve(W).then(nt,function(vt){ct||(ct=!0,B.reject(_t,vt))})}var pt=this;if(Object.prototype.toString.call(et)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=et.length,ct=!1;if(!T)return this.resolve([]);for(var ut=new Array(T),ft=0,$=-1,_t=new this(u);++$<T;)lt(et[$],$);return _t}function A(et){function lt($){pt.resolve($).then(function(_t){ct||(ct=!0,B.resolve(ft,_t))},function(_t){ct||(ct=!0,B.reject(ft,_t))})}var pt=this;if(Object.prototype.toString.call(et)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=et.length,ct=!1;if(!T)return this.resolve([]);for(var ut=-1,ft=new this(u);++ut<T;)lt(et[ut]);return ft}var G=n(1),B={},O=["REJECTED"],K=["FULFILLED"],Q=["PENDING"];c.exports=d,d.prototype.catch=function(et){return this.then(null,et)},d.prototype.then=function(et,lt){if(typeof et!="function"&&this.state===K||typeof lt!="function"&&this.state===O)return this;var pt=new this.constructor(u);return this.state!==Q?g(pt,this.state===K?et:lt,this.outcome):this.queue.push(new m(pt,et,lt)),pt},m.prototype.callFulfilled=function(et){B.resolve(this.promise,et)},m.prototype.otherCallFulfilled=function(et){g(this.promise,this.onFulfilled,et)},m.prototype.callRejected=function(et){B.reject(this.promise,et)},m.prototype.otherCallRejected=function(et){g(this.promise,this.onRejected,et)},B.resolve=function(et,lt){var pt=P(x,lt);if(pt.status==="error")return B.reject(et,pt.value);var T=pt.value;if(T)E(et,T);else{et.state=K,et.outcome=lt;for(var ct=-1,ut=et.queue.length;++ct<ut;)et.queue[ct].callFulfilled(lt)}return et},B.reject=function(et,lt){et.state=O,et.outcome=lt;for(var pt=-1,T=et.queue.length;++pt<T;)et.queue[pt].callRejected(lt);return et},d.resolve=L,d.reject=F,d.all=U,d.race=A},{1:1}],3:[function(n,c,h){(function(u){"use strict";typeof u.Promise!="function"&&(u.Promise=n(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,c,h){"use strict";function u(bt,Gt){if(!(bt instanceof Gt))throw new TypeError("Cannot call a class as a function")}function d(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}function m(){try{if(!ar||!ar.open)return!1;var bt=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Gt=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!bt||Gt)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function g(bt,Gt){bt=bt||[],Gt=Gt||{};try{return new Blob(bt,Gt)}catch(re){if(re.name!=="TypeError")throw re;for(var At=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,Qt=new At,le=0;le<bt.length;le+=1)Qt.append(bt[le]);return Qt.getBlob(Gt.type)}}function x(bt,Gt){Gt&&bt.then(function(At){Gt(null,At)},function(At){Gt(At)})}function E(bt,Gt,At){typeof Gt=="function"&&bt.then(Gt),typeof At=="function"&&bt.catch(At)}function P(bt){return typeof bt!="string"&&(console.warn(bt+" used as a key, but it is not a string."),bt=String(bt)),bt}function L(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}function F(bt){for(var Gt=bt.length,At=new ArrayBuffer(Gt),Qt=new Uint8Array(At),le=0;le<Gt;le++)Qt[le]=bt.charCodeAt(le);return At}function U(bt){return new ot(function(Gt){var At=bt.transaction(zt,nr),Qt=g([""]);At.objectStore(zt).put(Qt,"key"),At.onabort=function(le){le.preventDefault(),le.stopPropagation(),Gt(!1)},At.oncomplete=function(){var le=navigator.userAgent.match(/Chrome\/(\d+)/),re=navigator.userAgent.match(/Edge\//);Gt(re||!le||parseInt(le[1],10)>=43)}}).catch(function(){return!1})}function A(bt){return typeof Wt=="boolean"?ot.resolve(Wt):U(bt).then(function(Gt){return Wt=Gt})}function G(bt){var Gt=Ut[bt.name],At={};At.promise=new ot(function(Qt,le){At.resolve=Qt,At.reject=le}),Gt.deferredOperations.push(At),Gt.dbReady?Gt.dbReady=Gt.dbReady.then(function(){return At.promise}):Gt.dbReady=At.promise}function B(bt){var Gt=Ut[bt.name],At=Gt.deferredOperations.pop();if(At)return At.resolve(),At.promise}function O(bt,Gt){var At=Ut[bt.name],Qt=At.deferredOperations.pop();if(Qt)return Qt.reject(Gt),Qt.promise}function K(bt,Gt){return new ot(function(At,Qt){if(Ut[bt.name]=Ut[bt.name]||_t(),bt.db){if(!Gt)return At(bt.db);G(bt),bt.db.close()}var le=[bt.name];Gt&&le.push(bt.version);var re=ar.open.apply(ar,le);Gt&&(re.onupgradeneeded=function(Pe){var Ce=re.result;try{Ce.createObjectStore(bt.storeName),Pe.oldVersion<=1&&Ce.createObjectStore(zt)}catch(Xe){if(Xe.name!=="ConstraintError")throw Xe;console.warn('The database "'+bt.name+'" has been upgraded from version '+Pe.oldVersion+" to version "+Pe.newVersion+', but the storage "'+bt.storeName+'" already exists.')}}),re.onerror=function(Pe){Pe.preventDefault(),Qt(re.error)},re.onsuccess=function(){var Pe=re.result;Pe.onversionchange=function(Ce){Ce.target.close()},At(Pe),B(bt)}})}function Q(bt){return K(bt,!1)}function et(bt){return K(bt,!0)}function lt(bt,Gt){if(!bt.db)return!0;var At=!bt.db.objectStoreNames.contains(bt.storeName),Qt=bt.version<bt.db.version,le=bt.version>bt.db.version;if(Qt&&(bt.version!==Gt&&console.warn('The database "'+bt.name+`" can't be downgraded from version `+bt.db.version+" to version "+bt.version+"."),bt.version=bt.db.version),le||At){if(At){var re=bt.db.version+1;re>bt.version&&(bt.version=re)}return!0}return!1}function pt(bt){return new ot(function(Gt,At){var Qt=new FileReader;Qt.onerror=At,Qt.onloadend=function(le){var re=btoa(le.target.result||"");Gt({__local_forage_encoded_blob:!0,data:re,type:bt.type})},Qt.readAsBinaryString(bt)})}function T(bt){return g([F(atob(bt.data))],{type:bt.type})}function ct(bt){return bt&&bt.__local_forage_encoded_blob}function ut(bt){var Gt=this,At=Gt._initReady().then(function(){var Qt=Ut[Gt._dbInfo.name];if(Qt&&Qt.dbReady)return Qt.dbReady});return E(At,bt,bt),At}function ft(bt){G(bt);for(var Gt=Ut[bt.name],At=Gt.forages,Qt=0;Qt<At.length;Qt++){var le=At[Qt];le._dbInfo.db&&(le._dbInfo.db.close(),le._dbInfo.db=null)}return bt.db=null,Q(bt).then(function(re){return bt.db=re,lt(bt)?et(bt):re}).then(function(re){bt.db=Gt.db=re;for(var Pe=0;Pe<At.length;Pe++)At[Pe]._dbInfo.db=re}).catch(function(re){throw O(bt,re),re})}function $(bt,Gt,At,Qt){Qt===void 0&&(Qt=1);try{var le=bt.db.transaction(bt.storeName,Gt);At(null,le)}catch(re){if(Qt>0&&(!bt.db||re.name==="InvalidStateError"||re.name==="NotFoundError"))return ot.resolve().then(function(){if(!bt.db||re.name==="NotFoundError"&&!bt.db.objectStoreNames.contains(bt.storeName)&&bt.version<=bt.db.version)return bt.db&&(bt.version=bt.db.version+1),et(bt)}).then(function(){return ft(bt).then(function(){$(bt,Gt,At,Qt-1)})}).catch(At);At(re)}}function _t(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function W(bt){function Gt(){return ot.resolve()}var At=this,Qt={db:null};if(bt)for(var le in bt)Qt[le]=bt[le];var re=Ut[Qt.name];re||(re=_t(),Ut[Qt.name]=re),re.forages.push(At),At._initReady||(At._initReady=At.ready,At.ready=ut);for(var Pe=[],Ce=0;Ce<re.forages.length;Ce++){var Xe=re.forages[Ce];Xe!==At&&Pe.push(Xe._initReady().catch(Gt))}var Ae=re.forages.slice(0);return ot.all(Pe).then(function(){return Qt.db=re.db,Q(Qt)}).then(function(ke){return Qt.db=ke,lt(Qt,At._defaultConfig.version)?et(Qt):ke}).then(function(ke){Qt.db=re.db=ke,At._dbInfo=Qt;for(var lr=0;lr<Ae.length;lr++){var mr=Ae[lr];mr!==At&&(mr._dbInfo.db=Qt.db,mr._dbInfo.version=Qt.version)}})}function rt(bt,Gt){var At=this;bt=P(bt);var Qt=new ot(function(le,re){At.ready().then(function(){$(At._dbInfo,Se,function(Pe,Ce){if(Pe)return re(Pe);try{var Xe=Ce.objectStore(At._dbInfo.storeName),Ae=Xe.get(bt);Ae.onsuccess=function(){var ke=Ae.result;ke===void 0&&(ke=null),ct(ke)&&(ke=T(ke)),le(ke)},Ae.onerror=function(){re(Ae.error)}}catch(ke){re(ke)}})}).catch(re)});return x(Qt,Gt),Qt}function nt(bt,Gt){var At=this,Qt=new ot(function(le,re){At.ready().then(function(){$(At._dbInfo,Se,function(Pe,Ce){if(Pe)return re(Pe);try{var Xe=Ce.objectStore(At._dbInfo.storeName),Ae=Xe.openCursor(),ke=1;Ae.onsuccess=function(){var lr=Ae.result;if(lr){var mr=lr.value;ct(mr)&&(mr=T(mr));var Fr=bt(mr,lr.key,ke++);Fr!==void 0?le(Fr):lr.continue()}else le()},Ae.onerror=function(){re(Ae.error)}}catch(lr){re(lr)}})}).catch(re)});return x(Qt,Gt),Qt}function vt(bt,Gt,At){var Qt=this;bt=P(bt);var le=new ot(function(re,Pe){var Ce;Qt.ready().then(function(){return Ce=Qt._dbInfo,ve.call(Gt)==="[object Blob]"?A(Ce.db).then(function(Xe){return Xe?Gt:pt(Gt)}):Gt}).then(function(Xe){$(Qt._dbInfo,nr,function(Ae,ke){if(Ae)return Pe(Ae);try{var lr=ke.objectStore(Qt._dbInfo.storeName);Xe===null&&(Xe=void 0);var mr=lr.put(Xe,bt);ke.oncomplete=function(){Xe===void 0&&(Xe=null),re(Xe)},ke.onabort=ke.onerror=function(){var Fr=mr.error?mr.error:mr.transaction.error;Pe(Fr)}}catch(Fr){Pe(Fr)}})}).catch(Pe)});return x(le,At),le}function Mt(bt,Gt){var At=this;bt=P(bt);var Qt=new ot(function(le,re){At.ready().then(function(){$(At._dbInfo,nr,function(Pe,Ce){if(Pe)return re(Pe);try{var Xe=Ce.objectStore(At._dbInfo.storeName),Ae=Xe.delete(bt);Ce.oncomplete=function(){le()},Ce.onerror=function(){re(Ae.error)},Ce.onabort=function(){var ke=Ae.error?Ae.error:Ae.transaction.error;re(ke)}}catch(ke){re(ke)}})}).catch(re)});return x(Qt,Gt),Qt}function Bt(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){$(Gt._dbInfo,nr,function(re,Pe){if(re)return le(re);try{var Ce=Pe.objectStore(Gt._dbInfo.storeName),Xe=Ce.clear();Pe.oncomplete=function(){Qt()},Pe.onabort=Pe.onerror=function(){var Ae=Xe.error?Xe.error:Xe.transaction.error;le(Ae)}}catch(Ae){le(Ae)}})}).catch(le)});return x(At,bt),At}function Vt(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){$(Gt._dbInfo,Se,function(re,Pe){if(re)return le(re);try{var Ce=Pe.objectStore(Gt._dbInfo.storeName),Xe=Ce.count();Xe.onsuccess=function(){Qt(Xe.result)},Xe.onerror=function(){le(Xe.error)}}catch(Ae){le(Ae)}})}).catch(le)});return x(At,bt),At}function Lt(bt,Gt){var At=this,Qt=new ot(function(le,re){if(bt<0)return void le(null);At.ready().then(function(){$(At._dbInfo,Se,function(Pe,Ce){if(Pe)return re(Pe);try{var Xe=Ce.objectStore(At._dbInfo.storeName),Ae=!1,ke=Xe.openKeyCursor();ke.onsuccess=function(){var lr=ke.result;if(!lr)return void le(null);bt===0||Ae?le(lr.key):(Ae=!0,lr.advance(bt))},ke.onerror=function(){re(ke.error)}}catch(lr){re(lr)}})}).catch(re)});return x(Qt,Gt),Qt}function Ne(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){$(Gt._dbInfo,Se,function(re,Pe){if(re)return le(re);try{var Ce=Pe.objectStore(Gt._dbInfo.storeName),Xe=Ce.openKeyCursor(),Ae=[];Xe.onsuccess=function(){var ke=Xe.result;if(!ke)return void Qt(Ae);Ae.push(ke.key),ke.continue()},Xe.onerror=function(){le(Xe.error)}}catch(ke){le(ke)}})}).catch(le)});return x(At,bt),At}function ge(bt,Gt){Gt=L.apply(this,arguments);var At=this.config();bt=typeof bt!="function"&&bt||{},bt.name||(bt.name=bt.name||At.name,bt.storeName=bt.storeName||At.storeName);var Qt,le=this;if(bt.name){var re=bt.name===At.name&&le._dbInfo.db,Pe=re?ot.resolve(le._dbInfo.db):Q(bt).then(function(Ce){var Xe=Ut[bt.name],Ae=Xe.forages;Xe.db=Ce;for(var ke=0;ke<Ae.length;ke++)Ae[ke]._dbInfo.db=Ce;return Ce});Qt=bt.storeName?Pe.then(function(Ce){if(Ce.objectStoreNames.contains(bt.storeName)){var Xe=Ce.version+1;G(bt);var Ae=Ut[bt.name],ke=Ae.forages;Ce.close();for(var lr=0;lr<ke.length;lr++){var mr=ke[lr];mr._dbInfo.db=null,mr._dbInfo.version=Xe}return new ot(function(Fr,Ur){var ui=ar.open(bt.name,Xe);ui.onerror=function(nn){ui.result.close(),Ur(nn)},ui.onupgradeneeded=function(){ui.result.deleteObjectStore(bt.storeName)},ui.onsuccess=function(){var nn=ui.result;nn.close(),Fr(nn)}}).then(function(Fr){Ae.db=Fr;for(var Ur=0;Ur<ke.length;Ur++){var ui=ke[Ur];ui._dbInfo.db=Fr,B(ui._dbInfo)}}).catch(function(Fr){throw(O(bt,Fr)||ot.resolve()).catch(function(){}),Fr})}}):Pe.then(function(Ce){G(bt);var Xe=Ut[bt.name],Ae=Xe.forages;Ce.close();for(var ke=0;ke<Ae.length;ke++)Ae[ke]._dbInfo.db=null;return new ot(function(lr,mr){var Fr=ar.deleteDatabase(bt.name);Fr.onerror=function(){var Ur=Fr.result;Ur&&Ur.close(),mr(Fr.error)},Fr.onblocked=function(){console.warn('dropInstance blocked for database "'+bt.name+'" until all open connections are closed')},Fr.onsuccess=function(){var Ur=Fr.result;Ur&&Ur.close(),lr(Ur)}}).then(function(lr){Xe.db=lr;for(var mr=0;mr<Ae.length;mr++)B(Ae[mr]._dbInfo)}).catch(function(lr){throw(O(bt,lr)||ot.resolve()).catch(function(){}),lr})})}else Qt=ot.reject("Invalid arguments");return x(Qt,Gt),Qt}function Yt(){return typeof openDatabase=="function"}function ue(bt){var Gt,At,Qt,le,re,Pe=.75*bt.length,Ce=bt.length,Xe=0;bt[bt.length-1]==="="&&(Pe--,bt[bt.length-2]==="="&&Pe--);var Ae=new ArrayBuffer(Pe),ke=new Uint8Array(Ae);for(Gt=0;Gt<Ce;Gt+=4)At=Me.indexOf(bt[Gt]),Qt=Me.indexOf(bt[Gt+1]),le=Me.indexOf(bt[Gt+2]),re=Me.indexOf(bt[Gt+3]),ke[Xe++]=At<<2|Qt>>4,ke[Xe++]=(15&Qt)<<4|le>>2,ke[Xe++]=(3&le)<<6|63&re;return Ae}function ne(bt){var Gt,At=new Uint8Array(bt),Qt="";for(Gt=0;Gt<At.length;Gt+=3)Qt+=Me[At[Gt]>>2],Qt+=Me[(3&At[Gt])<<4|At[Gt+1]>>4],Qt+=Me[(15&At[Gt+1])<<2|At[Gt+2]>>6],Qt+=Me[63&At[Gt+2]];return At.length%3==2?Qt=Qt.substring(0,Qt.length-1)+"=":At.length%3==1&&(Qt=Qt.substring(0,Qt.length-2)+"=="),Qt}function dr(bt,Gt){var At="";if(bt&&(At=wn.call(bt)),bt&&(At==="[object ArrayBuffer]"||bt.buffer&&wn.call(bt.buffer)==="[object ArrayBuffer]")){var Qt,le=Mr;bt instanceof ArrayBuffer?(Qt=bt,le+=Vr):(Qt=bt.buffer,At==="[object Int8Array]"?le+=Qr:At==="[object Uint8Array]"?le+=Fi:At==="[object Uint8ClampedArray]"?le+=ro:At==="[object Int16Array]"?le+=Ln:At==="[object Uint16Array]"?le+=un:At==="[object Int32Array]"?le+=Di:At==="[object Uint32Array]"?le+=Mi:At==="[object Float32Array]"?le+=Qi:At==="[object Float64Array]"?le+=Qo:Gt(new Error("Failed to get type for BinaryArray"))),Gt(le+ne(Qt))}else if(At==="[object Blob]"){var re=new FileReader;re.onload=function(){var Pe=ei+bt.type+"~"+ne(this.result);Gt(Mr+yi+Pe)},re.readAsArrayBuffer(bt)}else try{Gt(JSON.stringify(bt))}catch(Pe){console.error("Couldn't convert value into a JSON string: ",bt),Gt(null,Pe)}}function je(bt){if(bt.substring(0,hr)!==Mr)return JSON.parse(bt);var Gt,At=bt.substring(ci),Qt=bt.substring(hr,ci);if(Qt===yi&&fr.test(At)){var le=At.match(fr);Gt=le[1],At=At.substring(le[0].length)}var re=ue(At);switch(Qt){case Vr:return re;case yi:return g([re],{type:Gt});case Qr:return new Int8Array(re);case Fi:return new Uint8Array(re);case ro:return new Uint8ClampedArray(re);case Ln:return new Int16Array(re);case un:return new Uint16Array(re);case Di:return new Int32Array(re);case Mi:return new Uint32Array(re);case Qi:return new Float32Array(re);case Qo:return new Float64Array(re);default:throw new Error("Unkown type: "+Qt)}}function Br(bt,Gt,At,Qt){bt.executeSql("CREATE TABLE IF NOT EXISTS "+Gt.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],At,Qt)}function Ue(bt){var Gt=this,At={db:null};if(bt)for(var Qt in bt)At[Qt]=typeof bt[Qt]!="string"?bt[Qt].toString():bt[Qt];var le=new ot(function(re,Pe){try{At.db=openDatabase(At.name,String(At.version),At.description,At.size)}catch(Ce){return Pe(Ce)}At.db.transaction(function(Ce){Br(Ce,At,function(){Gt._dbInfo=At,re()},function(Xe,Ae){Pe(Ae)})},Pe)});return At.serializer=vi,le}function Fe(bt,Gt,At,Qt,le,re){bt.executeSql(At,Qt,le,function(Pe,Ce){Ce.code===Ce.SYNTAX_ERR?Pe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Gt.storeName],function(Xe,Ae){Ae.rows.length?re(Xe,Ce):Br(Xe,Gt,function(){Xe.executeSql(At,Qt,le,re)},re)},re):re(Pe,Ce)},re)}function Lr(bt,Gt){var At=this;bt=P(bt);var Qt=new ot(function(le,re){At.ready().then(function(){var Pe=At._dbInfo;Pe.db.transaction(function(Ce){Fe(Ce,Pe,"SELECT * FROM "+Pe.storeName+" WHERE key = ? LIMIT 1",[bt],function(Xe,Ae){var ke=Ae.rows.length?Ae.rows.item(0).value:null;ke&&(ke=Pe.serializer.deserialize(ke)),le(ke)},function(Xe,Ae){re(Ae)})})}).catch(re)});return x(Qt,Gt),Qt}function De(bt,Gt){var At=this,Qt=new ot(function(le,re){At.ready().then(function(){var Pe=At._dbInfo;Pe.db.transaction(function(Ce){Fe(Ce,Pe,"SELECT * FROM "+Pe.storeName,[],function(Xe,Ae){for(var ke=Ae.rows,lr=ke.length,mr=0;mr<lr;mr++){var Fr=ke.item(mr),Ur=Fr.value;if(Ur&&(Ur=Pe.serializer.deserialize(Ur)),(Ur=bt(Ur,Fr.key,mr+1))!==void 0)return void le(Ur)}le()},function(Xe,Ae){re(Ae)})})}).catch(re)});return x(Qt,Gt),Qt}function se(bt,Gt,At,Qt){var le=this;bt=P(bt);var re=new ot(function(Pe,Ce){le.ready().then(function(){Gt===void 0&&(Gt=null);var Xe=Gt,Ae=le._dbInfo;Ae.serializer.serialize(Gt,function(ke,lr){lr?Ce(lr):Ae.db.transaction(function(mr){Fe(mr,Ae,"INSERT OR REPLACE INTO "+Ae.storeName+" (key, value) VALUES (?, ?)",[bt,ke],function(){Pe(Xe)},function(Fr,Ur){Ce(Ur)})},function(mr){if(mr.code===mr.QUOTA_ERR){if(Qt>0)return void Pe(se.apply(le,[bt,Xe,At,Qt-1]));Ce(mr)}})})}).catch(Ce)});return x(re,At),re}function oe(bt,Gt,At){return se.apply(this,[bt,Gt,At,1])}function Ar(bt,Gt){var At=this;bt=P(bt);var Qt=new ot(function(le,re){At.ready().then(function(){var Pe=At._dbInfo;Pe.db.transaction(function(Ce){Fe(Ce,Pe,"DELETE FROM "+Pe.storeName+" WHERE key = ?",[bt],function(){le()},function(Xe,Ae){re(Ae)})})}).catch(re)});return x(Qt,Gt),Qt}function vr(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){var re=Gt._dbInfo;re.db.transaction(function(Pe){Fe(Pe,re,"DELETE FROM "+re.storeName,[],function(){Qt()},function(Ce,Xe){le(Xe)})})}).catch(le)});return x(At,bt),At}function Kr(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){var re=Gt._dbInfo;re.db.transaction(function(Pe){Fe(Pe,re,"SELECT COUNT(key) as c FROM "+re.storeName,[],function(Ce,Xe){var Ae=Xe.rows.item(0).c;Qt(Ae)},function(Ce,Xe){le(Xe)})})}).catch(le)});return x(At,bt),At}function wi(bt,Gt){var At=this,Qt=new ot(function(le,re){At.ready().then(function(){var Pe=At._dbInfo;Pe.db.transaction(function(Ce){Fe(Ce,Pe,"SELECT key FROM "+Pe.storeName+" WHERE id = ? LIMIT 1",[bt+1],function(Xe,Ae){var ke=Ae.rows.length?Ae.rows.item(0).key:null;le(ke)},function(Xe,Ae){re(Ae)})})}).catch(re)});return x(Qt,Gt),Qt}function Ee(bt){var Gt=this,At=new ot(function(Qt,le){Gt.ready().then(function(){var re=Gt._dbInfo;re.db.transaction(function(Pe){Fe(Pe,re,"SELECT key FROM "+re.storeName,[],function(Ce,Xe){for(var Ae=[],ke=0;ke<Xe.rows.length;ke++)Ae.push(Xe.rows.item(ke).key);Qt(Ae)},function(Ce,Xe){le(Xe)})})}).catch(le)});return x(At,bt),At}function Sr(bt){return new ot(function(Gt,At){bt.transaction(function(Qt){Qt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(le,re){for(var Pe=[],Ce=0;Ce<re.rows.length;Ce++)Pe.push(re.rows.item(Ce).name);Gt({db:bt,storeNames:Pe})},function(le,re){At(re)})},function(Qt){At(Qt)})})}function Or(bt,Gt){Gt=L.apply(this,arguments);var At=this.config();bt=typeof bt!="function"&&bt||{},bt.name||(bt.name=bt.name||At.name,bt.storeName=bt.storeName||At.storeName);var Qt,le=this;return Qt=bt.name?new ot(function(re){var Pe;Pe=bt.name===At.name?le._dbInfo.db:openDatabase(bt.name,"","",0),re(bt.storeName?{db:Pe,storeNames:[bt.storeName]}:Sr(Pe))}).then(function(re){return new ot(function(Pe,Ce){re.db.transaction(function(Xe){function Ae(Fr){return new ot(function(Ur,ui){Xe.executeSql("DROP TABLE IF EXISTS "+Fr,[],function(){Ur()},function(nn,pn){ui(pn)})})}for(var ke=[],lr=0,mr=re.storeNames.length;lr<mr;lr++)ke.push(Ae(re.storeNames[lr]));ot.all(ke).then(function(){Pe()}).catch(function(Fr){Ce(Fr)})},function(Xe){Ce(Xe)})})}):ot.reject("Invalid arguments"),x(Qt,Gt),Qt}function xn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function ye(bt,Gt){var At=bt.name+"/";return bt.storeName!==Gt.storeName&&(At+=bt.storeName+"/"),At}function oi(){var bt="_localforage_support_test";try{return localStorage.setItem(bt,!0),localStorage.removeItem(bt),!1}catch{return!0}}function eo(){return!oi()||localStorage.length>0}function Xo(bt){var Gt=this,At={};if(bt)for(var Qt in bt)At[Qt]=bt[Qt];return At.keyPrefix=ye(bt,Gt._defaultConfig),eo()?(Gt._dbInfo=At,At.serializer=vi,ot.resolve()):ot.reject()}function Xn(bt){var Gt=this,At=Gt.ready().then(function(){for(var Qt=Gt._dbInfo.keyPrefix,le=localStorage.length-1;le>=0;le--){var re=localStorage.key(le);re.indexOf(Qt)===0&&localStorage.removeItem(re)}});return x(At,bt),At}function cn(bt,Gt){var At=this;bt=P(bt);var Qt=At.ready().then(function(){var le=At._dbInfo,re=localStorage.getItem(le.keyPrefix+bt);return re&&(re=le.serializer.deserialize(re)),re});return x(Qt,Gt),Qt}function Ft(bt,Gt){var At=this,Qt=At.ready().then(function(){for(var le=At._dbInfo,re=le.keyPrefix,Pe=re.length,Ce=localStorage.length,Xe=1,Ae=0;Ae<Ce;Ae++){var ke=localStorage.key(Ae);if(ke.indexOf(re)===0){var lr=localStorage.getItem(ke);if(lr&&(lr=le.serializer.deserialize(lr)),(lr=bt(lr,ke.substring(Pe),Xe++))!==void 0)return lr}}});return x(Qt,Gt),Qt}function Ot(bt,Gt){var At=this,Qt=At.ready().then(function(){var le,re=At._dbInfo;try{le=localStorage.key(bt)}catch{le=null}return le&&(le=le.substring(re.keyPrefix.length)),le});return x(Qt,Gt),Qt}function Kt(bt){var Gt=this,At=Gt.ready().then(function(){for(var Qt=Gt._dbInfo,le=localStorage.length,re=[],Pe=0;Pe<le;Pe++){var Ce=localStorage.key(Pe);Ce.indexOf(Qt.keyPrefix)===0&&re.push(Ce.substring(Qt.keyPrefix.length))}return re});return x(At,bt),At}function ae(bt){var Gt=this,At=Gt.keys().then(function(Qt){return Qt.length});return x(At,bt),At}function Ve(bt,Gt){var At=this;bt=P(bt);var Qt=At.ready().then(function(){var le=At._dbInfo;localStorage.removeItem(le.keyPrefix+bt)});return x(Qt,Gt),Qt}function Be(bt,Gt,At){var Qt=this;bt=P(bt);var le=Qt.ready().then(function(){Gt===void 0&&(Gt=null);var re=Gt;return new ot(function(Pe,Ce){var Xe=Qt._dbInfo;Xe.serializer.serialize(Gt,function(Ae,ke){if(ke)Ce(ke);else try{localStorage.setItem(Xe.keyPrefix+bt,Ae),Pe(re)}catch(lr){lr.name!=="QuotaExceededError"&&lr.name!=="NS_ERROR_DOM_QUOTA_REACHED"||Ce(lr),Ce(lr)}})})});return x(le,At),le}function Er(bt,Gt){if(Gt=L.apply(this,arguments),bt=typeof bt!="function"&&bt||{},!bt.name){var At=this.config();bt.name=bt.name||At.name,bt.storeName=bt.storeName||At.storeName}var Qt,le=this;return Qt=bt.name?new ot(function(re){re(bt.storeName?ye(bt,le._defaultConfig):bt.name+"/")}).then(function(re){for(var Pe=localStorage.length-1;Pe>=0;Pe--){var Ce=localStorage.key(Pe);Ce.indexOf(re)===0&&localStorage.removeItem(Ce)}}):ot.reject("Invalid arguments"),x(Qt,Gt),Qt}function br(bt,Gt){bt[Gt]=function(){var At=arguments;return bt.ready().then(function(){return bt[Gt].apply(bt,At)})}}function Oe(){for(var bt=1;bt<arguments.length;bt++){var Gt=arguments[bt];if(Gt)for(var At in Gt)Gt.hasOwnProperty(At)&&(_i(Gt[At])?arguments[0][At]=Gt[At].slice():arguments[0][At]=Gt[At])}return arguments[0]}var ur=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(bt){return typeof bt}:function(bt){return bt&&typeof Symbol=="function"&&bt.constructor===Symbol&&bt!==Symbol.prototype?"symbol":typeof bt},ar=d();typeof Promise>"u"&&n(3);var ot=Promise,zt="local-forage-detect-blob-support",Wt=void 0,Ut={},ve=Object.prototype.toString,Se="readonly",nr="readwrite",xr={_driver:"asyncStorage",_initStorage:W,_support:m(),iterate:nt,getItem:rt,setItem:vt,removeItem:Mt,clear:Bt,length:Vt,key:Lt,keys:Ne,dropInstance:ge},Me="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ei="~~local_forage_type~",fr=/^~~local_forage_type~([^~]+)~/,Mr="__lfsc__:",hr=Mr.length,Vr="arbf",yi="blob",Qr="si08",Fi="ui08",ro="uic8",Ln="si16",Di="si32",un="ur16",Mi="ui32",Qi="fl32",Qo="fl64",ci=hr+Vr.length,wn=Object.prototype.toString,vi={serialize:dr,deserialize:je,stringToBuffer:ue,bufferToString:ne},Jr={_driver:"webSQLStorage",_initStorage:Ue,_support:Yt(),iterate:De,getItem:Lr,setItem:oe,removeItem:Ar,clear:vr,length:Kr,key:wi,keys:Ee,dropInstance:Or},tn={_driver:"localStorageWrapper",_initStorage:Xo,_support:xn(),iterate:Ft,getItem:cn,setItem:Be,removeItem:Ve,clear:Xn,length:ae,key:Ot,keys:Kt,dropInstance:Er},gr=function(bt,Gt){return bt===Gt||typeof bt=="number"&&typeof Gt=="number"&&isNaN(bt)&&isNaN(Gt)},St=function(bt,Gt){for(var At=bt.length,Qt=0;Qt<At;){if(gr(bt[Qt],Gt))return!0;Qt++}return!1},_i=Array.isArray||function(bt){return Object.prototype.toString.call(bt)==="[object Array]"},Wr={},Vs={},In={INDEXEDDB:xr,WEBSQL:Jr,LOCALSTORAGE:tn},qi=[In.INDEXEDDB._driver,In.WEBSQL._driver,In.LOCALSTORAGE._driver],vo=["dropInstance"],xi=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(vo),Ei={description:"",driver:qi.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},hn=function(){function bt(Gt){u(this,bt);for(var At in In)if(In.hasOwnProperty(At)){var Qt=In[At],le=Qt._driver;this[At]=le,Wr[le]||this.defineDriver(Qt)}this._defaultConfig=Oe({},Ei),this._config=Oe({},this._defaultConfig,Gt),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return bt.prototype.config=function(Gt){if((Gt===void 0?"undefined":ur(Gt))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var At in Gt){if(At==="storeName"&&(Gt[At]=Gt[At].replace(/\W/g,"_")),At==="version"&&typeof Gt[At]!="number")return new Error("Database version must be a number.");this._config[At]=Gt[At]}return!("driver"in Gt&&Gt.driver)||this.setDriver(this._config.driver)}return typeof Gt=="string"?this._config[Gt]:this._config},bt.prototype.defineDriver=function(Gt,At,Qt){var le=new ot(function(re,Pe){try{var Ce=Gt._driver,Xe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Gt._driver)return void Pe(Xe);for(var Ae=xi.concat("_initStorage"),ke=0,lr=Ae.length;ke<lr;ke++){var mr=Ae[ke];if((!St(vo,mr)||Gt[mr])&&typeof Gt[mr]!="function")return void Pe(Xe)}(function(){for(var Ur=function(Co){return function(){var Us=new Error("Method "+Co+" is not implemented by the current driver"),Wn=ot.reject(Us);return x(Wn,arguments[arguments.length-1]),Wn}},ui=0,nn=vo.length;ui<nn;ui++){var pn=vo[ui];Gt[pn]||(Gt[pn]=Ur(pn))}})();var Fr=function(Ur){Wr[Ce]&&console.info("Redefining LocalForage driver: "+Ce),Wr[Ce]=Gt,Vs[Ce]=Ur,re()};"_support"in Gt?Gt._support&&typeof Gt._support=="function"?Gt._support().then(Fr,Pe):Fr(!!Gt._support):Fr(!0)}catch(Ur){Pe(Ur)}});return E(le,At,Qt),le},bt.prototype.driver=function(){return this._driver||null},bt.prototype.getDriver=function(Gt,At,Qt){var le=Wr[Gt]?ot.resolve(Wr[Gt]):ot.reject(new Error("Driver not found."));return E(le,At,Qt),le},bt.prototype.getSerializer=function(Gt){var At=ot.resolve(vi);return E(At,Gt),At},bt.prototype.ready=function(Gt){var At=this,Qt=At._driverSet.then(function(){return At._ready===null&&(At._ready=At._initDriver()),At._ready});return E(Qt,Gt,Gt),Qt},bt.prototype.setDriver=function(Gt,At,Qt){function le(){Ce._config.driver=Ce.driver()}function re(ke){return Ce._extend(ke),le(),Ce._ready=Ce._initStorage(Ce._config),Ce._ready}function Pe(ke){return function(){function lr(){for(;mr<ke.length;){var Fr=ke[mr];return mr++,Ce._dbInfo=null,Ce._ready=null,Ce.getDriver(Fr).then(re).catch(lr)}le();var Ur=new Error("No available storage method found.");return Ce._driverSet=ot.reject(Ur),Ce._driverSet}var mr=0;return lr()}}var Ce=this;_i(Gt)||(Gt=[Gt]);var Xe=this._getSupportedDrivers(Gt),Ae=this._driverSet!==null?this._driverSet.catch(function(){return ot.resolve()}):ot.resolve();return this._driverSet=Ae.then(function(){var ke=Xe[0];return Ce._dbInfo=null,Ce._ready=null,Ce.getDriver(ke).then(function(lr){Ce._driver=lr._driver,le(),Ce._wrapLibraryMethodsWithReady(),Ce._initDriver=Pe(Xe)})}).catch(function(){le();var ke=new Error("No available storage method found.");return Ce._driverSet=ot.reject(ke),Ce._driverSet}),E(this._driverSet,At,Qt),this._driverSet},bt.prototype.supports=function(Gt){return!!Vs[Gt]},bt.prototype._extend=function(Gt){Oe(this,Gt)},bt.prototype._getSupportedDrivers=function(Gt){for(var At=[],Qt=0,le=Gt.length;Qt<le;Qt++){var re=Gt[Qt];this.supports(re)&&At.push(re)}return At},bt.prototype._wrapLibraryMethodsWithReady=function(){for(var Gt=0,At=xi.length;Gt<At;Gt++)br(this,xi[Gt])},bt.prototype.createInstance=function(Gt){return new bt(Gt)},bt}(),Mn=new hn;c.exports=Mn},{3:3}]},{},[4])(4)});
